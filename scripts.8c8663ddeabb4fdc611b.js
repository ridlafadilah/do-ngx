(function(){var e,t,n,o,i,r,a,s,l,u,c,d,f,h,g,m,p,v,y,b,C,T,x,E,_,I,D,O,w,R,S,k,A,N,M,K,P,L,B,F,z,V,H,W,$,U,q,j,G=[].slice,X={}.hasOwnProperty,Y=function(e,t){function n(){this.constructor=e}for(var o in t)X.call(t,o)&&(e[o]=t[o]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e},Z=[].indexOf||function(e){for(var t=0,n=this.length;n>t;t++)if(t in this&&this[t]===e)return t;return-1};for(C={catchupTime:100,initialRate:.03,minTime:250,ghostTime:100,maxProgressPerFrame:20,easeFactor:1.25,startOnPageLoad:!0,restartOnPushState:!0,restartOnRequestAfter:500,target:"body",elements:{checkInterval:100,selectors:["body"]},eventLag:{minSamples:10,sampleCount:3,lagThreshold:3},ajax:{trackMethods:["GET"],trackWebSockets:!0,ignoreURLs:[]}},w=function(){var e;return null!=(e="undefined"!=typeof performance&&null!==performance&&"function"==typeof performance.now?performance.now():void 0)?e:+new Date},S=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame,b=window.cancelAnimationFrame||window.mozCancelAnimationFrame,null==S&&(S=function(e){return setTimeout(e,50)},b=function(e){return clearTimeout(e)}),A=function(e){var t,n;return t=w(),(n=function(){var o;return(o=w()-t)>=33?(t=w(),e(o,(function(){return S(n)}))):setTimeout(n,33-o)})()},k=function(){var e,t,n;return n=arguments[0],t=arguments[1],e=3<=arguments.length?G.call(arguments,2):[],"function"==typeof n[t]?n[t].apply(n,e):n[t]},T=function(){var e,t,n,o,i,r,a;for(t=arguments[0],r=0,a=(o=2<=arguments.length?G.call(arguments,1):[]).length;a>r;r++)if(n=o[r])for(e in n)X.call(n,e)&&(i=n[e],null!=t[e]&&"object"==typeof t[e]&&null!=i&&"object"==typeof i?T(t[e],i):t[e]=i);return t},p=function(e){var t,n,o,i;for(n=t=0,o=0,i=e.length;i>o;o++)n+=Math.abs(e[o]),t++;return n/t},E=function(e,t){var n,o;if(null==e&&(e="options"),null==t&&(t=!0),o=document.querySelector("[data-pace-"+e+"]")){if(n=o.getAttribute("data-pace-"+e),!t)return n;try{return JSON.parse(n)}catch(r){return"undefined"!=typeof console&&null!==console?console.error("Error parsing inline pace options",r):void 0}}},a=function(){function e(){}return e.prototype.on=function(e,t,n,o){var i;return null==o&&(o=!1),null==this.bindings&&(this.bindings={}),null==(i=this.bindings)[e]&&(i[e]=[]),this.bindings[e].push({handler:t,ctx:n,once:o})},e.prototype.once=function(e,t,n){return this.on(e,t,n,!0)},e.prototype.off=function(e,t){var n,o,i;if(null!=(null!=(o=this.bindings)?o[e]:void 0)){if(null==t)return delete this.bindings[e];for(n=0,i=[];n<this.bindings[e].length;)i.push(this.bindings[e][n].handler===t?this.bindings[e].splice(n,1):n++);return i}},e.prototype.trigger=function(){var e,t,n,o,i,r,a,s;if(n=arguments[0],e=2<=arguments.length?G.call(arguments,1):[],null!=(r=this.bindings)?r[n]:void 0){for(o=0,s=[];o<this.bindings[n].length;)i=(a=this.bindings[n][o]).once,a.handler.apply(null!=(t=a.ctx)?t:this,e),s.push(i?this.bindings[n].splice(o,1):o++);return s}},e}(),u=window.Pace||{},window.Pace=u,T(u,a.prototype),R=u.options=T({},C,window.paceOptions,E()),H=0,$=(q=["ajax","document","eventLag","elements"]).length;$>H;H++)!0===R[P=q[H]]&&(R[P]=C[P]);l=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Y(t,e),t}(Error),t=function(){function e(){this.progress=0}return e.prototype.getElement=function(){var e;if(null==this.el){if(!(e=document.querySelector(R.target)))throw new l;this.el=document.createElement("div"),this.el.className="pace pace-active",document.body.className=document.body.className.replace(/pace-done/g,""),document.body.className+=" pace-running",this.el.innerHTML='<div class="pace-progress">\n  <div class="pace-progress-inner"></div>\n</div>\n<div class="pace-activity"></div>',null!=e.firstChild?e.insertBefore(this.el,e.firstChild):e.appendChild(this.el)}return this.el},e.prototype.finish=function(){var e;return(e=this.getElement()).className=e.className.replace("pace-active",""),e.className+=" pace-inactive",document.body.className=document.body.className.replace("pace-running",""),document.body.className+=" pace-done"},e.prototype.update=function(e){return this.progress=e,this.render()},e.prototype.destroy=function(){try{this.getElement().parentNode.removeChild(this.getElement())}catch(e){l=e}return this.el=void 0},e.prototype.render=function(){var e,t,n,o,i,r;if(null==document.querySelector(R.target))return!1;for(e=this.getElement(),n="translate3d("+this.progress+"%, 0, 0)",o=0,i=(r=["webkitTransform","msTransform","transform"]).length;i>o;o++)e.children[0].style[r[o]]=n;return(!this.lastRenderedProgress||this.lastRenderedProgress|0!==this.progress|0)&&(e.children[0].setAttribute("data-progress-text",(0|this.progress)+"%"),this.progress>=100?t="99":(t=this.progress<10?"0":"",t+=0|this.progress),e.children[0].setAttribute("data-progress",""+t)),this.lastRenderedProgress=this.progress},e.prototype.done=function(){return this.progress>=100},e}(),s=function(){function e(){this.bindings={}}return e.prototype.trigger=function(e,t){var n,o,i,r;if(null!=this.bindings[e]){for(r=[],n=0,o=(i=this.bindings[e]).length;o>n;n++)r.push(i[n].call(this,t));return r}},e.prototype.on=function(e,t){var n;return null==(n=this.bindings)[e]&&(n[e]=[]),this.bindings[e].push(t)},e}(),V=window.XMLHttpRequest,z=window.XDomainRequest,F=window.WebSocket,x=function(e,t){var n,o;for(n in o=[],t.prototype)try{o.push(null==e[n]&&"function"!=typeof t[n]?"function"==typeof Object.defineProperty?Object.defineProperty(e,n,{get:function(){return t.prototype[n]},configurable:!0,enumerable:!0}):e[n]=t.prototype[n]:void 0)}catch(r){}return o},D=[],u.ignore=function(){var e,t,n;return t=arguments[0],e=2<=arguments.length?G.call(arguments,1):[],D.unshift("ignore"),n=t.apply(null,e),D.shift(),n},u.track=function(){var e,t,n;return t=arguments[0],e=2<=arguments.length?G.call(arguments,1):[],D.unshift("track"),n=t.apply(null,e),D.shift(),n},K=function(e){var t;if(null==e&&(e="GET"),"track"===D[0])return"force";if(!D.length&&R.ajax){if("socket"===e&&R.ajax.trackWebSockets)return!0;if(t=e.toUpperCase(),Z.call(R.ajax.trackMethods,t)>=0)return!0}return!1},c=function(e){function t(){var e,n=this;t.__super__.constructor.apply(this,arguments),e=function(e){var t;return t=e.open,e.open=function(o,i,r){return K(o)&&n.trigger("request",{type:o,url:i,request:e}),t.apply(e,arguments)}},window.XMLHttpRequest=function(t){var n;return n=new V(t),e(n),n};try{x(window.XMLHttpRequest,V)}catch(o){}if(null!=z){window.XDomainRequest=function(){var t;return t=new z,e(t),t};try{x(window.XDomainRequest,z)}catch(o){}}if(null!=F&&R.ajax.trackWebSockets){window.WebSocket=function(e,t){var o;return o=null!=t?new F(e,t):new F(e),K("socket")&&n.trigger("request",{type:"socket",url:e,protocols:t,request:o}),o};try{x(window.WebSocket,F)}catch(o){}}}return Y(t,e),t}(s),W=null,M=function(e){var t,n,o,i;for(n=0,o=(i=R.ajax.ignoreURLs).length;o>n;n++)if("string"==typeof(t=i[n])){if(-1!==e.indexOf(t))return!0}else if(t.test(e))return!0;return!1},(_=function(){return null==W&&(W=new c),W})().on("request",(function(t){var n,o,i,r;return r=t.type,i=t.request,M(t.url)||u.running||!1===R.restartOnRequestAfter&&"force"!==K(r)?void 0:(o=arguments,"boolean"==typeof(n=R.restartOnRequestAfter||0)&&(n=0),setTimeout((function(){var t,n,a,s,l;if("socket"===r?i.readyState<2:0<(a=i.readyState)&&4>a){for(u.restart(),l=[],t=0,n=(s=u.sources).length;n>t;t++){if((P=s[t])instanceof e){P.watch.apply(P,o);break}l.push(void 0)}return l}}),n))})),e=function(){function e(){var e=this;this.elements=[],_().on("request",(function(){return e.watch.apply(e,arguments)}))}return e.prototype.watch=function(e){var t,n,o;return o=e.type,t=e.request,M(e.url)?void 0:(n="socket"===o?new h(t):new g(t),this.elements.push(n))},e}(),g=function(e){var t,n,o,i,r=this;if(this.progress=0,null!=window.ProgressEvent)for(e.addEventListener("progress",(function(e){return r.progress=e.lengthComputable?100*e.loaded/e.total:r.progress+(100-r.progress)/2}),!1),t=0,n=(i=["load","abort","timeout","error"]).length;n>t;t++)e.addEventListener(i[t],(function(){return r.progress=100}),!1);else o=e.onreadystatechange,e.onreadystatechange=function(){var t;return 0===(t=e.readyState)||4===t?r.progress=100:3===e.readyState&&(r.progress=50),"function"==typeof o?o.apply(null,arguments):void 0}},h=function(e){var t,n,o,i=this;for(this.progress=0,t=0,n=(o=["error","open"]).length;n>t;t++)e.addEventListener(o[t],(function(){return i.progress=100}),!1)},o=function(e){var t,n,o;for(null==e&&(e={}),this.elements=[],null==e.selectors&&(e.selectors=[]),t=0,n=(o=e.selectors).length;n>t;t++)this.elements.push(new i(o[t]))},i=function(){function e(e){this.selector=e,this.progress=0,this.check()}return e.prototype.check=function(){var e=this;return document.querySelector(this.selector)?this.done():setTimeout((function(){return e.check()}),R.elements.checkInterval)},e.prototype.done=function(){return this.progress=100},e}(),n=function(){function e(){var e,t,n=this;this.progress=null!=(t=this.states[document.readyState])?t:100,e=document.onreadystatechange,document.onreadystatechange=function(){return null!=n.states[document.readyState]&&(n.progress=n.states[document.readyState]),"function"==typeof e?e.apply(null,arguments):void 0}}return e.prototype.states={loading:0,interactive:50,complete:100},e}(),r=function(){var e,t,n,o,i,r=this;this.progress=0,e=0,i=[],o=0,n=w(),t=setInterval((function(){var a;return a=w()-n-50,n=w(),i.push(a),i.length>R.eventLag.sampleCount&&i.shift(),e=p(i),++o>=R.eventLag.minSamples&&e<R.eventLag.lagThreshold?(r.progress=100,clearInterval(t)):r.progress=3/(e+3)*100}),50)},f=function(){function e(e){this.source=e,this.last=this.sinceLastUpdate=0,this.rate=R.initialRate,this.catchup=0,this.progress=this.lastProgress=0,null!=this.source&&(this.progress=k(this.source,"progress"))}return e.prototype.tick=function(e,t){var n;return null==t&&(t=k(this.source,"progress")),t>=100&&(this.done=!0),t===this.last?this.sinceLastUpdate+=e:(this.sinceLastUpdate&&(this.rate=(t-this.last)/this.sinceLastUpdate),this.catchup=(t-this.progress)/R.catchupTime,this.sinceLastUpdate=0,this.last=t),t>this.progress&&(this.progress+=this.catchup*e),n=1-Math.pow(this.progress/100,R.easeFactor),this.progress+=n*this.rate*e,this.progress=Math.min(this.lastProgress+R.maxProgressPerFrame,this.progress),this.progress=Math.max(0,this.progress),this.progress=Math.min(100,this.progress),this.lastProgress=this.progress,this.progress},e}(),L=null,N=null,v=null,B=null,m=null,y=null,u.running=!1,I=function(){return R.restartOnPushState?u.restart():void 0},null!=window.history.pushState&&(U=window.history.pushState,window.history.pushState=function(){return I(),U.apply(window.history,arguments)}),null!=window.history.replaceState&&(j=window.history.replaceState,window.history.replaceState=function(){return I(),j.apply(window.history,arguments)}),d={ajax:e,elements:o,document:n,eventLag:r},(O=function(){var e,n,o,i,r,a,s,l;for(u.sources=L=[],n=0,i=(a=["ajax","elements","document","eventLag"]).length;i>n;n++)!1!==R[e=a[n]]&&L.push(new d[e](R[e]));for(o=0,r=(l=null!=(s=R.extraSources)?s:[]).length;r>o;o++)L.push(new(P=l[o])(R));return u.bar=v=new t,N=[],B=new f})(),u.stop=function(){return u.trigger("stop"),u.running=!1,v.destroy(),y=!0,null!=m&&("function"==typeof b&&b(m),m=null),O()},u.restart=function(){return u.trigger("restart"),u.stop(),u.start()},u.go=function(){var e;return u.running=!0,v.render(),e=w(),y=!1,m=A((function(t,n){var o,i,r,a,s,l,c,d,h,g,m,p,b;for(o=d=0,i=!0,a=h=0,m=L.length;m>h;a=++h)for(P=L[a],c=null!=N[a]?N[a]:N[a]=[],s=g=0,p=(r=null!=(b=P.elements)?b:[P]).length;p>g;s=++g)i&=(l=null!=c[s]?c[s]:c[s]=new f(r[s])).done,l.done||(o++,d+=l.tick(t));return v.update(B.tick(t,d/o)),v.done()||i||y?(v.update(100),u.trigger("done"),setTimeout((function(){return v.finish(),u.running=!1,u.trigger("hide")}),Math.max(R.ghostTime,Math.max(R.minTime-(w()-e),0)))):n()}))},u.start=function(e){T(R,e),u.running=!0;try{v.render()}catch(t){l=t}return document.querySelector(".pace")?(u.trigger("start"),u.go()):setTimeout(u.start,50)},"function"==typeof define&&define.amd?define(["pace"],(function(){return u})):"object"==typeof exports?module.exports=u:R.startOnPageLoad&&u.start()}).call(this),function(e){"use strict";var t=function(e){if(null===e)return"null";if(void 0===e)return"undefined";var t=typeof e;return"object"==t&&(Array.prototype.isPrototypeOf(e)||e.constructor&&"Array"===e.constructor.name)?"array":"object"==t&&(String.prototype.isPrototypeOf(e)||e.constructor&&"String"===e.constructor.name)?"string":t},n=function(e){return{eq:e}},o=n((function(e,t){return e===t})),i=function(e){return n((function(t,n){if(t.length!==n.length)return!1;for(var o=t.length,i=0;i<o;i++)if(!e.eq(t[i],n[i]))return!1;return!0}))},r=function(e,t){return o=i(e),r=function(e){return n=t,Array.prototype.slice.call(e).sort(n);var n},n((function(e,t){return o.eq(r(e),r(t))}));var o,r},a=function(e){return n((function(t,n){var i=Object.keys(t),a=Object.keys(n);if(!r(o).eq(i,a))return!1;for(var s=i.length,l=0;l<s;l++){var u=i[l];if(!e.eq(t[u],n[u]))return!1}return!0}))},s=n((function(e,n){if(e===n)return!0;var o=t(e);return o===t(n)&&(-1!==["undefined","boolean","number","string","function","xml","null"].indexOf(o)?e===n:"array"===o?i(s).eq(e,n):"object"===o&&a(s).eq(e,n))})),l=function(){},u=function(e,t){return function(){for(var n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];return e(t.apply(null,n))}},c=function(e){return function(){return e}},d=function(e){return e};function f(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return function(){for(var n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];var i=t.concat(n);return e.apply(null,i)}}var h,g,m,p=function(e){return function(t){return!e(t)}},v=function(e){return function(){throw new Error(e)}},y=c(!1),b=c(!0),C=function(){return T},T=(h=function(e){return e.isNone()},{fold:function(e,t){return e()},is:y,isSome:y,isNone:b,getOr:m=function(e){return e},getOrThunk:g=function(e){return e()},getOrDie:function(e){throw new Error(e||"error: getOrDie called on none.")},getOrNull:c(null),getOrUndefined:c(void 0),or:m,orThunk:g,map:C,each:l,bind:C,exists:y,forall:b,filter:C,equals:h,equals_:h,toArray:function(){return[]},toString:c("none()")}),x=function(e){var t=c(e),n=function(){return i},o=function(t){return t(e)},i={fold:function(t,n){return n(e)},is:function(t){return e===t},isSome:b,isNone:y,getOr:t,getOrThunk:t,getOrDie:t,getOrNull:t,getOrUndefined:t,or:n,orThunk:n,map:function(t){return x(t(e))},each:function(t){t(e)},bind:o,exists:o,forall:o,filter:function(t){return t(e)?i:T},toArray:function(){return[e]},toString:function(){return"some("+e+")"},equals:function(t){return t.is(e)},equals_:function(t,n){return t.fold(y,(function(t){return n(e,t)}))}};return i},E={some:x,none:C,from:function(e){return null==e?T:x(e)}},_=function(e){return function(t){return o=typeof(n=t),(null===n?"null":"object"==o&&(Array.prototype.isPrototypeOf(n)||n.constructor&&"Array"===n.constructor.name)?"array":"object"==o&&(String.prototype.isPrototypeOf(n)||n.constructor&&"String"===n.constructor.name)?"string":o)===e;var n,o}},I=function(e){return function(t){return typeof t===e}},D=function(e){return function(t){return e===t}},O=_("string"),w=_("object"),R=_("array"),S=D(null),k=I("boolean"),A=D(void 0),N=I("function"),M=I("number"),K=Array.prototype.slice,P=Array.prototype.indexOf,L=Array.prototype.push,B=function(e,t){return P.call(e,t)},F=function(e,t){return-1<B(e,t)},z=function(e,t){for(var n=0,o=e.length;n<o;n++)if(t(e[n],n))return!0;return!1},V=function(e,t){for(var n=e.length,o=new Array(n),i=0;i<n;i++)o[i]=t(e[i],i);return o},H=function(e,t){for(var n=0,o=e.length;n<o;n++)t(e[n],n)},W=function(e,t){for(var n=e.length-1;0<=n;n--)t(e[n],n)},$=function(e,t){for(var n=[],o=0,i=e.length;o<i;o++){var r=e[o];t(r,o)&&n.push(r)}return n},U=function(e,t,n){return W(e,(function(e){n=t(n,e)})),n},q=function(e,t,n){return H(e,(function(e){n=t(n,e)})),n},j=function(e,t){return function(e,t,n){for(var o=0,i=e.length;o<i;o++){var r=e[o];if(t(r,o))return E.some(r);if(n(r,o))break}return E.none()}(e,t,y)},G=function(e,t){for(var n=0,o=e.length;n<o;n++)if(t(e[n],n))return E.some(n);return E.none()},X=function(e,t){return function(e){for(var t=[],n=0,o=e.length;n<o;++n){if(!R(e[n]))throw new Error("Arr.flatten item "+n+" was not an array, input: "+e);L.apply(t,e[n])}return t}(V(e,t))},Y=function(e,t){for(var n=0,o=e.length;n<o;++n)if(!0!==t(e[n],n))return!1;return!0},Z=function(e){var t=K.call(e,0);return t.reverse(),t},J=function(e,t){return $(e,(function(e){return!F(t,e)}))},Q=function(e){return 0===e.length?E.none():E.some(e[0])},ee=function(e){return 0===e.length?E.none():E.some(e[e.length-1])},te=N(Array.from)?Array.from:function(e){return K.call(e)},ne=Object.keys,oe=Object.hasOwnProperty,ie=function(e,t){for(var n=ne(e),o=0,i=n.length;o<i;o++){var r=n[o];t(e[r],r)}},re=function(e,t){return ae(e,(function(e,n){return{k:n,v:t(e,n)}}))},ae=function(e,t){var n={};return ie(e,(function(e,o){var i=t(e,o);n[i.k]=i.v})),n},se=function(e){return function(t,n){e[n]=t}},le=function(e,t,n,o){return ie(e,(function(e,i){(t(e,i)?n:o)(e,i)})),{}},ue=function(e,t){var n={},o={};return le(e,t,se(n),se(o)),{t:n,f:o}},ce=function(e,t){var n={};return le(e,t,se(n),l),n},de=function(e,t){return fe(e,t)?E.from(e[t]):E.none()},fe=function(e,t){return oe.call(e,t)},he=Array.isArray,ge=function(e,t,n){var o,i;if(!e)return 0;if(n=n||e,void 0!==e.length){for(o=0,i=e.length;o<i;o++)if(!1===t.call(n,e[o],o,e))return 0}else for(o in e)if(e.hasOwnProperty(o)&&!1===t.call(n,e[o],o,e))return 0;return 1},me=function(e,t){var n=[];return ge(e,(function(o,i){n.push(t(o,i,e))})),n},pe=function(e,t){var n=[];return ge(e,(function(o,i){t&&!t(o,i,e)||n.push(o)})),n},ve=function(e,t){var n,o;if(e)for(n=0,o=e.length;n<o;n++)if(e[n]===t)return n;return-1},ye=function(e,t,n,o){var i=0;for(arguments.length<3&&(n=e[0]);i<e.length;i++)n=t.call(o,n,e[i],i);return n},be=function(e,t,n){var o,i;for(o=0,i=e.length;o<i;o++)if(t.call(n,e[o],o,e))return o;return-1},Ce=function(e){return e[e.length-1]},Te=function(){return(Te=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function xe(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var o=Array(e),i=0;for(t=0;t<n;t++)for(var r=arguments[t],a=0,s=r.length;a<s;a++,i++)o[i]=r[a];return o}var Ee,_e,Ie,De=function(){return Oe(0,0)},Oe=function(e,t){return{major:e,minor:t}},we=function(e,t){var n=String(t).toLowerCase();return 0===e.length?De():function(e,t){var n=function(e,t){for(var n=0;n<e.length;n++){var o=e[n];if(o.test(t))return o}}(e,t);if(!n)return{major:0,minor:0};var o=function(e){return Number(t.replace(n,"$"+e))};return Oe(o(1),o(2))}(e,n)},Re=De,Se="Firefox",ke=function(e){var t=e.current,n=function(e){return function(){return t===e}};return{current:t,version:e.version,isEdge:n("Edge"),isChrome:n("Chrome"),isIE:n("IE"),isOpera:n("Opera"),isFirefox:n(Se),isSafari:n("Safari")}},Ae=function(){return ke({current:void 0,version:Re()})},Ne=ke,Me=(c("Edge"),c("Chrome"),c("IE"),c("Opera"),c(Se),c("Safari"),"Windows"),Ke="Android",Pe="Solaris",Le="FreeBSD",Be="ChromeOS",Fe=function(e){var t=e.current,n=function(e){return function(){return t===e}};return{current:t,version:e.version,isWindows:n(Me),isiOS:n("iOS"),isAndroid:n(Ke),isOSX:n("OSX"),isLinux:n("Linux"),isSolaris:n(Pe),isFreeBSD:n(Le),isChromeOS:n(Be)}},ze=function(){return Fe({current:void 0,version:Re()})},Ve=Fe,He=(c(Me),c("iOS"),c(Ke),c("Linux"),c("OSX"),c(Pe),c(Le),c(Be),function(e,t){var n=String(t).toLowerCase();return j(e,(function(e){return e.search(n)}))}),We=function(e,t){return-1!==e.indexOf(t)},$e=function(e,t){return n=e,""===(o=t)||n.length>=o.length&&n.substr(0,0+o.length)===o;var n,o},Ue=function(e){return function(t){return t.replace(e,"")}},qe=Ue(/^\s+|\s+$/g),je=Ue(/^\s+/g),Ge=Ue(/\s+$/g),Xe=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,Ye=function(e){return function(t){return We(t,e)}},Ze=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(e){return We(e,"edge/")&&We(e,"chrome")&&We(e,"safari")&&We(e,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,Xe],search:function(e){return We(e,"chrome")&&!We(e,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(e){return We(e,"msie")||We(e,"trident")}},{name:"Opera",versionRegexes:[Xe,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:Ye("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:Ye("firefox")},{name:"Safari",versionRegexes:[Xe,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(e){return(We(e,"safari")||We(e,"mobile/"))&&We(e,"applewebkit")}}],Je=[{name:"Windows",search:Ye("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(e){return We(e,"iphone")||We(e,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:Ye("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:Ye("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:Ye("linux"),versionRegexes:[]},{name:"Solaris",search:Ye("sunos"),versionRegexes:[]},{name:"FreeBSD",search:Ye("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:Ye("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],Qe={browsers:c(Ze),oses:c(Je)},et=function(t){return e.window.matchMedia(t).matches},tt=(Ie=!(Ee=function(){return function(e,t){var n,o,i,r,a,s,l,u,d,f,h,g,m=Qe.browsers(),p=Qe.oses(),v=function(e,t){return He(e,t).map((function(e){var n=we(e.versionRegexes,t);return{current:e.name,version:n}}))}(m,e).fold(Ae,Ne),y=function(e,t){return He(e,t).map((function(e){var n=we(e.versionRegexes,t);return{current:e.name,version:n}}))}(p,e).fold(ze,Ve);return{browser:v,os:y,deviceType:(o=v,i=e,r=t,a=(n=y).isiOS()&&!0===/ipad/i.test(i),s=n.isiOS()&&!a,l=n.isiOS()||n.isAndroid(),u=l||r("(pointer:coarse)"),d=a||!s&&l&&r("(min-device-width:768px)"),f=s||l&&!d,h=o.isSafari()&&n.isiOS()&&!1===/safari/i.test(i),g=!f&&!d&&!h,{isiPad:c(a),isiPhone:c(s),isTablet:c(d),isPhone:c(f),isTouch:c(u),isAndroid:n.isAndroid,isiOS:n.isiOS,isWebView:c(h),isDesktop:c(g)})}}(e.navigator.userAgent,et)}),function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Ie||(Ie=!0,_e=Ee.apply(null,e)),_e}),nt=function(){return tt()},ot=e.navigator.userAgent,it=nt(),rt=it.browser,at=it.os,st=it.deviceType,lt=/WebKit/.test(ot)&&!rt.isEdge(),ut="FormData"in e.window&&"FileReader"in e.window&&"URL"in e.window&&!!e.URL.createObjectURL,ct=-1!==ot.indexOf("Windows Phone"),dt={opera:rt.isOpera(),webkit:lt,ie:!(!rt.isIE()&&!rt.isEdge())&&rt.version.major,gecko:rt.isFirefox(),mac:at.isOSX()||at.isiOS(),iOS:st.isiPad()||st.isiPhone(),android:at.isAndroid(),contentEditable:!0,transparentSrc:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",caretAfter:!0,range:e.window.getSelection&&"Range"in e.window,documentMode:rt.isIE()?e.document.documentMode||7:10,fileApi:ut,ceFalse:!0,cacheSuffix:null,container:null,experimentalShadowDom:!1,canHaveCSP:!rt.isIE(),desktop:st.isDesktop(),windowsPhone:ct,browser:{current:rt.current,version:rt.version,isChrome:rt.isChrome,isEdge:rt.isEdge,isFirefox:rt.isFirefox,isIE:rt.isIE,isOpera:rt.isOpera,isSafari:rt.isSafari},os:{current:at.current,version:at.version,isAndroid:at.isAndroid,isChromeOS:at.isChromeOS,isFreeBSD:at.isFreeBSD,isiOS:at.isiOS,isLinux:at.isLinux,isOSX:at.isOSX,isSolaris:at.isSolaris,isWindows:at.isWindows},deviceType:{isDesktop:st.isDesktop,isiPad:st.isiPad,isiPhone:st.isiPhone,isPhone:st.isPhone,isTablet:st.isTablet,isTouch:st.isTouch,isWebView:st.isWebView}},ft=/^\s*|\s*$/g,ht=function(e){return null==e?"":(""+e).replace(ft,"")},gt=function(e,t){return t?!("array"!==t||!he(e))||typeof e===t:void 0!==e},mt=function(e,t,n,o){o=o||this,e&&(n&&(e=e[n]),ge(e,(function(e,i){if(!1===t.call(o,e,i,n))return!1;mt(e,t,n,o)})))},pt={trim:ht,isArray:he,is:gt,toArray:function(e){var t,n,o=e;if(!he(e))for(o=[],t=0,n=e.length;t<n;t++)o[t]=e[t];return o},makeMap:function(e,t,n){var o;for(t=t||",","string"==typeof(e=e||[])&&(e=e.split(t)),n=n||{},o=e.length;o--;)n[e[o]]={};return n},each:ge,map:me,grep:pe,inArray:ve,hasOwn:function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},extend:function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var o=0;o<t.length;o++){var i=t[o];for(var r in i)if(i.hasOwnProperty(r)){var a=i[r];void 0!==a&&(e[r]=a)}}return e},create:function(e,t,n){var o,i,r,a=this,s=0,l=(e=/^((static) )?([\w.]+)(:([\w.]+))?/.exec(e))[3].match(/(^|\.)(\w+)$/i)[2],u=a.createNS(e[3].replace(/\.\w+$/,""),n);if(!u[l]){if("static"===e[2])return u[l]=t,void(this.onCreate&&this.onCreate(e[2],e[3],u[l]));t[l]||(t[l]=function(){},s=1),u[l]=t[l],a.extend(u[l].prototype,t),e[5]&&(o=a.resolve(e[5]).prototype,i=e[5].match(/\.(\w+)$/i)[1],r=u[l],u[l]=s?function(){return o[i].apply(this,arguments)}:function(){return this.parent=o[i],r.apply(this,arguments)},u[l].prototype[l]=u[l],a.each(o,(function(e,t){u[l].prototype[t]=o[t]})),a.each(t,(function(e,t){o[t]?u[l].prototype[t]=function(){return this.parent=o[t],e.apply(this,arguments)}:t!==l&&(u[l].prototype[t]=e)}))),a.each(t.static,(function(e,t){u[l][t]=e}))}},walk:mt,createNS:function(t,n){var o,i;for(n=n||e.window,t=t.split("."),o=0;o<t.length;o++)n[i=t[o]]||(n[i]={}),n=n[i];return n},resolve:function(t,n){var o,i;for(n=n||e.window,o=0,i=(t=t.split(".")).length;o<i&&(n=n[t[o]]);o++);return n},explode:function(e,t){return!e||gt(e,"array")?e:me(e.split(t||","),ht)},_addCacheSuffix:function(e){var t=dt.cacheSuffix;return t&&(e+=(-1===e.indexOf("?")?"?":"&")+t),e}},vt=function(e){if(null==e)throw new Error("Node cannot be null or undefined");return{dom:c(e)}},yt={fromHtml:function(t,n){var o=(n||e.document).createElement("div");if(o.innerHTML=t,!o.hasChildNodes()||1<o.childNodes.length)throw e.console.error("HTML does not have a single root node",t),new Error("HTML must have a single root node");return vt(o.childNodes[0])},fromTag:function(t,n){var o=(n||e.document).createElement(t);return vt(o)},fromText:function(t,n){var o=(n||e.document).createTextNode(t);return vt(o)},fromDom:vt,fromPoint:function(e,t,n){var o=e.dom();return E.from(o.elementFromPoint(t,n)).map(vt)}},bt=(void 0!==e.window||Function("return this;")(),function(e){return e.dom().nodeName.toLowerCase()}),Ct=function(e){return e.dom().nodeType},Tt=function(e){return function(t){return Ct(t)===e}},xt=Tt(1),Et=Tt(3),_t=Tt(9),It=Tt(11),Dt=function(e,t){for(var n=[],o=function(e){return n.push(e),t(e)},i=t(e);(i=i.bind(o)).isSome(););return n},Ot=function(e,t){var n=e.dom();if(1!==n.nodeType)return!1;var o=n;if(void 0!==o.matches)return o.matches(t);if(void 0!==o.msMatchesSelector)return o.msMatchesSelector(t);if(void 0!==o.webkitMatchesSelector)return o.webkitMatchesSelector(t);if(void 0!==o.mozMatchesSelector)return o.mozMatchesSelector(t);throw new Error("Browser lacks native selectors")},wt=function(e){return 1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType||0===e.childElementCount},Rt=function(e,t){return e.dom()===t.dom()},St=function(t,n){return nt().browser.isIE()?function(t,n){return o=t.dom(),i=n.dom(),r=e.Node.DOCUMENT_POSITION_CONTAINED_BY,0!=(o.compareDocumentPosition(i)&r);var o,i,r}(t,n):(o=n,(i=t.dom())!==(r=o.dom())&&i.contains(r));var o,i,r},kt=function(e){return yt.fromDom(e.dom().ownerDocument)},At=function(e){return _t(e)?e:kt(e)},Nt=function(e){return E.from(e.dom().parentNode).map(yt.fromDom)},Mt=function(e){return E.from(e.dom().previousSibling).map(yt.fromDom)},Kt=function(e){return E.from(e.dom().nextSibling).map(yt.fromDom)},Pt=function(e){return Z(Dt(e,Mt))},Lt=function(e){return Dt(e,Kt)},Bt=function(e){return V(e.dom().childNodes,yt.fromDom)},Ft=function(e,t){var n=e.dom().childNodes;return E.from(n[t]).map(yt.fromDom)},zt=function(e){return Ft(e,0)},Vt=function(e){return Ft(e,e.dom().childNodes.length-1)},Ht=function(e){return It(e)},Wt=N(e.Element.prototype.attachShadow)&&N(e.Node.prototype.getRootNode)?function(e){return yt.fromDom(e.dom().getRootNode())}:At,$t=function(e){return yt.fromDom(e.dom().host)},Ut=function(e,t){Nt(e).each((function(n){n.dom().insertBefore(t.dom(),e.dom())}))},qt=function(e,t){Kt(e).fold((function(){Nt(e).each((function(e){Gt(e,t)}))}),(function(e){Ut(e,t)}))},jt=function(e,t){zt(e).fold((function(){Gt(e,t)}),(function(n){e.dom().insertBefore(t.dom(),n.dom())}))},Gt=function(e,t){e.dom().appendChild(t.dom())},Xt=function(e,t){H(t,(function(t){Gt(e,t)}))},Yt=function(e){e.dom().textContent="",H(Bt(e),(function(e){Zt(e)}))},Zt=function(e){var t=e.dom();null!==t.parentNode&&t.parentNode.removeChild(t)},Jt=function(e){var t,n=Bt(e);0<n.length&&(t=e,H(n,(function(e){Ut(t,e)}))),Zt(e)},Qt=function(e){var t,n,o,i,r=Et(e)?e.dom().parentNode:e.dom();return null!=r&&null!==r.ownerDocument&&(o=yt.fromDom(r),i=Wt(o),(Ht(i)?E.some(i):E.none()).fold((function(){return r.ownerDocument.body.contains(r)}),(t=Qt,n=$t,function(e){return t(n(e))})))},en=function(e,t){return{left:c(e),top:c(t),translate:function(n,o){return en(e+n,t+o)}}},tn=en,nn=function(e,t){return void 0!==e?e:void 0!==t?t:0},on=function(e){var t,n=e.dom(),o=n.ownerDocument.body;return o===n?tn(o.offsetLeft,o.offsetTop):Qt(e)?(t=n.getBoundingClientRect(),tn(t.left,t.top)):tn(0,0)},rn=function(t){var n=void 0!==t?t.dom():e.document;return tn(n.body.scrollLeft||n.documentElement.scrollLeft,n.body.scrollTop||n.documentElement.scrollTop)},an=function(t,n,o){(void 0!==o?o.dom():e.document).defaultView.scrollTo(t,n)},sn=function(e,t){nt().browser.isSafari()&&N(e.dom().scrollIntoViewIfNeeded)?e.dom().scrollIntoViewIfNeeded(!1):e.dom().scrollIntoView(t)},ln=function(e,t,n,o){return{x:e,y:t,width:n,height:o,right:e+n,bottom:t+o}},un=function(t){var n,o,i=void 0===t?e.window:t,r=rn(yt.fromDom(i.document));return o=void 0===(n=i)?e.window:n,E.from(o.visualViewport).fold((function(){var e=i.document.documentElement,t=e.clientWidth,n=e.clientHeight;return ln(r.left(),r.top(),t,n)}),(function(e){return ln(Math.max(e.pageLeft,r.left()),Math.max(e.pageTop,r.top()),e.width,e.height)}))},cn=function(e){return function(t){return!!t&&t.nodeType===e}},dn=function(e){return!!e&&!Object.getPrototypeOf(e)},fn=cn(1),hn=function(e){var t=e.map((function(e){return e.toLowerCase()}));return function(e){if(e&&e.nodeName){var n=e.nodeName.toLowerCase();return F(t,n)}return!1}},gn=function(e,t){var n=t.toLowerCase().split(" ");return function(t){var o;if(fn(t))for(o=0;o<n.length;o++){var i=t.ownerDocument.defaultView.getComputedStyle(t,null);if((i?i.getPropertyValue(e):null)===n[o])return!0}return!1}},mn=function(e){return function(t){return fn(t)&&t.hasAttribute(e)}},pn=function(e){return fn(e)&&e.hasAttribute("data-mce-bogus")},vn=function(e){return fn(e)&&"TABLE"===e.tagName},yn=function(e){return function(t){if(fn(t)){if(t.contentEditable===e)return!0;if(t.getAttribute("data-mce-contenteditable")===e)return!0}return!1}},bn=hn(["textarea","input"]),Cn=cn(3),Tn=cn(8),xn=cn(9),En=cn(11),_n=hn(["br"]),In=yn("true"),Dn=yn("false"),On=function(e){return void 0!==e.style&&N(e.style.getPropertyValue)},wn=function(t,n,o){if(!(O(o)||k(o)||M(o)))throw e.console.error("Invalid call to Attr.set. Key ",n,":: Value ",o,":: Element ",t),new Error("Attribute value was not simple");t.setAttribute(n,o+"")},Rn=function(e,t,n){wn(e.dom(),t,n)},Sn=function(e,t){var n=e.dom();ie(t,(function(e,t){wn(n,t,e)}))},kn=function(e,t){var n=e.dom().getAttribute(t);return null===n?void 0:n},An=function(e,t){e.dom().removeAttribute(t)},Nn=function(t,n){var o=t.dom(),i=e.window.getComputedStyle(o).getPropertyValue(n);return""!==i||Qt(t)?i:Mn(o,n)},Mn=function(e,t){return On(e)?e.style.getPropertyValue(t):""},Kn=function(e,t){var n=e.dom(),o=Mn(n,t);return E.from(o).filter((function(e){return 0<e.length}))},Pn=function(e){var t={},n=e.dom();if(On(n))for(var o=0;o<n.style.length;o++){var i=n.style.item(o);t[i]=n.style[i]}return t},Ln=nt().browser,Bn=function(e){return j(e,xt)},Fn=function(e,t){return e.children&&F(e.children,t)},zn=function(e){var t;return function(n){return(t=t||function(e,t){for(var n={},o=0,i=e.length;o<i;o++){var r=e[o];n[String(r)]=t(r,o)}return n}(e,c(!0))).hasOwnProperty(bt(n))}},Vn=zn(["h1","h2","h3","h4","h5","h6"]),Hn=zn(["article","aside","details","div","dt","figcaption","footer","form","fieldset","header","hgroup","html","main","nav","section","summary","body","p","dl","multicol","dd","figure","address","center","blockquote","h1","h2","h3","h4","h5","h6","listing","xmp","pre","plaintext","menu","dir","ul","ol","li","hr","table","tbody","thead","tfoot","th","tr","td","caption"]),Wn=function(e){return xt(e)&&!Hn(e)},$n=function(e){return xt(e)&&"br"===bt(e)},Un=zn(["h1","h2","h3","h4","h5","h6","p","div","address","pre","form","blockquote","center","dir","fieldset","header","footer","article","section","hgroup","aside","nav","figure"]),qn=zn(["ul","ol","dl"]),jn=zn(["li","dd","dt"]),Gn=zn(["area","base","basefont","br","col","frame","hr","img","input","isindex","link","meta","param","embed","source","wbr","track"]),Xn=zn(["thead","tbody","tfoot"]),Yn=zn(["td","th"]),Zn=zn(["pre","script","textarea","style"]),Jn=/^[ \t\r\n]*$/,Qn=function(e){return Jn.test(e)},eo=function(e){return e&&"SPAN"===e.tagName&&"bookmark"===e.getAttribute("data-mce-type")},to=function(e,t){var n,o=t.childNodes;if(!fn(t)||!eo(t)){for(n=o.length-1;0<=n;n--)to(e,o[n]);if(!1===xn(t)){if(Cn(t)&&0<t.nodeValue.length){var i=Qn(t.nodeValue);if(e.isBlock(t.parentNode)||!i)return;if((r=t).previousSibling&&"SPAN"===r.previousSibling.nodeName&&r.nextSibling&&"SPAN"===r.nextSibling.nodeName)return}else if(fn(t)&&(1===(o=t.childNodes).length&&eo(o[0])&&t.parentNode.insertBefore(o[0],t),o.length||Gn(yt.fromDom(t))))return;e.remove(t)}var r;return t}},no=pt.makeMap,oo=/[&<>\"\u0060\u007E-\uD7FF\uE000-\uFFEF]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g,io=/[<>&\u007E-\uD7FF\uE000-\uFFEF]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g,ro=/[<>&\"\']/g,ao=/&#([a-z0-9]+);?|&([a-z0-9]+);/gi,so={128:"€",130:"‚",131:"ƒ",132:"„",133:"…",134:"†",135:"‡",136:"ˆ",137:"‰",138:"Š",139:"‹",140:"Œ",142:"Ž",145:"‘",146:"’",147:"“",148:"”",149:"•",150:"–",151:"—",152:"˜",153:"™",154:"š",155:"›",156:"œ",158:"ž",159:"Ÿ"},lo={'"':"&quot;","'":"&#39;","<":"&lt;",">":"&gt;","&":"&amp;","`":"&#96;"},uo={"&lt;":"<","&gt;":">","&amp;":"&","&quot;":'"',"&apos;":"'"},co=function(e,t){var n,o,i,r={};if(e){for(e=e.split(","),t=t||10,n=0;n<e.length;n+=2)o=String.fromCharCode(parseInt(e[n],t)),lo[o]||(r[o]=i="&"+e[n+1]+";",r[i]=o);return r}},fo=co("50,nbsp,51,iexcl,52,cent,53,pound,54,curren,55,yen,56,brvbar,57,sect,58,uml,59,copy,5a,ordf,5b,laquo,5c,not,5d,shy,5e,reg,5f,macr,5g,deg,5h,plusmn,5i,sup2,5j,sup3,5k,acute,5l,micro,5m,para,5n,middot,5o,cedil,5p,sup1,5q,ordm,5r,raquo,5s,frac14,5t,frac12,5u,frac34,5v,iquest,60,Agrave,61,Aacute,62,Acirc,63,Atilde,64,Auml,65,Aring,66,AElig,67,Ccedil,68,Egrave,69,Eacute,6a,Ecirc,6b,Euml,6c,Igrave,6d,Iacute,6e,Icirc,6f,Iuml,6g,ETH,6h,Ntilde,6i,Ograve,6j,Oacute,6k,Ocirc,6l,Otilde,6m,Ouml,6n,times,6o,Oslash,6p,Ugrave,6q,Uacute,6r,Ucirc,6s,Uuml,6t,Yacute,6u,THORN,6v,szlig,70,agrave,71,aacute,72,acirc,73,atilde,74,auml,75,aring,76,aelig,77,ccedil,78,egrave,79,eacute,7a,ecirc,7b,euml,7c,igrave,7d,iacute,7e,icirc,7f,iuml,7g,eth,7h,ntilde,7i,ograve,7j,oacute,7k,ocirc,7l,otilde,7m,ouml,7n,divide,7o,oslash,7p,ugrave,7q,uacute,7r,ucirc,7s,uuml,7t,yacute,7u,thorn,7v,yuml,ci,fnof,sh,Alpha,si,Beta,sj,Gamma,sk,Delta,sl,Epsilon,sm,Zeta,sn,Eta,so,Theta,sp,Iota,sq,Kappa,sr,Lambda,ss,Mu,st,Nu,su,Xi,sv,Omicron,t0,Pi,t1,Rho,t3,Sigma,t4,Tau,t5,Upsilon,t6,Phi,t7,Chi,t8,Psi,t9,Omega,th,alpha,ti,beta,tj,gamma,tk,delta,tl,epsilon,tm,zeta,tn,eta,to,theta,tp,iota,tq,kappa,tr,lambda,ts,mu,tt,nu,tu,xi,tv,omicron,u0,pi,u1,rho,u2,sigmaf,u3,sigma,u4,tau,u5,upsilon,u6,phi,u7,chi,u8,psi,u9,omega,uh,thetasym,ui,upsih,um,piv,812,bull,816,hellip,81i,prime,81j,Prime,81u,oline,824,frasl,88o,weierp,88h,image,88s,real,892,trade,89l,alefsym,8cg,larr,8ch,uarr,8ci,rarr,8cj,darr,8ck,harr,8dl,crarr,8eg,lArr,8eh,uArr,8ei,rArr,8ej,dArr,8ek,hArr,8g0,forall,8g2,part,8g3,exist,8g5,empty,8g7,nabla,8g8,isin,8g9,notin,8gb,ni,8gf,prod,8gh,sum,8gi,minus,8gn,lowast,8gq,radic,8gt,prop,8gu,infin,8h0,ang,8h7,and,8h8,or,8h9,cap,8ha,cup,8hb,int,8hk,there4,8hs,sim,8i5,cong,8i8,asymp,8j0,ne,8j1,equiv,8j4,le,8j5,ge,8k2,sub,8k3,sup,8k4,nsub,8k6,sube,8k7,supe,8kl,oplus,8kn,otimes,8l5,perp,8m5,sdot,8o8,lceil,8o9,rceil,8oa,lfloor,8ob,rfloor,8p9,lang,8pa,rang,9ea,loz,9j0,spades,9j3,clubs,9j5,hearts,9j6,diams,ai,OElig,aj,oelig,b0,Scaron,b1,scaron,bo,Yuml,m6,circ,ms,tilde,802,ensp,803,emsp,809,thinsp,80c,zwnj,80d,zwj,80e,lrm,80f,rlm,80j,ndash,80k,mdash,80o,lsquo,80p,rsquo,80q,sbquo,80s,ldquo,80t,rdquo,80u,bdquo,810,dagger,811,Dagger,81g,permil,81p,lsaquo,81q,rsaquo,85c,euro",32),ho=function(e,t){return e.replace(t?oo:io,(function(e){return lo[e]||e}))},go=function(e,t){return e.replace(t?oo:io,(function(e){return 1<e.length?"&#"+(1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320)+65536)+";":lo[e]||"&#"+e.charCodeAt(0)+";"}))},mo=function(e,t,n){return n=n||fo,e.replace(t?oo:io,(function(e){return lo[e]||n[e]||e}))},po={encodeRaw:ho,encodeAllRaw:function(e){return(""+e).replace(ro,(function(e){return lo[e]||e}))},encodeNumeric:go,encodeNamed:mo,getEncodeFunc:function(e,t){var n=co(t)||fo,o=no(e.replace(/\+/g,","));return o.named&&o.numeric?function(e,t){return e.replace(t?oo:io,(function(e){return void 0!==lo[e]?lo[e]:void 0!==n[e]?n[e]:1<e.length?"&#"+(1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320)+65536)+";":"&#"+e.charCodeAt(0)+";"}))}:o.named?t?function(e,t){return mo(e,t,n)}:mo:o.numeric?go:ho},decode:function(e){return e.replace(ao,(function(e,t){return t?65535<(t="x"===t.charAt(0).toLowerCase()?parseInt(t.substr(1),16):parseInt(t,10))?(t-=65536,String.fromCharCode(55296+(t>>10),56320+(1023&t))):so[t]||String.fromCharCode(t):uo[e]||fo[e]||(n=e,(o=yt.fromTag("div").dom()).innerHTML=n,o.textContent||o.innerText||n);var n,o}))}},vo={},yo={},bo=pt.makeMap,Co=pt.each,To=pt.extend,xo=pt.explode,Eo=pt.inArray,_o=function(e,t){return(e=pt.trim(e))?e.split(t||" "):[]},Io=function(e,t){var n;return e&&(n={},"string"==typeof e&&(e={"*":e}),Co(e,(function(e,o){n[o]=n[o.toUpperCase()]=("map"===t?bo:xo)(e,/[, ]/)}))),n};function Do(e){var t={},n={},o=[],i={},r={},a=function(t,n,o){var i=e[t];return i?i=bo(i,/[, ]/,bo(i.toUpperCase(),/[, ]/)):(i=vo[t])||(i=bo(n," ",bo(n.toUpperCase()," ")),i=To(i,o),vo[t]=i),i},s=function(e){var t,n,o,i,r,a,s={},l=function(e,n,o){var i,r,a,l=function(e,t){var n,o,i={};for(n=0,o=e.length;n<o;n++)i[e[n]]=t||{};return i};for(n=n||"","string"==typeof(o=o||[])&&(o=_o(o)),i=(e=_o(e)).length;i--;)a={attributes:l(r=_o([t,n].join(" "))),attributesOrder:r,children:l(o,yo)},s[e[i]]=a},u=function(e,t){var n,o,i,r;for(n=(e=_o(e)).length,t=_o(t);n--;)for(o=s[e[n]],i=0,r=t.length;i<r;i++)o.attributes[t[i]]={},o.attributesOrder.push(t[i])};return vo[e]?vo[e]:(t="id accesskey class dir lang style tabindex title role",n="address blockquote div dl fieldset form h1 h2 h3 h4 h5 h6 hr menu ol p pre table ul",o="a abbr b bdo br button cite code del dfn em embed i iframe img input ins kbd label map noscript object q s samp script select small span strong sub sup textarea u var #text #comment","html4"!==e&&(t+=" contenteditable contextmenu draggable dropzone hidden spellcheck translate",n+=" article aside details dialog figure main header footer hgroup section nav",o+=" audio canvas command datalist mark meter output picture progress time wbr video ruby bdi keygen"),"html5-strict"!==e&&(t+=" xml:lang",o=[o,a="acronym applet basefont big font strike tt"].join(" "),Co(_o(a),(function(e){l(e,"",o)})),n=[n,r="center dir isindex noframes"].join(" "),i=[n,o].join(" "),Co(_o(r),(function(e){l(e,"",i)}))),i=i||[n,o].join(" "),l("html","manifest","head body"),l("head","","base command link meta noscript script style title"),l("title hr noscript br"),l("base","href target"),l("link","href rel media hreflang type sizes hreflang"),l("meta","name http-equiv content charset"),l("style","media type scoped"),l("script","src async defer type charset"),l("body","onafterprint onbeforeprint onbeforeunload onblur onerror onfocus onhashchange onload onmessage onoffline ononline onpagehide onpageshow onpopstate onresize onscroll onstorage onunload",i),l("address dt dd div caption","",i),l("h1 h2 h3 h4 h5 h6 pre p abbr code var samp kbd sub sup i b u bdo span legend em strong small s cite dfn","",o),l("blockquote","cite",i),l("ol","reversed start type","li"),l("ul","","li"),l("li","value",i),l("dl","","dt dd"),l("a","href target rel media hreflang type",o),l("q","cite",o),l("ins del","cite datetime",i),l("img","src sizes srcset alt usemap ismap width height"),l("iframe","src name width height",i),l("embed","src type width height"),l("object","data type typemustmatch name usemap form width height",[i,"param"].join(" ")),l("param","name value"),l("map","name",[i,"area"].join(" ")),l("area","alt coords shape href target rel media hreflang type"),l("table","border","caption colgroup thead tfoot tbody tr"+("html4"===e?" col":"")),l("colgroup","span","col"),l("col","span"),l("tbody thead tfoot","","tr"),l("tr","","td th"),l("td","colspan rowspan headers",i),l("th","colspan rowspan headers scope abbr",i),l("form","accept-charset action autocomplete enctype method name novalidate target",i),l("fieldset","disabled form name",[i,"legend"].join(" ")),l("label","form for",o),l("input","accept alt autocomplete checked dirname disabled form formaction formenctype formmethod formnovalidate formtarget height list max maxlength min multiple name pattern readonly required size src step type value width"),l("button","disabled form formaction formenctype formmethod formnovalidate formtarget name type value","html4"===e?i:o),l("select","disabled form multiple name required size","option optgroup"),l("optgroup","disabled label","option"),l("option","disabled label selected value"),l("textarea","cols dirname disabled form maxlength name readonly required rows wrap"),l("menu","type label",[i,"li"].join(" ")),l("noscript","",i),"html4"!==e&&(l("wbr"),l("ruby","",[o,"rt rp"].join(" ")),l("figcaption","",i),l("mark rt rp summary bdi","",o),l("canvas","width height",i),l("video","src crossorigin poster preload autoplay mediagroup loop muted controls width height buffered",[i,"track source"].join(" ")),l("audio","src crossorigin preload autoplay mediagroup loop muted controls buffered volume",[i,"track source"].join(" ")),l("picture","","img source"),l("source","src srcset type media sizes"),l("track","kind src srclang label default"),l("datalist","",[o,"option"].join(" ")),l("article section nav aside main header footer","",i),l("hgroup","","h1 h2 h3 h4 h5 h6"),l("figure","",[i,"figcaption"].join(" ")),l("time","datetime",o),l("dialog","open",i),l("command","type label icon disabled checked radiogroup command"),l("output","for form name",o),l("progress","value max",o),l("meter","value min max low high optimum",o),l("details","open",[i,"summary"].join(" ")),l("keygen","autofocus challenge disabled form keytype name")),"html5-strict"!==e&&(u("script","language xml:space"),u("style","xml:space"),u("object","declare classid code codebase codetype archive standby align border hspace vspace"),u("embed","align name hspace vspace"),u("param","valuetype type"),u("a","charset name rev shape coords"),u("br","clear"),u("applet","codebase archive code object alt name width height align hspace vspace"),u("img","name longdesc align border hspace vspace"),u("iframe","longdesc frameborder marginwidth marginheight scrolling align"),u("font basefont","size color face"),u("input","usemap align"),u("select"),u("textarea"),u("h1 h2 h3 h4 h5 h6 div p legend caption","align"),u("ul","type compact"),u("li","type"),u("ol dl menu dir","compact"),u("pre","width xml:space"),u("hr","align noshade size width"),u("isindex","prompt"),u("table","summary width frame rules cellspacing cellpadding align bgcolor"),u("col","width align char charoff valign"),u("colgroup","width align char charoff valign"),u("thead","align char charoff valign"),u("tr","align char charoff valign bgcolor"),u("th","axis align char charoff valign nowrap bgcolor width height"),u("form","accept"),u("td","abbr axis scope align char charoff valign nowrap bgcolor width height"),u("tfoot","align char charoff valign"),u("tbody","align char charoff valign"),u("area","nohref"),u("body","background bgcolor text link vlink alink")),"html4"!==e&&(u("input button select textarea","autofocus"),u("input textarea","placeholder"),u("a","download"),u("link script img","crossorigin"),u("img","loading"),u("iframe","sandbox seamless allowfullscreen loading")),Co(_o("a form meter progress dfn"),(function(e){s[e]&&delete s[e].children[e]})),delete s.caption.children.table,delete s.script,vo[e]=s)}((e=e||{}).schema);!1===e.verify_html&&(e.valid_elements="*[*]");var l=Io(e.valid_styles),u=Io(e.invalid_styles,"map"),c=Io(e.valid_classes,"map"),d=a("whitespace_elements","pre script noscript style textarea video audio iframe object code"),f=a("self_closing_elements","colgroup dd dt li option p td tfoot th thead tr"),h=a("short_ended_elements","area base basefont br col frame hr img input isindex link meta param embed source wbr track"),g=a("boolean_attributes","checked compact declare defer disabled ismap multiple nohref noresize noshade nowrap readonly selected autoplay loop controls"),m=a("non_empty_elements","td th iframe video audio object script pre code",h),p=a("move_caret_before_on_enter_elements","table",m),v=a("text_block_elements","h1 h2 h3 h4 h5 h6 p div address pre form blockquote center dir fieldset header footer article section hgroup aside main nav figure"),y=a("block_elements","hr table tbody thead tfoot th tr td li ol ul caption dl dt dd noscript menu isindex option datalist select optgroup figcaption details summary",v),b=a("text_inline_elements","span strong b em i font strike u var cite dfn code mark q sup sub samp");Co((e.special||"script noscript iframe noframes noembed title style textarea xmp").split(" "),(function(e){r[e]=new RegExp("</"+e+"[^>]*>","gi")}));var C=function(e){return new RegExp("^"+e.replace(/([?+*])/g,".$1")+"$")},T=function(e){var n,i,r,a,s,l,u,c,d,f,h,g,m,p,v,y,b,T,x=/^([#+\-])?([^\[!\/]+)(?:\/([^\[!]+))?(?:(!?)\[([^\]]+)\])?$/,E=/^([!\-])?(\w+[\\:]:\w+|[^=:<]+)?(?:([=:<])(.*))?$/,_=/[*?+]/;if(e)for(e=_o(e,","),t["@"]&&(y=t["@"].attributes,b=t["@"].attributesOrder),n=0,i=e.length;n<i;n++)if(s=x.exec(e[n])){if(d=s[2],v=s[3],c=s[5],l={attributes:g={},attributesOrder:m=[]},"#"===(p=s[1])&&(l.paddEmpty=!0),"-"===p&&(l.removeEmpty=!0),"!"===s[4]&&(l.removeEmptyAttrs=!0),y&&(ie(y,(function(e,t){g[t]=e})),m.push.apply(m,b)),c)for(r=0,a=(c=_o(c,"|")).length;r<a;r++)if(s=E.exec(c[r])){if(u={},h=s[1],f=s[2].replace(/[\\:]:/g,":"),p=s[3],T=s[4],"!"===h&&(l.attributesRequired=l.attributesRequired||[],l.attributesRequired.push(f),u.required=!0),"-"===h){delete g[f],m.splice(Eo(m,f),1);continue}p&&("="===p&&(l.attributesDefault=l.attributesDefault||[],l.attributesDefault.push({name:f,value:T}),u.defaultValue=T),":"===p&&(l.attributesForced=l.attributesForced||[],l.attributesForced.push({name:f,value:T}),u.forcedValue=T),"<"===p&&(u.validValues=bo(T,"?"))),_.test(f)?(l.attributePatterns=l.attributePatterns||[],u.pattern=C(f),l.attributePatterns.push(u)):(g[f]||m.push(f),g[f]=u)}y||"@"!==d||(y=g,b=m),v&&(l.outputName=d,t[v]=l),_.test(d)?(l.pattern=C(d),o.push(l)):t[d]=l}},x=function(e){t={},o=[],T(e),Co(s,(function(e,t){n[t]=e.children}))},E=function(e){var o=/^(~)?(.+)$/;e&&(vo.text_block_elements=vo.block_elements=null,Co(_o(e,","),(function(e){var r=o.exec(e),a="~"===r[1],s=a?"span":"div",l=r[2];if(n[l]=n[s],i[l]=s,a||(y[l.toUpperCase()]={},y[l]={}),!t[l]){var u=t[s];delete(u=To({},u)).removeEmptyAttrs,delete u.removeEmpty,t[l]=u}Co(n,(function(e,t){e[s]&&(n[t]=e=To({},n[t]),e[l]=e[s])}))})))},_=function(t){var o=/^([+\-]?)([A-Za-z0-9_\-\.\u00b7\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u037d\u037f-\u1fff\u200c-\u200d\u203f-\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]+)\[([^\]]+)\]$/;vo[e.schema]=null,t&&Co(_o(t,","),(function(e){var t,i,r=o.exec(e);r&&(t=(i=r[1])?n[r[2]]:n[r[2]]={"#comment":{}},t=n[r[2]],Co(_o(r[3],"|"),(function(e){"-"===i?delete t[e]:t[e]={}})))}))},I=function(e){var n,i=t[e];if(i)return i;for(n=o.length;n--;)if((i=o[n]).pattern.test(e))return i};return e.valid_elements?x(e.valid_elements):(Co(s,(function(e,o){t[o]={attributes:e.attributes,attributesOrder:e.attributesOrder},n[o]=e.children})),"html5"!==e.schema&&Co(_o("strong/b em/i"),(function(e){e=_o(e,"/"),t[e[1]].outputName=e[0]})),Co(_o("ol ul sub sup blockquote span font a table tbody tr strong em b i"),(function(e){t[e]&&(t[e].removeEmpty=!0)})),Co(_o("p h1 h2 h3 h4 h5 h6 th td pre div address caption li"),(function(e){t[e].paddEmpty=!0})),Co(_o("span"),(function(e){t[e].removeEmptyAttrs=!0}))),E(e.custom_elements),_(e.valid_children),T(e.extended_valid_elements),_("+ol[ul|ol],+ul[ul|ol]"),Co({dd:"dl",dt:"dl",li:"ul ol",td:"tr",th:"tr",tr:"tbody thead tfoot",tbody:"table",thead:"table",tfoot:"table",legend:"fieldset",area:"map",param:"video audio object"},(function(e,n){t[n]&&(t[n].parentsRequired=_o(e))})),e.invalid_elements&&Co(xo(e.invalid_elements),(function(e){t[e]&&delete t[e]})),I("span")||T("span[!data-mce-type|*]"),{children:n,elements:t,getValidStyles:function(){return l},getValidClasses:function(){return c},getBlockElements:function(){return y},getInvalidStyles:function(){return u},getShortEndedElements:function(){return h},getTextBlockElements:function(){return v},getTextInlineElements:function(){return b},getBoolAttrs:function(){return g},getElementRule:I,getSelfClosingElements:function(){return f},getNonEmptyElements:function(){return m},getMoveCaretBeforeOnEnterElements:function(){return p},getWhiteSpaceElements:function(){return d},getSpecialElements:function(){return r},isValidChild:function(e,t){var o=n[e.toLowerCase()];return!(!o||!o[t.toLowerCase()])},isValid:function(e,t){var n,o,i=I(e);if(i){if(!t)return!0;if(i.attributes[t])return!0;if(n=i.attributePatterns)for(o=n.length;o--;)if(n[o].pattern.test(e))return!0}return!1},getCustomElements:function(){return i},addValidElements:T,setValidElements:x,addCustomElements:E,addValidChildren:_}}var Oo=" ",wo=function(e,t,n,o){var i=function(e){return 1<(e=parseInt(e,10).toString(16)).length?e:"0"+e};return"#"+i(t)+i(n)+i(o)},Ro=function(e,t){var n,o,i,r=/rgb\s*\(\s*([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)\s*\)/gi,a=/(?:url(?:(?:\(\s*\"([^\"]+)\"\s*\))|(?:\(\s*\'([^\']+)\'\s*\))|(?:\(\s*([^)\s]+)\s*\))))|(?:\'([^\']+)\')|(?:\"([^\"]+)\")/gi,s=/\s*([^:]+):\s*([^;]+);?/g,l=/\s+$/,u={};e=e||{},t&&(o=t.getValidStyles(),i=t.getInvalidStyles());var c="\\\" \\' \\; \\: ; : \ufeff".split(" ");for(n=0;n<c.length;n++)u[c[n]]="\ufeff"+n,u["\ufeff"+n]=c[n];return{toHex:function(e){return e.replace(r,wo)},parse:function(t){var o,i,c,d,f,h,g,m={},p=e.url_converter,v=e.url_converter_scope||this,y=function(e,t,o){var i=m[e+"-top"+t];if(i){var r=m[e+"-right"+t];if(r){var a=m[e+"-bottom"+t];if(a){var s=m[e+"-left"+t];if(s){var l=[i,r,a,s];for(n=l.length-1;n--&&l[n]===l[n+1];);-1<n&&o||(m[e+t]=-1===n?l[0]:l.join(" "),delete m[e+"-top"+t],delete m[e+"-right"+t],delete m[e+"-bottom"+t],delete m[e+"-left"+t])}}}}},b=function(e){var t,n=m[e];if(n){for(t=(n=n.split(" ")).length;t--;)if(n[t]!==n[0])return!1;return m[e]=n[0],!0}},C=function(e){return d=!0,u[e]},T=function(e,t){return d&&(e=e.replace(/\uFEFF[0-9]/g,(function(e){return u[e]}))),t||(e=e.replace(/\\([\'\";:])/g,"$1")),e},x=function(e){return String.fromCharCode(parseInt(e.slice(1),16))},E=function(e){return e.replace(/\\[0-9a-f]+/gi,x)},_=function(t,n,o,i,r,a){if(r=r||a)return"'"+(r=T(r)).replace(/\'/g,"\\'")+"'";if(n=T(n||o||i),!e.allow_script_urls){var s=n.replace(/[\s\r\n]+/g,"");if(/(java|vb)script:/i.test(s))return"";if(!e.allow_svg_data_urls&&/^data:image\/svg/i.test(s))return""}return p&&(n=p.call(v,n,"style")),"url('"+n.replace(/\'/g,"\\'")+"')"};if(t){for(t=(t=t.replace(/[\u0000-\u001F]/g,"")).replace(/\\[\"\';:\uFEFF]/g,C).replace(/\"[^\"]+\"|\'[^\']+\'/g,(function(e){return e.replace(/[;:]/g,C)}));o=s.exec(t);)if(s.lastIndex=o.index+o[0].length,i=o[1].replace(l,"").toLowerCase(),c=o[2].replace(l,""),i&&c){if(i=E(i),c=E(c),-1!==i.indexOf("\ufeff")||-1!==i.indexOf('"'))continue;if(!e.allow_script_urls&&("behavior"===i||/expression\s*\(|\/\*|\*\//.test(c)))continue;"font-weight"===i&&"700"===c?c="bold":"color"!==i&&"background-color"!==i||(c=c.toLowerCase()),c=(c=c.replace(r,wo)).replace(a,_),m[i]=d?T(c,!0):c}y("border","",!0),y("border","-width"),y("border","-color"),y("border","-style"),y("padding",""),y("margin",""),h="border-style",g="border-color",b(f="border-width")&&b(h)&&b(g)&&(m.border=m[f]+" "+m[h]+" "+m[g],delete m[f],delete m[h],delete m[g]),"medium none"===m.border&&delete m.border,"none"===m["border-image"]&&delete m["border-image"]}return m},serialize:function(e,t){var n="",r=function(t){var i,r=o[t];if(r)for(var a=0,s=r.length;a<s;a++)(i=e[t=r[a]])&&(n+=(0<n.length?" ":"")+t+": "+i+";")};return t&&o?(r("*"),r(t)):ie(e,(function(e,o){var r,a;!e||i&&(r=o,(a=i["*"])&&a[r]||(a=i[t])&&a[r])||(n+=(0<n.length?" ":"")+o+": "+e+";")})),n}}},So=/^(?:mouse|contextmenu)|click/,ko={keyLocation:1,layerX:1,layerY:1,returnValue:1,webkitMovementX:1,webkitMovementY:1,keyIdentifier:1,mozPressure:1},Ao=function(){return!1},No=function(){return!0},Mo=function(e,t,n,o){e.addEventListener?e.addEventListener(t,n,o||!1):e.attachEvent&&e.attachEvent("on"+t,n)},Ko=function(e,t,n,o){e.removeEventListener?e.removeEventListener(t,n,o||!1):e.detachEvent&&e.detachEvent("on"+t,n)},Po=function(t,n){var o,i,r=n||{};for(o in t)ko[o]||(r[o]=t[o]);if(r.target||(r.target=r.srcElement||e.document),dt.experimentalShadowDom&&(r.target=function(e,t){if(e.composedPath){var n=e.composedPath();if(n&&0<n.length)return n[0]}return t}(t,r.target)),t&&So.test(t.type)&&void 0===t.pageX&&void 0!==t.clientX){var a=r.target.ownerDocument||e.document,s=a.documentElement,l=a.body;r.pageX=t.clientX+(s&&s.scrollLeft||l&&l.scrollLeft||0)-(s&&s.clientLeft||l&&l.clientLeft||0),r.pageY=t.clientY+(s&&s.scrollTop||l&&l.scrollTop||0)-(s&&s.clientTop||l&&l.clientTop||0)}return r.preventDefault=function(){r.isDefaultPrevented=No,t&&(t.preventDefault?t.preventDefault():t.returnValue=!1)},r.stopPropagation=function(){r.isPropagationStopped=No,t&&(t.stopPropagation?t.stopPropagation():t.cancelBubble=!0)},!(r.stopImmediatePropagation=function(){r.isImmediatePropagationStopped=No,r.stopPropagation()})==((i=r).isDefaultPrevented===No||i.isDefaultPrevented===Ao)&&(r.isDefaultPrevented=Ao,r.isPropagationStopped=Ao,r.isImmediatePropagationStopped=Ao),void 0===r.metaKey&&(r.metaKey=!1),r},Lo=function(e,t,n){var o=e.document,i={type:"ready"};if(n.domLoaded)t(i);else{var r=function(){Ko(e,"DOMContentLoaded",r),Ko(e,"load",r),n.domLoaded||(n.domLoaded=!0,t(i))};"complete"===o.readyState||"interactive"===o.readyState&&o.body?r():Mo(e,"DOMContentLoaded",r),Mo(e,"load",r)}},Bo=(Fo.prototype.bind=function(t,n,o,i){var r,a,s,l,u,c,d,f=this,h=e.window,g=function(e){f.executeHandlers(Po(e||h.event),r)};if(t&&3!==t.nodeType&&8!==t.nodeType){t[f.expando]?r=t[f.expando]:(r=f.count++,t[f.expando]=r,f.events[r]={}),i=i||t;var m=n.split(" ");for(s=m.length;s--;)c=g,u=d=!1,"DOMContentLoaded"===(l=m[s])&&(l="ready"),f.domLoaded&&"ready"===l&&"complete"===t.readyState?o.call(i,Po({type:l})):(f.hasMouseEnterLeave||(u=f.mouseEnterLeave[l])&&(c=function(e){var t=e.currentTarget,n=e.relatedTarget;if(n&&t.contains)n=t.contains(n);else for(;n&&n!==t;)n=n.parentNode;n||((e=Po(e||h.event)).type="mouseout"===e.type?"mouseleave":"mouseenter",e.target=t,f.executeHandlers(e,r))}),f.hasFocusIn||"focusin"!==l&&"focusout"!==l||(d=!0,u="focusin"===l?"focus":"blur",c=function(e){(e=Po(e||h.event)).type="focus"===e.type?"focusin":"focusout",f.executeHandlers(e,r)}),(a=f.events[r][l])?"ready"===l&&f.domLoaded?o(Po({type:l})):a.push({func:o,scope:i}):(f.events[r][l]=a=[{func:o,scope:i}],a.fakeName=u,a.capture=d,a.nativeHandler=c,"ready"===l?Lo(t,c,f):Mo(t,u||l,c,d)));return t=a=0,o}},Fo.prototype.unbind=function(e,t,n){var o,i,r,a,s;if(!e||3===e.nodeType||8===e.nodeType)return this;var l=e[this.expando];if(l){if(s=this.events[l],t){var u=t.split(" ");for(i=u.length;i--;)if(o=s[a=u[i]]){if(n)for(r=o.length;r--;)if(o[r].func===n){var c=o.nativeHandler,d=o.fakeName,f=o.capture;(o=o.slice(0,r).concat(o.slice(r+1))).nativeHandler=c,o.fakeName=d,o.capture=f,s[a]=o}n&&0!==o.length||(delete s[a],Ko(e,o.fakeName||a,o.nativeHandler,o.capture))}}else ie(s,(function(t,n){Ko(e,t.fakeName||n,t.nativeHandler,t.capture)})),s={};for(a in s)if(fe(s,a))return this;delete this.events[l];try{delete e[this.expando]}catch(p){e[this.expando]=null}}return this},Fo.prototype.fire=function(e,t,n){var o;if(!e||3===e.nodeType||8===e.nodeType)return this;var i=Po(null,n);for(i.type=t,i.target=e;(o=e[this.expando])&&this.executeHandlers(i,o),(e=e.parentNode||e.ownerDocument||e.defaultView||e.parentWindow)&&!i.isPropagationStopped(););return this},Fo.prototype.clean=function(e){var t,n;if(!e||3===e.nodeType||8===e.nodeType)return this;if(e[this.expando]&&this.unbind(e),e.getElementsByTagName||(e=e.document),e&&e.getElementsByTagName)for(this.unbind(e),t=(n=e.getElementsByTagName("*")).length;t--;)(e=n[t])[this.expando]&&this.unbind(e);return this},Fo.prototype.destroy=function(){this.events={}},Fo.prototype.cancel=function(e){return e&&(e.preventDefault(),e.stopImmediatePropagation()),!1},Fo.prototype.executeHandlers=function(e,t){var n=this.events[t],o=n&&n[e.type];if(o)for(var i=0,r=o.length;i<r;i++){var a=o[i];if(a&&!1===a.func.call(a.scope,e)&&e.preventDefault(),e.isImmediatePropagationStopped())return}},Fo.Event=new Fo,Fo);function Fo(){this.domLoaded=!1,this.events={},this.count=1,this.expando="mce-data-"+(+new Date).toString(32),this.hasMouseEnterLeave="onmouseenter"in e.document.documentElement,this.hasFocusIn="onfocusin"in e.document.documentElement,this.count=1}var zo,Vo,Ho,Wo,$o,Uo,qo,jo,Go,Xo,Yo,Zo,Jo,Qo,ei,ti,ni,oi="sizzle"+-new Date,ii=e.window.document,ri=0,ai=0,si=Fi(),li=Fi(),ui=Fi(),ci=function(e,t){return e===t&&(Xo=!0),0},di="undefined",fi={}.hasOwnProperty,hi=[],gi=hi.pop,mi=hi.push,pi=hi.push,vi=hi.slice,yi=hi.indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(this[t]===e)return t;return-1},bi="[\\x20\\t\\r\\n\\f]",Ci="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",Ti="\\["+bi+"*("+Ci+")(?:"+bi+"*([*^$|!~]?=)"+bi+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+Ci+"))|)"+bi+"*\\]",xi=":("+Ci+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+Ti+")*)|.*)\\)|)",Ei=new RegExp("^"+bi+"+|((?:^|[^\\\\])(?:\\\\.)*)"+bi+"+$","g"),_i=new RegExp("^"+bi+"*,"+bi+"*"),Ii=new RegExp("^"+bi+"*([>+~]|"+bi+")"+bi+"*"),Di=new RegExp("="+bi+"*([^\\]'\"]*?)"+bi+"*\\]","g"),Oi=new RegExp(xi),wi=new RegExp("^"+Ci+"$"),Ri={ID:new RegExp("^#("+Ci+")"),CLASS:new RegExp("^\\.("+Ci+")"),TAG:new RegExp("^("+Ci+"|[*])"),ATTR:new RegExp("^"+Ti),PSEUDO:new RegExp("^"+xi),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+bi+"*(even|odd|(([+-]|)(\\d*)n|)"+bi+"*(?:([+-]|)"+bi+"*(\\d+)|))"+bi+"*\\)|)","i"),bool:new RegExp("^(?:checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped)$","i"),needsContext:new RegExp("^"+bi+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+bi+"*((?:-\\d)?\\d*)"+bi+"*\\)|)(?=[^-]|$)","i")},Si=/^(?:input|select|textarea|button)$/i,ki=/^h\d$/i,Ai=/^[^{]+\{\s*\[native \w/,Ni=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,Mi=/[+~]/,Ki=/'|\\/g,Pi=new RegExp("\\\\([\\da-f]{1,6}"+bi+"?|("+bi+")|.)","ig"),Li=function(e,t,n){var o="0x"+t-65536;return o!=o||n?t:o<0?String.fromCharCode(65536+o):String.fromCharCode(o>>10|55296,1023&o|56320)};try{pi.apply(hi=vi.call(ii.childNodes),ii.childNodes)}catch(Ix){pi={apply:hi.length?function(e,t){mi.apply(e,vi.call(t))}:function(e,t){for(var n=e.length,o=0;e[n++]=t[o++];);e.length=n-1}}}var Bi=function(e,t,n,o){var i,r,a,s,l,u,c,d,f,h;if((t?t.ownerDocument||t:ii)!==Zo&&Yo(t),n=n||[],!e||"string"!=typeof e)return n;if(1!==(s=(t=t||Zo).nodeType)&&9!==s)return[];if(Qo&&!o){if(i=Ni.exec(e))if(a=i[1]){if(9===s){if(!(r=t.getElementById(a))||!r.parentNode)return n;if(r.id===a)return n.push(r),n}else if(t.ownerDocument&&(r=t.ownerDocument.getElementById(a))&&ni(t,r)&&r.id===a)return n.push(r),n}else{if(i[2])return pi.apply(n,t.getElementsByTagName(e)),n;if((a=i[3])&&zo.getElementsByClassName)return pi.apply(n,t.getElementsByClassName(a)),n}if(zo.qsa&&(!ei||!ei.test(e))){if(d=c=oi,f=t,h=9===s&&e,1===s&&"object"!==t.nodeName.toLowerCase()){for(u=$o(e),(c=t.getAttribute("id"))?d=c.replace(Ki,"\\$&"):t.setAttribute("id",d),d="[id='"+d+"'] ",l=u.length;l--;)u[l]=d+Ui(u[l]);f=Mi.test(e)&&Wi(t.parentNode)||t,h=u.join(",")}if(h)try{return pi.apply(n,f.querySelectorAll(h)),n}catch(v){}finally{c||t.removeAttribute("id")}}}return qo(e.replace(Ei,"$1"),t,n,o)};function Fi(){var e=[];return function t(n,o){return e.push(n+" ")>Vo.cacheLength&&delete t[e.shift()],t[n+" "]=o}}function zi(e){return e[oi]=!0,e}function Vi(e,t){var n=t&&e,o=n&&1===e.nodeType&&1===t.nodeType&&(~t.sourceIndex||1<<31)-(~e.sourceIndex||1<<31);if(o)return o;if(n)for(;n=n.nextSibling;)if(n===t)return-1;return e?1:-1}function Hi(e){return zi((function(t){return t=+t,zi((function(n,o){for(var i,r=e([],n.length,t),a=r.length;a--;)n[i=r[a]]&&(n[i]=!(o[i]=n[i]))}))}))}function Wi(e){return e&&typeof e.getElementsByTagName!=di&&e}function $i(){}function Ui(e){for(var t=0,n=e.length,o="";t<n;t++)o+=e[t].value;return o}function qi(e,t,n){var o=t.dir,i=n&&"parentNode"===o,r=ai++;return t.first?function(t,n,r){for(;t=t[o];)if(1===t.nodeType||i)return e(t,n,r)}:function(t,n,a){var s,l,u=[ri,r];if(a){for(;t=t[o];)if((1===t.nodeType||i)&&e(t,n,a))return!0}else for(;t=t[o];)if(1===t.nodeType||i){if((s=(l=t[oi]||(t[oi]={}))[o])&&s[0]===ri&&s[1]===r)return u[2]=s[2];if((l[o]=u)[2]=e(t,n,a))return!0}}}function ji(e){return 1<e.length?function(t,n,o){for(var i=e.length;i--;)if(!e[i](t,n,o))return!1;return!0}:e[0]}function Gi(e,t,n,o,i){for(var r,a=[],s=0,l=e.length,u=null!=t;s<l;s++)(r=e[s])&&(n&&!n(r,o,i)||(a.push(r),u&&t.push(s)));return a}function Xi(e,t,n,o,i,r){return o&&!o[oi]&&(o=Xi(o)),i&&!i[oi]&&(i=Xi(i,r)),zi((function(r,a,s,l){var u,c,d,f=[],h=[],g=a.length,m=r||function(e,t,n){for(var o=0,i=t.length;o<i;o++)Bi(e,t[o],n);return n}(t||"*",s.nodeType?[s]:s,[]),p=!e||!r&&t?m:Gi(m,f,e,s,l),v=n?i||(r?e:g||o)?[]:a:p;if(n&&n(p,v,s,l),o)for(u=Gi(v,h),o(u,[],s,l),c=u.length;c--;)(d=u[c])&&(v[h[c]]=!(p[h[c]]=d));if(r){if(i||e){if(i){for(u=[],c=v.length;c--;)(d=v[c])&&u.push(p[c]=d);i(null,v=[],u,l)}for(c=v.length;c--;)(d=v[c])&&-1<(u=i?yi.call(r,d):f[c])&&(r[u]=!(a[u]=d))}}else v=Gi(v===a?v.splice(g,v.length):v),i?i(null,a,v,l):pi.apply(a,v)}))}function Yi(e){for(var t,n,o,i=e.length,r=Vo.relative[e[0].type],a=r||Vo.relative[" "],s=r?1:0,l=qi((function(e){return e===t}),a,!0),u=qi((function(e){return-1<yi.call(t,e)}),a,!0),c=[function(e,n,o){return!r&&(o||n!==jo)||((t=n).nodeType?l:u)(e,n,o)}];s<i;s++)if(n=Vo.relative[e[s].type])c=[qi(ji(c),n)];else{if((n=Vo.filter[e[s].type].apply(null,e[s].matches))[oi]){for(o=++s;o<i&&!Vo.relative[e[o].type];o++);return Xi(1<s&&ji(c),1<s&&Ui(e.slice(0,s-1).concat({value:" "===e[s-2].type?"*":""})).replace(Ei,"$1"),n,s<o&&Yi(e.slice(s,o)),o<i&&Yi(e=e.slice(o)),o<i&&Ui(e))}c.push(n)}return ji(c)}zo=Bi.support={},Wo=Bi.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return!!t&&"HTML"!==t.nodeName},Yo=Bi.setDocument=function(e){var t,n=e?e.ownerDocument||e:ii,o=n.defaultView;return n!==Zo&&9===n.nodeType&&n.documentElement?(Jo=(Zo=n).documentElement,Qo=!Wo(n),o&&o!==function(e){try{return e.top}catch(t){}return null}(o)&&(o.addEventListener?o.addEventListener("unload",(function(){Yo()}),!1):o.attachEvent&&o.attachEvent("onunload",(function(){Yo()}))),zo.attributes=!0,zo.getElementsByTagName=!0,zo.getElementsByClassName=Ai.test(n.getElementsByClassName),zo.getById=!0,Vo.find.ID=function(e,t){if(typeof t.getElementById!=di&&Qo){var n=t.getElementById(e);return n&&n.parentNode?[n]:[]}},Vo.filter.ID=function(e){var t=e.replace(Pi,Li);return function(e){return e.getAttribute("id")===t}},Vo.find.TAG=zo.getElementsByTagName?function(e,t){if(typeof t.getElementsByTagName!=di)return t.getElementsByTagName(e)}:function(e,t){var n,o=[],i=0,r=t.getElementsByTagName(e);if("*"!==e)return r;for(;n=r[i++];)1===n.nodeType&&o.push(n);return o},Vo.find.CLASS=zo.getElementsByClassName&&function(e,t){if(Qo)return t.getElementsByClassName(e)},ti=[],ei=[],zo.disconnectedMatch=!0,ei=ei.length&&new RegExp(ei.join("|")),ti=ti.length&&new RegExp(ti.join("|")),t=Ai.test(Jo.compareDocumentPosition),ni=t||Ai.test(Jo.contains)?function(e,t){var n=9===e.nodeType?e.documentElement:e,o=t&&t.parentNode;return e===o||!(!o||1!==o.nodeType||!(n.contains?n.contains(o):e.compareDocumentPosition&&16&e.compareDocumentPosition(o)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},ci=t?function(e,t){if(e===t)return Xo=!0,0;var o=!e.compareDocumentPosition-!t.compareDocumentPosition;return o||(1&(o=(e.ownerDocument||e)===(t.ownerDocument||t)?e.compareDocumentPosition(t):1)||!zo.sortDetached&&t.compareDocumentPosition(e)===o?e===n||e.ownerDocument===ii&&ni(ii,e)?-1:t===n||t.ownerDocument===ii&&ni(ii,t)?1:Go?yi.call(Go,e)-yi.call(Go,t):0:4&o?-1:1)}:function(e,t){if(e===t)return Xo=!0,0;var o,i=0,r=e.parentNode,a=t.parentNode,s=[e],l=[t];if(!r||!a)return e===n?-1:t===n?1:r?-1:a?1:Go?yi.call(Go,e)-yi.call(Go,t):0;if(r===a)return Vi(e,t);for(o=e;o=o.parentNode;)s.unshift(o);for(o=t;o=o.parentNode;)l.unshift(o);for(;s[i]===l[i];)i++;return i?Vi(s[i],l[i]):s[i]===ii?-1:l[i]===ii?1:0},n):Zo},Bi.matches=function(e,t){return Bi(e,null,null,t)},Bi.matchesSelector=function(e,t){if((e.ownerDocument||e)!==Zo&&Yo(e),t=t.replace(Di,"='$1']"),zo.matchesSelector&&Qo&&(!ti||!ti.test(t))&&(!ei||!ei.test(t)))try{var n=(void 0).call(e,t);if(n||zo.disconnectedMatch||e.document&&11!==e.document.nodeType)return n}catch(Ix){}return 0<Bi(t,Zo,null,[e]).length},Bi.contains=function(e,t){return(e.ownerDocument||e)!==Zo&&Yo(e),ni(e,t)},Bi.attr=function(e,t){(e.ownerDocument||e)!==Zo&&Yo(e);var n=Vo.attrHandle[t.toLowerCase()],o=n&&fi.call(Vo.attrHandle,t.toLowerCase())?n(e,t,!Qo):void 0;return void 0!==o?o:zo.attributes||!Qo?e.getAttribute(t):(o=e.getAttributeNode(t))&&o.specified?o.value:null},Bi.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},Bi.uniqueSort=function(e){var t,n=[],o=0,i=0;if(Xo=!zo.detectDuplicates,Go=!zo.sortStable&&e.slice(0),e.sort(ci),Xo){for(;t=e[i++];)t===e[i]&&(o=n.push(i));for(;o--;)e.splice(n[o],1)}return Go=null,e},Ho=Bi.getText=function(e){var t,n="",o=0,i=e.nodeType;if(i){if(1===i||9===i||11===i){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=Ho(e)}else if(3===i||4===i)return e.nodeValue}else for(;t=e[o++];)n+=Ho(t);return n},(Vo=Bi.selectors={cacheLength:50,createPseudo:zi,match:Ri,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(Pi,Li),e[3]=(e[3]||e[4]||e[5]||"").replace(Pi,Li),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||Bi.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&Bi.error(e[0]),e},PSEUDO:function(e){var t,n=!e[6]&&e[2];return Ri.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":n&&Oi.test(n)&&(t=$o(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(Pi,Li).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=si[e+" "];return t||(t=new RegExp("(^|"+bi+")"+e+"("+bi+"|$)"))&&si(e,(function(e){return t.test("string"==typeof e.className&&e.className||typeof e.getAttribute!=di&&e.getAttribute("class")||"")}))},ATTR:function(e,t,n){return function(o){var i=Bi.attr(o,e);return null==i?"!="===t:!t||(i+="","="===t?i===n:"!="===t?i!==n:"^="===t?n&&0===i.indexOf(n):"*="===t?n&&-1<i.indexOf(n):"$="===t?n&&i.slice(-n.length)===n:"~="===t?-1<(" "+i+" ").indexOf(n):"|="===t&&(i===n||i.slice(0,n.length+1)===n+"-"))}},CHILD:function(e,t,n,o,i){var r="nth"!==e.slice(0,3),a="last"!==e.slice(-4),s="of-type"===t;return 1===o&&0===i?function(e){return!!e.parentNode}:function(t,n,l){var u,c,d,f,h,g,m=r!=a?"nextSibling":"previousSibling",p=t.parentNode,v=s&&t.nodeName.toLowerCase(),y=!l&&!s;if(p){if(r){for(;m;){for(d=t;d=d[m];)if(s?d.nodeName.toLowerCase()===v:1===d.nodeType)return!1;g=m="only"===e&&!g&&"nextSibling"}return!0}if(g=[a?p.firstChild:p.lastChild],a&&y){for(h=(u=(c=p[oi]||(p[oi]={}))[e]||[])[0]===ri&&u[1],f=u[0]===ri&&u[2],d=h&&p.childNodes[h];d=++h&&d&&d[m]||(f=h=0)||g.pop();)if(1===d.nodeType&&++f&&d===t){c[e]=[ri,h,f];break}}else if(y&&(u=(t[oi]||(t[oi]={}))[e])&&u[0]===ri)f=u[1];else for(;(d=++h&&d&&d[m]||(f=h=0)||g.pop())&&((s?d.nodeName.toLowerCase()!==v:1!==d.nodeType)||!++f||(y&&((d[oi]||(d[oi]={}))[e]=[ri,f]),d!==t)););return(f-=i)===o||f%o==0&&0<=f/o}}},PSEUDO:function(e,t){var n,o=Vo.pseudos[e]||Vo.setFilters[e.toLowerCase()]||Bi.error("unsupported pseudo: "+e);return o[oi]?o(t):1<o.length?(n=[e,e,"",t],Vo.setFilters.hasOwnProperty(e.toLowerCase())?zi((function(e,n){for(var i,r=o(e,t),a=r.length;a--;)e[i=yi.call(e,r[a])]=!(n[i]=r[a])})):function(e){return o(e,0,n)}):o}},pseudos:{not:zi((function(e){var t=[],n=[],o=Uo(e.replace(Ei,"$1"));return o[oi]?zi((function(e,t,n,i){for(var r,a=o(e,null,i,[]),s=e.length;s--;)(r=a[s])&&(e[s]=!(t[s]=r))})):function(e,i,r){return t[0]=e,o(t,null,r,n),!n.pop()}})),has:zi((function(e){return function(t){return 0<Bi(e,t).length}})),contains:zi((function(e){return e=e.replace(Pi,Li),function(t){return-1<(t.textContent||t.innerText||Ho(t)).indexOf(e)}})),lang:zi((function(e){return wi.test(e||"")||Bi.error("unsupported lang: "+e),e=e.replace(Pi,Li).toLowerCase(),function(t){var n;do{if(n=Qo?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return(n=n.toLowerCase())===e||0===n.indexOf(e+"-")}while((t=t.parentNode)&&1===t.nodeType);return!1}})),target:function(t){var n=e.window.location&&e.window.location.hash;return n&&n.slice(1)===t.id},root:function(e){return e===Jo},focus:function(e){return e===Zo.activeElement&&(!Zo.hasFocus||Zo.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return!1===e.disabled},disabled:function(e){return!0===e.disabled},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return!0===e.selected},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!Vo.pseudos.empty(e)},header:function(e){return ki.test(e.nodeName)},input:function(e){return Si.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:Hi((function(){return[0]})),last:Hi((function(e,t){return[t-1]})),eq:Hi((function(e,t,n){return[n<0?n+t:n]})),even:Hi((function(e,t){for(var n=0;n<t;n+=2)e.push(n);return e})),odd:Hi((function(e,t){for(var n=1;n<t;n+=2)e.push(n);return e})),lt:Hi((function(e,t,n){for(var o=n<0?n+t:n;0<=--o;)e.push(o);return e})),gt:Hi((function(e,t,n){for(var o=n<0?n+t:n;++o<t;)e.push(o);return e}))}}).pseudos.nth=Vo.pseudos.eq,H(["radio","checkbox","file","password","image"],(function(e){Vo.pseudos[e]=function(e){return function(t){return"input"===t.nodeName.toLowerCase()&&t.type===e}}(e)})),H(["submit","reset"],(function(e){Vo.pseudos[e]=function(e){return function(t){var n=t.nodeName.toLowerCase();return("input"===n||"button"===n)&&t.type===e}}(e)})),$i.prototype=Vo.filters=Vo.pseudos,Vo.setFilters=new $i,$o=Bi.tokenize=function(e,t){var n,o,i,r,a,s,l,u=li[e+" "];if(u)return t?0:u.slice(0);for(a=e,s=[],l=Vo.preFilter;a;){for(r in n&&!(o=_i.exec(a))||(o&&(a=a.slice(o[0].length)||a),s.push(i=[])),n=!1,(o=Ii.exec(a))&&(n=o.shift(),i.push({value:n,type:o[0].replace(Ei," ")}),a=a.slice(n.length)),Vo.filter)Vo.filter.hasOwnProperty(r)&&(!(o=Ri[r].exec(a))||l[r]&&!(o=l[r](o))||(n=o.shift(),i.push({value:n,type:r,matches:o}),a=a.slice(n.length)));if(!n)break}return t?a.length:a?Bi.error(e):li(e,s).slice(0)},Uo=Bi.compile=function(e,t){var n,o=[],i=[],r=ui[e+" "];if(!r){for(n=(t=t||$o(e)).length;n--;)(r=Yi(t[n]))[oi]?o.push(r):i.push(r);(r=ui(e,function(e,t){var n=0<t.length,o=0<e.length,i=function(i,r,a,s,l){var u,c,d,f=0,h="0",g=i&&[],m=[],p=jo,v=i||o&&Vo.find.TAG("*",l),y=ri+=null==p?1:Math.random()||.1,b=v.length;for(l&&(jo=r!==Zo&&r);h!==b&&null!=(u=v[h]);h++){if(o&&u){for(c=0;d=e[c++];)if(d(u,r,a)){s.push(u);break}l&&(ri=y)}n&&((u=!d&&u)&&f--,i&&g.push(u))}if(f+=h,n&&h!==f){for(c=0;d=t[c++];)d(g,m,r,a);if(i){if(0<f)for(;h--;)g[h]||m[h]||(m[h]=gi.call(s));m=Gi(m)}pi.apply(s,m),l&&!i&&0<m.length&&1<f+t.length&&Bi.uniqueSort(s)}return l&&(ri=y,jo=p),g};return n?zi(i):i}(i,o))).selector=e}return r},qo=Bi.select=function(e,t,n,o){var i,r,a,s,l,u="function"==typeof e&&e,c=!o&&$o(e=u.selector||e);if(n=n||[],1===c.length){if(2<(r=c[0]=c[0].slice(0)).length&&"ID"===(a=r[0]).type&&zo.getById&&9===t.nodeType&&Qo&&Vo.relative[r[1].type]){if(!(t=(Vo.find.ID(a.matches[0].replace(Pi,Li),t)||[])[0]))return n;u&&(t=t.parentNode),e=e.slice(r.shift().value.length)}for(i=Ri.needsContext.test(e)?0:r.length;i--&&!Vo.relative[s=(a=r[i]).type];)if((l=Vo.find[s])&&(o=l(a.matches[0].replace(Pi,Li),Mi.test(r[0].type)&&Wi(t.parentNode)||t))){if(r.splice(i,1),!(e=o.length&&Ui(r)))return pi.apply(n,o),n;break}}return(u||Uo(e,c))(o,t,!Qo,n,Mi.test(e)&&Wi(t.parentNode)||t),n},zo.sortStable=oi.split("").sort(ci).join("")===oi,zo.detectDuplicates=!!Xo,Yo(),zo.sortDetached=!0;var Zi=e.document,Ji=Array.prototype.push,Qi=Array.prototype.slice,er=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,tr=Bo.Event,nr=pt.makeMap("children,contents,next,prev"),or=function(e){return void 0!==e},ir=function(e){return"string"==typeof e},rr=function(e,t){var n,o=(t=t||Zi).createElement("div"),i=t.createDocumentFragment();for(o.innerHTML=e;n=o.firstChild;)i.appendChild(n);return i},ar=function(e,t,n,o){var i;if(ir(t))t=rr(t,Cr(e[0]));else if(t.length&&!t.nodeType){if(t=_r.makeArray(t),o)for(i=t.length-1;0<=i;i--)ar(e,t[i],n,o);else for(i=0;i<t.length;i++)ar(e,t[i],n,o);return e}if(t.nodeType)for(i=e.length;i--;)n.call(e[i],t);return e},sr=function(e,t){return e&&t&&-1!==(" "+e.className+" ").indexOf(" "+t+" ")},lr=function(e,t,n){var o,i;return t=_r(t)[0],e.each((function(){n&&o===this.parentNode||(o=this.parentNode,i=t.cloneNode(!1),this.parentNode.insertBefore(i,this)),i.appendChild(this)})),e},ur=pt.makeMap("fillOpacity fontWeight lineHeight opacity orphans widows zIndex zoom"," "),cr=pt.makeMap("checked compact declare defer disabled ismap multiple nohref noshade nowrap readonly selected"," "),dr={for:"htmlFor",class:"className",readonly:"readOnly"},fr={float:"cssFloat"},hr={},gr={},mr=function(e,t){return new _r.fn.init(e,t)},pr=/^\s*|\s*$/g,vr=function(e){return null==e?"":(""+e).replace(pr,"")},yr=function(e,t){var n,o,i,r;if(e)if(void 0===(n=e.length)){for(o in e)if(e.hasOwnProperty(o)&&!1===t.call(r=e[o],o,r))break}else for(i=0;i<n&&!1!==t.call(r=e[i],i,r);i++);return e},br=function(e,t){var n=[];return yr(e,(function(e,o){t(o,e)&&n.push(o)})),n},Cr=function(e){return e?9===e.nodeType?e:e.ownerDocument:Zi};mr.fn=mr.prototype={constructor:mr,selector:"",context:null,length:0,init:function(t,n){var o,i,r=this;if(!t)return r;if(t.nodeType)return r.context=r[0]=t,r.length=1,r;if(n&&n.nodeType)r.context=n;else{if(n)return _r(t).attr(n);r.context=n=e.document}if(ir(t)){if(!(o="<"===(r.selector=t).charAt(0)&&">"===t.charAt(t.length-1)&&3<=t.length?[null,t,null]:er.exec(t)))return _r(n).find(t);if(o[1])for(i=rr(t,Cr(n)).firstChild;i;)Ji.call(r,i),i=i.nextSibling;else{if(!(i=Cr(n).getElementById(o[2])))return r;if(i.id!==o[2])return r.find(t);r.length=1,r[0]=i}}else this.add(t,!1);return r},toArray:function(){return pt.toArray(this)},add:function(e,t){var n,o;if(ir(e))return this.add(_r(e));if(!1!==t)for(n=_r.unique(this.toArray().concat(_r.makeArray(e))),this.length=n.length,o=0;o<n.length;o++)this[o]=n[o];else Ji.apply(this,_r.makeArray(e));return this},attr:function(e,t){var n,o=this;if("object"==typeof e)yr(e,(function(e,t){o.attr(e,t)}));else{if(!or(t)){if(o[0]&&1===o[0].nodeType){if((n=hr[e])&&n.get)return n.get(o[0],e);if(cr[e])return o.prop(e)?e:void 0;null===(t=o[0].getAttribute(e,2))&&(t=void 0)}return t}this.each((function(){var n;if(1===this.nodeType){if((n=hr[e])&&n.set)return void n.set(this,t);null===t?this.removeAttribute(e,2):this.setAttribute(e,t,2)}}))}return o},removeAttr:function(e){return this.attr(e,null)},prop:function(e,t){var n=this;if("object"==typeof(e=dr[e]||e))yr(e,(function(e,t){n.prop(e,t)}));else{if(!or(t))return n[0]&&n[0].nodeType&&e in n[0]?n[0][e]:t;this.each((function(){1===this.nodeType&&(this[e]=t)}))}return n},css:function(e,t){var n,o,i=this,r=function(e){return e.replace(/-(\D)/g,(function(e,t){return t.toUpperCase()}))},s=function(e){return e.replace(/[A-Z]/g,(function(e){return"-"+e}))};if("object"==typeof e)yr(e,(function(e,t){i.css(e,t)}));else if(or(t))e=r(e),"number"!=typeof t||ur[e]||(t=t.toString()+"px"),i.each((function(){var n=this.style;if((o=gr[e])&&o.set)o.set(this,t);else{try{this.style[fr[e]||e]=t}catch(r){}null!==t&&""!==t||(n.removeProperty?n.removeProperty(s(e)):n.removeAttribute(e))}}));else{if(n=i[0],(o=gr[e])&&o.get)return o.get(n);if(!n.ownerDocument.defaultView)return n.currentStyle?n.currentStyle[r(e)]:"";try{return n.ownerDocument.defaultView.getComputedStyle(n,null).getPropertyValue(s(e))}catch(a){return}}return i},remove:function(){for(var e,t=this.length;t--;)tr.clean(e=this[t]),e.parentNode&&e.parentNode.removeChild(e);return this},empty:function(){for(var e,t=this.length;t--;)for(e=this[t];e.firstChild;)e.removeChild(e.firstChild);return this},html:function(e){var t;if(or(e)){t=this.length;try{for(;t--;)this[t].innerHTML=e}catch(g){_r(this[t]).empty().append(e)}return this}return this[0]?this[0].innerHTML:""},text:function(e){var t;if(or(e)){for(t=this.length;t--;)"innerText"in this[t]?this[t].innerText=e:this[0].textContent=e;return this}return this[0]?this[0].innerText||this[0].textContent:""},append:function(){return ar(this,arguments,(function(e){(1===this.nodeType||this.host&&1===this.host.nodeType)&&this.appendChild(e)}))},prepend:function(){return ar(this,arguments,(function(e){(1===this.nodeType||this.host&&1===this.host.nodeType)&&this.insertBefore(e,this.firstChild)}),!0)},before:function(){return this[0]&&this[0].parentNode?ar(this,arguments,(function(e){this.parentNode.insertBefore(e,this)})):this},after:function(){return this[0]&&this[0].parentNode?ar(this,arguments,(function(e){this.parentNode.insertBefore(e,this.nextSibling)}),!0):this},appendTo:function(e){return _r(e).append(this),this},prependTo:function(e){return _r(e).prepend(this),this},replaceWith:function(e){return this.before(e).remove()},wrap:function(e){return lr(this,e)},wrapAll:function(e){return lr(this,e,!0)},wrapInner:function(e){return this.each((function(){_r(this).contents().wrapAll(e)})),this},unwrap:function(){return this.parent().each((function(){_r(this).replaceWith(this.childNodes)}))},clone:function(){var e=[];return this.each((function(){e.push(this.cloneNode(!0))})),_r(e)},addClass:function(e){return this.toggleClass(e,!0)},removeClass:function(e){return this.toggleClass(e,!1)},toggleClass:function(e,t){var n=this;return"string"!=typeof e||(-1!==e.indexOf(" ")?yr(e.split(" "),(function(){n.toggleClass(this,t)})):n.each((function(n,o){var i=sr(o,e);if(i!==t){var r=o.className;i?o.className=vr((" "+r+" ").replace(" "+e+" "," ")):o.className+=r?" "+e:e}}))),n},hasClass:function(e){return sr(this[0],e)},each:function(e){return yr(this,e)},on:function(e,t){return this.each((function(){tr.bind(this,e,t)}))},off:function(e,t){return this.each((function(){tr.unbind(this,e,t)}))},trigger:function(e){return this.each((function(){"object"==typeof e?tr.fire(this,e.type,e):tr.fire(this,e)}))},show:function(){return this.css("display","")},hide:function(){return this.css("display","none")},slice:function(){return new _r(Qi.apply(this,arguments))},eq:function(e){return-1===e?this.slice(e):this.slice(e,+e+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},find:function(e){var t,n,o=[];for(t=0,n=this.length;t<n;t++)_r.find(e,this[t],o);return _r(o)},filter:function(e){return _r("function"==typeof e?br(this.toArray(),(function(t,n){return e(n,t)})):_r.filter(e,this.toArray()))},closest:function(e){var t=[];return e instanceof _r&&(e=e[0]),this.each((function(n,o){for(;o;){if("string"==typeof e&&_r(o).is(e)){t.push(o);break}if(o===e){t.push(o);break}o=o.parentNode}})),_r(t)},offset:function(e){var t,n,o,i,r=0,a=0;return e?this.css(e):((t=this[0])&&(o=(n=t.ownerDocument).documentElement,t.getBoundingClientRect&&(r=(i=t.getBoundingClientRect()).left+(o.scrollLeft||n.body.scrollLeft)-o.clientLeft,a=i.top+(o.scrollTop||n.body.scrollTop)-o.clientTop)),{left:r,top:a})},push:Ji,sort:Array.prototype.sort,splice:Array.prototype.splice},pt.extend(mr,{extend:pt.extend,makeArray:function(e){return(t=e)&&t===t.window||e.nodeType?[e]:pt.toArray(e);var t},inArray:function(e,t){var n;if(t.indexOf)return t.indexOf(e);for(n=t.length;n--;)if(t[n]===e)return n;return-1},isArray:pt.isArray,each:yr,trim:vr,grep:br,find:Bi,expr:Bi.selectors,unique:Bi.uniqueSort,text:Bi.getText,contains:Bi.contains,filter:function(e,t,n){var o=t.length;for(n&&(e=":not("+e+")");o--;)1!==t[o].nodeType&&t.splice(o,1);return 1===t.length?_r.find.matchesSelector(t[0],e)?[t[0]]:[]:_r.find.matches(e,t)}});var Tr=function(e,t,n){var o=[],i=e[t];for("string"!=typeof n&&n instanceof _r&&(n=n[0]);i&&9!==i.nodeType;){if(void 0!==n){if(i===n)break;if("string"==typeof n&&_r(i).is(n))break}1===i.nodeType&&o.push(i),i=i[t]}return o},xr=function(e,t,n,o){var i=[];for(o instanceof _r&&(o=o[0]);e;e=e[t])if(!n||e.nodeType===n){if(void 0!==o){if(e===o)break;if("string"==typeof o&&_r(e).is(o))break}i.push(e)}return i},Er=function(e,t,n){for(e=e[t];e;e=e[t])if(e.nodeType===n)return e;return null};yr({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return Tr(e,"parentNode")},next:function(e){return Er(e,"nextSibling",1)},prev:function(e){return Er(e,"previousSibling",1)},children:function(e){return xr(e.firstChild,"nextSibling",1)},contents:function(e){return pt.toArray(("iframe"===e.nodeName?e.contentDocument||e.contentWindow.document:e).childNodes)}},(function(e,t){mr.fn[e]=function(n){var o=[];this.each((function(){var e=t.call(o,this,n,o);e&&(_r.isArray(e)?o.push.apply(o,e):o.push(e))})),1<this.length&&(nr[e]||(o=_r.unique(o)),0===e.indexOf("parents")&&(o=o.reverse()));var i=_r(o);return n?i.filter(n):i}})),yr({parentsUntil:function(e,t){return Tr(e,"parentNode",t)},nextUntil:function(e,t){return xr(e,"nextSibling",1,t).slice(1)},prevUntil:function(e,t){return xr(e,"previousSibling",1,t).slice(1)}},(function(e,t){mr.fn[e]=function(n,o){var i=[];this.each((function(){var e=t.call(i,this,n,i);e&&(_r.isArray(e)?i.push.apply(i,e):i.push(e))})),1<this.length&&(i=_r.unique(i),0!==e.indexOf("parents")&&"prevUntil"!==e||(i=i.reverse()));var r=_r(i);return o?r.filter(o):r}})),mr.fn.is=function(e){return!!e&&0<this.filter(e).length},mr.fn.init.prototype=mr.fn,mr.overrideDefaults=function(e){var t,n=function(o,i){return t=t||e(),0===arguments.length&&(o=t.element),new n.fn.init(o,i=i||t.context)};return _r.extend(n,this),n},mr.attrHooks=hr,mr.cssHooks=gr;var _r=mr,Ir=(Dr.prototype.current=function(){return this.node},Dr.prototype.next=function(e){return this.node=this.findSibling(this.node,"firstChild","nextSibling",e),this.node},Dr.prototype.prev=function(e){return this.node=this.findSibling(this.node,"lastChild","previousSibling",e),this.node},Dr.prototype.prev2=function(e){return this.node=this.findPreviousNode(this.node,"lastChild","previousSibling",e),this.node},Dr.prototype.findSibling=function(e,t,n,o){var i,r;if(e){if(!o&&e[t])return e[t];if(e!==this.rootNode){if(i=e[n])return i;for(r=e.parentNode;r&&r!==this.rootNode;r=r.parentNode)if(i=r[n])return i}}},Dr.prototype.findPreviousNode=function(e,t,n,o){var i,r,a;if(e){if(i=e[n],this.rootNode&&i===this.rootNode)return;if(i){if(!o)for(a=i[t];a;a=a[t])if(!a[t])return a;return i}if((r=e.parentNode)&&r!==this.rootNode)return r}},Dr);function Dr(e,t){this.node=e,this.rootNode=t,this.current=this.current.bind(this),this.next=this.next.bind(this),this.prev=this.prev.bind(this),this.prev2=this.prev2.bind(this)}var Or,wr,Rr={},Sr={exports:Rr};Or=Rr,wr=Sr,function(e){"object"==typeof Or&&void 0!==wr?wr.exports=e():("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).EphoxContactWrapper=e()}((function(){return function e(t,n,o){function i(a,s){if(!n[a]){if(!t[a]){if(r)return r(a,!0);var l=new Error("Cannot find module '"+a+"'");throw l.code="MODULE_NOT_FOUND",l}var u=n[a]={exports:{}};t[a][0].call(u.exports,(function(e){return i(t[a][1][e]||e)}),u,u.exports,e,t,n,o)}return n[a].exports}for(var r=!1,a=0;a<o.length;a++)i(o[a]);return i}({1:[function(e,t,n){var o,i,r=t.exports={};function a(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function l(e){if(o===setTimeout)return setTimeout(e,0);if((o===a||!o)&&setTimeout)return o=setTimeout,setTimeout(e,0);try{return o(e,0)}catch(Ix){try{return o.call(null,e,0)}catch(Ix){return o.call(this,e,0)}}}!function(){try{o="function"==typeof setTimeout?setTimeout:a}catch(Ix){o=a}try{i="function"==typeof clearTimeout?clearTimeout:s}catch(Ix){i=s}}();var u,c=[],d=!1,f=-1;function h(){d&&u&&(d=!1,u.length?c=u.concat(c):f=-1,c.length&&g())}function g(){if(!d){var e=l(h);d=!0;for(var t=c.length;t;){for(u=c,c=[];++f<t;)u&&u[f].run();f=-1,t=c.length}u=null,d=!1,function(e){if(i===clearTimeout)return clearTimeout(e);if((i===s||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(e);try{i(e)}catch(Ix){try{return i.call(null,e)}catch(Ix){return i.call(this,e)}}}(e)}}function m(e,t){this.fun=e,this.array=t}function p(){}r.nextTick=function(e){var t=new Array(arguments.length-1);if(1<arguments.length)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];c.push(new m(e,t)),1!==c.length||d||l(g)},m.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=p,r.addListener=p,r.once=p,r.off=p,r.removeListener=p,r.removeAllListeners=p,r.emit=p,r.prependListener=p,r.prependOnceListener=p,r.listeners=function(e){return[]},r.binding=function(e){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},{}],2:[function(e,t,n){(function(e){function n(){}function o(e){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],u(e,this)}function i(e,t){for(;3===e._state;)e=e._value;0!==e._state?(e._handled=!0,o._immediateFn((function(){var n=1===e._state?t.onFulfilled:t.onRejected;if(null!==n){var o;try{o=n(e._value)}catch(Ix){return void a(t.promise,Ix)}r(t.promise,o)}else(1===e._state?r:a)(t.promise,e._value)}))):e._deferreds.push(t)}function r(e,t){try{if(t===e)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"==typeof t||"function"==typeof t)){var n=t.then;if(t instanceof o)return e._state=3,e._value=t,void s(e);if("function"==typeof n)return void u(function(e,t){return function(){e.apply(t,arguments)}}(n,t),e)}e._state=1,e._value=t,s(e)}catch(Ix){a(e,Ix)}}function a(e,t){e._state=2,e._value=t,s(e)}function s(e){2===e._state&&0===e._deferreds.length&&o._immediateFn((function(){e._handled||o._unhandledRejectionFn(e._value)}));for(var t=0,n=e._deferreds.length;t<n;t++)i(e,e._deferreds[t]);e._deferreds=null}function l(e,t,n){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.promise=n}function u(e,t){var o=!1;try{e((function(e){o||(o=!0,r(t,e))}),(function(e){o||(o=!0,a(t,e))}))}catch(n){if(o)return;o=!0,a(t,n)}}var c;c=setTimeout,o.prototype.catch=function(e){return this.then(null,e)},o.prototype.then=function(e,t){var o=new this.constructor(n);return i(this,new l(e,t,o)),o},o.all=function(e){var t=Array.prototype.slice.call(e);return new o((function(e,o){if(0===t.length)return e([]);var i=t.length;function r(a,s){try{if(s&&("object"==typeof s||"function"==typeof s)){var l=s.then;if("function"==typeof l)return void l.call(s,(function(e){r(a,e)}),o)}t[a]=s,0==--i&&e(t)}catch(n){o(n)}}for(var a=0;a<t.length;a++)r(a,t[a])}))},o.resolve=function(e){return e&&"object"==typeof e&&e.constructor===o?e:new o((function(t){t(e)}))},o.reject=function(e){return new o((function(t,n){n(e)}))},o.race=function(e){return new o((function(t,n){for(var o=0,i=e.length;o<i;o++)e[o].then(t,n)}))},o._immediateFn="function"==typeof e?function(t){e(t)}:function(e){c(e,0)},o._unhandledRejectionFn=function(e){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",e)},o._setImmediateFn=function(e){o._immediateFn=e},o._setUnhandledRejectionFn=function(e){o._unhandledRejectionFn=e},void 0!==t&&t.exports?t.exports=o:this.Promise||(this.Promise=o)}).call(this,e("timers").setImmediate)},{timers:3}],3:[function(e,t,n){(function(t,o){var i=e("process/browser.js").nextTick,r=Function.prototype.apply,a=Array.prototype.slice,s={},l=0;function u(e,t){this._id=e,this._clearFn=t}n.setTimeout=function(){return new u(r.call(setTimeout,window,arguments),clearTimeout)},n.setInterval=function(){return new u(r.call(setInterval,window,arguments),clearInterval)},n.clearTimeout=n.clearInterval=function(e){e.close()},u.prototype.unref=u.prototype.ref=function(){},u.prototype.close=function(){this._clearFn.call(window,this._id)},n.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},n.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},n._unrefActive=n.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;0<=t&&(e._idleTimeoutId=setTimeout((function(){e._onTimeout&&e._onTimeout()}),t))},n.setImmediate="function"==typeof t?t:function(e){var t=l++,o=!(arguments.length<2)&&a.call(arguments,1);return s[t]=!0,i((function(){s[t]&&(o?e.apply(null,o):e.call(null),n.clearImmediate(t))})),t},n.clearImmediate="function"==typeof o?o:function(e){delete s[e]}}).call(this,e("timers").setImmediate,e("timers").clearImmediate)},{"process/browser.js":1,timers:3}],4:[function(e,t,n){var o=e("promise-polyfill"),i="undefined"!=typeof window?window:Function("return this;")();t.exports={boltExport:i.Promise||o}},{"promise-polyfill":2}]},{},[4])(4)}));var kr,Ar,Nr,Mr,Kr=Sr.exports.boltExport,Pr=function(t){var n=E.none(),o=[],i=function(e){r()?a(e):o.push(e)},r=function(){return n.isSome()},a=function(t){n.each((function(n){e.setTimeout((function(){t(n)}),0)}))};return t((function(e){r()||(n=E.some(e),function(e){H(e,a)}(o),o=[])})),{get:i,map:function(e){return Pr((function(t){i((function(n){t(e(n))}))}))},isReady:r}},Lr={nu:Pr,pure:function(e){return Pr((function(t){t(e)}))}},Br=function(t){e.setTimeout((function(){throw t}),0)},Fr=function(e){var t=function(t){e().then(t,Br)};return{map:function(t){return Fr((function(){return e().then(t)}))},bind:function(t){return Fr((function(){return e().then((function(e){return t(e).toPromise()}))}))},anonBind:function(t){return Fr((function(){return e().then((function(){return t.toPromise()}))}))},toLazy:function(){return Lr.nu(t)},toCached:function(){var t=null;return Fr((function(){return null===t&&(t=e()),t}))},toPromise:e,get:t}},zr=function(e){return Fr((function(){return new Kr(e)}))},Vr=function(e){return{is:function(t){return e===t},isValue:b,isError:y,getOr:c(e),getOrThunk:c(e),getOrDie:c(e),or:function(t){return Vr(e)},orThunk:function(t){return Vr(e)},fold:function(t,n){return n(e)},map:function(t){return Vr(t(e))},mapError:function(t){return Vr(e)},each:function(t){t(e)},bind:function(t){return t(e)},exists:function(t){return t(e)},forall:function(t){return t(e)},toOption:function(){return E.some(e)}}},Hr=function(e){return{is:y,isValue:y,isError:b,getOr:d,getOrThunk:function(e){return e()},getOrDie:function(){return v(String(e))()},or:function(e){return e},orThunk:function(e){return e()},fold:function(t,n){return t(e)},map:function(t){return Hr(e)},mapError:function(t){return Hr(t(e))},each:l,bind:function(t){return Hr(e)},exists:y,forall:b,toOption:E.none}},Wr={value:Vr,error:Hr,fromOption:function(e,t){return e.fold((function(){return Hr(t)}),Vr)}},$r=function(t){if(!R(t))throw new Error("cases must be an array");if(0===t.length)throw new Error("there must be at least one case");var n=[],o={};return H(t,(function(i,r){var a=ne(i);if(1!==a.length)throw new Error("one and only one name per case");var s=a[0],l=i[s];if(void 0!==o[s])throw new Error("duplicate key detected:"+s);if("cata"===s)throw new Error("cannot have a case named cata (sorry)");if(!R(l))throw new Error("case arguments must be an array");n.push(s),o[s]=function(){var o=arguments.length;if(o!==l.length)throw new Error("Wrong number of arguments to case "+s+". Expected "+l.length+" ("+l+"), got "+o);for(var i=new Array(o),a=0;a<i.length;a++)i[a]=arguments[a];return{fold:function(){if(arguments.length!==t.length)throw new Error("Wrong number of arguments to fold. Expected "+t.length+", got "+arguments.length);return arguments[r].apply(null,i)},match:function(e){var t=ne(e);if(n.length!==t.length)throw new Error("Wrong number of arguments to match. Expected: "+n.join(",")+"\nActual: "+t.join(","));if(!Y(n,(function(e){return F(t,e)})))throw new Error("Not all branches were specified when using match. Specified: "+t.join(", ")+"\nRequired: "+n.join(", "));return e[s].apply(null,i)},log:function(t){e.console.log(t,{constructors:n,constructor:s,params:i})}}}})),o},Ur=($r([{bothErrors:["error1","error2"]},{firstError:["error1","value2"]},{secondError:["value1","error2"]},{bothValues:["value1","value2"]}]),function(e){return e.fold(d,d)}),qr=window.Promise?window.Promise:(kr=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},Nr=(Ar=function(e){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=null,this._value=null,this._deferreds=[],Qr(e,jr(Xr,this),jr(Yr,this))}).immediateFn||"function"==typeof e.setImmediate&&e.setImmediate||function(t){e.setTimeout(t,1)},Ar.prototype.catch=function(e){return this.then(null,e)},Ar.prototype.then=function(e,t){var n=this;return new Ar((function(o,i){Gr.call(n,new Jr(e,t,o,i))}))},Ar.all=function(){var e=Array.prototype.slice.call(1===arguments.length&&kr(arguments[0])?arguments[0]:arguments);return new Ar((function(n,o){if(0===e.length)return n([]);var i=e.length;function r(a,s){try{if(s&&("object"==typeof s||"function"==typeof s)){var l=s.then;if("function"==typeof l)return void l.call(s,(function(e){r(a,e)}),o)}e[a]=s,0==--i&&n(e)}catch(t){o(t)}}for(var a=0;a<e.length;a++)r(a,e[a])}))},Ar.resolve=function(e){return e&&"object"==typeof e&&e.constructor===Ar?e:new Ar((function(t){t(e)}))},Ar.reject=function(e){return new Ar((function(t,n){n(e)}))},Ar.race=function(e){return new Ar((function(t,n){for(var o=0,i=e.length;o<i;o++)e[o].then(t,n)}))},Ar);function jr(e,t){return function(){e.apply(t,arguments)}}function Gr(e){var t=this;null!==this._state?Nr((function(){var n=t._state?e.onFulfilled:e.onRejected;if(null!==n){var o;try{o=n(t._value)}catch(Ix){return void e.reject(Ix)}e.resolve(o)}else(t._state?e.resolve:e.reject)(t._value)})):this._deferreds.push(e)}function Xr(e){try{if(e===this)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"==typeof e||"function"==typeof e)){var t=e.then;if("function"==typeof t)return void Qr(jr(t,e),jr(Xr,this),jr(Yr,this))}this._state=!0,this._value=e,Zr.call(this)}catch(Ix){Yr.call(this,Ix)}}function Yr(e){this._state=!1,this._value=e,Zr.call(this)}function Zr(){for(var e=0,t=this._deferreds.length;e<t;e++)Gr.call(this,this._deferreds[e]);this._deferreds=null}function Jr(e,t,n,o){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.resolve=n,this.reject=o}function Qr(e,t,n){var o=!1;try{e((function(e){o||(o=!0,t(e))}),(function(e){o||(o=!0,n(e))}))}catch(d){if(o)return;o=!0,n(d)}}var ea=function(t,n){return"number"!=typeof n&&(n=0),e.setTimeout(t,n)},ta=function(t,n){return"number"!=typeof n&&(n=1),e.setInterval(t,n)},na=function(t,n){var o,i=function(){for(var i=[],r=0;r<arguments.length;r++)i[r]=arguments[r];e.clearTimeout(o),o=ea((function(){t.apply(this,i)}),n)};return i.stop=function(){e.clearTimeout(o)},i},oa={requestAnimationFrame:function(t,n){Mr?Mr.then(t):Mr=new qr((function(t){!function(t,n){var o,i=e.window.requestAnimationFrame,r=["ms","moz","webkit"];for(o=0;o<r.length&&!i;o++)i=e.window[r[o]+"RequestAnimationFrame"];(i=i||function(t){e.window.setTimeout(t,0)})(t,n)}(t,n=n||e.document.body)})).then(t)},setTimeout:ea,setInterval:ta,setEditorTimeout:function(e,t,n){return ea((function(){e.removed||t()}),n)},setEditorInterval:function(t,n,o){var i=ta((function(){t.removed?e.clearInterval(i):n()}),o);return i},debounce:na,throttle:na,clearInterval:function(t){return e.clearInterval(t)},clearTimeout:function(t){return e.clearTimeout(t)}};function ia(t,n){void 0===n&&(n={});var o=0,i={},r=yt.fromDom(t),a=At(r),s=n.maxLoadTime||5e3,l=function(e){Gt(function(e){return Ht(e)?e:function(e){var t=e.dom().head;if(null==t)throw new Error("Head is not available yet");return yt.fromDom(t)}(At(e))}(r),e)},d=function(r,u,c){var d,f,h,g=function(e){h.status=e,h.passed=[],h.failed=[],d&&(d.onload=null,d.onerror=null,d=null)},m=function(){for(var e=h.passed,t=e.length;t--;)e[t]();g(2)},p=function(){for(var e=h.failed,t=e.length;t--;)e[t]();g(3)},v=function(e,t){e()||((new Date).getTime()-T<s?oa.setTimeout(t):p())},y=function(){v((function(){for(var e,n,o=t.styleSheets,i=o.length;i--;)if((n=(e=o[i]).ownerNode?e.ownerNode:e.owningElement)&&n.id===d.id)return m(),1}),y)},b=function(){v((function(){try{var e=f.sheet.cssRules;return m(),e}catch(u){}}),b)};if(r=pt._addCacheSuffix(r),i[r]?h=i[r]:i[r]=h={passed:[],failed:[]},u&&h.passed.push(u),c&&h.failed.push(c),1!==h.status)if(2!==h.status)if(3!==h.status){h.status=1,(d=a.dom().createElement("link")).rel="stylesheet",d.type="text/css",d.id="u"+o++,d.async=!1,d.defer=!1;var C,T=(new Date).getTime();if(n.contentCssCors&&(d.crossOrigin="anonymous"),n.referrerPolicy&&Rn(yt.fromDom(d),"referrerpolicy",n.referrerPolicy),!("onload"in d)||(C=e.navigator.userAgent.match(/WebKit\/(\d*)/))&&parseInt(C[1],10)<536){if(0<e.navigator.userAgent.indexOf("Firefox"))return(f=a.dom().createElement("style")).textContent='@import "'+r+'"',b(),void l(yt.fromDom(f));y()}else d.onload=y,d.onerror=p;l(yt.fromDom(d)),d.href=r}else p();else m()},f=function(e){return zr((function(t){d(e,u(t,c(Wr.value(e))),u(t,c(Wr.error(e))))}))};return{load:d,loadAll:function(e,t,n){(function(e,t){return t((function(t){var n=[],o=0;0===e.length?t([]):H(e,(function(i,r){var a;i.get((a=r,function(i){n[a]=i,++o>=e.length&&t(n)}))}))}))})(V(e,f),zr).get((function(e){var o=function(e,t){for(var n=[],o=[],i=0,r=e.length;i<r;i++){var a=e[i];(t(a)?n:o).push(a)}return{pass:n,fail:o}}(e,(function(e){return e.isValue()}));0<o.fail.length?n(o.fail.map(Ur)):t(o.pass.map(Ur))}))},_setReferrerPolicy:function(e){n.referrerPolicy=e}}}var ra,aa,sa=(ra=new WeakMap,{forElement:function(e,t){var n=Wt(e).dom();return E.from(ra.get(n)).getOrThunk((function(){var e=ia(n,t);return ra.set(n,e),e}))}}),la=pt.each,ua=pt.grep,ca=dt.ie,da=/^([a-z0-9],?)+$/i,fa=function(e,t){var n=t.attr("style"),o=e.serialize(e.parse(n),t[0].nodeName);t.attr("data-mce-style",o=o||null)},ha=function(e,t){var n,o,i=0;if(e)for(n=e.nodeType,e=e.previousSibling;e;e=e.previousSibling)o=e.nodeType,(!t||3!==o||o!==n&&e.nodeValue.length)&&(i++,n=o);return i};function ga(t,n){var o=this;void 0===n&&(n={});var i={},r=e.window,a={},s=0,l=sa.forElement(yt.fromDom(t),{contentCssCors:n.contentCssCors,referrerPolicy:n.referrerPolicy}),u=[],c=n.schema?n.schema:Do({}),d=Ro({url_converter:n.url_converter,url_converter_scope:n.url_converter_scope},n.schema),f=n.ownEvents?new Bo:Bo.Event,h=c.getBlockElements(),g=_r.overrideDefaults((function(){return{context:t,element:H.getRoot()}})),m=function(e){return e&&t&&O(e)?t.getElementById(e):e},p=function(e){return g("string"==typeof e?m(e):e)},v=function(e,t,n){var o,i,r=p(e);return r.length&&(i=(o=W[t])&&o.get?o.get(r,t):r.attr(t)),void 0===i&&(i=n||""),i},y=function(e){var t=m(e);return t?t.attributes:[]},b=function(e,t,o){""===o&&(o=null);var i=p(e),r=i.attr(t);if(i.length){var a=W[t];a&&a.set?a.set(i,o,t):i.attr(t,o),r!==o&&n.onSetAttrib&&n.onSetAttrib({attrElm:i,attrName:t,attrValue:o})}},C=function(){return n.root_element||t.body},T=function(e,n){return function(e,t,n){var o,i,r,a=0,s=0,l=e.ownerDocument;if(n=n||e,t){if(n===e&&t.getBoundingClientRect&&"static"===Nn(yt.fromDom(e),"position"))return{x:a=(i=t.getBoundingClientRect()).left+(l.documentElement.scrollLeft||e.scrollLeft)-l.documentElement.clientLeft,y:s=i.top+(l.documentElement.scrollTop||e.scrollTop)-l.documentElement.clientTop};for(o=t;o&&o!==n&&o.nodeType&&!Fn(o,n);)a+=o.offsetLeft||0,s+=o.offsetTop||0,o=o.offsetParent;for(o=t.parentNode;o&&o!==n&&o.nodeType&&!Fn(o,n);)a-=o.scrollLeft||0,s-=o.scrollTop||0,o=o.parentNode;s+=(r=yt.fromDom(t),Ln.isFirefox()&&"table"===bt(r)?Bn(Bt(r)).filter((function(e){return"caption"===bt(e)})).bind((function(e){return Bn(Lt(e)).map((function(t){var n=t.dom().offsetTop,o=e.dom().offsetTop,i=e.dom().offsetHeight;return n<=o?-i:0}))})).getOr(0):0)}return{x:a,y:s}}(t.body,m(e),n)},x=function(e,t,n){var o=p(e);return n?o.css(t):("float"===(t=t.replace(/-(\D)/g,(function(e,t){return t.toUpperCase()})))&&(t=dt.browser.isIE()?"styleFloat":"cssFloat"),o[0]&&o[0].style?o[0].style[t]:void 0)},E=function(e){var t,n;return e=m(e),t=x(e,"width"),n=x(e,"height"),-1===t.indexOf("px")&&(t=0),-1===n.indexOf("px")&&(n=0),{w:parseInt(t,10)||e.offsetWidth||e.clientWidth,h:parseInt(n,10)||e.offsetHeight||e.clientHeight}},_=function(e,t){var n;if(!e)return!1;if(!Array.isArray(e)){if("*"===t)return 1===e.nodeType;if(da.test(t)){var o=t.toLowerCase().split(/,/),i=e.nodeName.toLowerCase();for(n=o.length-1;0<=n;n--)if(o[n]===i)return!0;return!1}if(e.nodeType&&1!==e.nodeType)return!1}var r=Array.isArray(e)?e:[e];return 0<Bi(t,r[0].ownerDocument||r[0],null,r).length},I=function(e,t,n,o){var i,r=[],a=m(e);for(o=void 0===o,n=n||("BODY"!==C().nodeName?C().parentNode:null),pt.is(t,"string")&&(t="*"===(i=t)?function(e){return 1===e.nodeType}:function(e){return _(e,i)});a&&a!==n&&a.nodeType&&9!==a.nodeType;){if(!t||"function"==typeof t&&t(a)){if(!o)return[a];r.push(a)}a=a.parentNode}return o?r:null},D=function(e,t,n){var o=t;if(e)for("string"==typeof t&&(o=function(e){return _(e,t)}),e=e[n];e;e=e[n])if("function"==typeof o&&o(e))return e;return null},w=function(e,t,n){var i,r="string"==typeof e?m(e):e;return!!r&&(pt.isArray(r)&&(r.length||0===r.length)?(i=[],la(r,(function(e,o){e&&("string"==typeof e&&(e=m(e)),i.push(t.call(n,e,o)))})),i):t.call(n||o,r))},R=function(e,t){p(e).each((function(e,n){la(t,(function(e,t){b(n,t,e)}))}))},S=function(e,t){var n=p(e);ca?n.each((function(e,n){if(!1!==n.canHaveHTML){for(;n.firstChild;)n.removeChild(n.firstChild);try{n.innerHTML="<br>"+t,n.removeChild(n.firstChild)}catch(h){_r("<div></div>").html("<br>"+t).contents().slice(1).appendTo(n)}return t}})):n.html(t)},k=function(e,n,o,i,r){return w(e,(function(e){var a="string"==typeof n?t.createElement(n):n;return R(a,o),i&&("string"!=typeof i&&i.nodeType?a.appendChild(i):"string"==typeof i&&S(a,i)),r?a:e.appendChild(a)}))},A=function(e,n,o){return k(t.createElement(e),e,n,o,!0)},N=po.encodeAllRaw,M=function(e,t){var n=p(e);return t?n.each((function(){for(var e;e=this.firstChild;)3===e.nodeType&&0===e.data.length?this.removeChild(e):this.parentNode.insertBefore(e,this)})).remove():n.remove(),1<n.length?n.toArray():n[0]},K=function(e,t,n){p(e).toggleClass(t,n).each((function(){""===this.className&&_r(this).attr("class",null)}))},P=function(e,t,n){return w(t,(function(t){return pt.is(t,"array")&&(e=e.cloneNode(!0)),n&&la(ua(t.childNodes),(function(t){e.appendChild(t)})),t.parentNode.replaceChild(e,t)}))},L=function(e){if(fn(e)){var t="a"===e.nodeName.toLowerCase()&&!v(e,"href")&&v(e,"id");if(v(e,"name")||v(e,"data-mce-bookmark")||t)return!0}return!1},B=function(){return t.createRange()},F=function(e,o,i,a){if(pt.isArray(e)){for(var s=e.length,l=[];s--;)l[s]=F(e[s],o,i,a);return l}return!n.collect||e!==t&&e!==r||u.push([e,o,i,a]),f.bind(e,o,i,a||H)},z=function(e,n,o){var i;if(pt.isArray(e)){i=e.length;for(var a=[];i--;)a[i]=z(e[i],n,o);return a}if(0<u.length&&(e===t||e===r))for(i=u.length;i--;){var s=u[i];e!==s[0]||n&&n!==s[1]||o&&o!==s[2]||f.unbind(s[0],s[1],s[2])}return f.unbind(e,n,o)},V=function(e){if(e&&fn(e)){var t=e.getAttribute("data-mce-contenteditable");return t&&"inherit"!==t?t:"inherit"!==e.contentEditable?e.contentEditable:null}return null},H={doc:t,settings:n,win:r,files:a,stdMode:!0,boxModel:!0,styleSheetLoader:l,boundEvents:u,styles:d,schema:c,events:f,isBlock:function(e){if("string"==typeof e)return!!h[e];if(e){var t=e.nodeType;if(t)return!(1!==t||!h[e.nodeName])}return!1},$:g,$$:p,root:null,clone:function(e,n){if(!ca||1!==e.nodeType||n)return e.cloneNode(n);var o=t.createElement(e.nodeName);return la(y(e),(function(t){b(o,t.nodeName,v(e,t.nodeName))})),o},getRoot:C,getViewPort:function(e){var t=un(e);return{x:t.x,y:t.y,w:t.width,h:t.height}},getRect:function(e){e=m(e);var t=T(e),n=E(e);return{x:t.x,y:t.y,w:n.w,h:n.h}},getSize:E,getParent:function(e,t,n){var o=I(e,t,n,!1);return o&&0<o.length?o[0]:null},getParents:I,get:m,getNext:function(e,t){return D(e,t,"nextSibling")},getPrev:function(e,t){return D(e,t,"previousSibling")},select:function(e,o){return Bi(e,m(o)||n.root_element||t,[])},is:_,add:k,create:A,createHTML:function(e,t,n){var o,i="";for(o in i+="<"+e,t)t.hasOwnProperty(o)&&null!=t[o]&&(i+=" "+o+'="'+N(t[o])+'"');return void 0!==n?i+">"+n+"</"+e+">":i+" />"},createFragment:function(e){var n,o=t.createElement("div"),i=t.createDocumentFragment();for(i.appendChild(o),e&&(o.innerHTML=e);n=o.firstChild;)i.appendChild(n);return i.removeChild(o),i},remove:M,setStyle:function(e,t,o){var i=O(t)?p(e).css(t,o):p(e).css(t);n.update_styles&&fa(d,i)},getStyle:x,setStyles:function(e,t){var o=p(e).css(t);n.update_styles&&fa(d,o)},removeAllAttribs:function(e){return w(e,(function(e){var t,n=e.attributes;for(t=n.length-1;0<=t;t--)e.removeAttributeNode(n.item(t))}))},setAttrib:b,setAttribs:R,getAttrib:v,getPos:T,parseStyle:function(e){return d.parse(e)},serializeStyle:function(e,t){return d.serialize(e,t)},addStyle:function(n){var o,r;if(H!==ga.DOM&&t===e.document){if(i[n])return;i[n]=!0}(r=t.getElementById("mceDefaultStyles"))||((r=t.createElement("style")).id="mceDefaultStyles",r.type="text/css",(o=t.getElementsByTagName("head")[0]).firstChild?o.insertBefore(r,o.firstChild):o.appendChild(r)),r.styleSheet?r.styleSheet.cssText+=n:r.appendChild(t.createTextNode(n))},loadCSS:function(o){if(H===ga.DOM||t!==e.document){o=o||"";var i=t.getElementsByTagName("head")[0];la(o.split(","),(function(e){if(e=pt._addCacheSuffix(e),!a[e]){a[e]=!0;var t=A("link",Te(Te({rel:"stylesheet",type:"text/css",href:e},n.contentCssCors?{crossOrigin:"anonymous"}:{}),n.referrerPolicy?{referrerPolicy:n.referrerPolicy}:{}));i.appendChild(t)}}))}else ga.DOM.loadCSS(o)},addClass:function(e,t){p(e).addClass(t)},removeClass:function(e,t){K(e,t,!1)},hasClass:function(e,t){return p(e).hasClass(t)},toggleClass:K,show:function(e){p(e).show()},hide:function(e){p(e).hide()},isHidden:function(e){return"none"===p(e).css("display")},uniqueId:function(e){return(e||"mce_")+s++},setHTML:S,getOuterHTML:function(e){var t="string"==typeof e?m(e):e;return fn(t)?t.outerHTML:_r("<div></div>").append(_r(t).clone()).html()},setOuterHTML:function(e,t){p(e).each((function(){try{if("outerHTML"in this)return void(this.outerHTML=t)}catch(e){}M(_r(this).html(t),!0)}))},decode:po.decode,encode:N,insertAfter:function(e,t){var n=m(t);return w(e,(function(e){var t=n.parentNode,o=n.nextSibling;return o?t.insertBefore(e,o):t.appendChild(e),e}))},replace:P,rename:function(e,t){var n;return e.nodeName!==t.toUpperCase()&&(n=A(t),la(y(e),(function(t){b(n,t.nodeName,v(e,t.nodeName))})),P(n,e,!0)),n||e},findCommonAncestor:function(e,t){for(var n,o=e;o;){for(n=t;n&&o!==n;)n=n.parentNode;if(o===n)break;o=o.parentNode}return!o&&e.ownerDocument?e.ownerDocument.documentElement:o},toHex:function(e){return d.toHex(pt.trim(e))},run:w,getAttribs:y,isEmpty:function(e,t){var n,o,i=0;if(L(e))return!1;if(e=e.firstChild){var r=new Ir(e,e.parentNode),a=c?c.getWhiteSpaceElements():{};t=t||(c?c.getNonEmptyElements():null);do{if(n=e.nodeType,fn(e)){var s=e.getAttribute("data-mce-bogus");if(s){e=r.next("all"===s);continue}if(o=e.nodeName.toLowerCase(),t&&t[o]){if("br"!==o)return!1;i++,e=r.next();continue}if(L(e))return!1}if(8===n)return!1;if(3===n&&!Qn(e.nodeValue))return!1;if(3===n&&e.parentNode&&a[e.parentNode.nodeName]&&Qn(e.nodeValue))return!1;e=r.next()}while(e)}return i<=1},createRng:B,nodeIndex:ha,split:function(e,t,n){var o,i,r,a=B();if(e&&t)return a.setStart(e.parentNode,ha(e)),a.setEnd(t.parentNode,ha(t)),o=a.extractContents(),(a=B()).setStart(t.parentNode,ha(t)+1),a.setEnd(e.parentNode,ha(e)+1),i=a.extractContents(),(r=e.parentNode).insertBefore(to(H,o),e),r.insertBefore(n||t,e),r.insertBefore(to(H,i),e),M(e),n||t},bind:F,unbind:z,fire:function(e,t,n){return f.fire(e,t,n)},getContentEditable:V,getContentEditableParent:function(e){for(var t=C(),n=null;e&&e!==t&&null===(n=V(e));e=e.parentNode);return n},destroy:function(){if(0<u.length)for(var e=u.length;e--;){var t=u[e];f.unbind(t[0],t[1],t[2])}Bi.setDocument&&Bi.setDocument()},isChildOf:function(e,t){for(;e;){if(t===e)return!0;e=e.parentNode}return!1},dumpRng:function(e){return"startContainer: "+e.startContainer.nodeName+", startOffset: "+e.startOffset+", endContainer: "+e.endContainer.nodeName+", endOffset: "+e.endOffset}},W=function(e,t,n){var o=t.keep_values,i={set:function(e,n,o){t.url_converter&&(n=t.url_converter.call(t.url_converter_scope||H,n,o,e[0])),e.attr("data-mce-"+o,n).attr(o,n)},get:function(e,t){return e.attr("data-mce-"+t)||e.attr(t)}},r={style:{set:function(t,n){null===n||"object"!=typeof n?(o&&t.attr("data-mce-style",n),null!==n&&"string"==typeof n?(t.removeAttr("style"),t.css(e.parse(n))):t.attr("style",n)):t.css(n)},get:function(t){var n=t.attr("data-mce-style")||t.attr("style");return e.serialize(e.parse(n),t[0].nodeName)}}};return o&&(r.href=r.src=i),r}(d,n);return H}(aa=ga=ga||{}).DOM=aa(e.document),aa.nodeIndex=ha;var ma=ga,pa=ma.DOM,va=pt.each,ya=pt.grep,ba=(Ca.prototype._setReferrerPolicy=function(e){this.settings.referrerPolicy=e},Ca.prototype.loadScript=function(t,n,o){var i,r=pa,a=r.uniqueId();(i=e.document.createElement("script")).id=a,i.type="text/javascript",i.src=pt._addCacheSuffix(t),this.settings.referrerPolicy&&r.setAttrib(i,"referrerpolicy",this.settings.referrerPolicy),i.onload=function(){r.remove(a),i&&(i.onreadystatechange=i.onload=i=null),n()},i.onerror=function(){N(o)?o():void 0!==e.console&&e.console.log&&e.console.log("Failed to load script: "+t)},(e.document.getElementsByTagName("head")[0]||e.document.body).appendChild(i)},Ca.prototype.isDone=function(e){return 2===this.states[e]},Ca.prototype.markDone=function(e){this.states[e]=2},Ca.prototype.add=function(e,t,n,o){void 0===this.states[e]&&(this.queue.push(e),this.states[e]=0),t&&(this.scriptLoadedCallbacks[e]||(this.scriptLoadedCallbacks[e]=[]),this.scriptLoadedCallbacks[e].push({success:t,failure:o,scope:n||this}))},Ca.prototype.load=function(e,t,n,o){return this.add(e,t,n,o)},Ca.prototype.remove=function(e){delete this.states[e],delete this.scriptLoadedCallbacks[e]},Ca.prototype.loadQueue=function(e,t,n){this.loadScripts(this.queue,e,t,n)},Ca.prototype.loadScripts=function(e,t,n,o){var i=this,r=[],a=function(e,t){va(i.scriptLoadedCallbacks[t],(function(t){N(t[e])&&t[e].call(t.scope)})),i.scriptLoadedCallbacks[t]=void 0};i.queueLoadedCallbacks.push({success:t,failure:o,scope:n||this});var s=function(){var t=ya(e);if(e.length=0,va(t,(function(e){2!==i.states[e]?3!==i.states[e]?1!==i.states[e]&&(i.states[e]=1,i.loading++,i.loadScript(e,(function(){i.states[e]=2,i.loading--,a("success",e),s()}),(function(){i.states[e]=3,i.loading--,r.push(e),a("failure",e),s()}))):a("failure",e):a("success",e)})),!i.loading){var n=i.queueLoadedCallbacks.slice(0);i.queueLoadedCallbacks.length=0,va(n,(function(e){0===r.length?N(e.success)&&e.success.call(e.scope):N(e.failure)&&e.failure.call(e.scope,r)}))}};s()},Ca.ScriptLoader=new Ca,Ca);function Ca(e){void 0===e&&(e={}),this.states={},this.queue=[],this.scriptLoadedCallbacks={},this.queueLoadedCallbacks=[],this.loading=0,this.settings=e}var Ta,xa=function(e){var t=e;return{get:function(){return t},set:function(e){t=e}}},Ea={},_a=xa("en"),Ia=function(){return de(Ea,_a.get())},Da={getData:function(){return re(Ea,(function(e){return Te({},e)}))},setCode:function(e){e&&_a.set(e)},getCode:function(){return _a.get()},add:function(e,t){var n=Ea[e];n||(Ea[e]=n={}),ie(t,(function(e,t){n[t.toLowerCase()]=e}))},translate:function(e){var t,n,o=Ia().getOr({}),i=function(e){return N(e)?Object.prototype.toString.call(e):r(e)?"":""+e},r=function(e){return""===e||null==e},a=function(e){var t=i(e);return de(o,t.toLowerCase()).map(i).getOr(t)},s=function(e){return e.replace(/{context:\w+}$/,"")};if(r(e))return"";if(w(t=e)&&fe(t,"raw"))return i(e.raw);if(R(n=e)&&1<n.length){var l=e.slice(1);return s(a(e[0]).replace(/\{([0-9]+)\}/g,(function(e,t){return fe(l,t)?i(l[t]):e})))}return s(a(e))},isRtl:function(){return Ia().bind((function(e){return de(e,"_dir")})).exists((function(e){return"rtl"===e}))},hasCode:function(e){return fe(Ea,e)}};function Oa(){var e=this,t=[],n={},o={},i=[],r=function(e,t){var n=$(i,(function(n){return n.name===e&&n.state===t}));H(n,(function(e){return e.callback()}))},a=function(e){var t;return o[e]&&(t=o[e].dependencies),t||[]},s=function(e,t){return"object"==typeof t?t:"string"==typeof e?{prefix:"",resource:t,suffix:""}:{prefix:e.prefix,resource:t,suffix:e.suffix}},l=function(e,t,i,u,c){if(!n[e]){var d="string"==typeof t?t:t.prefix+t.resource+t.suffix;0!==d.indexOf("/")&&-1===d.indexOf("://")&&(d=Oa.baseURL+"/"+d),n[e]=d.substring(0,d.lastIndexOf("/"));var f=function(){var n,o,c,d;r(e,"loaded"),n=t,o=i,c=u,d=a(e),H(d,(function(e){var t=s(n,e);l(t.resource,t,void 0,void 0)})),o&&o.call(c||ba)};o[e]?f():ba.ScriptLoader.add(d,f,u,c)}},u=function(e,t,r){void 0===r&&(r="added"),fe(o,e)&&"added"===r||fe(n,e)&&"loaded"===r?t():i.push({name:e,state:r,callback:t})};return{items:t,urls:n,lookup:o,_listeners:i,get:function(e){return o[e]?o[e].instance:void 0},dependencies:a,requireLangPack:function(e,t){!1!==Oa.languageLoad&&u(e,(function(){var o=Da.getCode();!o||t&&-1===(","+(t||"")+",").indexOf(","+o+",")||ba.ScriptLoader.add(n[e]+"/langs/"+o+".js")}),"loaded")},add:function(e,n,i){var a=n;return t.push(a),o[e]={instance:a,dependencies:i},r(e,"added"),a},remove:function(e){delete n[e],delete o[e]},createUrl:s,addComponents:function(t,n){var o=e.urls[t];H(n,(function(e){ba.ScriptLoader.add(o+"/"+e)}))},load:l,waitFor:u}}(Ta=Oa=Oa||{}).PluginManager=Ta(),Ta.ThemeManager=Ta();var wa=Oa,Ra=function(t,n){var o=null;return{cancel:function(){null!==o&&(e.clearTimeout(o),o=null)},throttle:function(){for(var i=[],r=0;r<arguments.length;r++)i[r]=arguments[r];null===o&&(o=e.setTimeout((function(){t.apply(null,i),o=null}),n))}}},Sa=function(t,n){var o=null;return{cancel:function(){null!==o&&(e.clearTimeout(o),o=null)},throttle:function(){for(var i=[],r=0;r<arguments.length;r++)i[r]=arguments[r];null!==o&&e.clearTimeout(o),o=e.setTimeout((function(){t.apply(null,i),o=null}),n)}}},ka=function(e,t){var n=kn(e,t);return void 0===n||""===n?[]:n.split(" ")},Aa=function(e){return void 0!==e.dom().classList},Na=function(e,t){Aa(e)?e.dom().classList.add(t):function(e,t){return o=t,i=ka(n=e,"class").concat([o]),Rn(n,"class",i.join(" ")),!0;var n,o,i}(e,t)},Ma=function(e,t){return Aa(e)&&e.dom().classList.contains(t)},Ka=function(e,t){var n=[];return H(Bt(e),(function(e){t(e)&&(n=n.concat([e])),n=n.concat(Ka(e,t))})),n},Pa=function(t,n){return o=n,r=void 0===(i=t)?e.document:i.dom(),wt(r)?[]:V(r.querySelectorAll(o),yt.fromDom);var o,i,r};function La(e,t,n,o,i){return e(n,o)?E.some(n):N(i)&&i(n)?E.none():t(n,o,i)}var Ba,Fa=function(e,t,n){for(var o=e.dom(),i=N(n)?n:c(!1);o.parentNode;){var r=yt.fromDom(o=o.parentNode);if(t(r))return E.some(r);if(i(r))break}return E.none()},za=function(e,t,n){return La((function(e,t){return t(e)}),Fa,e,t,n)},Va=function(e,t,n){return Fa(e,(function(e){return Ot(e,t)}),n)},Ha=function(t,n){return o=n,r=void 0===(i=t)?e.document:i.dom(),wt(r)?E.none():E.from(r.querySelector(o)).map(yt.fromDom);var o,i,r},Wa=function(e,t,n){return La((function(e,t){return Ot(e,t)}),Va,e,t,n)},$a=c("mce-annotation"),Ua=c("data-mce-annotation"),qa=c("data-mce-annotation-uid"),ja=function(e,t){var n=e.selection.getRng(),o=yt.fromDom(n.startContainer),i=yt.fromDom(e.getBody()),r=t.fold((function(){return"."+$a()}),(function(e){return"["+Ua()+'="'+e+'"]'})),a=Ft(o,n.startOffset).getOr(o),s=Wa(a,r,(function(e){return Rt(e,i)})),l=function(e,t){return n=t,(o=e.dom())&&o.hasAttribute&&o.hasAttribute(n)?E.some(kn(e,t)):E.none();var n,o};return s.bind((function(t){return l(t,""+qa()).bind((function(n){return l(t,""+Ua()).map((function(t){var o=Ga(e,n);return{uid:n,name:t,elements:o}}))}))}))},Ga=function(e,t){var n=yt.fromDom(e.getBody());return Pa(n,"["+qa()+'="'+t+'"]')},Xa=0,Ya=function(e){var t=(new Date).getTime();return e+"_"+Math.floor(1e9*Math.random())+ ++Xa+String(t)},Za=function(t,n){var o,i,r=kt(t).dom(),a=yt.fromDom(r.createDocumentFragment()),s=(o=n,(i=(r||e.document).createElement("div")).innerHTML=o,Bt(yt.fromDom(i)));Xt(a,s),Yt(t),Gt(t,a)},Ja=function(e,t){return yt.fromDom(e.dom().cloneNode(t))},Qa=function(e){return Ja(e,!1)},es=function(e){return Ja(e,!0)},ts=function(e,t,n){void 0===n&&(n=y);var o=new Ir(e,t),i=function(e){for(var t;(t=o[e]())&&!Cn(t)&&!n(t););return E.from(t).filter(Cn)};return{current:function(){return E.from(o.current()).filter(Cn)},next:function(){return i("next")},prev:function(){return i("prev")},prev2:function(){return i("prev2")}}},ns=function(e,t){var n=t||function(t){return e.isBlock(t)||_n(t)||Dn(t)},o=function(e,t,n,i){if(Cn(e)){var r=i(e,t,e.data);if(-1!==r)return E.some({container:e,offset:r})}return n().bind((function(e){return o(e.container,e.offset,n,i)}))};return{backwards:function(e,t,i,r){var a=ts(e,r,n);return o(e,t,(function(){return a.prev().map((function(e){return{container:e,offset:e.length}}))}),i).getOrNull()},forwards:function(e,t,i,r){var a=ts(e,r,n);return o(e,t,(function(){return a.next().map((function(e){return{container:e,offset:0}}))}),i).getOrNull()}}},os="\ufeff",is=function(e){return"\ufeff"===e},rs=function(e){return e.replace(/\uFEFF/g,"")},as=fn,ss=Cn,ls=function(e){return ss(e)&&(e=e.parentNode),as(e)&&e.hasAttribute("data-mce-caret")},us=function(e){return ss(e)&&is(e.data)},cs=function(e){return ls(e)||us(e)},ds=function(e){return e.firstChild!==e.lastChild||!_n(e.firstChild)},fs=function(e){var t=e.container();return!(!e||!Cn(t))&&(t.data.charAt(e.offset())===os||e.isAtStart()&&us(t.previousSibling))},hs=function(e){var t=e.container();return!(!e||!Cn(t))&&(t.data.charAt(e.offset()-1)===os||e.isAtEnd()&&us(t.nextSibling))},gs=function(e){return ss(e)&&e.data[0]===os},ms=function(e){return ss(e)&&e.data[e.data.length-1]===os},ps=function(e){return e&&e.hasAttribute("data-mce-caret")?(t=e.getElementsByTagName("br"),pn(n=t[t.length-1])&&n.parentNode.removeChild(n),e.removeAttribute("data-mce-caret"),e.removeAttribute("data-mce-bogus"),e.removeAttribute("style"),e.removeAttribute("_moz_abspos"),e):null;var t,n},vs=function(e,t,n){return e.isSome()&&t.isSome()?E.some(n(e.getOrDie(),t.getOrDie())):E.none()},ys=Math.round,bs=function(e){return e?{left:ys(e.left),top:ys(e.top),bottom:ys(e.bottom),right:ys(e.right),width:ys(e.width),height:ys(e.height)}:{left:0,top:0,bottom:0,right:0,width:0,height:0}},Cs=function(e,t){return e=bs(e),t||(e.left=e.left+e.width),e.right=e.left,e.width=0,e},Ts=function(e,t,n){return 0<=e&&e<=Math.min(t.height,n.height)/2},xs=function(e,t){return e.bottom-e.height/2<t.top||!(e.top>t.bottom)&&Ts(t.top-e.bottom,e,t)},Es=function(e,t){return e.top>t.bottom||!(e.bottom<t.top)&&Ts(t.bottom-e.top,e,t)},_s=function(e,t,n){return t>=e.left&&t<=e.right&&n>=e.top&&n<=e.bottom},Is=function(e){var t=e.startContainer,n=e.startOffset;return t.hasChildNodes()&&e.endOffset===n+1?t.childNodes[n]:null},Ds=function(e,t){return 1===e.nodeType&&e.hasChildNodes()&&(t>=e.childNodes.length&&(t=e.childNodes.length-1),e=e.childNodes[t]),e},Os=new RegExp("[̀-ͯ҃-҇҈-҉֑-ֽֿׁ-ׂׄ-ׇׅؐ-ًؚ-ٰٟۖ-ۜ۟-ۤۧ-۪ۨ-ܑۭܰ-݊ަ-ް߫-߳ࠖ-࠙ࠛ-ࠣࠥ-ࠧࠩ-࡙࠭-࡛ࣣ-ंऺ़ु-ै्॑-ॗॢ-ॣঁ়াু-ৄ্ৗৢ-ৣਁ-ਂ਼ੁ-ੂੇ-ੈੋ-੍ੑੰ-ੱੵઁ-ં઼ુ-ૅે-ૈ્ૢ-ૣଁ଼ାିୁ-ୄ୍ୖୗୢ-ୣஂாீ்ௗఀా-ీె-ైొ-్ౕ-ౖౢ-ౣಁ಼ಿೂೆೌ-್ೕ-ೖೢ-ೣഁാു-ൄ്ൗൢ-ൣ්ාි-ුූෟัิ-ฺ็-๎ັິ-ູົ-ຼ່-ໍ༘-ཱ༹༙༵༷-ཾྀ-྄྆-྇ྍ-ྗྙ-ྼ࿆ိ-ူဲ-့္-်ွ-ှၘ-ၙၞ-ၠၱ-ၴႂႅ-ႆႍႝ፝-፟ᜒ-᜔ᜲ-᜴ᝒ-ᝓᝲ-ᝳ឴-឵ិ-ួំ៉-៓៝᠋-᠍ᢩᤠ-ᤢᤧ-ᤨᤲ᤹-᤻ᨗ-ᨘᨛᩖᩘ-ᩞ᩠ᩢᩥ-ᩬᩳ-᩿᩼᪰-᪽᪾ᬀ-ᬃ᬴ᬶ-ᬺᬼᭂ᭫-᭳ᮀ-ᮁᮢ-ᮥᮨ-ᮩ᮫-ᮭ᯦ᯨ-ᯩᯭᯯ-ᯱᰬ-ᰳᰶ-᰷᳐-᳔᳒-᳢᳠-᳨᳭᳴᳸-᳹᷀-᷵᷼-᷿‌-‍⃐-⃜⃝-⃠⃡⃢-⃤⃥-⃰⳯-⵿⳱ⷠ-〪ⷿ-〭〮-゙〯-゚꙯꙰-꙲ꙴ-꙽ꚞ-ꚟ꛰-꛱ꠂ꠆ꠋꠥ-ꠦ꣄꣠-꣱ꤦ-꤭ꥇ-ꥑꦀ-ꦂ꦳ꦶ-ꦹꦼꧥꨩ-ꨮꨱ-ꨲꨵ-ꨶꩃꩌꩼꪰꪲ-ꪴꪷ-ꪸꪾ-꪿꫁ꫬ-ꫭ꫶ꯥꯨ꯭ﬞ︀-️︠-︯ﾞ-ﾟ]"),ws=function(e){return"string"==typeof e&&768<=e.charCodeAt(0)&&Os.test(e)},Rs=In,Ss=Dn,ks=_n,As=Cn,Ns=hn(["script","style","textarea"]),Ms=hn(["img","input","textarea","hr","iframe","video","audio","object"]),Ks=hn(["table"]),Ps=cs,Ls=function(e){return!Ps(e)&&(As(e)?!Ns(e.parentNode):Ms(e)||ks(e)||Ks(e)||Bs(e))},Bs=function(e){return!1===(fn(t=e)&&"true"===t.getAttribute("unselectable"))&&Ss(e);var t},Fs=function(e,t){return Ls(e)&&function(e,t){for(e=e.parentNode;e&&e!==t;e=e.parentNode){if(Bs(e))return!1;if(Rs(e))return!0}return!0}(e,t)},zs=fn,Vs=Ls,Hs=gn("display","block table"),Ws=gn("float","left right"),$s=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(t){for(var n=0;n<e.length;n++)if(!e[n](t))return!1;return!0}}(zs,Vs,p(Ws)),Us=p(gn("white-space","pre pre-line pre-wrap")),qs=Cn,js=_n,Gs=ma.nodeIndex,Xs=Ds,Ys=function(e){return"createRange"in e?e.createRange():ma.DOM.createRng()},Zs=function(e){return e&&/[\r\n\t ]/.test(e)},Js=function(e){return!!e.setStart&&!!e.setEnd},Qs=function(e){var t,n=e.startContainer,o=e.startOffset;return!!(Zs(e.toString())&&Us(n.parentNode)&&Cn(n)&&(t=n.data,Zs(t[o-1])||Zs(t[o+1])))},el=function(e){return 0===e.left&&0===e.right&&0===e.top&&0===e.bottom},tl=function(e){var t,n=e.getClientRects();return t=bs(0<n.length?n[0]:e.getBoundingClientRect()),!Js(e)&&js(e)&&el(t)?function(e){var t=e.ownerDocument,n=Ys(t),o=t.createTextNode(Oo),i=e.parentNode;i.insertBefore(o,e),n.setStart(o,0),n.setEnd(o,1);var r=bs(n.getBoundingClientRect());return i.removeChild(o),r}(e):el(t)&&Js(e)?function(e){var t=e.endContainer,n=e.startOffset,o=e.endOffset;if(e.startContainer===t&&Cn(t)&&0===n&&1===o){var i=e.cloneRange();return i.setEndAfter(t),tl(i)}return null}(e):t},nl=function(e,t){var n=Cs(e,t);return n.width=1,n.right=n.left+1,n};function ol(e,t,n){var o=function(){return n=n||function(e){var t,n,o=[],i=function(e){var t,n;0!==e.height&&(0<o.length&&(t=e).left===(n=o[o.length-1]).left&&t.top===n.top&&t.bottom===n.bottom&&t.right===n.right||o.push(e))},r=function(e,t){var n=Ys(e.ownerDocument);if(t<e.data.length){if(ws(e.data[t]))return o;if(ws(e.data[t-1])&&(n.setStart(e,t),n.setEnd(e,t+1),!Qs(n)))return i(nl(tl(n),!1)),o}0<t&&(n.setStart(e,t-1),n.setEnd(e,t),Qs(n)||i(nl(tl(n),!1))),t<e.data.length&&(n.setStart(e,t),n.setEnd(e,t+1),Qs(n)||i(nl(tl(n),!0)))};if(qs(e.container()))return r(e.container(),e.offset()),o;if(zs(e.container()))if(e.isAtEnd())n=Xs(e.container(),e.offset()),qs(n)&&r(n,n.data.length),$s(n)&&!js(n)&&i(nl(tl(n),!1));else{if(n=Xs(e.container(),e.offset()),qs(n)&&r(n,0),$s(n)&&e.isAtEnd())return i(nl(tl(n),!1)),o;t=Xs(e.container(),e.offset()-1),$s(t)&&!js(t)&&(!Hs(t)&&!Hs(n)&&$s(n)||i(nl(tl(t),!1))),$s(n)&&i(nl(tl(n),!0))}return o}(ol(e,t))};return{container:c(e),offset:c(t),toRange:function(){var n=Ys(e.ownerDocument);return n.setStart(e,t),n.setEnd(e,t),n},getClientRects:o,isVisible:function(){return 0<o().length},isAtStart:function(){return qs(e),0===t},isAtEnd:function(){return qs(e)?t>=e.data.length:t>=e.childNodes.length},isEqual:function(n){return n&&e===n.container()&&t===n.offset()},getNode:function(n){return Xs(e,n?t-1:t)}}}(Ba=ol=ol||{}).fromRangeStart=function(e){return Ba(e.startContainer,e.startOffset)},Ba.fromRangeEnd=function(e){return Ba(e.endContainer,e.endOffset)},Ba.after=function(e){return Ba(e.parentNode,Gs(e)+1)},Ba.before=function(e){return Ba(e.parentNode,Gs(e))},Ba.isAbove=function(e,t){return vs(Q(t.getClientRects()),ee(e.getClientRects()),xs).getOr(!1)},Ba.isBelow=function(e,t){return vs(ee(t.getClientRects()),Q(e.getClientRects()),Es).getOr(!1)},Ba.isAtStart=function(e){return!!e&&e.isAtStart()},Ba.isAtEnd=function(e){return!!e&&e.isAtEnd()},Ba.isTextPosition=function(e){return!!e&&Cn(e.container())},Ba.isElementPosition=function(e){return!1===Ba.isTextPosition(e)};var il,rl,al=ol,sl=function(e,t){Cn(t)&&0===t.data.length&&e.remove(t)},ll=function(e,t,n){var o,i,r,a,s,l,u;En(n)?(r=e,a=t,l=E.from((s=n).firstChild),u=E.from(s.lastChild),a.insertNode(s),l.each((function(e){return sl(r,e.previousSibling)})),u.each((function(e){return sl(r,e.nextSibling)}))):(o=e,t.insertNode(i=n),sl(o,i.previousSibling),sl(o,i.nextSibling))},ul=Cn,cl=pn,dl=ma.nodeIndex,fl=function(e){var t=e.parentNode;return cl(t)?fl(t):t},hl=function(e){return e?ye(e.childNodes,(function(e,t){return cl(t)&&"BR"!==t.nodeName?e=e.concat(hl(t)):e.push(t),e}),[]):[]},gl=function(e){return function(t){return e===t}},ml=function(e){return(ul(e)?"text()":e.nodeName.toLowerCase())+"["+function(e){var t,n;t=hl(fl(e)),n=be(t,gl(e),e),t=t.slice(0,n+1);var o=ye(t,(function(e,n,o){return ul(n)&&ul(t[o-1])&&e++,e}),0);return t=pe(t,hn([e.nodeName])),(n=be(t,gl(e),e))-o}(e)+"]"},pl=function(e,t){var n,o,i,r,a,s=[];return n=t.container(),o=t.offset(),ul(n)?i=function(e,t){for(;(e=e.previousSibling)&&ul(e);)t+=e.data.length;return t}(n,o):(o>=(r=n.childNodes).length?(i="after",o=r.length-1):i="before",n=r[o]),s.push(ml(n)),a=function(e,t,n){var o=[];for(t=t.parentNode;t!==e;t=t.parentNode)o.push(t);return o}(e,n),a=pe(a,p(pn)),(s=s.concat(me(a,(function(e){return ml(e)})))).reverse().join("/")+","+i},vl=function(e,t){var n;if(!t)return null;var o=t.split(","),i=o[0].split("/");n=1<o.length?o[1]:"before";var r=ye(i,(function(e,t){return(t=/([\w\-\(\)]+)\[([0-9]+)\]/.exec(t))?("text()"===t[1]&&(t[1]="#text"),n=e,o=t[1],i=parseInt(t[2],10),r=hl(n),r=pe(r,(function(e,t){return!ul(e)||!ul(r[t-1])})),(r=pe(r,hn([o])))[i]):null;var n,o,i,r}),e);return r?ul(r)?function(e,t){for(var n,o=e,i=0;ul(o);){if(n=o.data.length,i<=t&&t<=i+n){e=o,t-=i;break}if(!ul(o.nextSibling)){e=o,t=n;break}i+=n,o=o.nextSibling}return ul(e)&&t>e.data.length&&(t=e.data.length),al(e,t)}(r,parseInt(n,10)):(n="after"===n?dl(r)+1:dl(r),al(r.parentNode,n)):null},yl=Dn,bl=function(e,t,n,o,i){var r,a=o[i?"startContainer":"endContainer"],s=o[i?"startOffset":"endOffset"],l=[],u=0,c=e.getRoot();for(Cn(a)?l.push(n?function(e,t,n){var o,i;for(i=e(t.data.slice(0,n)).length,o=t.previousSibling;o&&Cn(o);o=o.previousSibling)i+=e(o.data).length;return i}(t,a,s):s):(s>=(r=a.childNodes).length&&r.length&&(u=1,s=Math.max(0,r.length-1)),l.push(e.nodeIndex(r[s],n)+u));a&&a!==c;a=a.parentNode)l.push(e.nodeIndex(a,n));return l},Cl=function(e,t,n){var o=0;return pt.each(e.select(t),(function(e){if("all"!==e.getAttribute("data-mce-bogus"))return e!==n&&void o++})),o},Tl=function(e,t){var n,o,i,r=t?"start":"end";o=e[r+"Offset"],fn(n=e[r+"Container"])&&"TR"===n.nodeName&&(n=(i=n.childNodes)[Math.min(t?o:o-1,i.length-1)])&&e["set"+(t?"Start":"End")](n,o=t?0:n.childNodes.length)},xl=function(e){return Tl(e,!0),Tl(e,!1),e},El=function(e,t){var n;if(fn(e)&&(e=Ds(e,t),yl(e)))return e;if(cs(e)){if(Cn(e)&&ls(e)&&(e=e.parentNode),yl(n=e.previousSibling))return n;if(yl(n=e.nextSibling))return n}},_l=function(e,t,n){var o=n.getNode(),i=o?o.nodeName:null,r=n.getRng();if(yl(o)||"IMG"===i)return{name:i,index:Cl(n.dom,i,o)};var a,s,l,u,c,d,f,h=El((a=r).startContainer,a.startOffset)||El(a.endContainer,a.endOffset);return h?{name:i=h.tagName,index:Cl(n.dom,i,h)}:(d=(l=n).dom,(f={}).start=bl(d,s=e,u=t,c=r,!0),l.isCollapsed()||(f.end=bl(d,s,u,c,!1)),f)},Il=function(e,t,n){var o={"data-mce-type":"bookmark",id:t,style:"overflow:hidden;line-height:0px"};return n?e.create("span",o,"&#xFEFF;"):e.create("span",o)},Dl=function(e,t){var n=e.dom,o=e.getRng(),i=n.uniqueId(),r=e.isCollapsed(),a=e.getNode(),s=a.nodeName;if("IMG"===s)return{name:s,index:Cl(n,s,a)};var l=xl(o.cloneRange());if(!r){l.collapse(!1);var u=Il(n,i+"_end",t);ll(n,l,u)}(o=xl(o)).collapse(!0);var c=Il(n,i+"_start",t);return ll(n,o,c),e.moveToBookmark({id:i,keep:!0}),{id:i}},Ol=f(_l,d,!0),wl=ma.DOM,Rl=function(e,t,n){var o=e.getParam(t,n);if(-1===o.indexOf("="))return o;var i=e.getParam(t,"","hash");return i.hasOwnProperty(e.id)?i[e.id]:n},Sl=function(e){return e.getParam("content_security_policy","")},kl=function(e){if(e.getParam("force_p_newlines",!1))return"p";var t=e.getParam("forced_root_block","p");return!1===t?"":!0===t?"p":t},Al=function(e){return e.getParam("forced_root_block_attrs",{})},Nl=function(e){return e.getParam("automatic_uploads",!0,"boolean")},Ml=function(e){return e.getParam("icons","","string")},Kl=function(e){return e.getParam("referrer_policy","","string")},Pl=function(e){return e.getParam("language","en","string")},Ll=function(e){return e.getParam("indent_use_margin",!1)},Bl=function(e){return e.getParam("object_resizing")},Fl=function(e){return e.getParam("event_root")},zl=function(e){return e.getParam("theme")},Vl=function(e){return!1!==e.getParam("inline_boundaries")},Hl=function(e){return e.getParam("plugins")},Wl=fn,$l=Cn,Ul=function(e){var t=e.parentNode;t&&t.removeChild(e)},ql=function(e,t){0===t.length?Ul(e):e.nodeValue=t},jl=function(e){var t=rs(e);return{count:e.length-t.length,text:t}},Gl=function(e,t){return Zl(e),t},Xl=function(e,t){var n,o,i=t.container(),r=(n=te(i.childNodes),(-1===(o=B(n,e))?E.none():E.some(o)).map((function(e){return e<t.offset()?al(i,t.offset()-1):t})).getOr(t));return Zl(e),r},Yl=function(e,t){return al.isTextPosition(t)?function(e,t){return $l(e)&&t.container()===e?(i=jl((n=e).data.substr(0,(o=t).offset())),r=jl(n.data.substr(o.offset())),0<(a=i.text+r.text).length?(ql(n,a),al(n,o.offset()-i.count)):o):Gl(e,t);var n,o,i,r,a}(e,t):(n=e,((o=t).container()===n.parentNode?Xl:Gl)(n,o));var n,o},Zl=function(e){if(Wl(e)&&cs(e)&&(ds(e)?e.removeAttribute("data-mce-caret"):Ul(e)),$l(e)){var t=rs(function(e){try{return e.nodeValue}catch(t){return""}}(e));ql(e,t)}},Jl=nt().browser,Ql=Dn,eu=function(e,t,n){var o,i,r,a,s,l=Cs(t.getBoundingClientRect(),n);return r="BODY"===e.tagName?(o=e.ownerDocument.documentElement,i=e.scrollLeft||o.scrollLeft,e.scrollTop||o.scrollTop):(s=e.getBoundingClientRect(),i=e.scrollLeft-s.left,e.scrollTop-s.top),l.left+=i,l.right+=i,l.top+=r,l.bottom+=r,l.width=1,0<(a=t.offsetWidth-t.clientWidth)&&(n&&(a*=-1),l.left+=a,l.right+=a),l},tu=function(){return Jl.isIE()||Jl.isEdge()||Jl.isFirefox()},nu=function(e){return Ql(e)||vn(e)&&tu()},ou=Dn,iu=gn("display","block table table-cell table-caption list-item"),ru=cs,au=ls,su=fn,lu=Ls,uu=function(e,t){for(var n;n=e(t);)if(!au(n))return n;return null},cu=function(e,t,n,o,i){var r=new Ir(e,o);if(t<0){if((ou(e)||au(e))&&n(e=uu(r.prev,!0)))return e;for(;e=uu(r.prev,i);)if(n(e))return e}if(0<t){if((ou(e)||au(e))&&n(e=uu(r.next,!0)))return e;for(;e=uu(r.next,i);)if(n(e))return e}return null},du=function(e,t){for(;e&&e!==t;){if(iu(e))return e;e=e.parentNode}return null},fu=function(e,t,n){return du(e.container(),n)===du(t.container(),n)},hu=function(e,t){if(!t)return null;var n=t.container(),o=t.offset();return su(n)?n.childNodes[o+e]:null},gu=function(e,t){var n=t.ownerDocument.createRange();return e?(n.setStartBefore(t),n.setEndBefore(t)):(n.setStartAfter(t),n.setEndAfter(t)),n},mu=function(e,t,n){var o,i,r,a;for(i=e?"previousSibling":"nextSibling";n&&n!==t;){if(ru(o=n[i])&&(o=o[i]),ou(o)){if(a=n,du(o,r=t)===du(a,r))return o;break}if(lu(o))break;n=n.parentNode}return null},pu=f(gu,!0),vu=f(gu,!1),yu=function(e,t,n){var o,i,r,a=f(mu,!0,t),s=f(mu,!1,t),l=n.startOffset;if(ls(i=n.startContainer)){if(su(i)||(i=i.parentNode),"before"===(r=i.getAttribute("data-mce-caret"))&&nu(o=i.nextSibling))return pu(o);if("after"===r&&nu(o=i.previousSibling))return vu(o)}if(!n.collapsed)return n;if(Cn(i)){if(ru(i)){if(1===e){if(o=s(i))return pu(o);if(o=a(i))return vu(o)}if(-1===e){if(o=a(i))return vu(o);if(o=s(i))return pu(o)}return n}if(ms(i)&&l>=i.data.length-1)return 1===e&&(o=s(i))?pu(o):n;if(gs(i)&&l<=1)return-1===e&&(o=a(i))?vu(o):n;if(l===i.data.length)return(o=s(i))?pu(o):n;if(0===l)return(o=a(i))?vu(o):n}return n},bu=function(e,t){return E.from(hu(e?0:-1,t)).filter(ou)},Cu=function(e,t,n){var o=yu(e,t,n);return-1===e?ol.fromRangeStart(o):ol.fromRangeEnd(o)},Tu=function(e){return E.from(e.getNode()).map(yt.fromDom)},xu=function(e,t){for(;t=e(t);)if(t.isVisible())return t;return t},Eu=function(e,t){var n=fu(e,t);return!(n||!_n(e.getNode()))||n};(rl=il=il||{})[rl.Backwards=-1]="Backwards",rl[rl.Forwards=1]="Forwards";var _u=Dn,Iu=Cn,Du=fn,Ou=_n,wu=Ls,Ru=function(e){return Ms(e)||!!Bs(t=e)&&!0!==q(te(t.getElementsByTagName("*")),(function(e,t){return e||Rs(t)}),!1);var t},Su=Fs,ku=function(e,t){return e.hasChildNodes()&&t<e.childNodes.length?e.childNodes[t]:null},Au=function(e,t){if(0<e){if(wu(t.previousSibling)&&!Iu(t.previousSibling))return al.before(t);if(Iu(t))return al(t,0)}if(e<0){if(wu(t.nextSibling)&&!Iu(t.nextSibling))return al.after(t);if(Iu(t))return al(t,t.data.length)}return e<0&&!Ou(t)?al.after(t):al.before(t)},Nu=function(e,t,n){var o,i,r,a;if(!Du(n)||!t)return null;if(t.isEqual(al.after(n))&&n.lastChild){if(a=al.after(n.lastChild),e<0&&wu(n.lastChild)&&Du(n.lastChild))return Ou(n.lastChild)?al.before(n.lastChild):a}else a=t;var s,l,u,d=a.container(),f=a.offset();if(Iu(d)){if(e<0&&0<f)return al(d,--f);if(0<e&&f<d.length)return al(d,++f);o=d}else{if(e<0&&0<f&&(i=ku(d,f-1),wu(i)))return!Ru(i)&&(r=cu(i,e,Su,i))?Iu(r)?al(r,r.data.length):al.after(r):Iu(i)?al(i,i.data.length):al.before(i);if(0<e&&f<d.childNodes.length&&(i=ku(d,f),wu(i)))return Ou(i)?(s=n,(u=(l=i).nextSibling)&&wu(u)?Iu(u)?al(u,0):al.before(u):Nu(il.Forwards,al.after(l),s)):!Ru(i)&&(r=cu(i,e,Su,i))?Iu(r)?al(r,0):al.before(r):Iu(i)?al(i,0):al.after(i);o=i||a.getNode()}if((0<e&&a.isAtEnd()||e<0&&a.isAtStart())&&(o=cu(o,e,c(!0),n,!0),Su(o,n)))return Au(e,o);i=cu(o,e,Su,n);var h=Ce($(function(e,t){for(var n=[];e&&e!==t;)n.push(e),e=e.parentNode;return n}(d,n),_u));return!h||i&&h.contains(i)?i?Au(e,i):null:a=0<e?al.after(h):al.before(h)},Mu=function(e){return{next:function(t){return Nu(il.Forwards,t,e)},prev:function(t){return Nu(il.Backwards,t,e)}}},Ku=function(e){return al.isTextPosition(e)?0===e.offset():Ls(e.getNode())},Pu=function(e){if(al.isTextPosition(e)){var t=e.container();return e.offset()===t.data.length}return Ls(e.getNode(!0))},Lu=function(e,t){return!al.isTextPosition(e)&&!al.isTextPosition(t)&&e.getNode()===t.getNode(!0)},Bu=function(e,t,n){var o=Mu(t);return E.from(e?o.next(n):o.prev(n))},Fu=function(e,t,n){return Bu(e,t,n).bind((function(o){return fu(n,o,t)&&function(e,t,n){return e?!Lu(t,n)&&!(!al.isTextPosition(o=t)&&_n(o.getNode()))&&Pu(t)&&Ku(n):!Lu(n,t)&&Ku(t)&&Pu(n);var o}(e,n,o)?Bu(e,t,o):E.some(o)}))},zu=function(e,t,n,o){return Fu(e,t,n).bind((function(n){return o(n)?zu(e,t,n,o):E.some(n)}))},Vu=function(e,t){var n,o,i,r,a,s=e?t.firstChild:t.lastChild;return Cn(s)?E.some(al(s,e?0:s.data.length)):s?Ls(s)?E.some(e?al.before(s):_n(a=s)?al.before(a):al.after(a)):(o=t,i=s,r=(n=e)?al.before(i):al.after(i),Bu(n,o,r)):E.none()},Hu=f(Bu,!0),Wu=f(Bu,!1),$u=f(Vu,!0),Uu=f(Vu,!1),qu="_mce_caret",ju=function(e){return fn(e)&&e.id===qu},Gu=function(e,t){for(;t&&t!==e;){if(t.id===qu)return t;t=t.parentNode}return null},Xu=function(e,t){return fn(t)&&e.isBlock(t)&&!t.innerHTML&&!dt.ie&&(t.innerHTML='<br data-mce-bogus="1" />'),t},Yu=function(e,t){return Uu(e).fold((function(){return!1}),(function(e){return t.setStart(e.container(),e.offset()),t.setEnd(e.container(),e.offset()),!0}))},Zu=function(e,t,n){return!(!1!==t.hasChildNodes()||!Gu(e,t)||(i=n,r=(o=t).ownerDocument.createTextNode(os),o.appendChild(r),i.setStart(r,0),i.setEnd(r,0),0));var o,i,r},Ju=function(e,t,n,o){var i,r,a,s,l=n[t?"start":"end"],u=e.getRoot();if(l){for(a=l[0],r=u,i=l.length-1;1<=i;i--){if(s=r.childNodes,Zu(u,r,o))return!0;if(l[i]>s.length-1)return!!Zu(u,r,o)||Yu(r,o);r=s[l[i]]}3===r.nodeType&&(a=Math.min(l[0],r.nodeValue.length)),1===r.nodeType&&(a=Math.min(l[0],r.childNodes.length)),t?o.setStart(r,a):o.setEnd(r,a)}return!0},Qu=function(e){return Cn(e)&&0<e.data.length},ec=function(e,t,n){var o,i,r,a,s,l,u=e.get(n.id+"_"+t),c=n.keep;if(u){if(o=u.parentNode,i="start"===t?c?u.hasChildNodes()?(o=u.firstChild,1):Qu(u.nextSibling)?(o=u.nextSibling,0):Qu(u.previousSibling)?(o=u.previousSibling,u.previousSibling.data.length):(o=u.parentNode,e.nodeIndex(u)+1):e.nodeIndex(u):c?u.hasChildNodes()?(o=u.firstChild,1):Qu(u.previousSibling)?(o=u.previousSibling,u.previousSibling.data.length):(o=u.parentNode,e.nodeIndex(u)):e.nodeIndex(u),s=o,l=i,!c){for(a=u.previousSibling,r=u.nextSibling,pt.each(pt.grep(u.childNodes),(function(e){Cn(e)&&(e.nodeValue=e.nodeValue.replace(/\uFEFF/g,""))}));u=e.get(n.id+"_"+t);)e.remove(u,!0);a&&r&&a.nodeType===r.nodeType&&Cn(a)&&!dt.opera&&(i=a.nodeValue.length,a.appendData(r.nodeValue),e.remove(r),s=a,l=i)}return E.some(al(s,l))}return E.none()},tc=function(e,t,n){return function(e,t,n){return 2===t?_l(rs,n,e):3===t?(i=(o=e).getRng(),{start:pl(o.dom.getRoot(),al.fromRangeStart(i)),end:pl(o.dom.getRoot(),al.fromRangeEnd(i))}):t?{rng:e.getRng()}:Dl(e,!1);var o,i}(e,t,n)},nc=function(e,t){(function(e,t){var n,o,i,r,a,s,l,u,c,d,f,h,g,m=e.dom;if(t){if(pt.isArray(t.start))return h=t,g=(f=m).createRng(),Ju(f,!0,h,g)&&Ju(f,!1,h,g)?E.some(g):E.none();if("string"==typeof t.start)return E.some((u=t,d=(l=m).createRng(),c=vl(l.getRoot(),u.start),d.setStart(c.container(),c.offset()),c=vl(l.getRoot(),u.end),d.setEnd(c.container(),c.offset()),d));if(t.hasOwnProperty("id"))return a=ec(i=m,"start",r=t),s=ec(i,"end",r),vs(a,s.or(a),(function(e,t){var n=i.createRng();return n.setStart(Xu(i,e.container()),e.offset()),n.setEnd(Xu(i,t.container()),t.offset()),n}));if(t.hasOwnProperty("name"))return E.from((n=m).select((o=t).name)[o.index]).map((function(e){var t=n.createRng();return t.selectNode(e),t}));if(t.hasOwnProperty("rng"))return E.some(t.rng)}return E.none()})(e,t).each((function(t){e.setRng(t)}))},oc=function(e){return fn(e)&&"SPAN"===e.tagName&&"bookmark"===e.getAttribute("data-mce-type")},ic=function(e){return" "===e},rc=function(e){return""!==e&&-1!==" \f\n\r\t\v".indexOf(e)},ac=function(e){return!rc(e)&&!ic(e)},sc=function(e){return!!e.nodeType},lc=function(e,t,n){var o,i,r,a,s=n.startOffset,l=n.startContainer;if(!(n.startContainer===n.endContainer&&(a=n.startContainer.childNodes[n.startOffset])&&/^(IMG)$/.test(a.nodeName)||1!==l.nodeType))for(s<(r=l.childNodes).length?o=new Ir(l=r[s],e.getParent(l,e.isBlock)):(o=new Ir(l=r[r.length-1],e.getParent(l,e.isBlock))).next(!0),i=o.current();i;i=o.next())if(3===i.nodeType&&!fc(i))return n.setStart(i,0),void t.setRng(n)},uc=function(e,t,n){if(e){var o=t?"nextSibling":"previousSibling";for(e=n?e:e[o];e;e=e[o])if(1===e.nodeType||!fc(e))return e}},cc=function(e,t){return sc(t)&&(t=t.nodeName),!!e.schema.getTextBlockElements()[t.toLowerCase()]},dc=function(e,t,n){return e.schema.isValidChild(t,n)},fc=function(e){return e&&Cn(e)&&/^([\t \r\n]+|)$/.test(e.nodeValue)},hc=function(e,t){return"string"!=typeof e?e=e(t):t&&(e=e.replace(/%(\w+)/g,(function(e,n){return t[n]||e}))),e},gc=function(e,t){return e=""+((e=e||"").nodeName||e),t=""+((t=t||"").nodeName||t),e.toLowerCase()===t.toLowerCase()},mc=function(e,t,n){return"color"!==n&&"backgroundColor"!==n||(t=e.toHex(t)),"fontWeight"===n&&700===t&&(t="bold"),"fontFamily"===n&&(t=t.replace(/[\'\"]/g,"").replace(/,\s+/g,",")),""+t},pc=function(e,t,n){return mc(e,e.getStyle(t,n),n)},vc=function(e,t){var n;return e.getParent(t,(function(t){return(n=e.getStyle(t,"text-decoration"))&&"none"!==n})),n},yc=function(e,t,n){return e.getParents(t,n,e.getRoot())},bc=function(e,t,n){var o=["inline","block","selector","attributes","styles","classes"],i=function(e){return ce(e,(function(e,t){return z(o,(function(e){return e===t}))}))};return z(e.formatter.get(t),(function(t){var o=i(t);return z(e.formatter.get(n),(function(e){var t,n,r,l=i(e);return t=o,n=l,void 0===r&&(r=s),a(r).eq(t,n)}))}))},Cc=oc,Tc=yc,xc=fc,Ec=cc,_c=function(e,t){for(var n=t;n;){if(fn(n)&&e.getContentEditable(n))return"false"===e.getContentEditable(n)?n:t;n=n.parentNode}return t},Ic=function(e,t,n,o){for(var i=t.data,r=n;e?0<=r:r<i.length;e?r--:r++)if(o(i.charAt(r)))return e?r+1:r;return-1},Dc=function(e,t,n){return Ic(e,t,n,(function(e){return ic(e)||rc(e)}))},Oc=function(e,t,n){return Ic(e,t,n,ac)},wc=function(e,t,n,o,i,r){var a,s=e.getParent(n,e.isBlock)||t,l=function(t,n,o){var r=ns(e);return E.from((i?r.backwards:r.forwards)(t,n,(function(e,t){return Cc(e.parentNode)?-1:o(i,a=e,t)}),s))};return l(n,o,Dc).bind((function(e){return r?l(e.container,e.offset+(i?-1:0),Oc):E.some(e)})).orThunk((function(){return a?E.some({container:a,offset:i?0:a.length}):E.none()}))},Rc=function(e,t,n,o,i){Cn(o)&&0===o.nodeValue.length&&o[i]&&(o=o[i]);for(var r=Tc(e,o),a=0;a<r.length;a++)for(var s=0;s<t.length;s++){var l=t[s];if((!("collapsed"in l)||l.collapsed===n.collapsed)&&e.is(r[a],l.selector))return r[a]}return o},Sc=function(e,t,n,o){var i,r=e.dom,a=r.getRoot();if(t[0].wrapper||(i=r.getParent(n,t[0].block,a)),!i){var s=r.getParent(n,"LI,TD,TH");i=r.getParent(Cn(n)?n.parentNode:n,(function(t){return t!==a&&Ec(e,t)}),s)}if(i&&t[0].wrapper&&(i=Tc(r,i,"ul,ol").reverse()[0]||i),!i)for(i=n;i[o]&&!r.isBlock(i[o])&&!gc(i=i[o],"br"););return i||n},kc=function(e,t,n,o,i,r,a){var s,l,u;s=l=a?n:i;var c,d=a?"previousSibling":"nextSibling",f=e.getRoot();if(Cn(s)&&!xc(s)&&(a?0<o:r<s.nodeValue.length))return s;for(;;){if(!t[0].block_expand&&e.isBlock(l))return l;for(u=l[d];u;u=u[d])if(!Cc(u)&&!xc(u)&&("BR"!==(c=u).nodeName||!c.getAttribute("data-mce-bogus")||c.nextSibling))return l;if(l===f||l.parentNode===f){s=l;break}l=l.parentNode}return s},Ac=function(e,t,n,o){void 0===o&&(o=!1);var i=t.startContainer,r=t.startOffset,a=t.endContainer,s=t.endOffset,l=e.dom;return fn(i)&&i.hasChildNodes()&&(i=Ds(i,r),Cn(i)&&(r=0)),fn(a)&&a.hasChildNodes()&&(a=Ds(a,t.collapsed?s:s-1),Cn(a)&&(s=a.nodeValue.length)),i=_c(l,i),a=_c(l,a),(Cc(i.parentNode)||Cc(i))&&(i=Cc(i)?i:i.parentNode,Cn(i=t.collapsed?i.previousSibling||i:i.nextSibling||i)&&(r=t.collapsed?i.length:0)),(Cc(a.parentNode)||Cc(a))&&(a=Cc(a)?a:a.parentNode,Cn(a=t.collapsed?a.nextSibling||a:a.previousSibling||a)&&(s=t.collapsed?0:a.length)),t.collapsed&&(wc(l,e.getBody(),i,r,!0,o).each((function(e){i=e.container,r=e.offset})),wc(l,e.getBody(),a,s,!1,o).each((function(e){a=e.container,s=e.offset}))),(n[0].inline||n[0].block_expand)&&(n[0].inline&&Cn(i)&&0!==r||(i=kc(l,n,i,r,a,s,!0)),n[0].inline&&Cn(a)&&s!==a.nodeValue.length||(a=kc(l,n,i,r,a,s,!1))),n[0].selector&&!1!==n[0].expand&&!n[0].inline&&(i=Rc(l,n,t,i,"previousSibling"),a=Rc(l,n,t,a,"nextSibling")),(n[0].block||n[0].selector)&&(i=Sc(e,n,i,"previousSibling"),a=Sc(e,n,a,"nextSibling"),n[0].block&&(l.isBlock(i)||(i=kc(l,n,i,r,a,s,!0)),l.isBlock(a)||(a=kc(l,n,i,r,a,s,!1)))),fn(i)&&(r=l.nodeIndex(i),i=i.parentNode),fn(a)&&(s=l.nodeIndex(a)+1,a=a.parentNode),{startContainer:i,startOffset:r,endContainer:a,endOffset:s}},Nc=function(e,t){var n=e.childNodes;return t>=n.length?t=n.length-1:t<0&&(t=0),n[t]||e},Mc=function(e,t,n){var o=t.startContainer,i=t.startOffset,r=t.endContainer,a=t.endOffset,s=function(e){var t;return 3===(t=e[0]).nodeType&&t===o&&i>=t.nodeValue.length&&e.splice(0,1),t=e[e.length-1],0===a&&0<e.length&&t===r&&3===t.nodeType&&e.splice(e.length-1,1),e},l=function(e,t,n){for(var o=[];e&&e!==n;e=e[t])o.push(e);return o},u=function(e,t){do{if(e.parentNode===t)return e;e=e.parentNode}while(e)},c=function(e,t,o){for(var i=o?"nextSibling":"previousSibling",r=e,a=r.parentNode;r&&r!==t;r=a){a=r.parentNode;var u=l(r===e?r:r[i],i);u.length&&(o||u.reverse(),n(s(u)))}};if(1===o.nodeType&&o.hasChildNodes()&&(o=Nc(o,i)),1===r.nodeType&&r.hasChildNodes()&&(r=Nc(r,a-1)),o===r)return n(s([o]));for(var d=e.findCommonAncestor(o,r),f=o;f;f=f.parentNode){if(f===r)return c(o,d,!0);if(f===d)break}for(f=r;f;f=f.parentNode){if(f===o)return c(r,d);if(f===d)break}var h=u(o,d)||o,g=u(r,d)||r;c(o,h,!0);var m=l(h===o?h:h.nextSibling,"nextSibling",g===r?g.nextSibling:g);m.length&&n(s(m)),c(r,g)},Kc=function(e){var t=[];if(e)for(var n=0;n<e.rangeCount;n++)t.push(e.getRangeAt(n));return t},Pc=function(e,t){var n=Pa(t,"td[data-mce-selected],th[data-mce-selected]");return 0<n.length?n:function(e){return $(X(e,(function(e){var t=Is(e);return t?[yt.fromDom(t)]:[]})),Yn)}(e)},Lc=function(e){return Pc(Kc(e.selection.getSel()),yt.fromDom(e.getBody()))},Bc=function(e){return zt(e).fold(c([e]),(function(t){return[e].concat(Bc(t))}))},Fc=function(e){return Vt(e).fold(c([e]),(function(t){return"br"===bt(t)?Mt(t).map((function(t){return[e].concat(Fc(t))})).getOr([]):[e].concat(Fc(t))}))},zc=function(e,t){return vs((a=(r=t).startContainer,s=r.startOffset,Cn(a)?0===s?E.some(yt.fromDom(a)):E.none():E.from(a.childNodes[s]).map(yt.fromDom)),(o=(n=t).endContainer,i=n.endOffset,Cn(o)?i===o.data.length?E.some(yt.fromDom(o)):E.none():E.from(o.childNodes[i-1]).map(yt.fromDom)),(function(t,n){var o=j(Bc(e),f(Rt,t)),i=j(Fc(e),f(Rt,n));return o.isSome()&&i.isSome()})).getOr(!1);var n,o,i,r,a,s},Vc=function(e,t,n,o){var i=n,r=new Ir(n,i),a=e.schema.getNonEmptyElements();do{if(3===n.nodeType&&0!==pt.trim(n.nodeValue).length)return void(o?t.setStart(n,0):t.setEnd(n,n.nodeValue.length));if(a[n.nodeName]&&!/^(TD|TH)$/.test(n.nodeName))return void(o?t.setStartBefore(n):"BR"===n.nodeName?t.setEndBefore(n):t.setEndAfter(n))}while(n=o?r.next():r.prev());"BODY"===i.nodeName&&(o?t.setStart(i,0):t.setEnd(i,i.childNodes.length))},Hc=function(e){var t=e.selection.getSel();return t&&0<t.rangeCount},Wc=function(e,t){var n=Lc(e);0<n.length?H(n,(function(n){var o=n.dom(),i=e.dom.createRng();i.setStartBefore(o),i.setEndAfter(o),t(i,!0)})):t(e.selection.getRng(),!1)},$c=function(e,t,n){var o=Dl(e,t);n(o),e.moveToBookmark(o)},Uc=function(e,t){var n=function(t){return e(t)?E.from(t.dom().nodeValue):E.none()};return{get:function(t){if(!e(t))throw new Error("Can only get text value of a text node");return n(t).getOr("")},getOption:n,set:function(t,n){if(!e(t))throw new Error("Can only set raw text value of a text node");t.dom().nodeValue=n}}}(Et),qc=function(e){return Uc.get(e)},jc=function(e,t,n,o){var i=t.uid,r=void 0===i?Ya("mce-annotation"):i,a=function(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(o=Object.getOwnPropertySymbols(e);i<o.length;i++)t.indexOf(o[i])<0&&Object.prototype.propertyIsEnumerable.call(e,o[i])&&(n[o[i]]=e[o[i]])}return n}(t,["uid"]),s=yt.fromTag("span",e);Na(s,$a()),Rn(s,""+qa(),r),Rn(s,""+Ua(),n);var l,u=o(r,a),c=u.attributes,d=u.classes,f=void 0===d?[]:d;return Sn(s,void 0===c?{}:c),l=s,H(f,(function(e){Na(l,e)})),s},Gc=function(e){var t,n=(t={},{register:function(e,n){t[e]={name:e,settings:n}},lookup:function(e){return t.hasOwnProperty(e)?E.from(t[e]).map((function(e){return e.settings})):E.none()}});!function(e,t){e.on("init",(function(){e.serializer.addNodeFilter("span",(function(e){H(e,(function(e){E.from(e.attr(Ua())).bind(t.lookup).each((function(t){!1===t.persistent&&e.unwrap()}))}))}))}))}(e,n);var o=function(e,t){var n=xa({}),o=function(e,t){i(e,(function(e){return t(e),e}))},i=function(e,t){var o=n.get(),i=t(o.hasOwnProperty(e)?o[e]:{listeners:[],previous:xa(E.none())});o[e]=i,n.set(o)},r=Sa((function(){var t,r,a=n.get(),s=(t=ne(a),(r=K.call(t,0)).sort(void 0),r);H(s,(function(t){i(t,(function(n){var i=n.previous.get();return ja(e,E.some(t)).fold((function(){var e;i.isSome()&&(o(e=t,(function(t){H(t.listeners,(function(t){return t(!1,e)}))})),n.previous.set(E.none()))}),(function(e){var t,r,a,s=e.uid,l=e.name,u=e.elements;i.is(s)||(r=s,a=u,o(t=l,(function(e){H(e.listeners,(function(e){return e(!0,t,{uid:r,nodes:V(a,(function(e){return e.dom()}))})}))})),n.previous.set(E.some(s)))})),{previous:n.previous,listeners:n.listeners}}))}))}),30);return e.on("remove",(function(){r.cancel()})),e.on("NodeChange",(function(){r.throttle()})),{addListener:function(e,t){i(e,(function(e){return{previous:e.previous,listeners:e.listeners.concat([t])}}))}}}(e);return{register:function(e,t){n.register(e,t)},annotate:function(t,o){n.lookup(t).each((function(n){!function(e,t,n,o){e.undoManager.transact((function(){var i,r,a,s=e.selection,l=s.getRng(),u=0<Lc(e).length;if(l.collapsed&&!u&&(a=Ac(i=e,r=l,[{inline:!0}]),r.setStart(a.startContainer,a.startOffset),r.setEnd(a.endContainer,a.endOffset),i.selection.setRng(r)),s.getRng().collapsed&&!u){var c=jc(e.getDoc(),o,t,n.decorate);Za(c,Oo),s.getRng().insertNode(c.dom()),s.select(c.dom())}else $c(s,!1,(function(){Wc(e,(function(i){!function(e,t,n,o,i){var r=[],a=jc(e.getDoc(),i,n,o),s=xa(E.none()),l=function(){s.set(E.none())},u=function(e){H(e,c)},c=function(t){var n,o;switch(function(e,t,n,o){return Nt(t).fold((function(){return"skipping"}),(function(i){return"br"===o||Et(a=t)&&"\ufeff"===qc(a)?"valid":xt(r=t)&&Ma(r,$a())?"existing":ju(t)?"caret":dc(e,n,o)&&dc(e,bt(i),n)?"valid":"invalid-child";var r,a}))}(e,t,"span",bt(t))){case"invalid-child":l();var i=Bt(t);u(i),l();break;case"valid":var c=s.get().getOrThunk((function(){var e=Qa(a);return r.push(e),s.set(E.some(e)),e}));Ut(n=t,o=c),Gt(o,n)}};Mc(e.dom,t,(function(e){var t;l(),t=V(e,yt.fromDom),u(t)}))}(e,i,t,n.decorate,o)}))}))}))}(e,t,n,o)}))},annotationChanged:function(e,t){o.addListener(e,t)},remove:function(t){ja(e,E.some(t)).each((function(e){H(e.elements,Jt)}))},getAll:function(t){var n,o,i,r,a=(n=t,o=yt.fromDom(e.getBody()),i=Pa(o,"["+Ua()+'="'+n+'"]'),r={},H(i,(function(e){var t=kn(e,qa()),n=r.hasOwnProperty(t)?r[t]:[];r[t]=n.concat([e])})),r);return re(a,(function(e){return V(e,(function(e){return e.dom()}))}))}}},Xc={"#text":3,"#comment":8,"#cdata":4,"#pi":7,"#doctype":10,"#document-fragment":11},Yc=function(e,t,n){var o=n?"lastChild":"firstChild",i=n?"prev":"next";if(e[o])return e[o];if(e!==t){var r=e[i];if(r)return r;for(var a=e.parent;a&&a!==t;a=a.parent)if(r=a[i])return r}},Zc=function(e){if(!Qn(e.value))return!1;var t=e.parent;return!t||"span"===t.name&&!t.attr("style")||!/^[ ]+$/.test(e.value)},Jc=function(e){var t="a"===e.name&&!e.attr("href")&&e.attr("id");return e.attr("name")||e.attr("id")&&!e.firstChild||e.attr("data-mce-bookmark")||t},Qc=(ed.create=function(e,t){var n=new ed(e,Xc[e]||1);return t&&ie(t,(function(e,t){n.attr(t,e)})),n},ed.prototype.replace=function(e){return e.parent&&e.remove(),this.insert(e,this),this.remove(),this},ed.prototype.attr=function(e,t){var n,o=this;if("string"!=typeof e)return null!=e&&ie(e,(function(e,t){o.attr(t,e)})),o;if(n=o.attributes){if(void 0===t)return n.map[e];if(null===t){if(e in n.map){delete n.map[e];for(var i=n.length;i--;)if(n[i].name===e)return n.splice(i,1),o}return o}if(e in n.map){for(i=n.length;i--;)if(n[i].name===e){n[i].value=t;break}}else n.push({name:e,value:t});return n.map[e]=t,o}},ed.prototype.clone=function(){var e,t=new ed(this.name,this.type);if(e=this.attributes){var n=[];n.map={};for(var o=0,i=e.length;o<i;o++){var r=e[o];"id"!==r.name&&(n[n.length]={name:r.name,value:r.value},n.map[r.name]=r.value)}t.attributes=n}return t.value=this.value,t.shortEnded=this.shortEnded,t},ed.prototype.wrap=function(e){return this.parent.insert(e,this),e.append(this),this},ed.prototype.unwrap=function(){for(var e=this.firstChild;e;){var t=e.next;this.insert(e,this,!0),e=t}this.remove()},ed.prototype.remove=function(){var e=this.parent,t=this.next,n=this.prev;return e&&(e.firstChild===this?(e.firstChild=t)&&(t.prev=null):n.next=t,e.lastChild===this?(e.lastChild=n)&&(n.next=null):t.prev=n,this.parent=this.next=this.prev=null),this},ed.prototype.append=function(e){e.parent&&e.remove();var t=this.lastChild;return t?((t.next=e).prev=t,this.lastChild=e):this.lastChild=this.firstChild=e,e.parent=this,e},ed.prototype.insert=function(e,t,n){e.parent&&e.remove();var o=t.parent||this;return n?(t===o.firstChild?o.firstChild=e:t.prev.next=e,e.prev=t.prev,(e.next=t).prev=e):(t===o.lastChild?o.lastChild=e:t.next.prev=e,e.next=t.next,(e.prev=t).next=e),e.parent=o,e},ed.prototype.getAll=function(e){for(var t=[],n=this.firstChild;n;n=Yc(n,this))n.name===e&&t.push(n);return t},ed.prototype.empty=function(){if(this.firstChild){for(var e=[],t=this.firstChild;t;t=Yc(t,this))e.push(t);for(var n=e.length;n--;)(t=e[n]).parent=t.firstChild=t.lastChild=t.next=t.prev=null}return this.firstChild=this.lastChild=null,this},ed.prototype.isEmpty=function(e,t,n){void 0===t&&(t={});var o=this.firstChild;if(Jc(this))return!1;if(o)do{if(1===o.type){if(o.attr("data-mce-bogus"))continue;if(e[o.name])return!1;if(Jc(o))return!1}if(8===o.type)return!1;if(3===o.type&&!Zc(o))return!1;if(3===o.type&&o.parent&&t[o.parent.name]&&Qn(o.value))return!1;if(n&&n(o))return!1}while(o=Yc(o,this));return!0},ed.prototype.walk=function(e){return Yc(this,null,e)},ed);function ed(e,t){this.name=e,1===(this.type=t)&&(this.attributes=[],this.attributes.map={})}var td=pt.makeMap,nd=function(e){var t=[],n=(e=e||{}).indent,o=td(e.indent_before||""),i=td(e.indent_after||""),r=po.getEncodeFunc(e.entity_encoding||"raw",e.entities),a="html"===e.element_format;return{start:function(e,s,l){var u,c,d,f;if(n&&o[e]&&0<t.length&&0<(f=t[t.length-1]).length&&"\n"!==f&&t.push("\n"),t.push("<",e),s)for(u=0,c=s.length;u<c;u++)t.push(" ",(d=s[u]).name,'="',r(d.value,!0),'"');t[t.length]=!l||a?">":" />",l&&n&&i[e]&&0<t.length&&0<(f=t[t.length-1]).length&&"\n"!==f&&t.push("\n")},end:function(e){var o;t.push("</",e,">"),n&&i[e]&&0<t.length&&0<(o=t[t.length-1]).length&&"\n"!==o&&t.push("\n")},text:function(e,n){0<e.length&&(t[t.length]=n?e:r(e))},cdata:function(e){t.push("<![CDATA[",e,"]]>")},comment:function(e){t.push("\x3c!--",e,"--\x3e")},pi:function(e,o){o?t.push("<?",e," ",r(o),"?>"):t.push("<?",e,"?>"),n&&t.push("\n")},doctype:function(e){t.push("<!DOCTYPE",e,">",n?"\n":"")},reset:function(){t.length=0},getContent:function(){return t.join("").replace(/\n$/,"")}}},od=function(e,t){void 0===t&&(t=Do());var n=nd(e);return(e=e||{}).validate=!("validate"in e)||e.validate,{serialize:function(o){var i=e.validate,r={3:function(e){n.text(e.value,e.raw)},8:function(e){n.comment(e.value)},7:function(e){n.pi(e.name,e.value)},10:function(e){n.doctype(e.value)},4:function(e){n.cdata(e.value)},11:function(e){if(e=e.firstChild)for(;a(e),e=e.next;);}};n.reset();var a=function(e){var o,s,l,u,c,d,f,h,g,m=r[e.type];if(m)m(e);else{if(o=e.name,s=e.shortEnded,l=e.attributes,i&&l&&1<l.length&&((d=[]).map={},g=t.getElementRule(e.name))){for(f=0,h=g.attributesOrder.length;f<h;f++)(u=g.attributesOrder[f])in l.map&&(d.map[u]=c=l.map[u],d.push({name:u,value:c}));for(f=0,h=l.length;f<h;f++)(u=l[f].name)in d.map||(d.map[u]=c=l.map[u],d.push({name:u,value:c}));l=d}if(n.start(e.name,l,s),!s){if(e=e.firstChild)for(;a(e),e=e.next;);n.end(o)}}};return 1!==o.type||e.inner?r[11](o):a(o),n.getContent()}}},id=function(e,t){return e.replace(new RegExp(t.prefix+"_[0-9]+","g"),(function(e){return de(t.uris,e).getOr(e)}))},rd=function(e,t,n){var o,i,r=1,a=e.getShortEndedElements(),s=/<([!?\/])?([A-Za-z0-9\-_\:\.]+)((?:\s+[^"\'>]+(?:(?:"[^"]*")|(?:\'[^\']*\')|[^>]*))*|\/|\s+)>/g;for(s.lastIndex=o=n;i=s.exec(t);){if(o=s.lastIndex,"/"===i[1])r--;else if(!i[1]){if(i[2]in a)continue;r++}if(0===r)break}return o},ad=function(e,t){var n=e.exec(t);if(n){var o=n[1],i=n[2];return"string"==typeof o&&"data-mce-bogus"===o.toLowerCase()?i:null}return null};function sd(e,t){void 0===t&&(t=Do());var n=function(){};!1!==(e=e||{}).fix_self_closing&&(e.fix_self_closing=!0);var o=e.comment?e.comment:n,i=e.cdata?e.cdata:n,r=e.text?e.text:n,a=e.start?e.start:n,s=e.end?e.end:n,l=e.pi?e.pi:n,u=e.doctype?e.doctype:n;return{parse:function(n,c){void 0===c&&(c="html"),function(n,c){void 0===c&&(c="html");for(var d,f,h,g,m,p,v,y,b,C,T,x,E,_,I,D,O,w,R,S=n.html,k=0,A=[],N=0,M=po.decode,K=pt.makeMap("src,href,data,background,formaction,poster,xlink:href"),P=/((java|vb)script|mhtml):/i,L="html"===c?0:1,B=function(e){var t,n;for(t=A.length;t--&&A[t].name!==e;);if(0<=t){for(n=A.length-1;t<=n;n--)(e=A[n]).valid&&s(e.name);A.length=t}},F=function(e,t){return r(id(e,n),t)},z=function(t){""!==t&&(">"===t.charAt(0)&&(t=" "+t),e.allow_conditional_comments||"[if"!==t.substr(0,3).toLowerCase()||(t=" "+t),o(id(t,n)))},V=function(e,t){var n=e||"",o=!$e(n,"--"),i=function(e,t,n){void 0===n&&(n=0);var o=e.toLowerCase();if(-1!==o.indexOf("[if ",n)&&/^\s*\[if [\w\W]+\]>.*<!\[endif\](--!?)?>/.test(o.substr(n))){var i=o.indexOf("[endif]",n);return o.indexOf(">",i)}if(t){var r=o.indexOf(">",n);return-1!==r?r:o.length}var a=/--!?>/;a.lastIndex=n;var s=a.exec(e);return s?s.index+s[0].length:o.length}(S,o,t);return e=S.substr(t,i-t),z(o?n+e:e),i+1},H=function(t,o,i,r,a){var s,l,u,c,d,f;if(u=(o=o.toLowerCase())in j?o:M(i||r||a||""),i=de(n.uris,u).getOr(u),G&&!y&&0==(0===(c=o).indexOf("data-")||0===c.indexOf("aria-"))){if(!(s=_[o])&&I){for(l=I.length;l--&&!(s=I[l]).pattern.test(o););-1===l&&(s=null)}if(!s)return;if(s.validValues&&!(i in s.validValues))return}if(K[o]&&!e.allow_script_urls){var h=i.replace(/[\s\u0000-\u001F]+/g,"");try{h=decodeURIComponent(h)}catch(D){h=unescape(h)}if(P.test(h))return;if(f=h,!(d=e).allow_html_data_urls&&(/^data:image\//i.test(f)?!1===d.allow_svg_data_urls&&/^data:image\/svg\+xml/i.test(f):/^data:/i.test(f)))return}y&&(o in K||0===o.indexOf("on"))||(g.map[o]=i,g.push({name:o,value:i}))},W=new RegExp("<(?:(?:!--([\\w\\W]*?)--!?>)|(?:!\\[CDATA\\[([\\w\\W]*?)\\]\\]>)|(?:![Dd][Oo][Cc][Tt][Yy][Pp][Ee]([\\w\\W]*?)>)|(?:!(--)?)|(?:\\?([^\\s\\/<>]+) ?([\\w\\W]*?)[?/]>)|(?:\\/([A-Za-z][A-Za-z0-9\\-_\\:\\.]*)>)|(?:([A-Za-z][A-Za-z0-9\\-_\\:\\.]*)((?:\\s+[^\"'>]+(?:(?:\"[^\"]*\")|(?:'[^']*')|[^>]*))*|\\/|\\s+)>))","g"),$=/([\w:\-]+)(?:\s*=\s*(?:(?:\"((?:[^\"])*)\")|(?:\'((?:[^\'])*)\')|([^>\s]+)))?/g,U=t.getShortEndedElements(),q=e.self_closing_elements||t.getSelfClosingElements(),j=t.getBoolAttrs(),G=e.validate,X=e.remove_internals,Y=e.fix_self_closing,Z=t.getSpecialElements(),J=S+">";d=W.exec(J);){var Q=d[0];if(k<d.index&&F(M(S.substr(k,d.index-k))),f=d[7])":"===(f=f.toLowerCase()).charAt(0)&&(f=f.substr(1)),B(f);else if(f=d[8]){if(d.index+Q.length>S.length){F(M(S.substr(d.index))),k=d.index+Q.length;continue}":"===(f=f.toLowerCase()).charAt(0)&&(f=f.substr(1)),b=f in U,Y&&q[f]&&0<A.length&&A[A.length-1].name===f&&B(f);var ee=ad($,d[9]);if(null!==ee){if("all"===ee){k=rd(t,S,W.lastIndex),W.lastIndex=k;continue}T=!1}if(!G||(C=t.getElementRule(f))){if(T=!0,G&&(_=C.attributes,I=C.attributePatterns),(E=d[9])?((y=-1!==E.indexOf("data-mce-type"))&&X&&(T=!1),(g=[]).map={},E.replace($,H)):(g=[]).map={},G&&!y){if(D=C.attributesRequired,O=C.attributesDefault,C.removeEmptyAttrs&&!g.length&&(T=!1),w=C.attributesForced)for(m=w.length;m--;)v=(x=w[m]).name,"{$uid}"===(R=x.value)&&(R="mce_"+N++),g.map[v]=R,g.push({name:v,value:R});if(O)for(m=O.length;m--;)(v=(x=O[m]).name)in g.map||("{$uid}"===(R=x.value)&&(R="mce_"+N++),g.map[v]=R,g.push({name:v,value:R}));if(D){for(m=D.length;m--&&!(D[m]in g.map););-1===m&&(T=!1)}if(x=g.map["data-mce-bogus"]){if("all"===x){k=rd(t,S,W.lastIndex),W.lastIndex=k;continue}T=!1}}T&&a(f,g,b)}else T=!1;if(h=Z[f]){h.lastIndex=k=d.index+Q.length,k=(d=h.exec(S))?(T&&(p=S.substr(k,d.index-k)),d.index+d[0].length):(p=S.substr(k),S.length),T&&(0<p.length&&F(p,!0),s(f)),W.lastIndex=k;continue}b||(E&&E.indexOf("/")===E.length-1?T&&s(f):A.push({name:f,valid:T}))}else if(f=d[1])z(f);else if(f=d[2]){if(!(1==L||e.preserve_cdata||0<A.length&&t.isValidChild(A[A.length-1].name,"#cdata"))){k=V("",d.index+2),W.lastIndex=k;continue}i(f)}else if(f=d[3])u(f);else{if((f=d[4])||"<!"===Q){k=V(f,d.index+Q.length),W.lastIndex=k;continue}if(f=d[5]){if(1!=L){k=V("?",d.index+2),W.lastIndex=k;continue}l(f,d[6])}}k=d.index+Q.length}for(k<S.length&&F(M(S.substr(k))),m=A.length-1;0<=m;m--)(f=A[m]).valid&&s(f.name)}(function(e){for(var t,n=/data:[^;]+;base64,([a-z0-9\+\/=]+)/gi,o=[],i={},r=Ya("img"),a=0,s=0;t=n.exec(e);){var l=t[0],u=r+"_"+s++;i[u]=l,a<t.index&&o.push(e.substr(a,t.index-a)),o.push(u),a=t.index+l.length}return 0===a?{prefix:r,uris:i,html:e}:(a<e.length&&o.push(e.substr(a)),{prefix:r,uris:i,html:o.join("")})}(n),c)}}}(sd=sd||{}).findEndTag=rd;var ld,ud,cd=sd,dd=function(e,t){var n,o,i,r,a,s,l,u=t,c=/<(\w+) [^>]*data-mce-bogus="all"[^>]*>/g,d=e.schema;a=e.getTempAttrs(),s=u,l=new RegExp(["\\s?("+a.join("|")+')="[^"]+"'].join("|"),"gi"),u=s.replace(l,"");for(var f=d.getShortEndedElements();r=c.exec(u);)o=c.lastIndex,i=r[0].length,n=f[r[1]]?o:cd.findEndTag(d,u,o),u=u.substring(0,o-i)+u.substring(n),c.lastIndex=o-i;return rs(u)},fd=dd,hd=pt.each,gd=function(e){this.compare=function(t,n){if(t.nodeName!==n.nodeName)return!1;var o=function(t){var n={};return hd(e.getAttribs(t),(function(o){var i=o.nodeName.toLowerCase();0!==i.indexOf("_")&&"style"!==i&&0!==i.indexOf("data-")&&(n[i]=e.getAttrib(t,i))})),n},i=function(e,t){var n,o;for(o in e)if(e.hasOwnProperty(o)){if(void 0===(n=t[o]))return!1;if(e[o]!==n)return!1;delete t[o]}for(o in t)if(t.hasOwnProperty(o))return!1;return!0};return!(!i(o(t),o(n))||!i(e.parseStyle(e.getAttrib(t,"style")),e.parseStyle(e.getAttrib(n,"style")))||oc(t)||oc(n))}},md=function(e,t,n){return E.from(n.container()).filter(Cn).exists((function(o){var i=e?0:-1;return t(o.data.charAt(n.offset()+i))}))},pd=f(md,!0,rc),vd=f(md,!1,rc),yd=function(e){var t=e.container();return Cn(t)&&0===t.data.length},bd=function(e,t){return function(n){return E.from(hu(e?0:-1,n)).filter(t).isSome()}},Cd=function(e){return"IMG"===e.nodeName&&"block"===Nn(yt.fromDom(e),"display")},Td=function(e){return Dn(e)&&!(fn(t=e)&&"all"===t.getAttribute("data-mce-bogus"));var t},xd=bd(!0,Cd),Ed=bd(!1,Cd),_d=bd(!0,vn),Id=bd(!1,vn),Dd=bd(!0,Td),Od=bd(!1,Td),wd=function(e,t){return Ls(t)&&!1===(o=e,Cn(i=t)&&Qn(i.data)&&!1===function(e,t){var n,o,i=yt.fromDom(e);return n=yt.fromDom(t),o=f(Rt,i),Va(n,"pre,code",o).isSome()}(o,i))||fn(n=t)&&"A"===n.nodeName&&n.hasAttribute("name")||Rd(t);var n,o,i},Rd=mn("data-mce-bookmark"),Sd=mn("data-mce-bogus"),kd=function(e){return fn(e)&&"all"===e.getAttribute("data-mce-bogus")},Ad=function(e,t){return void 0===t&&(t=!0),function(e,t){var n,o=0;if(wd(e,e))return!1;if(!(n=e.firstChild))return!0;var i=new Ir(n,e);do{if(t){if(kd(n)){n=i.next(!0);continue}if(Sd(n)){n=i.next();continue}}if(_n(n))o++,n=i.next();else{if(wd(e,n))return!1;n=i.next()}}while(n);return o<=1}(e.dom(),t)},Nd=function(e){Yt(e),Gt(e,yt.fromHtml('<br data-mce-bogus="1">'))},Md=function(e){Vt(e).each((function(t){Mt(t).each((function(n){Hn(e)&&$n(t)&&Hn(n)&&Zt(t)}))}))},Kd=function(e,t){return function(e,t,n){return St(t,e)?function(e,t){for(var n=N(t)?t:y,o=e.dom(),i=[];null!=o.parentNode;){var r=o.parentNode,a=yt.fromDom(r);if(i.push(a),!0===n(a))break;o=r}return i}(e,(function(e){return n(e)||Rt(e,t)})).slice(0,-1):[]}(e,t,c(!1))},Pd=function(e,t){return[e].concat(Kd(e,t))},Ld=function(e,t,n){if(0!==n){var o,i,r,a=e.data.slice(t,t+n);e.replaceData(t,n,(i=0===t,r=t+n>=e.data.length,q(o=a,(function(e,t){return rc(t)||ic(t)?e.previousCharIsSpace||""===e.str&&i||e.str.length===o.length-1&&r?{previousCharIsSpace:!1,str:e.str+Oo}:{previousCharIsSpace:!0,str:e.str+" "}:{previousCharIsSpace:!1,str:e.str+t}}),{previousCharIsSpace:!1,str:""}).str))}},Bd=function(e,t){var n=e.data.slice(t),o=n.length-je(n).length;return Ld(e,t,o)},Fd=function(e,t){return o=e,i=(n=t).container(),r=n.offset(),!1===al.isTextPosition(n)&&i===o.parentNode&&r>al.before(o).offset()?al(t.container(),t.offset()-1):t;var n,o,i,r},zd=function(e){return Ls(e.previousSibling)?E.some(Cn(t=e.previousSibling)?al(t,t.data.length):al.after(t)):e.previousSibling?Uu(e.previousSibling):E.none();var t},Vd=function(e){return Ls(e.nextSibling)?E.some(Cn(t=e.nextSibling)?al(t,0):al.before(t)):e.nextSibling?$u(e.nextSibling):E.none();var t},Hd=function(e,t){return zd(t).orThunk((function(){return Vd(t)})).orThunk((function(){return n=e,i=al.before((o=t).previousSibling?o.previousSibling:o.parentNode),Wu(n,i).fold((function(){return Hu(n,al.after(o))}),E.some);var n,o,i}))},Wd=function(e,t){return Vd(t).orThunk((function(){return zd(t)})).orThunk((function(){return Hu(n=e,al.after(o=t)).fold((function(){return Wu(n,al.before(o))}),E.some);var n,o}))},$d=function(e,t,n){return(e?Wd:Hd)(t,n).map(f(Fd,n))},Ud=function(e,t,n){n.fold((function(){e.focus()}),(function(n){e.selection.setRng(n.toRange(),t)}))},qd=function(e,t){return t&&e.schema.getBlockElements().hasOwnProperty(bt(t))},jd=function(e){if(Ad(e)){var t=yt.fromHtml('<br data-mce-bogus="1">');return Yt(e),Gt(e,t),E.some(al.before(t.dom()))}return E.none()},Gd=function(e,t,n,o){void 0===o&&(o=!0);var i,r,a=$d(t,e.getBody(),n.dom()),s=Fa(n,f(qd,e),(i=e.getBody(),function(e){return e.dom()===i})),l=function(e,t,n){var o,i,r,a,s=Mt(e).filter(Et),l=Kt(e).filter(Et);return Zt(e),i=l,r=t,a=function(e,t,o){var i,r,a,s,l=e.dom(),u=t.dom(),c=l.data.length;return r=u,a=n,s=Ge((i=l).data).length,i.appendData(r.data),Zt(yt.fromDom(r)),a&&Bd(i,s),o.container()===u?al(l,c):o},((o=s).isSome()&&i.isSome()&&r.isSome()?E.some(a(o.getOrDie(),i.getOrDie(),r.getOrDie())):E.none()).orThunk((function(){return n&&(s.each((function(e){return t=e.dom(),n=e.dom().length,i=(o=t.data.slice(0,n)).length-Ge(o).length,Ld(t,n-i,i);var t,n,o,i})),l.each((function(e){return Bd(e.dom(),0)}))),t}))}(n,a,(r=n,fe(e.schema.getTextInlineElements(),bt(r))));e.dom.isEmpty(e.getBody())?(e.setContent(""),e.selection.setCursorLocation()):s.bind(jd).fold((function(){o&&Ud(e,t,l)}),(function(n){o&&Ud(e,t,E.some(n))}))},Xd=function(e,t){return{start:e,end:t}},Yd=$r([{removeTable:["element"]},{emptyCells:["cells"]},{deleteCellSelection:["rng","cell"]}]),Zd=function(e,t){return Wa(yt.fromDom(e),"td,th",t)},Jd=function(e,t){return Va(e,"table",t)},Qd=function(e){return!Rt(e.start,e.end)},ef=function(e,t){return Jd(e.start,t).bind((function(n){return Jd(e.end,t).bind((function(e){return Rt(n,e)?E.some(n):E.none()}))}))},tf=function(e){return Pa(e,"td,th")},nf=function(e,t){return ef(t,e).isSome()},of=function(e,t){return G(e,(function(e){return Rt(e,t)}))},rf=function(e){return vs(of((t=e).cells,t.rng.start),of(t.cells,t.rng.end),(function(e,n){return t.cells.slice(e,n+1)})).map((function(t){return t.length===e.cells.length?Yd.removeTable(e.table):Yd.emptyCells(t)}));var t},af=function(e){var t;return(8===Ct(t=e)||"#comment"===bt(t)?Mt:Vt)(e).bind(af).orThunk((function(){return E.some(e)}))},sf=function(e,t){return H(t,Nd),e.selection.setCursorLocation(t[0].dom(),0),!0},lf=function(e,t,n){t.deleteContents();var o,i=af(n).getOr(n),r=yt.fromDom(e.dom.getParent(i.dom(),e.dom.isBlock));if(Ad(r)&&(Nd(r),e.selection.setCursorLocation(r.dom(),0)),!Rt(n,r)){var a=Nt(r).is(n)?[]:Nt(o=r).map(Bt).map((function(e){return $(e,(function(e){return!Rt(o,e)}))})).getOr([]);H(a.concat(Bt(n)),(function(e){Rt(e,r)||St(e,r)||Zt(e)}))}return!0},uf=function(e,t){return Gd(e,!1,t),!0},cf=function(e,t){return j(Pd(t,e),Yn)},df=function(e,t){return j(Pd(t,e),(function(e){return"caption"===bt(e)}))},ff=function(e,t){return Nd(t),e.selection.setCursorLocation(t.dom(),0),E.some(!0)},hf=function(e,t){return(e?_d:Id)(t)},gf=function(e,t){var n,o,i,r,a,s=yt.fromDom(e.selection.getStart(!0)),l=Lc(e);return e.selection.isCollapsed()&&0===l.length?function(e,t,n){var o=yt.fromDom(e.getBody());return df(o,n).fold((function(){return function(e,t,n,o){var i=al.fromRangeStart(e.selection.getRng());return cf(n,o).bind((function(o){return Ad(o)?ff(e,o):(r=n,a=o,s=i,Fu(t,e.getBody(),s).bind((function(e){return cf(r,yt.fromDom(e.getNode())).map((function(e){return!1===Rt(e,a)}))})));var r,a,s})).getOr(!1)}(e,t,o,n)||(r=t,a=al.fromRangeStart((i=e).selection.getRng()),hf(r,a)||Bu(r,i.getBody(),a).map((function(e){return hf(r,e)})).getOr(!1));var i,r,a}),(function(n){return r=t,a=o,s=n,l=al.fromRangeStart((i=e).selection.getRng()),(Ad(s)?ff(i,s):function(e,t,n,o,i){return Fu(n,e.getBody(),i).bind((function(r){return l=n,u=i,c=r,$u((s=o).dom()).bind((function(e){return Uu(s.dom()).map((function(t){return l?u.isEqual(e)&&c.isEqual(t):u.isEqual(t)&&c.isEqual(e)}))})).getOr(!0)?ff(e,o):(a=o,df(t,yt.fromDom(r.getNode())).map((function(e){return!1===Rt(e,a)})));var a,s,l,u,c})).or(E.some(!0))}(i,a,r,s,l)).getOr(!1);var i,r,a,s,l}))}(e,t,s):(o=s,i=yt.fromDom((n=e).getBody()),r=n.selection.getRng(),0!==(a=Lc(n)).length?sf(n,a):function(e,t,n,o){return df(t,o).fold((function(){return o=e,function(e,t){var n,o,i,r,a,s=(n=e,function(e){return Rt(n,e)}),l=(r=Zd((o=t).startContainer,i=s),a=Zd(o.endContainer,i),vs(r,a,Xd));return function(e,t,n){return e.filter((function(e){return i=n,!Qd(o=e)&&ef(o,i).exists((function(e){var t=e.dom().rows;return 1===t.length&&1===t[0].cells.length}))&&zc(e.start,t);var o,i})).map((function(e){return e.start}))}(l,t,s).map((function(e){return Yd.deleteCellSelection(t,e)})).orThunk((function(){return function(e,t,n){return e.filter((function(e){return Qd(e)&&nf(n,e)})).orThunk((function(){return function(e,t){var n=Zd(t.startContainer,e),o=Zd(t.endContainer,e);return t.collapsed?E.none():vs(n,o,Xd).fold((function(){return n.fold((function(){return o.bind((function(t){return Jd(t,e).bind((function(e){return Q(tf(e)).map((function(e){return Xd(e,t)}))}))}))}),(function(t){return Jd(t,e).bind((function(e){return ee(tf(e)).map((function(e){return Xd(t,e)}))}))}))}),(function(t){return nf(e,t)?E.none():Jd((n=t).start,e).bind((function(e){return ee(tf(e)).map((function(e){return Xd(n.start,e)}))}));var n}))}(n,t)})).bind((function(e){return ef(t=e,n).map((function(e){return{rng:t,table:e,cells:tf(e)}}));var t}))}(l,t,s).bind(rf)}))}(t,n).map((function(e){return e.fold(f(uf,o),f(sf,o),f(lf,o))}));var o}),(function(t){return ff(e,t)})).getOr(!1)}(n,i,r,o))},mf=function(t){return t.collapsed?t:function(t){var n=al.fromRangeStart(t),o=al.fromRangeEnd(t),i=t.commonAncestorContainer;return Bu(!1,i,o).map((function(r){return!fu(n,o,i)&&fu(n,r,i)?(a=n.container(),s=n.offset(),l=r.container(),u=r.offset(),(c=e.document.createRange()).setStart(a,s),c.setEnd(l,u),c):t;var a,s,l,u,c})).getOr(t)}(t)},pf=function(e,t){var n=e.getParent(t,e.isBlock);return n&&"LI"===n.nodeName?n:null},vf=function(e,t){var n=al.after(e),o=Mu(t).prev(n);return o?o.toRange():null},yf=hn(["td","th"]),bf=function(e,t){var n,o,i=e.selection.getRng(),r=i.startContainer,a=i.startOffset;i.collapsed&&(o=a,Cn(n=r)&&n.nodeValue[o-1]===Oo)&&Cn(r)&&(r.insertData(a-1," "),r.deleteData(a,1),i.setStart(r,a),i.setEnd(r,a),e.selection.setRng(i)),e.selection.setContent(t)},Cf=function(e,t,n){var o,i,r,a,s,l,u,c,d,f,h,g=e.selection,m=e.dom;/^ | $/.test(t)&&(c=t,f=(u=g.getRng()).startOffset,h=function(e){return d[e]&&3===d[e].nodeType},Cn(d=u.startContainer)&&(0<f?c=c.replace(/^&nbsp;/," "):h("previousSibling")||(c=c.replace(/^ /,"&nbsp;")),f<d.length?c=c.replace(/&nbsp;(<br>|)$/," "):h("nextSibling")||(c=c.replace(/(&nbsp;| )(<br>|)$/,"&nbsp;"))),t=c);var p=e.parser,v=n.merge,y=od({validate:e.getParam("validate")},e.schema),b='<span id="mce_marker" data-mce-type="bookmark">&#xFEFF;&#x200B;</span>';if((r=e.fire("BeforeSetContent",r={content:t,format:"html",selection:!0,paste:n.paste})).isDefaultPrevented())e.fire("SetContent",{content:r.content,format:"html",selection:!0,paste:n.paste});else{-1===(t=r.content).indexOf("{$caret}")&&(t+="{$caret}"),t=t.replace(/\{\$caret\}/,b);var C,T,x,_,I,D=(s=g.getRng()).startContainer||(s.parentElement?s.parentElement():null),O=e.getBody();D===O&&g.isCollapsed()&&m.isBlock(O.firstChild)&&(C=O.firstChild)&&!e.schema.getShortEndedElements()[C.nodeName]&&m.isEmpty(O.firstChild)&&((s=m.createRng()).setStart(O.firstChild,0),s.setEnd(O.firstChild,0),g.setRng(s)),g.isCollapsed()||(function(e){var t=e.dom,n=mf(e.selection.getRng());e.selection.setRng(n);var o,i,r=t.getParent(n.startContainer,yf);o=n,null!==(i=r)&&i===t.getParent(o.endContainer,yf)&&zc(yt.fromDom(i),o)?lf(e,n,yt.fromDom(r)):e.getDoc().execCommand("Delete",!1,null)}(e),x=t,I=(T=e.selection.getRng()).startOffset,Cn(_=T.startContainer)&&T.collapsed&&(_.data[I]===Oo?(_.deleteData(I,1),/[\u00a0| ]$/.test(x)||(x+=" ")):_.data[I-1]===Oo&&(_.deleteData(I-1,1),/[\u00a0| ]$/.test(x)||(x=" "+x))),t=x);var w,R,S,k={context:(o=g.getNode()).nodeName.toLowerCase(),data:n.data,insert:!0},A=p.parse(t,k);if(!0===n.paste&&function(e,t){var n,o,i,r=t.firstChild,a=t.lastChild;return r&&"meta"===r.name&&(r=r.next),a&&"mce_marker"===a.attr("id")&&(a=a.prev),o=a,i=(n=e).getNonEmptyElements(),o&&(o.isEmpty(i)||function(e,t){var n,o;return e.getBlockElements()[t.name]&&(o=t).firstChild&&o.firstChild===o.lastChild&&("br"===(n=t.firstChild).name||n.value===Oo)}(n,o))&&(a=a.prev),!(!r||r!==a||"ul"!==r.name&&"ol"!==r.name)}(e.schema,A)&&pf(m,o))return s=function(e,t,n,o){var i,r,a,s,l,u,c,d,f,h,g,m,p,v,y,b,C,T=(i=t,l=e.serialize(o),a=(r=i.createFragment(l)).firstChild,s=r.lastChild,a&&"META"===a.nodeName&&a.parentNode.removeChild(a),s&&"mce_marker"===s.id&&s.parentNode.removeChild(s),r),x=pf(t,n.startContainer),E=function(e){return 0<e.length&&(!(t=e[e.length-1]).firstChild||function(e){return e&&e.firstChild&&e.firstChild===e.lastChild&&((t=e.firstChild).data===Oo||_n(t));var t}(t))?e.slice(0,-1):e;var t}(pt.grep(T.firstChild.childNodes,(function(e){return"LI"===e.nodeName}))),_=t.getRoot(),I=function(e){var o=al.fromRangeStart(n),i=Mu(t.getRoot()),r=1===e?i.prev(o):i.next(o);return!r||pf(t,r.getNode())!==x};return I(1)?function(e,t,n){var o,i,r,a=e.parentNode;return pt.each(t,(function(t){a.insertBefore(t,e)})),o=n,i=al.before(e),(r=Mu(o).next(i))?r.toRange():null}(x,E,_):I(2)?(u=x,d=_,t.insertAfter((c=E).reverse(),u),vf(c[0],d)):(h=E,g=_,m=f=x,v=(p=n).cloneRange(),y=p.cloneRange(),v.setStartBefore(m),y.setEndAfter(m),b=[v.cloneContents(),y.cloneContents()],(C=f.parentNode).insertBefore(b[0],f),pt.each(h,(function(e){C.insertBefore(e,f)})),C.insertBefore(b[1],f),C.removeChild(f),vf(h[h.length-1],g))}(y,m,e.selection.getRng(),A),e.selection.setRng(s),void e.fire("SetContent",r);if(function(e){for(var t=e;t=t.walk();)1===t.type&&t.attr("data-mce-fragment","1")}(A),"mce_marker"===(l=A.lastChild).attr("id"))for(l=(a=l).prev;l;l=l.walk(!0))if(3===l.type||!m.isBlock(l.name)){e.schema.isValidChild(l.parent.name,"span")&&l.parent.insert(a,l,"br"===l.name);break}if(e._selectionOverrides.showBlockCaretContainer(o),k.invalid){for(bf(e,b),o=g.getNode(),i=e.getBody(),9===o.nodeType?o=l=i:l=o;l!==i;)l=(o=l).parentNode;t=o===i?i.innerHTML:m.getOuterHTML(o),t=y.serialize(p.parse(t.replace(/<span (id="mce_marker"|id=mce_marker).+?<\/span>/i,(function(){return y.serialize(A)})))),o===i?m.setHTML(i,t):m.setOuterHTML(o,t)}else!function(e,t,n){if("all"===n.getAttribute("data-mce-bogus"))n.parentNode.insertBefore(e.dom.createFragment(t),n);else{var o=n.firstChild;!o||o===n.lastChild&&"BR"===o.nodeName?e.dom.setHTML(n,t):bf(e,t)}}(e,t=y.serialize(A),o);!function(e,t){var n=e.schema.getTextInlineElements(),o=e.dom;if(t){var i=e.getBody(),r=new gd(o);pt.each(o.select("*[data-mce-fragment]"),(function(e){for(var t=e.parentNode;t&&t!==i;t=t.parentNode)n[e.nodeName.toLowerCase()]&&r.compare(t,e)&&o.remove(e,!0)}))}}(e,v),function(e,t){var n,o,i=e.dom,r=e.selection;if(t){e.selection.scrollIntoView(t);var a=function(t){for(var n=e.getBody();t&&t!==n;t=t.parentNode)if("false"===e.dom.getContentEditable(t))return t;return null}(t);if(a)return i.remove(t),r.select(a);var s=i.createRng(),l=t.previousSibling;l&&3===l.nodeType?(s.setStart(l,l.nodeValue.length),dt.ie||(o=t.nextSibling)&&3===o.nodeType&&(l.appendData(o.data),o.parentNode.removeChild(o))):(s.setStartBefore(t),s.setEndBefore(t));var u=i.getParent(t,i.isBlock);i.remove(t),u&&i.isEmpty(u)&&(e.$(u).empty(),s.setStart(u,0),s.setEnd(u,0),yf(u)||u.getAttribute("data-mce-fragment")||!(n=function(t){var n=al.fromRangeStart(t);if(n=Mu(e.getBody()).next(n))return n.toRange()}(s))?i.add(u,i.create("br",{"data-mce-bogus":"1"})):(s=n,i.remove(u))),r.setRng(s)}}(e,m.get("mce_marker")),w=e.getBody(),pt.each(w.getElementsByTagName("*"),(function(e){e.removeAttribute("data-mce-fragment")})),R=e.dom,S=e.selection.getStart(),E.from(R.getParent(S,"td,th")).map(yt.fromDom).each(Md),e.fire("SetContent",r),e.addVisual()}},Tf=function(e){var t=Wt(e).dom();return e.dom()===t.activeElement},xf=function(t){return void 0===t&&(t=yt.fromDom(e.document)),E.from(t.dom().activeElement).map(yt.fromDom)},Ef=($r([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),$r([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),function(e,t,n,o){return{start:c(e),soffset:c(t),finish:c(n),foffset:c(o)}}),_f=nt().browser,If=function(e,t){var n=Et(t)?qc(t).length:Bt(t).length+1;return n<e?n:e<0?0:e},Df=function(e){return Ef(e.start(),If(e.soffset(),e.start()),e.finish(),If(e.foffset(),e.finish()))},Of=function(e,t){return!dn(t.dom())&&(St(e,t)||Rt(e,t))},wf=function(e){return function(t){return Of(e,t.start())&&Of(e,t.finish())}},Rf=function(e){return!0===e.inline||_f.isIE()},Sf=function(e){return Ef(yt.fromDom(e.startContainer),e.startOffset,yt.fromDom(e.endContainer),e.endOffset)},kf=function(t){var n=e.document.createRange();try{return n.setStart(t.start().dom(),t.soffset()),n.setEnd(t.finish().dom(),t.foffset()),E.some(n)}catch(g){return E.none()}},Af=function(e){var t=Rf(e)?function(e){var t;return((t=function(e){return yt.fromDom(e.dom().ownerDocument.defaultView)}(e).dom().getSelection())&&0!==t.rangeCount?E.from(t.getRangeAt(0)):E.none()).map(Sf).filter(wf(e))}(yt.fromDom(e.getBody())):E.none();e.bookmark=t.isSome()?t:e.bookmark},Nf=function(e){return(e.bookmark?e.bookmark:E.none()).bind((function(t){return n=yt.fromDom(e.getBody()),E.from(t).filter(wf(n)).map(Df);var n})).bind(kf)},Mf={isEditorUIElement:function(e){var t=e.className.toString();return-1!==t.indexOf("tox-")||-1!==t.indexOf("mce-")}},Kf=ma.DOM,Pf=function(e,t){var n=e.getParam("custom_ui_selector","","string");return null!==Kf.getParent(t,(function(t){return Mf.isEditorUIElement(t)||!!n&&e.dom.is(t,n)}))},Lf=function(t,n){var o=n.editor;(function(t){var n=Ra((function(){Af(t)}),0);t.on("init",(function(){var o,i,r;t.inline&&(o=t,i=n,ma.DOM.bind(e.document,"mouseup",r=function(){i.throttle()}),o.on("remove",(function(){ma.DOM.unbind(e.document,"mouseup",r)}))),function(e,t){var n,o;nt().browser.isIE()?(o=e).on("focusout",(function(){Af(o)})):(n=t,e.on("mouseup touchend",(function(e){n.throttle()}))),e.on("keyup NodeChange",(function(t){var n;"nodechange"===(n=t).type&&n.selectionChange||Af(e)}))}(t,n)})),t.on("remove",(function(){n.cancel()}))})(o),o.on("focusin",(function(){var e=t.focusedEditor;e!==this&&(e&&e.fire("blur",{focusedEditor:this}),t.setActive(this),(t.focusedEditor=this).fire("focus",{blurredEditor:e}),this.focus(!0))})),o.on("focusout",(function(){var n=this;oa.setEditorTimeout(n,(function(){var o=t.focusedEditor;Pf(n,function(){try{return e.document.activeElement}catch(o){return e.document.body}}())||o!==n||(n.fire("blur",{focusedEditor:null}),t.focusedEditor=null)}))})),ld||Kf.bind(e.document,"focusin",ld=function(n){var o=t.activeEditor,i=n.target;o&&i.ownerDocument===e.document&&(i===e.document.body||Pf(o,i)||t.focusedEditor!==o||(o.fire("blur",{focusedEditor:null}),t.focusedEditor=null))})},Bf=function(t,n){t.focusedEditor===n.editor&&(t.focusedEditor=null),t.activeEditor||(Kf.unbind(e.document,"focusin",ld),ld=null)},Ff=function(e,t){(function(e,t){return((n=t).collapsed?E.from(Ds(n.startContainer,n.startOffset)).map(yt.fromDom):E.none()).bind((function(t){return Xn(t)?E.some(t):!1===St(e,t)?E.some(e):E.none()}));var n})(yt.fromDom(e.getBody()),t).bind((function(e){return $u(e.dom())})).fold((function(){e.selection.normalize()}),(function(t){return e.selection.setRng(t.toRange())}))},zf=function(e){if(e.setActive)try{e.setActive()}catch(n){e.focus()}else e.focus()},Vf=function(e){return e.inline?(n=e.getBody())&&function(e){return Tf(e)||xf(Wt(t=e)).filter((function(e){return t.dom().contains(e.dom())})).isSome();var t}(yt.fromDom(n)):(t=e).iframeElement&&Tf(yt.fromDom(t.iframeElement));var t,n},Hf=function(e){var t=e.selection,n=e.getBody(),o=t.getRng();e.quirks.refreshContentEditable(),void 0!==e.bookmark&&!1===Vf(e)&&Nf(e).each((function(t){e.selection.setRng(t),o=t}));var i,r,a=(i=e,r=t.getNode(),i.dom.getParent(r,(function(e){return"true"===i.dom.getContentEditable(e)})));if(e.$.contains(n,a))return zf(a),Ff(e,o),void Wf(e);e.inline||(dt.opera||zf(n),e.getWin().focus()),(dt.gecko||e.inline)&&(zf(n),Ff(e,o)),Wf(e)},Wf=function(e){return e.editorManager.setActive(e)},$f=function(e,t){t(e),e.firstChild&&$f(e.firstChild,t),e.next&&$f(e.next,t)},Uf=function(e,t,n){var o=function(e,t,n){var o={},i={},r=[];for(var a in n.firstChild&&$f(n.firstChild,(function(n){H(e,(function(e){e.name===n.name&&(o[e.name]?o[e.name].nodes.push(n):o[e.name]={filter:e,nodes:[n]})})),H(t,(function(e){"string"==typeof n.attr(e.name)&&(i[e.name]?i[e.name].nodes.push(n):i[e.name]={filter:e,nodes:[n]})}))})),o)o.hasOwnProperty(a)&&r.push(o[a]);for(var s in i)i.hasOwnProperty(s)&&r.push(i[s]);return r}(e,t,n);H(o,(function(e){H(e.filter.callbacks,(function(t){t(e.nodes,e.filter.name,{})}))}))},qf=function(e){return e instanceof Qc},jf=function(e,t){var n;e.dom.setHTML(e.getBody(),t),Vf(n=e)&&$u(n.getBody()).each((function(e){var t=e.getNode(),o=vn(t)?$u(t).getOr(e):e;n.selection.setRng(o.toRange())}))},Gf=function(e,t){return e.splitText(t)},Xf=function(e){var t=e.startContainer,n=e.startOffset,o=e.endContainer,i=e.endOffset;return t===o&&Cn(t)?0<n&&n<t.nodeValue.length&&(t=(o=Gf(t,n)).previousSibling,n<i?(t=o=Gf(o,i-=n).previousSibling,i=o.nodeValue.length,n=0):i=0):(Cn(t)&&0<n&&n<t.nodeValue.length&&(t=Gf(t,n),n=0),Cn(o)&&0<i&&i<o.nodeValue.length&&(i=(o=Gf(o,i).previousSibling).nodeValue.length)),{startContainer:t,startOffset:n,endContainer:o,endOffset:i}},Yf=gc,Zf=function(e,t,n){var o=e.formatter.get(n);if(o)for(var i=0;i<o.length;i++)if(!1===o[i].inherit&&e.dom.is(t,o[i].selector))return!0;return!1},Jf=function(e,t,n,o){var i=e.dom.getRoot();return t!==i&&(t=e.dom.getParent(t,(function(t){return!!Zf(e,t,n)||t.parentNode===i||!!th(e,t,n,o,!0)})),th(e,t,n,o))},Qf=function(e,t,n){return!!Yf(t,n.inline)||!!Yf(t,n.block)||(n.selector?1===t.nodeType&&e.is(t,n.selector):void 0)},eh=function(e,t,n,o,i,r){var a,s,l,u=n[o];if(n.onmatch)return n.onmatch(t,n,o);if(u)if(void 0===u.length){for(a in u)if(u.hasOwnProperty(a)){if(s="attributes"===o?e.getAttrib(t,a):pc(e,t,a),i&&!s&&!n.exact)return;if((!i||n.exact)&&!Yf(s,mc(e,hc(u[a],r),a)))return}}else for(l=0;l<u.length;l++)if("attributes"===o?e.getAttrib(t,u[l]):pc(e,t,u[l]))return n;return n},th=function(e,t,n,o,i){var r,a,s,l,u=e.formatter.get(n),c=e.dom;if(u&&t)for(a=0;a<u.length;a++)if(Qf(e.dom,t,r=u[a])&&eh(c,t,r,"attributes",i,o)&&eh(c,t,r,"styles",i,o)){if(l=r.classes)for(s=0;s<l.length;s++)if(!e.dom.hasClass(t,l[s]))return;return r}},nh=function(e,t,n,o){if(o)return Jf(e,o,t,n);if(o=e.selection.getNode(),Jf(e,o,t,n))return!0;var i=e.selection.getStart();return!(i===o||!Jf(e,i,t,n))},oh=function(e,t,n){var o=[],i={},r=e.selection.getStart();return e.dom.getParent(r,(function(r){for(var a=0;a<t.length;a++){var s=t[a];!i[s]&&th(e,r,s,n)&&(i[s]=!0,o.push(s))}}),e.dom.getRoot()),o},ih=function(e,t){var n,o,i,r,a,s=e.formatter.get(t),l=e.dom;if(s)for(n=e.selection.getStart(),o=yc(l,n),r=s.length-1;0<=r;r--){if(!(a=s[r].selector)||s[r].defaultBlock)return!0;for(i=o.length-1;0<=i;i--)if(l.is(o[i],a))return!0}return!1},rh=os,ah="_mce_caret",sh=function(e){return 0<function(e){for(var t=[];e;){if(3===e.nodeType&&e.nodeValue!==rh||1<e.childNodes.length)return[];1===e.nodeType&&t.push(e),e=e.firstChild}return t}(e).length},lh=function(e){if(e){var t=new Ir(e,e);for(e=t.current();e;e=t.next())if(Cn(e))return e}return null},uh=function(e){var t=yt.fromTag("span");return Sn(t,{id:ah,"data-mce-bogus":"1","data-mce-type":"format-caret"}),e&&Gt(t,yt.fromText(rh)),t},ch=function(e,t,n){void 0===n&&(n=!0);var o,i=e.dom,r=e.selection;if(sh(t))Gd(e,!1,yt.fromDom(t),n);else{var a=r.getRng(),s=i.getParent(t,i.isBlock),l=a.startContainer,u=a.startOffset,c=a.endContainer,d=a.endOffset,f=((o=lh(t))&&o.nodeValue.charAt(0)===rh&&o.deleteData(0,1),o);i.remove(t,!0),l===f&&0<u&&a.setStart(f,u-1),c===f&&0<d&&a.setEnd(f,d-1),s&&i.isEmpty(s)&&Nd(yt.fromDom(s)),r.setRng(a)}},dh=function(e,t,n){void 0===n&&(n=!0);var o=e.dom,i=e.selection;if(t)ch(e,t,n);else if(!(t=Gu(e.getBody(),i.getStart())))for(;t=o.get(ah);)ch(e,t,!1)},fh=function(e,t){return e.appendChild(t),t},hh=function(e,t){var n=U(e,(function(e,t){return fh(e,t.cloneNode(!1))}),t);return fh(n,n.ownerDocument.createTextNode(rh))},gh=function(e,t){return e.schema.getTextInlineElements().hasOwnProperty(bt(t))&&!ju(t.dom())&&!pn(t.dom())},mh={},ph=pe,vh=ge;ud=function(e){var t,n=e.selection.getRng(),o=hn(["pre"]);n.collapsed||(t=e.selection.getSelectedBlocks(),vh(ph(ph(t,o),(function(e){return o(e.previousSibling)&&-1!==ve(t,e.previousSibling)})),(function(e){var t,n;t=e.previousSibling,_r(n=e).remove(),_r(t).append("<br><br>").append(n.childNodes)})))},mh.pre||(mh.pre=[]),mh.pre.push(ud);var yh,bh,Ch=pt.each,Th=function(e){return fn(e)&&!oc(e)&&!ju(e)&&!pn(e)},xh=function(e,t){var n;for(n=e;n;n=n[t]){if(Cn(n)&&0!==n.nodeValue.length)return e;if(fn(n)&&!oc(n))return n}return e},Eh=function(e,t,n){var o,i,r=new gd(e);if(t&&n&&(t=xh(t,"previousSibling"),n=xh(n,"nextSibling"),r.compare(t,n))){for(o=t.nextSibling;o&&o!==n;)o=(i=o).nextSibling,t.appendChild(i);return e.remove(n),pt.each(pt.grep(n.childNodes),(function(e){t.appendChild(e)})),t}return n},_h=function(e,t,n,o){if(o&&!1!==t.merge_siblings){var i=Eh(e,uc(o),o);Eh(e,i,uc(i,!0))}},Ih=function(e,t,n){Ch(e.childNodes,(function(e){Th(e)&&(t(e)&&n(e),e.hasChildNodes()&&Ih(e,t,n))}))},Dh=function(e,t){return function(n){return!(!n||!pc(e,n,t))}},Oh=function(e,t,n){return function(o){var i,r;e.setStyle(o,t,n),""===o.getAttribute("style")&&o.removeAttribute("style"),i=e,"SPAN"===(r=o).nodeName&&0===i.getAttribs(r).length&&i.remove(r,!0)}},wh=$r([{keep:[]},{rename:["name"]},{removed:[]}]),Rh=/^(src|href|style)$/,Sh=pt.each,kh=gc,Ah=function(e,t,n){return e.isChildOf(t,n)&&t!==n&&!e.isBlock(n)},Nh=function(e,t,n){var o,i;if(i=t[n?"startOffset":"endOffset"],fn(o=t[n?"startContainer":"endContainer"])){var r=o.childNodes.length-1;!n&&i&&i--,o=o.childNodes[r<i?r:i]}return Cn(o)&&n&&i>=o.nodeValue.length&&(o=new Ir(o,e.getBody()).next()||o),Cn(o)&&!n&&0===i&&(o=new Ir(o,e.getBody()).prev()||o),o},Mh=function(e,t){var n=t?"firstChild":"lastChild";if(/^(TR|TH|TD)$/.test(e.nodeName)&&e[n]){var o=e[n];return"TR"===e.nodeName&&o[n]||o}return e},Kh=function(e,t,n,o){var i=e.create(n,o);return t.parentNode.insertBefore(i,t),i.appendChild(t),i},Ph=function(e,t,n,o,i){var r=yt.fromDom(t),a=yt.fromDom(e.create(o,i)),s=(n?Lt:Pt)(r);return Xt(a,s),n?(Ut(r,a),jt(a,r)):(qt(r,a),Gt(a,r)),a.dom()},Lh=function(e,t,n,o){return!(t=uc(t,n,o))||"BR"===t.nodeName||e.isBlock(t)},Bh=function(e,t,n,o,i){var r,a,s,l,u,c=e.dom;if(s=c,!(kh(l=o,(u=t).inline)||kh(l,u.block)||u.selector&&fn(l)&&s.is(l,u.selector)||(a=o,t.links&&"A"===a.nodeName)))return wh.keep();var d,f,h,g,m,p,v,y=o;if(t.inline&&"all"===t.remove&&R(t.preserve_attributes)){var b=$(c.getAttribs(y),(function(e){return F(t.preserve_attributes,e.name.toLowerCase())}));if(c.removeAllAttribs(y),H(b,(function(e){return c.setAttrib(y,e.name,e.value)})),0<b.length)return wh.rename("span")}if("all"!==t.remove){Sh(t.styles,(function(e,o){e=mc(c,hc(e,n),o),"number"==typeof o&&(o=e,i=null),!t.remove_similar&&i&&!kh(pc(c,i,o),e)||c.setStyle(y,o,""),r=!0})),r&&""===c.getAttrib(y,"style")&&(y.removeAttribute("style"),y.removeAttribute("data-mce-style")),Sh(t.attributes,(function(e,o){var r;if(e=hc(e,n),"number"==typeof o&&(o=e,i=null),t.remove_similar||!i||kh(c.getAttrib(i,o),e)){if("class"===o&&(e=c.getAttrib(y,o))&&(r="",H(e.split(/\s+/),(function(e){/mce\-\w+/.test(e)&&(r+=(r?" ":"")+e)})),r))return void c.setAttrib(y,o,r);"class"===o&&y.removeAttribute("className"),Rh.test(o)&&y.removeAttribute("data-mce-"+o),y.removeAttribute(o)}})),Sh(t.classes,(function(e){e=hc(e,n),i&&!c.hasClass(i,e)||c.removeClass(y,e)}));for(var C=c.getAttribs(y),T=0;T<C.length;T++){var x=C[T].nodeName;if(0!==x.indexOf("_")&&0!==x.indexOf("data-"))return wh.keep()}}return"none"!==t.remove?(h=t,m=(f=y).parentNode,p=(d=e).dom,v=kl(d),h.block&&(v?m===p.getRoot()&&(h.list_block&&kh(f,h.list_block)||H(te(f.childNodes),(function(e){dc(d,v,e.nodeName.toLowerCase())?g?g.appendChild(e):(g=Kh(p,e,v),p.setAttribs(g,d.settings.forced_root_block_attrs)):g=0}))):p.isBlock(f)&&!p.isBlock(m)&&(Lh(p,f,!1)||Lh(p,f.firstChild,!0,!0)||f.insertBefore(p.create("br"),f.firstChild),Lh(p,f,!0)||Lh(p,f.lastChild,!1,!0)||f.appendChild(p.create("br")))),h.selector&&h.inline&&!kh(h.inline,f)||p.remove(f,!0),wh.removed()):wh.keep()},Fh=function(e,t,n,o,i){return Bh(e,t,n,o,i).fold(y,(function(t){return e.dom.rename(o,t),!0}),b)},zh=function(e,t,n,o){return Bh(e,t,n,o,o).fold(c(o),(function(t){return e.dom.createFragment().appendChild(o),e.dom.rename(o,t)}),c(null))},Vh=function(e,t,n,o,i){var r=e.formatter.get(t),a=r[0],s=!0,l=e.dom,u=e.selection,c=function(o){var s,l,u,c,d,f=(l=t,u=n,c=i,H(yc((s=e).dom,o.parentNode).reverse(),(function(e){if(!d&&"_start"!==e.id&&"_end"!==e.id){var t=th(s,e,l,u,c);t&&!1!==t.split&&(d=e)}})),d);return function(e,t,n,o,i,r,a,s){var l,u,c,d=e.dom;if(n){for(var f=n.parentNode,h=o.parentNode;h&&h!==f;h=h.parentNode){l=d.clone(h,!1);for(var g=0;g<t.length&&null!==(l=zh(e,t[g],s,l));g++);l&&(u&&l.appendChild(u),c=c||l,u=l)}a.mixed&&d.isBlock(n)||(o=d.split(n,o)),u&&(i.parentNode.insertBefore(u,i),c.appendChild(i),a.inline&&_h(d,a,0,u))}return o}(e,r,f,o,o,0,a,n)},d=function(t){var o,i;fn(t)&&l.getContentEditable(t)&&(o=s,s="true"===l.getContentEditable(t),i=!0);var u=te(t.childNodes);if(s&&!i)for(var c=0;c<r.length&&!Fh(e,r[c],n,t,t);c++);if(a.deep&&u.length){for(c=0;c<u.length;c++)d(u[c]);i&&(s=o)}},h=function(e){var t,n=l.get(e?"_start":"_end"),o=n[e?"firstChild":"lastChild"];return oc(t=o)&&fn(t)&&("_start"===t.id||"_end"===t.id)&&(o=o[e?"firstChild":"lastChild"]),Cn(o)&&0===o.data.length&&(o=e?n.previousSibling||n.nextSibling:n.nextSibling||n.previousSibling),l.remove(n,!0),o},g=function(t){var n,o,i=Ac(e,t,r,!0);if(a.split){if(i=Xf(i),(n=Nh(e,i,!0))!==(o=Nh(e,i))){if(n=Mh(n,!0),o=Mh(o,!1),Ah(l,n,o)){var s=E.from(n.firstChild).getOr(n);return c(Ph(l,s,!0,"span",{id:"_start","data-mce-type":"bookmark"})),void h(!0)}if(Ah(l,o,n))return s=E.from(o.lastChild).getOr(o),c(Ph(l,s,!1,"span",{id:"_end","data-mce-type":"bookmark"})),void h(!1);n=Kh(l,n,"span",{id:"_start","data-mce-type":"bookmark"}),o=Kh(l,o,"span",{id:"_end","data-mce-type":"bookmark"});var u=l.createRng();u.setStartAfter(n),u.setEndBefore(o),Mc(l,u,(function(e){H(e,(function(e){oc(e)||oc(e.parentNode)||c(e)}))})),c(n),c(o),n=h(!0),o=h()}else n=o=c(n);i.startContainer=n.parentNode?n.parentNode:n,i.startOffset=l.nodeIndex(n),i.endContainer=o.parentNode?o.parentNode:o,i.endOffset=l.nodeIndex(o)+1}Mc(l,i,(function(t){H(t,(function(t){d(t),H(["underline","line-through","overline"],(function(n){fn(t)&&e.dom.getStyle(t,"text-decoration")===n&&t.parentNode&&vc(l,t.parentNode)===n&&Fh(e,{deep:!1,exact:!0,inline:"span",styles:{textDecoration:n}},null,t)}))}))}))};if(o)if(sc(o)){var m=l.createRng();m.setStartBefore(o),m.setEndAfter(o),g(m)}else g(o);else if("false"!==l.getContentEditable(u.getNode()))u.isCollapsed()&&a.inline&&!Lc(e).length?function(e,t,n,o){var i,r,a,s,l,u,c,d,h=e.dom,g=e.selection,m=[],p=g.getRng(),v=p.startContainer;for(3===(r=v).nodeType&&(p.startOffset!==v.nodeValue.length&&(i=!0),r=r.parentNode);r;){if(th(e,r,t,n,o)){a=r;break}r.nextSibling&&(i=!0),m.push(r),r=r.parentNode}if(a)if(i){var y=g.getBookmark();p.collapse(!0);var b=Ac(e,p,e.formatter.get(t),!0);b=Xf(b),e.formatter.remove(t,n,b,o),g.moveToBookmark(y)}else{var C=Gu(e.getBody(),a),T=uh(!1).dom();l=T,(d=(c=(s=e).dom).getParent(u=null!==C?C:a,f(cc,s)))&&c.isEmpty(d)?u.parentNode.replaceChild(l,u):(function(e){var t=Pa(e,"br"),n=$(function(e){for(var t=[],n=e.dom();n;)t.push(yt.fromDom(n)),n=n.lastChild;return t}(e).slice(-1),$n);t.length===n.length&&H(n,Zt)}(yt.fromDom(u)),c.isEmpty(u)?u.parentNode.replaceChild(l,u):c.insertAfter(l,u));var x=function(e,t,n,o,i,r){var a=e.formatter,s=e.dom,l=$(ne(a.get()),(function(e){return e!==o&&!We(e,"removeformat")})),u=function(e,t,n){return q(n,(function(n,o){var i=z(e.formatter.get(o),(function(e){var t=function(e){return 1<e.length&&"%"===e.charAt(0)};return z(["styles","attributes"],(function(n){return de(e,n).exists((function(e){var n=R(e)?e:function(e){return t=[],ie(e,(function(e,n){t.push(e)})),t;var t}(e);return z(n,t)}))}))}));return e.formatter.matchNode(t,o,{},i)?n.concat([o]):n}),[])}(e,n,l);if(0<$(u,(function(t){return!bc(e,t,o)})).length){var c=n.cloneNode(!1);return s.add(t,c),a.remove(o,i,c,r),s.remove(c),E.some(c)}return E.none()}(e,T,a,t,n,o),_=hh(m.concat(x.toArray()),T);ch(e,C,!1),g.setCursorLocation(_,1),h.isEmpty(a)&&h.remove(a)}}(e,t,n,i):($c(u,!0,(function(){Wc(e,g)})),a.inline&&nh(e,t,n,u.getStart())&&lc(l,u,u.getRng()),e.nodeChanged());else{o=u.getNode();for(var p=0;p<r.length&&(!r[p].ceFalseOverride||!Fh(e,r[p],n,o,o));p++);}},Hh=pt.each,Wh=pt.each,$h=function(e,t,n,o){var i,r=e.formatter.get(t),a=r[0],s=!o&&e.selection.isCollapsed(),l=e.dom,u=e.selection,c=function(e,t){if(t=t||a,e){if(t.onformat&&t.onformat(e,t,n,o),Wh(t.styles,(function(t,o){l.setStyle(e,o,hc(t,n))})),t.styles){var i=l.getAttrib(e,"style");i&&l.setAttrib(e,"data-mce-style",i)}Wh(t.attributes,(function(t,o){l.setAttrib(e,o,hc(t,n))})),Wh(t.classes,(function(t){t=hc(t,n),l.hasClass(e,t)||l.addClass(e,t)}))}},d=function(e,t){var n=!1;return!!a.selector&&(Wh(e,(function(e){if(!("collapsed"in e)||e.collapsed===s)return l.is(t,e.selector)&&!ju(t)?(c(t,e),!(n=!0)):void 0})),n)},f=function(o,i,s,l){var u=[],f=!0,h=a.inline||a.block,g=o.create(h);c(g),Mc(o,i,(function(i){var s,m=function(i){var p=!1,v=f,y=i.nodeName.toLowerCase(),b=i.parentNode.nodeName.toLowerCase();if(fn(i)&&o.getContentEditable(i)&&(v=f,f="true"===o.getContentEditable(i),p=!0),gc(y,"br"))return s=0,void(a.block&&o.remove(i));if(a.wrapper&&th(e,i,t,n))s=0;else{if(f&&!p&&a.block&&!a.wrapper&&cc(e,y)&&dc(e,b,h))return i=o.rename(i,h),c(i),u.push(i),void(s=0);if(a.selector){var C=d(r,i);if(!a.inline||C)return void(s=0)}!f||p||!dc(e,h,y)||!dc(e,b,h)||!l&&3===i.nodeType&&1===i.nodeValue.length&&65279===i.nodeValue.charCodeAt(0)||ju(i)||a.inline&&o.isBlock(i)?(s=0,Wh(pt.grep(i.childNodes),m),p&&(f=v),s=0):(s||(s=o.clone(g,!1),i.parentNode.insertBefore(s,i),u.push(s)),s.appendChild(i))}};Wh(i,m)})),!0===a.links&&Wh(u,(function(e){var t=function(e){"A"===e.nodeName&&c(e,a),Wh(pt.grep(e.childNodes),t)};t(e)})),Wh(u,(function(i){var s,l,d,f,h,g,m,p,v,y,b,C,T,x,E,_,I,D,O,w=(s=0,Wh(i.childNodes,(function(e){var t;(t=e)&&Cn(t)&&0===t.length||oc(e)||s++})),s);!(1<u.length)&&o.isBlock(i)||0!==w?(a.inline||a.wrapper)&&(a.exact||1!==w||((O=function(e){var t=!1;return Wh(e.childNodes,(function(e){if((n=e)&&1===n.nodeType&&!oc(n)&&!ju(n)&&!pn(n))return t=e,!1;var n})),t}(I=i))&&!oc(O)&&Qf(o,O,a)&&(D=o.clone(O,!1),c(D),o.replace(D,I,!0),o.remove(O,!0)),i=D||I),function(e,t,n,o){Hh(t,(function(t){Hh(e.dom.select(t.inline,o),(function(o){Th(o)&&Fh(e,t,n,o,t.exact?o:null)})),function(e,t,n){t.clear_child_styles&&Ch(e.select(t.links?"*:not(a)":"*",n),(function(n){Th(n)&&Ch(t.styles,(function(t,o){e.setStyle(n,o,"")}))}))}(e.dom,t,o)}))}(e,r,n,i),T=a,th(C=e,(_=i).parentNode,x=t,E=n)&&Fh(C,T,E,_)||T.merge_with_parents&&C.dom.getParent(_.parentNode,(function(e){if(th(C,e,x,E))return Fh(C,T,E,_),!0})),v=o,b=n,(y=a).styles&&y.styles.backgroundColor&&Ih(i,Dh(v,"fontSize"),Oh(v,"backgroundColor",hc(y.styles.backgroundColor,b))),h=o,m=i,p=function(e){if(1===e.nodeType&&e.parentNode&&1===e.parentNode.nodeType){var t=vc(h,e.parentNode);h.getStyle(e,"color")&&t?h.setStyle(e,"text-decoration",t):h.getStyle(e,"text-decoration")===t&&h.setStyle(e,"text-decoration",null)}},(g=a).styles&&(g.styles.color||g.styles.textDecoration)&&(pt.walk(m,p,"childNodes"),p(m)),l=o,f=i,"sub"!==(d=a).inline&&"sup"!==d.inline||(Ih(f,Dh(l,"fontSize"),Oh(l,"fontSize","")),l.remove(l.select("sup"===d.inline?"sub":"sup",f),!0)),_h(o,a,0,i)):o.remove(i,!0)}))};if("false"!==l.getContentEditable(u.getNode())){if(a){if(o)sc(o)?d(r,o)||((i=l.createRng()).setStartBefore(o),i.setEndAfter(o),f(l,Ac(e,i,r),0,!0)):f(l,o,0,!0);else if(s&&a.inline&&!Lc(e).length)!function(e,t,n){var o,i,r=e.selection,a=r.getRng(),s=a.startOffset,l=a.startContainer.nodeValue;(o=Gu(e.getBody(),r.getStart()))&&(i=lh(o));var u,c,d=/[^\s\u00a0\u00ad\u200b\ufeff]/;if(l&&0<s&&s<l.length&&d.test(l.charAt(s))&&d.test(l.charAt(s-1))){var f=r.getBookmark();a.collapse(!0);var h=Ac(e,a,e.formatter.get(t));h=Xf(h),e.formatter.apply(t,n,h),r.moveToBookmark(f)}else o&&i.nodeValue===rh||(u=e.getDoc(),c=uh(!0).dom(),i=(o=u.importNode(c,!0)).firstChild,a.insertNode(o),s=1),e.formatter.apply(t,n,o),r.setCursorLocation(i,s)}(e,t,n);else{var h=u.getNode();e.settings.forced_root_block||!r[0].defaultBlock||l.getParent(h,l.isBlock)||$h(e,r[0].defaultBlock),u.setRng(mf(u.getRng())),$c(u,!0,(function(t){Wc(e,(function(t,n){var o=n?t:Ac(e,t,r);f(l,o)}))})),lc(l,u,u.getRng()),e.nodeChanged()}g=e,vh(mh[t],(function(e){e(g)}))}var g}else{o=u.getNode();for(var m=0,p=r.length;m<p;m++)if(r[m].ceFalseOverride&&l.is(o,r[m].selector))return void c(o,r[m])}},Uh=function(e,t){return V(t,(function(t){var n=e.fire("GetSelectionRange",{range:t});return n.range!==t?n.range:t}))},qh=function(t,n){var o=(n||e.document).createDocumentFragment();return H(t,(function(e){o.appendChild(e.dom())})),yt.fromDom(o)},jh=function(e,t,n){return{element:c(e),width:c(t),rows:c(n)}},Gh=function(e,t){return{element:c(e),cells:c(t)}},Xh=function(e,t){var n=parseInt(kn(e,t),10);return isNaN(n)?1:n},Yh=function(e){return q(e,(function(e,t){return t.cells().length>e?t.cells().length:e}),0)},Zh=function(e,t){for(var n,o=e.rows(),i=0;i<o.length;i++)for(var r=o[i].cells(),a=0;a<r.length;a++)if(Rt(r[a],t))return E.some((n=i,{x:c(a),y:c(n)}));return E.none()},Jh=function(e,t,n,o,i){for(var r=[],a=e.rows(),s=n;s<=i;s++){var l=a[s].cells(),u=t<o?l.slice(t,o+1):l.slice(o,t+1);r.push(Gh(a[s].element(),u))}return r},Qh=function(e){return n=V((t=e).rows(),(function(e){var t=V(e.cells(),(function(e){var t=es(e);return An(t,"colspan"),An(t,"rowspan"),t})),n=Qa(e.element());return Xt(n,t),n})),o=Qa(t.element()),i=yt.fromTag("tbody"),Xt(i,n),Gt(o,i),o;var t,n,o,i},eg=function(){return qh([])},tg=function(e,t){return 0<=t&&t<e.length&&rc(e.charAt(t))},ng=function(e){var t=rs(e.innerText);return dt.browser.isIE()?t.replace(/^[ \f\n\r\t\v]+/,""):t},og=function(t,n,o){if(void 0===o&&(o={}),o.get=!0,o.format=n,o.selection=!0,(o=t.fire("BeforeGetContent",o)).isDefaultPrevented())return t.fire("GetContent",o),o.content;if("text"===o.format)return E.from((h=t).selection.getRng()).map((function(e){var t=h.dom.add(h.getBody(),"div",{"data-mce-bogus":"all",style:"overflow: hidden; opacity: 0;"},e.cloneContents()),n=ng(t),o=rs(t.textContent);if(h.dom.remove(t),tg(o,0)||tg(o,o.length-1)){var i=h.dom.getParent(e.commonAncestorContainer,h.dom.isBlock),r=ng(i),a=r.indexOf(n);return-1===a?n:(tg(r,a-1)?" ":"")+n+(tg(r,a+n.length)?" ":"")}return n})).getOr("");o.getInner=!0;var i,r,a,s,l,u,d,h,g=(r=o,a=(i=t).selection.getRng(),s=i.dom.create("body"),l=i.selection.getSel(),u=Uh(i,Kc(l)),(d=r.contextual?function(t,n){var o,i,r=Pc(n,t);return 0<r.length?function(e,t){return Va(t[0],"table",f(Rt,e)).bind((function(e){var n=t[0],o=t[t.length-1];return function(e,t,n){return Zh(e,t).bind((function(t){return Zh(e,n).map((function(n){return o=e,r=n,a=(i=t).x(),s=i.y(),l=r.x(),c=s<(u=r.y())?Jh(o,a,s,l,u):Jh(o,a,u,l,s),jh(o.element(),Yh(c),c);var o,i,r,a,s,l,u,c}))}))}(function(e){var t=jh(Qa(e),0,[]);return H(Pa(e,"tr"),(function(e,n){H(Pa(e,"td,th"),(function(o,i){!function(e,t,n,o,i){for(var r=Xh(i,"rowspan"),a=Xh(i,"colspan"),s=e.rows(),l=n;l<n+r;l++){s[l]||(s[l]=Gh(es(o),[]));for(var u=t;u<t+a;u++)s[l].cells()[u]=l===n&&u===t?i:Qa(i)}}(t,function(e,t,n){for(;o=t,i=n,r=void 0,((r=e.rows())[i]?r[i].cells():[])[o];)t++;var o,i,r;return t}(t,i,n),n,e,o)}))})),jh(t.element(),Yh(t.rows()),t.rows())}(e),n,o).map((function(e){return qh([Qh(e)])}))})).getOrThunk(eg)}(t,r):(o=t,0<(i=n).length&&i[0].collapsed?eg():function(t,n){return o=yt.fromDom(n.cloneContents()),i=function(t,n){var o,i=yt.fromDom(n.commonAncestorContainer),r=Pd(i,t),a=$(r,(function(e){return Wn(e)||Vn(e)})),s=function(t,n){return j(t,(function(e){return"li"===bt(e)&&zc(e,n)})).fold(c([]),(function(n){return j(t,(function(e){return"ul"===bt(e)||"ol"===bt(e)})).map((function(t){var n=yt.fromTag(bt(t));return function(t,n){var o=t.dom();ie(n,(function(t,n){!function(t,n,o){if(!O(o))throw e.console.error("Invalid call to CSS.set. Property ",n,":: Value ",o,":: Element ",t),new Error("CSS value must be a string: "+o);On(t)&&t.style.setProperty(n,o)}(o,n,t)}))}(n,ce(Pn(t),(function(e,t){return $e(t,"list-style")}))),[yt.fromTag("li"),n]})).getOr([])}))}(r,n),l=a.concat(s.length?s:jn(o=i)?Nt(o).filter(qn).fold(c([]),(function(e){return[o,e]})):qn(o)?[o]:[]);return V(l,Qa)}(t,n),r=q(i,(function(e,t){return Gt(t,e),t}),o),0<i.length?qh([r]):r;var o,i,r}(o,i[0]))}(yt.fromDom(i.getBody()),u).dom():a.cloneContents())&&s.appendChild(d),i.selection.serializer.serialize(s,r));return"tree"===o.format?g:(o.content=t.selection.isCollapsed()?"":g,t.fire("GetContent",o),o.content)},ig=function(e){return fn(e)?e.outerHTML:Cn(e)?po.encodeRaw(e.data,!1):Tn(e)?"\x3c!--"+e.data+"--\x3e":""},rg=xa(E.none()),ag=function(e){var t,n=(t=e.getBody(),$(V(te(t.childNodes),ig),(function(e){return 0<e.length}))),o=X(n,(function(t){var n=dd(e.serializer,t);return 0<n.length?[n]:[]})),i=o.join("");return-1!==i.indexOf("</iframe>")?{type:"fragmented",fragments:o,content:"",bookmark:null,beforeBookmark:null}:{type:"complete",fragments:null,content:i,bookmark:null,beforeBookmark:null}},sg=function(t,n,o){"fragmented"===n.type?function(t,n){var o,i,r,a,s,l,u,c,d,f,h,g=V(te(n.childNodes),ig);s=(r=g).length+(a=t).length+2,l=new Array(s),u=new Array(s),c=function(e,t,n,o,i){var s=f(e,t,n,o);if(null===s||s.start===t&&s.diag===t-o||s.end===e&&s.diag===e-n)for(var l=e,u=n;l<t||u<o;)l<t&&u<o&&r[l]===a[u]?(i.push([0,r[l]]),++l,++u):o-n<t-e?(i.push([2,r[l]]),++l):(i.push([1,a[u]]),++u);else{c(e,s.start,n,s.start-s.diag,i);for(var d=s.start;d<s.end;++d)i.push([0,r[d]]);c(s.end,t,s.end-s.diag,o,i)}},d=function(e,t,n,o){for(var i=e;i-t<o&&i<n&&r[i]===a[i-t];)++i;return{start:e,end:i,diag:t}},f=function(e,t,n,o){var i=t-e,s=o-n;if(0==i||0==s)return null;var c,f,h,g,m,p=i-s,v=s+i,y=(v%2==0?v:1+v)/2;for(l[1+y]=e,u[1+y]=t+1,c=0;c<=y;++c){for(f=-c;f<=c;f+=2){for(l[h=f+y]=f===-c||f!==c&&l[h-1]<l[h+1]?l[h+1]:l[h-1]+1,m=(g=l[h])-e+n-f;g<t&&m<o&&r[g]===a[m];)l[h]=++g,++m;if(p%2!=0&&p-c<=f&&f<=p+c&&u[h-p]<=l[h])return d(u[h-p],f+e-n,t,o)}for(f=p-c;f<=p+c;f+=2){for(u[h=f+y-p]=f===p-c||f!==p+c&&u[h+1]<=u[h-1]?u[h+1]-1:u[h-1],m=(g=u[h]-1)-e+n-f;e<=g&&n<=m&&r[g]===a[m];)u[h]=g--,m--;if(p%2==0&&-c<=f&&f<=c&&u[h]<=l[h+p])return d(u[h],f+e-n,t,o)}}},c(0,r.length,0,a.length,h=[]),o=n,i=0,H(h,(function(t){0===t[0]?i++:1===t[0]?(function(t,n,o){var i=function(t){var n,o=e.document.createElement("div"),i=e.document.createDocumentFragment();for(t&&(o.innerHTML=t);n=o.firstChild;)i.appendChild(n);return i}(n);if(t.hasChildNodes()&&o<t.childNodes.length){var r=t.childNodes[o];r.parentNode.insertBefore(i,r)}else t.appendChild(i)}(o,t[1],i),i++):2===t[0]&&function(e,t){if(e.hasChildNodes()&&t<e.childNodes.length){var n=e.childNodes[t];n.parentNode.removeChild(n)}}(o,i)}))}(n.fragments,t.getBody()):t.setContent(n.content,{format:"raw"}),t.selection.moveToBookmark(o?n.beforeBookmark:n.bookmark)},lg=function(e){return"fragmented"===e.type?e.fragments.join(""):e.content},ug=function(t){var n=yt.fromTag("body",rg.get().getOrThunk((function(){var t=e.document.implementation.createHTMLDocument("undo");return rg.set(E.some(t)),t})));return Za(n,lg(t)),H(Pa(n,"*[data-mce-bogus]"),Jt),n.dom().innerHTML},cg=function(e,t){return!(!e||!t)&&(o=t,lg(e)===lg(o)||(n=t,ug(e)===ug(n)));var n,o},dg=function(e){return 0===e.get()},fg=function(e,t,n){dg(n)&&(e.typing=t)},hg=function(e,t){e.typing&&(fg(e,!1,t),e.add())},gg=function(e){return e instanceof Qc},mg=function(e,t){Uf(e.serializer.getNodeFilters(),e.serializer.getAttributeFilters(),t)},pg=function(e){return{undoManager:{beforeChange:function(t,n){return o=e,i=n,void(dg(t)&&i.set(E.some(Ol(o.selection))));var o,i},addUndoLevel:function(t,n,o,i,r,a){return function(e,t,n,o,i,r,a){var s=ag(e);if(r=pt.extend(r=r||{},s),!1===dg(o)||e.removed)return null;var l=t.data[n.get()];if(e.fire("BeforeAddUndo",{level:r,lastLevel:l,originalEvent:a}).isDefaultPrevented())return null;if(l&&cg(l,r))return null;t.data[n.get()]&&i.get().each((function(e){t.data[n.get()].beforeBookmark=e}));var u=e.getParam("custom_undo_redo_levels",0,"number");if(u&&t.data.length>u){for(var c=0;c<t.data.length-1;c++)t.data[c]=t.data[c+1];t.data.length--,n.set(t.data.length)}r.bookmark=Ol(e.selection),n.get()<t.data.length-1&&(t.data.length=n.get()+1),t.data.push(r),n.set(t.data.length-1);var d={level:r,lastLevel:l,originalEvent:a};return e.fire("AddUndo",d),0<n.get()&&(e.setDirty(!0),e.fire("change",d)),r}(e,t,n,o,i,r,a)},undo:function(t,n,o){return i=e,a=n,s=o,(r=t).typing&&(r.add(),r.typing=!1,fg(r,!1,a)),0<s.get()&&(s.set(s.get()-1),l=r.data[s.get()],sg(i,l,!0),i.setDirty(!0),i.fire("Undo",{level:l})),l;var i,r,a,s,l},redo:function(t,n){return o=e,r=n,(i=t).get()<r.length-1&&(i.set(i.get()+1),a=r[i.get()],sg(o,a,!1),o.setDirty(!0),o.fire("Redo",{level:a})),a;var o,i,r,a},clear:function(t,n){return o=e,r=n,(i=t).data=[],r.set(0),i.typing=!1,void o.fire("ClearUndos");var o,i,r},reset:function(e){return(t=e).clear(),void t.add();var t},hasUndo:function(t,n){return o=e,i=t,0<n.get()||i.typing&&i.data[0]&&!cg(ag(o),i.data[0]);var o,i},hasRedo:function(e,t){return n=e,t.get()<n.data.length-1&&!n.typing;var n},transact:function(e,t,n){return i=n,hg(o=e,t),o.beforeChange(),o.ignore(i),o.add();var o,i},ignore:function(e,t){return function(e,t){try{e.set(e.get()+1),t()}finally{e.set(e.get()-1)}}(e,t)},extra:function(t,n,o,i){return function(e,t,n,o,i){if(t.transact(o)){var r=t.data[n.get()].bookmark,a=t.data[n.get()-1];sg(e,a,!0),t.transact(i)&&(t.data[n.get()-1].beforeBookmark=r)}}(e,t,n,o,i)}},formatter:{apply:function(t,n,o){return $h(e,t,n,o)},remove:function(t,n,o,i){return Vh(e,t,n,o,i)},toggle:function(t,n,o){return a=n,s=o,l=(i=e).formatter.get(r=t),void(!nh(i,r,a,s)||"toggle"in l[0]&&!l[0].toggle?$h:Vh)(i,r,a,s);var i,r,a,s,l}},editor:{getContent:function(t,n){return i=t,r=n,E.from((o=e).getBody()).fold(c("tree"===i.format?new Qc("body",11):""),(function(e){return function(e,t,n,o){var i,r,a,s,l;if(t.format=n,t.get=!0,t.getInner=!0,t.no_events||e.fire("BeforeGetContent",t),"raw"===t.format)i=pt.trim(fd(e.serializer,o.innerHTML));else if("text"===t.format)i=rs(o.innerText||o.textContent);else{if("tree"===t.format)return e.serializer.serialize(o,t);a=(r=e).serializer.serialize(o,t),s=kl(r),l=new RegExp("^(<"+s+"[^>]*>(&nbsp;|&#160;|\\s| |<br \\/>|)<\\/"+s+">[\r\n]*|<br \\/>[\r\n]*)$"),i=a.replace(l,"")}return t.content="text"===t.format||Zn(yt.fromDom(o))?i:pt.trim(i),t.no_events||e.fire("GetContent",t),t.content}(o,i,r,e)}));var o,i,r},setContent:function(t,n){return function(e,t,n){return n.format=n.format?n.format:"html",n.set=!0,n.content=qf(t)?"":t,qf(t)||n.no_events||(e.fire("BeforeSetContent",n),t=n.content),E.from(e.getBody()).fold(c(t),(function(o){return qf(t)?function(e,t,n,o){Uf(e.parser.getNodeFilters(),e.parser.getAttributeFilters(),n);var i=od({validate:e.validate},e.schema).serialize(n);return o.content=Zn(yt.fromDom(t))?i:pt.trim(i),jf(e,o.content),o.no_events||e.fire("SetContent",o),n}(e,o,t,n):(i=e,r=o,s=n,0===(a=t).length||/^\s+$/.test(a)?(u='<br data-mce-bogus="1">',"TABLE"===r.nodeName?a="<tr><td>"+u+"</td></tr>":/^(UL|OL)$/.test(r.nodeName)&&(a="<li>"+u+"</li>"),a=(l=kl(i))&&i.schema.isValidChild(r.nodeName.toLowerCase(),l.toLowerCase())?(a=u,i.dom.createHTML(l,Al(i),a)):a||'<br data-mce-bogus="1">',jf(i,a),i.fire("SetContent",s)):("raw"!==s.format&&(a=od({validate:i.validate},i.schema).serialize(i.parser.parse(a,{isRootContent:!0,insert:!0}))),s.content=Zn(yt.fromDom(r))?a:pt.trim(a),jf(i,s.content),s.no_events||i.fire("SetContent",s)),s.content);var i,r,a,s,l,u}))}(e,t,n)},insertContent:function(t,n){return Cf(e,t,n)}},selection:{getContent:function(t,n){return og(e,t,n)}},raw:{getModel:function(){return E.none()}}}},vg=function(e){return fe(e.plugins,"rtc")},yg=function(e){var t=e;return de(e.plugins,"rtc").fold((function(){return t.rtcInstance=pg(e),E.none()}),(function(n){return E.some(n.setup().then((function(n){var o,i,r,a;return t.rtcInstance=(o=e,i=n,r=function(e){return w(e)?e:{}},a=v("Unimplemented feature for rtc"),{undoManager:{beforeChange:l,addUndoLevel:a,undo:function(){return i.undo(),{type:"complete",fragments:[],content:"",bookmark:null,beforeBookmark:null}},redo:function(){return i.redo(),{type:"complete",fragments:[],content:"",bookmark:null,beforeBookmark:null}},clear:a,reset:a,hasUndo:function(){return i.hasUndo()},hasRedo:function(){return i.hasRedo()},transact:function(e,t,n){return i.transact(n),{type:"complete",fragments:[],content:"",bookmark:null,beforeBookmark:null}},ignore:a,extra:a},formatter:{apply:function(e,t,n){return i.applyFormat(e,r(t))},remove:function(e,t,n,o){return i.removeFormat(e,r(t))},toggle:function(e,t,n){return i.toggleFormat(e,r(t))}},editor:{getContent:function(e,t){if("html"!==t&&"tree"!==t)return pg(o).editor.getContent(e,t);var n=i.getContent(),r=od({inner:!0});return mg(o,n),"tree"===t?n:r.serialize(n)},setContent:function(e,t){var n=gg(e)?e:o.parser.parse(e,{isRootContent:!0,insert:!0});return i.setContent(n),e},insertContent:function(e,t){var n=gg(e)?e:o.parser.parse(e,{insert:!0});i.insertContent(n)}},selection:{getContent:function(e,t){if("html"!==e&&"tree"!==e)return pg(o).selection.getContent(e,t);var n=i.getSelectedContent(),r=od({});return mg(o,n),"tree"===e?n:r.serialize(n)}},raw:{getModel:function(){return E.some(i.getRawModel())}}}),n.isRemote})))}))},bg=function(e){return e.rtcInstance?e.rtcInstance:pg(e)},Cg=function(e){var t=e.rtcInstance;if(t)return t;throw new Error("Failed to get RTC instance not yet initialized.")},Tg=function(e,t,n){return void 0===n&&(n={}),o=t,i=n,bg(e).editor.setContent(o,i);var o,i},xg=ma.DOM,Eg=function(e){return E.from(e).each((function(e){return e.destroy()}))},_g=Object.prototype.hasOwnProperty,Ig=(yh=function(e,t){return w(e)&&w(t)?Ig(e,t):t},function(){for(var e=new Array(arguments.length),t=0;t<e.length;t++)e[t]=arguments[t];if(0===e.length)throw new Error("Can't merge zero objects");for(var n={},o=0;o<e.length;o++){var i=e[o];for(var r in i)_g.call(i,r)&&(n[r]=yh(n[r],i[r]))}return n}),Dg=nt().deviceType,Og=Dg.isTouch(),wg=Dg.isPhone(),Rg=Dg.isTablet(),Sg=["lists","autolink","autosave"],kg={table_grid:!1,object_resizing:!1,resize:!1},Ag=function(e){var t=R(e)?e.join(" "):e,n=V(O(t)?t.split(" "):[],qe);return $(n,(function(e){return 0<e.length}))},Ng=function(e,t){return e.sections().hasOwnProperty(t)},Mg=function(e,t){return de(e,"toolbar_mode").orThunk((function(){return de(e,"toolbar_drawer").map((function(e){return!1===e?"wrap":e}))})).getOr(t)},Kg=function(e,t,n){return E.from(t.settings[n]).filter(e)},Pg=(bh={},{add:function(e,t){bh[e]=t},get:function(e){return bh[e]?bh[e]:{icons:{}}},has:function(e){return fe(bh,e)}}),Lg=function(e,t){return t.dom()[e]},Bg=function(e,t){return parseInt(Nn(t,e),10)},Fg=f(Lg,"clientWidth"),zg=f(Lg,"clientHeight"),Vg=f(Bg,"margin-top"),Hg=f(Bg,"margin-left"),Wg=function(e,t,n){var o,i,r,a,s,l,u,c,d,f,h=yt.fromDom(e.getBody()),g=e.inline?h:yt.fromDom(h.dom().ownerDocument.documentElement),m=(o=e.inline,r=t,a=n,s=(i=g).dom().getBoundingClientRect(),{x:r-(o?s.left+i.dom().clientLeft+Hg(i):0),y:a-(o?s.top+i.dom().clientTop+Vg(i):0)});return u=m.x,c=m.y,d=Fg(l=g),f=zg(l),0<=u&&0<=c&&u<=d&&c<=f};function $g(e){var t,n=[],o=function(){var t=e.theme;return t&&t.getNotificationManagerImpl?t.getNotificationManagerImpl():function(){var e=function(){throw new Error("Theme did not provide a NotificationManager implementation.")};return{open:e,close:e,reposition:e,getArgs:e}}()},i=function(){return E.from(n[0])},r=function(){0<n.length&&o().reposition(n)},a=function(e){G(n,(function(t){return t===e})).each((function(e){n.splice(e,1)}))},s=function(t){if(!e.removed&&function(e){var t=e.inline?e.getBody():e.getContentAreaContainer();return E.from(t).map(yt.fromDom).map((function(e){return St(kt(e),e)})).getOr(!1)}(e))return j(n,(function(e){return!((n=o().getArgs(e)).type!==(i=t).type||n.text!==i.text||n.progressBar||n.timeout||i.progressBar||i.timeout);var n,i})).getOrThunk((function(){e.editorManager.setActive(e);var s=o().open(t,(function(){a(s),r(),i().fold((function(){return e.focus()}),(function(e){return yt.fromDom(e.getEl()).dom().focus()}))}));return n.push(s),r(),s}))};return(t=e).on("SkinLoaded",(function(){var e=t.getParam("service_message");e&&s({text:e,type:"warning",timeout:0})})),t.on("ResizeEditor ResizeWindow NodeChange",(function(){oa.requestAnimationFrame(r)})),t.on("remove",(function(){H(n.slice(),(function(e){o().close(e)}))})),{open:s,close:function(){i().each((function(e){o().close(e),a(e),r()}))},getNotifications:function(){return n}}}var Ug=wa.PluginManager,qg=wa.ThemeManager,jg=function(e){var t=[],n=function(){var t=e.theme;return t&&t.getWindowManagerImpl?t.getWindowManagerImpl():function(){var e=function(){throw new Error("Theme did not provide a WindowManager implementation.")};return{open:e,openUrl:e,alert:e,confirm:e,close:e,getParams:e,setParams:e}}()},o=function(e,t){return function(){return t?t.apply(e,arguments):void 0}},i=function(n){e.fire("CloseWindow",{dialog:n}),0===(t=$(t,(function(e){return e!==n}))).length&&e.focus()},r=function(n){e.editorManager.setActive(e),Af(e);var o=n();return function(n){t.push(n),e.fire("OpenWindow",{dialog:n})}(o),o};return e.on("remove",(function(){H(t,(function(e){n().close(e)}))})),{open:function(e,t){return r((function(){return n().open(e,t,i)}))},openUrl:function(e){return r((function(){return n().openUrl(e,i)}))},alert:function(e,t,i){n().alert(e,o(i||this,t))},confirm:function(e,t,i){n().confirm(e,o(i||this,t))},close:function(){E.from(t[t.length-1]).each((function(e){n().close(e),i(e)}))}}},Gg=function(e,t){e.notificationManager.open({type:"error",text:t})},Xg=function(e,t){e._skinLoaded?Gg(e,t):e.on("SkinLoaded",(function(){Gg(e,t)}))},Yg=function(t,n,o){t.fire(n,{message:o}),e.console.error(o)},Zg=function(e,t,n){return n?"Failed to load "+e+": "+n+" from url "+t:"Failed to load "+e+" url: "+t},Jg=function(e,t,n){Yg(e,"PluginLoadError",Zg("plugin",t,n))},Qg=function(t){for(var n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];var i=e.window.console;i&&(i.error?i.error.apply(i,xe([t],n)):i.log.apply(i,xe([t],n)))},em=function(e,t){var n=function(t){var n=function(e){var t=e.dom();return Qt(e)?t.getBoundingClientRect().height:t.offsetHeight}(t);if(n<=0||null===n){var o=Nn(t,e);return parseFloat(o)||0}return n},o=function(e,t){return q(t,(function(t,n){var o=Nn(e,n),i=void 0===o?0:parseInt(o,10);return isNaN(i)?t:t+i}),0)};return{set:function(t,n){if(!M(n)&&!n.match(/^[0-9]+$/))throw new Error(e+".set accepts only positive integer values. Value was "+n);var o=t.dom();On(o)&&(o.style[e]=n+"px")},get:n,getOuter:n,aggregate:o,max:function(e,t,n){var i=o(e,n);return i<t?t-i:0}}}("height"),tm=function(e,t){return e.view(t).fold(c([]),(function(t){var n=e.owner(t),o=tm(e,n);return[t].concat(o)}))},nm=Object.freeze({__proto__:null,view:function(t){return(t.dom()===e.document?E.none():E.from(t.dom().defaultView.frameElement)).map(yt.fromDom)},owner:function(e){return kt(e)}}),om=function(e){return"textarea"===bt(e)},im=function(e,t){var n=function(e){var t=e.dom().ownerDocument,n=t.body,o=t.defaultView,i=t.documentElement;if(n===e.dom())return tn(n.offsetLeft,n.offsetTop);var r=nn(o.pageYOffset,i.scrollTop),a=nn(o.pageXOffset,i.scrollLeft),s=nn(i.clientTop,n.clientTop),l=nn(i.clientLeft,n.clientLeft);return on(e).translate(a-l,r-s)}(e),o=em.get(e);return{element:e,bottom:n.top()+o,height:o,pos:n,cleanup:t}},rm=function(e,t,n,o){um(e,(function(i,r){return sm(e,t,n,o)}),n)},am=function(e,t,n,o,i){var r={elm:o.element.dom(),alignToTop:i};e.fire("ScrollIntoView",r).isDefaultPrevented()||(n(t,rn(t).top(),o,i),e.fire("AfterScrollIntoView",r))},sm=function(e,t,n,o){var i=yt.fromDom(e.getBody()),r=yt.fromDom(e.getDoc());i.dom();var a=function(e,t){var n=function(e,t){var n=Bt(e);if(0===n.length||om(e))return{element:e,offset:t};if(t<n.length&&!om(n[t]))return{element:n[t],offset:0};var o=n[n.length-1];return om(o)?{element:e,offset:t}:"img"===bt(o)?{element:o,offset:1}:Et(o)?{element:o,offset:qc(o).length}:{element:o,offset:Bt(o).length}}(e,t),o=yt.fromHtml('<span data-mce-bogus="all">\ufeff</span>');return Ut(n.element,o),im(o,(function(){return Zt(o)}))}(yt.fromDom(n.startContainer),n.startOffset);am(e,r,t,a,o),a.cleanup()},lm=function(e,t,n,o){var i=yt.fromDom(e.getDoc());am(e,i,n,im(yt.fromDom(t),l),o)},um=function(e,t,n){var o=n.startContainer,i=n.startOffset,r=n.endContainer,a=n.endOffset;t(yt.fromDom(o),yt.fromDom(r));var s=e.dom.createRng();s.setStart(o,i),s.setEnd(r,a),e.selection.setRng(n)},cm=function(e,t,n,o){var i=e.pos;if(n)an(i.left(),i.top(),o);else{var r=i.top()-t+e.height;an(i.left(),r,o)}},dm=function(e,t,n,o,i){var r=n+t,a=o.pos.top(),s=o.bottom,l=n<=s-a;a<t?cm(o,n,!1!==i,e):r<a?cm(o,n,l?!1!==i:!0===i,e):r<s&&!l&&cm(o,n,!0===i,e)},fm=function(e,t,n,o){var i=e.dom().defaultView.innerHeight;dm(e,t,i,n,o)},hm=function(t,n,o,i){var r=t.dom().defaultView.innerHeight;dm(t,n,r,o,i);var a=function(t){var n,o,i=yt.fromDom(e.document),r=rn(i),a=(o=(n=nm).owner(t),tm(n,o)),s=on(t),l=U(a,(function(e,t){var n=on(t);return{left:e.left+n.left(),top:e.top+n.top()}}),{left:0,top:0});return tn(l.left+s.left()+r.left(),l.top+s.top()+r.top())}(o.element),s=un(e.window);a.top()<s.y?sn(o.element,!1!==i):a.top()>s.bottom&&sn(o.element,!0===i)},gm=function(e,t,n){return rm(e,fm,t,n)},mm=function(e,t,n){return lm(e,t,fm,n)},pm=function(e,t,n){return rm(e,hm,t,n)},vm=function(e,t,n){return lm(e,t,hm,n)},ym=function(e,t,n){(e.inline?gm:pm)(e,t,n)},bm=function(e){return In(e)||Dn(e)},Cm=function(e,t,n){var o,i,a,s,l,u=n;if(u.caretPositionFromPoint)(i=u.caretPositionFromPoint(e,t))&&((o=n.createRange()).setStart(i.offsetNode,i.offset),o.collapse(!0));else if(n.caretRangeFromPoint)o=n.caretRangeFromPoint(e,t);else if(u.body.createTextRange){o=u.body.createTextRange();try{o.moveToPoint(e,t),o.collapse(!0)}catch(r){o=function(e,t,n){var o,i=n.elementFromPoint(e,t),r=n.body.createTextRange();if(i&&"HTML"!==i.tagName||(i=n.body),r.moveToElementText(i),0<(o=(o=pt.toArray(r.getClientRects())).sort((function(e,n){return(e=Math.abs(Math.max(e.top-t,e.bottom-t)))-Math.abs(Math.max(n.top-t,n.bottom-t))}))).length){t=(o[0].bottom+o[0].top)/2;try{return r.moveToPoint(e,t),r.collapse(!0),r}catch(s){}}return null}(e,t,n)}return s=n.body,l=(a=o)&&a.parentElement?a.parentElement():null,Dn(function(e,t,n){for(;e&&e!==t;){if(n(e))return e;e=e.parentNode}return null}(l,s,bm))?null:a}return o},Tm=function(e,t,n,o,i){var r=n?t.startOffset:t.endOffset;return E.from(n?t.startContainer:t.endContainer).map(yt.fromDom).map((function(e){return o&&t.collapsed?e:Ft(e,i(e,r)).getOr(e)})).bind((function(e){return xt(e)?E.some(e):Nt(e).filter(xt)})).map((function(e){return e.dom()})).getOr(e)},xm=function(e,t,n){return Tm(e,t,!0,n,(function(e,t){return Math.min(e.dom().childNodes.length,t)}))},Em=function(e,t,n){return Tm(e,t,!1,n,(function(e,t){return 0<t?t-1:t}))},_m=function(e,t){for(var n=e;e&&Cn(e)&&0===e.length;)e=t?e.nextSibling:e.previousSibling;return e||n},Im=function(e,t){return e&&t&&e.startContainer===t.startContainer&&e.startOffset===t.startOffset&&e.endContainer===t.endContainer&&e.endOffset===t.endOffset},Dm=function(e,t,n){return null!==function(e,t,n){for(;e&&e!==t;){if(n(e))return e;e=e.parentNode}return null}(e,t,n)},Om=function(e,t,n){return Dm(e,t,(function(e){return e.nodeName===n}))},wm=function(e){return e&&"TABLE"===e.nodeName},Rm=function(e,t,n){for(var o=new Ir(t,e.getParent(t.parentNode,e.isBlock)||e.getRoot());t=o[n?"prev":"next"]();)if(_n(t))return!0},Sm=function(e,t,n,o,i){var r,a,s=e.getRoot(),l=e.schema.getNonEmptyElements(),u=e.getParent(i.parentNode,e.isBlock)||s;if(o&&_n(i)&&t&&e.isEmpty(u))return E.some(ol(i.parentNode,e.nodeIndex(i)));for(var c,d,f=new Ir(i,u);a=f[o?"prev":"next"]();){if("false"===e.getContentEditableParent(a)||(d=s,cs(c=a)&&!1===Dm(c,d,ju)))return E.none();if(Cn(a)&&0<a.nodeValue.length)return!1===Om(a,s,"A")?E.some(ol(a,o?a.nodeValue.length:0)):E.none();if(e.isBlock(a)||l[a.nodeName.toLowerCase()])return E.none();r=a}return n&&r?E.some(ol(r,0)):E.none()},km=function(e,t,n,o){var i,r,a,s,l=e.getRoot(),u=!1;r=o[(n?"start":"end")+"Offset"];var c,d,f=fn(i=o[(n?"start":"end")+"Container"])&&r===i.childNodes.length,h=e.schema.getNonEmptyElements();if(s=n,cs(i))return E.none();if(fn(i)&&r>i.childNodes.length-1&&(s=!1),xn(i)&&(i=l,r=0),i===l){if(s&&(a=i.childNodes[0<r?r-1:0])){if(cs(a))return E.none();if(h[a.nodeName]||wm(a))return E.none()}if(i.hasChildNodes()){if(r=Math.min(!s&&0<r?r-1:r,i.childNodes.length-1),r=Cn(i=i.childNodes[r])&&f?i.data.length:0,!t&&i===l.lastChild&&wm(i))return E.none();if(function(e,t){for(;t&&t!==e;){if(Dn(t))return!0;t=t.parentNode}return!1}(l,i)||cs(i))return E.none();if(i.hasChildNodes()&&!1===wm(i)){var g=new Ir(a=i,l);do{if(Dn(a)||cs(a)){u=!1;break}if(Cn(a)&&0<a.nodeValue.length){r=s?0:a.nodeValue.length,i=a,u=!0;break}if(h[a.nodeName.toLowerCase()]&&(!(c=a)||!/^(TD|TH|CAPTION)$/.test(c.nodeName))){r=e.nodeIndex(a),i=a.parentNode,s||r++,u=!0;break}}while(a=s?g.next():g.prev())}}}return t&&(Cn(i)&&0===r&&Sm(e,f,t,!0,i).each((function(e){i=e.container(),r=e.offset(),u=!0})),fn(i)&&(!(a=(a=i.childNodes[r])||i.childNodes[r-1])||!_n(a)||(d=a).previousSibling&&"A"===d.previousSibling.nodeName||Rm(e,a,!1)||Rm(e,a,!0)||Sm(e,f,t,!0,a).each((function(e){i=e.container(),r=e.offset(),u=!0})))),s&&!t&&Cn(i)&&r===i.nodeValue.length&&Sm(e,f,t,!1,i).each((function(e){i=e.container(),r=e.offset(),u=!0})),u?E.some(ol(i,r)):E.none()},Am=function(e,t){var n=t.collapsed,o=t.cloneRange(),i=ol.fromRangeStart(t);return km(e,n,!0,o).each((function(e){n&&ol.isAbove(i,e)||o.setStart(e.container(),e.offset())})),n||km(e,n,!1,o).each((function(e){o.setEnd(e.container(),e.offset())})),n&&o.collapse(!0),Im(t,o)?E.none():E.some(o)},Nm=function(e){return 0===e.dom().length?(Zt(e),E.none()):E.some(e)};function Mm(e){return{getBookmark:f(tc,e),moveToBookmark:f(nc,e)}}(Mm=Mm||{}).isBookmarkNode=oc;var Km,Pm,Lm=Mm,Bm=function(e,t,n){if(n.collapsed)return!1;if(dt.browser.isIE()&&n.startOffset===n.endOffset-1&&n.startContainer===n.endContainer){var o=n.startContainer.childNodes[n.startOffset];if(fn(o))return z(o.getClientRects(),(function(n){return _s(n,e,t)}))}return z(n.getClientRects(),(function(n){return _s(n,e,t)}))},Fm={BACKSPACE:8,DELETE:46,DOWN:40,ENTER:13,LEFT:37,RIGHT:39,SPACEBAR:32,TAB:9,UP:38,END:35,HOME:36,modifierPressed:function(e){return e.shiftKey||e.ctrlKey||e.altKey||this.metaKeyPressed(e)},metaKeyPressed:function(e){return dt.mac?e.metaKey:e.ctrlKey&&!e.altKey}},zm=Dn,Vm=In,Hm=function(t,n){var o,i,r,a,s,l,u,c,d,f,g,m,p,v,y=n.dom,b=pt.each,C=n.getDoc(),T=e.document,x=Math.abs,E=Math.round,_=n.getBody(),I={nw:[0,0,-1,-1],ne:[1,0,1,-1],se:[1,1,1,1],sw:[0,1,-1,1]},D=function(e){return e&&("IMG"===e.nodeName||n.dom.is(e,"figure.image"))},O=function(e){var t=e.target;!function(e,t){if("longpress"!==e.type&&0!==e.type.indexOf("touch"))return D(e.target)&&!Bm(e.clientX,e.clientY,t);var n=e.touches[0];return D(e.target)&&!Bm(n.clientX,n.clientY,t)}(e,n.selection.getRng())||e.isDefaultPrevented()||n.selection.select(t)},w=function(e){return n.dom.is(e,"figure.image")?e.querySelector("img"):e},R=function(e){var t=Bl(n);return!1!==t&&!dt.iOS&&("string"!=typeof t&&(t="table,img,figure.image,div"),"false"!==e.getAttribute("data-mce-resize")&&e!==n.getBody()&&Ot(yt.fromDom(e),t))},S=function(e,t,n){y.setStyles(w(e),{width:t,height:n})},k=function(e){var t,h,b,C;g=(g=(t=e.screenX-s)*a[2]+u)<5?5:g,m=(m=(h=e.screenY-l)*a[3]+c)<5?5:m,(D(o)&&!1!==n.getParam("resize_img_proportional",!0,"boolean")?!Fm.modifierPressed(e):Fm.modifierPressed(e))&&(x(t)>x(h)?(m=E(g*d),g=E(m/d)):(g=E(m/d),m=E(g*d))),S(i,g,m),b=0<(b=a.startPos.x+t)?b:0,C=0<(C=a.startPos.y+h)?C:0,y.setStyles(r,{left:b,top:C,display:"block"}),r.innerHTML=g+" &times; "+m,a[2]<0&&i.clientWidth<=g&&y.setStyle(i,"left",void 0+(u-g)),a[3]<0&&i.clientHeight<=m&&y.setStyle(i,"top",void 0+(c-m)),(t=_.scrollWidth-p)+(h=_.scrollHeight-v)!=0&&y.setStyles(r,{left:b-t,top:C-h}),f||(n.fire("ObjectResizeStart",{target:o,width:u,height:c}),f=!0)},A=function(){var e=f;f=!1;var t=function(e,t){t&&(o.style[e]||!n.schema.isValid(o.nodeName.toLowerCase(),e)?y.setStyle(w(o),e,t):y.setAttrib(w(o),e,""+t))};e&&(t("width",g),t("height",m)),y.unbind(C,"mousemove",k),y.unbind(C,"mouseup",A),T!==C&&(y.unbind(T,"mousemove",k),y.unbind(T,"mouseup",A)),y.remove(i),y.remove(r),N(o),e&&(n.fire("ObjectResized",{target:o,width:g,height:m}),y.setAttrib(o,"style",y.getAttrib(o,"style"))),n.nodeChanged()},N=function(e){M(),L();var t=y.getPos(e,_),f=t.x,h=t.y,x=e.getBoundingClientRect(),E=x.width||x.right-x.left,D=x.height||x.bottom-x.top;o!==e&&(o=e,g=m=0);var O=n.fire("ObjectSelected",{target:e});R(e)&&!O.isDefaultPrevented()?b(I,(function(e,t){var n;(n=y.get("mceResizeHandle"+t))&&y.remove(n),n=y.add(_,"div",{id:"mceResizeHandle"+t,"data-mce-bogus":"all",class:"mce-resizehandle",unselectable:!0,style:"cursor:"+t+"-resize; margin:0; padding:0"}),11===dt.ie&&(n.contentEditable=!1),y.bind(n,"mousedown",(function(t){var n;t.stopImmediatePropagation(),t.preventDefault(),s=(n=t).screenX,l=n.screenY,u=w(o).clientWidth,c=w(o).clientHeight,d=c/u,(a=e).startPos={x:E*e[0]+f,y:D*e[1]+h},p=_.scrollWidth,v=_.scrollHeight,i=o.cloneNode(!0),y.addClass(i,"mce-clonedresizable"),y.setAttrib(i,"data-mce-bogus","all"),i.contentEditable=!1,i.unSelectabe=!0,y.setStyles(i,{left:f,top:h,margin:0}),S(i,E,D),i.removeAttribute("data-mce-selected"),_.appendChild(i),y.bind(C,"mousemove",k),y.bind(C,"mouseup",A),T!==C&&(y.bind(T,"mousemove",k),y.bind(T,"mouseup",A)),r=y.add(_,"div",{class:"mce-resize-helper","data-mce-bogus":"all"},u+" &times; "+c)})),e.elm=n,y.setStyles(n,{left:E*e[0]+f-n.offsetWidth/2,top:D*e[1]+h-n.offsetHeight/2})})):M(),o.setAttribute("data-mce-selected","1")},M=function(){L(),o&&o.removeAttribute("data-mce-selected"),ie(I,(function(e,t){var n=y.get("mceResizeHandle"+t);n&&(y.unbind(n),y.remove(n))}))},K=function(e){var o,i=function(e,t){if(e)do{if(e===t)return!0}while(e=e.parentNode)};f||n.removed||(b(y.select("img[data-mce-selected],hr[data-mce-selected]"),(function(e){e.removeAttribute("data-mce-selected")})),o="mousedown"===e.type?e.target:t.getNode(),i(o=y.$(o).closest("table,img,figure.image,hr")[0],_)&&(B(),i(t.getStart(!0),o)&&i(t.getEnd(!0),o))?N(o):M())},P=function(e){return zm(function(e,t){for(;t&&t!==e;){if(Vm(t)||zm(t))return t;t=t.parentNode}return null}(n.getBody(),e))},L=function(){ie(I,(function(e){e.elm&&(y.unbind(e.elm),delete e.elm)}))},B=function(){try{n.getDoc().execCommand("enableObjectResizing",!1,!1)}catch(h){}};return n.on("init",(function(){if(B(),dt.browser.isIE()||dt.browser.isEdge()){n.on("mousedown click",(function(e){var t=e.target,o=t.nodeName;f||!/^(TABLE|IMG|HR)$/.test(o)||P(t)||(2!==e.button&&n.selection.select(t,"TABLE"===o),"mousedown"===e.type&&n.nodeChanged())}));var e=function(e){var t=function(e){oa.setEditorTimeout(n,(function(){return n.selection.select(e)}))};if(P(e.target))return e.preventDefault(),void t(e.target);/^(TABLE|IMG|HR)$/.test(e.target.nodeName)&&(e.preventDefault(),"IMG"===e.target.tagName&&t(e.target))};y.bind(_,"mscontrolselect",e),n.on("remove",(function(){return y.unbind(_,"mscontrolselect",e)}))}var t=oa.throttle((function(e){n.composing||K(e)}));n.on("nodechange ResizeEditor ResizeWindow ResizeContent drop FullscreenStateChanged",t),n.on("keyup compositionend",(function(e){o&&"TABLE"===o.nodeName&&t(e)})),n.on("hide blur",M),n.on("contextmenu longpress",O,!0)})),n.on("remove",L),{isResizable:R,showResizeRect:N,hideResizeRect:M,updateResizeRect:K,destroy:function(){o=i=null}}},Wm=function(e,t,n){if(e&&e.hasOwnProperty(t)){var o=$(e[t],(function(e){return e!==n}));0===o.length?delete e[t]:e[t]=o}},$m=function(e){return!!e.select},Um=function(e){return!(!e||!e.ownerDocument)&&St(yt.fromDom(e.ownerDocument),yt.fromDom(e))},qm=function(e,t,n,o){var i,r,a=function(e,t){var n,o;return{selectorChangedWithUnbind:function(i,r){return n||(n={},o={},t.on("NodeChange",(function(t){var i=t.element,r=e.getParents(i,null,e.getRoot()),a={};pt.each(n,(function(t,n){pt.each(r,(function(i){if(e.is(i,n))return o[n]||(pt.each(t,(function(e){e(!0,{node:i,selector:n,parents:r})})),o[n]=t),a[n]=t,!1}))})),pt.each(o,(function(e,t){a[t]||(delete o[t],pt.each(e,(function(e){e(!1,{node:i,selector:t,parents:r})})))}))}))),n[i]||(n[i]=[]),n[i].push(r),{unbind:function(){Wm(n,i,r),Wm(o,i,r)}}}}}(e,o).selectorChangedWithUnbind,s=function(e,t){return function(e,t,n){void 0===n&&(n={});var o,i=(o=t,Te(Te({format:"html"},n),{set:!0,selection:!0,content:o}));if(i.no_events||!(i=e.fire("BeforeSetContent",i)).isDefaultPrevented()){n.content=function(e,t){if("raw"===t.format)return t.content;var n=e.parser.parse(t.content,Te({isRootContent:!0,forced_root_block:!1},t));return od({validate:e.validate},e.schema).serialize(n)}(e,i);var r=e.selection.getRng();(function(e,t){var n=E.from(t.firstChild).map(yt.fromDom),o=E.from(t.lastChild).map(yt.fromDom);e.deleteContents(),e.insertNode(t);var i=n.bind(Mt).filter(Et).bind(Nm),r=o.bind(Kt).filter(Et).bind(Nm);vs(i,n.filter(Et),(function(e,t){var n,o;n=t.dom(),o=e.dom().data,n.insertData(0,o),Zt(e)})),vs(r,o.filter(Et),(function(t,n){var o=n.dom().length;n.dom().appendData(t.dom().data),e.setEnd(n.dom(),o),Zt(t)})),e.collapse(!1)})(r,r.createContextualFragment(n.content)),e.selection.setRng(r),ym(e,r),i.no_events||e.fire("SetContent",i)}else e.fire("SetContent",i)}(o,e,t)},l=function(e){var t=c();t.collapse(!!e),d(t)},u=function(){return t.getSelection?t.getSelection():t.document.selection},c=function(){var n,a,s,l=function(e,t,n){try{return t.compareBoundaryPoints(e,n)}catch(l){return-1}};if(!t)return null;var c=t.document;if(null==c)return null;if(void 0!==o.bookmark&&!1===Vf(o)){var d=Nf(o);if(d.isSome())return d.map((function(e){return Uh(o,[e])[0]})).getOr(c.createRange())}try{(n=u())&&!dn(n.anchorNode)&&(a=0<n.rangeCount?n.getRangeAt(0):n.createRange?n.createRange():c.createRange())}catch(f){}return(a=(a=Uh(o,[a])[0])||(c.createRange?c.createRange():c.body.createTextRange())).setStart&&9===a.startContainer.nodeType&&a.collapsed&&(s=e.getRoot(),a.setStart(s,0),a.setEnd(s,0)),i&&r&&(0===l(a.START_TO_START,a,i)&&0===l(a.END_TO_END,a,i)?a=r:r=i=null),a},d=function(e,t){var n;if((a=e)&&($m(a)||Um(a.startContainer)&&Um(a.endContainer))){var a,s=$m(e)?e:null;if(s){r=null;try{s.select()}catch(f){}}else{var l=u();if(e=o.fire("SetSelectionRange",{range:e,forward:t}).range,l){r=e;try{l.removeAllRanges(),l.addRange(e)}catch(f){}!1===t&&l.extend&&(l.collapse(e.endContainer,e.endOffset),l.extend(e.startContainer,e.startOffset)),i=0<l.rangeCount?l.getRangeAt(0):null}e.collapsed||e.startContainer!==e.endContainer||!l.setBaseAndExtent||dt.ie||e.endOffset-e.startOffset<2&&e.startContainer.hasChildNodes()&&(n=e.startContainer.childNodes[e.startOffset])&&"IMG"===n.tagName&&(l.setBaseAndExtent(e.startContainer,e.startOffset,e.endContainer,e.endOffset),l.anchorNode===e.startContainer&&l.focusNode===e.endContainer||l.setBaseAndExtent(n,0,n,1)),o.fire("AfterSetSelectionRange",{range:e,forward:t})}}},f=function(){var t=u();if(!t||!t.anchorNode||!t.focusNode)return!0;var n=e.createRng();n.setStart(t.anchorNode,t.anchorOffset),n.collapse(!0);var o=e.createRng();return o.setStart(t.focusNode,t.focusOffset),o.collapse(!0),n.compareBoundaryPoints(n.START_TO_START,o)<=0},h={bookmarkManager:null,controlSelection:null,dom:e,win:t,serializer:n,editor:o,collapse:l,setCursorLocation:function(t,n){var i=e.createRng();t?(i.setStart(t,n),i.setEnd(t,n),d(i),l(!1)):(Vc(e,i,o.getBody(),!0),d(i))},getContent:function(e){return function(e,t){var n,o;return void 0===t&&(t={}),n=t.format?t.format:"html",o=t,Cg(e).selection.getContent(n,o)}(o,e)},setContent:s,getBookmark:function(e,t){return g.getBookmark(e,t)},moveToBookmark:function(e){return g.moveToBookmark(e)},select:function(t,n){var o,i;return o=e,i=n,E.from(t).map((function(e){var t=o.nodeIndex(e),n=o.createRng();return n.setStart(e.parentNode,t),n.setEnd(e.parentNode,t+1),i&&(Vc(o,n,e,!0),Vc(o,n,e,!1)),n})).each(d),t},isCollapsed:function(){var e=c(),t=u();return!(!e||e.item)&&(e.compareEndPoints?0===e.compareEndPoints("StartToEnd",e):!t||e.collapsed)},isForward:f,setNode:function(t){return s(e.getOuterHTML(t)),t},getNode:function(){return function(e,t){var n,o,i;if(!t)return e;o=t.startContainer,i=t.endContainer;var r=t.startOffset,a=t.endOffset;return n=t.commonAncestorContainer,!t.collapsed&&(o===i&&a-r<2&&o.hasChildNodes()&&(n=o.childNodes[r]),3===o.nodeType&&3===i.nodeType&&(o=o.length===r?_m(o.nextSibling,!0):o.parentNode,i=0===a?_m(i.previousSibling,!1):i.parentNode,o&&o===i))?o:n&&3===n.nodeType?n.parentNode:n}(o.getBody(),c())},getSel:u,setRng:d,getRng:c,getStart:function(e){return xm(o.getBody(),c(),e)},getEnd:function(e){return Em(o.getBody(),c(),e)},getSelectedBlocks:function(t,n){return function(e,t,n,o){var i,r=[],a=e.getRoot();if(n=e.getParent(n||xm(a,t,t.collapsed),e.isBlock),o=e.getParent(o||Em(a,t,t.collapsed),e.isBlock),n&&n!==a&&r.push(n),n&&o&&n!==o)for(var s=new Ir(i=n,a);(i=s.next())&&i!==o;)e.isBlock(i)&&r.push(i);return o&&n!==o&&o!==a&&r.push(o),r}(e,c(),t,n)},normalize:function(){var t=c(),n=u();if(1<Kc(n).length||!Hc(o))return t;var i=Am(e,t);return i.each((function(e){d(e,f())})),i.getOr(t)},selectorChanged:function(e,t){return a(e,t),h},selectorChangedWithUnbind:a,getScrollContainer:function(){for(var t,n=e.getRoot();n&&"BODY"!==n.nodeName;){if(n.scrollHeight>n.clientHeight){t=n;break}n=n.parentNode}return t},scrollIntoView:function(e,t){var n;((n=o).inline?mm:vm)(n,e,t)},placeCaretAt:function(e,t){return d(Cm(e,t,o.getDoc()))},getBoundingClientRect:function(){var e=c();return e.collapsed?al.fromRangeStart(e).getClientRects()[0]:e.getBoundingClientRect()},destroy:function(){t=i=r=null,m.destroy()}},g=Lm(h),m=Hm(h,o);return h.bookmarkManager=g,h.controlSelection=m,h},jm=function(e){var t,n=decodeURIComponent(e).split(","),o=/data:([^;]+)/.exec(n[0]);return o&&(t=o[1]),{type:t,data:n[1]}},Gm=function(t,n){var o;try{o=e.atob(n)}catch(Ix){return E.none()}for(var i=new Uint8Array(o.length),r=0;r<i.length;r++)i[r]=o.charCodeAt(r);return E.some(new e.Blob([i],{type:t}))},Xm=function(t){return 0===t.indexOf("blob:")?(n=t,new qr((function(t,i){var r=function(){i("Cannot convert "+n+" to Blob. Resource might not exist or is inaccessible.")};try{var a=new e.XMLHttpRequest;a.open("GET",n,!0),a.responseType="blob",a.onload=function(){200===this.status?t(this.response):r()},a.onerror=r,a.send()}catch(o){r()}}))):0===t.indexOf("data:")?(o=t,new qr((function(t){var n=jm(o);Gm(n.type,n.data).fold((function(){return t(new e.Blob([]))}),t)}))):null;var n,o},Ym=0,Zm=function(e){return(e||"blobid")+Ym++},Jm=function(e,t,n,o){(e.padd_empty_with_br||t.insert)&&n[o.name]?o.empty().append(new Qc("br",1)).shortEnded=!0:o.empty().append(new Qc("#text",3)).value=Oo},Qm=function(e,t){return e&&e.firstChild&&e.firstChild===e.lastChild&&e.firstChild.name===t},ep=function(e,t,n,o){return o.isEmpty(t,n,(function(t){return(n=e.getElementRule(t.name))&&n.paddEmpty;var n}))},tp=function(t,n){var o=t.schema;n.remove_trailing_brs&&t.addNodeFilter("br",(function(e,t,i){var r,a,s,l,u,c,d,f,h=e.length,g=pt.extend({},o.getBlockElements()),m=o.getNonEmptyElements(),p=o.getWhiteSpaceElements();for(g.body=1,r=0;r<h;r++)if(s=(a=e[r]).parent,g[a.parent.name]&&a===s.lastChild){for(u=a.prev;u;){if("span"!==(c=u.name)||"bookmark"!==u.attr("data-mce-type")){if("br"!==c)break;if("br"===c){a=null;break}}u=u.prev}a&&(a.remove(),ep(o,m,p,s)&&(d=o.getElementRule(s.name))&&(d.removeEmpty?s.remove():d.paddEmpty&&Jm(n,i,g,s)))}else{for(l=a;s&&s.firstChild===l&&s.lastChild===l&&!g[(l=s).name];)s=s.parent;l===s&&!0!==n.padd_empty_with_br&&((f=new Qc("#text",3)).value=Oo,a.replace(f))}})),t.addAttributeFilter("href",(function(e){var t=e.length,o=function(e){var t=e?pt.trim(e):"";return/\b(noopener)\b/g.test(t)?t:t.split(" ").filter((function(e){return 0<e.length})).concat(["noopener"]).sort().join(" ")};if(!n.allow_unsafe_link_target)for(;t--;){var i=e[t];"a"===i.name&&"_blank"===i.attr("target")&&i.attr("rel",o(i.attr("rel")))}})),n.allow_html_in_named_anchor||t.addAttributeFilter("id,name",(function(e){for(var t,n,o,i,r=e.length;r--;)if("a"===(i=e[r]).name&&i.firstChild&&!i.attr("href"))for(o=i.parent,t=i.lastChild;n=t.prev,o.insert(t,i),t=n;);})),n.fix_list_elements&&t.addNodeFilter("ul,ol",(function(e){for(var t,n,o=e.length;o--;)if("ul"===(n=(t=e[o]).parent).name||"ol"===n.name)if(t.prev&&"li"===t.prev.name)t.prev.append(t);else{var i=new Qc("li",1);i.attr("style","list-style-type: none"),t.wrap(i)}})),n.validate&&o.getValidClasses()&&t.addAttributeFilter("class",(function(e){for(var t,n,i,r,a,s,l,u=e.length,c=o.getValidClasses();u--;){for(n=(t=e[u]).attr("class").split(" "),a="",i=0;i<n.length;i++)r=n[i],l=!1,(s=c["*"])&&s[r]&&(l=!0),s=c[t.name],!l&&s&&s[r]&&(l=!0),l&&(a&&(a+=" "),a+=r);a.length||(a=null),t.attr("class",a)}})),function(t,n){var o=n.blob_cache,i=function(t){var i,r,a=t.attr("src");(i=t).attr("src")===dt.transparentSrc||i.attr("data-mce-placeholder")||t.attr("data-mce-bogus")||((r=/data:([^;]+);base64,([a-z0-9\+\/=]+)/i.exec(a))?E.some({type:r[1],data:decodeURIComponent(r[2])}):E.none()).filter((function(){return function(t,n){if(n.images_dataimg_filter){var o=new e.Image;return o.src=t.attr("src"),ie(t.attributes.map,(function(e,t){o.setAttribute(t,e)})),n.images_dataimg_filter(o)}return!0}(t,n)})).bind((function(e){var t=e.type,n=e.data;return E.from(o.getByData(n,t)).orThunk((function(){return Gm(t,n).map((function(e){var t=o.create(Zm(),e,n);return o.add(t),t}))}))})).each((function(e){t.attr("src",e.blobUri())}))};o&&t.addAttributeFilter("src",(function(e){return H(e,i)}))}(t,n)},np=pt.makeMap,op=pt.each,ip=pt.explode,rp=pt.extend,ap=function(e,t){void 0===t&&(t=Do());var n={},o=[],i={},r={};(e=e||{}).validate=!("validate"in e)||e.validate,e.root_name=e.root_name||"body";var a,s=function(e){var t,a,s;(a=e.name)in n&&((s=i[a])?s.push(e):i[a]=[e]),t=o.length;for(;t--;)(a=o[t].name)in e.attributes.map&&((s=r[a])?s.push(e):r[a]=[e]);return e},l={schema:t,addAttributeFilter:function(e,t){op(ip(e),(function(e){var n;for(n=0;n<o.length;n++)if(o[n].name===e)return void o[n].callbacks.push(t);o.push({name:e,callbacks:[t]})}))},getAttributeFilters:function(){return[].concat(o)},addNodeFilter:function(e,t){op(ip(e),(function(e){var o=n[e];o||(n[e]=o=[]),o.push(t)}))},getNodeFilters:function(){var e=[];for(var t in n)n.hasOwnProperty(t)&&e.push({name:t,callbacks:n[t]});return e},filterNode:s,parse:function(a,l){var u,c,d,f,h,g,m,p,v,y=[];l=l||{},i={},r={};var b,C=rp(np("script,style,head,html,body,title,meta,param"),t.getBlockElements()),T=t.getNonEmptyElements(),x=t.children,E=e.validate,_=!1===(b="forced_root_block"in l?l.forced_root_block:e.forced_root_block)?"":!0===b?"p":b,I=t.getWhiteSpaceElements(),D=/^[ \t\r\n]+/,O=/[ \t\r\n]+$/,w=/[ \t\r\n]+/g,R=/^[ \t\r\n]+$/;p=I.hasOwnProperty(l.context)||I.hasOwnProperty(e.root_name);var S=function(e,t){var o,r=new Qc(e,t);return e in n&&((o=i[e])?o.push(r):i[e]=[r]),r},k=function(e){var n,o,i,r,a=t.getBlockElements();for(n=e.prev;n&&3===n.type;){if(0<(i=n.value.replace(O,"")).length)return void(n.value=i);if(o=n.next){if(3===o.type&&o.value.length){n=n.prev;continue}if(!a[o.name]&&"script"!==o.name&&"style"!==o.name){n=n.prev;continue}}r=n.prev,n.remove(),n=r}},A=cd({validate:E,allow_html_data_urls:e.allow_html_data_urls,allow_script_urls:e.allow_script_urls,allow_conditional_comments:e.allow_conditional_comments,preserve_cdata:e.preserve_cdata,self_closing_elements:function(e){var t,n={};for(t in e)"li"!==t&&"p"!==t&&(n[t]=e[t]);return n}(t.getSelfClosingElements()),cdata:function(e){v.append(S("#cdata",4)).value=e},text:function(e,t){var n,o;p||(e=e.replace(w," "),(o=v.lastChild)&&(C[o.name]||"br"===o.name)&&(e=e.replace(D,""))),0!==e.length&&((n=S("#text",3)).raw=!!t,v.append(n).value=e)},comment:function(e){v.append(S("#comment",8)).value=e},pi:function(e,t){v.append(S(e,7)).value=t,k(v)},doctype:function(e){v.append(S("#doctype",10)).value=e,k(v)},start:function(e,n,i){var a,s,l,u,c=E?t.getElementRule(e):{};if(c){for((a=S(c.outputName||e,1)).attributes=n,a.shortEnded=i,v.append(a),(u=x[v.name])&&x[a.name]&&!u[a.name]&&y.push(a),s=o.length;s--;)(l=o[s].name)in n.map&&((g=r[l])?g.push(a):r[l]=[a]);C[e]&&k(a),i||(v=a),!p&&I[e]&&(p=!0)}},end:function(n){var o,i,r,a,s,u=E?t.getElementRule(n):{};if(u){if(C[n]&&!p){if((o=v.firstChild)&&3===o.type)if(0<(i=o.value.replace(D,"")).length)o.value=i,o=o.next;else for(r=o.next,o.remove(),o=r;o&&3===o.type;)r=o.next,0!==(i=o.value).length&&!R.test(i)||(o.remove(),o=r),o=r;if((o=v.lastChild)&&3===o.type)if(0<(i=o.value.replace(O,"")).length)o.value=i,o=o.prev;else for(r=o.prev,o.remove(),o=r;o&&3===o.type;)r=o.prev,0!==(i=o.value).length&&!R.test(i)||(o.remove(),o=r),o=r}if(p&&I[n]&&(p=!1),u.removeEmpty&&ep(t,T,I,v))return a=v.parent,C[v.name]?v.empty().remove():v.unwrap(),void(v=a);u.paddEmpty&&(Qm(s=v,"#text")&&s.firstChild.value===Oo||ep(t,T,I,v))&&Jm(e,l,C,v),v=v.parent}}},t),N=v=new Qc(l.context||e.root_name,11);if(A.parse(a,l.format),E&&y.length&&(l.context?l.invalid=!0:function(e){var n,o,i,r,a,l,u,c,d,f,h,g=np("tr,td,th,tbody,thead,tfoot,table"),m=t.getNonEmptyElements(),p=t.getWhiteSpaceElements(),v=t.getTextBlockElements(),y=t.getSpecialElements();for(n=0;n<e.length;n++)if((o=e[n]).parent&&!o.fixed)if(v[o.name]&&"li"===o.parent.name){for(f=o.next;f&&v[f.name];)f.name="li",f.fixed=!0,o.parent.insert(f,o.parent),f=f.next;o.unwrap(o)}else{for(r=[o],i=o.parent;i&&!t.isValidChild(i.name,o.name)&&!g[i.name];i=i.parent)r.push(i);if(i&&1<r.length){for(r.reverse(),a=l=s(r[0].clone()),d=0;d<r.length-1;d++){for(t.isValidChild(l.name,r[d].name)?(u=s(r[d].clone()),l.append(u)):u=l,c=r[d].firstChild;c&&c!==r[d+1];)h=c.next,u.append(c),c=h;l=u}ep(t,m,p,a)?i.insert(o,r[0],!0):(i.insert(a,r[0],!0),i.insert(o,a)),(ep(t,m,p,i=r[0])||Qm(i,"br"))&&i.empty().remove()}else if(o.parent){if("li"===o.name){if((f=o.prev)&&("ul"===f.name||"ul"===f.name)){f.append(o);continue}if((f=o.next)&&("ul"===f.name||"ul"===f.name)){f.insert(o,f.firstChild,!0);continue}o.wrap(s(new Qc("ul",1)));continue}t.isValidChild(o.parent.name,"div")&&t.isValidChild("div",o.name)?o.wrap(s(new Qc("div",1))):y[o.name]?o.empty().remove():o.unwrap()}}}(y)),_&&("body"===N.name||l.isRootContent)&&function(){var n,o,i=N.firstChild,r=function(e){e&&((i=e.firstChild)&&3===i.type&&(i.value=i.value.replace(D,"")),(i=e.lastChild)&&3===i.type&&(i.value=i.value.replace(O,"")))};if(t.isValidChild(N.name,_.toLowerCase())){for(;i;)n=i.next,3===i.type||1===i.type&&"p"!==i.name&&!C[i.name]&&!i.attr("data-mce-type")?(o||((o=S(_,1)).attr(e.forced_root_block_attrs),N.insert(o,i)),o.append(i)):(r(o),o=null),i=n;r(o)}}(),!l.invalid){for(m in i)if(i.hasOwnProperty(m)){for(g=n[m],f=(u=i[m]).length;f--;)u[f].parent||u.splice(f,1);for(c=0,d=g.length;c<d;c++)g[c](u,m,l)}for(c=0,d=o.length;c<d;c++)if((g=o[c]).name in r){for(f=(u=r[g.name]).length;f--;)u[f].parent||u.splice(f,1);for(f=0,h=g.callbacks.length;f<h;f++)g.callbacks[f](u,g.name,l)}}return N}};return tp(l,e),(a=e).inline_styles&&function(e,t){var n,o=Ro();t.convert_fonts_to_spans&&function(e,t,n){e.addNodeFilter("font",(function(e){H(e,(function(e){var o,i=t.parse(e.attr("style")),r=e.attr("color"),a=e.attr("face"),s=e.attr("size");r&&(i.color=r),a&&(i["font-family"]=a),s&&(i["font-size"]=n[parseInt(e.attr("size"),10)-1]),e.name="span",e.attr("style",t.serialize(i)),o=e,H(["color","face","size"],(function(e){o.attr(e,null)}))}))}))}(e,o,pt.explode(t.font_size_legacy_values)),n=o,e.addNodeFilter("strike",(function(e){H(e,(function(e){var t=n.parse(e.attr("style"));t["text-decoration"]="line-through",e.name="span",e.attr("style",n.serialize(t))}))}))}(l,a),l},sp=function(e,t,n){-1===pt.inArray(t,n)&&(e.addAttributeFilter(n,(function(e,t){for(var n=e.length;n--;)e[n].attr(t,null)})),t.push(n))},lp=function(t,n){var o=function(t,n){var o=["data-mce-selected"],i=n&&n.dom?n.dom:ma.DOM,r=n&&n.schema?n.schema:Do(t);t.entity_encoding=t.entity_encoding||"named",t.remove_trailing_brs=!("remove_trailing_brs"in t)||t.remove_trailing_brs;var a,s,l,u=ap(t,r);return s=t,l=i,(a=u).addAttributeFilter("data-mce-tabindex",(function(e,t){for(var n,o=e.length;o--;)(n=e[o]).attr("tabindex",n.attr("data-mce-tabindex")),n.attr(t,null)})),a.addAttributeFilter("src,href,style",(function(e,t){for(var n,o,i=e.length,r="data-mce-"+t,a=s.url_converter,u=s.url_converter_scope;i--;)void 0!==(o=(n=e[i]).attr(r))?(n.attr(t,0<o.length?o:null),n.attr(r,null)):(o=n.attr(t),"style"===t?o=l.serializeStyle(l.parseStyle(o),n.name):a&&(o=a.call(u,o,t,n.name)),n.attr(t,0<o.length?o:null))})),a.addAttributeFilter("class",(function(e){for(var t,n,o=e.length;o--;)(n=(t=e[o]).attr("class"))&&(n=t.attr("class").replace(/(?:^|\s)mce-item-\w+(?!\S)/g,""),t.attr("class",0<n.length?n:null))})),a.addAttributeFilter("data-mce-type",(function(e,t,n){for(var o,i=e.length;i--;)"bookmark"!==(o=e[i]).attr("data-mce-type")||n.cleanup||(E.from(o.firstChild).exists((function(e){return!is(e.value)}))?o.unwrap():o.remove())})),a.addNodeFilter("noscript",(function(e){for(var t,n=e.length;n--;)(t=e[n].firstChild)&&(t.value=po.decode(t.value))})),a.addNodeFilter("script,style",(function(e,t){for(var n,o,i,r=e.length,a=function(e){return e.replace(/(<!--\[CDATA\[|\]\]-->)/g,"\n").replace(/^[\r\n]*|[\r\n]*$/g,"").replace(/^\s*((<!--)?(\s*\/\/)?\s*<!\[CDATA\[|(<!--\s*)?\/\*\s*<!\[CDATA\[\s*\*\/|(\/\/)?\s*<!--|\/\*\s*<!--\s*\*\/)\s*[\r\n]*/gi,"").replace(/\s*(\/\*\s*\]\]>\s*\*\/(-->)?|\s*\/\/\s*\]\]>(-->)?|\/\/\s*(-->)?|\]\]>|\/\*\s*-->\s*\*\/|\s*-->\s*)\s*$/g,"")};r--;)o=(n=e[r]).firstChild?n.firstChild.value:"","script"===t?((i=n.attr("type"))&&n.attr("type","mce-no/type"===i?null:i.replace(/^mce\-/,"")),"xhtml"===s.element_format&&0<o.length&&(n.firstChild.value="// <![CDATA[\n"+a(o)+"\n// ]]>")):"xhtml"===s.element_format&&0<o.length&&(n.firstChild.value="\x3c!--\n"+a(o)+"\n--\x3e")})),a.addNodeFilter("#comment",(function(e){for(var t,n=e.length;n--;)t=e[n],s.preserve_cdata&&0===t.value.indexOf("[CDATA[")?(t.name="#cdata",t.type=4,t.value=l.decode(t.value.replace(/^\[CDATA\[|\]\]$/g,""))):0===t.value.indexOf("mce:protected ")&&(t.name="#text",t.type=3,t.raw=!0,t.value=unescape(t.value).substr(14))})),a.addNodeFilter("xml:namespace,input",(function(e,t){for(var n,o=e.length;o--;)7===(n=e[o]).type?n.remove():1===n.type&&("input"!==t||n.attr("type")||n.attr("type","text"))})),a.addAttributeFilter("data-mce-type",(function(e){H(e,(function(e){"format-caret"===e.attr("data-mce-type")&&(e.isEmpty(a.schema.getNonEmptyElements())?e.remove():e.unwrap())}))})),a.addAttributeFilter("data-mce-src,data-mce-href,data-mce-style,data-mce-selected,data-mce-expando,data-mce-type,data-mce-resize,data-mce-placeholder",(function(e,t){for(var n=e.length;n--;)e[n].attr(t,null)})),{schema:r,addNodeFilter:u.addNodeFilter,addAttributeFilter:u.addAttributeFilter,serialize:function(o,a){void 0===a&&(a={});var s,l,c,d,f,h,g,m,p=Te({format:"html"},a),v=function(t,n,o){return r=o,(i=t)&&i.hasEventListeners("PreProcess")&&!r.no_events?function(t,n,o){var i,r,a=t.dom;n=n.cloneNode(!0);var s,l,u=e.document.implementation;return u.createHTMLDocument&&(i=u.createHTMLDocument(""),pt.each("BODY"===n.nodeName?n.childNodes:[n],(function(e){i.body.appendChild(i.importNode(e,!0))})),n="BODY"!==n.nodeName?i.body.firstChild:i.body,r=a.doc,a.doc=i),s=t,l=Te(Te({},o),{node:n}),s.fire("PreProcess",l),r&&(a.doc=r),n}(t,n,o):n;var i,r}(n,o,p),y=(s=v,c=rs((l=p).getInner?s.innerHTML:i.getOuterHTML(s)),l.selection||Zn(yt.fromDom(s))?c:pt.trim(c)),b=(d=u,f=y,g=(h=p).selection?Te({forced_root_block:!1},h):h,function(e){var t=function(e){return e&&"br"===e.name},n=e.lastChild;if(t(n)){var o=n.prev;t(o)&&(n.remove(),o.remove())}}(m=d.parse(f,g)),m);return"tree"===p.format?b:function(e,t,n,o,i){var r,a,s,l,u,c;return a=e,r=o,l=od(t,n).serialize(r),(s=i).no_events||!a?l:(u=a,c=Te(Te({},s),{content:l}),u.fire("PostProcess",c).content)}(n,t,r,b,p)},addRules:function(e){r.addValidElements(e)},setRules:function(e){r.setValidElements(e)},addTempAttr:f(sp,u,o),getTempAttrs:function(){return o},getNodeFilters:u.getNodeFilters,getAttributeFilters:u.getAttributeFilters}}(t,n);return{schema:o.schema,addNodeFilter:o.addNodeFilter,addAttributeFilter:o.addAttributeFilter,serialize:o.serialize,addRules:o.addRules,setRules:o.setRules,addTempAttr:o.addTempAttr,getTempAttrs:o.getTempAttrs,getNodeFilters:o.getNodeFilters,getAttributeFilters:o.getAttributeFilters}},up=0,cp=function(e){return e+up+++(t=function(){return Math.round(4294967295*Math.random()).toString(36)},"s"+(new Date).getTime().toString(36)+t()+t()+t());var t},dp=function(e,t,n,o,i){var r,a,s,l,u,c,d,f;return null===t.get()&&(a=e,s=xa({}),(r=t).set({}),a.on("NodeChange",(function(e){!function(e,t,n,o){var i=ne(n.get()),r={},a={},s=$(yc(e.dom,t),(function(e){return 1===e.nodeType&&!e.getAttribute("data-mce-bogus")}));ie(o,(function(t,n){pt.each(s,(function(o){return e.formatter.matchNode(o,n,{},t.similar)?(-1===i.indexOf(n)&&(H(t.callbacks,(function(e){e(!0,{node:o,format:n,parents:s})})),r[n]=t.callbacks),a[n]=t.callbacks,!1):!Zf(e,o,n)&&void 0}))}));var l=function(e,t,n,o){return ue(e,(function(e,i){return!!fe(t,i)||(H(e,(function(e){e(!1,{node:n,format:i,parents:o})})),!1)})).t}(n.get(),a,t,s);n.set(Te(Te({},r),l))}(a,e.element,s,r.get())}))),u=n,c=o,d=i,f=(l=t).get(),H(u.split(","),(function(e){f[e]||(f[e]={similar:d,callbacks:[]}),f[e].callbacks.push(c)})),l.set(f),{unbind:function(){return i=n,r=o,a=(e=t).get(),H(i.split(","),(function(e){a[e].callbacks=$(a[e].callbacks,(function(e){return e!==r})),0===a[e].callbacks.length&&delete a[e]})),void e.set(a);var e,i,r,a}}},fp=pt.each,hp=ma.DOM,gp=function(e,t){var n,o,i,r=t&&t.schema||Do({}),a=function(e){var t,n,i=hp.create((o="string"==typeof e?{name:e,classes:[],attrs:{}}:e).name);return t=i,(n=o).classes.length&&hp.addClass(t,n.classes.join(" ")),hp.setAttribs(t,n.attrs),i},s=function(e,t,n){var o,i,l,u,c,d,f,h=0<t.length&&t[0],g=h&&h.name,m=(u=g,c="string"!=typeof(l=e)?l.nodeName.toLowerCase():l,!(!(f=(d=r.getElementRule(c))&&d.parentsRequired)||!f.length)&&(u&&-1!==pt.inArray(f,u)?u:f[0]));if(m)g===m?(i=t[0],t=t.slice(1)):i=m;else if(h)i=t[0],t=t.slice(1);else if(!n)return e;return i&&(o=a(i)).appendChild(e),n&&(o||(o=hp.create("div")).appendChild(e),pt.each(n,(function(t){var n=a(t);o.insertBefore(n,e)}))),s(o,t,i&&i.siblings)};return e&&e.length?(n=a(o=e[0]),(i=hp.create("div")).appendChild(s(n,e.slice(1),o.siblings)),i):""},mp=function(e){var t,n={classes:[],attrs:{}};return"*"!==(e=n.selector=pt.trim(e))&&(t=e.replace(/(?:([#\.]|::?)([\w\-]+)|(\[)([^\]]+)\]?)/g,(function(e,t,o,i,r){switch(t){case"#":n.attrs.id=o;break;case".":n.classes.push(o);break;case":":-1!==pt.inArray("checked disabled enabled read-only required".split(" "),o)&&(n.attrs[o]=o)}if("["===i){var a=r.match(/([\w\-]+)(?:\=\"([^\"]+))?/);a&&(n.attrs[a[1]]=a[2])}return""}))),n.name=t||"div",n},pp=function(e,t){var n,o,i,r,a="",s=(r=e.getParam("preview_styles","font-family font-size font-weight font-style text-decoration text-transform color background-color border border-radius outline text-shadow"),O(r)?r:"");if(""===s)return"";var l=function(e){return e.replace(/%(\w+)/g,"")};if("string"==typeof t){if(!(t=e.formatter.get(t)))return;t=t[0]}if("preview"in t){var u=de(t,"preview");if(u.is(!1))return"";s=u.getOr(s)}n=t.block||t.inline||"span";var c,d=(c=t.selector)&&"string"==typeof c?(c=(c=c.split(/\s*,\s*/)[0]).replace(/\s*(~\+|~|\+|>)\s*/g,"$1"),pt.map(c.split(/(?:>|\s+(?![^\[\]]+\]))/),(function(e){var t=pt.map(e.split(/(?:~\+|~|\+)/),mp),n=t.pop();return t.length&&(n.siblings=t),n})).reverse()):[];o=d.length?(d[0].name||(d[0].name=n),n=t.selector,gp(d,e)):gp([n],e);var f=hp.select(n,o)[0]||o.firstChild;return fp(t.styles,(function(e,t){(e=l(e))&&hp.setStyle(f,t,e)})),fp(t.attributes,(function(e,t){(e=l(e))&&hp.setAttrib(f,t,e)})),fp(t.classes,(function(e){e=l(e),hp.hasClass(f,e)||hp.addClass(f,e)})),e.fire("PreviewFormats"),hp.setStyles(o,{position:"absolute",left:-65535}),e.getBody().appendChild(o),i=hp.getStyle(e.getBody(),"fontSize",!0),i=/px$/.test(i)?parseInt(i,10):0,fp(s.split(" "),(function(t){var n=hp.getStyle(f,t,!0);if(!("background-color"===t&&/transparent|rgba\s*\([^)]+,\s*0\)/.test(n)&&(n=hp.getStyle(e.getBody(),t,!0),"#ffffff"===hp.toHex(n).toLowerCase())||"color"===t&&"#000000"===hp.toHex(n).toLowerCase())){if("font-size"===t&&/em|%$/.test(n)){if(0===i)return;n=parseFloat(n)/(/%$/.test(n)?100:1)*i+"px"}"border"===t&&n&&(a+="padding:0 2px;"),a+=t+":"+n+";"}})),e.fire("AfterPreviewFormats"),hp.remove(o),a},vp=function(e){var t=function(e){var t,n,o={},i=function(e,t){e&&("string"!=typeof e?pt.each(e,(function(e,t){i(t,e)})):(R(t)||(t=[t]),pt.each(t,(function(e){void 0===e.deep&&(e.deep=!e.selector),void 0===e.split&&(e.split=!e.selector||e.inline),void 0===e.remove&&e.selector&&!e.inline&&(e.remove="none"),e.selector&&e.inline&&(e.mixed=!0,e.block_expand=!0),"string"==typeof e.classes&&(e.classes=e.classes.split(/\s+/))})),o[e]=t))};return i((t=e.dom,n={valigntop:[{selector:"td,th",styles:{verticalAlign:"top"}}],valignmiddle:[{selector:"td,th",styles:{verticalAlign:"middle"}}],valignbottom:[{selector:"td,th",styles:{verticalAlign:"bottom"}}],alignleft:[{selector:"figure.image",collapsed:!1,classes:"align-left",ceFalseOverride:!0,preview:"font-family font-size"},{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li",styles:{textAlign:"left"},inherit:!1,preview:!1,defaultBlock:"div"},{selector:"img,table",collapsed:!1,styles:{float:"left"},preview:"font-family font-size"}],aligncenter:[{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li",styles:{textAlign:"center"},inherit:!1,preview:"font-family font-size",defaultBlock:"div"},{selector:"figure.image",collapsed:!1,classes:"align-center",ceFalseOverride:!0,preview:"font-family font-size"},{selector:"img",collapsed:!1,styles:{display:"block",marginLeft:"auto",marginRight:"auto"},preview:!1},{selector:"table",collapsed:!1,styles:{marginLeft:"auto",marginRight:"auto"},preview:"font-family font-size"}],alignright:[{selector:"figure.image",collapsed:!1,classes:"align-right",ceFalseOverride:!0,preview:"font-family font-size"},{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li",styles:{textAlign:"right"},inherit:!1,preview:"font-family font-size",defaultBlock:"div"},{selector:"img,table",collapsed:!1,styles:{float:"right"},preview:"font-family font-size"}],alignjustify:[{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li",styles:{textAlign:"justify"},inherit:!1,defaultBlock:"div",preview:"font-family font-size"}],bold:[{inline:"strong",remove:"all",preserve_attributes:["class","style"]},{inline:"span",styles:{fontWeight:"bold"}},{inline:"b",remove:"all",preserve_attributes:["class","style"]}],italic:[{inline:"em",remove:"all",preserve_attributes:["class","style"]},{inline:"span",styles:{fontStyle:"italic"}},{inline:"i",remove:"all",preserve_attributes:["class","style"]}],underline:[{inline:"span",styles:{textDecoration:"underline"},exact:!0},{inline:"u",remove:"all",preserve_attributes:["class","style"]}],strikethrough:[{inline:"span",styles:{textDecoration:"line-through"},exact:!0},{inline:"strike",remove:"all",preserve_attributes:["class","style"]}],forecolor:{inline:"span",styles:{color:"%value"},links:!0,remove_similar:!0,clear_child_styles:!0},hilitecolor:{inline:"span",styles:{backgroundColor:"%value"},links:!0,remove_similar:!0,clear_child_styles:!0},fontname:{inline:"span",toggle:!1,styles:{fontFamily:"%value"},clear_child_styles:!0},fontsize:{inline:"span",toggle:!1,styles:{fontSize:"%value"},clear_child_styles:!0},fontsize_class:{inline:"span",attributes:{class:"%value"}},blockquote:{block:"blockquote",wrapper:!0,remove:"all"},subscript:{inline:"sub"},superscript:{inline:"sup"},code:{inline:"code"},link:{inline:"a",selector:"a",remove:"all",split:!0,deep:!0,onmatch:function(e,t,n){return fn(e)&&e.hasAttribute("href")},onformat:function(e,n,o){pt.each(o,(function(n,o){t.setAttrib(e,o,n)}))}},removeformat:[{selector:"b,strong,em,i,font,u,strike,sub,sup,dfn,code,samp,kbd,var,cite,mark,q,del,ins",remove:"all",split:!0,expand:!1,block_expand:!0,deep:!0},{selector:"span",attributes:["style","class"],remove:"empty",split:!0,expand:!1,deep:!0},{selector:"*",attributes:["style","class"],split:!1,expand:!1,deep:!0}]},pt.each("p h1 h2 h3 h4 h5 h6 div address pre div dt dd samp".split(/\s/),(function(e){n[e]={block:e,remove:"all"}})),n)),i(e.getParam("formats")),{get:function(e){return e?o[e]:o},has:function(e){return fe(o,e)},register:i,unregister:function(e){return e&&o[e]&&delete o[e],o}}}(e),n=xa(null);return function(e){e.addShortcut("meta+b","","Bold"),e.addShortcut("meta+i","","Italic"),e.addShortcut("meta+u","","Underline");for(var t=1;t<=6;t++)e.addShortcut("access+"+t,"",["FormatBlock",!1,"h"+t]);e.addShortcut("access+7","",["FormatBlock",!1,"p"]),e.addShortcut("access+8","",["FormatBlock",!1,"div"]),e.addShortcut("access+9","",["FormatBlock",!1,"address"])}(e),function(e){e.on("mouseup keydown",(function(t){var n,o,i,r;o=t.keyCode,i=(n=e).selection,r=n.getBody(),dh(n,null,!1),8!==o&&46!==o||!i.isCollapsed()||i.getStart().innerHTML!==rh||dh(n,Gu(r,i.getStart())),37!==o&&39!==o||dh(n,Gu(r,i.getStart()))}))}(e),{get:t.get,has:t.has,register:t.register,unregister:t.unregister,apply:function(t,n,o){var i,r,a;i=t,r=n,a=o,Cg(e).formatter.apply(i,r,a)},remove:function(t,n,o,i){var r,a,s,l;r=t,a=n,s=o,l=i,Cg(e).formatter.remove(r,a,s,l)},toggle:function(t,n,o){var i,r,a;i=t,r=n,a=o,Cg(e).formatter.toggle(i,r,a)},match:f(nh,e),matchAll:f(oh,e),matchNode:f(th,e),canApply:f(ih,e),formatChanged:f(dp,e,n),getCssText:f(pp,e)}},yp=function(e){var t,n=xa(E.none()),o=xa(0),i=xa(0),r={data:[],typing:!1,beforeChange:function(){var t,i;t=o,i=n,Cg(e).undoManager.beforeChange(t,i)},add:function(t,a){return s=r,l=i,u=o,c=n,d=t,f=a,Cg(e).undoManager.addUndoLevel(s,l,u,c,d,f);var s,l,u,c,d,f},undo:function(){return t=r,n=o,a=i,Cg(e).undoManager.undo(t,n,a);var t,n,a},redo:function(){return t=i,n=r.data,Cg(e).undoManager.redo(t,n);var t,n},clear:function(){var t,n;t=r,n=i,Cg(e).undoManager.clear(t,n)},reset:function(){var t;t=r,Cg(e).undoManager.reset(t)},hasUndo:function(){return t=r,n=i,Cg(e).undoManager.hasUndo(t,n);var t,n},hasRedo:function(){return t=r,n=i,Cg(e).undoManager.hasRedo(t,n);var t,n},transact:function(t){return n=r,i=o,a=t,Cg(e).undoManager.transact(n,i,a);var n,i,a},ignore:function(t){var n,i;n=o,i=t,Cg(e).undoManager.ignore(n,i)},extra:function(t,n){var o,a,s,l;o=r,a=i,s=t,l=n,Cg(e).undoManager.extra(o,a,s,l)}};return vg(e)||function(e,t,n){var o=xa(!1),i=function(e){fg(t,!1,n),t.add({},e)};e.on("init",(function(){t.add()})),e.on("BeforeExecCommand",(function(e){var o=e.command.toLowerCase();"undo"!==o&&"redo"!==o&&"mcerepaint"!==o&&(hg(t,n),t.beforeChange())})),e.on("ExecCommand",(function(e){var t=e.command.toLowerCase();"undo"!==t&&"redo"!==t&&"mcerepaint"!==t&&i(e)})),e.on("ObjectResizeStart cut",(function(){t.beforeChange()})),e.on("SaveContent ObjectResized blur",i),e.on("dragend",i),e.on("keyup",(function(n){var r=n.keyCode;n.isDefaultPrevented()||((33<=r&&r<=36||37<=r&&r<=40||45===r||n.ctrlKey)&&(i(),e.nodeChanged()),46!==r&&8!==r||e.nodeChanged(),o.get()&&t.typing&&!1===cg(ag(e),t.data[0])&&(!1===e.isDirty()&&(e.setDirty(!0),e.fire("change",{level:t.data[0],lastLevel:null})),e.fire("TypingUndo"),o.set(!1),e.nodeChanged()))})),e.on("keydown",(function(e){var r=e.keyCode;e.isDefaultPrevented()||(33<=r&&r<=36||37<=r&&r<=40||45===r?t.typing&&i(e):!(r<16||20<r)||224===r||91===r||t.typing||e.ctrlKey&&!e.altKey||e.metaKey||(t.beforeChange(),fg(t,!0,n),t.add({},e),o.set(!0)))})),e.on("mousedown",(function(e){t.typing&&i(e)})),e.on("input",(function(e){var t,n;e.inputType&&("insertReplacementText"===e.inputType||"insertText"===(n=e).inputType&&null===n.data||"insertFromPaste"===(t=e).inputType||"insertFromDrop"===t.inputType)&&i(e)})),e.on("AddUndo Undo Redo ClearUndos",(function(t){t.isDefaultPrevented()||e.nodeChanged()}))}(e,r,o),(t=e).addShortcut("meta+z","","Undo"),t.addShortcut("meta+y,meta+shift+z","","Redo"),r},bp=[9,27,Fm.HOME,Fm.END,19,20,44,144,145,33,34,45,16,17,18,91,92,93,Fm.DOWN,Fm.UP,Fm.LEFT,Fm.RIGHT].concat(dt.browser.isFirefox()?[224]:[]),Cp="data-mce-placeholder",Tp=function(e){return"keydown"===e.type||"keyup"===e.type},xp=function(e){var t=e.keyCode;return t===Fm.BACKSPACE||t===Fm.DELETE},Ep=function(e){return void 0===e.touches||1!==e.touches.length?E.none():E.some(e.touches[0])},_p=function(e,t){return e.hasOwnProperty(t.nodeName)},Ip=function(e,t){if(Cn(t)){if(0===t.nodeValue.length)return!0;if(/^\s+$/.test(t.nodeValue)&&(!t.nextSibling||_p(e,t.nextSibling)))return!0}return!1},Dp=function(e){var t,n,o,i=e.dom,r=e.selection,a=e.schema,s=a.getBlockElements(),l=r.getStart(),u=e.getBody(),c=kl(e);if(l&&fn(l)&&c){var d=u.nodeName.toLowerCase();if(a.isValidChild(d,c.toLowerCase())&&(f=s,h=u,!z(Kd(yt.fromDom(l),yt.fromDom(h)),(function(e){return _p(f,e.dom())})))){var f,h,g,m,p=r.getRng(),v=p.startContainer,y=p.startOffset,b=p.endContainer,C=p.endOffset,T=Vf(e);for(l=u.firstChild;l;)if(g=s,Cn(m=l)||fn(m)&&!_p(g,m)&&!oc(m)){if(Ip(s,l)){l=(n=l).nextSibling,i.remove(n);continue}t||(t=i.create(c,Al(e)),l.parentNode.insertBefore(t,l),o=!0),l=(n=l).nextSibling,t.appendChild(n)}else t=null,l=l.nextSibling;o&&T&&(p.setStart(v,y),p.setEnd(b,C),r.setRng(p),e.nodeChanged())}}},Op=function(e,t,n){var o=e?1:-1;return t.setRng(al(n.container(),n.offset()+o).toRange()),t.getSel().modify("move",e?"forward":"backward","word"),!0},wp=Cn,Rp=function(e){return wp(e)&&e.data[0]===os},Sp=function(e){return wp(e)&&e.data[e.data.length-1]===os},kp=function(e){return e.ownerDocument.createTextNode(os)},Ap=function(e,t){return(e?function(e){if(wp(e.previousSibling))return Sp(e.previousSibling)||e.previousSibling.appendData(os),e.previousSibling;if(wp(e))return Rp(e)||e.insertData(0,os),e;var t=kp(e);return e.parentNode.insertBefore(t,e),t}:function(e){if(wp(e.nextSibling))return Rp(e.nextSibling)||e.nextSibling.insertData(0,os),e.nextSibling;if(wp(e))return Sp(e)||e.appendData(os),e;var t=kp(e);return e.nextSibling?e.parentNode.insertBefore(t,e.nextSibling):e.parentNode.appendChild(t),t})(t)},Np=f(Ap,!0),Mp=f(Ap,!1),Kp=function(e,t){return Cn(e.container())?Ap(t,e.container()):Ap(t,e.getNode())},Pp=function(e,t){var n=t.get();return n&&e.container()===n&&us(n)},Lp=function(e,t){return t.fold((function(t){Zl(e.get());var n=Np(t);return e.set(n),E.some(al(n,n.length-1))}),(function(t){return $u(t).map((function(t){if(Pp(t,e))return al(e.get(),1);Zl(e.get());var n=Kp(t,!0);return e.set(n),al(n,1)}))}),(function(t){return Uu(t).map((function(t){if(Pp(t,e))return al(e.get(),e.get().length-1);Zl(e.get());var n=Kp(t,!1);return e.set(n),al(n,n.length-1)}))}),(function(t){Zl(e.get());var n=Mp(t);return e.set(n),E.some(al(n,1))}))},Bp=/[\u0591-\u07FF\uFB1D-\uFDFF\uFE70-\uFEFC]/,Fp=function(e,t){return Ot(yt.fromDom(t),e.getParam("inline_boundaries_selector","a[href],code,.mce-annotation","string"))},zp=function(e,t,n){var o,i,r=(o=e,i=t,$(ma.DOM.getParents(n.container(),"*",i),o));return E.from(r[r.length-1])},Vp=function(e,t){if(!t)return t;var n=t.container(),o=t.offset();return e?us(n)?Cn(n.nextSibling)?al(n.nextSibling,0):al.after(n):fs(t)?al(n,o+1):t:us(n)?Cn(n.previousSibling)?al(n.previousSibling,n.previousSibling.data.length):al.before(n):hs(t)?al(n,o-1):t},Hp=f(Vp,!0),Wp=f(Vp,!1),$p=function(e,t){for(var n=0;n<e.length;n++){var o=e[n].apply(null,t);if(o.isSome())return o}return E.none()},Up=$r([{before:["element"]},{start:["element"]},{end:["element"]},{after:["element"]}]),qp=function(e,t){return du(t,e)||e},jp=function(e,t,n){var o=Hp(n),i=qp(t,o.container());return zp(e,i,o).fold((function(){return Hu(i,o).bind(f(zp,e,i)).map((function(e){return Up.before(e)}))}),E.none)},Gp=function(e,t){return null===Gu(e,t)},Xp=function(e,t,n){return zp(e,t,n).filter(f(Gp,t))},Yp=function(e,t,n){var o=Wp(n);return Xp(e,t,o).bind((function(e){return Wu(e,o).isNone()?E.some(Up.start(e)):E.none()}))},Zp=function(e,t,n){var o=Hp(n);return Xp(e,t,o).bind((function(e){return Hu(e,o).isNone()?E.some(Up.end(e)):E.none()}))},Jp=function(e,t,n){var o=Wp(n),i=qp(t,o.container());return zp(e,i,o).fold((function(){return Wu(i,o).bind(f(zp,e,i)).map((function(e){return Up.after(e)}))}),E.none)},Qp=function(e){return!1===function(e){return"rtl"===ma.DOM.getStyle(e,"direction",!0)||Bp.test(e.textContent)}(tv(e))},ev=function(e,t,n){return $p([jp,Yp,Zp,Jp],[e,t,n]).filter(Qp)},tv=function(e){return e.fold(d,d,d,d)},nv=function(e){return e.fold(c("before"),c("start"),c("end"),c("after"))},ov=function(e){return e.fold(Up.before,Up.before,Up.after,Up.after)},iv=function(e){return e.fold(Up.start,Up.start,Up.end,Up.end)},rv=function(e,t,n,o,i,r){return vs(zp(t,n,o),zp(t,n,i),(function(t,o){return t!==o&&(a=o,s=du(t,i=n),l=du(a,i),s&&s===l)?Up.after(e?t:o):r;var i,a,s,l})).getOr(r)},av=function(e,t){return e.fold(c(!0),(function(e){return o=t,!(nv(n=e)===nv(o)&&tv(n)===tv(o));var n,o}))},sv=function(e,t){return e?t.fold(u(E.some,Up.start),E.none,u(E.some,Up.after),E.none):t.fold(E.none,u(E.some,Up.before),E.none,u(E.some,Up.end))},lv=function(e,t,n,o){var i=Vp(e,o),r=ev(t,n,i);return ev(t,n,i).bind(f(sv,e)).orThunk((function(){return a=t,s=n,l=r,u=Vp(i=e,o),Bu(i,s,u).map(f(Vp,i)).fold((function(){return l.map(ov)}),(function(e){return ev(a,s,e).map(f(rv,i,a,s,u,e)).filter(f(av,l))})).filter(Qp);var i,a,s,l,u}))},uv=(f(lv,!1),f(lv,!0),function(e,t){var n=e.dom.createRng();n.setStart(t.container(),t.offset()),n.setEnd(t.container(),t.offset()),e.selection.setRng(n)}),cv=function(e,t){e?t.setAttribute("data-mce-selected","inline-boundary"):t.removeAttribute("data-mce-selected")},dv=function(e,t,n){return Lp(t,n).map((function(t){return uv(e,t),n}))},fv=function(e,t,n){return function(){return!!Vl(e)&&(i=t,r=n,a=(o=e).getBody(),s=al.fromRangeStart(o.selection.getRng()),l=f(Fp,o),lv(r,l,a,s).bind((function(e){return dv(o,i,e)})).isSome());var o,i,r,a,s,l}},hv=function(e,t,n){return function(){return!!Vl(t)&&function(e,t){var n=t.selection.getRng(),o=e?al.fromRangeEnd(n):al.fromRangeStart(n);return!!N(t.selection.getSel().modify)&&(e&&fs(o)?Op(!0,t.selection,o):!(e||!hs(o))&&Op(!1,t.selection,o))}(e,t)}},gv=f(hv,!0),mv=f(hv,!1);(Pm=Km=Km||{})[Pm.Br=0]="Br",Pm[Pm.Block=1]="Block",Pm[Pm.Wrap=2]="Wrap",Pm[Pm.Eol=3]="Eol";var pv,vv,yv=function(e,t){return e===il.Backwards?Z(t):t},bv=function(e,t,n,o){for(var i,r,a,s,l,u=Mu(n),c=o,d=[];c&&(s=u,l=c,i=t===il.Forwards?s.next(l):s.prev(l));){if(_n(i.getNode(!1)))return t===il.Forwards?{positions:yv(t,d).concat([i]),breakType:Km.Br,breakAt:E.some(i)}:{positions:yv(t,d),breakType:Km.Br,breakAt:E.some(i)};if(i.isVisible()){if(e(c,i)){var f=(r=c,_n((a=i).getNode(t===il.Forwards))?Km.Br:!1===fu(r,a)?Km.Block:Km.Wrap);return{positions:yv(t,d),breakType:f,breakAt:E.some(i)}}d.push(i),c=i}else c=i}return{positions:yv(t,d),breakType:Km.Eol,breakAt:E.none()}},Cv=function(e,t,n,o){return t(n,o).breakAt.map((function(o){var i=t(n,o).positions;return e===il.Backwards?i.concat(o):[o].concat(i)})).getOr([])},Tv=function(e,t){return q(e,(function(e,n){return e.fold((function(){return E.some(n)}),(function(o){return vs(Q(o.getClientRects()),Q(n.getClientRects()),(function(e,i){var r=Math.abs(t-e.left);return Math.abs(t-i.left)<=r?n:o})).or(e)}))}),E.none())},xv=function(e,t){return Q(t.getClientRects()).bind((function(t){return Tv(e,t.left)}))},Ev=f(bv,ol.isAbove,-1),_v=f(bv,ol.isBelow,1),Iv=f(Cv,-1,Ev),Dv=f(Cv,1,_v),Ov=function(e){var t=function(t){return V(t,(function(t){return(t=bs(t)).node=e,t}))};if(fn(e))return t(e.getClientRects());if(Cn(e)){var n=e.ownerDocument.createRange();return n.setStart(e,0),n.setEnd(e,e.data.length),t(n.getClientRects())}},wv=function(e){return X(e,Ov)};(vv=pv=pv||{})[vv.Up=-1]="Up",vv[vv.Down=1]="Down";var Rv=function(e,t,n,o,i,r){var a=0,s=[],l=function(o){var r,l,c;for(c=wv([o]),-1===e&&(c=c.reverse()),r=0;r<c.length;r++)if(!n(l=c[r],u)){if(0<s.length&&t(l,Ce(s))&&a++,l.line=a,i(l))return!0;s.push(l)}},u=Ce(r.getClientRects());if(!u)return s;var c=r.getNode();return l(c),function(e,t,n,o){for(;o=cu(o,e,Fs,t);)if(n(o))return}(e,o,l,c),s},Sv=f(Rv,pv.Up,xs,Es),kv=f(Rv,pv.Down,Es,xs),Av=function(e){return function(t){return t.line>e}},Nv=function(e){return function(t){return t.line===e}},Mv=Dn,Kv=cu,Pv=function(e,t){return Math.abs(e.left-t)},Lv=function(e,t){return Math.abs(e.right-t)},Bv=function(e,t){return e>=t.left&&e<=t.right},Fv=function(e,t){return e>=t.top&&e<=t.bottom},zv=function(e,t){return ye(e,(function(e,n){var o=Math.min(Pv(e,t),Lv(e,t)),i=Math.min(Pv(n,t),Lv(n,t));return Bv(t,n)||!Bv(t,e)&&(i===o&&Mv(n.node)||i<o)?n:e}))},Vv=function(e,t,n,o,i){var r=Kv(o,e,Fs,t,!i);do{if(!r||n(r))return}while(r=Kv(r,e,Fs,t))},Hv=In,Wv=Dn,$v=function(e,t,n,o,i){return t._selectionOverrides.showCaret(e,n,o,i)},Uv=function(e,t){var n,o;return e.fire("BeforeObjectSelected",{target:t}).isDefaultPrevented()?null:((o=(n=t).ownerDocument.createRange()).selectNode(n),o)},qv=function(e,t,n){var o=yu(1,e.getBody(),t),i=al.fromRangeStart(o),r=i.getNode();if(Wv(r))return $v(1,e,r,!i.isAtEnd(),!1);var a=i.getNode(!0);if(Wv(a))return $v(1,e,a,!1,!1);var s=e.dom.getParent(i.getNode(),(function(e){return Wv(e)||Hv(e)}));return Wv(s)?$v(1,e,s,!1,n):null},jv=function(e,t,n){return t&&t.collapsed&&qv(e,t,n)||t},Gv=Dn,Xv=Is,Yv=function(e,t,n){var o,i,r,a,s=Mu(e.getBody()),l=f(xu,s.next),u=f(xu,s.prev);if(n.collapsed&&""!==kl(e)){if(!(o=e.dom.getParent(n.startContainer,"PRE")))return;(1===t?l:u)(al.fromRangeStart(n))||(a=(r=e).dom.create(kl(r)),(!dt.ie||11<=dt.ie)&&(a.innerHTML='<br data-mce-bogus="1">'),i=a,1===t?e.$(o).after(i):e.$(o).before(i),e.selection.select(i,!0),e.selection.collapse())}},Zv=function(e,t){return function(){var n,o,i,r,a,s,l,u,c,d=(o=t,r=Mu((n=e).getBody()),a=f(xu,r.next),s=f(xu,r.prev),l=o?il.Forwards:il.Backwards,u=o?a:s,c=n.selection.getRng(),(i=function(e,t,n,o){var i=e===il.Forwards,r=i?Dd:Od;if(!o.collapsed){var a=Xv(o);if(Gv(a))return $v(e,t,a,e===il.Backwards,!0)}var s=ls(o.startContainer),l=Cu(e,t.getBody(),o);if(r(l))return Uv(t,l.getNode(!i));var u=Vp(i,n(l));if(!u)return s?o:null;if(r(u))return $v(e,t,u.getNode(!i),i,!0);var c=n(u);return c&&r(c)&&Eu(u,c)?$v(e,t,c.getNode(!i),i,!0):s?jv(t,u.toRange(),!0):null}(l,n,u,c))?i:(i=Yv(n,l,c))||null);return!!d&&(e.selection.setRng(d),!0)}},Jv=function(e,t){return function(){var n,o,i,r,a,s,l=(r=(o=t)?1:-1,a=o?kv:Sv,s=(n=e).selection.getRng(),(i=function(e,t,n,o){var i,r,a,s;s=Xv(o);var l=Cu(e,t.getBody(),o),u=n(t.getBody(),Av(1),l),c=$(u,Nv(1)),d=Ce(l.getClientRects());if((Dd(l)||_d(l))&&(s=l.getNode()),(Od(l)||Id(l))&&(s=l.getNode(!0)),!d)return null;var f=d.left;if((i=zv(c,f))&&Gv(i.node))return r=Math.abs(f-i.left),a=Math.abs(f-i.right),$v(e,t,i.node,r<a,!0);if(s){var h=function(e,t,n,o){var i,r,a,s,l,u=Mu(t),c=[],d=0,f=function(e){return Ce(e.getClientRects())},h=f(s=1===e?(i=u.next,r=Es,a=xs,al.after(o)):(i=u.prev,r=xs,a=Es,al.before(o)));do{if(s.isVisible()&&!a(l=f(s),h)){if(0<c.length&&r(l,Ce(c))&&d++,(l=bs(l)).position=s,l.line=d,n(l))return c;c.push(l)}}while(s=i(s));return c}(e,t.getBody(),Av(1),s);if(i=zv($(h,Nv(1)),f))return jv(t,i.position.toRange(),!0);if(i=Ce($(h,Nv(0))))return jv(t,i.position.toRange(),!0)}}(r,n,a,s))?i:(i=Yv(n,r,s))||null);return!!l&&(e.selection.setRng(l),!0)}},Qv=function(e,t){return function(){var n,o=t?al.fromRangeEnd(e.selection.getRng()):al.fromRangeStart(e.selection.getRng()),i=(t?_v:Ev)(e.getBody(),o);return(t?ee:Q)(i.positions).filter((n=t,function(e){return(n?Od:Dd)(e)})).fold(c(!1),(function(t){return e.selection.setRng(t.toRange()),!0}))}},ey=function(e,t,n,o,i){var r,a,s=Pa(yt.fromDom(n),"td,th,caption").map((function(e){return e.dom()})),l=$(function(e,t){return X(t,(function(t){var n,o={left:(n=bs(t.getBoundingClientRect())).left- -1,top:n.top- -1,right:n.right+-2,bottom:n.bottom+-2,width:n.width+-1,height:n.height+-1};return[{x:o.left,y:e(o),cell:t},{x:o.right,y:e(o),cell:t}]}))}(e,s),(function(e){return t(e,i)}));return r=o,a=i,q(l,(function(e,t){return e.fold((function(){return E.some(t)}),(function(e){var n=Math.sqrt(Math.abs(e.x-r)+Math.abs(e.y-a)),o=Math.sqrt(Math.abs(t.x-r)+Math.abs(t.y-a));return E.some(o<n?t:e)}))}),E.none()).map((function(e){return e.cell}))},ty=f(ey,(function(e){return e.bottom}),(function(e,t){return e.y<t})),ny=f(ey,(function(e){return e.top}),(function(e,t){return e.y>t})),oy=function(e,t){e.selection.setRng(t),ym(e,t)},iy=function(e,t,n){var o,i,r,a,s=e(t,n);return(a=s).breakType===Km.Wrap&&0===a.positions.length||!_n(n.getNode())&&(r=s).breakType===Km.Br&&1===r.positions.length?(o=e,i=t,!s.breakAt.map((function(e){return o(i,e).breakAt.isSome()})).getOr(!1)):s.breakAt.isNone()},ry=f(iy,Ev),ay=f(iy,_v),sy=function(e,t,n){var o=function(e,t){var n=t.getNode(e);return fn(n)&&"TABLE"===n.nodeName?E.some(n):E.none()}(!!t,n),i=!1===t;o.fold((function(){return oy(e,n.toRange())}),(function(o){return Vu(i,e.getBody()).filter((function(e){return e.isEqual(n)})).fold((function(){return oy(e,n.toRange())}),(function(i){return r=t,s=o,l=n,void((u=kl(a=e))?a.undoManager.transact((function(){var e=yt.fromTag(u);Sn(e,Al(a)),Gt(e,yt.fromTag("br")),(r?qt:Ut)(yt.fromDom(s),e);var t=a.dom.createRng();t.setStart(e.dom(),0),t.setEnd(e.dom(),0),oy(a,t)})):oy(a,l.toRange()));var r,a,s,l,u}))}))},ly=function(e,t){return function(){return E.from(e.dom.getParent(e.selection.getNode(),"td,th")).bind((function(n){return E.from(e.dom.getParent(n,"table")).map((function(n){return function(e,t,n,o){var i,r,a,s=e.selection.getRng(),l=t?1:-1;if(tu()&&(i=t,r=n,a=al.fromRangeStart(s),Vu(!i,r).map((function(e){return e.isEqual(a)})).getOr(!1))){var u=$v(l,e,n,!t,!0);return oy(e,u),!0}return!1}(e,t,n)}))})).getOr(!1)}},uy=function(e,t){return function(){return E.from(e.dom.getParent(e.selection.getNode(),"td,th")).bind((function(n){return E.from(e.dom.getParent(n,"table")).map((function(o){return function(e,t,n,o){var i,r,a,s,l,u,c=e.selection.getRng(),d=al.fromRangeStart(c),f=e.getBody();if(!t&&ry(o,d)){var h=(s=f,function(e,t){return Q(t.getClientRects()).bind((function(t){return ty(e,t.left,t.top)})).bind((function(e){return xv(Uu(n=e).map((function(e){return Ev(n,e).positions.concat(e)})).getOr([]),t);var n}))}(l=n,u=d).orThunk((function(){return Q(u.getClientRects()).bind((function(e){return Tv(Iv(s,al.before(l)),e.left)}))})).getOr(al.before(l)));return sy(e,t,h),!0}return!(!t||!ay(o,d)||(i=f,h=function(e,t){return ee(t.getClientRects()).bind((function(t){return ny(e,t.left,t.top)})).bind((function(e){return xv($u(n=e).map((function(e){return[e].concat(_v(n,e).positions)})).getOr([]),t);var n}))}(r=n,a=d).orThunk((function(){return Q(a.getClientRects()).bind((function(e){return Tv(Dv(i,al.after(r)),e.left)}))})).getOr(al.after(r)),sy(e,t,h),0))}(e,t,o,n)}))})).getOr(!1)}},cy=function(e){return F(["figcaption"],bt(e))},dy=function(t){var n=e.document.createRange();return n.setStartBefore(t.dom()),n.setEndBefore(t.dom()),n},fy=function(e,t,n){(n?Gt:jt)(e,t)},hy=function(e,t){return function(){return!!e.selection.isCollapsed()&&function(e,t){var n,o,i=yt.fromDom(e.getBody()),r=al.fromRangeStart(e.selection.getRng()),a=kl(e),s=Al(e);return n=r,o=f(Rt,i),za(yt.fromDom(n.container()),Hn,o).filter(cy).exists((function(){if(function(e,t,n){return t?(i=e.dom(),_v(i,n).breakAt.isNone()):(o=e.dom(),Ev(o,n).breakAt.isNone());var o,i}(i,t,r)){var n=function(e,t,n,o){return""===t?(u=e,c=o,d=yt.fromTag("br"),fy(u,d,c),dy(d)):(i=e,r=o,a=n,s=yt.fromTag(t),l=yt.fromTag("br"),Sn(s,a),Gt(s,l),fy(i,s,r),dy(l));var i,r,a,s,l,u,c,d}(i,a,s,t);return e.selection.setRng(n),!0}return!1}))}(e,t)}},gy=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return function(){return e.apply(null,t)}},my=function(e,t){return j(function(e,t){return X(V(e,(function(e){return Te({shiftKey:!1,altKey:!1,ctrlKey:!1,metaKey:!1,keyCode:0,action:l},e)})),(function(e){return(o=t).keyCode===(n=e).keyCode&&o.shiftKey===n.shiftKey&&o.altKey===n.altKey&&o.ctrlKey===n.ctrlKey&&o.metaKey===n.metaKey?[e]:[];var n,o}))}(e,t),(function(e){return e.action()}))},py=function(e,t){return St(e,t)?za(t,(function(e){return Un(e)||jn(e)}),(n=e,function(e){return Rt(n,yt.fromDom(e.dom().parentNode))})):E.none();var n},vy=function(e){var t,n,o;e.dom.isEmpty(e.getBody())&&(e.setContent(""),o=(n=(t=e).getBody()).firstChild&&t.dom.isBlock(n.firstChild)?n.firstChild:n,t.selection.setCursorLocation(o,0))},yy=function(e,t){return{from:e,to:t}},by=function(e,t){var n=yt.fromDom(e),o=yt.fromDom(t.container());return py(n,o).map((function(e){return{block:e,position:t}}))},Cy=function(e){var t,n=(t=Bt(e),G(t,Hn).fold((function(){return t}),(function(e){return t.slice(0,e)})));return H(n,Zt),n},Ty=function(e,t){var n=Pd(t,e);return j(n.reverse(),(function(e){return Ad(e)})).each(Zt)},xy=function(e,t,n,o){if(Ad(n))return Nd(n),$u(n.dom());0===$(Pt(o),(function(e){return!Ad(e)})).length&&Ad(t)&&Ut(o,yt.fromTag("br"));var i=Wu(n.dom(),al.before(o.dom()));return H(Cy(t),(function(e){Ut(o,e)})),Ty(e,t),i},Ey=function(e,t,n){if(Ad(n))return Zt(n),Ad(t)&&Nd(t),$u(t.dom());var o=Uu(n.dom());return H(Cy(t),(function(e){Gt(n,e)})),Ty(e,t),o},_y=function(e,t){Vu(e,t.dom()).map((function(e){return e.getNode()})).map(yt.fromDom).filter($n).each(Zt)},Iy=function(e,t,n){return _y(!0,t),_y(!1,n),function(e,t){return St(t,e)?(n=Pd(e,t),E.from(n[n.length-1])):E.none();var n}(t,n).fold(f(Ey,e,t,n),f(xy,e,t,n))},Dy=function(e,t,n,o){return t?Iy(e,o,n):Iy(e,n,o)},Oy=function(e,t){var n,o,i,r=yt.fromDom(e.getBody()),a=(n=r.dom(),o=t,((i=e.selection.getRng()).collapsed?function(e,t,n){var o=by(e,al.fromRangeStart(n)),i=o.bind((function(n){return Bu(t,e,n.position).bind((function(n){return by(e,n).map((function(n){return o=e,i=t,_n((r=n).position.getNode())&&!1===Ad(r.block)?Vu(!1,r.block.dom()).bind((function(e){return e.isEqual(r.position)?Bu(i,o,e).bind((function(e){return by(o,e)})):E.some(r)})).getOr(r):r;var o,i,r}))}))}));return vs(o,i,yy).filter((function(e){return!1===Rt((o=e).from.block,o.to.block)&&Nt((n=e).from.block).bind((function(e){return Nt(n.to.block).filter((function(t){return Rt(e,t)}))})).isSome()&&!1===Dn((t=e).from.block.dom())&&!1===Dn(t.to.block.dom());var t,n,o}))}(n,o,i):E.none()).bind((function(e){return Dy(r,t,e.from.block,e.to.block)})));return a.each((function(t){e.selection.setRng(t.toRange())})),a.isSome()},wy=function(e,t){var n=yt.fromDom(t),o=f(Rt,e);return Fa(n,Yn,o).isSome()},Ry=function(e,t){return!e.selection.isCollapsed()&&function(e){var t,n,o,i,r=yt.fromDom(e.getBody());return function(e,t){var n,o,i=Wu(e.dom(),al.fromRangeStart(t)).isNone(),r=Hu(e.dom(),al.fromRangeEnd(t)).isNone();return!(wy(n=e,(o=t).startContainer)||wy(n,o.endContainer))&&i&&r}(r,e.selection.getRng())?((i=e).setContent(""),i.selection.setCursorLocation(),!0):(t=r,o=(n=e.selection).getRng(),vs(py(t,yt.fromDom(o.startContainer)),py(t,yt.fromDom(o.endContainer)),(function(e,i){return!1===Rt(e,i)&&(o.deleteContents(),Dy(t,!0,e,i).each((function(e){n.setRng(e.toRange())})),!0)})).getOr(!1))}(e)},Sy=function(e){return Tu(e).exists($n)},ky=function(e,t,n){var o=$(Pd(yt.fromDom(n.container()),t),Hn),i=Q(o).getOr(t);return Bu(e,i.dom(),n).filter(Sy)},Ay=function(e,t){return Tu(t).exists($n)||ky(!0,e,t).isSome()},Ny=function(e,t){return E.from(t.getNode(!0)).map(yt.fromDom).exists($n)||ky(!1,e,t).isSome()},My=f(ky,!1),Ky=f(ky,!0),Py=$r([{remove:["element"]},{moveToElement:["element"]},{moveToPosition:["position"]}]),Ly=function(e,t,n){return Bu(t,e,n).bind((function(o){return u=o.getNode(),Yn(yt.fromDom(u))||jn(yt.fromDom(u))?E.none():(i=e,s=o,l=function(e){return Wn(yt.fromDom(e))&&!fu(a,s,i)},bu(!(r=t),a=n).fold((function(){return bu(r,s).fold(c(!1),l)}),l)?E.none():t&&Dn(o.getNode())||!1===t&&Dn(o.getNode(!0))?function(e,t,n,o){var i=o.getNode(!1===t);return py(yt.fromDom(e),yt.fromDom(n.getNode())).map((function(e){return Ad(e)?Py.remove(e.dom()):Py.moveToElement(i)})).orThunk((function(){return E.some(Py.moveToElement(i))}))}(e,t,n,o):t&&Od(n)||!1===t&&Dd(n)?E.some(Py.moveToPosition(o)):E.none());var i,r,a,s,l,u}))},By=function(e,t){return E.from(Vy(e.getBody(),t))},Fy=function(e,t){var n=e.selection.getNode();return By(e,n).filter(Dn).fold((function(){var n,o,i,r,a,s;return(n=e.getBody(),o=t,i=e.selection.getRng(),r=yu(o?1:-1,n,i),a=al.fromRangeStart(r),s=yt.fromDom(n),(!1===o&&Od(a)?E.some(Py.remove(a.getNode(!0))):o&&Dd(a)?E.some(Py.remove(a.getNode())):!1===o&&Dd(a)&&Ny(s,a)?My(s,a).map((function(e){return Py.remove(e.getNode())})):o&&Od(a)&&Ay(s,a)?Ky(s,a).map((function(e){return Py.remove(e.getNode())})):function(e,t,n){return a=n.getNode(!1===(r=t)),s=r?"after":"before",fn(a)&&a.getAttribute("data-mce-caret")===s?(o=t,i=n.getNode(!1===t),(o&&Dn(i.nextSibling)?E.some(Py.moveToElement(i.nextSibling)):!1===o&&Dn(i.previousSibling)?E.some(Py.moveToElement(i.previousSibling)):E.none()).fold((function(){return Ly(e,t,n)}),E.some)):Ly(e,t,n).bind((function(t){return o=e,i=n,t.fold((function(e){return E.some(Py.remove(e))}),(function(e){return E.some(Py.moveToElement(e))}),(function(e){return fu(i,e,o)?E.none():E.some(Py.moveToPosition(e))}));var o,i}));var o,i,r,a,s}(n,o,a)).map((function(n){return n.fold((function(e){return a._selectionOverrides.hideFakeCaret(),Gd(a,s,yt.fromDom(e)),!0}),(r=s=t,function(e){var t=r?al.before(e):al.after(e);return i.selection.setRng(t.toRange()),!0}),(o=i=a=e,function(e){return o.selection.setRng(e.toRange()),!0}));var o,i,r,a,s}))).getOr(!1)}),(function(){return!0}))},zy=function(e,t){var n=e.selection.getNode();return!!Dn(n)&&By(e,n.parentNode).filter(Dn).fold((function(){var n;return n=yt.fromDom(e.getBody()),H(Pa(n,".mce-offscreen-selection"),Zt),Gd(e,t,yt.fromDom(e.selection.getNode())),vy(e),!0}),(function(){return!0}))},Vy=function(e,t){for(;t&&t!==e;){if(In(t)||Dn(t))return t;t=t.parentNode}return null},Hy=function(e){var t,n=Vy(e.getBody(),e.selection.getNode());return In(n)&&e.dom.isBlock(n)&&e.dom.isEmpty(n)&&(t=e.dom.create("br",{"data-mce-bogus":"1"}),e.dom.setHTML(n,""),n.appendChild(t),e.selection.setRng(al.before(t).toRange())),!0},Wy=function(e,t){return(e.selection.isCollapsed()?Fy:zy)(e,t)},$y=function(e,t,n,o,i,r){var a,s,l=$v(o,e,r.getNode(!i),i,!0);if(t.collapsed){var u=t.cloneRange();i?u.setEnd(l.startContainer,l.startOffset):u.setStart(l.endContainer,l.endOffset),u.deleteContents()}else t.deleteContents();return e.selection.setRng(l),a=e.dom,Cn(s=n)&&0===s.data.length&&a.remove(s),!0},Uy=function(e,t){return function(e,t){var n=e.selection.getRng();if(!Cn(n.commonAncestorContainer))return!1;var o=t?il.Forwards:il.Backwards,i=Mu(e.getBody()),r=f(xu,i.next),a=f(xu,i.prev),s=t?r:a,l=t?Dd:Od,u=Cu(o,e.getBody(),n),c=Vp(t,s(u));if(!c||!Eu(u,c))return!1;if(l(c))return $y(e,n,u.getNode(),o,t,c);var d=s(c);return!!(d&&l(d)&&Eu(c,d))&&$y(e,n,u.getNode(),o,t,d)}(e,t)},qy=function(e,t){return function(n){return Lp(t,n).map((function(t){return uv(e,t),!0})).getOr(!1)}},jy=function(t,n,o,i){var r=t.getBody(),a=f(Fp,t);t.undoManager.ignore((function(){var s,l,u;t.selection.setRng((s=o,l=i,(u=e.document.createRange()).setStart(s.container(),s.offset()),u.setEnd(l.container(),l.offset()),u)),t.execCommand("Delete"),ev(a,r,al.fromRangeStart(t.selection.getRng())).map(iv).map(qy(t,n))})),t.nodeChanged()},Gy=function(e,t,n){if(e.selection.isCollapsed()&&Vl(e)){var o=al.fromRangeStart(e.selection.getRng());return function(e,t,n,o){var i,r,a=(i=e.getBody(),r=o.container(),du(r,i)||i),s=f(Fp,e),l=ev(s,a,o);return l.bind((function(e){return n?e.fold(c(E.some(iv(e))),E.none,c(E.some(ov(e))),E.none):e.fold(E.none,c(E.some(ov(e))),E.none,c(E.some(iv(e))))})).map(qy(e,t)).getOrThunk((function(){var i=Fu(n,a,o),r=i.bind((function(e){return ev(s,a,e)}));return l.isSome()&&r.isSome()?zp(s,a,o).map((function(t){return!!vs($u(o=t),Uu(o),(function(e,t){var n=Vp(!0,e),i=Vp(!1,t);return Hu(o,n).map((function(e){return e.isEqual(i)})).getOr(!0)})).getOr(!0)&&(Gd(e,n,yt.fromDom(t)),!0);var o})).getOr(!1):r.bind((function(r){return i.map((function(i){return n?jy(e,t,o,i):jy(e,t,i,o),!0}))})).getOr(!1)}))}(e,t,n,o)}return!1},Xy=function(e){return 1===Bt(e).length},Yy=function(e,t){return!!e.selection.isCollapsed()&&function(e,t){var n,o=yt.fromDom(e.getBody()),i=yt.fromDom(e.selection.getStart()),r=$((n=Pd(i,o),G(n,Hn).fold(c(n),(function(e){return n.slice(0,e)}))),Xy);return ee(r).map((function(n){var o,i,a,s,l=al.fromRangeStart(e.selection.getRng());return i=t,a=l,s=n.dom(),!(!vs($u(s),Uu(s),(function(e,t){var n=Vp(!0,e),o=Vp(!1,t),r=Vp(!1,a);return i?Hu(s,r).map((function(e){return e.isEqual(o)&&a.isEqual(n)})).getOr(!1):Wu(s,r).map((function(e){return e.isEqual(n)&&a.isEqual(o)})).getOr(!1)})).getOr(!0)||ju((o=n).dom())&&sh(o.dom())||(function(e,t,n,o){var i,r,a,s,l=f(gh,t),u=V($(o,l),(function(e){return e.dom()}));if(0===u.length)Gd(t,e,n);else{var c=(i=n.dom(),r=u,a=uh(!1),s=hh(r,a.dom()),Ut(yt.fromDom(i),a),Zt(yt.fromDom(i)),al(s,0));t.selection.setRng(c.toRange())}}(t,e,n,r),0))})).getOr(!1)}(e,t)},Zy=function(e,t){return!!e.selection.isCollapsed()&&(o=t,i=al.fromRangeStart((n=e).selection.getRng()),Bu(o,n.getBody(),i).filter((function(e){return(o?xd:Ed)(e)})).bind((function(e){return E.from(hu(o?0:-1,e))})).map((function(e){return n.selection.select(e),!0})).getOr(!1));var n,o,i},Jy=function(e){var t=parseInt(e,10);return isNaN(t)?0:t},Qy=function(e,t){return(e||"table"===bt(t)?"margin":"padding")+("rtl"===Nn(t,"direction")?"-right":"-left")},eb=function(e){var t,n=nb(e);return!e.mode.isReadOnly()&&(1<n.length||(t=e,Y(n,(function(e){var n=Qy(Ll(t),e),o=Kn(e,n).map(Jy).getOr(0);return"false"!==t.dom.getContentEditable(e.dom())&&0<o}))))},tb=function(e){return qn(e)||jn(e)},nb=function(e){return $(V(e.selection.getSelectedBlocks(),yt.fromDom),(function(e){return!tb(e)&&!Nt(e).map(tb).getOr(!1)&&za(e,(function(e){return In(e.dom())||Dn(e.dom())})).exists((function(e){return In(e.dom())}))}))},ob=function(e,t){var n=e.dom,o=e.selection,i=e.formatter,r=e.getParam("indentation","40px","string"),a=/[a-z%]+$/i.exec(r)[0],s=parseInt(r,10),l=Ll(e),u=kl(e);e.queryCommandState("InsertUnorderedList")||e.queryCommandState("InsertOrderedList")||""!==u||n.getParent(o.getNode(),n.isBlock)||i.apply("div"),H(nb(e),(function(e){!function(e,t,n,o,i,r){var a=Qy(n,yt.fromDom(r));if("outdent"===t){var s=Math.max(0,Jy(r.style[a])-o);e.setStyle(r,a,s?s+i:"")}else s=Jy(r.style[a])+o+i,e.setStyle(r,a,s)}(n,t,l,s,a,e.dom())}))},ib=function(e,t,n){return zu(e,t,n,yd)},rb=function(e,t){return j(Pd(yt.fromDom(t.container()),e),Hn)},ab=function(e,t,n){return ib(e,t.dom(),n).forall((function(e){return rb(t,n).fold((function(){return!1===fu(e,n,t.dom())}),(function(o){return!1===fu(e,n,t.dom())&&St(o,yt.fromDom(e.container()))}))}))},sb=function(e,t,n){return rb(t,n).fold((function(){return ib(e,t.dom(),n).forall((function(e){return!1===fu(e,n,t.dom())}))}),(function(t){return ib(e,t.dom(),n).isNone()}))},lb=f(sb,!1),ub=f(sb,!0),cb=f(ab,!1),db=f(ab,!0),fb=function(e,t,n){if(e.selection.isCollapsed()&&eb(e)){var o=e.dom,i=e.selection.getRng(),r=al.fromRangeStart(i),a=o.getParent(i.startContainer,o.isBlock);if(null!==a&&lb(yt.fromDom(a),r))return ob(e,"outdent"),!0}return!1},hb=function(e,t){var n,o=t,i=e.dom,r=e.schema.getMoveCaretBeforeOnEnterElements();if(t){if(/^(LI|DT|DD)$/.test(t.nodeName)){var a=function(e){for(;e;){if(1===e.nodeType||3===e.nodeType&&e.data&&/[\r\n\s]/.test(e.data))return e;e=e.nextSibling}}(t.firstChild);a&&/^(UL|OL|DL)$/.test(a.nodeName)&&t.insertBefore(i.doc.createTextNode(Oo),t.firstChild)}var s=i.createRng();if(t.normalize(),t.hasChildNodes()){for(var l=new Ir(t,t);n=l.current();){if(Cn(n)){s.setStart(n,0),s.setEnd(n,0);break}if(r[n.nodeName.toLowerCase()]){s.setStartBefore(n),s.setEndBefore(n);break}o=n,n=l.next()}n||(s.setStart(o,0),s.setEnd(o,0))}else _n(t)?t.nextSibling&&i.isBlock(t.nextSibling)?(s.setStartBefore(t),s.setEndBefore(t)):(s.setStartAfter(t),s.setEndAfter(t)):(s.setStart(t,0),s.setEnd(t,0));e.selection.setRng(s),ym(e,s)}},gb=function(e){return E.from(e.dom.getParent(e.selection.getStart(!0),e.dom.isBlock))},mb=function(e,t){return e&&e.parentNode&&e.parentNode.nodeName===t},pb=function(e){return e&&/^(OL|UL|LI)$/.test(e.nodeName)},vb=function(e){var t=e.parentNode;return/^(LI|DT|DD)$/.test(t.nodeName)?t:e},yb=function(e,t,n){for(var o=e[n?"firstChild":"lastChild"];o&&!fn(o);)o=o[n?"nextSibling":"previousSibling"];return o===t},bb=function(e){e.innerHTML='<br data-mce-bogus="1">'},Cb=function(e,t){return e.nodeName===t||e.previousSibling&&e.previousSibling.nodeName===t},Tb=function(e,t){return t&&e.isBlock(t)&&!/^(TD|TH|CAPTION|FORM)$/.test(t.nodeName)&&!/^(fixed|absolute)/i.test(t.style.position)&&"true"!==e.getContentEditable(t)},xb=function(e,t,n){return!1===Cn(t)?n:e?1===n&&t.data.charAt(n-1)===os?0:n:n===t.data.length-1&&t.data.charAt(n)===os?t.data.length:n},Eb=function(e,t){var n,o,i=e.getRoot();for(n=t;n!==i&&"false"!==e.getContentEditable(n);)"true"===e.getContentEditable(n)&&(o=n),n=n.parentNode;return n!==i?o:i},_b=function(e,t){var n=kl(e);n&&n.toLowerCase()===t.tagName.toLowerCase()&&function(e,t,n){E.from(n.style).map(e.dom.parseStyle).each((function(n){var o=Pn(yt.fromDom(t)),i=Te(Te({},o),n);e.dom.setStyles(t,i)}));var o=E.from(n.class).map((function(e){return e.split(/\s+/)})),i=E.from(t.className).map((function(e){return $(e.split(/\s+/),(function(e){return""!==e}))}));vs(o,i,(function(n,o){var i=$(o,(function(e){return!F(n,e)})),r=xe(n,i);e.dom.setAttrib(t,"class",r.join(" "))}));var r=["style","class"],a=ce(n,(function(e,t){return!F(r,t)}));e.dom.setAttribs(t,a)}(e,t,Al(e))},Ib=function(e,t,n){var o=e.create("span",{},"&nbsp;");n.parentNode.insertBefore(o,n),t.scrollIntoView(o),e.remove(o)},Db=function(e,t,n,o){var i=e.createRng();o?(i.setStartBefore(n),i.setEndBefore(n)):(i.setStartAfter(n),i.setEndAfter(n)),t.setRng(i)},Ob=function(e,t){var n=yt.fromTag("br");Ut(yt.fromDom(t),n),e.undoManager.add()},wb=function(e,t){Rb(e.getBody(),t)||qt(yt.fromDom(t),yt.fromTag("br"));var n=yt.fromTag("br");qt(yt.fromDom(t),n),Ib(e.dom,e.selection,n.dom()),Db(e.dom,e.selection,n.dom(),!1),e.undoManager.add()},Rb=function(e,t){return n=al.after(t),!!_n(n.getNode())||Hu(e,al.after(t)).map((function(e){return _n(e.getNode())})).getOr(!1);var n},Sb=function(e){return e&&"A"===e.nodeName&&"href"in e},kb=function(e){return e.fold(c(!1),Sb,Sb,c(!1))},Ab=function(e,t){t.fold(l,f(Ob,e),f(wb,e),l)},Nb=function(e,t){var n,o,i,r=(o=f(Fp,n=e),i=al.fromRangeStart(n.selection.getRng()),ev(o,n.getBody(),i).filter(kb));r.isSome()?r.each(f(Ab,e)):function(e,t){var n,o,i=e.selection,r=e.dom,a=i.getRng();Am(r,a).each((function(e){a.setStart(e.startContainer,e.startOffset),a.setEnd(e.endContainer,e.endOffset)}));var s=a.startOffset,l=a.startContainer;if(1===l.nodeType&&l.hasChildNodes()){var u=s>l.childNodes.length-1;l=l.childNodes[Math.min(s,l.childNodes.length-1)]||l,s=u&&3===l.nodeType?l.nodeValue.length:0}var c=r.getParent(l,r.isBlock),d=c?r.getParent(c.parentNode,r.isBlock):null;"LI"!==(d?d.nodeName.toUpperCase():"")||!(!t||!t.ctrlKey)||(c=d),l&&3===l.nodeType&&s>=l.nodeValue.length&&!function(e,t,n){for(var o,i=new Ir(t,n),r=e.getNonEmptyElements();o=i.next();)if(r[o.nodeName.toLowerCase()]||0<o.length)return!0}(e.schema,l,c)&&(n=r.create("br"),a.insertNode(n),a.setStartAfter(n),a.setEndAfter(n),o=!0),n=r.create("br"),ll(r,a,n),Ib(r,i,n),Db(r,i,n,o),e.undoManager.add()}(e,t)},Mb=function(e,t){return gb(e).filter((function(e){return 0<t.length&&Ot(yt.fromDom(e),t)})).isSome()},Kb=$r([{br:[]},{block:[]},{none:[]}]),Pb=function(e,t){return Mb(n=e,n.getParam("no_newline_selector",""));var n},Lb=function(e){return function(t,n){return""===kl(t)===e}},Bb=function(e){return function(t,n){return gb(t).filter((function(e){return jn(yt.fromDom(e))})).isSome()===e}},Fb=function(e,t){return function(n,o){return gb(n).fold(c(""),(function(e){return e.nodeName.toUpperCase()}))===e.toUpperCase()===t}},zb=function(e){return Fb("pre",e)},Vb=function(e){return function(t,n){return t.getParam("br_in_pre",!0)===e}},Hb=function(e,t){return Mb(n=e,n.getParam("br_newline_selector",".mce-toc h2,figcaption,caption"));var n},Wb=function(e,t){return t},$b=function(e){var t=kl(e),n=function(e,t){var n,o,i=e.getRoot();for(n=t;n!==i&&"false"!==e.getContentEditable(n);)"true"===e.getContentEditable(n)&&(o=n),n=n.parentNode;return n!==i?o:i}(e.dom,e.selection.getStart());return n&&e.schema.isValidChild(n.nodeName,t||"P")},Ub=function(e,t){return function(n,o){return q(e,(function(e,t){return e&&t(n,o)}),!0)?E.some(t):E.none()}},qb=function(e,t){(function(e,t){return $p([Ub([Pb],Kb.none()),Ub([Fb("summary",!0)],Kb.br()),Ub([zb(!0),Vb(!1),Wb],Kb.br()),Ub([zb(!0),Vb(!1)],Kb.block()),Ub([zb(!0),Vb(!0),Wb],Kb.block()),Ub([zb(!0),Vb(!0)],Kb.br()),Ub([Bb(!0),Wb],Kb.br()),Ub([Bb(!0)],Kb.block()),Ub([Lb(!0),Wb,$b],Kb.block()),Ub([Lb(!0)],Kb.br()),Ub([Hb],Kb.br()),Ub([Lb(!1),Wb],Kb.br()),Ub([$b],Kb.block())],[e,!(!t||!t.shiftKey)]).getOr(Kb.none())})(e,t).fold((function(){Nb(e,t)}),(function(){!function(e,t){var n,o,i,r,a,s,l,u,c,d,f=e.dom,h=e.schema,g=h.getNonEmptyElements(),m=e.selection.getRng(),p=function(t){var n,i,a,s=o,l=h.getTextInlineElements();if(a=n=t||"TABLE"===u||"HR"===u?f.create(t||c):r.cloneNode(!1),!1===e.getParam("keep_styles",!0))f.setAttrib(n,"style",null),f.setAttrib(n,"class",null);else do{if(l[s.nodeName]){if(ju(s)||oc(s))continue;i=s.cloneNode(!1),f.setAttrib(i,"id",""),n.hasChildNodes()?i.appendChild(n.firstChild):a=i,n.appendChild(i)}}while((s=s.parentNode)&&s!==T);return _b(e,n),bb(a),n},v=function(e){var t,n,a=xb(e,o,i);if(Cn(o)&&(e?0<a:a<o.nodeValue.length))return!1;if(o.parentNode===r&&d&&!e)return!0;if(e&&fn(o)&&o===r.firstChild)return!0;if(Cb(o,"TABLE")||Cb(o,"HR"))return d&&!e||!d&&e;var s=new Ir(o,r);for(Cn(o)&&(e&&0===a?s.prev():e||a!==o.nodeValue.length||s.next());t=s.current();){if(fn(t)){if(!t.getAttribute("data-mce-bogus")&&(n=t.nodeName.toLowerCase(),g[n]&&"br"!==n))return!1}else if(Cn(t)&&!Qn(t.nodeValue))return!1;e?s.prev():s.next()}return!0},y=function(){a=/^(H[1-6]|PRE|FIGURE)$/.test(u)&&"HGROUP"!==_?p(c):p(),e.getParam("end_container_on_empty_block",!1)&&Tb(f,l)&&f.isEmpty(r)?a=f.split(l,r):f.insertAfter(a,r),hb(e,a)};Am(f,m).each((function(e){m.setStart(e.startContainer,e.startOffset),m.setEnd(e.endContainer,e.endOffset)})),o=m.startContainer,i=m.startOffset,c=kl(e);var b=!(!t||!t.shiftKey),C=!(!t||!t.ctrlKey);fn(o)&&o.hasChildNodes()&&(d=i>o.childNodes.length-1,o=o.childNodes[Math.min(i,o.childNodes.length-1)]||o,i=d&&Cn(o)?o.nodeValue.length:0);var T=Eb(f,o);if(T){(c&&!b||!c&&b)&&(o=function(e,t,n,o,i){var r,a,s,l,u,c,d,f=t||"P",h=e.dom,g=Eb(h,o);if(!(a=h.getParent(o,h.isBlock))||!Tb(h,a)){if(c=(a=a||g)===e.getBody()||(d=a)&&/^(TD|TH|CAPTION)$/.test(d.nodeName)?a.nodeName.toLowerCase():a.parentNode.nodeName.toLowerCase(),!a.hasChildNodes())return r=h.create(f),_b(e,r),a.appendChild(r),n.setStart(r,0),n.setEnd(r,0),r;for(l=o;l.parentNode!==a;)l=l.parentNode;for(;l&&!h.isBlock(l);)l=(s=l).previousSibling;if(s&&e.schema.isValidChild(c,f.toLowerCase())){for(r=h.create(f),_b(e,r),s.parentNode.insertBefore(r,s),l=s;l&&!h.isBlock(l);)u=l.nextSibling,r.appendChild(l),l=u;n.setStart(o,i),n.setEnd(o,i)}}return o}(e,c,m,o,i)),r=f.getParent(o,f.isBlock),l=r?f.getParent(r.parentNode,f.isBlock):null,u=r?r.nodeName.toUpperCase():"";var x,E,_=l?l.nodeName.toUpperCase():"";"LI"!==_||C||(l=(r=l).parentNode,u=_),/^(LI|DT|DD)$/.test(u)&&f.isEmpty(r)?function(e,t,n,o,i){var r=e.dom,a=e.selection.getRng();if(n!==e.getBody()){var s;pb(s=n)&&pb(s.parentNode)&&(i="LI");var l,u=i?t(i):r.create("BR");if(yb(n,o,!0)&&yb(n,o,!1))mb(n,"LI")?r.insertAfter(u,vb(n)):r.replace(u,n);else if(yb(n,o,!0))mb(n,"LI")?(r.insertAfter(u,vb(n)),u.appendChild(r.doc.createTextNode(" ")),u.appendChild(n)):n.parentNode.insertBefore(u,n);else if(yb(n,o,!1))r.insertAfter(u,vb(n));else{n=vb(n);var c=a.cloneRange();c.setStartAfter(o),c.setEndAfter(n);var d=c.extractContents();"LI"===i&&(l=d).firstChild&&"LI"===l.firstChild.nodeName?(u=d.firstChild,r.insertAfter(d,n)):(r.insertAfter(d,n),r.insertAfter(u,n))}r.remove(o),hb(e,u)}}(e,p,l,r,c):c&&r===e.getBody()||(c=c||"P",ls(r)?(a=ps(r),f.isEmpty(r)&&bb(r),_b(e,a),hb(e,a)):v()?y():v(!0)?(a=r.parentNode.insertBefore(p(),r),hb(e,Cb(r,"HR")?a:r)):((E=(x=m).cloneRange()).setStart(x.startContainer,xb(!0,x.startContainer,x.startOffset)),E.setEnd(x.endContainer,xb(!1,x.endContainer,x.endOffset)),(n=E.cloneRange()).setEndAfter(r),s=n.extractContents(),H(Ka(yt.fromDom(s),Et),(function(e){var t=e.dom();t.nodeValue=rs(t.nodeValue)})),function(e){for(;Cn(e)&&(e.nodeValue=e.nodeValue.replace(/^[\r\n]+/,"")),e=e.firstChild;);}(s),a=s.firstChild,f.insertAfter(s,r),function(e,t,n){var o,i=n,r=[];if(i){for(;i=i.firstChild;){if(e.isBlock(i))return;fn(i)&&!t[i.nodeName.toLowerCase()]&&r.push(i)}for(o=r.length;o--;)(!(i=r[o]).hasChildNodes()||i.firstChild===i.lastChild&&""===i.firstChild.nodeValue||(a=i)&&"A"===a.nodeName&&e.isEmpty(a))&&e.remove(i);var a}}(f,g,a),function(e,t){t.normalize();var n=t.lastChild;n&&!/^(left|right)$/gi.test(e.getStyle(n,"float",!0))||e.add(t,"br")}(f,r),f.isEmpty(r)&&bb(r),a.normalize(),f.isEmpty(a)?(f.remove(a),y()):(_b(e,a),hb(e,a))),f.setAttrib(a,"id",""),e.fire("NewBlock",{newBlock:a}))}}(e,t)}),l)},jb=function(e,t){var n=t.container(),o=t.offset();return Cn(n)?(n.insertData(o,e),E.some(ol(n,o+e.length))):Tu(t).map((function(n){var o=yt.fromText(e);return(t.isAtEnd()?qt:Ut)(n,o),ol(o.dom(),e.length)}))},Gb=f(jb,Oo),Xb=f(jb," "),Yb=function(e){return ol.isTextPosition(e)&&!e.isAtStart()&&!e.isAtEnd()},Zb=function(e,t){var n=$(Pd(yt.fromDom(t.container()),e),Hn);return Q(n).getOr(e)},Jb=function(e,t){return Yb(t)?vd(t):vd(t)||Wu(Zb(e,t).dom(),t).exists(vd)},Qb=function(e,t){return Yb(t)?pd(t):pd(t)||Hu(Zb(e,t).dom(),t).exists(pd)},eC=function(e){return Tu(e).bind((function(e){return za(e,xt)})).exists((function(e){return t=Nn(e,"white-space"),F(["pre","pre-wrap"],t);var t}))},tC=function(e,t){return n=e,!eC(o=t)&&(lb(n,o)||cb(n,o)||Ny(n,o)||Jb(n,o))||function(e,t){var n,o,i,r=(o=(n=t).container(),i=n.offset(),Cn(o)&&i<o.data.length?ol(o,i+1):n);return!eC(r)&&(ub(e,r)||db(e,r)||Ay(e,r)||Qb(e,r))}(e,t);var n,o},nC=function(e,t){return ic(e.charAt(t))},oC=function(e){var t=e.container();return Cn(t)&&We(t.data,Oo)},iC=function(e){var t=yt.fromDom(e.getBody());e.selection.isCollapsed()&&function(e,t){return E.some(t).filter(oC).bind((function(t){var n,o,i,r,a,s,l,u,c=t.container();return a=e,l=(s=c).data,u=ol(s,0),nC(l,0)&&!tC(a,u)&&(s.data=" "+l.slice(1),1)||function(e){var t,n=e.data,o=(t=n.split(""),V(t,(function(e,n){return ic(e)&&0<n&&n<t.length-1&&ac(t[n-1])&&ac(t[n+1])?" ":e})).join(""));return o!==n&&(e.data=o,!0)}(c)||(n=e,i=(o=c).data,r=ol(o,i.length-1),nC(i,i.length-1)&&!tC(n,r)&&(o.data=i.slice(0,-1)+" ",1))?E.some(t):E.none()}))}(t,ol.fromRangeStart(e.selection.getRng())).each((function(t){e.selection.setRng(t.toRange())}))},rC=function(e){var t,n,o=al.fromRangeStart(e.selection.getRng()),i=yt.fromDom(e.getBody());if(e.selection.isCollapsed()){var r=f(Fp,e),a=al.fromRangeStart(e.selection.getRng());return ev(r,e.getBody(),a).bind((n=i,function(e){return e.fold((function(e){return Wu(n.dom(),al.before(e))}),(function(e){return $u(e)}),(function(e){return Uu(e)}),(function(e){return Hu(n.dom(),al.after(e))}))})).bind(function(e,t){return function(n){return o=e,(!eC(i=n)&&(function(e,t){return o=t,Wu(e.dom(),o).isNone()||(n=t,Hu(e.dom(),n).isNone())||lb(e,t)||ub(e,t)||Ny(e,t)||Ay(e,t);var n,o}(o,i)||Jb(o,i)||Qb(o,i))?Gb:Xb)(t);var o,i}}(i,o)).exists((t=e,function(e){return t.selection.setRng(e.toRange()),t.nodeChanged(),!0}))}return!1},aC=function(e,t){var n;t.hasAttribute("data-mce-caret")&&(ps(t),(n=e).selection.setRng(n.selection.getRng()),e.selection.scrollIntoView(t))},sC=function(e,t){var n=Ha(yt.fromDom(e.getBody()),"*[data-mce-caret]").fold(c(null),(function(e){return e.dom()}));if(n)return"compositionstart"===t.type?(t.preventDefault(),t.stopPropagation(),void aC(e,n)):void(ds(n)&&(aC(e,n),e.undoManager.add()))},lC=nt().browser,uC=(cC.prototype.nodeChanged=function(e){var t,n,o,i=this.editor.selection;this.editor.initialized&&i&&!this.editor.getParam("disable_nodechange")&&!this.editor.mode.isReadOnly()&&(o=this.editor.getBody(),(t=i.getStart(!0)||o).ownerDocument===this.editor.getDoc()&&this.editor.dom.isChildOf(t,o)||(t=o),n=[],this.editor.dom.getParent(t,(function(e){if(e===o)return!0;n.push(e)})),(e=e||{}).element=t,e.parents=n,this.editor.fire("NodeChange",e))},cC.prototype.isSameElementPath=function(e){var t,n=this.editor.$(e).parentsUntil(this.editor.getBody()).add(e);if(n.length===this.lastPath.length){for(t=n.length;0<=t&&n[t]===this.lastPath[t];t--);if(-1===t)return this.lastPath=n,!0}return this.lastPath=n,!1},cC);function cC(e){var t;this.lastPath=[],this.editor=e;var n=this;"onselectionchange"in e.getDoc()||e.on("NodeChange click mouseup keyup focus",(function(n){var o=e.selection.getRng(),i={startContainer:o.startContainer,startOffset:o.startOffset,endContainer:o.endContainer,endOffset:o.endOffset};"nodechange"!==n.type&&Im(i,t)||e.fire("SelectionChange"),t=i})),e.on("contextmenu",(function(){e.fire("SelectionChange")})),e.on("SelectionChange",(function(){var t=e.selection.getStart(!0);!t||!dt.range&&e.selection.isCollapsed()||Hc(e)&&!n.isSameElementPath(t)&&e.dom.isChildOf(t,e.getBody())&&e.nodeChanged({selectionChange:!0})})),e.on("mouseup",(function(t){!t.isDefaultPrevented()&&Hc(e)&&("IMG"===e.selection.getNode().nodeName?oa.setEditorTimeout(e,(function(){e.nodeChanged()})):e.nodeChanged())}))}var dC=function(e){return fn(e)&&Un(yt.fromDom(e))},fC=function(e){var t=e.getBoundingClientRect(),n=e.ownerDocument,o=n.documentElement,i=n.defaultView;return{top:t.top+i.pageYOffset-o.clientTop,left:t.left+i.pageXOffset-o.clientLeft}},hC=function(e,t){return n=(s=e).inline?fC(s.getBody()):{left:0,top:0},a=(r=e).getBody(),o=r.inline?{left:a.scrollLeft,top:a.scrollTop}:{left:0,top:0},{pageX:(i=function(e,t){if(t.target.ownerDocument===e.getDoc())return{left:t.pageX,top:t.pageY};var n,o,i,r=fC(e.getContentAreaContainer()),a=(o=(n=e).getBody(),i=n.getDoc().documentElement,n.inline?{left:o.scrollLeft,top:o.scrollTop}:{left:o.scrollLeft||i.scrollLeft,top:o.scrollTop||i.scrollTop});return{left:t.pageX-r.left+a.left,top:t.pageY-r.top+a.top}}(e,t)).left-n.left+o.left,pageY:i.top-n.top+o.top};var n,o,i,r,a,s},gC=Dn,mC=In,pC=function(e){e&&e.parentNode&&e.parentNode.removeChild(e)},vC=function(e){e.dragging=!1,e.element=null,pC(e.ghost)},yC=In,bC=Dn,CC=function(e,t){for(var n=e.getBody();t&&t!==n;){if(yC(t)||bC(t))return t;t=t.parentNode}return null},TC=function(t){var n,o=t.getBody(),i=function(n,o,i,r){var a,s,l=xa(E.none()),u=kl(n),c=0<u.length?u:"p",d=function(){!function(e){var t,n,o,i,r=Pa(yt.fromDom(e),"*[contentEditable=false]");for(o=0;o<r.length;o++)n=(t=r[o].dom()).previousSibling,ms(n)&&(1===(i=n.data).length?n.parentNode.removeChild(n):n.deleteData(i.length-1,1)),gs(n=t.nextSibling)&&(1===(i=n.data).length?n.parentNode.removeChild(n):n.deleteData(0,1))}(o),s&&(Zl(s),s=null),l.get().each((function(e){_r(e.caret).remove(),l.set(E.none())})),a&&(oa.clearInterval(a),a=null)},f=function(){a=oa.setInterval((function(){Vf(t)?_r("div.mce-visual-caret",o).toggleClass("mce-visual-caret-hidden"):_r("div.mce-visual-caret",o).addClass("mce-visual-caret-hidden")}),500)};return{show:function(n,i){var r,a,u;if(d(),fn(u=i)&&/^(TD|TH)$/i.test(u.tagName))return null;if(!function(e){return t.dom.isBlock(e)}(i))return s=function(e,t){var n,o=e.ownerDocument.createTextNode(os),i=e.parentNode;if(t){if(ss(n=e.previousSibling)){if(cs(n))return n;if(ms(n))return n.splitText(n.data.length-1)}i.insertBefore(o,e)}else{if(ss(n=e.nextSibling)){if(cs(n))return n;if(gs(n))return n.splitText(1),n}e.nextSibling?i.insertBefore(o,e.nextSibling):i.appendChild(o)}return o}(i,n),a=i.ownerDocument.createRange(),Ql(s.nextSibling)?(a.setStart(s,0),a.setEnd(s,0)):(a.setStart(s,1),a.setEnd(s,1)),a;s=function(t,n,o){var i,r=n.ownerDocument.createElement(t);r.setAttribute("data-mce-caret",o?"before":"after"),r.setAttribute("data-mce-bogus","all"),r.appendChild(((i=e.document.createElement("br")).setAttribute("data-mce-bogus","1"),i));var a=n.parentNode;return o?a.insertBefore(r,n):n.nextSibling?a.insertBefore(r,n.nextSibling):a.appendChild(r),r}(c,i,n),r=eu(o,i,n),_r(s).css("top",r.top);var h=_r('<div class="mce-visual-caret" data-mce-bogus="all"></div>').css(r).appendTo(o)[0];return l.set(E.some({caret:h,element:i,before:n})),l.get().each((function(e){n&&_r(e.caret).addClass("mce-visual-caret-before")})),f(),(a=i.ownerDocument.createRange()).setStart(s,0),a.setEnd(s,0),a},hide:d,getCss:function(){return".mce-visual-caret {position: absolute;background-color: black;background-color: currentcolor;}.mce-visual-caret-hidden {display: none;}*[data-mce-caret] {position: absolute;left: -1000px;right: auto;top: 0;margin: 0;padding: 0;}"},reposition:function(){l.get().each((function(e){var t=eu(o,e.element,e.before);_r(e.caret).css(Te({},t))}))},destroy:function(){return oa.clearInterval(a)}}}(t,o),r="sel-"+t.dom.uniqueId(),a=function(e){e&&t.selection.setRng(e)},s=function(){return t.selection.getRng()},l=function(e,n,o,r){return void 0===r&&(r=!0),t.fire("ShowCaret",{target:n,direction:e,before:o}).isDefaultPrevented()?null:(r&&t.selection.scrollIntoView(n,-1===e),i.show(o,n))},u=function(e){return cs(e)||gs(e)||ms(e)},c=function(e){return u(e.startContainer)||u(e.endContainer)},d=function(e,i){var a,s,u,d,f,h,m,p=t.$,v=t.dom;if(!e)return null;if(e.collapsed){if(!c(e))if(!1===i){if(f=Cu(-1,o,e),nu(f.getNode(!0)))return l(-1,f.getNode(!0),!1,!1);if(nu(f.getNode()))return l(-1,f.getNode(),!f.isAtEnd(),!1)}else{if(f=Cu(1,o,e),nu(f.getNode()))return l(1,f.getNode(),!f.isAtEnd(),!1);if(nu(f.getNode(!0)))return l(1,f.getNode(!0),!1,!1)}return null}d=e.startOffset;var y=e.endOffset;if(3===(u=e.startContainer).nodeType&&0===d&&bC(u.parentNode)&&(d=v.nodeIndex(u=u.parentNode),u=u.parentNode),1!==u.nodeType)return null;if(y===d+1&&u===e.endContainer&&(a=u.childNodes[d]),!bC(a))return null;h=m=a.cloneNode(!0);var b=t.fire("ObjectSelected",{target:a,targetClone:h});if(b.isDefaultPrevented())return null;s=Ha(yt.fromDom(t.getBody()),"#"+r).fold((function(){return p([])}),(function(e){return p([e.dom()])})),h=b.targetClone,0===s.length&&(s=p('<div data-mce-bogus="all" class="mce-offscreen-selection"></div>').attr("id",r)).appendTo(t.getBody()),e=t.dom.createRng(),h===m&&dt.ie?(s.empty().append('<p style="font-size: 0" data-mce-bogus="all"> </p>').append(h),e.setStartAfter(s[0].firstChild.firstChild),e.setEndAfter(h)):(s.empty().append(Oo).append(h).append(Oo),e.setStart(s[0].firstChild,1),e.setEnd(s[0].lastChild,0)),s.css({top:v.getPos(a,t.getBody()).y}),s[0].focus();var C=t.selection.getSel();C.removeAllRanges(),C.addRange(e);var T=yt.fromDom(a);return H(Pa(yt.fromDom(t.getBody()),"*[data-mce-selected]"),(function(e){Rt(T,e)||An(e,"data-mce-selected")})),t.dom.getAttrib(a,"data-mce-selected")||a.setAttribute("data-mce-selected","1"),n=a,g(),e},h=function(){n&&(n.removeAttribute("data-mce-selected"),Ha(yt.fromDom(t.getBody()),"#"+r).each(Zt),n=null),Ha(yt.fromDom(t.getBody()),"#"+r).each(Zt),n=null},g=function(){i.hide()};return dt.ceFalse&&function(){var u,m,p;t.on("mouseup",(function(e){var n=s();n.collapsed&&Wg(t,e.clientX,e.clientY)&&a(qv(t,n,!1))})),t.on("click",(function(e){var n=CC(t,e.target);n&&(bC(n)&&(e.preventDefault(),t.focus()),yC(n)&&t.dom.isChildOf(n,t.selection.getNode())&&h())})),t.on("blur NewBlock",(function(){h()})),t.on("ResizeWindow FullscreenStateChanged",(function(){return i.reposition()})),(u=t).on("tap",(function(e){var t=CC(u,e.target);bC(t)&&(e.preventDefault(),d(Uv(u,t)))}),!0),t.on("mousedown",(function(e){var n=e.target;if((n===o||"HTML"===n.nodeName||t.dom.isChildOf(n,o))&&!1!==Wg(t,e.clientX,e.clientY)){var i=CC(t,n);if(i)bC(i)?(e.preventDefault(),d(Uv(t,i))):(h(),yC(i)&&e.shiftKey||Bm(e.clientX,e.clientY,t.selection.getRng())||(g(),t.selection.placeCaretAt(e.clientX,e.clientY)));else if(!1===nu(n)){h(),g();var r=function(e,t,n){var o,i,r=wv($(te(e.getElementsByTagName("*")),nu)),a=$(r,f(Fv,n)),s=zv(a,t);if(s){var l=!vn(s.node);if((s=zv(function(e,t,n){void 0===n&&(n=!0);var o=[],i=function(e,n){var i=$(wv([n]),(function(n){return!e(n,t)}));return o=o.concat(i),0===i.length};return o.push(t),Vv(pv.Up,e,f(i,xs),t.node,n),Vv(pv.Down,e,f(i,Es),t.node,n),o}(e,s,l),t))&&nu(s.node))return{node:(o=s).node,before:Pv(o,i=t)<Lv(o,i)}}return null}(o,e.clientX,e.clientY);if(r&&!function(e,n){var o,i=t.dom.getParent(e,t.dom.isBlock),r=t.dom.getParent(n,t.dom.isBlock);return!(!i||!t.dom.isChildOf(i,r)||!1!==bC(CC(t,i)))||i&&(o=r,!(t.dom.getParent(i,t.dom.isBlock)===t.dom.getParent(o,t.dom.isBlock)))&&function(e){var t=Mu(e);if(!e.firstChild)return!1;var n=al.before(e.firstChild),o=t.next(n);return o&&!Dd(o)&&!Od(o)}(i)}(e.target,r.node)){e.preventDefault();var s=l(1,r.node,r.before,!1);t.getBody().focus(),a(s)}}}})),t.on("keypress",(function(e){Fm.modifierPressed(e)||bC(t.selection.getNode())&&e.preventDefault()})),t.on("GetSelectionRange",(function(e){var t=e.range;if(n){if(!n.parentNode)return void(n=null);(t=t.cloneRange()).selectNode(n),e.range=t}})),t.on("SetSelectionRange",(function(e){e.range=function(e){var n=t.schema.getShortEndedElements(),o=t.dom.createRng(),i=e.startContainer,r=e.startOffset,a=e.endContainer,s=e.endOffset;return fe(n,i.nodeName.toLowerCase())?0===r?o.setStartBefore(i):o.setStartAfter(i):o.setStart(i,r),fe(n,a.nodeName.toLowerCase())?0===s?o.setEndBefore(a):o.setEndAfter(a):o.setEnd(a,s),o}(e.range);var n=d(e.range,e.forward);n&&(e.range=n)})),t.on("AfterSetSelectionRange",(function(e){var n=e.range;c(n)||"mcepastebin"===n.startContainer.parentNode.id||g(),t.dom.hasClass(n.startContainer.parentNode,"mce-offscreen-selection")||h()})),t.on("copy",(function(e){var n,o=e.clipboardData;if(!e.isDefaultPrevented()&&e.clipboardData&&!dt.ie){var i=(n=t.dom.get(r))?n.getElementsByTagName("*")[0]:n;i&&(e.preventDefault(),o.clearData(),o.setData("text/html",i.outerHTML),o.setData("text/plain",i.outerText))}})),function(t){var n,o,i,r,a;(function(t){var n,o,i={},r=ma.DOM,a=e.document,s=function(e,t){return function(n){if(0===n.button){var o=j(t.dom.getParents(n.target),function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(t){for(var n=0;n<e.length;n++)if(e[n](t))return!0;return!1}}(gC,mC)).getOr(null);if(s=t.getBody(),gC(l=o)&&l!==s){var i=t.dom.getPos(o),r=t.getBody(),a=t.getDoc().documentElement;e.element=o,e.screenX=n.screenX,e.screenY=n.screenY,e.maxX=(t.inline?r.scrollWidth:a.offsetWidth)-2,e.maxY=(t.inline?r.scrollHeight:a.offsetHeight)-2,e.relX=n.pageX-i.x,e.relY=n.pageY-i.y,e.width=o.offsetWidth,e.height=o.offsetHeight,e.ghost=function(e,t,n,o){var i=t.cloneNode(!0);e.dom.setStyles(i,{width:n,height:o}),e.dom.setAttrib(i,"data-mce-selected",null);var r=e.dom.create("div",{class:"mce-drag-container","data-mce-bogus":"all",unselectable:"on",contenteditable:"false"});return e.dom.setStyles(r,{position:"absolute",opacity:.5,overflow:"hidden",border:0,padding:0,margin:0,width:n,height:o}),e.dom.setStyles(i,{margin:0,boxSizing:"border-box"}),r.appendChild(i),r}(t,o,e.width,e.height)}}var s,l}}(i,t),l=function(e,t){var n=oa.throttle((function(e,n){t._selectionOverrides.hideFakeCaret(),t.selection.placeCaretAt(e,n)}),0);return function(o){var i,r,a,s,l,u,c,d,f,h,g,m,p=Math.max(Math.abs(o.screenX-e.screenX),Math.abs(o.screenY-e.screenY));if(e.element&&!e.dragging&&10<p){if(t.fire("dragstart",{target:e.element}).isDefaultPrevented())return;e.dragging=!0,t.focus()}if(e.dragging){var v=(g=e,{pageX:(m=hC(t,o)).pageX-g.relX,pageY:m.pageY+5});f=e.ghost,h=t.getBody(),f.parentNode!==h&&h.appendChild(f),a=e.width,s=e.height,l=e.maxX,u=e.maxY,d=c=0,(i=e.ghost).style.left=(r=v).pageX+"px",i.style.top=r.pageY+"px",r.pageX+a>l&&(c=r.pageX+a-l),r.pageY+s>u&&(d=r.pageY+s-u),i.style.width=a-c+"px",i.style.height=s-d+"px",n(o.clientX,o.clientY)}}}(i,t),u=function(e,t){return function(n){if(e.dragging&&(s=3===(u=(a=t).selection.getSel().getRangeAt(0).startContainer).nodeType?u.parentNode:u)!==(l=e.element)&&!a.dom.isChildOf(s,l)&&!gC(s)){var o=((r=e.element.cloneNode(!0)).removeAttribute("data-mce-selected"),r),i=t.fire("drop",{targetClone:o,clientX:n.clientX,clientY:n.clientY});i.isDefaultPrevented()||(o=i.targetClone,t.undoManager.transact((function(){pC(e.element),t.insertContent(t.dom.getOuterHTML(o)),t._selectionOverrides.hideFakeCaret()})))}var r,a,s,l,u;vC(e)}}(i,t),c=(n=i,function(){n.dragging&&o.fire("dragend"),vC(n)});(o=t).on("mousedown",s),t.on("mousemove",l),t.on("mouseup",u),r.bind(a,"mousemove",l),r.bind(a,"mouseup",c),t.on("remove",(function(){r.unbind(a,"mousemove",l),r.unbind(a,"mouseup",c)}))})(t),(n=t).on("drop",(function(e){var t=void 0!==e.clientX?n.getDoc().elementFromPoint(e.clientX,e.clientY):null;(gC(t)||gC(n.dom.getContentEditableParent(t)))&&e.preventDefault()})),t.getParam("block_unsupported_drop",!0,"boolean")&&(i=function(e){if(!e.defaultPrevented){var t=e.dataTransfer;t&&(F(t.types,"Files")||0<t.files.length)&&e.preventDefault()}},r=function(e){Pf(o,e.target)&&i(e)},a=function(){var t=ma.DOM,n=o.dom,a=e.document,s=o.inline?o.getBody():o.getDoc(),l=["drop","dragover"];H(l,(function(e){t.bind(a,e,r),n.bind(s,e,i)})),o.on("remove",(function(){H(l,(function(e){t.unbind(a,e,r),n.unbind(s,e,i)}))}))},(o=t).on("init",(function(){oa.setEditorTimeout(o,a,0)})))}(t),p=Ra((function(){if(!m.removed&&m.getBody().contains(e.document.activeElement)&&m.selection.getRng().collapsed){var t=jv(m,m.selection.getRng(),!1);m.selection.setRng(t)}}),0),(m=t).on("focus",(function(){p.throttle()})),m.on("blur",(function(){p.cancel()}))}(),{showCaret:l,showBlockCaretContainer:function(e){e.hasAttribute("data-mce-caret")&&(ps(e),a(s()),t.selection.scrollIntoView(e))},hideFakeCaret:g,destroy:function(){i.destroy(),n=null}}},xC=ma.DOM,EC=function(e){return ce(e,(function(e){return!1===A(e)}))},_C=function(e){var t,n=e.settings,o=e.editorUpload.blobCache;return EC({allow_conditional_comments:n.allow_conditional_comments,allow_html_data_urls:n.allow_html_data_urls,allow_html_in_named_anchor:n.allow_html_in_named_anchor,allow_script_urls:n.allow_script_urls,allow_unsafe_link_target:n.allow_unsafe_link_target,convert_fonts_to_spans:n.convert_fonts_to_spans,fix_list_elements:n.fix_list_elements,font_size_legacy_values:n.font_size_legacy_values,forced_root_block:n.forced_root_block,forced_root_block_attrs:n.forced_root_block_attrs,padd_empty_with_br:n.padd_empty_with_br,preserve_cdata:n.preserve_cdata,remove_trailing_brs:n.remove_trailing_brs,inline_styles:n.inline_styles,root_name:(t=e).inline?t.getElement().nodeName.toLowerCase():void 0,validate:!0,blob_cache:o,images_dataimg_filter:n.images_dataimg_filter})},IC=function(e){var t;e.bindPendingEventDelegates(),e.initialized=!0,e.fire("Init"),e.focus(!0),function(e){var t=e.dom.getRoot();e.inline||Hc(e)&&e.selection.getStart(!0)!==t||$u(t).each((function(t){var n,o,i,r,a=t.getNode(),s=vn(a)?$u(a).getOr(t):t;dt.browser.isIE()?(n=e,o=s.toRange(),i=yt.fromDom(n.getBody()),r=(Rf(n)?E.from(o):E.none()).map(Sf).filter(wf(i)),n.bookmark=r.isSome()?r:n.bookmark):e.selection.setRng(s.toRange())}))}(e),e.nodeChanged({initial:!0}),e.execCallback("init_instance_callback",e),(t=e).settings.auto_focus&&oa.setEditorTimeout(t,(function(){var e;(e=!0===t.settings.auto_focus?t:t.editorManager.get(t.settings.auto_focus)).destroyed||e.focus()}),100)},DC=function(t,n){var o=t.settings,i=t.getDoc(),r=t.getBody();o.browser_spellcheck||o.gecko_spellcheck||(i.body.spellcheck=!1,xC.setAttrib(r,"spellcheck","false")),t.quirks=function(t){var n,o,i,r=pt.each,a=Fm.BACKSPACE,s=Fm.DELETE,l=t.dom,u=t.selection,c=t.parser,d=dt.gecko,f=dt.webkit,h="data:text/mce-internal,",g=dt.ie?"Text":"URL",m=function(e,n){try{t.getDoc().execCommand(e,!1,n)}catch(o){}},p=function(e){return e.isDefaultPrevented()},v=function(){t.shortcuts.add("meta+a",null,"SelectAll")},y=function(){t.on("keydown",(function(e){if(!p(e)&&e.keyCode===a&&u.isCollapsed()&&0===u.getRng().startOffset){var t=u.getNode().previousSibling;if(t&&t.nodeName&&"table"===t.nodeName.toLowerCase())return e.preventDefault(),!1}}))},b=function(){t.inline||(t.contentStyles.push("body {min-height: 150px}"),t.on("click",(function(e){var n;if("HTML"===e.target.nodeName){if(11<dt.ie)return void t.getBody().focus();n=t.selection.getRng(),t.getBody().focus(),t.selection.setRng(n),t.selection.normalize(),t.nodeChanged()}})))};return t.on("keydown",(function(e){var n,o;if(!p(e)&&e.keyCode===Fm.BACKSPACE){var i=(n=u.getRng()).startContainer,r=n.startOffset,a=l.getRoot();if(o=i,n.collapsed&&0===r){for(;o&&o.parentNode&&o.parentNode.firstChild===o&&o.parentNode!==a;)o=o.parentNode;"BLOCKQUOTE"===o.tagName&&(t.formatter.toggle("blockquote",null,o),(n=l.createRng()).setStart(i,0),n.setEnd(i,0),u.setRng(n))}}})),n=function(e){var t=l.create("body"),n=e.cloneContents();return t.appendChild(n),u.serializer.serialize(t,{format:"html"})},t.on("keydown",(function(e){var o,i,r,u,c,d=e.keyCode;if(!p(e)&&(d===s||d===a)){if(o=t.selection.isCollapsed(),i=t.getBody(),o&&!l.isEmpty(i))return;if(!o&&(r=t.selection.getRng(),u=n(r),(c=l.createRng()).selectNode(t.getBody()),u!==n(c)))return;e.preventDefault(),t.setContent(""),i.firstChild&&l.isBlock(i.firstChild)?t.selection.setCursorLocation(i.firstChild,0):t.selection.setCursorLocation(i,0),t.nodeChanged()}})),dt.windowsPhone||t.on("keyup focusin mouseup",(function(e){Fm.modifierPressed(e)||u.normalize()}),!0),f&&(t.inline||l.bind(t.getDoc(),"mousedown mouseup",(function(e){var n;if(e.target===t.getDoc().documentElement)if(n=u.getRng(),t.getBody().focus(),"mousedown"===e.type){if(cs(n.startContainer))return;u.placeCaretAt(e.clientX,e.clientY)}else u.setRng(n)})),t.on("click",(function(e){var n=e.target;/^(IMG|HR)$/.test(n.nodeName)&&"false"!==l.getContentEditableParent(n)&&(e.preventDefault(),t.selection.select(n),t.nodeChanged()),"A"===n.nodeName&&l.hasClass(n,"mce-item-anchor")&&(e.preventDefault(),u.select(n))})),kl(t)&&t.on("init",(function(){m("DefaultParagraphSeparator",kl(t))})),t.on("init",(function(){t.dom.bind(t.getBody(),"submit",(function(e){e.preventDefault()}))})),y(),c.addNodeFilter("br",(function(e){for(var t=e.length;t--;)"Apple-interchange-newline"===e[t].attr("class")&&e[t].remove()})),dt.iOS?(t.inline||t.on("keydown",(function(){e.document.activeElement===e.document.body&&t.getWin().focus()})),b(),t.on("click",(function(e){var t=e.target;do{if("A"===t.tagName)return void e.preventDefault()}while(t=t.parentNode)})),t.contentStyles.push(".mce-content-body {-webkit-touch-callout: none}")):v()),11<=dt.ie&&(b(),y()),dt.ie&&(v(),m("AutoUrlDetect",!1),t.on("dragstart",(function(e){var n,o,i;(n=e).dataTransfer&&(t.selection.isCollapsed()&&"IMG"===n.target.tagName&&u.select(n.target),0<(o=t.selection.getContent()).length&&(i=h+escape(t.id)+","+escape(o),n.dataTransfer.setData(g,i)))})),t.on("drop",(function(e){if(!p(e)){var n=(r=e).dataTransfer&&(a=r.dataTransfer.getData(g))&&0<=a.indexOf(h)?(a=a.substr(h.length).split(","),{id:unescape(a[0]),html:unescape(a[1])}):null;if(n&&n.id!==t.id){e.preventDefault();var o=Cm(e.x,e.y,t.getDoc());u.setRng(o),i=n.html,t.queryCommandSupported("mceInsertClipboardContent")?t.execCommand("mceInsertClipboardContent",!1,{content:i,internal:!0}):t.execCommand("mceInsertContent",!1,i)}}var i,r,a}))),d&&(t.on("keydown",(function(e){if(!p(e)&&e.keyCode===a){if(!t.getBody().getElementsByTagName("hr").length)return;if(u.isCollapsed()&&0===u.getRng().startOffset){var n=u.getNode(),o=n.previousSibling;if("HR"===n.nodeName)return l.remove(n),void e.preventDefault();o&&o.nodeName&&"hr"===o.nodeName.toLowerCase()&&(l.remove(o),e.preventDefault())}}})),e.Range.prototype.getClientRects||t.on("mousedown",(function(e){if(!p(e)&&"HTML"===e.target.nodeName){var n=t.getBody();n.blur(),oa.setEditorTimeout(t,(function(){n.focus()}))}})),o=function(){var e=l.getAttribs(u.getStart().cloneNode(!1));return function(){var n=u.getStart();n!==t.getBody()&&(l.setAttrib(n,"style",null),r(e,(function(e){n.setAttributeNode(e.cloneNode(!0))})))}},i=function(){return!u.isCollapsed()&&l.getParent(u.getStart(),l.isBlock)!==l.getParent(u.getEnd(),l.isBlock)},t.on("keypress",(function(e){var n;if(!p(e)&&(8===e.keyCode||46===e.keyCode)&&i())return n=o(),t.getDoc().execCommand("delete",!1,null),n(),e.preventDefault(),!1})),l.bind(t.getDoc(),"cut",(function(e){var n;!p(e)&&i()&&(n=o(),oa.setEditorTimeout(t,(function(){n()})))})),t.getParam("readonly")||t.on("BeforeExecCommand mousedown",(function(){m("StyleWithCSS",!1),m("enableInlineTableEditing",!1),Bl(t)||m("enableObjectResizing",!1)})),t.on("SetContent ExecCommand",(function(e){"setcontent"!==e.type&&"mceInsertLink"!==e.command||r(l.select("a"),(function(e){var t=e.parentNode,n=l.getRoot();if(t.lastChild===e){for(;t&&!l.isBlock(t);){if(t.parentNode.lastChild!==t||t===n)return;t=t.parentNode}l.add(t,"br",{"data-mce-bogus":1})}}))})),t.contentStyles.push("img:-moz-broken {-moz-force-broken-image-icon:1;min-width:24px;min-height:24px}"),dt.mac&&t.on("keydown",(function(e){!Fm.metaKeyPressed(e)||e.shiftKey||37!==e.keyCode&&39!==e.keyCode||(e.preventDefault(),t.selection.getSel().modify("move",37===e.keyCode?"backward":"forward","lineboundary"))})),y()),{refreshContentEditable:function(){},isHidden:function(){if(!d||t.removed)return!1;var e=t.selection.getSel();return!e||!e.rangeCount||0===e.rangeCount}}}(t),t.fire("PostRender");var a,s,l,u,c=t.getParam("directionality",Da.isRtl()?"rtl":void 0);if(void 0!==c&&(r.dir=c),o.protect&&t.on("BeforeSetContent",(function(e){pt.each(o.protect,(function(t){e.content=e.content.replace(t,(function(e){return"\x3c!--mce:protected "+escape(e)+"--\x3e"}))}))})),t.on("SetContent",(function(){t.addVisual(t.getBody())})),!1===n&&t.load({initial:!0,format:"html"}),t.startContent=t.getContent({format:"raw"}),t.on("compositionstart compositionend",(function(e){t.composing="compositionstart"===e.type})),0<t.contentStyles.length){var d="";pt.each(t.contentStyles,(function(e){d+=e+"\r\n"})),t.dom.addStyle(d)}((a=t).inline?xC.styleSheetLoader:a.dom.styleSheetLoader).loadAll(t.contentCSS,(function(e){IC(t)}),(function(e){IC(t)})),o.content_style&&(s=o.content_style,l=yt.fromDom(t.getDoc().head),u=yt.fromTag("style"),Rn(u,"type","text/css"),Gt(u,yt.fromText(s)),Gt(l,u))},OC=function(t,n){var o=t.settings,i=t.getElement(),r=t.getDoc();o.inline||(t.getElement().style.visibility=t.orgVisibility),n||t.inline||(r.open(),r.write(t.iframeHTML),r.close()),t.inline&&(xC.addClass(i,"mce-content-body"),t.contentDocument=r=e.document,t.contentWindow=e.window,t.bodyElement=i,t.contentAreaContainer=i);var a,s,l,u,d,h,g=t.getBody();g.disabled=!0,t.readonly=!!o.readonly,t.readonly||(t.inline&&"static"===xC.getStyle(g,"position",!0)&&(g.style.position="relative"),g.contentEditable=t.getParam("content_editable_state",!0)),g.disabled=!1,t.editorUpload=function(t){var n,o,i,r,a,s,l=(n=[],o=function(t){if(!t.blob||!t.base64)throw new Error("blob and base64 representations of the image are required for BlobInfo to be created");var n=t.id||cp("blobid"),o=t.name||n;return{id:c(n),name:c(o),filename:c(o+"."+({"image/jpeg":"jpg","image/jpg":"jpg","image/gif":"gif","image/png":"png"}[t.blob.type.toLowerCase()]||"dat")),blob:c(t.blob),base64:c(t.base64),blobUri:c(t.blobUri||e.URL.createObjectURL(t.blob)),uri:c(t.uri)}},{create:function(e,t,n,i){if(O(e))return o({id:e,name:i,blob:t,base64:n});if(w(e))return o(e);throw new Error("Unknown input type")},add:function(e){r(e.id())||n.push(e)},get:r=function(e){return i((function(t){return t.id()===e}))},getByUri:function(e){return i((function(t){return t.blobUri()===e}))},getByData:function(e,t){return i((function(n){return n.base64()===e&&n.blob().type===t}))},findFirst:i=function(e){return j(n,e).getOrUndefined()},removeByUri:function(t){n=$(n,(function(n){return n.blobUri()!==t||(e.URL.revokeObjectURL(n.blobUri()),!1)}))},destroy:function(){H(n,(function(t){e.URL.revokeObjectURL(t.blobUri())})),n=[]}}),u=function(){var e={},t=function(e,t){return{status:e,resultUri:t}},n=function(t){return t in e};return{hasBlobUri:n,getResultUri:function(t){var n=e[t];return n?n.resultUri:null},isPending:function(t){return!!n(t)&&1===e[t].status},isUploaded:function(t){return!!n(t)&&2===e[t].status},markPending:function(n){e[n]=t(1,null)},markUploaded:function(n,o){e[n]=t(2,o)},removeFailed:function(t){delete e[t]},destroy:function(){e={}}}}(),d=[],f=function(e){return function(n){return t.selection?e(n):[]}},h=function(e,t,n){for(var o=0;-1!==(o=e.indexOf(t,o))&&(e=e.substring(0,o)+n+e.substr(o+t.length),o+=n.length-t.length+1),-1!==o;);return e},g=function(e,t,n){return e=h(e,'src="'+t+'"','src="'+n+'"'),h(e,'data-mce-src="'+t+'"','data-mce-src="'+n+'"')},m=function(e,n){H(t.undoManager.data,(function(t){"fragmented"===t.type?t.fragments=V(t.fragments,(function(t){return g(t,e,n)})):t.content=g(t.content,e,n)}))},p=function(){return t.notificationManager.open({text:t.translate("Image uploading..."),type:"info",timeout:-1,progressBar:!0})},v=function(n){return a=a||function(t,n){var o={},i=function(t,o,i,r){var a=new e.XMLHttpRequest;a.open("POST",n.url),a.withCredentials=n.credentials,a.upload.onprogress=function(e){r(e.loaded/e.total*100)},a.onerror=function(){i("Image upload failed due to a XHR Transport error. Code: "+a.status)},a.onload=function(){if(a.status<200||300<=a.status)i("HTTP Error: "+a.status);else{var e,t,r=JSON.parse(a.responseText);r&&"string"==typeof r.location?o((t=r.location,(e=n.basePath)?e.replace(/\/$/,"")+"/"+t.replace(/^\//,""):t)):i("Invalid JSON: "+a.responseText)}};var s=new e.FormData;s.append("file",t.blob(),t.filename()),a.send(s)},r=function(e,t){return{url:t,blobInfo:e,status:!0}},a=function(e,t){return{url:"",blobInfo:e,status:!1,error:t}},s=function(e,t){pt.each(o[e],(function(e){e(t)})),delete o[e]};return!1===N(n.handler)&&(n.handler=i),{upload:function(e,l){return n.url||n.handler!==i?function(e,i){return e=pt.grep(e,(function(e){return!t.isUploaded(e.blobUri())})),qr.all(pt.map(e,(function(e){return t.isPending(e.blobUri())?(d=e.blobUri(),new qr((function(e){o[d]=o[d]||[],o[d].push(e)}))):(u=n.handler,c=i,t.markPending((l=e).blobUri()),new qr((function(n){var o;try{var i=function(){o&&o.close()};u(l,(function(e){i(),t.markUploaded(l.blobUri(),e),s(l.blobUri(),r(l,e)),n(r(l,e))}),(function(e){i(),t.removeFailed(l.blobUri()),s(l.blobUri(),a(l,e)),n(a(l,e))}),(function(e){e<0||100<e||(o=o||c()).progressBar.value(e)}))}catch(e){n(a(l,e.message))}})));var l,u,c,d})))}(e,l):new qr((function(e){e([])}))}}}(u,{url:t.getParam("images_upload_url","","string"),basePath:t.getParam("images_upload_base_path","","string"),credentials:t.getParam("images_upload_credentials",!1,"boolean"),handler:t.getParam("images_upload_handler",null,"function")}),C().then(f((function(e){var o=V(e,(function(e){return e.blobInfo}));return a.upload(o,p).then(f((function(o){var i=V(o,(function(n,o){var i=e[o].blobInfo,r=e[o].image;return n.status&&t.getParam("images_replace_blob_uris",!0,"boolean")?(l.removeByUri(r.src),function(e,n){var o,i=t.convertURL(n,"src");m(e.src,n),t.$(e).attr({src:t.getParam("images_reuse_filename",!1,"boolean")?(o=n)+(-1===o.indexOf("?")?"?":"&")+(new Date).getTime():n,"data-mce-src":i})}(r,n.url)):n.error&&Xg(t,Da.translate(["Failed to upload image: {0}",n.error])),{element:r,status:n.status,uploadUri:n.url,blobInfo:i}}));return n&&n(i),i})))})))},y=function(e){if(Nl(t))return v(e)},b=function(e){return!1!==Y(d,(function(t){return t(e)}))&&(0!==e.getAttribute("src").indexOf("data:")||t.getParam("images_dataimg_filter",c(!0),"function")(e))},C=function(){return(s=s||function(t,n){var o={};return{findAll:function(i,r){r=r||c(!0);var a,s=$((a=i)?te(a.getElementsByTagName("img")):[],(function(e){var n=e.src;return!!dt.fileApi&&!e.hasAttribute("data-mce-bogus")&&!e.hasAttribute("data-mce-placeholder")&&!(!n||n===dt.transparentSrc)&&(0===n.indexOf("blob:")?!t.isUploaded(n)&&r(e):0===n.indexOf("data:")&&r(e))})),l=V(s,(function(t){if(void 0!==o[t.src])return new qr((function(e){o[t.src].then((function(n){if("string"==typeof n)return n;e({image:t,blobInfo:n.blobInfo})}))}));var i=new qr((function(o,i){!function(t,n,o,i){var r,a;if(0!==n.src.indexOf("blob:")){var s=jm(n.src);(a=t.getByData(r=s.data,s.type))?o({image:n,blobInfo:a}):Xm(n.src).then((function(e){a=t.create(Zm(),e,r),t.add(a),o({image:n,blobInfo:a})}),(function(e){i(e)}))}else(a=t.getByUri(n.src))?o({image:n,blobInfo:a}):Xm(n.src).then((function(i){var s;s=i,new qr((function(t){var n=new e.FileReader;n.onloadend=function(){t(n.result)},n.readAsDataURL(s)})).then((function(e){r=jm(e).data,a=t.create(Zm(),i,r),t.add(a),o({image:n,blobInfo:a})}))}),(function(e){i(e)}))}(n,t,o,i)})).then((function(e){return delete o[e.image.src],e})).catch((function(e){return delete o[t.src],e}));return o[t.src]=i}));return qr.all(l)}}}(u,l)).findAll(t.getBody(),b).then(f((function(e){return e=$(e,(function(e){return"string"!=typeof e||(Xg(t,e),!1)})),H(e,(function(e){m(e.image.src,e.blobInfo.blobUri()),e.image.src=e.blobInfo.blobUri(),e.image.removeAttribute("data-mce-src")})),e})))},T=function(e){return e.replace(/src="(blob:[^"]+)"/g,(function(e,n){var o=u.getResultUri(n);if(o)return'src="'+o+'"';var i=l.getByUri(n);return(i=i||q(t.editorManager.get(),(function(e,t){return e||t.editorUpload&&t.editorUpload.blobCache.getByUri(n)}),null))?'src="data:'+i.blob().type+";base64,"+i.base64()+'"':e}))};return t.on("SetContent",(function(){(Nl(t)?y:C)()})),t.on("RawSaveContent",(function(e){e.content=T(e.content)})),t.on("GetContent",(function(e){e.source_view||"raw"===e.format||(e.content=T(e.content))})),t.on("PostRender",(function(){t.parser.addNodeFilter("img",(function(e){H(e,(function(e){var t=e.attr("src");if(!l.getByUri(t)){var n=u.getResultUri(t);n&&e.attr("src",n)}}))}))})),{blobCache:l,addFilter:function(e){d.push(e)},uploadImages:v,uploadImagesAuto:y,scanForImages:C,destroy:function(){l.destroy(),u.destroy(),s=a=null}}}(t),t.schema=Do(o),t.dom=ma(r,{keep_values:!0,url_converter:t.convertURL,url_converter_scope:t,hex_colors:o.force_hex_style_colors,update_styles:!0,root_element:t.inline?t.getBody():null,collect:function(){return t.inline},schema:t.schema,contentCssCors:t.getParam("content_css_cors",!1,"boolean"),referrerPolicy:Kl(t),onSetAttrib:function(e){t.fire("SetAttrib",e)}}),t.parser=((s=ap(_C(a=t),a.schema)).addAttributeFilter("src,href,style,tabindex",(function(e,t){for(var n,o,i=e.length,r=a.dom,s="data-mce-"+t;i--;)if((o=(n=e[i]).attr(t))&&!n.attr(s)){if(0===o.indexOf("data:")||0===o.indexOf("blob:"))continue;"style"===t?((o=r.serializeStyle(r.parseStyle(o),n.name)).length||(o=null),n.attr(s,o),n.attr(t,o)):"tabindex"===t?(n.attr(s,o),n.attr(t,null)):n.attr(s,a.convertURL(o,t,n.name))}})),s.addNodeFilter("script",(function(e){for(var t=e.length;t--;){var n=e[t],o=n.attr("type")||"no/type";0!==o.indexOf("mce-")&&n.attr("type","mce-"+o)}})),a.settings.preserve_cdata&&s.addNodeFilter("#cdata",(function(e){for(var t=e.length;t--;){var n=e[t];n.type=8,n.name="#comment",n.value="[CDATA["+a.dom.encode(n.value)+"]]"}})),s.addNodeFilter("p,h1,h2,h3,h4,h5,h6,div",(function(e){for(var t=e.length,n=a.schema.getNonEmptyElements();t--;){var o=e[t];o.isEmpty(n)&&0===o.getAll("br").length&&(o.append(new Qc("br",1)).shortEnded=!0)}})),s),t.serializer=lp((u=(l=t).settings,Te(Te({},_C(l)),EC({url_converter:u.url_converter,url_converter_scope:u.url_converter_scope,element_format:u.element_format,entities:u.entities,entity_encoding:u.entity_encoding,indent:u.indent,indent_after:u.indent_after,indent_before:u.indent_before,block_elements:u.block_elements,boolean_attributes:u.boolean_attributes,custom_elements:u.custom_elements,extended_valid_elements:u.extended_valid_elements,invalid_elements:u.invalid_elements,invalid_styles:u.invalid_styles,move_caret_before_on_enter_elements:u.move_caret_before_on_enter_elements,non_empty_elements:u.non_empty_elements,schema:u.schema,self_closing_elements:u.self_closing_elements,short_ended_elements:u.short_ended_elements,special:u.special,text_block_elements:u.text_block_elements,text_inline_elements:u.text_inline_elements,valid_children:u.valid_children,valid_classes:u.valid_classes,valid_elements:u.valid_elements,valid_styles:u.valid_styles,verify_html:u.verify_html,whitespace_elements:u.whitespace_elements}))),t),t.selection=qm(t.dom,t.getWin(),t.serializer,t),t.annotator=Gc(t),t.formatter=vp(t),t.undoManager=yp(t),t._nodeChangeDispatcher=new uC(t),t._selectionOverrides=TC(t),function(e){var t=xa(E.none()),n=xa(!1),o=Sa((function(t){e.fire("longpress",Te(Te({},t),{type:"longpress"})),n.set(!0)}),400);e.on("touchstart",(function(e){Ep(e).each((function(i){o.cancel();var r={x:c(i.clientX),y:c(i.clientY),target:c(e.target)};o.throttle(e),n.set(!1),t.set(E.some(r))}))}),!0),e.on("touchmove",(function(i){o.cancel(),Ep(i).each((function(o){t.get().each((function(i){var r,a,s,l;r=o,a=i,s=Math.abs(r.clientX-a.x()),l=Math.abs(r.clientY-a.y()),(5<s||5<l)&&(t.set(E.none()),n.set(!1),e.fire("longpresscancel"))}))}))}),!0),e.on("touchend touchcancel",(function(i){o.cancel(),"touchcancel"!==i.type&&t.get().filter((function(e){return e.target().isEqualNode(i.target)})).each((function(){n.get()?i.preventDefault():e.fire("tap",Te(Te({},i),{type:"tap"}))}))}),!0)}(t),function(e){var t,n;(t=e).on("click",(function(e){t.dom.getParent(e.target,"details")&&e.preventDefault()})),(n=e).parser.addNodeFilter("details",(function(e){H(e,(function(e){e.attr("data-mce-open",e.attr("open")),e.attr("open","open")}))})),n.serializer.addNodeFilter("details",(function(e){H(e,(function(e){var t=e.attr("data-mce-open");e.attr("open",O(t)?t:null),e.attr("data-mce-open",null)}))}))}(t),vg(t)||function(e){e.on("click",(function(t){3<=t.detail&&function(e){var t=e.selection.getRng(),n=ol.fromRangeStart(t),o=ol.fromRangeEnd(t);if(ol.isElementPosition(n)){var i=n.container();dC(i)&&$u(i).each((function(e){return t.setStart(e.container(),e.offset())}))}ol.isElementPosition(o)&&(i=n.container(),dC(i)&&Uu(i).each((function(e){return t.setEnd(e.container(),e.offset())}))),e.selection.setRng(mf(t))}(e)}))}(t),vg(d=t)||function(e){var t,n=function(e){var t=xa(null),n=f(Fp,e);return e.on("NodeChange",(function(o){var i,r,a,s,l;!Vl(e)||dt.browser.isIE()&&o.initial||(i=n,r=o.parents,a=V(Pa(yt.fromDom(e.dom.getRoot()),'*[data-mce-selected="inline-boundary"]'),(function(e){return e.dom()})),s=$(a,i),l=$(r,i),H(J(s,l),f(cv,!1)),H(J(l,s),f(cv,!0)),function(e,t){if(e.selection.isCollapsed()&&!0!==e.composing&&t.get()){var n=al.fromRangeStart(e.selection.getRng());al.isTextPosition(n)&&!1===(fs(o=n)||hs(o))&&(uv(e,Yl(t.get(),n)),t.set(null))}var o}(e,t),function(e,t,n,o){if(t.selection.isCollapsed()){var i=$(o,e);H(i,(function(o){var i=al.fromRangeStart(t.selection.getRng());ev(e,t.getBody(),i).bind((function(e){return dv(t,n,e)}))}))}}(n,e,t,o.parents))})),t}(e);(t=e).on("keyup compositionstart",f(sC,t)),function(e,t){e.on("keydown",(function(n){var o,i,r,a;!1===n.isDefaultPrevented()&&(o=e,i=t,r=n,a=nt().os,my([{keyCode:Fm.RIGHT,action:Zv(o,!0)},{keyCode:Fm.LEFT,action:Zv(o,!1)},{keyCode:Fm.UP,action:Jv(o,!1)},{keyCode:Fm.DOWN,action:Jv(o,!0)},{keyCode:Fm.RIGHT,action:ly(o,!0)},{keyCode:Fm.LEFT,action:ly(o,!1)},{keyCode:Fm.UP,action:uy(o,!1)},{keyCode:Fm.DOWN,action:uy(o,!0)},{keyCode:Fm.RIGHT,action:fv(o,i,!0)},{keyCode:Fm.LEFT,action:fv(o,i,!1)},{keyCode:Fm.RIGHT,ctrlKey:!a.isOSX(),altKey:a.isOSX(),action:gv(o,i)},{keyCode:Fm.LEFT,ctrlKey:!a.isOSX(),altKey:a.isOSX(),action:mv(o,i)},{keyCode:Fm.UP,action:hy(o,!1)},{keyCode:Fm.DOWN,action:hy(o,!0)}],r).each((function(e){r.preventDefault()})))}))}(e,n),function(e,t){e.on("keydown",(function(n){var o,i,r;!1===n.isDefaultPrevented()&&(i=t,r=n,my([{keyCode:Fm.BACKSPACE,action:gy(fb,o=e,!1)},{keyCode:Fm.BACKSPACE,action:gy(Wy,o,!1)},{keyCode:Fm.DELETE,action:gy(Wy,o,!0)},{keyCode:Fm.BACKSPACE,action:gy(Uy,o,!1)},{keyCode:Fm.DELETE,action:gy(Uy,o,!0)},{keyCode:Fm.BACKSPACE,action:gy(Gy,o,i,!1)},{keyCode:Fm.DELETE,action:gy(Gy,o,i,!0)},{keyCode:Fm.BACKSPACE,action:gy(gf,o,!1)},{keyCode:Fm.DELETE,action:gy(gf,o,!0)},{keyCode:Fm.BACKSPACE,action:gy(Zy,o,!1)},{keyCode:Fm.DELETE,action:gy(Zy,o,!0)},{keyCode:Fm.BACKSPACE,action:gy(Ry,o,!1)},{keyCode:Fm.DELETE,action:gy(Ry,o,!0)},{keyCode:Fm.BACKSPACE,action:gy(Oy,o,!1)},{keyCode:Fm.DELETE,action:gy(Oy,o,!0)},{keyCode:Fm.BACKSPACE,action:gy(Yy,o,!1)},{keyCode:Fm.DELETE,action:gy(Yy,o,!0)}],r).each((function(e){r.preventDefault()})))})),e.on("keyup",(function(t){var n,o;!1===t.isDefaultPrevented()&&(o=t,my([{keyCode:Fm.BACKSPACE,action:gy(Hy,n=e)},{keyCode:Fm.DELETE,action:gy(Hy,n)}],o))}))}(e,n),function(e){e.on("keydown",(function(t){var n,o,i;t.keyCode===Fm.ENTER&&(n=e,(o=t).isDefaultPrevented()||(o.preventDefault(),(i=n.undoManager).typing&&(i.typing=!1,i.add()),n.undoManager.transact((function(){!1===n.selection.isCollapsed()&&n.execCommand("Delete"),qb(n,o)}))))}))}(e),function(e){e.on("keydown",(function(t){var n;!1===t.isDefaultPrevented()&&(n=t,my([{keyCode:Fm.SPACEBAR,action:gy(rC,e)}],n).each((function(e){n.preventDefault()})))}))}(e),function(e){var t,n;t=e,n=Ra((function(){t.composing||iC(t)}),0),lC.isIE()&&(t.on("keypress",(function(e){n.throttle()})),t.on("remove",(function(e){n.cancel()}))),e.on("input",(function(t){!1===t.isComposing&&iC(e)}))}(e),function(e){e.on("keydown",(function(t){var n,o;!1===t.isDefaultPrevented()&&(o=t,my([{keyCode:Fm.END,action:Qv(n=e,!0)},{keyCode:Fm.HOME,action:Qv(n,!1)}],o).each((function(e){o.preventDefault()})))}))}(e)}(d),kl(h=t)&&h.on("NodeChange",f(Dp,h)),function(e){var t,n=e.dom,o=kl(e),i=(t=e).getParam("placeholder",wl.getAttrib(t.getElement(),"placeholder"),"string"),r=function(t,a){if(!function(e){if(Tp(e)){var t=e.keyCode;return!xp(e)&&(Fm.metaKeyPressed(e)||e.altKey||112<=t&&t<=123||F(bp,t))}return!1}(t)){var s,l=e.getBody(),u=!(Tp(s=t)&&!(xp(s)||"keyup"===s.type&&229===s.keyCode))&&function(e,t,n){if(Ad(yt.fromDom(t),!1)){var o=""===n,i=t.firstElementChild;return!i||!e.getStyle(t.firstElementChild,"padding-left")&&!e.getStyle(t.firstElementChild,"padding-right")&&(o?!e.isBlock(i):n===i.nodeName.toLowerCase())}return!1}(n,l,o);""!==n.getAttrib(l,Cp)===u&&!a||(n.setAttrib(l,Cp,u?i:null),n.setAttrib(l,"aria-placeholder",u?i:null),e.fire("PlaceholderToggle",{state:u}),e.on(u?"keydown":"keyup",r),e.off(u?"keyup":"keydown",r))}};i&&e.on("init",(function(t){r(t,!0),e.on("change SetContent ExecCommand",r),e.on("paste",(function(t){return oa.setEditorTimeout(e,(function(){return r(t)}))}))}))}(t),t.fire("PreInit"),yg(t).fold((function(){DC(t,!1)}),(function(e){t.setProgressState(!0),e.then((function(e){t.setProgressState(!1),DC(t,e)}))}))},wC=ma.DOM,RC=ma.DOM,SC=function(e,t,n){var o=Ug.get(n),i=Ug.urls[n]||e.documentBaseUrl.replace(/\/$/,"");if(n=pt.trim(n),o&&-1===pt.inArray(t,n)){if(pt.each(Ug.dependencies(n),(function(n){SC(e,t,n)})),e.plugins[n])return;try{var r=new o(e,i,e.$);(e.plugins[n]=r).init&&(r.init(e,i),t.push(n))}catch(Ix){!function(e,t,n){var o=Da.translate(["Failed to initialize plugin: {0}",t]);Qg(o,n),Xg(e,o)}(e,n,Ix)}}},kC=function(e){return e.replace(/^\-/,"")},AC=function(e){return{editorContainer:e,iframeContainer:e}},NC=function(t){var n,o,i,r,a,s;t.fire("ScriptsLoaded"),o=pt.trim(Ml(n=t)),i=n.ui.registry.getAll().icons,r=Te(Te({},Pg.get("default").icons),Pg.get(o).icons),ie(r,(function(e,t){fe(i,t)||n.ui.registry.addIcon(t,e)})),function(e){var t=zl(e);if(O(t)){e.settings.theme=kC(t);var n=qg.get(t);e.theme=new n(e,qg.urls[t]),e.theme.init&&e.theme.init(e,qg.urls[t]||e.documentBaseUrl.replace(/\/$/,""),e.$)}else e.theme={}}(t),s=[],pt.each(Hl(a=t).split(/[ ,]/),(function(e){SC(a,s,kC(e))}));var l,u,c,d,f=function(e){var t,n,o,i=e.getElement();return e.orgDisplay=i.style.display,O(zl(e))?e.theme.renderUI():N(zl(e))?(n=(t=e).getElement(),(o=zl(t)(t,n)).editorContainer.nodeType&&(o.editorContainer.id=o.editorContainer.id||t.id+"_parent"),o.iframeContainer&&o.iframeContainer.nodeType&&(o.iframeContainer.id=o.iframeContainer.id||t.id+"_iframecontainer"),o.height=o.iframeHeight?o.iframeHeight:n.offsetHeight,o):function(e){var t,n,o=e.getElement();return e.inline?AC(null):(t=o,n=RC.create("div"),RC.insertAfter(n,t),AC(n))}(e)}(t);return t.editorContainer=f.editorContainer?f.editorContainer:null,(l=t).contentCSS=l.contentCSS.concat(function(e){var t,n,o=(n=(t=e).getParam("content_css"),O(n)?V(n.split(","),qe):R(n)?n:!1===n||t.inline?[]:["default"]),i=e.editorManager.baseURL+"/skins/content",r="content"+e.editorManager.suffix+".css",a=!0===e.inline;return V(o,(function(t){return/^[a-z0-9\-]+$/i.test(t)&&!a?i+"/"+t+"/"+r:e.documentBaseURI.toAbsolute(t)}))}(l)),t.inline?OC(t):(d=function(t,n){var o,i,r,a,s=t.editorManager.translate("Rich Text Area. Press ALT-0 for help."),l=(o=t.id,i=s,r=t.getParam("iframe_attrs",{}),a=yt.fromTag("iframe"),Sn(a,r),Sn(a,{id:o+"_ifr",frameBorder:"0",allowTransparency:"true",title:i}),Na(a,"tox-edit-area__iframe"),a.dom());l.onload=function(){l.onload=null,t.fire("load")};var u=function(t,n){if(e.document.domain!==e.window.location.hostname&&dt.browser.isIE()){var o=cp("mce");return t[o]=function(){OC(t)},wC.setAttrib(n,"src",'javascript:(function(){document.open();document.domain="'+e.document.domain+'";var ed = window.parent.tinymce.get("'+t.id+'");document.write(ed.iframeHTML);document.close();ed.'+o+"(true);})()"),!0}return!1}(t,l);return t.contentAreaContainer=n.iframeContainer,t.iframeElement=l,t.iframeHTML=function(e){var t=e.getParam("doctype","<!DOCTYPE html>")+"<html><head>";e.getParam("document_base_url","")!==e.documentBaseUrl&&(t+='<base href="'+e.documentBaseURI.getURI()+'" />'),t+='<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />';var n=Rl(e,"body_id","tinymce"),o=Rl(e,"body_class","");return Sl(e)&&(t+='<meta http-equiv="Content-Security-Policy" content="'+Sl(e)+'" />'),t+'</head><body id="'+n+'" class="mce-content-body '+o+'" data-id="'+e.id+'"><br></body></html>'}(t),wC.add(n.iframeContainer,l),u}(u=t,c=f),c.editorContainer&&(wC.get(c.editorContainer).style.display=u.orgDisplay,u.hidden=wC.isHidden(c.editorContainer)),u.getElement().style.display="none",wC.setAttrib(u.id,"aria-hidden","true"),void(d||OC(u)))},MC=ma.DOM,KC=function(e){return"-"===e.charAt(0)},PC=function(e,t,n){return E.from(t).filter((function(e){return 0<e.length&&!Pg.has(e)})).map((function(t){return{url:e.editorManager.baseURL+"/icons/"+t+"/icons"+n+".js",name:E.some(t)}}))},LC=function(e){return N(e)?e:c(!1)},BC={"font-size":"size","font-family":"face"},FC=function(e){return function(t,n){return E.from(n).map(yt.fromDom).filter(xt).bind((function(n){return function(e,t,n){var o=function(t){return Kn(t,e).orThunk((function(){return"font"===bt(t)?de(BC,e).bind((function(e){return E.from(kn(t,e))})):E.none()}))};return function(e,t,n){var o=t(e),i=LC(n);return o.orThunk((function(){return i(e)?E.none():function(e,t,n){for(var o=e.dom(),i=LC(n);o.parentNode;){var r=yt.fromDom(o=o.parentNode),a=t(r);if(a.isSome())return a;if(i(r))break}return E.none()}(e,t,i)}))}(yt.fromDom(n),(function(e){return o(e)}),(function(e){return Rt(yt.fromDom(t),e)}))}(e,t,n.dom()).or((o=e,i=n.dom(),E.from(ma.DOM.getStyle(i,o,!0))));var o,i})).getOr("")}},zC=FC("font-size"),VC=u((function(e){return e.replace(/[\'\"\\]/g,"").replace(/,\s+/g,",")}),FC("font-family")),HC=function(e){return $u(e.getBody()).map((function(e){var t=e.container();return Cn(t)?t.parentNode:t}))},WC=function(e){return E.from(e.selection.getRng()).bind((function(t){var n,o=e.getBody();return(n=t).startContainer===o&&0===n.startOffset?E.none():E.from(e.selection.getStart(!0))}))},$C=function(e,t){if(/^[0-9\.]+$/.test(t)){var n=parseInt(t,10);if(1<=n&&n<=7){var o=pt.explode(e.getParam("font_size_style_values","xx-small,x-small,small,medium,large,x-large,xx-large")),i=pt.explode(e.getParam("font_size_classes",""));return i?i[n-1]||t:o[n-1]||t}return t}return t},UC=function(e,t){e.getDoc().execCommand(t,!1,null)},qC=pt.each,jC=pt.map,GC=pt.inArray,XC=(YC.prototype.execCommand=function(e,t,n,o){var i,a=!1,s=this;if(!s.editor.removed){var l;if(/^(mceAddUndoLevel|mceEndUndoLevel|mceBeginUndoLevel|mceRepaint)$/.test(e)||o&&o.skip_focus?Nf(l=s.editor).each((function(e){l.selection.setRng(e)})):s.editor.focus(),(o=s.editor.fire("BeforeExecCommand",{command:e,ui:t,value:n})).isDefaultPrevented())return!1;var u=e.toLowerCase();if(i=s.commands.exec[u])return i(u,t,n),s.editor.fire("ExecCommand",{command:e,ui:t,value:n}),!0;if(qC(this.editor.plugins,(function(o){if(o.execCommand&&o.execCommand(e,t,n))return s.editor.fire("ExecCommand",{command:e,ui:t,value:n}),!(a=!0)})),a)return a;if(s.editor.theme&&s.editor.theme.execCommand&&s.editor.theme.execCommand(e,t,n))return s.editor.fire("ExecCommand",{command:e,ui:t,value:n}),!0;try{a=s.editor.getDoc().execCommand(e,t,n)}catch(r){}return!!a&&(s.editor.fire("ExecCommand",{command:e,ui:t,value:n}),!0)}},YC.prototype.queryCommandState=function(e){var t;if(!this.editor.quirks.isHidden()&&!this.editor.removed){if(e=e.toLowerCase(),t=this.commands.state[e])return t(e);try{return this.editor.getDoc().queryCommandState(e)}catch(g){}return!1}},YC.prototype.queryCommandValue=function(e){var t;if(!this.editor.quirks.isHidden()&&!this.editor.removed){if(e=e.toLowerCase(),t=this.commands.value[e])return t(e);try{return this.editor.getDoc().queryCommandValue(e)}catch(g){}}},YC.prototype.addCommands=function(e,t){var n=this;t=t||"exec",qC(e,(function(e,o){qC(o.toLowerCase().split(","),(function(o){n.commands[t][o]=e}))}))},YC.prototype.addCommand=function(e,t,n){var o=this;e=e.toLowerCase(),this.commands.exec[e]=function(e,i,r,a){return t.call(n||o.editor,i,r,a)}},YC.prototype.queryCommandSupported=function(e){if(e=e.toLowerCase(),this.commands.exec[e])return!0;try{return this.editor.getDoc().queryCommandSupported(e)}catch(n){}return!1},YC.prototype.addQueryStateHandler=function(e,t,n){var o=this;e=e.toLowerCase(),this.commands.state[e]=function(){return t.call(n||o.editor)}},YC.prototype.addQueryValueHandler=function(e,t,n){var o=this;e=e.toLowerCase(),this.commands.value[e]=function(){return t.call(n||o.editor)}},YC.prototype.hasCustomCommand=function(e){return e=e.toLowerCase(),!!this.commands.exec[e]},YC.prototype.execNativeCommand=function(e,t,n){return void 0===t&&(t=!1),void 0===n&&(n=null),this.editor.getDoc().execCommand(e,t,n)},YC.prototype.isFormatMatch=function(e){return this.editor.formatter.match(e)},YC.prototype.toggleFormat=function(e,t){this.editor.formatter.toggle(e,t?{value:t}:void 0),this.editor.nodeChanged()},YC.prototype.storeSelection=function(e){this.selectionBookmark=this.editor.selection.getBookmark(e)},YC.prototype.restoreSelection=function(){this.editor.selection.moveToBookmark(this.selectionBookmark)},YC.prototype.setupCommands=function(e){var t=this;this.addCommands({"mceResetDesignMode,mceBeginUndoLevel":function(){},"mceEndUndoLevel,mceAddUndoLevel":function(){e.undoManager.add()},"Cut,Copy,Paste":function(n){var o,i=e.getDoc();try{t.execNativeCommand(n)}catch(d){o=!0}if("paste"!==n||i.queryCommandEnabled(n)||(o=!0),o||!i.queryCommandSupported(n)){var r=e.translate("Your browser doesn't support direct access to the clipboard. Please use the Ctrl+X/C/V keyboard shortcuts instead.");dt.mac&&(r=r.replace(/Ctrl\+/g,"⌘+")),e.notificationManager.open({text:r,type:"error"})}},unlink:function(){if(e.selection.isCollapsed()){var t=e.dom.getParent(e.selection.getStart(),"a");t&&e.dom.remove(t,!0)}else e.formatter.remove("link")},"JustifyLeft,JustifyCenter,JustifyRight,JustifyFull,JustifyNone":function(n){var o=n.substring(7);"full"===o&&(o="justify"),qC("left,center,right,justify".split(","),(function(t){o!==t&&e.formatter.remove("align"+t)})),"none"!==o&&t.toggleFormat("align"+o)},"InsertUnorderedList,InsertOrderedList":function(n){var o;t.execNativeCommand(n);var i=e.dom.getParent(e.selection.getNode(),"ol,ul");i&&/^(H[1-6]|P|ADDRESS|PRE)$/.test((o=i.parentNode).nodeName)&&(t.storeSelection(),e.dom.split(o,i),t.restoreSelection())},"Bold,Italic,Underline,Strikethrough,Superscript,Subscript":function(e){t.toggleFormat(e)},"ForeColor,HiliteColor":function(e,n,o){t.toggleFormat(e,o)},FontName:function(t,n,o){!function(e,t){var n,o=$C(e,t);e.formatter.toggle("fontname",{value:(n=o.split(/\s*,\s*/),V(n,(function(e){return-1===e.indexOf(" ")||$e(e,'"')||$e(e,"'")?e:"'"+e+"'"})).join(","))}),e.nodeChanged()}(e,o)},FontSize:function(t,n,o){var i;(i=e).formatter.toggle("fontsize",{value:$C(i,o)}),i.nodeChanged()},RemoveFormat:function(t){e.formatter.remove(t)},mceBlockQuote:function(){t.toggleFormat("blockquote")},FormatBlock:function(e,n,o){return t.toggleFormat(o||"p")},mceCleanup:function(){var t=e.selection.getBookmark();e.setContent(e.getContent()),e.selection.moveToBookmark(t)},mceRemoveNode:function(n,o,i){var r=i||e.selection.getNode();r!==e.getBody()&&(t.storeSelection(),e.dom.remove(r,!0),t.restoreSelection())},mceSelectNodeDepth:function(t,n,o){var i=0;e.dom.getParent(e.selection.getNode(),(function(t){if(1===t.nodeType&&i++===o)return e.selection.select(t),!1}),e.getBody())},mceSelectNode:function(t,n,o){e.selection.select(o)},mceInsertContent:function(t,n,o){!function(e,t){var n,o,i,r,a="string"!=typeof(n=t)?(o=pt.extend({paste:n.paste,data:{paste:n.paste}},n),{content:n.content,details:o}):{content:n,details:{}};i=a.content,r=a.details,bg(e).editor.insertContent(i,r)}(e,o)},mceInsertRawHTML:function(t,n,o){e.selection.setContent("tiny_mce_marker");var i=e.getContent();e.setContent(i.replace(/tiny_mce_marker/g,(function(){return o})))},mceInsertNewLine:function(t,n,o){qb(e,o)},mceToggleFormat:function(e,n,o){t.toggleFormat(o)},mceSetContent:function(t,n,o){e.setContent(o)},"Indent,Outdent":function(t){ob(e,t)},mceRepaint:function(){},InsertHorizontalRule:function(){e.execCommand("mceInsertContent",!1,"<hr />")},mceToggleVisualAid:function(){e.hasVisual=!e.hasVisual,e.addVisual()},mceReplaceContent:function(t,n,o){e.execCommand("mceInsertContent",!1,o.replace(/\{\$selection\}/g,e.selection.getContent({format:"text"})))},mceInsertLink:function(t,n,o){"string"==typeof o&&(o={href:o});var i=e.dom.getParent(e.selection.getNode(),"a");o.href=o.href.replace(/ /g,"%20"),i&&o.href||e.formatter.remove("link"),o.href&&e.formatter.apply("link",o,i)},selectAll:function(){var t=e.dom.getParent(e.selection.getStart(),In);if(t){var n=e.dom.createRng();n.selectNodeContents(t),e.selection.setRng(n)}},delete:function(){var t;fb(t=e)||Wy(t,!1)||Uy(t,!1)||Gy(t,!1)||Oy(t,!1)||gf(t)||Ry(t)||Yy(t,!1)||(UC(t,"Delete"),vy(t))},forwardDelete:function(){var t;Wy(t=e,!0)||Uy(t,!0)||Gy(t,!0)||Oy(t,!0)||gf(t)||Ry(t)||Yy(t,!0)||UC(t,"ForwardDelete")},mceNewDocument:function(){e.setContent("")},InsertLineBreak:function(t,n,o){return Nb(e,o),!0}});var n=function(t){return function(){var n=e.selection.isCollapsed()?[e.dom.getParent(e.selection.getNode(),e.dom.isBlock)]:e.selection.getSelectedBlocks(),o=jC(n,(function(n){return!!e.formatter.matchNode(n,t)}));return-1!==GC(o,!0)}};t.addCommands({JustifyLeft:n("alignleft"),JustifyCenter:n("aligncenter"),JustifyRight:n("alignright"),JustifyFull:n("alignjustify"),"Bold,Italic,Underline,Strikethrough,Superscript,Subscript":function(e){return t.isFormatMatch(e)},mceBlockQuote:function(){return t.isFormatMatch("blockquote")},Outdent:function(){return eb(e)},"InsertUnorderedList,InsertOrderedList":function(t){var n=e.dom.getParent(e.selection.getNode(),"ul,ol");return n&&("insertunorderedlist"===t&&"UL"===n.tagName||"insertorderedlist"===t&&"OL"===n.tagName)}},"state"),t.addCommands({Undo:function(){e.undoManager.undo()},Redo:function(){e.undoManager.redo()}}),t.addQueryValueHandler("FontName",(function(){return WC(t=e).fold((function(){return HC(t).map((function(e){return VC(t.getBody(),e)})).getOr("")}),(function(e){return VC(t.getBody(),e)}));var t}),this),t.addQueryValueHandler("FontSize",(function(){return WC(t=e).fold((function(){return HC(t).map((function(e){return zC(t.getBody(),e)})).getOr("")}),(function(e){return zC(t.getBody(),e)}));var t}),this)},YC);function YC(e){this.commands={state:{},exec:{},value:{}},this.editor=e,this.setupCommands(e)}var ZC="data-mce-contenteditable",JC=function(e,n,o){try{e.getDoc().execCommand(n,!1,o)}catch(t){}},QC=function(e,t){e.dom().contentEditable=t?"true":"false"},eT=function(e){return e.readonly},tT=function(e){e.parser.addAttributeFilter("contenteditable",(function(t){eT(e)&&H(t,(function(e){e.attr(ZC,e.attr("contenteditable")),e.attr("contenteditable","false")}))})),e.serializer.addAttributeFilter(ZC,(function(t){eT(e)&&H(t,(function(e){e.attr("contenteditable",e.attr(ZC))}))})),e.serializer.addTempAttr(ZC)},nT=pt.makeMap("focus blur focusin focusout click dblclick mousedown mouseup mousemove mouseover beforepaste paste cut copy selectionchange mouseout mouseenter mouseleave wheel keydown keypress keyup input beforeinput contextmenu dragstart dragend dragover draggesture dragdrop drop drag submit compositionstart compositionend compositionupdate touchstart touchmove touchend touchcancel"," "),oT=(iT.isNative=function(e){return!!nT[e.toLowerCase()]},iT.prototype.fire=function(e,t){e=e.toLowerCase(),(t=t||{}).type=e,t.target||(t.target=this.scope),t.preventDefault||(t.preventDefault=function(){t.isDefaultPrevented=b},t.stopPropagation=function(){t.isPropagationStopped=b},t.stopImmediatePropagation=function(){t.isImmediatePropagationStopped=b},t.isDefaultPrevented=y,t.isPropagationStopped=y,t.isImmediatePropagationStopped=y),this.settings.beforeFire&&this.settings.beforeFire(t);var n=this.bindings[e];if(n)for(var o=0,i=n.length;o<i;o++){var r=n[o];if(r.once&&this.off(e,r.func),t.isImmediatePropagationStopped())return t.stopPropagation(),t;if(!1===r.func.call(this.scope,t))return t.preventDefault(),t}return t},iT.prototype.on=function(e,t,n,o){var i,r,a;if(!1===t&&(t=y),t){var s={func:t};for(o&&pt.extend(s,o),a=(r=e.toLowerCase().split(" ")).length;a--;)(i=this.bindings[e=r[a]])||(i=this.bindings[e]=[],this.toggleEvent(e,!0)),n?i.unshift(s):i.push(s)}return this},iT.prototype.off=function(e,t){var n,o,i,r,a=this;if(e)for(n=(i=e.toLowerCase().split(" ")).length;n--;){if(o=this.bindings[e=i[n]],!e)return ie(this.bindings,(function(e,t){a.toggleEvent(t,!1),delete a.bindings[t]})),this;if(o){if(t)for(r=o.length;r--;)o[r].func===t&&(o=o.slice(0,r).concat(o.slice(r+1)),this.bindings[e]=o);else o.length=0;o.length||(this.toggleEvent(e,!1),delete this.bindings[e])}}else ie(this.bindings,(function(e,t){a.toggleEvent(t,!1)})),this.bindings={};return this},iT.prototype.once=function(e,t,n){return this.on(e,t,n,{once:!0})},iT.prototype.has=function(e){return e=e.toLowerCase(),!(!this.bindings[e]||0===this.bindings[e].length)},iT);function iT(e){this.bindings={},this.settings=e||{},this.scope=this.settings.scope||this,this.toggleEvent=this.settings.toggleEvent||y}var rT,aT=function(e){return e._eventDispatcher||(e._eventDispatcher=new oT({scope:e,toggleEvent:function(t,n){oT.isNative(t)&&e.toggleNativeEvent&&e.toggleNativeEvent(t,n)}})),e._eventDispatcher},sT={fire:function(e,t,n){if(this.removed&&"remove"!==e&&"detach"!==e)return t;var o=aT(this).fire(e,t);if(!1!==n&&this.parent)for(var i=this.parent();i&&!o.isPropagationStopped();)i.fire(e,o,!1),i=i.parent();return o},on:function(e,t,n){return aT(this).on(e,t,n)},off:function(e,t){return aT(this).off(e,t)},once:function(e,t){return aT(this).once(e,t)},hasEventListeners:function(e){return aT(this).has(e)}},lT=ma.DOM,uT=function(e,t){if("selectionchange"===t)return e.getDoc();if(!e.inline&&/^mouse|touch|click|contextmenu|drop|dragover|dragend/.test(t))return e.getDoc().documentElement;var n=Fl(e);return n?(e.eventRoot||(e.eventRoot=lT.select(n)[0]),e.eventRoot):e.getBody()},cT=function(e,t,n){var o,i,r,a;(a=e).hidden||eT(a)?eT(e)&&(o=e,r=(i=n).target,"click"!==i.type||Fm.metaKeyPressed(i)||null===o.dom.getParent(r,"a")||i.preventDefault()):e.fire(t,n)},dT=function(e,t){var n;if(e.delegates||(e.delegates={}),!e.delegates[t]&&!e.removed){var o=uT(e,t);if(Fl(e)){if(rT||(rT={},e.editorManager.on("removeEditor",(function(){e.editorManager.activeEditor||rT&&(ie(rT,(function(t,n){e.dom.unbind(uT(e,n))})),rT=null)}))),rT[t])return;rT[t]=n=function(n){for(var o=n.target,i=e.editorManager.get(),r=i.length;r--;){var a=i[r].getBody();a!==o&&!lT.isChildOf(o,a)||cT(i[r],t,n)}},lT.bind(o,t,n)}else lT.bind(o,t,n=function(n){cT(e,t,n)}),e.delegates[t]=n}},fT=Te(Te({},sT),{bindPendingEventDelegates:function(){var e=this;pt.each(e._pendingNativeEvents,(function(t){dT(e,t)}))},toggleNativeEvent:function(e,t){var n=this;"focus"!==e&&"blur"!==e&&(t?n.initialized?dT(n,e):n._pendingNativeEvents?n._pendingNativeEvents.push(e):n._pendingNativeEvents=[e]:n.initialized&&(n.dom.unbind(uT(n,e),e,n.delegates[e]),delete n.delegates[e]))},unbindAllNativeEvents:function(){var e=this,t=e.getBody(),n=e.dom;e.delegates&&(ie(e.delegates,(function(t,n){e.dom.unbind(uT(e,n),n,t)})),delete e.delegates),!e.inline&&t&&n&&(t.onload=null,n.unbind(e.getWin()),n.unbind(e.getDoc())),n&&(n.unbind(t),n.unbind(e.getContainer()))}}),hT=["design","readonly"],gT=function(t,n,o,i){var r=o[n.get()],a=o[i];try{a.activate()}catch(Ix){return void e.console.error("problem while activating editor mode "+i+":",Ix)}r.deactivate(),r.editorReadOnly!==a.editorReadOnly&&function(e,t){var n,o,i=yt.fromDom(e.getBody());(function(e,t,n){Ma(e,t)&&!1===n?function(e,t){Aa(e)?e.dom().classList.remove(t):function(e,t){return 0<(i=$(ka(n=e,o="class"),(function(e){return"mce-content-readonly"!==e}))).length?Rn(n,o,i.join(" ")):An(n,o),!1;var n,o,i}(e),function(e){0===(Aa(e)?e.dom().classList:ka(e,"class")).length&&An(e,"class")}(e)}(e,t):n&&Na(e,t)})(i,"mce-content-readonly",t),t?(e.selection.controlSelection.hideResizeRect(),e._selectionOverrides.hideFakeCaret(),E.from(e.selection.getNode()).each((function(e){e.removeAttribute("data-mce-selected")})),e.readonly=!0,QC(i,!1),H(Pa(i,'*[contenteditable="true"]'),(function(e){Rn(e,ZC,"true"),QC(e,!1)}))):(e.readonly=!1,QC(i,!0),H(Pa(i,"*["+ZC+'="true"]'),(function(e){An(e,ZC),QC(e,!0)})),JC(e,"StyleWithCSS",!1),JC(e,"enableInlineTableEditing",!1),JC(e,"enableObjectResizing",!1),(Vf(o=e)||function(e){return xf().filter((function(t){return!(void 0!==(n=t.dom().classList)&&(n.contains("tox-edit-area")||n.contains("tox-edit-area__iframe")||n.contains("mce-content-body")))&&Pf(e,t.dom());var n})).isSome()}(o))&&e.focus(),(n=e).selection.setRng(n.selection.getRng()),e.nodeChanged())}(t,a.editorReadOnly),n.set(i),t.fire("SwitchMode",{mode:i})},mT=pt.each,pT=pt.explode,vT={f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123},yT=pt.makeMap("alt,ctrl,shift,meta,access"),bT=(CT.prototype.add=function(e,t,n,o){var i=this,r=n;return"string"==typeof r?n=function(){i.editor.execCommand(r,!1,null)}:pt.isArray(r)&&(n=function(){i.editor.execCommand(r[0],r[1],r[2])}),mT(pT(pt.trim(e)),(function(e){var r=i.createShortcut(e,t,n,o);i.shortcuts[r.id]=r})),!0},CT.prototype.remove=function(e){var t=this.createShortcut(e);return!!this.shortcuts[t.id]&&(delete this.shortcuts[t.id],!0)},CT.prototype.parseShortcut=function(e){var t,n={};mT(pT(e.toLowerCase(),"+"),(function(e){e in yT?n[e]=!0:/^[0-9]{2,}$/.test(e)?n.keyCode=parseInt(e,10):(n.charCode=e.charCodeAt(0),n.keyCode=vT[e]||e.toUpperCase().charCodeAt(0))}));var o=[n.keyCode];for(t in yT)n[t]?o.push(t):n[t]=!1;return n.id=o.join(","),n.access&&(n.alt=!0,dt.mac?n.ctrl=!0:n.shift=!0),n.meta&&(dt.mac?n.meta=!0:(n.ctrl=!0,n.meta=!1)),n},CT.prototype.createShortcut=function(e,t,n,o){var i=pt.map(pT(e,">"),this.parseShortcut);return i[i.length-1]=pt.extend(i[i.length-1],{func:n,scope:o||this.editor}),pt.extend(i[0],{desc:this.editor.translate(t),subpatterns:i.slice(1)})},CT.prototype.hasModifier=function(e){return e.altKey||e.ctrlKey||e.metaKey},CT.prototype.isFunctionKey=function(e){return"keydown"===e.type&&112<=e.keyCode&&e.keyCode<=123},CT.prototype.matchShortcut=function(e,t){return!!t&&t.ctrl===e.ctrlKey&&t.meta===e.metaKey&&t.alt===e.altKey&&t.shift===e.shiftKey&&!!(e.keyCode===t.keyCode||e.charCode&&e.charCode===t.charCode)&&(e.preventDefault(),!0)},CT.prototype.executeShortcutAction=function(e){return e.func?e.func.call(e.scope):null},CT);function CT(e){this.shortcuts={},this.pendingPatterns=[],this.editor=e;var t=this;e.on("keyup keypress keydown",(function(e){!t.hasModifier(e)&&!t.isFunctionKey(e)||e.isDefaultPrevented()||(mT(t.shortcuts,(function(n){if(t.matchShortcut(e,n))return t.pendingPatterns=n.subpatterns.slice(0),"keydown"===e.type&&t.executeShortcutAction(n),!0})),t.matchShortcut(e,t.pendingPatterns[0])&&(1===t.pendingPatterns.length&&"keydown"===e.type&&t.executeShortcutAction(t.pendingPatterns[0]),t.pendingPatterns.shift()))}))}var TT=function(){var e,t,n,o,i,r,a,s,l=(t={},n={},o={},i={},r={},a={},{addButton:(s=function(e,t){return function(n,o){return e[n.toLowerCase()]=Te(Te({},o),{type:t})}})(e={},"button"),addGroupToolbarButton:s(e,"grouptoolbarbutton"),addToggleButton:s(e,"togglebutton"),addMenuButton:s(e,"menubutton"),addSplitButton:s(e,"splitbutton"),addMenuItem:s(t,"menuitem"),addNestedMenuItem:s(t,"nestedmenuitem"),addToggleMenuItem:s(t,"togglemenuitem"),addAutocompleter:s(n,"autocompleter"),addContextMenu:s(i,"contextmenu"),addContextToolbar:s(r,"contexttoolbar"),addContextForm:s(r,"contextform"),addSidebar:s(a,"sidebar"),addIcon:function(e,t){return o[e.toLowerCase()]=t},getAll:function(){return{buttons:e,menuItems:t,icons:o,popups:n,contextMenus:i,contextToolbars:r,sidebars:a}}});return{addAutocompleter:l.addAutocompleter,addButton:l.addButton,addContextForm:l.addContextForm,addContextMenu:l.addContextMenu,addContextToolbar:l.addContextToolbar,addIcon:l.addIcon,addMenuButton:l.addMenuButton,addMenuItem:l.addMenuItem,addNestedMenuItem:l.addNestedMenuItem,addSidebar:l.addSidebar,addSplitButton:l.addSplitButton,addToggleButton:l.addToggleButton,addGroupToolbarButton:l.addGroupToolbarButton,addToggleMenuItem:l.addToggleMenuItem,getAll:l.getAll}},xT=pt.each,ET=pt.trim,_T="source protocol authority userInfo user password host port relative path directory file query anchor".split(" "),IT={ftp:21,http:80,https:443,mailto:25},DT=(OT.parseDataUri=function(e){var t,n=decodeURIComponent(e).split(","),o=/data:([^;]+)/.exec(n[0]);return o&&(t=o[1]),{type:t,data:n[1]}},OT.getDocumentBaseUrl=function(e){var t;return t=0!==e.protocol.indexOf("http")&&"file:"!==e.protocol?e.href:e.protocol+"//"+e.host+e.pathname,/^[^:]+:\/\/\/?[^\/]+\//.test(t)&&(t=t.replace(/[\?#].*$/,"").replace(/[\/\\][^\/]+$/,""),/[\/\\]$/.test(t)||(t+="/")),t},OT.prototype.setPath=function(e){var t=/^(.*?)\/?(\w+)?$/.exec(e);this.path=t[0],this.directory=t[1],this.file=t[2],this.source="",this.getURI()},OT.prototype.toRelative=function(e){var t;if("./"===e)return e;var n=new OT(e,{base_uri:this});if("mce_host"!==n.host&&this.host!==n.host&&n.host||this.port!==n.port||this.protocol!==n.protocol&&""!==n.protocol)return n.getURI();var o=this.getURI(),i=n.getURI();return o===i||"/"===o.charAt(o.length-1)&&o.substr(0,o.length-1)===i?o:(t=this.toRelPath(this.path,n.path),n.query&&(t+="?"+n.query),n.anchor&&(t+="#"+n.anchor),t)},OT.prototype.toAbsolute=function(e,t){var n=new OT(e,{base_uri:this});return n.getURI(t&&this.isSameOrigin(n))},OT.prototype.isSameOrigin=function(e){if(this.host==e.host&&this.protocol==e.protocol){if(this.port==e.port)return!0;var t=IT[this.protocol];if(t&&(this.port||t)==(e.port||t))return!0}return!1},OT.prototype.toRelPath=function(e,t){var n,o,i=0,r="",a=e.substring(0,e.lastIndexOf("/")).split("/"),s=t.split("/");if(a.length>=s.length)for(n=0,o=a.length;n<o;n++)if(n>=s.length||a[n]!==s[n]){i=n+1;break}if(a.length<s.length)for(n=0,o=s.length;n<o;n++)if(n>=a.length||a[n]!==s[n]){i=n+1;break}if(1===i)return t;for(n=0,o=a.length-(i-1);n<o;n++)r+="../";for(n=i-1,o=s.length;n<o;n++)r+=n!==i-1?"/"+s[n]:s[n];return r},OT.prototype.toAbsPath=function(e,t){var n,o,i=0,r=[],a=/\/$/.test(t)?"/":"",s=e.split("/"),l=t.split("/");for(xT(s,(function(e){e&&r.push(e)})),s=r,n=l.length-1,r=[];0<=n;n--)0!==l[n].length&&"."!==l[n]&&(".."!==l[n]?0<i?i--:r.push(l[n]):i++);return 0!==(o=(n=s.length-i)<=0?Z(r).join("/"):s.slice(0,n).join("/")+"/"+Z(r).join("/")).indexOf("/")&&(o="/"+o),a&&o.lastIndexOf("/")!==o.length-1&&(o+=a),o},OT.prototype.getURI=function(e){var t;return void 0===e&&(e=!1),this.source&&!e||(t="",e||(t+=this.protocol?this.protocol+"://":"//",this.userInfo&&(t+=this.userInfo+"@"),this.host&&(t+=this.host),this.port&&(t+=":"+this.port)),this.path&&(t+=this.path),this.query&&(t+="?"+this.query),this.anchor&&(t+="#"+this.anchor),this.source=t),this.source},OT);function OT(t,n){t=ET(t),this.settings=n||{};var o=this.settings.base_uri,i=this;if(/^([\w\-]+):([^\/]{2})/i.test(t)||/^\s*#/.test(t))i.source=t;else{var r=0===t.indexOf("//");if(0!==t.indexOf("/")||r||(t=(o&&o.protocol||"http")+"://mce_host"+t),!/^[\w\-]*:?\/\//.test(t)){var a=this.settings.base_uri?this.settings.base_uri.path:new OT(e.document.location.href).directory;if(this.settings.base_uri&&""==this.settings.base_uri.protocol)t="//mce_host"+i.toAbsPath(a,t);else{var s=/([^#?]*)([#?]?.*)/.exec(t);t=(o&&o.protocol||"http")+"://mce_host"+i.toAbsPath(a,s[1])+s[2]}}t=t.replace(/@@/g,"(mce_at)");var l=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@\/]*):?([^:@\/]*))?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/.exec(t);xT(_T,(function(e,t){var n=l[t];n=n&&n.replace(/\(mce_at\)/g,"@@"),i[e]=n})),o&&(i.protocol||(i.protocol=o.protocol),i.userInfo||(i.userInfo=o.userInfo),i.port||"mce_host"!==i.host||(i.port=o.port),i.host&&"mce_host"!==i.host||(i.host=o.host),i.source=""),r&&(i.protocol="")}}var wT=ma.DOM,RT=pt.extend,ST=pt.each,kT=pt.resolve,AT=dt.ie,NT=(MT.prototype.render=function(){!function(t){var n=t.id;Da.setCode(Pl(t));var o=function(){MC.unbind(e.window,"ready",o),t.render()};if(Bo.Event.domLoaded){if(t.getElement()&&dt.contentEditable){var i,r=yt.fromDom(t.getElement()),a=q(r.dom().attributes,(function(e,t){return e[t.name]=t.value,e}),{});t.on("remove",(function(){W(r.dom().attributes,(function(e){return An(r,e.name)})),Sn(r,a)})),t.ui.styleSheetLoader=sa.forElement(r,{contentCssCors:(i=t).getParam("content_css_cors"),referrerPolicy:Kl(i)}),t.getParam("inline")?t.inline=!0:(t.orgVisibility=t.getElement().style.visibility,t.getElement().style.visibility="hidden");var s=t.getElement().form||MC.getParent(n,"form");s&&(t.formElement=s,t.getParam("hidden_input")&&!bn(t.getElement())&&(MC.insertAfter(MC.create("input",{type:"hidden",name:n}),n),t.hasHiddenInput=!0),t.formEventDelegate=function(e){t.fire(e.type,e)},MC.bind(s,"submit reset",t.formEventDelegate),t.on("reset",(function(){t.resetContent()})),!t.getParam("submit_patch")||s.submit.nodeType||s.submit.length||s._mceOldSubmit||(s._mceOldSubmit=s.submit,s.submit=function(){return t.editorManager.triggerSave(),t.setDirty(!1),s._mceOldSubmit(s)})),t.windowManager=jg(t),t.notificationManager=$g(t),"xml"===t.getParam("encoding")&&t.on("GetContent",(function(e){e.save&&(e.content=MC.encode(e.content))})),t.getParam("add_form_submit_trigger")&&t.on("submit",(function(){t.initialized&&t.save()})),t.getParam("add_unload_trigger")&&(t._beforeUnload=function(){!t.initialized||t.destroyed||t.isHidden()||t.save({format:"raw",no_events:!0,set_dirty:!1})},t.editorManager.on("BeforeUnload",t._beforeUnload)),t.editorManager.add(t),function(e,t){var n=ba.ScriptLoader;!function(e,t,n,o){var i=zl(t);if(O(i)){if(!KC(i)&&!qg.urls.hasOwnProperty(i)){var r=t.getParam("theme_url");qg.load(i,r?t.documentBaseURI.toAbsolute(r):"themes/"+i+"/theme"+n+".js")}e.loadQueue((function(){qg.waitFor(i,o)}))}else o()}(n,e,t,(function(){var o,i;(function(e,t){var n=Pl(t),o=t.getParam("language_url","","string");if(!1===Da.hasCode(n)&&"en"!==n){var i=""!==o?o:t.editorManager.baseURL+"/langs/"+n+".js";e.add(i,l,void 0,(function(){Yg(t,"LanguageLoadError",Zg("language",i,n))}))}})(n,e),function(e,t,n){var o=PC(t,"default",n),i=E.from(t.getParam("icons_url","","string")).filter((function(e){return 0<e.length})).map((function(e){return{url:e,name:E.none()}})).orThunk((function(){return PC(t,Ml(t),"")}));H(function(e){for(var t=[],n=function(e){t.push(e)},o=0;o<e.length;o++)e[o].each(n);return t}([o,i]),(function(n){e.add(n.url,l,void 0,(function(){var e,o,i;e=t,o=n.url,i=n.name.getOrUndefined(),Yg(e,"IconsLoadError",Zg("icons",o,i))}))}))}(n,e,t),i=t,pt.each((o=e).getParam("external_plugins"),(function(e,t){Ug.load(t,e,l,void 0,(function(){Jg(o,e,t)})),o.settings.plugins+=" "+t})),pt.each(Hl(o).split(/[ ,]/),(function(e){if((e=pt.trim(e))&&!Ug.urls[e])if(KC(e)){e=e.substr(1,e.length);var t=Ug.dependencies(e);pt.each(t,(function(e){var t=Ug.createUrl({prefix:"plugins/",resource:e,suffix:"/plugin"+i+".js"},e);Ug.load(t.resource,t,l,void 0,(function(){Jg(o,t.prefix+t.resource+t.suffix,t.resource)}))}))}else{var n={prefix:"plugins/",resource:e,suffix:"/plugin"+i+".js"};Ug.load(e,n,l,void 0,(function(){Jg(o,n.prefix+n.resource+n.suffix,e)}))}})),n.loadQueue((function(){e.removed||NC(e)}),e,(function(){e.removed||NC(e)}))}))}(t,t.suffix)}}else MC.bind(e.window,"ready",o)}(this)},MT.prototype.focus=function(e){this.removed||(e?Wf:Hf)(this)},MT.prototype.hasFocus=function(){return Vf(this)},MT.prototype.execCallback=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var o,i=this.settings[e];if(i)return this.callbackLookup&&(o=this.callbackLookup[e])&&(i=o.func,o=o.scope),"string"==typeof i&&(o=(o=i.replace(/\.\w+$/,""))?kT(o):0,i=kT(i),this.callbackLookup=this.callbackLookup||{},this.callbackLookup[e]={func:i,scope:o}),i.apply(o||this,t)},MT.prototype.translate=function(e){return Da.translate(e)},MT.prototype.getParam=function(e,t,n){return function(e,t,n,o){var i,r,a,s=t in e.settings?e.settings[t]:n;return"hash"===o?(a={},"string"==typeof(r=s)?H(0<r.indexOf("=")?r.split(/[;,](?![^=;,]*(?:[;,]|$))/):r.split(","),(function(e){var t=e.split("=");a[pt.trim(t[0])]=pt.trim(1<t.length?t[1]:t[0])})):a=r,a):"string"===o?Kg(O,e,t).getOr(n):"number"===o?Kg(M,e,t).getOr(n):"boolean"===o?Kg(k,e,t).getOr(n):"object"===o?Kg(w,e,t).getOr(n):"array"===o?Kg(R,e,t).getOr(n):"string[]"===o?Kg((i=O,function(e){return R(e)&&Y(e,i)}),e,t).getOr(n):"function"===o?Kg(N,e,t).getOr(n):s}(this,e,t,n)},MT.prototype.nodeChanged=function(e){this._nodeChangeDispatcher.nodeChanged(e)},MT.prototype.addCommand=function(e,t,n){this.editorCommands.addCommand(e,t,n)},MT.prototype.addQueryStateHandler=function(e,t,n){this.editorCommands.addQueryStateHandler(e,t,n)},MT.prototype.addQueryValueHandler=function(e,t,n){this.editorCommands.addQueryValueHandler(e,t,n)},MT.prototype.addShortcut=function(e,t,n,o){this.shortcuts.add(e,t,n,o)},MT.prototype.execCommand=function(e,t,n,o){return this.editorCommands.execCommand(e,t,n,o)},MT.prototype.queryCommandState=function(e){return this.editorCommands.queryCommandState(e)},MT.prototype.queryCommandValue=function(e){return this.editorCommands.queryCommandValue(e)},MT.prototype.queryCommandSupported=function(e){return this.editorCommands.queryCommandSupported(e)},MT.prototype.show=function(){this.hidden&&(this.hidden=!1,this.inline?this.getBody().contentEditable="true":(wT.show(this.getContainer()),wT.hide(this.id)),this.load(),this.fire("show"))},MT.prototype.hide=function(){var e=this,t=e.getDoc();e.hidden||(AT&&t&&!e.inline&&t.execCommand("SelectAll"),e.save(),e.inline?(e.getBody().contentEditable="false",e===e.editorManager.focusedEditor&&(e.editorManager.focusedEditor=null)):(wT.hide(e.getContainer()),wT.setStyle(e.id,"display",e.orgDisplay)),e.hidden=!0,e.fire("hide"))},MT.prototype.isHidden=function(){return!!this.hidden},MT.prototype.setProgressState=function(e,t){this.fire("ProgressState",{state:e,time:t})},MT.prototype.load=function(e){var t,n=this.getElement();if(this.removed)return"";if(n){(e=e||{}).load=!0;var o=bn(n)?n.value:n.innerHTML;return t=this.setContent(o,e),e.element=n,e.no_events||this.fire("LoadContent",e),e.element=n=null,t}},MT.prototype.save=function(e){var t,n,o=this,i=o.getElement();if(i&&o.initialized&&!o.removed)return(e=e||{}).save=!0,e.element=i,e.content=o.getContent(e),e.no_events||o.fire("SaveContent",e),"raw"===e.format&&o.fire("RawSaveContent",e),t=e.content,bn(i)?i.value=t:(!e.is_removing&&o.inline||(i.innerHTML=t),(n=wT.getParent(o.id,"form"))&&ST(n.elements,(function(e){if(e.name===o.id)return e.value=t,!1}))),e.element=i=null,!1!==e.set_dirty&&o.setDirty(!1),t},MT.prototype.setContent=function(e,t){return Tg(this,e,t)},MT.prototype.getContent=function(e){return function(e,t){var n,o;return void 0===t&&(t={}),n=t,o=t.format?t.format:"html",bg(e).editor.getContent(n,o)}(this,e)},MT.prototype.insertContent=function(e,t){t&&(e=RT({content:e},t)),this.execCommand("mceInsertContent",!1,e)},MT.prototype.resetContent=function(e){void 0===e?Tg(this,this.startContent,{format:"raw"}):Tg(this,e),this.undoManager.reset(),this.setDirty(!1),this.nodeChanged()},MT.prototype.isDirty=function(){return!this.isNotDirty},MT.prototype.setDirty=function(e){var t=!this.isNotDirty;this.isNotDirty=!e,e&&e!==t&&this.fire("dirty")},MT.prototype.getContainer=function(){return this.container||(this.container=wT.get(this.editorContainer||this.id+"_parent")),this.container},MT.prototype.getContentAreaContainer=function(){return this.contentAreaContainer},MT.prototype.getElement=function(){return this.targetElm||(this.targetElm=wT.get(this.id)),this.targetElm},MT.prototype.getWin=function(){var e;return this.contentWindow||(e=this.iframeElement)&&(this.contentWindow=e.contentWindow),this.contentWindow},MT.prototype.getDoc=function(){var e;return this.contentDocument||(e=this.getWin())&&(this.contentDocument=e.document),this.contentDocument},MT.prototype.getBody=function(){var e=this.getDoc();return this.bodyElement||(e?e.body:null)},MT.prototype.convertURL=function(e,t,n){var o=this.settings;return o.urlconverter_callback?this.execCallback("urlconverter_callback",e,n,!0,t):!o.convert_urls||n&&"LINK"===n.nodeName||0===e.indexOf("file:")||0===e.length?e:o.relative_urls?this.documentBaseURI.toRelative(e):e=this.documentBaseURI.toAbsolute(e,o.remove_script_host)},MT.prototype.addVisual=function(e){var t,n=this,o=n.settings,i=n.dom;e=e||n.getBody(),void 0===n.hasVisual&&(n.hasVisual=o.visual),ST(i.select("table,a",e),(function(e){var r;switch(e.nodeName){case"TABLE":return t=o.visual_table_class||"mce-item-table",void((r=i.getAttrib(e,"border"))&&"0"!==r||!n.hasVisual?i.removeClass(e,t):i.addClass(e,t));case"A":return void(i.getAttrib(e,"href")||(r=i.getAttrib(e,"name")||e.id,t=o.visual_anchor_class||"mce-item-anchor",r&&n.hasVisual?i.addClass(e,t):i.removeClass(e,t)))}})),n.fire("VisualAid",{element:e,hasVisual:n.hasVisual})},MT.prototype.remove=function(){!function(e){if(!e.removed){var t=e._selectionOverrides,n=e.editorUpload,o=e.getBody(),i=e.getElement();o&&e.save({is_removing:!0}),e.removed=!0,e.unbindAllNativeEvents(),e.hasHiddenInput&&i&&xg.remove(i.nextSibling),e.fire("remove"),e.editorManager.remove(e),!e.inline&&o&&xg.setStyle((r=e).id,"display",r.orgDisplay),e.fire("detach"),xg.remove(e.getContainer()),Eg(t),Eg(n),e.destroy()}var r}(this)},MT.prototype.destroy=function(e){!function(e,t){var n,o,i,r=e.selection,a=e.dom;e.destroyed||(t||e.removed?(t||(e.editorManager.off("beforeunload",e._beforeUnload),e.theme&&e.theme.destroy&&e.theme.destroy(),Eg(r),Eg(a)),(o=(n=e).formElement)&&(o._mceOldSubmit&&(o.submit=o._mceOldSubmit,o._mceOldSubmit=null),xg.unbind(o,"submit reset",n.formEventDelegate)),(i=e).contentAreaContainer=i.formElement=i.container=i.editorContainer=null,i.bodyElement=i.contentDocument=i.contentWindow=null,i.iframeElement=i.targetElm=null,i.selection&&(i.selection=i.selection.win=i.selection.dom=i.selection.dom.doc=null),e.destroyed=!0):e.remove())}(this,e)},MT.prototype.uploadImages=function(e){return this.editorUpload.uploadImages(e)},MT.prototype._scanForImages=function(){return this.editorUpload.scanForImages()},MT.prototype.addButton=function(){throw new Error("editor.addButton has been removed in tinymce 5x, use editor.ui.registry.addButton or editor.ui.registry.addToggleButton or editor.ui.registry.addSplitButton instead")},MT.prototype.addSidebar=function(){throw new Error("editor.addSidebar has been removed in tinymce 5x, use editor.ui.registry.addSidebar instead")},MT.prototype.addMenuItem=function(){throw new Error("editor.addMenuItem has been removed in tinymce 5x, use editor.ui.registry.addMenuItem instead")},MT.prototype.addContextToolbar=function(){throw new Error("editor.addContextToolbar has been removed in tinymce 5x, use editor.ui.registry.addContextToolbar instead")},MT);function MT(t,n,o){var i=this;this.plugins={},this.contentCSS=[],this.contentStyles=[],this.loadedCSS={},this.isNotDirty=!1,this.editorManager=o,this.documentBaseUrl=o.documentBaseURL,RT(this,fT),this.settings=function(e,t,n,o,i){var r,a,s,l,u=(r=n,a=Og,s=e,l={id:t,theme:"silver",toolbar_mode:Mg(i,"floating"),plugins:"",document_base_url:r,add_form_submit_trigger:!0,submit_patch:!0,add_unload_trigger:!0,convert_urls:!0,relative_urls:!0,remove_script_host:!0,object_resizing:!0,doctype:"<!DOCTYPE html>",visual:!0,font_size_legacy_values:"xx-small,small,medium,large,x-large,xx-large,300%",forced_root_block:"p",hidden_input:!0,inline_styles:!0,convert_fonts_to_spans:!0,indent:!0,indent_before:"p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,th,ul,ol,li,dl,dt,dd,area,table,thead,tfoot,tbody,tr,section,summary,article,hgroup,aside,figure,figcaption,option,optgroup,datalist",indent_after:"p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,th,ul,ol,li,dl,dt,dd,area,table,thead,tfoot,tbody,tr,section,summary,article,hgroup,aside,figure,figcaption,option,optgroup,datalist",entity_encoding:"named",url_converter:s.convertURL,url_converter_scope:s},Te(Te({},l),a?kg:{}));return function(e,t,n,o,i){var r,a,s,l,u,d,h=e?{mobile:(r=i.mobile||{},a=t,s={resize:!1,toolbar_mode:Mg(r,"scrolling"),toolbar_sticky:!1},Te(Te(Te({},kg),s),a?{menubar:!1}:{}))}:{},g=function(e,t){var n,o=ue(t,(function(t,n){return F(e,n)}));return n=o.f,{sections:c(o.t),settings:c(n)}}(["mobile"],Ig(h,i)),m=pt.extend(n,o,g.settings(),e&&Ng(g,"mobile")?function(e,t,n){void 0===n&&(n={});var o=e.sections(),i=o.hasOwnProperty(t)?o[t]:{};return pt.extend({},n,i)}(g,"mobile"):{},{validate:!0,external_plugins:(l=o,u=g.settings(),d=u.external_plugins?u.external_plugins:{},l&&l.external_plugins?pt.extend({},l.external_plugins,d):d)});return function(e,t,n,o){var i,r,a,s,l,u,c=Ag(n.forced_plugins),d=Ag(o.plugins),h=Ng(i=t,"mobile")?i.sections().mobile:{},g=h.plugins?Ag(h.plugins):d,m=(u=e&&(s=a="mobile",l=(r=t).sections(),Ng(r,a)&&l[a].theme===s)?$(g,f(F,Sg)):e&&Ng(t,"mobile")?g:d,[].concat(Ag(c)).concat(Ag(u)));return pt.extend(o,{plugins:m.join(" ")})}(e,g,o,m)}(wg||Rg,wg,u,o,i)}(this,t,this.documentBaseUrl,o.defaultSettings,n),this.settings.suffix&&(o.suffix=this.settings.suffix),this.suffix=o.suffix,this.settings.base_url&&o._setBaseUrl(this.settings.base_url),this.baseUri=o.baseURI,this.settings.referrer_policy&&(ba.ScriptLoader._setReferrerPolicy(this.settings.referrer_policy),ma.DOM.styleSheetLoader._setReferrerPolicy(this.settings.referrer_policy)),wa.languageLoad=this.settings.language_load,wa.baseURL=o.baseURL,this.id=t,this.setDirty(!1),this.documentBaseURI=new DT(this.settings.document_base_url,{base_uri:this.baseUri}),this.baseURI=this.baseUri,this.inline=!!this.settings.inline,this.shortcuts=new bT(this),this.editorCommands=new XC(this),this.settings.cache_suffix&&(dt.cacheSuffix=this.settings.cache_suffix.replace(/^[\?\&]+/,"")),this.ui={registry:TT(),styleSheetLoader:void 0};var r=function(t){var n,o,i=xa("design"),r=xa({design:{activate:l,deactivate:l,editorReadOnly:!1},readonly:{activate:l,deactivate:l,editorReadOnly:!0}});return(n=t).serializer?tT(n):n.on("PreInit",(function(){tT(n)})),(o=t).on("ShowCaret",(function(e){eT(o)&&e.preventDefault()})),o.on("ObjectSelected",(function(e){eT(o)&&e.preventDefault()})),{isReadOnly:function(){return eT(t)},set:function(e){return function(e,t,n,o){if(o!==n.get()){if(!fe(t,o))throw new Error("Editor mode '"+o+"' is invalid");e.initialized?gT(e,n,t,o):e.on("init",(function(){return gT(e,n,t,o)}))}}(t,r.get(),i,e)},get:function(){return i.get()},register:function(t,n){r.set(function(t,n,o){var i;if(F(hT,n))throw new Error("Cannot override default mode "+n);return Te(Te({},t),((i={})[n]=Te(Te({},o),{deactivate:function(){try{o.deactivate()}catch(Ix){e.console.error("problem while deactivating editor mode "+n+":",Ix)}}}),i))}(r.get(),t,n))}}}(this);this.mode=r,this.setMode=r.set,o.fire("SetupEditor",{editor:this}),this.execCallback("setup",this),this.$=_r.overrideDefaults((function(){return{context:i.inline?i.getBody():i.getDoc(),element:i.getBody()}}))}var KT,PT,LT=ma.DOM,BT=pt.explode,FT=pt.each,zT=pt.extend,VT=0,HT=!1,WT=[],$T=[],UT=function(e){var t=e.type;FT(XT.get(),(function(n){switch(t){case"scroll":n.fire("ScrollWindow",e);break;case"resize":n.fire("ResizeWindow",e)}}))},qT=function(e){e!==HT&&(e?_r(window).on("resize scroll",UT):_r(window).off("resize scroll",UT),HT=e)},jT=function(e){var t=$T;delete WT[e.id];for(var n=0;n<WT.length;n++)if(WT[n]===e){WT.splice(n,1);break}return $T=$($T,(function(t){return e!==t})),XT.activeEditor===e&&(XT.activeEditor=0<$T.length?$T[0]:null),XT.focusedEditor===e&&(XT.focusedEditor=null),t.length!==$T.length},GT="CSS1Compat"!==e.document.compatMode,XT=Te(Te({},sT),{baseURI:null,baseURL:null,defaultSettings:{},documentBaseURL:null,suffix:null,$:_r,majorVersion:"5",minorVersion:"4.2",releaseDate:"2020-08-17",editors:WT,i18n:Da,activeEditor:null,focusedEditor:null,settings:{},setup:function(){var t,n,o="";n=DT.getDocumentBaseUrl(e.document.location),/^[^:]+:\/\/\/?[^\/]+\//.test(n)&&(n=n.replace(/[\?#].*$/,"").replace(/[\/\\][^\/]+$/,""),/[\/\\]$/.test(n)||(n+="/"));var i,r=window.tinymce||window.tinyMCEPreInit;if(r)t=r.base||r.baseURL,o=r.suffix;else{for(var a=e.document.getElementsByTagName("script"),s=0;s<a.length;s++){var l;if(""!==(l=a[s].src||"")){var u=l.substring(l.lastIndexOf("/"));if(/tinymce(\.full|\.jquery|)(\.min|\.dev|)\.js/.test(l)){-1!==u.indexOf(".min")&&(o=".min"),t=l.substring(0,l.lastIndexOf("/"));break}}}!t&&e.document.currentScript&&(-1!==(l=e.document.currentScript.src).indexOf(".min")&&(o=".min"),t=l.substring(0,l.lastIndexOf("/")))}this.baseURL=new DT(n).toAbsolute(t),this.documentBaseURL=n,this.baseURI=new DT(this.baseURL),this.suffix=o,(i=this).on("AddEditor",f(Lf,i)),i.on("RemoveEditor",f(Bf,i))},overrideDefaults:function(e){var t=e.base_url;t&&this._setBaseUrl(t),e.suffix&&(this.suffix=e.suffix);var n=(this.defaultSettings=e).plugin_base_urls;void 0!==n&&ie(n,(function(e,t){wa.PluginManager.urls[t]=e}))},init:function(t){var n,o=this,i=pt.makeMap("area base basefont br col frame hr img input isindex link meta param embed source wbr track colgroup option table tbody tfoot thead tr th td script noscript style textarea video audio iframe object menu"," "),r=function(e){var t=e.id;return t||(t=de(e,"name").filter((function(e){return!LT.get(e)})).getOrThunk(LT.uniqueId),e.setAttribute("id",t)),t},a=function(e,t){return t.constructor===RegExp?t.test(e.className):LT.hasClass(e,t)},s=function(e){n=e},l=function(){var n,u=0,c=[],d=function(e,t,i){var r=new NT(e,t,o);c.push(r),r.on("init",(function(){++u===n.length&&s(c)})),r.targetElm=r.targetElm||i,r.render()};LT.unbind(window,"ready",l),function(e){var n=t[e];n&&n.apply(o,Array.prototype.slice.call(arguments,2))}("onpageload"),n=_r.unique(function(t){var n=[];if(dt.browser.isIE()&&dt.browser.version.major<11)return Qg("TinyMCE does not support the browser you are using. For a list of supported browsers please see: https://www.tinymce.com/docs/get-started/system-requirements/"),[];if(GT)return Qg("Failed to initialize the editor as the document is not in standards mode. TinyMCE requires standards mode."),[];if(t.types)return FT(t.types,(function(e){n=n.concat(LT.select(e.selector))})),n;if(t.selector)return LT.select(t.selector);if(t.target)return[t.target];switch(t.mode){case"exact":var o=t.elements||"";0<o.length&&FT(BT(o),(function(t){var o=LT.get(t);o?n.push(o):FT(e.document.forms,(function(e){FT(e.elements,(function(e){e.name===t&&(t="mce_editor_"+VT++,LT.setAttrib(e,"id",t),n.push(e))}))}))}));break;case"textareas":case"specific_textareas":FT(LT.select("textarea"),(function(e){t.editor_deselector&&a(e,t.editor_deselector)||t.editor_selector&&!a(e,t.editor_selector)||n.push(e)}))}return n}(t)),t.types?FT(t.types,(function(e){pt.each(n,(function(n){return!LT.is(n,e.selector)||(d(r(n),zT({},t,e),n),!1)}))})):(pt.each(n,(function(e){var t;(t=o.get(e.id))&&t.initialized&&!(t.getContainer()||t.getBody()).parentNode&&(jT(t),t.unbindAllNativeEvents(),t.destroy(!0),t.removed=!0,t=null)})),0===(n=pt.grep(n,(function(e){return!o.get(e.id)}))).length?s([]):FT(n,(function(e){t.inline&&e.tagName.toLowerCase()in i?Qg("Could not initialize inline editor on invalid inline target element",e):d(r(e),t,e)})))};return o.settings=t,LT.bind(window,"ready",l),new qr((function(e){n?e(n):s=function(t){e(t)}}))},get:function(e){return 0===arguments.length?$T.slice(0):O(e)?j($T,(function(t){return t.id===e})).getOr(null):M(e)&&$T[e]?$T[e]:null},add:function(e){var t=this;return WT[e.id]===e||(null===t.get(e.id)&&("length"!==e.id&&(WT[e.id]=e),WT.push(e),$T.push(e)),qT(!0),t.activeEditor=e,t.fire("AddEditor",{editor:e}),KT||(KT=function(e){var n=t.fire("BeforeUnload");if(n.returnValue)return e.preventDefault(),e.returnValue=n.returnValue,n.returnValue},window.addEventListener("beforeunload",KT))),e},createEditor:function(e,t){return this.add(new NT(e,t,this))},remove:function(e){var t,n,o=this;if(e){if(!O(e))return S(o.get((n=e).id))?null:(jT(n)&&o.fire("RemoveEditor",{editor:n}),0===$T.length&&window.removeEventListener("beforeunload",KT),n.remove(),qT(0<$T.length),n);FT(LT.select(e),(function(e){(n=o.get(e.id))&&o.remove(n)}))}else for(t=$T.length-1;0<=t;t--)o.remove($T[t])},execCommand:function(e,t,n){var o=this.get(n);switch(e){case"mceAddEditor":return this.get(n)||new NT(n,this.settings,this).render(),!0;case"mceRemoveEditor":return o&&o.remove(),!0;case"mceToggleEditor":return o?(o.isHidden()?o.show():o.hide(),!0):(this.execCommand("mceAddEditor",0,n),!0)}return!!this.activeEditor&&this.activeEditor.execCommand(e,t,n)},triggerSave:function(){FT($T,(function(e){e.save()}))},addI18n:function(e,t){Da.add(e,t)},translate:function(e){return Da.translate(e)},setActive:function(e){var t=this.activeEditor;this.activeEditor!==e&&(t&&t.fire("deactivate",{relatedTarget:e}),e.fire("activate",{relatedTarget:t})),this.activeEditor=e},_setBaseUrl:function(e){this.baseURL=new DT(this.documentBaseURL).toAbsolute(e.replace(/\/+$/,"")),this.baseURI=new DT(this.baseURL)}});function YT(e){return{walk:function(t,n){return Mc(e,t,n)},split:Xf,normalize:function(t){return Am(e,t).fold(c(!1),(function(e){return t.setStart(e.startContainer,e.startOffset),t.setEnd(e.endContainer,e.endOffset),!0}))}}}XT.setup(),(PT=YT=YT||{}).compareRanges=Im,PT.getCaretRangeFromPoint=Cm,PT.getSelectedNode=Is,PT.getNode=Ds;var ZT,JT,QT,ex,tx=YT,nx=(ZT={},JT={},{load:function(t,n){var o='Script at URL "'+n+'" failed to load',i='Script at URL "'+n+"\" did not call `tinymce.Resource.add('"+t+"', data)` within 1 second";if(void 0!==ZT[t])return ZT[t];var r=new qr((function(r,a){var s=function(t,n,o){void 0===o&&(o=1e3);var i=!1,r=null,a=function(t){return function(){for(var n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];i||(i=!0,null!==r&&(e.clearTimeout(r),r=null),t.apply(null,n))}},s=a(t),l=a(n);return{start:function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];i||null!==r||(r=e.setTimeout((function(){return l.apply(null,t)}),o))},resolve:s,reject:l}}(r,a);JT[t]=s.resolve,ba.ScriptLoader.loadScript(n,(function(){return s.start(i)}),(function(){return s.reject(o)}))}));return ZT[t]=r},add:function(e,t){void 0!==JT[e]&&(JT[e](t),delete JT[e]),ZT[e]=qr.resolve(t)}}),ox=Math.min,ix=Math.max,rx=Math.round,ax=function(e,t,n){var o=t.x,i=t.y,r=e.w,a=e.h,s=t.w,l=t.h;return"b"===(n=(n||"").split(""))[0]&&(i+=l),"r"===n[1]&&(o+=s),"c"===n[0]&&(i+=rx(l/2)),"c"===n[1]&&(o+=rx(s/2)),"b"===n[3]&&(i-=a),"r"===n[4]&&(o-=r),"c"===n[3]&&(i-=rx(a/2)),"c"===n[4]&&(o-=rx(r/2)),sx(o,i,r,a)},sx=function(e,t,n,o){return{x:e,y:t,w:n,h:o}},lx={inflate:function(e,t,n){return sx(e.x-t,e.y-n,e.w+2*t,e.h+2*n)},relativePosition:ax,findBestRelativePosition:function(e,t,n,o){var i,r;for(r=0;r<o.length;r++)if((i=ax(e,t,o[r])).x>=n.x&&i.x+i.w<=n.w+n.x&&i.y>=n.y&&i.y+i.h<=n.h+n.y)return o[r];return null},intersect:function(e,t){var n=ix(e.x,t.x),o=ix(e.y,t.y),i=ox(e.x+e.w,t.x+t.w),r=ox(e.y+e.h,t.y+t.h);return i-n<0||r-o<0?null:sx(n,o,i-n,r-o)},clamp:function(e,t,n){var o=e.x,i=e.y,r=e.x+e.w,a=e.y+e.h,s=t.x+t.w,l=t.y+t.h,u=ix(0,t.x-o),c=ix(0,t.y-i),d=ix(0,r-s),f=ix(0,a-l);return o+=u,i+=c,n&&(r+=u,a+=c,o-=d,i-=f),sx(o,i,(r-=d)-o,(a-=f)-i)},create:sx,fromClientRect:function(e){return sx(e.left,e.top,e.width,e.height)}},ux=pt.each,cx=pt.extend,dx=function(){};dx.extend=QT=function(e){var t=this.prototype,n=function(){var e,t,n;if(!ex&&(this.init&&this.init.apply(this,arguments),t=this.Mixins))for(e=t.length;e--;)(n=t[e]).init&&n.init.apply(this,arguments)},o=function(){return this};ex=!0;var i=new this;return ex=!1,e.Mixins&&(ux(e.Mixins,(function(t){for(var n in t)"init"!==n&&(e[n]=t[n])})),t.Mixins&&(e.Mixins=t.Mixins.concat(e.Mixins))),e.Methods&&ux(e.Methods.split(","),(function(t){e[t]=o})),e.Properties&&ux(e.Properties.split(","),(function(t){var n="_"+t;e[t]=function(e){return void 0!==e?(this[n]=e,this):this[n]}})),e.Statics&&ux(e.Statics,(function(e,t){n[t]=e})),e.Defaults&&t.Defaults&&(e.Defaults=cx({},t.Defaults,e.Defaults)),ie(e,(function(e,n){var o,r;i[n]="function"==typeof e&&t[n]?(o=n,r=e,function(){var e=this._super;this._super=t[o];var n=r.apply(this,arguments);return this._super=e,n}):e})),n.prototype=i,(n.constructor=n).extend=QT,n};var fx,hx=Math.min,gx=Math.max,mx=Math.round,px={serialize:function(e){var t=JSON.stringify(e);return O(t)?t.replace(/[\u0080-\uFFFF]/g,(function(e){var t=e.charCodeAt(0).toString(16);return"\\u"+"0000".substring(t.length)+t})):t},parse:function(e){try{return JSON.parse(e)}catch(n){}}},vx={callbacks:{},count:0,send:function(e){var t=this,n=ma.DOM,o=void 0!==e.count?e.count:t.count,i="tinymce_jsonp_"+o;t.callbacks[o]=function(r){n.remove(i),delete t.callbacks[o],e.callback(r)},n.add(n.doc.body,"script",{id:i,src:e.url,type:"text/javascript"}),t.count++}},yx=Te(Te({},sT),{send:function(t){var n,o=0,i=function(){!t.async||4===n.readyState||1e4<o++?(t.success&&o<1e4&&200===n.status?t.success.call(t.success_scope,""+n.responseText,n,t):t.error&&t.error.call(t.error_scope,1e4<o?"TIMED_OUT":"GENERAL",n,t),n=null):oa.setTimeout(i,10)};if(t.scope=t.scope||this,t.success_scope=t.success_scope||t.scope,t.error_scope=t.error_scope||t.scope,t.async=!1!==t.async,t.data=t.data||"",yx.fire("beforeInitialize",{settings:t}),n=new e.XMLHttpRequest){if(n.overrideMimeType&&n.overrideMimeType(t.content_type),n.open(t.type||(t.data?"POST":"GET"),t.url,t.async),t.crossDomain&&(n.withCredentials=!0),t.content_type&&n.setRequestHeader("Content-Type",t.content_type),t.requestheaders&&pt.each(t.requestheaders,(function(e){n.setRequestHeader(e.key,e.value)})),n.setRequestHeader("X-Requested-With","XMLHttpRequest"),(n=yx.fire("beforeSend",{xhr:n,settings:t}).xhr).send(t.data),!t.async)return i();oa.setTimeout(i,10)}}}),bx=pt.extend,Cx=(Tx.sendRPC=function(e){return(new Tx).send(e)},Tx.prototype.send=function(e){var t=e.error,n=e.success,o=bx(this.settings,e);o.success=function(e,i){void 0===(e=px.parse(e))&&(e={error:"JSON Parse error."}),e.error?t.call(o.error_scope||o.scope,e.error,i):n.call(o.success_scope||o.scope,e.result)},o.error=function(e,n){t&&t.call(o.error_scope||o.scope,e,n)},o.data=px.serialize({id:e.id||"c"+this.count++,method:e.method,params:e.params}),o.content_type="application/json",yx.send(o)},Tx);function Tx(e){this.settings=bx({},e),this.count=0}try{var xx="__storage_test__";(fx=e.window.localStorage).setItem(xx,xx),fx.removeItem(xx)}catch(Ix){fx=function(){return e={},t=[],n={getItem:function(t){return e[t]||null},setItem:function(n,o){t.push(n),e[n]=String(o)},key:function(e){return t[e]},removeItem:function(n){t=t.filter((function(e){return e===n})),delete e[n]},clear:function(){t=[],e={}},length:0},Object.defineProperty(n,"length",{get:function(){return t.length},configurable:!1,enumerable:!1}),n;var e,t,n}()}var Ex,_x=pt.extend(XT,{geom:{Rect:lx},util:{Promise:qr,Delay:oa,Tools:pt,VK:Fm,URI:DT,Class:dx,EventDispatcher:oT,Observable:sT,I18n:Da,XHR:yx,JSON:px,JSONRequest:Cx,JSONP:vx,LocalStorage:fx,Color:function(e){var t={},n=0,o=0,i=0,r=function(e){var r;return"object"==typeof e?"r"in e?(n=e.r,o=e.g,i=e.b):"v"in e&&function(e,t,r){if(e=(parseInt(e,10)||0)%360,t=parseInt(t,10)/100,r=parseInt(r,10)/100,t=gx(0,hx(t,1)),r=gx(0,hx(r,1)),0!==t){var a=e/60,s=r*t,l=s*(1-Math.abs(a%2-1)),u=r-s;switch(Math.floor(a)){case 0:n=s,o=l,i=0;break;case 1:n=l,o=s,i=0;break;case 2:n=0,o=s,i=l;break;case 3:n=0,o=l,i=s;break;case 4:n=l,o=0,i=s;break;case 5:n=s,o=0,i=l;break;default:n=o=i=0}n=mx(255*(n+u)),o=mx(255*(o+u)),i=mx(255*(i+u))}else n=o=i=mx(255*r)}(e.h,e.s,e.v):(r=/rgb\s*\(\s*([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)[^\)]*\)/gi.exec(e))?(n=parseInt(r[1],10),o=parseInt(r[2],10),i=parseInt(r[3],10)):(r=/#([0-F]{2})([0-F]{2})([0-F]{2})/gi.exec(e))?(n=parseInt(r[1],16),o=parseInt(r[2],16),i=parseInt(r[3],16)):(r=/#([0-F])([0-F])([0-F])/gi.exec(e))&&(n=parseInt(r[1]+r[1],16),o=parseInt(r[2]+r[2],16),i=parseInt(r[3]+r[3],16)),n=n<0?0:255<n?255:n,o=o<0?0:255<o?255:o,i=i<0?0:255<i?255:i,t};return e&&r(e),t.toRgb=function(){return{r:n,g:o,b:i}},t.toHsv=function(){return function(e,t,n){var o,i;i=0;var r=hx(e/=255,hx(t/=255,n/=255)),a=gx(e,gx(t,n));return r===a?{h:0,s:0,v:100*(i=r)}:(o=(a-r)/a,{h:mx(60*((e===r?3:n===r?1:5)-(e===r?t-n:n===r?e-t:n-e)/((i=a)-r))),s:mx(100*o),v:mx(100*i)})}(n,o,i)},t.toHex=function(){var e=function(e){return 1<(e=parseInt(e,10).toString(16)).length?e:"0"+e};return"#"+e(n)+e(o)+e(i)},t.parse=r,t}},dom:{EventUtils:Bo,Sizzle:Bi,DomQuery:_r,TreeWalker:Ir,TextSeeker:ns,DOMUtils:ma,ScriptLoader:ba,RangeUtils:tx,Serializer:lp,StyleSheetLoader:ia,ControlSelection:Hm,BookmarkManager:Lm,Selection:qm,Event:Bo.Event},html:{Styles:Ro,Entities:po,Node:Qc,Schema:Do,SaxParser:cd,DomParser:ap,Writer:nd,Serializer:od},Env:dt,AddOnManager:wa,Annotator:Gc,Formatter:vp,UndoManager:yp,EditorCommands:XC,WindowManager:jg,NotificationManager:$g,EditorObservable:fT,Shortcuts:bT,Editor:NT,FocusManager:Mf,EditorManager:XT,DOM:ma.DOM,ScriptLoader:ba.ScriptLoader,PluginManager:wa.PluginManager,ThemeManager:wa.ThemeManager,IconManager:Pg,Resource:nx,trim:pt.trim,isArray:pt.isArray,is:pt.is,toArray:pt.toArray,makeMap:pt.makeMap,each:pt.each,map:pt.map,grep:pt.grep,inArray:pt.inArray,extend:pt.extend,create:pt.create,walk:pt.walk,createNS:pt.createNS,resolve:pt.resolve,explode:pt.explode,_addCacheSuffix:pt._addCacheSuffix,isOpera:dt.opera,isWebKit:dt.webkit,isIE:dt.ie,isGecko:dt.gecko,isMac:dt.mac});Ex=_x,window.tinymce=Ex,window.tinyMCE=Ex,function(e){if("object"==typeof module)try{module.exports=e}catch(n){}}(_x)}(window),function(e){"use strict";var t=function(){},n=function(e,t){return function(){for(var n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];return e(t.apply(null,n))}},o=function(e){return function(){return e}},i=function(e){return e};function a(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return function(){for(var n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];var i=t.concat(n);return e.apply(null,i)}}var s=function(e){return function(t){return!e(t)}},l=function(e){return function(){throw new Error(e)}},u=o(!1),c=o(!0),d=tinymce.util.Tools.resolve("tinymce.ThemeManager"),f=function(){return(f=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function h(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(o=Object.getOwnPropertySymbols(e);i<o.length;i++)t.indexOf(o[i])<0&&Object.prototype.propertyIsEnumerable.call(e,o[i])&&(n[o[i]]=e[o[i]])}return n}function g(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var o=Array(e),i=0;for(t=0;t<n;t++)for(var r=arguments[t],a=0,s=r.length;a<s;a++,i++)o[i]=r[a];return o}var m,p,v,y,b,C=function(){return T},T=(m=function(e){return e.isNone()},{fold:function(e,t){return e()},is:u,isSome:u,isNone:c,getOr:v=function(e){return e},getOrThunk:p=function(e){return e()},getOrDie:function(e){throw new Error(e||"error: getOrDie called on none.")},getOrNull:o(null),getOrUndefined:o(void 0),or:v,orThunk:p,map:C,each:t,bind:C,exists:u,forall:c,filter:C,equals:m,equals_:m,toArray:function(){return[]},toString:o("none()")}),x=function(e){var t=o(e),n=function(){return r},i=function(t){return t(e)},r={fold:function(t,n){return n(e)},is:function(t){return e===t},isSome:c,isNone:u,getOr:t,getOrThunk:t,getOrDie:t,getOrNull:t,getOrUndefined:t,or:n,orThunk:n,map:function(t){return x(t(e))},each:function(t){t(e)},bind:i,exists:i,forall:i,filter:function(t){return t(e)?r:T},toArray:function(){return[e]},toString:function(){return"some("+e+")"},equals:function(t){return t.is(e)},equals_:function(t,n){return t.fold(u,(function(t){return n(e,t)}))}};return r},E={some:x,none:C,from:function(e){return null==e?T:x(e)}},_=function(e){return function(t){return o=typeof(n=t),(null===n?"null":"object"==o&&(Array.prototype.isPrototypeOf(n)||n.constructor&&"Array"===n.constructor.name)?"array":"object"==o&&(String.prototype.isPrototypeOf(n)||n.constructor&&"String"===n.constructor.name)?"string":o)===e;var n,o}},I=function(e){return function(t){return typeof t===e}},D=_("string"),O=_("object"),w=_("array"),R=I("boolean"),S=function(e){return!(null===(t=e)||void 0===t);var t},k=I("function"),A=I("number"),N=function(e,t){if(w(e)){for(var n=0,o=e.length;n<o;++n)if(!t(e[n]))return!1;return!0}return!1},M=Array.prototype.slice,K=Array.prototype.indexOf,P=Array.prototype.push,L=function(e,t){return K.call(e,t)},B=function(e,t){return-1<L(e,t)},F=function(e,t){for(var n=0,o=e.length;n<o;n++)if(t(e[n],n))return!0;return!1},z=function(e,t){for(var n=[],o=0;o<e;o++)n.push(t(o));return n},V=function(e,t){for(var n=[],o=0;o<e.length;o+=t){var i=M.call(e,o,o+t);n.push(i)}return n},H=function(e,t){for(var n=e.length,o=new Array(n),i=0;i<n;i++)o[i]=t(e[i],i);return o},W=function(e,t){for(var n=0,o=e.length;n<o;n++)t(e[n],n)},$=function(e,t){for(var n=[],o=[],i=0,r=e.length;i<r;i++){var a=e[i];(t(a,i)?n:o).push(a)}return{pass:n,fail:o}},U=function(e,t){for(var n=[],o=0,i=e.length;o<i;o++){var r=e[o];t(r,o)&&n.push(r)}return n},q=function(e,t,n){return function(e,t){for(var n=e.length-1;0<=n;n--)t(e[n])}(e,(function(e){n=t(n,e)})),n},j=function(e,t,n){return W(e,(function(e){n=t(n,e)})),n},G=function(e,t){return function(e,t,n){for(var o=0,i=e.length;o<i;o++){var r=e[o];if(t(r,o))return E.some(r);if(n(r,o))break}return E.none()}(e,t,u)},X=function(e,t){for(var n=0,o=e.length;n<o;n++)if(t(e[n],n))return E.some(n);return E.none()},Y=function(e){for(var t=[],n=0,o=e.length;n<o;++n){if(!w(e[n]))throw new Error("Arr.flatten item "+n+" was not an array, input: "+e);P.apply(t,e[n])}return t},Z=function(e,t){return Y(H(e,t))},J=function(e,t){for(var n=0,o=e.length;n<o;++n)if(!0!==t(e[n],n))return!1;return!0},Q=function(e){var t=M.call(e,0);return t.reverse(),t},ee=function(e,t){return U(e,(function(e){return!B(t,e)}))},te=function(e,t){var n=M.call(e,0);return n.sort(t),n},ne=function(e){return 0===e.length?E.none():E.some(e[0])},oe=function(e){return 0===e.length?E.none():E.some(e[e.length-1])},ie=k(Array.from)?Array.from:function(e){return M.call(e)},re=function(e,t){for(var n=0;n<e.length;n++){var o=t(e[n],n);if(o.isSome())return o}return E.none()},ae=function(e){return{is:function(t){return e===t},isValue:c,isError:u,getOr:o(e),getOrThunk:o(e),getOrDie:o(e),or:function(t){return ae(e)},orThunk:function(t){return ae(e)},fold:function(t,n){return n(e)},map:function(t){return ae(t(e))},mapError:function(t){return ae(e)},each:function(t){t(e)},bind:function(t){return t(e)},exists:function(t){return t(e)},forall:function(t){return t(e)},toOption:function(){return E.some(e)}}},se=function(e){return{is:u,isValue:u,isError:c,getOr:i,getOrThunk:function(e){return e()},getOrDie:function(){return l(String(e))()},or:function(e){return e},orThunk:function(e){return e()},fold:function(t,n){return t(e)},map:function(t){return se(e)},mapError:function(t){return se(t(e))},each:t,bind:function(t){return se(e)},exists:u,forall:c,toOption:E.none}},le={value:ae,error:se,fromOption:function(e,t){return e.fold((function(){return se(t)}),ae)}};(b=y=y||{})[b.Error=0]="Error",b[b.Value=1]="Value";var ue,ce,de=function(e,t,n){return e.stype===y.Error?t(e.serror):n(e.svalue)},fe=function(e){return{stype:y.Value,svalue:e}},he=function(e){return{stype:y.Error,serror:e}},ge=fe,me=function(e){var t=[],n=[];return W(e,(function(e){de(e,(function(e){return n.push(e)}),(function(e){return t.push(e)}))})),{values:t,errors:n}},pe=he,ve=function(e,t){return e.stype===y.Value?t(e.svalue):e},ye=function(e,t){return e.stype===y.Value?{stype:y.Value,svalue:t(e.svalue)}:e},be=Object.keys,Ce=Object.hasOwnProperty,Te=function(e,t){for(var n=be(e),o=0,i=n.length;o<i;o++){var r=n[o];t(e[r],r)}},xe=function(e,t){return Ee(e,(function(e,n){return{k:n,v:t(e,n)}}))},Ee=function(e,t){var n={};return Te(e,(function(e,o){var i=t(e,o);n[i.k]=i.v})),n},_e=function(e,t){var n=[];return Te(e,(function(e,o){n.push(t(e,o))})),n},Ie=function(e,t){for(var n=be(e),o=0,i=n.length;o<i;o++){var r=n[o],a=e[r];if(t(a,r,e))return E.some(a)}return E.none()},De=function(e){return _e(e,(function(e){return e}))},Oe=function(e,t){return we(e,t)?E.from(e[t]):E.none()},we=function(e,t){return Ce.call(e,t)},Re=function(e,t){return we(e,t)&&null!=e[t]},Se=function(t){if(!w(t))throw new Error("cases must be an array");if(0===t.length)throw new Error("there must be at least one case");var n=[],o={};return W(t,(function(i,r){var a=be(i);if(1!==a.length)throw new Error("one and only one name per case");var s=a[0],l=i[s];if(void 0!==o[s])throw new Error("duplicate key detected:"+s);if("cata"===s)throw new Error("cannot have a case named cata (sorry)");if(!w(l))throw new Error("case arguments must be an array");n.push(s),o[s]=function(){var o=arguments.length;if(o!==l.length)throw new Error("Wrong number of arguments to case "+s+". Expected "+l.length+" ("+l+"), got "+o);for(var i=new Array(o),a=0;a<i.length;a++)i[a]=arguments[a];return{fold:function(){if(arguments.length!==t.length)throw new Error("Wrong number of arguments to fold. Expected "+t.length+", got "+arguments.length);return arguments[r].apply(null,i)},match:function(e){var t=be(e);if(n.length!==t.length)throw new Error("Wrong number of arguments to match. Expected: "+n.join(",")+"\nActual: "+t.join(","));if(!J(n,(function(e){return B(t,e)})))throw new Error("Not all branches were specified when using match. Specified: "+t.join(", ")+"\nRequired: "+n.join(", "));return e[s].apply(null,i)},log:function(t){e.console.log(t,{constructors:n,constructor:s,params:i})}}}})),o},ke=Object.prototype.hasOwnProperty,Ae=function(e){return function(){for(var t=new Array(arguments.length),n=0;n<t.length;n++)t[n]=arguments[n];if(0===t.length)throw new Error("Can't merge zero objects");for(var o={},i=0;i<t.length;i++){var r=t[i];for(var a in r)ke.call(r,a)&&(o[a]=e(o[a],r[a]))}return o}},Ne=Ae((function(e,t){return O(e)&&O(t)?Ne(e,t):t})),Me=Ae((function(e,t){return t})),Ke=function(e){var t,n=!1;return function(){for(var o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];return n||(n=!0,t=e.apply(null,o)),t}},Pe=Se([{strict:[]},{defaultedThunk:["fallbackThunk"]},{asOption:[]},{asDefaultedOptionThunk:["fallbackThunk"]},{mergeWithThunk:["baseThunk"]}]),Le=function(e){return Pe.defaultedThunk(o(e))},Be=Pe.strict,Fe=Pe.asOption,ze=Pe.defaultedThunk,Ve=Pe.mergeWithThunk,He=function(e,t){var n;return(n={})[e]=t,n},We=(Se([{bothErrors:["error1","error2"]},{firstError:["error1","value2"]},{secondError:["value1","error2"]},{bothValues:["value1","value2"]}]),function(e,t){return n=t,o={},Te(e,(function(e,t){B(n,t)||(o[t]=e)})),o;var n,o}),$e=function(e,t){return He(e,t)},Ue=function(e){return t={},W(e,(function(e){t[e.key]=e.value})),t;var t},qe=function(e){return n(pe,Y)(e)},je=function(e){var t=me(e);return 0<t.errors.length?qe(t.errors):ge(t.values)},Ge=function(e){return O(e)&&100<be(e).length?" removed due to size":JSON.stringify(e,null,2)},Xe=function(e,t){return pe([{path:e,getErrorInfo:t}])},Ye=Se([{field:["key","okey","presence","prop"]},{state:["okey","instantiator"]}]),Ze=function(e,t,n){var o=Oe(e,t).fold((function(){return n(e)}),i);return ge(o)},Je=function(e){return{extract:function(t,n,o){return function(e,n){return e.stype===y.Error?function(e){return n=e,Xe(t,(function(){return n}));var n}(e.serror):e}(e(o,n))},toString:function(){return"val"}}},Qe=function(e){var n=et(e),i=q(e,(function(e,t){return t.fold((function(t){return Ne(e,$e(t,!0))}),o(e))}),{});return{extract:function(e,o,r){var a,s=R(r)?[]:be(function(e,n){var o,i,r,a,s={};return o=function(e){return null!=e},a=s,i=function(e,t){a[t]=e},r=t,Te(e,(function(e,t){(o(e)?i:r)(e,t)})),s}(r)),l=U(s,(function(e){return!Re(i,e)}));return 0===l.length?n.extract(e,o,r):(a=l,Xe(e,(function(){return"There are unsupported fields: ["+a.join(", ")+"] specified"})))},toString:n.toString}},et=function(e){return{extract:function(t,n,i){return r=t,a=i,s=n,function(e,t){var n,o,i=me(e);return 0<i.errors.length?qe(i.errors):(o={},ge(0<(n=i.values).length?Ne(o,Me.apply(void 0,n)):o))}(H(e,(function(e){return function(e,t,n,i){return n.fold((function(n,r,a,s){var l=function(t){var o=s.extract(e.concat([n]),i,t);return ye(o,(function(e){return He(r,i(e))}))},u=function(t){return t.fold((function(){var e=He(r,i(E.none()));return ge(e)}),(function(t){var o=s.extract(e.concat([n]),i,t);return ye(o,(function(e){return He(r,i(E.some(e)))}))}))};return a.fold((function(){return ve(function(e,t,n){return Oe(t,n).fold((function(){return o=n,i=t,Xe(e,(function(){return'Could not find valid *strict* value for "'+o+'" in '+Ge(i)}));var o,i}),ge)}(e,t,n),l)}),(function(e){return ve(Ze(t,n,e),l)}),(function(){return ve(ge(Oe(t,n)),u)}),(function(e){return ve((i=e,r=Oe(o=t,n).map((function(e){return!0===e?i(o):e})),ge(r)),u);var o,i,r}),(function(e){var i=e(t),r=ye(Ze(t,n,o({})),(function(e){return Ne(i,e)}));return ve(r,l)}))}),(function(e,n){var o=n(t);return ge(He(e,i(o)))}))}(r,a,e,s)})));var r,a,s},toString:function(){return"obj{\n"+H(e,(function(e){return e.fold((function(e,t,n,o){return e+" -> "+o.toString()}),(function(e,t){return"state("+e+")"}))})).join("\n")+"}"}}},tt=function(e){return{extract:function(t,n,o){var i=H(o,(function(o,i){return e.extract(t.concat(["["+i+"]"]),n,o)}));return je(i)},toString:function(){return"array("+e.toString()+")"}}},nt=o(Je(ge)),ot=n(tt,et),it=Ye.state,rt=Ye.field,at=function(e,t){return{extract:function(n,o,i){return Oe(i,e).fold((function(){return t=e,Xe(n,(function(){return'Choice schema did not contain choice key: "'+t+'"'}));var t}),(function(e){return function(e,t,n,o,i){return Oe(o,i).fold((function(){return t=o,n=i,Xe(e,(function(){return'The chosen schema: "'+n+'" did not exist in branches: '+Ge(t)}));var t,n}),(function(o){return o.extract(e.concat(["branch: "+i]),t,n)}))}(n,o,i,t,e)}))},toString:function(){return"chooseOn("+e+"). Possible values: "+be(t)}}},st=Je(ge),lt=function(e){return ot(e)},ut=function(e){return Je((function(t){return e(t).fold(pe,ge)}))},ct=function(e,t){return function(e,t){return{extract:function(n,o,r){var a,s,l=be(r),u=(a=n,s=l,tt(Je(e)).extract(a,i,s));return ve(u,(function(e){var i=H(e,(function(e){return Ye.field(e,e,Be(),t)}));return et(i).extract(n,o,r)}))},toString:function(){return"setOf("+t.toString()+")"}}}((function(t){return function(e){return e.fold(he,fe)}(e(t))}),t)},dt=function(e,t,n){return function(e){return de(e,le.error,le.value)}(function(e,t){return e.stype===y.Error?{stype:y.Error,serror:function(e){return{input:o,errors:e}}(e.serror)}:e}(t.extract([e],i,o=n)));var o},ft=function(e){return e.fold((function(e){throw new Error(gt(e))}),i)},ht=function(e,t,n){return ft(dt(e,t,n))},gt=function(e){return"Errors: \n"+(n=10<(t=e.errors).length?t.slice(0,10).concat([{path:[],getErrorInfo:function(){return"... (only showing first ten failures)"}}]):t,H(n,(function(e){return"Failed path: ("+e.path.join(" > ")+")\n"+e.getErrorInfo()})).join("\n")+"\n\nInput object: ")+Ge(e.input);var t,n},mt=function(e,t){return at(e,t)},pt=function(e,t){return at(e,xe(t,et))},vt=o(st),yt=function(e,t){return Je((function(n){var o=typeof n;return e(n)?ge(n):pe("Expected type: "+t+" but got: "+o)}))},bt=yt(A,"number"),Ct=yt(D,"string"),Tt=yt(R,"boolean"),xt=yt(k,"function"),Et=function(e){var t=function(e,t){for(var n=e.next();!n.done;){if(!t(n.value))return!1;n=e.next()}return!0};if(Object(e)!==e)return!0;switch({}.toString.call(e).slice(8,-1)){case"Boolean":case"Number":case"String":case"Date":case"RegExp":case"Blob":case"FileList":case"ImageData":case"ImageBitmap":case"ArrayBuffer":return!0;case"Array":case"Object":return Object.keys(e).every((function(t){return Et(e[t])}));case"Map":return t(e.keys(),Et)&&t(e.values(),Et);case"Set":return t(e.keys(),Et);default:return!1}},_t=Je((function(e){return Et(e)?ge(e):pe("Expected value to be acceptable for sending via postMessage")})),It=function(e){return ut((function(t){return B(e,t)?le.value(t):le.error('Unsupported value: "'+t+'", choose one of "'+e.join(", ")+'".')}))},Dt=function(e){return rt(e,e,Be(),nt())},Ot=function(e,t){return rt(e,e,Be(),t)},wt=function(e){return Ot(e,Ct)},Rt=function(e,t){return rt(e,e,Be(),It(t))},St=function(e){return Ot(e,xt)},kt=function(e,t){return rt(e,e,Be(),et(t))},At=function(e,t){return rt(e,e,Be(),ot(t))},Nt=function(e,t){return rt(e,e,Be(),tt(t))},Mt=function(e){return rt(e,e,Fe(),nt())},Kt=function(e,t){return rt(e,e,Fe(),t)},Pt=function(e){return Kt(e,bt)},Lt=function(e){return Kt(e,Ct)},Bt=function(e){return Kt(e,xt)},Ft=function(e,t){return Kt(e,et(t))},zt=function(e,t){return rt(e,e,Le(t),nt())},Vt=function(e,t,n){return rt(e,e,Le(t),n)},Ht=function(e,t){return Vt(e,t,bt)},Wt=function(e,t){return Vt(e,t,Ct)},$t=function(e,t,n){return Vt(e,t,It(n))},Ut=function(e,t){return Vt(e,t,Tt)},qt=function(e,t){return Vt(e,t,xt)},jt=function(e,t,n){return Vt(e,t,et(n))},Gt=function(e,t){return it(e,t)},Xt=function(e){var t=e;return{get:function(){return t},set:function(e){t=e}}},Yt=function(e){if(null==e)throw new Error("Node cannot be null or undefined");return{dom:o(e)}},Zt=function(t,n){var o=(n||e.document).createElement("div");if(o.innerHTML=t,!o.hasChildNodes()||1<o.childNodes.length)throw e.console.error("HTML does not have a single root node",t),new Error("HTML must have a single root node");return Yt(o.childNodes[0])},Jt=function(t,n){var o=(n||e.document).createElement(t);return Yt(o)},Qt=function(t,n){var o=(n||e.document).createTextNode(t);return Yt(o)},en=Yt,tn=function(){return nn(0,0)},nn=function(e,t){return{major:e,minor:t}},on=function(e,t){var n=String(t).toLowerCase();return 0===e.length?tn():function(e,t){var n=function(e,t){for(var n=0;n<e.length;n++){var o=e[n];if(o.test(t))return o}}(e,t);if(!n)return{major:0,minor:0};var o=function(e){return Number(t.replace(n,"$"+e))};return nn(o(1),o(2))}(e,n)},rn=tn,an="Firefox",sn=function(e){var t=e.current,n=function(e){return function(){return t===e}};return{current:t,version:e.version,isEdge:n("Edge"),isChrome:n("Chrome"),isIE:n("IE"),isOpera:n("Opera"),isFirefox:n(an),isSafari:n("Safari")}},ln=function(){return sn({current:void 0,version:rn()})},un=sn,cn=(o("Edge"),o("Chrome"),o("IE"),o("Opera"),o(an),o("Safari"),"Windows"),dn="Android",fn="Solaris",hn="FreeBSD",gn="ChromeOS",mn=function(e){var t=e.current,n=function(e){return function(){return t===e}};return{current:t,version:e.version,isWindows:n(cn),isiOS:n("iOS"),isAndroid:n(dn),isOSX:n("OSX"),isLinux:n("Linux"),isSolaris:n(fn),isFreeBSD:n(hn),isChromeOS:n(gn)}},pn=function(){return mn({current:void 0,version:rn()})},vn=mn,yn=(o(cn),o("iOS"),o(dn),o("Linux"),o("OSX"),o(fn),o(hn),o(gn),function(e,t){var n=String(t).toLowerCase();return G(e,(function(e){return e.search(n)}))}),bn=function(e,t){return-1!==e.indexOf(t)},Cn=(ue=/^\s+|\s+$/g,function(e){return e.replace(ue,"")}),Tn=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,xn=function(e){return function(t){return bn(t,e)}},En=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(e){return bn(e,"edge/")&&bn(e,"chrome")&&bn(e,"safari")&&bn(e,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,Tn],search:function(e){return bn(e,"chrome")&&!bn(e,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(e){return bn(e,"msie")||bn(e,"trident")}},{name:"Opera",versionRegexes:[Tn,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:xn("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:xn("firefox")},{name:"Safari",versionRegexes:[Tn,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(e){return(bn(e,"safari")||bn(e,"mobile/"))&&bn(e,"applewebkit")}}],_n=[{name:"Windows",search:xn("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(e){return bn(e,"iphone")||bn(e,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:xn("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:xn("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:xn("linux"),versionRegexes:[]},{name:"Solaris",search:xn("sunos"),versionRegexes:[]},{name:"FreeBSD",search:xn("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:xn("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],In={browsers:o(En),oses:o(_n)},Dn=function(t){return e.window.matchMedia(t).matches},On=Ke((function(){return function(e,t){var n,i,r,a,s,l,u,c,d,f,h,g,m=In.browsers(),p=In.oses(),v=function(e,t){return yn(e,t).map((function(e){var n=on(e.versionRegexes,t);return{current:e.name,version:n}}))}(m,e).fold(ln,un),y=function(e,t){return yn(e,t).map((function(e){var n=on(e.versionRegexes,t);return{current:e.name,version:n}}))}(p,e).fold(pn,vn);return{browser:v,os:y,deviceType:(i=v,r=e,a=t,s=(n=y).isiOS()&&!0===/ipad/i.test(r),l=n.isiOS()&&!s,u=n.isiOS()||n.isAndroid(),c=u||a("(pointer:coarse)"),d=s||!l&&u&&a("(min-device-width:768px)"),f=l||u&&!d,h=i.isSafari()&&n.isiOS()&&!1===/safari/i.test(r),g=!f&&!d&&!h,{isiPad:o(s),isiPhone:o(l),isTablet:o(d),isPhone:o(f),isTouch:o(c),isAndroid:n.isAndroid,isiOS:n.isiOS,isWebView:o(h),isDesktop:o(g)})}}(e.navigator.userAgent,Dn)})),wn=function(){return On()},Rn=function(e,t){var n=e.dom();if(1!==n.nodeType)return!1;var o=n;if(void 0!==o.matches)return o.matches(t);if(void 0!==o.msMatchesSelector)return o.msMatchesSelector(t);if(void 0!==o.webkitMatchesSelector)return o.webkitMatchesSelector(t);if(void 0!==o.mozMatchesSelector)return o.mozMatchesSelector(t);throw new Error("Browser lacks native selectors")},Sn=function(e){return 1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType||0===e.childElementCount},kn=function(e,t){return e.dom()===t.dom()},An=function(t,n){return wn().browser.isIE()?function(t,n){return o=t.dom(),i=n.dom(),r=e.Node.DOCUMENT_POSITION_CONTAINED_BY,0!=(o.compareDocumentPosition(i)&r);var o,i,r}(t,n):(o=n,(i=t.dom())!==(r=o.dom())&&i.contains(r));var o,i,r},Nn=function(e){return k(e)?e:o(!1)},Mn=function(e,t,n){for(var o=e.dom(),i=Nn(n);o.parentNode;){var r=en(o=o.parentNode),a=t(r);if(a.isSome())return a;if(i(r))break}return E.none()},Kn=function(e,t,n){var o=t(e),i=Nn(n);return o.orThunk((function(){return i(e)?E.none():Mn(e,t,i)}))},Pn=function(e,t){return kn(e.element(),t.event().target())},Ln=function(e){if(!Re(e,"can")&&!Re(e,"abort")&&!Re(e,"run"))throw new Error("EventHandler defined by: "+JSON.stringify(e,null,2)+" does not have can, abort, or run!");return ht("Extracting event.handler",Qe([zt("can",o(!0)),zt("abort",o(!1)),zt("run",t)]),e)},Bn=o("touchstart"),Fn=o("touchmove"),zn=o("touchend"),Vn=o("touchcancel"),Hn=o("mousedown"),Wn=o("mousemove"),$n=o("mouseout"),Un=o("mouseup"),qn=o("mouseover"),jn=o("focusin"),Gn=o("focusout"),Xn=o("keydown"),Yn=o("keyup"),Zn=o("input"),Jn=o("change"),Qn=o("click"),eo=o("transitionend"),to=o("selectstart"),no={tap:o("alloy.tap")},oo=o("alloy.focus"),io=o("alloy.blur.post"),ro=o("alloy.paste.post"),ao=o("alloy.receive"),so=o("alloy.execute"),lo=o("alloy.focus.item"),uo=no.tap,co=o("alloy.longpress"),fo=o("alloy.sandbox.close"),ho=o("alloy.typeahead.cancel"),go=o("alloy.system.init"),mo=o("alloy.system.touchmove"),po=o("alloy.system.touchend"),vo=o("alloy.system.scroll"),yo=o("alloy.system.resize"),bo=o("alloy.system.attached"),Co=o("alloy.system.detached"),To=o("alloy.system.dismissRequested"),xo=o("alloy.system.repositionRequested"),Eo=o("alloy.focusmanager.shifted"),_o=o("alloy.slotcontainer.visibility"),Io=o("alloy.change.tab"),Do=o("alloy.dismiss.tab"),Oo=o("alloy.highlight"),wo=o("alloy.dehighlight"),Ro=function(e,t){No(e,e.element(),t,{})},So=function(e,t,n){No(e,e.element(),t,n)},ko=function(e){Ro(e,so())},Ao=function(e,t,n){No(e,t,n,{})},No=function(e,t,n,i){var r=f({target:t},i);e.getSystem().triggerEvent(n,t,xe(r,o))},Mo=function(e,t,n,o){e.getSystem().triggerEvent(n,t,o.event())},Ko=function(e){return Ue(e)},Po=function(e,t){return{key:e,value:Ln({abort:t})}},Lo=function(e){return{key:e,value:Ln({run:function(e,t){t.event().prevent()}})}},Bo=function(e,t){return{key:e,value:Ln({run:t})}},Fo=function(e,t,n){return{key:e,value:Ln({run:function(e,o){t.apply(void 0,[e,o].concat(n))}})}},zo=function(e){return function(t){return{key:e,value:Ln({run:function(e,n){Pn(e,n)&&t(e,n)}})}}},Vo=function(e,t,n){var o,i;return i=t.partUids[n],Bo(o=e,(function(e,t){e.getSystem().getByUid(i).each((function(e){Mo(e,e.element(),o,t)}))}))},Ho=function(e,t){return Bo(e,(function(e,n){var i=n.event(),r=e.getSystem().getByDom(i.target()).fold((function(){return Kn(i.target(),(function(t){return e.getSystem().getByDom(t).toOption()}),o(!1)).getOr(e)}),(function(e){return e}));t(e,r,n)}))},Wo=function(e){return Bo(e,(function(e,t){t.cut()}))},$o=function(e,t){return zo(e)(t)},Uo=zo(bo()),qo=zo(Co()),jo=zo(go()),Go=(ce=so(),function(e){return Bo(ce,e)}),Xo=(void 0!==e.window||Function("return this;")(),function(e){return e.dom().nodeName.toLowerCase()}),Yo=function(e){return function(t){return t.dom().nodeType===e}},Zo=Yo(1),Jo=Yo(3),Qo=Yo(9),ei=Yo(11),ti=function(e){return en(e.dom().ownerDocument)},ni=function(e){return Qo(e)?e:ti(e)},oi=function(e){return en(e.dom().ownerDocument.documentElement)},ii=function(e){return en(e.dom().ownerDocument.defaultView)},ri=function(e){return E.from(e.dom().parentNode).map(en)},ai=function(e){return E.from(e.dom().offsetParent).map(en)},si=function(e){return H(e.dom().childNodes,en)},li=function(e,t){var n=e.dom().childNodes;return E.from(n[t]).map(en)},ui=function(e,t){ri(e).each((function(n){n.dom().insertBefore(t.dom(),e.dom())}))},ci=function(e,t){var n;(n=e,E.from(n.dom().nextSibling).map(en)).fold((function(){ri(e).each((function(e){fi(e,t)}))}),(function(e){ui(e,t)}))},di=function(e,t){li(e,0).fold((function(){fi(e,t)}),(function(n){e.dom().insertBefore(t.dom(),n.dom())}))},fi=function(e,t){e.dom().appendChild(t.dom())},hi=function(e,t){W(t,(function(t){fi(e,t)}))},gi=function(e){e.dom().textContent="",W(si(e),(function(e){mi(e)}))},mi=function(e){var t=e.dom();null!==t.parentNode&&t.parentNode.removeChild(t)},pi=function(e){var t,n=si(e);0<n.length&&(t=e,W(n,(function(e){ui(t,e)}))),mi(e)},vi=function(e){return e.dom().innerHTML},yi=function(t,n){var o,i,r=ti(t).dom(),a=en(r.createDocumentFragment()),s=(o=n,(i=(r||e.document).createElement("div")).innerHTML=o,si(en(i)));hi(a,s),gi(t),fi(t,a)},bi=function(t,n,o){if(!(D(o)||R(o)||A(o)))throw e.console.error("Invalid call to Attr.set. Key ",n,":: Value ",o,":: Element ",t),new Error("Attribute value was not simple");t.setAttribute(n,o+"")},Ci=function(e,t,n){bi(e.dom(),t,n)},Ti=function(e,t){var n=e.dom().getAttribute(t);return null===n?void 0:n},xi=function(e,t){return E.from(Ti(e,t))},Ei=function(e,t){var n=e.dom();return!(!n||!n.hasAttribute)&&n.hasAttribute(t)},_i=function(e,t){e.dom().removeAttribute(t)},Ii=function(e){return function(e){var t,n,o;return t=function(e){return en(e.dom().cloneNode(!1))}(e),n=Jt("div"),o=en(t.dom().cloneNode(!0)),fi(n,o),vi(n)}(e)},Di=Ko([{key:oo(),value:Ln({can:function(t,n){var o,i,r=n.event().originator(),a=n.event().target();return i=a,!(kn(o=r,t.element())&&!kn(o,i)&&(e.console.warn(oo()+" did not get interpreted by the desired target. \nOriginator: "+Ii(r)+"\nTarget: "+Ii(a)+"\nCheck the "+oo()+" event handlers"),1))}})}]),Oi=Object.freeze({__proto__:null,events:Di}),wi=0,Ri=function(e){var t=(new Date).getTime();return e+"_"+Math.floor(1e9*Math.random())+ ++wi+String(t)},Si=o("alloy-id-"),ki=o("data-alloy-id"),Ai=Si(),Ni=ki(),Mi=function(e,t){Object.defineProperty(e.dom(),Ni,{value:t,writable:!0})},Ki=function(e){var t=Zo(e)?e.dom()[Ni]:null;return E.from(t)},Pi=function(e){return Ri(e)},Li=i,Bi=function(e){var t=function(t){return function(){throw new Error("The component must be in a context to send: "+t+(e?"\n"+Ii(e().element())+" is not in context.":""))}};return{debugInfo:o("fake"),triggerEvent:t("triggerEvent"),triggerFocus:t("triggerFocus"),triggerEscape:t("triggerEscape"),build:t("build"),addToWorld:t("addToWorld"),removeFromWorld:t("removeFromWorld"),addToGui:t("addToGui"),removeFromGui:t("removeFromGui"),getByUid:t("getByUid"),getByDom:t("getByDom"),broadcast:t("broadcast"),broadcastOn:t("broadcastOn"),broadcastEvent:t("broadcastEvent"),isConnected:o(!1)}},Fi=Bi(),zi=function(e){return H(e,(function(e){return n=(t=e).length-"/*".length,t.length>="/*".length&&"/*"===t.substr(n,n+"/*".length)?e.substring(0,e.length-"/*".length):e;var t,n}))},Vi=function(e,t){var n=e.toString(),o=n.indexOf(")")+1,i=n.indexOf("("),r=n.substring(i+1,o-1).split(/,\s*/);return e.toFunctionAnnotation=function(){return{name:t,parameters:zi(r)}},e},Hi=Ri("alloy-premade"),Wi=function(e){return $e(Hi,e)},$i=function(e){return t=function(t){for(var n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];return e.apply(void 0,g([t.getApis(),t],n))},o=(n=e.toString()).indexOf(")")+1,i=n.indexOf("("),r=n.substring(i+1,o-1).split(/,\s*/),t.toFunctionAnnotation=function(){return{name:"OVERRIDE",parameters:zi(r.slice(1))}},t;var t,n,o,i,r},Ui={init:function(){return qi({readState:function(){return"No State required"}})}},qi=function(e){return e},ji=function(e,t){var n={};return Te(e,(function(e,o){Te(e,(function(e,i){var r=Oe(n,i).getOr([]);n[i]=r.concat([t(o,e)])}))})),n},Gi=function(e){return{classes:void 0!==e.classes?e.classes:[],attributes:void 0!==e.attributes?e.attributes:{},styles:void 0!==e.styles?e.styles:{}}},Xi=function(e){return e.cHandler},Yi=function(e,t){return{name:o(e),handler:o(t)}},Zi=function(e,t){var n=Ti(e,t);return void 0===n||""===n?[]:n.split(" ")},Ji=function(e){return void 0!==e.dom().classList},Qi=function(e,t){Ji(e)?e.dom().classList.add(t):function(e,t){return o=t,i=Zi(n=e,"class").concat([o]),Ci(n,"class",i.join(" ")),!0;var n,o,i}(e,t)},er=function(e,t){Ji(e)?e.dom().classList.remove(t):function(e,t){return i=t,0<(r=U(Zi(n=e,o="class"),(function(e){return e!==i}))).length?Ci(n,o,r.join(" ")):_i(n,o),!1;var n,o,i,r}(e,t),function(e){0===(Ji(e)?e.dom().classList:Zi(e,"class")).length&&_i(e,"class")}(e)},tr=function(e,t){return Ji(e)&&e.dom().classList.contains(t)},nr=function(e,t){W(t,(function(t){Qi(e,t)}))},or=function(e,t){W(t,(function(t){er(e,t)}))},ir=function(e){return void 0!==e.style&&k(e.style.getPropertyValue)},rr=function(e){return ei(e)},ar=k(e.Element.prototype.attachShadow)&&k(e.Node.prototype.getRootNode),sr=o(ar),lr=ar?function(e){return en(e.dom().getRootNode())}:ni,ur=function(e){return en(e.dom().host)},cr=function(e){var t,n,o,i,r=Jo(e)?e.dom().parentNode:e.dom();return null!=r&&null!==r.ownerDocument&&(o=en(r),i=lr(o),(rr(i)?E.some(i):E.none()).fold((function(){return r.ownerDocument.body.contains(r)}),(t=cr,n=ur,function(e){return t(n(e))})))},dr=function(){return fr(en(e.document))},fr=function(e){var t=e.dom().body;if(null==t)throw new Error("Body is not available yet");return en(t)},hr=function(t,n,o){if(!D(o))throw e.console.error("Invalid call to CSS.set. Property ",n,":: Value ",o,":: Element ",t),new Error("CSS value must be a string: "+o);ir(t)&&t.style.setProperty(n,o)},gr=function(e,t){ir(e)&&e.style.removeProperty(t)},mr=function(e,t,n){var o=e.dom();hr(o,t,n)},pr=function(e,t){var n=e.dom();Te(t,(function(e,t){hr(n,t,e)}))},vr=function(e,t){var n=e.dom();Te(t,(function(e,t){e.fold((function(){gr(n,t)}),(function(e){hr(n,t,e)}))}))},yr=function(t,n){var o=t.dom(),i=e.window.getComputedStyle(o).getPropertyValue(n);return""!==i||cr(t)?i:br(o,n)},br=function(e,t){return ir(e)?e.style.getPropertyValue(t):""},Cr=function(e,t){var n=e.dom(),o=br(n,t);return E.from(o).filter((function(e){return 0<e.length}))},Tr=function(e,t,n){var o=Jt(e);return mr(o,t,n),Cr(o,t).isSome()},xr=function(e,t){var n=e.dom();gr(n,t),xi(e,"style").map(Cn).is("")&&_i(e,"style")},Er=function(e){return e.dom().offsetWidth},_r=function(e){return e.dom().value},Ir=function(e,t){if(void 0===t)throw new Error("Value.set was undefined");e.dom().value=t},Dr=function(e){var t,n,i,r,a,s,l,u,c,d,g,m,p,v=Li(e),y=v.events,b=h(v,["events"]),C=(t=Oe(b,"components").getOr([]),H(t,Sr)),T=f(f({},b),{events:f(f({},Oi),y),components:C});return le.value((i=function(){return p},r=Xt(Fi),a=ft(function(e){return dt("custom.definition",et([rt("dom","dom",Be(),et([Dt("tag"),zt("styles",{}),zt("classes",[]),zt("attributes",{}),Mt("value"),Mt("innerHtml")])),Dt("components"),Dt("uid"),zt("events",{}),zt("apis",{}),rt("eventOrder","eventOrder",Pe.mergeWithThunk(o({"alloy.execute":["disabling","alloy.base.behaviour","toggling","typeaheadevents"],"alloy.focus":["alloy.base.behaviour","focusing","keying"],"alloy.system.init":["alloy.base.behaviour","disabling","toggling","representing"],input:["alloy.base.behaviour","representing","streaming","invalidating"],"alloy.system.detached":["alloy.base.behaviour","representing","item-events","tooltipping"],mousedown:["focusing","alloy.base.behaviour","item-type-events"],touchstart:["focusing","alloy.base.behaviour","item-type-events"],mouseover:["item-type-events","tooltipping"],"alloy.receive":["receiving","reflecting","tooltipping"]})),vt()),Mt("domModification")]),e)}(n=T)),s=function(e){var t,n;return function(e,t){return n=e,i=H(o=t,(function(e){return Ft(e.name(),[Dt("config"),zt("state",Ui)])})),r=dt("component.behaviours",et(i),n.behaviours).fold((function(e){throw new Error(gt(e)+"\nComplete spec:\n"+JSON.stringify(n,null,2))}),(function(e){return e})),{list:o,data:xe(r,(function(e){var t=e.map((function(e){return{config:e.config,state:e.state.init(e.config)}}));return function(){return t}}))};var n,o,i,r}(e,(t=Oe(e,"behaviours").getOr({}),n=U(be(t),(function(e){return void 0!==t[e]})),H(n,(function(e){return t[e].me}))))}(n),c=function(e,t,n){var o,i,r,a=f(f({},(o=e).dom),{uid:o.uid,domChildren:H(o.components,(function(e){return e.element()}))}),s=e.domModification.fold((function(){return Gi({})}),Gi);return r=0<t.length?function(e,t,n,o){var i=f({},t);W(n,(function(t){i[t.name()]=t.exhibit(e,o)}));var r=ji(i,(function(e,t){return{name:e,modification:t}})),a=function(e){return q(e,(function(e,t){return f(f({},t.modification),e)}),{})},s=q(r.classes,(function(e,t){return t.modification.concat(e)}),[]),l=a(r.attributes),u=a(r.styles);return Gi({classes:s,attributes:l,styles:u})}(n,{"alloy.base.modification":s},t,a):s,f(f({},i=a),{attributes:f(f({},i.attributes),r.attributes),styles:f(f({},i.styles),r.styles),classes:i.classes.concat(r.classes)})}(a,l=s.list,u=s.data),d=function(e){var t,n,o=Jt(e.tag);return t=e.attributes,n=o.dom(),Te(t,(function(e,t){bi(n,t,e)})),nr(o,e.classes),pr(o,e.styles),e.innerHtml.each((function(e){return yi(o,e)})),hi(o,e.domChildren),e.value.each((function(e){Ir(o,e)})),Mi(o,e.uid),o}(c),g=function(e,t,n){var i;return i=e.eventOrder,function(e,t){return function(e,t){var n,o,i,r,a=(n=[],o=[],W(e,(function(e){e.fold((function(e){n.push(e)}),(function(e){o.push(e)}))})),{errors:n,values:o});return 0<a.errors.length?le.error(Y(a.errors)):(r={},0===(i=a.values).length?le.value(r):le.value(Ne(r,Me.apply(void 0,i))))}(_e(e,(function(e,n){return(1===e.length?le.value(e[0].handler()):function(e,t,n){var o=t[n];return o?function(e,t,o,i){try{var r=te(o,(function(n,o){var r=n[t](),a=o[t](),s=i.indexOf(r),l=i.indexOf(a);if(-1===s)throw new Error("The ordering for "+e+" does not have an entry for "+r+".\nOrder specified: "+JSON.stringify(i,null,2));if(-1===l)throw new Error("The ordering for "+e+" does not have an entry for "+a+".\nOrder specified: "+JSON.stringify(i,null,2));return s<l?-1:l<s?1:0}));return le.value(r)}catch(n){return le.error([n])}}("Event: "+n,"name",e,o).map((function(e){return function(e){var t,n,o,i,r=(n=function(e){return e.can},function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];return j(t,(function(t,o){return t&&n(o).apply(void 0,e)}),!0)}),a=(o=t=e,i=function(e){return e.abort},function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return j(o,(function(t,n){return t||i(n).apply(void 0,e)}),!1)});return Ln({can:r,abort:a,run:function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];W(e,(function(e){e.run.apply(void 0,t)}))}})}(H(e,(function(e){return e.handler()})))})):le.error(["The event ("+n+') has more than one behaviour that listens to it.\nWhen this occurs, you must specify an event ordering for the behaviours in your spec (e.g. [ "listing", "toggling" ]).\nThe behaviours that can trigger it are: '+JSON.stringify(H(e,(function(e){return e.name()})),null,2)])}(e,t,n)).map((function(i){var r=function(e){var t,n=k(t=e)?{can:o(!0),abort:o(!1),run:t}:t;return function(e,t){for(var o=[],i=2;i<arguments.length;i++)o[i-2]=arguments[i];var r=[e,t].concat(o);n.abort.apply(void 0,r)?t.stop():n.can.apply(void 0,r)&&n.run.apply(void 0,r)}}(i),a=1<e.length?U(t[n],(function(t){return F(e,(function(e){return e.name()===t}))})).join(" > "):e[0].name();return $e(n,{handler:r,purpose:o(a)})}))})))}(function(e,t,n){var o,i,r=f(f({},n),(o=e,i={},W(t,(function(e){i[e.name()]=e.handlers(o)})),i));return ji(r,Yi)}(n,t,{"alloy.base.behaviour":e.events}),i).getOrDie()}(a,l,u),m=Xt(a.components),p={getSystem:r.get,config:function(e){var t=u;return(k(t[e.name()])?t[e.name()]:function(){throw new Error("Could not find "+e.name()+" in "+JSON.stringify(n,null,2))})()},hasConfigured:function(e){return k(u[e.name()])},spec:o(n),readState:function(e){return u[e]().map((function(e){return e.state.readState()})).getOr("not enabled")},getApis:function(){return a.apis},connect:function(e){r.set(e)},disconnect:function(){r.set(Bi(i))},element:o(d),syncComponents:function(){var e=si(d),t=Z(e,(function(e){return r.get().getByDom(e).fold((function(){return[]}),(function(e){return[e]}))}));m.set(t)},components:m.get,events:o(g)}))},Or=function(e){var t=Qt(e);return wr({element:t})},wr=function(e){var n=ht("external.component",Qe([Dt("element"),Mt("uid")]),e),i=Xt(Bi());n.uid.each((function(e){Mi(n.element,e)}));var r={getSystem:i.get,config:E.none,hasConfigured:o(!1),connect:function(e){i.set(e)},disconnect:function(){i.set(Bi((function(){return r})))},getApis:function(){return{}},element:o(n.element),spec:o(e),readState:o("No state"),syncComponents:t,components:o([]),events:o({})};return Wi(r)},Rr=Pi,Sr=function(e){return Oe(e,Hi).fold((function(){var t=e.hasOwnProperty("uid")?e:f({uid:Rr("")},e);return Dr(t).getOrDie()}),(function(e){return e}))},kr=Wi;function Ar(e,t){var n=function(n){var o=t(n);if(o<=0||null===o){var i=yr(n,e);return parseFloat(i)||0}return o},o=function(e,t){return j(t,(function(t,n){var o=yr(e,n),i=void 0===o?0:parseInt(o,10);return isNaN(i)?t:t+i}),0)};return{set:function(t,n){if(!A(n)&&!n.match(/^[0-9]+$/))throw new Error(e+".set accepts only positive integer values. Value was "+n);var o=t.dom();ir(o)&&(o.style[e]=n+"px")},get:n,getOuter:n,aggregate:o,max:function(e,t,n){var i=o(e,n);return i<t?t-i:0}}}var Nr=Ar("height",(function(e){var t=e.dom();return cr(e)?t.getBoundingClientRect().height:t.offsetHeight})),Mr=function(e){return Nr.get(e)},Kr=function(e){return Nr.getOuter(e)},Pr=function(e,t){return{left:o(e),top:o(t),translate:function(n,o){return Pr(e+n,t+o)}}},Lr=Pr,Br=function(e,t){return void 0!==e?e:void 0!==t?t:0},Fr=function(e){var t=e.dom().ownerDocument,n=t.body,o=t.defaultView,i=t.documentElement;if(n===e.dom())return Lr(n.offsetLeft,n.offsetTop);var r=Br(o.pageYOffset,i.scrollTop),a=Br(o.pageXOffset,i.scrollLeft),s=Br(i.clientTop,n.clientTop),l=Br(i.clientLeft,n.clientLeft);return zr(e).translate(a-l,r-s)},zr=function(e){var t,n=e.dom(),o=n.ownerDocument.body;return o===n?Lr(o.offsetLeft,o.offsetTop):cr(e)?(t=n.getBoundingClientRect(),Lr(t.left,t.top)):Lr(0,0)},Vr=Ar("width",(function(e){return e.dom().offsetWidth})),Hr=function(e){return Vr.get(e)},Wr=function(e){return Vr.getOuter(e)},$r=function(e){var t,i,r,a,s,l,u=en(function(e){if(sr()&&S(e.target)){var t=en(e.target);if(Zo(t)&&function(e){return S(e.dom().shadowRoot)}(en(e.target))&&e.composed&&e.composedPath){var n=e.composedPath();if(n)return ne(n)}}return E.from(e.target)}(e).getOr(e.target)),c=function(){return e.stopPropagation()},d=function(){return e.preventDefault()},f=n(d,c);return t=e.clientX,i=e.clientY,r=c,a=d,s=f,l=e,{target:o(u),x:o(t),y:o(i),stop:r,prevent:a,kill:s,raw:o(l)}},Ur=function(e,t,n,o,i){var r,s,l=(r=n,s=o,function(e){r(e)&&s($r(e))});return e.dom().addEventListener(t,l,i),{unbind:a(qr,e,t,l,i)}},qr=function(e,t,n,o){e.dom().removeEventListener(t,n,o)},jr=function(t){var n=void 0!==t?t.dom():e.document;return Lr(n.body.scrollLeft||n.documentElement.scrollLeft,n.body.scrollTop||n.documentElement.scrollTop)},Gr=function(t,n,o){(void 0!==o?o.dom():e.document).defaultView.scrollTo(t,n)},Xr=function(e,t,n,o){return{x:e,y:t,width:n,height:o,right:e+n,bottom:t+o}},Yr=function(t){var n,o,i=void 0===t?e.window:t,r=jr(en(i.document));return o=void 0===(n=i)?e.window:n,E.from(o.visualViewport).fold((function(){var e=i.document.documentElement,t=e.clientWidth,n=e.clientHeight;return Xr(r.left(),r.top(),t,n)}),(function(e){return Xr(Math.max(e.pageLeft,r.left()),Math.max(e.pageTop,r.top()),e.width,e.height)}))},Zr=function(e,t){return e.view(t).fold(o([]),(function(t){var n=e.owner(t),o=Zr(e,n);return[t].concat(o)}))},Jr=Object.freeze({__proto__:null,view:function(t){return(t.dom()===e.document?E.none():E.from(t.dom().defaultView.frameElement)).map(en)},owner:function(e){return ti(e)}}),Qr=function(t){var n,o,i,r,s=en(e.document),l=jr(s);return(n=t,i=(o=Jr).owner(n),r=Zr(o,i),E.some(r)).fold(a(Fr,t),(function(e){var n=zr(t),o=q(e,(function(e,t){var n=zr(t);return{left:e.left+n.left(),top:e.top+n.top()}}),{left:0,top:0});return Lr(o.left+n.left()+l.left(),o.top+n.top()+l.top())}))},ea=function(e,t,n,o){return{x:e,y:t,width:n,height:o,right:e+n,bottom:t+o}},ta=function(e){var t=Fr(e),n=Wr(e),o=Kr(e);return ea(t.left(),t.top(),n,o)},na=function(e){var t=Qr(e),n=Wr(e),o=Kr(e);return ea(t.left(),t.top(),n,o)},oa=function(){return Yr(e.window)};function ia(e,t,n,o,i){return e(n,o)?E.some(n):k(i)&&i(n)?E.none():t(n,o,i)}var ra,aa,sa=function(e,t,n){for(var i=e.dom(),r=k(n)?n:o(!1);i.parentNode;){var a=en(i=i.parentNode);if(t(a))return E.some(a);if(r(a))break}return E.none()},la=function(e,t,n){return ia((function(e,t){return t(e)}),sa,e,t,n)},ua=function(e,t,n){return la(e,t,n).isSome()},ca=function(e,t,n){return sa(e,(function(e){return Rn(e,t)}),n)},da=function(t,n){return o=n,r=void 0===(i=t)?e.document:i.dom(),Sn(r)?E.none():E.from(r.querySelector(o)).map(en);var o,i,r},fa=function(e,t,n){return ia((function(e,t){return Rn(e,t)}),ca,e,t,n)},ha=function(){var e=Ri("aria-owns");return{id:e,link:function(t){Ci(t,"aria-owns",e)},unlink:function(e){_i(e,"aria-owns")}}},ga=function(e,t){return ua(t,(function(t){return kn(t,e.element())}),o(!1))||function(e,t){return la(t,(function(e){if(!Zo(e))return!1;var t=Ti(e,"id");return void 0!==t&&-1<t.indexOf("aria-owns")})).bind((function(e){var t=Ti(e,"id"),n=ti(e);return da(n,'[aria-owns="'+t+'"]')})).exists((function(t){return ga(e,t)}))}(e,t)};(aa=ra=ra||{})[aa.STOP=0]="STOP",aa[aa.NORMAL=1]="NORMAL",aa[aa.LOGGING=2]="LOGGING";var ma,pa,va=Xt({}),ya=["alloy/data/Fields","alloy/debugging/Debugging"],ba=function(t,n,o){return function(t,n,o){var i,r,a,s;switch(Oe(va.get(),t).orThunk((function(){var e=be(va.get());return re(e,(function(e){return-1<t.indexOf(e)?E.some(va.get()[e]):E.none()}))})).getOr(ra.NORMAL)){case ra.NORMAL:return o(Ca());case ra.LOGGING:var l=(i=t,r=n,a=[],s=(new Date).getTime(),{logEventCut:function(e,t,n){a.push({outcome:"cut",target:t,purpose:n})},logEventStopped:function(e,t,n){a.push({outcome:"stopped",target:t,purpose:n})},logNoParent:function(e,t,n){a.push({outcome:"no-parent",target:t,purpose:n})},logEventNoHandlers:function(e,t){a.push({outcome:"no-handlers-left",target:t})},logEventResponse:function(e,t,n){a.push({outcome:"response",purpose:n,target:t})},write:function(){var t=(new Date).getTime();B(["mousemove","mouseover","mouseout",go()],i)||e.console.log(i,{event:i,time:t-s,target:r.dom(),sequence:H(a,(function(e){return B(["cut","stopped","response"],e.outcome)?"{"+e.purpose+"} "+e.outcome+" at ("+Ii(e.target)+")":e.outcome}))})}}),u=o(l);return l.write(),u;case ra.STOP:return!0}}(t,n,o)},Ca=o({logEventCut:t,logEventStopped:t,logNoParent:t,logEventNoHandlers:t,logEventResponse:t,write:t}),Ta=o([Dt("menu"),Dt("selectedMenu")]),xa=o([Dt("item"),Dt("selectedItem")]),Ea=(o(et(xa().concat(Ta()))),o(et(xa()))),_a=kt("initSize",[Dt("numColumns"),Dt("numRows")]),Ia=function(){return kt("markers",[Dt("backgroundMenu")].concat(Ta()).concat(xa()))},Da=function(e){return kt("markers",H(e,Dt))},Oa=function(e,t,n){return function(){var e=new Error;if(void 0!==e.stack){var t=e.stack.split("\n");G(t,(function(e){return 0<e.indexOf("alloy")&&!F(ya,(function(t){return-1<e.indexOf(t)}))})).getOr("unknown")}}(),rt(t,t,n,ut((function(e){return le.value((function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return e.apply(void 0,t)}))})))},wa=function(e){return Oa(0,e,Le(t))},Ra=function(e){return Oa(0,e,Le(E.none))},Sa=function(e){return Oa(0,e,Be())},ka=function(e){return Oa(0,e,Be())},Aa=function(e,t){return Gt(e,o(t))},Na=function(e){return Gt(e,i)},Ma=o(_a),Ka=function(e,t,n,i,r,a){return{x:o(e),y:o(t),bubble:o(n),direction:o(i),boundsRestriction:o(r),label:o(a)}},Pa=Se([{southeast:[]},{southwest:[]},{northeast:[]},{northwest:[]},{south:[]},{north:[]},{east:[]},{west:[]}]),La=Pa.southeast,Ba=Pa.southwest,Fa=Pa.northeast,za=Pa.northwest,Va=Pa.south,Ha=Pa.north,Wa=Pa.east,$a=Pa.west,Ua=function(e,t){return function(e,t){for(var n={},o=0,i=e.length;o<i;o++){var r=e[o];n[String(r)]=t(r)}return n}(["left","right","top","bottom"],(function(n){return Oe(t,n).map((function(t){return function(e,t){switch(t){case 1:return e.x;case 0:return e.x+e.width;case 2:return e.y;case 3:return e.y+e.height}}(e,t)}))}))},qa=function(e){return e.x},ja=function(e,t){return e.x+e.width/2-t.width/2},Ga=function(e,t){return e.x+e.width-t.width},Xa=function(e,t){return e.y-t.height},Ya=function(e){return e.y+e.height},Za=function(e,t){return e.y+e.height/2-t.height/2},Ja=function(e,t,n){return Ka(qa(e),Ya(e),n.southeast(),La(),Ua(e,{left:1,top:3}),"layout-se")},Qa=function(e,t,n){return Ka(Ga(e,t),Ya(e),n.southwest(),Ba(),Ua(e,{right:0,top:3}),"layout-sw")},es=function(e,t,n){return Ka(qa(e),Xa(e,t),n.northeast(),Fa(),Ua(e,{left:1,bottom:2}),"layout-ne")},ts=function(e,t,n){return Ka(Ga(e,t),Xa(e,t),n.northwest(),za(),Ua(e,{right:0,bottom:2}),"layout-nw")},ns=function(e,t,n){return Ka(ja(e,t),Xa(e,t),n.north(),Ha(),Ua(e,{bottom:2}),"layout-n")},os=function(e,t,n){return Ka(ja(e,t),Ya(e),n.south(),Va(),Ua(e,{top:3}),"layout-s")},is=function(e,t,n){return Ka((o=e).x+o.width,Za(e,t),n.east(),Wa(),Ua(e,{left:0}),"layout-e");var o},rs=function(e,t,n){return Ka(e.x-t.width,Za(e,t),n.west(),$a(),Ua(e,{right:1}),"layout-w")},as=function(){return[Ja,Qa,es,ts,os,ns,is,rs]},ss=function(){return[Qa,Ja,ts,es,os,ns,is,rs]},ls=function(){return[es,ts,Ja,Qa,ns,os]},us=function(){return[Ja,Qa,es,ts,os,ns]},cs=function(){return[Qa,Ja,ts,es,os,ns]},ds=function(e,t,n){return jo((function(o,i){n(o,e,t)}))},fs=function(e){return{key:e,value:void 0}},hs=function(e,t,n,i,r,s,l){var u=function(e){return Re(e,n)?e[n]():E.none()},c=xe(r,(function(e,t){return function(e,t,n){var i,r,a,s,l,u;return i=function(i){for(var r=[],a=1;a<arguments.length;a++)r[a-1]=arguments[a];var s=[i].concat(r);return i.config({name:o(e)}).fold((function(){throw new Error("We could not find any behaviour configuration for: "+e+". Using API: "+n)}),(function(e){var n=Array.prototype.slice.call(s,1);return t.apply(void 0,[i,e.config,e.state].concat(n))}))},r=n,s=(a=t.toString()).indexOf(")")+1,l=a.indexOf("("),u=a.substring(l+1,s-1).split(/,\s*/),i.toFunctionAnnotation=function(){return{name:r,parameters:zi(u.slice(0,1).concat(u.slice(3)))}},i}(n,e,t)})),d=xe(s,(function(e,t){return Vi(e,t)})),h=f(f(f({},d),c),{revoke:a(fs,n),config:function(t){var o=ht(n+"-config",e,t);return{key:n,value:{config:o,me:h,configAsRaw:Ke((function(){return ht(n+"-config",e,t)})),initialConfig:t,state:l}}},schema:function(){return t},exhibit:function(e,t){return u(e).bind((function(e){return Oe(i,"exhibit").map((function(n){return n(t,e.config,e.state)}))})).getOr(Gi({}))},name:function(){return n},handlers:function(e){return u(e).map((function(e){return Oe(i,"events").getOr((function(){return{}}))(e.config,e.state)})).getOr({})}});return h},gs=function(e){return Ue(e)},ms=Qe([Dt("fields"),Dt("name"),zt("active",{}),zt("apis",{}),zt("state",Ui),zt("extra",{})]),ps=function(e){var t=ht("Creating behaviour: "+e.name,ms,e);return function(e,t,n,o,i,r){var a=Qe(e),s=Ft(t,[Kt("config",Qe(e))]);return hs(a,s,t,n,o,i,r)}(t.fields,t.name,t.active,t.apis,t.extra,t.state)},vs=Qe([Dt("branchKey"),Dt("branches"),Dt("name"),zt("active",{}),zt("apis",{}),zt("state",Ui),zt("extra",{})]),ys=function(e){var t,n,o,i,r,a,s,l,u=ht("Creating behaviour: "+e.name,vs,e);return t=pt(u.branchKey,u.branches),o=u.active,i=u.apis,r=u.extra,a=u.state,l=Ft(n=u.name,[Kt("config",s=t)]),hs(s,l,n,o,i,r,a)},bs=o(void 0),Cs=Object.freeze({__proto__:null,events:function(e){return Ko([Bo(ao(),(function(t,n){var o,i,r=e.channels,a=be(r),s=n,l=(o=a,(i=s).universal()?o:U(o,(function(e){return B(i.channels(),e)})));W(l,(function(e){var n=r[e],o=n.schema,i=ht("channel["+e+"] data\nReceiver: "+Ii(t.element()),o,s.data());n.onReceive(t,i)}))}))])}}),Ts=[Ot("channels",ct(le.value,Qe([Sa("onReceive"),zt("schema",vt())])))],xs=ps({fields:Ts,name:"receiving",active:Cs}),Es=Object.freeze({__proto__:null,exhibit:function(e,t){return Gi({classes:[],styles:t.useFixed()?{}:{position:"relative"}})}}),_s=function(e){return e.dom().focus()},Is=function(t){return void 0===t&&(t=en(e.document)),E.from(t.dom().activeElement).map(en)},Ds=function(e){return Is(lr(e)).filter((function(t){return e.dom().contains(t.dom())}))},Os=function(e,n){var o=ti(n),i=Is(o).bind((function(e){var t,o,i=function(t){return kn(e,t)};return i(n)?E.some(n):(t=i,(o=function(e){for(var n=0;n<e.childNodes.length;n++){var i=en(e.childNodes[n]);if(t(i))return E.some(i);var r=o(e.childNodes[n]);if(r.isSome())return r}return E.none()})(n.dom()))})),r=e(n);return i.each((function(e){Is(o).filter((function(t){return kn(t,e)})).fold((function(){_s(e)}),t)})),r},ws=function(e,t,n,i,r){return{position:o(e),left:o(t),top:o(n),right:o(i),bottom:o(r)}},Rs=function(e,t){var n=function(e){return e+"px"};vr(e,{position:E.some(t.position()),left:t.left().map(n),top:t.top().map(n),right:t.right().map(n),bottom:t.bottom().map(n)})},Ss=Se([{none:[]},{relative:["x","y","width","height"]},{fixed:["x","y","width","height"]}]),ks=function(e,t,n,o,i,r){var a=t.x-n,s=t.y-o,l=i-(a+t.width),u=r-(s+t.height),c=E.some(a),d=E.some(s),f=E.some(l),h=E.some(u),g=E.none();return t.direction.fold((function(){return ws(e,c,d,g,g)}),(function(){return ws(e,g,d,f,g)}),(function(){return ws(e,c,g,g,h)}),(function(){return ws(e,g,g,f,h)}),(function(){return ws(e,c,d,g,g)}),(function(){return ws(e,c,g,g,h)}),(function(){return ws(e,c,d,g,g)}),(function(){return ws(e,g,d,f,g)}))},As=function(e,t){var n=a(Qr,t),o=e.fold(n,n,(function(){var e=jr();return Qr(t).translate(-e.left(),-e.top())})),i=Wr(t),r=Kr(t);return ea(o.left(),o.top(),i,r)},Ns=function(e,t,n){var i=Lr(t,n);return e.fold(o(i),o(i),(function(){var e=jr();return i.translate(-e.left(),-e.top())}))},Ms=Ss.relative,Ks=Ss.fixed,Ps=function(e,t,n,o){var i=e+t;return o<i?n:i<n?o:i},Ls=function(e,t,n){return Math.min(Math.max(e,t),n)},Bs=Se([{fit:["reposition"]},{nofit:["reposition","deltaW","deltaH"]}]),Fs=function(e,t){var n,o,i;n=e,o=Math.floor(t),i=Nr.max(n,o,["margin-top","border-top-width","padding-top","padding-bottom","border-bottom-width","margin-bottom"]),mr(n,"max-height",i+"px")},zs=o((function(e,t){Fs(e,t),pr(e,{"overflow-x":"hidden","overflow-y":"auto"})})),Vs=o((function(e,t){Fs(e,t)})),Hs=function(e,t,n){return void 0===e[t]?n:e[t]},Ws=["valignCentre","alignLeft","alignRight","alignCentre","top","bottom","left","right"],$s=function(e,t,n){var o=function(e){return Oe(n,e).getOr([])},i=function(e,t,n){var i=ee(Ws,n);return{offset:function(){return Lr(e,t)},classesOn:function(){return Z(n,o)},classesOff:function(){return Z(i,o)}}};return{southeast:function(){return i(-e,t,["top","alignLeft"])},southwest:function(){return i(e,t,["top","alignRight"])},south:function(){return i(-e/2,t,["top","alignCentre"])},northeast:function(){return i(-e,-t,["bottom","alignLeft"])},northwest:function(){return i(e,-t,["bottom","alignRight"])},north:function(){return i(-e/2,-t,["bottom","alignCentre"])},east:function(){return i(e,-t/2,["valignCentre","left"])},west:function(){return i(-e,-t/2,["valignCentre","right"])},innerNorthwest:function(){return i(-e,t,["top","alignRight"])},innerNortheast:function(){return i(e,t,["top","alignLeft"])},innerNorth:function(){return i(-e/2,t,["top","alignCentre"])},innerSouthwest:function(){return i(-e,-t,["bottom","alignRight"])},innerSoutheast:function(){return i(e,-t,["bottom","alignLeft"])},innerSouth:function(){return i(-e/2,-t,["bottom","alignCentre"])},innerWest:function(){return i(e,-t/2,["valignCentre","right"])},innerEast:function(){return i(-e,-t/2,["valignCentre","left"])}}},Us=function(){return $s(0,0,{})},qs=function(e,t){return function(n){return"rtl"===js(n)?t:e}},js=function(e){return"rtl"===yr(e,"direction")?"rtl":"ltr"};(pa=ma=ma||{}).TopToBottom="toptobottom",pa.BottomToTop="bottomtotop";var Gs,Xs,Ys="data-alloy-vertical-dir",Zs=function(e){return ua(e,(function(e){return Zo(e)&&Ti(e,Ys)===ma.BottomToTop}))},Js=function(){return Ft("layouts",[Dt("onLtr"),Dt("onRtl"),Mt("onBottomLtr"),Mt("onBottomRtl")])},Qs=function(e,t,n,o,i,r,a){var s=a.map(Zs).getOr(!1),l=t.layouts.map((function(t){return t.onLtr(e)})),u=t.layouts.map((function(t){return t.onRtl(e)})),c=s?t.layouts.bind((function(t){return t.onBottomLtr.map((function(t){return t(e)}))})).or(l).getOr(i):l.getOr(n),d=s?t.layouts.bind((function(t){return t.onBottomRtl.map((function(t){return t(e)}))})).or(u).getOr(r):u.getOr(o);return qs(c,d)(e)},el=[Dt("hotspot"),Mt("bubble"),zt("overrides",{}),Js(),Aa("placement",(function(e,t,n){var o=As(n,t.hotspot.element()),i=Qs(e.element(),t,us(),cs(),ls(),[ts,es,Qa,Ja,ns,os],E.some(t.hotspot.element()));return E.some({anchorBox:o,bubble:t.bubble.getOr(Us()),overrides:t.overrides,layouts:i,placer:E.none()})}))],tl=[Dt("x"),Dt("y"),zt("height",0),zt("width",0),zt("bubble",Us()),zt("overrides",{}),Js(),Aa("placement",(function(e,t,n){var o=Ns(n,t.x,t.y),i=ea(o.left(),o.top(),t.width,t.height),r=Qs(e.element(),t,as(),ss(),as(),ss(),E.none());return E.some({anchorBox:i,bubble:t.bubble,overrides:t.overrides,layouts:r,placer:E.none()})}))],nl=function(e,t,n,i){return{start:o(e),soffset:o(t),finish:o(n),foffset:o(i)}},ol=(Se([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),function(e){return e.fold(i,i,i)}),il=Se([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),rl={domRange:il.domRange,relative:il.relative,exact:il.exact,exactFromRange:function(e){return il.exact(e.start(),e.soffset(),e.finish(),e.foffset())},getWin:function(e){var t=e.match({domRange:function(e){return en(e.startContainer)},relative:function(e,t){return ol(e)},exact:function(e,t,n,o){return e}});return ii(t)},range:nl},al=function(e,t,n){var o,i,r=e.document.createRange();return o=r,t.fold((function(e){o.setStartBefore(e.dom())}),(function(e,t){o.setStart(e.dom(),t)}),(function(e){o.setStartAfter(e.dom())})),i=r,n.fold((function(e){i.setEndBefore(e.dom())}),(function(e,t){i.setEnd(e.dom(),t)}),(function(e){i.setEndAfter(e.dom())})),r},sl=function(e,t,n,o,i){var r=e.document.createRange();return r.setStart(t.dom(),n),r.setEnd(o.dom(),i),r},ll=function(e){return{left:o(e.left),top:o(e.top),right:o(e.right),bottom:o(e.bottom),width:o(e.width),height:o(e.height)}},ul=Se([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),cl=function(e,t,n){return t(en(n.startContainer),n.startOffset,en(n.endContainer),n.endOffset)},dl=function(e,t){var n=function(t){return e(t)?E.from(t.dom().nodeValue):E.none()};return{get:function(t){if(!e(t))throw new Error("Can only get text value of a text node");return n(t).getOr("")},getOption:n,set:function(t,n){if(!e(t))throw new Error("Can only set raw text value of a text node");t.dom().nodeValue=n}}}(Jo),fl=function(e){return dl.getOption(e)},hl=["img","br"],gl=function(e){return fl(e).filter((function(e){return 0!==e.trim().length||-1<e.indexOf(" ")})).isSome()||B(hl,Xo(e))},ml=function(t,n){return o=n,r=void 0===(i=t)?e.document:i.dom(),Sn(r)?[]:H(r.querySelectorAll(o),en);var o,i,r},pl=function(e){var t=en(e.anchorNode),n=en(e.focusNode);return function(e,t,n,o){var i,r,a,s,l,u=(r=t,a=n,s=o,(l=ti(i=e).dom().createRange()).setStart(i.dom(),r),l.setEnd(a.dom(),s),l),c=kn(e,n)&&t===o;return u.collapsed&&!c}(t,e.anchorOffset,n,e.focusOffset)?E.some(nl(t,e.anchorOffset,n,e.focusOffset)):function(e){if(0<e.rangeCount){var t=e.getRangeAt(0),n=e.getRangeAt(e.rangeCount-1);return E.some(nl(en(t.startContainer),t.startOffset,en(n.endContainer),n.endOffset))}return E.none()}(e)},vl=function(e,t){var n,i,r,a,s=function(e,t){var n,i,r,a=(n=e,t.match({domRange:function(e){return{ltr:o(e),rtl:E.none}},relative:function(e,t){return{ltr:Ke((function(){return al(n,e,t)})),rtl:Ke((function(){return E.some(al(n,t,e))}))}},exact:function(e,t,o,i){return{ltr:Ke((function(){return sl(n,e,t,o,i)})),rtl:Ke((function(){return E.some(sl(n,o,i,e,t))}))}}}));return(r=(i=a).ltr()).collapsed?i.rtl().filter((function(e){return!1===e.collapsed})).map((function(e){return ul.rtl(en(e.endContainer),e.endOffset,en(e.startContainer),e.startOffset)})).getOrThunk((function(){return cl(0,ul.ltr,r)})):cl(0,ul.ltr,r)}(n=e,t).match({ltr:function(e,t,o,i){var r=n.document.createRange();return r.setStart(e.dom(),t),r.setEnd(o.dom(),i),r},rtl:function(e,t,o,i){var r=n.document.createRange();return r.setStart(o.dom(),i),r.setEnd(e.dom(),t),r}});return 0<(a=0<(r=(i=s).getClientRects()).length?r[0]:i.getBoundingClientRect()).width||0<a.height?E.some(a).map(ll):E.none()},yl=function(e,t){return{element:e,offset:t}},bl=Se([{screen:["point"]},{absolute:["point","scrollLeft","scrollTop"]}]),Cl=function(e){return e.fold(i,(function(e,t,n){return e.translate(-t,-n)}))},Tl=function(e){return e.fold(i,i)},xl=function(e){return j(e,(function(e,t){return e.translate(t.left(),t.top())}),Lr(0,0))},El=function(e){var t=H(e,Tl);return xl(t)},_l=bl.screen,Il=bl.absolute,Dl=function(e,t,n){var o,i,r=ti(e.element()),a=jr(r),s=(o=e,i=ii(n.root).dom(),E.from(i.frameElement).map(en).filter((function(e){var t=ti(e),n=ti(o.element());return kn(t,n)})).map(Fr).getOr(a));return Il(s,a.left(),a.top())},Ol=function(e,t,n,o){var i=e,r=t,a=n,s=o;e<0&&(i=0,a=n+e),t<0&&(r=0,s=o+t);var l=_l(Lr(i,r));return E.some({point:l,width:a,height:s})},wl=function(e,t,n,o,i){return e.map((function(e){var r=[t,e.point],a=o.fold((function(){return El(r)}),(function(){return El(r)}),(function(){return e=H(r,Cl),xl(e);var e})),s={x:a.left(),y:a.top(),width:e.width,height:e.height},l=(n.showAbove?ls:us)(),u=cs(),c=Qs(i,n,l,u,l,u,E.none());return{anchorBox:s,bubble:n.bubble.getOr(Us()),overrides:n.overrides,layouts:c,placer:E.none()}}))},Rl=function(e,t){return Jo(e)?{element:e,offset:t}:function(e,t){var n=si(e);if(0===n.length)return yl(e,t);if(t<n.length)return yl(n[t],0);var o=n[n.length-1],i=Jo(o)?dl.get(o).length:si(o).length;return yl(o,i)}(e,t)},Sl=function(e,t){return t.getSelection.getOrThunk((function(){return function(){return E.from(e.getSelection()).filter((function(e){return 0<e.rangeCount})).bind(pl)}}))().map((function(e){var t=Rl(e.start(),e.soffset()),n=Rl(e.finish(),e.foffset());return rl.range(t.element,t.offset,n.element,n.offset)}))},kl=[Mt("getSelection"),Dt("root"),Mt("bubble"),Js(),zt("overrides",{}),zt("showAbove",!1),Aa("placement",(function(e,t,n){var o=ii(t.root).dom(),i=Dl(e,0,t),r=Sl(o,t).bind((function(e){return vl(o,rl.exactFromRange(e)).orThunk((function(){var t=Qt("\ufeff");return ui(e.start(),t),vl(o,rl.exact(t,0,t,1)).map((function(e){return mi(t),e}))})).bind((function(e){return Ol(e.left(),e.top(),e.width(),e.height())}))})),a=Sl(o,t).bind((function(e){return Zo(e.start())?E.some(e.start()):ri(e.start())})).getOr(e.element());return wl(r,i,t,n,a)}))],Al=[Dt("node"),Dt("root"),Mt("bubble"),Js(),zt("overrides",{}),zt("showAbove",!1),Aa("placement",(function(e,t,n){var o=Dl(e,0,t);return t.node.bind((function(i){var r=i.dom().getBoundingClientRect(),a=Ol(r.left,r.top,r.width,r.height),s=t.node.getOr(e.element());return wl(a,o,t,n,s)}))}))],Nl=function(e){return e.x+e.width},Ml=function(e,t){return e.x-t.width},Kl=function(e,t){return e.y-t.height+e.height},Pl=function(e){return e.y},Ll=function(e,t,n){return Ka(Nl(e),Pl(e),n.southeast(),La(),Ua(e,{left:0,top:2}),"link-layout-se")},Bl=function(e,t,n){return Ka(Ml(e,t),Pl(e),n.southwest(),Ba(),Ua(e,{right:1,top:2}),"link-layout-sw")},Fl=function(e,t,n){return Ka(Nl(e),Kl(e,t),n.northeast(),Fa(),Ua(e,{left:0,bottom:3}),"link-layout-ne")},zl=function(e,t,n){return Ka(Ml(e,t),Kl(e,t),n.northwest(),za(),Ua(e,{right:1,bottom:3}),"link-layout-nw")},Vl=function(){return[Ll,Bl,Fl,zl]},Hl=function(){return[Bl,Ll,zl,Fl]},Wl=[Dt("item"),Js(),zt("overrides",{}),Aa("placement",(function(e,t,n){var o=As(n,t.item.element()),i=Qs(e.element(),t,Vl(),Hl(),Vl(),Hl(),E.none());return E.some({anchorBox:o,bubble:Us(),overrides:t.overrides,layouts:i,placer:E.none()})}))],$l=pt("anchor",{selection:kl,node:Al,hotspot:el,submenu:Wl,makeshift:tl}),Ul=function(e,n,r,s,l){!function(e,n,r,s,l,u){var c,d=Hs(u,"maxHeightFunction",zs()),f=Hs(u,"maxWidthFunction",t),h=e.anchorBox(),g=e.origin(),m={bounds:(c=g,l.fold((function(){return c.fold(oa,oa,ea)}),(function(e){return c.fold(e,e,(function(){var t=e(),n=Ns(c,t.x,t.y);return ea(n.left(),n.top(),t.width,t.height)}))}))),origin:g,preference:s,maxHeightFunction:d,maxWidthFunction:f};!function(e,t,n,r){var s,l,u=function(e,t,n,r){xr(t,"max-height"),xr(t,"max-width");var s,l,u,c,d,f,h,g,m={width:Wr(s=t),height:Kr(s)};return c=n,d=r.bounds,f=(u=m).width,h=u.height,g=function(e,t,n,r){return function(e,t,n,r){var a,s,l,u,c,d,f,h,g,m,p,v,y,b,C,T,x,_,I,D,O,w,R,S,k,A,N,M,K,P,L,B,F=e.x(),z=e.y(),V=e.bubble().offset(),H=V.left(),W=V.top(),$=(a=r,s=e.boundsRestriction(),l=V,c=(u=function(e,t){var n="top"===e||"bottom"===e?l.top():l.left();return Oe(s,e).bind(i).bind((function(n){return"left"===e||"top"===e?t<=n?E.some(n):E.none():n<=t?E.some(n):E.none()})).map((function(e){return e+n})).getOr(t)})("left",a.x),d=u("top",a.y),f=u("right",a.right),h=u("bottom",a.bottom),ea(c,d,f-c,h-d)),U=$.y,q=$.bottom,j=$.x,G=$.right,X=z+W,Y=(v=n,b=(y=$).x,x=y.height,I=(C=y.y)<=(m=X),D=(_=b<=(g=F+H))&&I,O=g+(p=t)<=b+(T=y.width)&&m+v<=C+x,w=Math.abs(Math.min(p,_?b+T-g:b-(g+p))),R=Math.abs(Math.min(v,I?C+x-m:C-(m+v))),S=Math.max(y.x,y.right-p),k=Math.max(y.y,y.bottom-v),{originInBounds:D,sizeInBounds:O,limitX:Ls(g,y.x,S),limitY:Ls(m,y.y,k),deltaW:w,deltaH:R}),Z=Y.originInBounds,J=Y.sizeInBounds,Q=Y.limitX,ee=Y.limitY,te=Y.deltaW,ne=Y.deltaH,oe=o(ee+ne-U),ie=(N=A=o(q-ee),e.direction().fold(A,A,M=oe,M,A,M,N,N)),re=o(Q+te-j),ae=o(G-Q),se={x:Q,y:ee,width:te,height:ne,maxHeight:ie,maxWidth:(K=e.direction(),L=P=ae,B=re,K.fold(P,B,P,B,L,L,P,B)),direction:e.direction(),classes:{on:e.bubble().classesOn(),off:e.bubble().classesOff()},label:e.label(),candidateYforTest:X};return Z&&J?Bs.fit(se):Bs.nofit(se,te,ne)}(e(l,u,c),f,h,d).fold(Bs.fit,(function(e,o,i){return r<i||n<o?Bs.nofit(e,o,i):Bs.nofit(t,n,r)}))},j(r.preference,(function(e,t){var n=a(g,t);return e.fold(Bs.fit,n)}),Bs.nofit({x:(l=e).x,y:l.y,width:u.width,height:u.height,maxHeight:u.height,maxWidth:u.width,direction:La(),classes:{on:[],off:[]},label:"none",candidateYforTest:l.y},-1,-1)).fold(i,i)}(e,t,n,r);(function(e,t,n){var o;Rs(e,(o=t,n.origin.fold((function(){return ws("absolute",E.some(o.x),E.some(o.y),E.none(),E.none())}),(function(e,t,n,i){return ks("absolute",o,e,t,n,i)}),(function(e,t,n,i){return ks("fixed",o,e,t,n,i)}))))})(t,u,r),or(s=t,(l=u.classes).off),nr(s,l.on),(0,r.maxHeightFunction)(t,u.maxHeight),(0,r.maxWidthFunction)(t,u.maxWidth)}(h,n,r,m)}(function(e,t){return n=t,{anchorBox:o(e),origin:o(n)};var n}(r.anchorBox,n),l.element(),r.bubble,r.layouts,s,r.overrides)},ql=function(e,t,n,o,i,r){var a=r.map(ta);return jl(e,t,n,o,i,a)},jl=function(t,n,i,r,a,s){var l=ht("positioning anchor.info",$l,r);Os((function(){mr(a.element(),"position","fixed");var i=Cr(a.element(),"visibility");mr(a.element(),"visibility","hidden");var r,u,c,d,f=n.useFixed()?Ks(0,0,(d=e.document.documentElement).clientWidth,d.clientHeight):(u=Fr((r=t).element()),c=r.element().dom().getBoundingClientRect(),Ms(u.left(),u.top(),c.width,c.height)),h=l.placement,g=s.map(o).or(n.getBounds);h(t,l,f).each((function(e){e.placer.getOr(Ul)(t,f,e,g,a)})),i.fold((function(){xr(a.element(),"visibility")}),(function(e){mr(a.element(),"visibility",e)})),Cr(a.element(),"left").isNone()&&Cr(a.element(),"top").isNone()&&Cr(a.element(),"right").isNone()&&Cr(a.element(),"bottom").isNone()&&Cr(a.element(),"position").is("fixed")&&xr(a.element(),"position")}),a.element())},Gl=Object.freeze({__proto__:null,position:function(e,t,n,o,i){ql(e,t,n,o,i,E.none())},positionWithin:ql,positionWithinBounds:jl,getMode:function(e,t,n){return t.useFixed()?"fixed":"absolute"}}),Xl=[zt("useFixed",u),Mt("getBounds")],Yl=ps({fields:Xl,name:"positioning",active:Es,apis:Gl}),Zl=function(e){Ro(e,Co());var t=e.components();W(t,Zl)},Jl=function(e){var t=e.components();W(t,Jl),Ro(e,bo())},Ql=function(e,t){fi(e.element(),t.element())},eu=function(e,t){var n,o=e.components();W((n=e).components(),(function(e){return mi(e.element())})),gi(n.element()),n.syncComponents();var i=ee(o,t);W(i,(function(t){Zl(t),e.getSystem().removeFromWorld(t)})),W(t,(function(t){t.getSystem().isConnected()?Ql(e,t):(e.getSystem().addToWorld(t),Ql(e,t),cr(e.element())&&Jl(t)),e.syncComponents()}))},tu=function(e,t){nu(e,t,fi)},nu=function(e,t,n){e.getSystem().addToWorld(t),n(e.element(),t.element()),cr(e.element())&&Jl(t),e.syncComponents()},ou=function(e){Zl(e),mi(e.element()),e.getSystem().removeFromWorld(e)},iu=function(e){var t=ri(e.element()).bind((function(t){return e.getSystem().getByDom(t).toOption()}));ou(e),t.each((function(e){e.syncComponents()}))},ru=function(e){var t=e.components();W(t,ou),gi(e.element()),e.syncComponents()},au=function(e,t){su(e,t,fi)},su=function(e,t,n){n(e,t.element());var o=si(t.element());W(o,(function(e){t.getByDom(e).each(Jl)}))},lu=function(e){var t=si(e.element());W(t,(function(t){e.getByDom(t).each(Zl)})),mi(e.element())},uu=function(e,t,n,o){n.get().each((function(t){ru(e)}));var i=t.getAttachPoint(e);tu(i,e);var r=e.getSystem().build(o);return tu(e,r),n.set(r),r},cu=function(e,t,n,o){var i=uu(e,t,n,o);return t.onOpen(e,i),i},du=function(e,t,n){n.get().each((function(o){ru(e),iu(e),t.onClose(e,o),n.clear()}))},fu=function(e,t,n){return n.isOpen()},hu=function(e,t,n){var o,i,r,a=t.getAttachPoint(e);mr(e.element(),"position",Yl.getMode(a)),i="visibility",r=t.cloakVisibilityAttr,Cr((o=e).element(),i).fold((function(){_i(o.element(),r)}),(function(e){Ci(o.element(),r,e)})),mr(o.element(),i,"hidden")},gu=function(e,t,n){var o,i,r,a;o=e.element(),F(["top","left","right","bottom"],(function(e){return Cr(o,e).isSome()}))||xr(e.element(),"position"),r="visibility",a=t.cloakVisibilityAttr,xi((i=e).element(),a).fold((function(){return xr(i.element(),r)}),(function(e){return mr(i.element(),r,e)}))},mu=Object.freeze({__proto__:null,cloak:hu,decloak:gu,open:cu,openWhileCloaked:function(e,t,n,o,i){hu(e,t),cu(e,t,n,o),i(),gu(e,t)},close:du,isOpen:fu,isPartOf:function(e,t,n,o){return fu(0,0,n)&&n.get().exists((function(n){return t.isPartOf(e,n,o)}))},getState:function(e,t,n){return n.get()},setContent:function(e,t,n,o){return n.get().map((function(){return uu(e,t,n,o)}))}}),pu=Object.freeze({__proto__:null,events:function(e,t){return Ko([Bo(fo(),(function(n,o){du(n,e,t)}))])}}),vu=[wa("onOpen"),wa("onClose"),Dt("isPartOf"),Dt("getAttachPoint"),zt("cloakVisibilityAttr","data-precloak-visibility")],yu=ps({fields:vu,name:"sandboxing",active:pu,apis:mu,state:Object.freeze({__proto__:null,init:function(){var e=Xt(E.none()),t=o("not-implemented");return qi({readState:t,isOpen:function(){return e.get().isSome()},clear:function(){e.set(E.none())},set:function(t){e.set(E.some(t))},get:function(){return e.get()}})}})}),bu=o("dismiss.popups"),Cu=o("reposition.popups"),Tu=o("mouse.released"),xu=Qe([zt("isExtraPart",o(!1)),Ft("fireEventInstead",[zt("event",To())])]),Eu=function(e){var t,n=ht("Dismissal",xu,e);return(t={})[bu()]={schema:Qe([Dt("target")]),onReceive:function(e,t){yu.isOpen(e)&&(yu.isPartOf(e,t.target)||n.isExtraPart(e,t.target)||n.fireEventInstead.fold((function(){return yu.close(e)}),(function(t){return Ro(e,t.event)})))}},t},_u=Qe([Ft("fireEventInstead",[zt("event",xo())]),St("doReposition")]),Iu=function(e){var t,n=ht("Reposition",_u,e);return(t={})[Cu()]={onReceive:function(e){yu.isOpen(e)&&n.fireEventInstead.fold((function(){return n.doReposition(e)}),(function(t){return Ro(e,t.event)}))}},t},Du=function(e,t,n){t.store.manager.onLoad(e,t,n)},Ou=function(e,t,n){t.store.manager.onUnload(e,t,n)},wu=Object.freeze({__proto__:null,onLoad:Du,onUnload:Ou,setValue:function(e,t,n,o){t.store.manager.setValue(e,t,n,o)},getValue:function(e,t,n){return t.store.manager.getValue(e,t,n)},getState:function(e,t,n){return n}}),Ru=Object.freeze({__proto__:null,events:function(e,t){var n=e.resetOnDom?[Uo((function(n,o){Du(n,e,t)})),qo((function(n,o){Ou(n,e,t)}))]:[ds(e,t,Du)];return Ko(n)}}),Su=function(){var e=Xt(null);return qi({set:e.set,get:e.get,isNotSet:function(){return null===e.get()},clear:function(){e.set(null)},readState:function(){return{mode:"memory",value:e.get()}}})},ku=function(){var e=Xt({}),t=Xt({});return qi({readState:function(){return{mode:"dataset",dataByValue:e.get(),dataByText:t.get()}},lookup:function(n){return Oe(e.get(),n).orThunk((function(){return Oe(t.get(),n)}))},update:function(n){var o=e.get(),i=t.get(),r={},a={};W(n,(function(e){r[e.value]=e,Oe(e,"meta").each((function(t){Oe(t,"text").each((function(t){a[t]=e}))}))})),e.set(f(f({},o),r)),t.set(f(f({},i),a))},clear:function(){e.set({}),t.set({})}})},Au=Object.freeze({__proto__:null,memory:Su,dataset:ku,manual:function(){return qi({readState:function(){}})},init:function(e){return e.store.manager.state(e)}}),Nu=function(e,t,n,o){var i=t.store;n.update([o]),i.setValue(e,o),t.onSetValue(e,o)},Mu=[Mt("initialValue"),Dt("getFallbackEntry"),Dt("getDataKey"),Dt("setValue"),Aa("manager",{setValue:Nu,getValue:function(e,t,n){var o=t.store,i=o.getDataKey(e);return n.lookup(i).fold((function(){return o.getFallbackEntry(i)}),(function(e){return e}))},onLoad:function(e,t,n){t.store.initialValue.each((function(o){Nu(e,t,n,o)}))},onUnload:function(e,t,n){n.clear()},state:ku})],Ku=[Dt("getValue"),zt("setValue",t),Mt("initialValue"),Aa("manager",{setValue:function(e,t,n,o){t.store.setValue(e,o),t.onSetValue(e,o)},getValue:function(e,t,n){return t.store.getValue(e)},onLoad:function(e,t,n){t.store.initialValue.each((function(n){t.store.setValue(e,n)}))},onUnload:t,state:Ui.init})],Pu=[Mt("initialValue"),Aa("manager",{setValue:function(e,t,n,o){n.set(o),t.onSetValue(e,o)},getValue:function(e,t,n){return n.get()},onLoad:function(e,t,n){t.store.initialValue.each((function(e){n.isNotSet()&&n.set(e)}))},onUnload:function(e,t,n){n.clear()},state:Su})],Lu=[Vt("store",{mode:"memory"},pt("mode",{memory:Pu,manual:Ku,dataset:Mu})),wa("onSetValue"),zt("resetOnDom",!1)],Bu=ps({fields:Lu,name:"representing",active:Ru,apis:wu,extra:{setValueFrom:function(e,t){var n=Bu.getValue(t);Bu.setValue(e,n)}},state:Au}),Fu=function(e,t){return jt(e,{},H(t,(function(t){return n=t.name(),o="Cannot configure "+t.name()+" for "+e,rt(n,n,Fe(),Je((function(e){return pe("The field: "+n+" is forbidden. "+o)})));var n,o})).concat([Gt("dump",i)]))},zu=function(e){return e.dump},Vu=function(e,t){return f(f({},e.dump),gs(t))},Hu=Fu,Wu=Vu,$u="placeholder",Uu=Se([{single:["required","valueThunk"]},{multiple:["required","valueThunks"]}]),qu=function(e){return we(e,"uiType")},ju=function(e,t,n,r){return function(e,t,n,i){return qu(n)&&n.uiType===$u?(a=n,s=i,(r=e).exists((function(e){return e!==a.owner}))?Uu.single(!0,o(a)):Oe(s,a.name).fold((function(){throw new Error("Unknown placeholder component: "+a.name+"\nKnown: ["+be(s)+"]\nNamespace: "+r.getOr("none")+"\nSpec: "+JSON.stringify(a,null,2))}),(function(e){return e.replace()}))):Uu.single(!1,o(n));var r,a,s}(e,0,n,r).fold((function(o,i){var a=qu(n)?i(t,n.config,n.validated):i(t),s=Oe(a,"components").getOr([]),l=Z(s,(function(n){return ju(e,t,n,r)}));return[f(f({},a),{components:l})]}),(function(e,o){if(qu(n)){var r=o(t,n.config,n.validated);return n.validated.preprocess.getOr(i)(r)}return o(t)}))},Gu=Uu.single,Xu=Uu.multiple,Yu=o($u),Zu=Se([{required:["data"]},{external:["data"]},{optional:["data"]},{group:["data"]}]),Ju=zt("factory",{sketch:i}),Qu=zt("schema",[]),ec=Dt("name"),tc=rt("pname","pname",ze((function(e){return"<alloy."+Ri(e.name)+">"})),vt()),nc=Gt("schema",(function(){return[Mt("preprocess")]})),oc=zt("defaults",o({})),ic=zt("overrides",o({})),rc=et([Ju,Qu,ec,tc,oc,ic]),ac=et([Ju,Qu,ec,oc,ic]),sc=et([Ju,Qu,ec,tc,oc,ic]),lc=et([Ju,nc,ec,Dt("unit"),tc,oc,ic]),uc=function(e){return e.fold(E.some,E.none,E.some,E.some)},cc=function(e){var t=function(e){return e.name};return e.fold(t,t,t,t)},dc=function(e,t){return function(n){var o=ht("Converting part type",t,n);return e(o)}},fc=dc(Zu.required,rc),hc=dc(Zu.external,ac),gc=dc(Zu.optional,sc),mc=dc(Zu.group,lc),pc=o("entirety"),vc=Object.freeze({__proto__:null,required:fc,external:hc,optional:gc,group:mc,asNamedPart:uc,name:cc,asCommon:function(e){return e.fold(i,i,i,i)},original:pc}),yc=function(e,t,n,o){return Ne(t.defaults(e,n,o),n,{uid:e.partUids[t.name]},t.overrides(e,n,o))},bc=function(e,t){var n={};return W(t,(function(t){uc(t).each((function(t){var o=Cc(e,t.pname);n[t.name]=function(n){var i=ht("Part: "+t.name+" in "+e,et(t.schema),n);return f(f({},o),{config:n,validated:i})}}))})),n},Cc=function(e,t){return{uiType:Yu(),owner:e,name:t}},Tc=function(e,t,n){return{uiType:Yu(),owner:e,name:t,config:n,validated:{}}},xc=function(e){return Z(e,(function(e){return e.fold(E.none,E.some,E.none,E.none).map((function(e){return kt(e.name,e.schema.concat([Na(pc())]))})).toArray()}))},Ec=function(e){return H(e,cc)},_c=function(e,t,n){return i=t,r={},a={},W(n,(function(e){e.fold((function(e){r[e.pname]=Gu(!0,(function(t,n,o){return e.factory.sketch(yc(t,e,n,o))}))}),(function(e){var t=i.parts[e.name];a[e.name]=o(e.factory.sketch(yc(i,e,t[pc()]),t))}),(function(e){r[e.pname]=Gu(!1,(function(t,n,o){return e.factory.sketch(yc(t,e,n,o))}))}),(function(e){r[e.pname]=Xu(!0,(function(t,n,o){return H(t[e.name],(function(n){return e.factory.sketch(Ne(e.defaults(t,n,o),n,e.overrides(t,n)))}))}))}))})),{internals:o(r),externals:o(a)};var i,r,a},Ic=function(e,t,n){return function(e,t,n,i){var r,a,s,l=xe(i,(function(e,t){return i=e,r=!1,{name:o(n=t),required:function(){return i.fold((function(e,t){return e}),(function(e,t){return e}))},used:function(){return r},replace:function(){if(r)throw new Error("Trying to use the same placeholder more than once: "+n);return r=!0,i}};var n,i,r})),u=(r=e,a=t,s=l,Z(n,(function(e){return ju(r,a,e,s)})));return Te(l,(function(n){if(!1===n.used()&&n.required())throw new Error("Placeholder: "+n.name()+" was not found in components list\nNamespace: "+e.getOr("none")+"\nComponents: "+JSON.stringify(t.components,null,2))})),u}(E.some(e),t,t.components,n)},Dc=function(e,t,n){var o=t.partUids[n];return e.getSystem().getByUid(o).toOption()},Oc=function(e,t,n){return Dc(e,t,n).getOrDie("Could not find part: "+n)},wc=function(e,t,n){var i={},r=t.partUids,a=e.getSystem();return W(n,(function(e){i[e]=o(a.getByUid(r[e]))})),i},Rc=function(e,t){var n=e.getSystem();return xe(t.partUids,(function(e,t){return o(n.getByUid(e))}))},Sc=function(e){return be(e.partUids)},kc=function(e,t,n){var i={},r=t.partUids,a=e.getSystem();return W(n,(function(e){i[e]=o(a.getByUid(r[e]).getOrDie())})),i},Ac=function(e,t){var n=Ec(t);return Ue(H(n,(function(t){return{key:t,value:e+"-"+t}})))},Nc=function(e){return rt("partUids","partUids",Ve((function(t){return Ac(t.uid,e)})),vt())},Mc=Object.freeze({__proto__:null,generate:bc,generateOne:Tc,schemas:xc,names:Ec,substitutes:_c,components:Ic,defaultUids:Ac,defaultUidsSchema:Nc,getAllParts:Rc,getAllPartNames:Sc,getPart:Dc,getPartOrDie:Oc,getParts:wc,getPartsOrDie:kc}),Kc=function(e,t,n,o,i){var r,a,s=(a=i,(0<(r=o).length?[kt("parts",r)]:[]).concat([Dt("uid"),zt("dom",{}),zt("components",[]),Na("originalSpec"),zt("debug.sketcher",{})]).concat(a));return ht(e+" [SpecSchema]",Qe(s.concat(t)),n)},Pc=function(e,t,n,o,i){var r=Lc(i),a=xc(n),s=Nc(n),l=Kc(e,t,r,a,[s]),u=_c(0,l,n);return o(l,Ic(e,l,u.internals()),r,u.externals())},Lc=function(e){return we(e,"uid")?e:f(f({},e),{uid:Pi("uid")})},Bc=Qe([Dt("name"),Dt("factory"),Dt("configFields"),zt("apis",{}),zt("extraApis",{})]),Fc=Qe([Dt("name"),Dt("factory"),Dt("configFields"),Dt("partFields"),zt("apis",{}),zt("extraApis",{})]),zc=function(e){var t=ht("Sketcher for "+e.name,Bc,e),n=xe(t.apis,$i),i=xe(t.extraApis,(function(e,t){return Vi(e,t)}));return f(f({name:o(t.name),configFields:o(t.configFields),sketch:function(e){return n=t.name,o=t.configFields,i=t.factory,r=Lc(e),i(Kc(n,o,r,[],[]),r);var n,o,i,r}},n),i)},Vc=function(e){var t=ht("Sketcher for "+e.name,Fc,e),n=bc(t.name,t.partFields),i=xe(t.apis,$i),r=xe(t.extraApis,(function(e,t){return Vi(e,t)}));return f(f({name:o(t.name),partFields:o(t.partFields),configFields:o(t.configFields),sketch:function(e){return Pc(t.name,t.configFields,t.partFields,t.factory,e)},parts:o(n)},i),r)},Hc=function(e){for(var t=[],n=function(e){t.push(e)},o=0;o<e.length;o++)e[o].each(n);return t},Wc=function(e){return"input"===Xo(e)&&"radio"!==Ti(e,"type")||"textarea"===Xo(e)},$c=Object.freeze({__proto__:null,getCurrent:function(e,t,n){return t.find(e)}}),Uc=[Dt("find")],qc=ps({fields:Uc,name:"composing",apis:$c}),jc=function(e,t,n,o){var i=ml(e.element(),"."+t.highlightClass);W(i,(function(n){F(o,(function(e){return e.element()===n}))||(er(n,t.highlightClass),e.getSystem().getByDom(n).each((function(n){t.onDehighlight(e,n),Ro(n,wo())})))}))},Gc=function(e,t,n,o){jc(e,t,0,[o]),Xc(e,t,n,o)||(Qi(o.element(),t.highlightClass),t.onHighlight(e,o),Ro(o,Oo()))},Xc=function(e,t,n,o){return tr(o.element(),t.highlightClass)},Yc=function(e,t,n){return da(e.element(),"."+t.itemClass).bind((function(t){return e.getSystem().getByDom(t).toOption()}))},Zc=function(e,t,n){var o=ml(e.element(),"."+t.itemClass);return(0<o.length?E.some(o[o.length-1]):E.none()).bind((function(t){return e.getSystem().getByDom(t).toOption()}))},Jc=function(e,t,n,o){var i=ml(e.element(),"."+t.itemClass);return X(i,(function(e){return tr(e,t.highlightClass)})).bind((function(t){var n=Ps(t,o,0,i.length-1);return e.getSystem().getByDom(i[n]).toOption()}))},Qc=function(e,t,n){var o=ml(e.element(),"."+t.itemClass);return Hc(H(o,(function(t){return e.getSystem().getByDom(t).toOption()})))},ed=Object.freeze({__proto__:null,dehighlightAll:function(e,t,n){return jc(e,t,0,[])},dehighlight:function(e,t,n,o){Xc(e,t,n,o)&&(er(o.element(),t.highlightClass),t.onDehighlight(e,o),Ro(o,wo()))},highlight:Gc,highlightFirst:function(e,t,n){Yc(e,t).each((function(o){Gc(e,t,n,o)}))},highlightLast:function(e,t,n){Zc(e,t).each((function(o){Gc(e,t,n,o)}))},highlightAt:function(e,t,n,o){(function(e,t,n,o){var i=ml(e.element(),"."+t.itemClass);return E.from(i[o]).fold((function(){return le.error("No element found with index "+o)}),e.getSystem().getByDom)})(e,t,0,o).fold((function(e){throw new Error(e)}),(function(o){Gc(e,t,n,o)}))},highlightBy:function(e,t,n,o){var i=Qc(e,t);G(i,o).each((function(o){Gc(e,t,n,o)}))},isHighlighted:Xc,getHighlighted:function(e,t,n){return da(e.element(),"."+t.highlightClass).bind((function(t){return e.getSystem().getByDom(t).toOption()}))},getFirst:Yc,getLast:Zc,getPrevious:function(e,t,n){return Jc(e,t,0,-1)},getNext:function(e,t,n){return Jc(e,t,0,1)},getCandidates:Qc}),td=[Dt("highlightClass"),Dt("itemClass"),wa("onHighlight"),wa("onDehighlight")],nd=ps({fields:td,name:"highlighting",apis:ed}),od=function(e,t,n){var o=Q(e.slice(0,t)),i=Q(e.slice(t+1));return G(o.concat(i),n)},id=function(e,t,n){var o=Q(e.slice(0,t));return G(o,n)},rd=function(e,t,n){var o=e.slice(0,t),i=e.slice(t+1);return G(i.concat(o),n)},ad=function(e,t,n){var o=e.slice(t+1);return G(o,n)},sd=function(e){return function(t){var n=t.raw();return B(e,n.which)}},ld=function(e){return function(t){return J(e,(function(e){return e(t)}))}},ud=function(e){return!0===e.raw().shiftKey},cd=function(e){return!0===e.raw().ctrlKey},dd=s(ud),fd=function(e,t){return{matches:e,classification:t}},hd=function(e,t,n){t.exists((function(e){return n.exists((function(t){return kn(t,e)}))}))||So(e,Eo(),{prevFocus:t,newFocus:n})},gd=function(){var e=function(e){return Ds(e.element())};return{get:e,set:function(t,n){var o=e(t);t.getSystem().triggerFocus(n,t.element());var i=e(t);hd(t,o,i)}}},md=function(){var e=function(e){return nd.getHighlighted(e).map((function(e){return e.element()}))};return{get:e,set:function(n,o){var i=e(n);n.getSystem().getByDom(o).fold(t,(function(e){nd.highlight(n,e)}));var r=e(n);hd(n,i,r)}}};(Xs=Gs=Gs||{}).OnFocusMode="onFocus",Xs.OnEnterOrSpaceMode="onEnterOrSpace",Xs.OnApiMode="onApi";var pd,vd,yd=function(e,t,n,o,i){var r=function(e,t,n,o,i){var r,a;return r=n(e,t,o,i),a=t.event(),G(r,(function(e){return e.matches(a)})).map((function(e){return e.classification})).bind((function(n){return n(e,t,o,i)}))},a={schema:function(){return e.concat([zt("focusManager",gd()),Vt("focusInside","onFocus",ut((function(e){return B(["onFocus","onEnterOrSpace","onApi"],e)?le.value(e):le.error("Invalid value for focusInside")}))),Aa("handler",a),Aa("state",t),Aa("sendFocusIn",i)])},processKey:r,toEvents:function(e,t){var a=e.focusInside!==Gs.OnFocusMode?E.none():i(e).map((function(n){return Bo(oo(),(function(o,i){n(o,e,t),i.stop()}))})),s=[Bo(Xn(),(function(o,a){r(o,a,n,e,t).fold((function(){var n,r,s;n=o,r=a,s=sd([32].concat([13]))(r.event()),e.focusInside===Gs.OnEnterOrSpaceMode&&s&&Pn(n,r)&&i(e).each((function(o){o(n,e,t),r.stop()}))}),(function(e){a.stop()}))})),Bo(Yn(),(function(n,i){r(n,i,o,e,t).each((function(e){i.stop()}))}))];return Ko(a.toArray().concat(s))}};return a},bd=function(e){var t=[Mt("onEscape"),Mt("onEnter"),zt("selector",'[data-alloy-tabstop="true"]:not(:disabled)'),zt("firstTabstop",0),zt("useTabstopAt",o(!0)),Mt("visibilitySelector")].concat([e]),n=function(e,t){var n=e.visibilitySelector.bind((function(e){return fa(t,e)})).getOr(t);return 0<Mr(n)},i=function(e,t,o){var i,r,a;i=t,r=ml(e.element(),i.selector),a=U(r,(function(e){return n(i,e)})),E.from(a[i.firstTabstop]).each((function(n){t.focusManager.set(e,n)}))},r=function(e,t,o,i,r){return r(t,o,(function(e){return n(t=i,o=e)&&t.useTabstopAt(o);var t,o})).fold((function(){return i.cyclic?E.some(!0):E.none()}),(function(t){return i.focusManager.set(e,t),E.some(!0)}))},s=function(e,t,n,o){var i,s=ml(e.element(),n.selector);return(i=n).focusManager.get(e).bind((function(e){return fa(e,i.selector)})).bind((function(t){return X(s,a(kn,t)).bind((function(t){return r(e,s,t,n,o)}))}))},l=o([fd(ld([ud,sd([9])]),(function(e,t,n){return s(e,0,n,n.cyclic?od:id)})),fd(sd([9]),(function(e,t,n){return s(e,0,n,n.cyclic?rd:ad)})),fd(sd([27]),(function(e,t,n){return n.onEscape.bind((function(n){return n(e,t)}))})),fd(ld([dd,sd([13])]),(function(e,t,n){return n.onEnter.bind((function(n){return n(e,t)}))}))]),u=o([]);return yd(t,Ui.init,l,u,(function(){return E.some(i)}))},Cd=bd(Gt("cyclic",o(!1))),Td=bd(Gt("cyclic",o(!0))),xd=function(e,t,n){return Wc(n)&&sd([32])(t.event())?E.none():(Ao(e,n,so()),E.some(!0))},Ed=function(e,t){return E.some(!0)},_d=[zt("execute",xd),zt("useSpace",!1),zt("useEnter",!0),zt("useControlEnter",!1),zt("useDown",!1)],Id=function(e,t,n){return n.execute(e,t,e.element())},Dd=yd(_d,Ui.init,(function(e,t,n,o){var i=n.useSpace&&!Wc(e.element())?[32]:[],r=n.useDown?[40]:[],a=i.concat(n.useEnter?[13]:[]).concat(r);return[fd(sd(a),Id)].concat(n.useControlEnter?[fd(ld([cd,sd([13])]),Id)]:[])}),(function(e,t,n,o){return n.useSpace&&!Wc(e.element())?[fd(sd([32]),Ed)]:[]}),(function(){return E.none()})),Od=function(){var e=Xt(E.none());return qi({readState:function(){return e.get().map((function(e){return{numRows:String(e.numRows),numColumns:String(e.numColumns)}})).getOr({numRows:"?",numColumns:"?"})},setGridSize:function(t,n){e.set(E.some({numRows:t,numColumns:n}))},getNumRows:function(){return e.get().map((function(e){return e.numRows}))},getNumColumns:function(){return e.get().map((function(e){return e.numColumns}))}})},wd=Object.freeze({__proto__:null,flatgrid:Od,init:function(e){return e.state(e)}}),Rd=function(e){return function(t,n,o,i){var r=e(t.element());return Nd(r,t,n,o,i)}},Sd=function(e,t){var n=qs(e,t);return Rd(n)},kd=function(e,t){var n=qs(t,e);return Rd(n)},Ad=function(e){return function(t,n,o,i){return Nd(e,t,n,o,i)}},Nd=function(e,t,n,o,i){return o.focusManager.get(t).bind((function(n){return e(t.element(),n,o,i)})).map((function(e){return o.focusManager.set(t,e),!0}))},Md=Ad,Kd=Ad,Pd=Ad,Ld=function(e){return!((t=e.dom()).offsetWidth<=0&&t.offsetHeight<=0);var t},Bd=function(e,t,n){var i,r=ml(e,n),a=U(r,Ld);return X(i=a,(function(e){return kn(e,t)})).map((function(e){return{index:o(e),candidates:o(i)}}))},Fd=function(e,t){return X(e,(function(e){return kn(t,e)}))},zd=function(e,t,n,o){return o(Math.floor(t/n),t%n).bind((function(t){var o=t.row()*n+t.column();return 0<=o&&o<e.length?E.some(e[o]):E.none()}))},Vd=function(e,t,n,i,r){return zd(e,t,i,(function(t,a){var s=Ps(a,r,0,(t===n-1?e.length-t*i:i)-1);return E.some({row:o(t),column:o(s)})}))},Hd=function(e,t,n,i,r){return zd(e,t,i,(function(t,a){var s=Ps(t,r,0,n-1),l=Ls(a,0,(s===n-1?e.length-s*i:i)-1);return E.some({row:o(s),column:o(l)})}))},Wd=[Dt("selector"),zt("execute",xd),Ra("onEscape"),zt("captureTab",!1),Ma()],$d=function(e,t,n){da(e.element(),t.selector).each((function(n){t.focusManager.set(e,n)}))},Ud=function(e){return function(t,n,o,i){return Bd(t,n,o.selector).bind((function(t){return e(t.candidates(),t.index(),i.getNumRows().getOr(o.initSize.numRows),i.getNumColumns().getOr(o.initSize.numColumns))}))}},qd=function(e,t,n){return n.captureTab?E.some(!0):E.none()},jd=Ud((function(e,t,n,o){return Vd(e,t,n,o,-1)})),Gd=Ud((function(e,t,n,o){return Vd(e,t,n,o,1)})),Xd=Ud((function(e,t,n,o){return Hd(e,t,n,o,-1)})),Yd=Ud((function(e,t,n,o){return Hd(e,t,n,o,1)})),Zd=o([fd(sd([37]),Sd(jd,Gd)),fd(sd([39]),kd(jd,Gd)),fd(sd([38]),Md(Xd)),fd(sd([40]),Kd(Yd)),fd(ld([ud,sd([9])]),qd),fd(ld([dd,sd([9])]),qd),fd(sd([27]),(function(e,t,n){return n.onEscape(e,t)})),fd(sd([32].concat([13])),(function(e,t,n,o){return(i=n).focusManager.get(e).bind((function(e){return fa(e,i.selector)})).bind((function(o){return n.execute(e,t,o)}));var i}))]),Jd=o([fd(sd([32]),Ed)]),Qd=yd(Wd,Od,Zd,Jd,(function(){return E.some($d)})),ef=function(e,t,n,o){var i=function(e,t,n){var r,a=Ps(t,o,0,n.length-1);return a===e?E.none():"button"===Xo(r=n[a])&&"disabled"===Ti(r,"disabled")?i(e,a,n):E.from(n[a])};return Bd(e,n,t).bind((function(e){var t=e.index(),n=e.candidates();return i(t,t,n)}))},tf=[Dt("selector"),zt("getInitial",E.none),zt("execute",xd),Ra("onEscape"),zt("executeOnMove",!1),zt("allowVertical",!0)],nf=function(e,t,n){return(o=n).focusManager.get(e).bind((function(e){return fa(e,o.selector)})).bind((function(o){return n.execute(e,t,o)}));var o},of=function(e,t,n){t.getInitial(e).orThunk((function(){return da(e.element(),t.selector)})).each((function(n){t.focusManager.set(e,n)}))},rf=function(e,t,n){return ef(e,n.selector,t,-1)},af=function(e,t,n){return ef(e,n.selector,t,1)},sf=function(e){return function(t,n,o,i){return e(t,n,o,i).bind((function(){return o.executeOnMove?nf(t,n,o):E.some(!0)}))}},lf=function(e,t,n){return n.onEscape(e,t)},uf=o([fd(sd([32]),Ed)]),cf=yd(tf,Ui.init,(function(e,t,n,o){var i=[37].concat(n.allowVertical?[38]:[]),r=[39].concat(n.allowVertical?[40]:[]);return[fd(sd(i),sf(Sd(rf,af))),fd(sd(r),sf(kd(rf,af))),fd(sd([13]),nf),fd(sd([32]),nf),fd(sd([27]),lf)]}),uf,(function(){return E.some(of)})),df=function(e,t,n){return E.from(e[t]).bind((function(e){return E.from(e[n]).map((function(e){return{rowIndex:t,columnIndex:n,cell:e}}))}))},ff=function(e,t,n,o){var i=Ps(n,o,0,e[t].length-1);return df(e,t,i)},hf=function(e,t,n,o){var i=Ps(n,o,0,e.length-1),r=Ls(t,0,e[i].length-1);return df(e,i,r)},gf=function(e,t,n,o){var i=Ls(n+o,0,e[t].length-1);return df(e,t,i)},mf=function(e,t,n,o){var i=Ls(n+o,0,e.length-1),r=Ls(t,0,e[i].length-1);return df(e,i,r)},pf=[kt("selectors",[Dt("row"),Dt("cell")]),zt("cycles",!0),zt("previousSelector",E.none),zt("execute",xd)],vf=function(e,t,n){t.previousSelector(e).orThunk((function(){var n=t.selectors;return da(e.element(),n.cell)})).each((function(n){t.focusManager.set(e,n)}))},yf=function(e,t){return function(n,o,i){var r=i.cycles?e:t;return fa(o,i.selectors.row).bind((function(e){var t=ml(e,i.selectors.cell);return Fd(t,o).bind((function(t){var o=ml(n,i.selectors.row);return Fd(o,e).bind((function(e){var n,a=(n=i,H(o,(function(e){return ml(e,n.selectors.cell)})));return r(a,e,t).map((function(e){return e.cell}))}))}))}))}},bf=yf((function(e,t,n){return ff(e,t,n,-1)}),(function(e,t,n){return gf(e,t,n,-1)})),Cf=yf((function(e,t,n){return ff(e,t,n,1)}),(function(e,t,n){return gf(e,t,n,1)})),Tf=yf((function(e,t,n){return hf(e,n,t,-1)}),(function(e,t,n){return mf(e,n,t,-1)})),xf=yf((function(e,t,n){return hf(e,n,t,1)}),(function(e,t,n){return mf(e,n,t,1)})),Ef=o([fd(sd([37]),Sd(bf,Cf)),fd(sd([39]),kd(bf,Cf)),fd(sd([38]),Md(Tf)),fd(sd([40]),Kd(xf)),fd(sd([32].concat([13])),(function(e,t,n){return Ds(e.element()).bind((function(o){return n.execute(e,t,o)}))}))]),_f=o([fd(sd([32]),Ed)]),If=yd(pf,Ui.init,Ef,_f,(function(){return E.some(vf)})),Df=[Dt("selector"),zt("execute",xd),zt("moveOnTab",!1)],Of=function(e,t,n){return n.focusManager.get(e).bind((function(o){return n.execute(e,t,o)}))},wf=function(e,t,n){da(e.element(),t.selector).each((function(n){t.focusManager.set(e,n)}))},Rf=function(e,t,n){return ef(e,n.selector,t,-1)},Sf=function(e,t,n){return ef(e,n.selector,t,1)},kf=o([fd(sd([38]),Pd(Rf)),fd(sd([40]),Pd(Sf)),fd(ld([ud,sd([9])]),(function(e,t,n,o){return n.moveOnTab?Pd(Rf)(e,t,n,o):E.none()})),fd(ld([dd,sd([9])]),(function(e,t,n,o){return n.moveOnTab?Pd(Sf)(e,t,n,o):E.none()})),fd(sd([13]),Of),fd(sd([32]),Of)]),Af=o([fd(sd([32]),Ed)]),Nf=yd(Df,Ui.init,kf,Af,(function(){return E.some(wf)})),Mf=[Ra("onSpace"),Ra("onEnter"),Ra("onShiftEnter"),Ra("onLeft"),Ra("onRight"),Ra("onTab"),Ra("onShiftTab"),Ra("onUp"),Ra("onDown"),Ra("onEscape"),zt("stopSpaceKeyup",!1),Mt("focusIn")],Kf=yd(Mf,Ui.init,(function(e,t,n){return[fd(sd([32]),n.onSpace),fd(ld([dd,sd([13])]),n.onEnter),fd(ld([ud,sd([13])]),n.onShiftEnter),fd(ld([ud,sd([9])]),n.onShiftTab),fd(ld([dd,sd([9])]),n.onTab),fd(sd([38]),n.onUp),fd(sd([40]),n.onDown),fd(sd([37]),n.onLeft),fd(sd([39]),n.onRight),fd(sd([32]),n.onSpace),fd(sd([27]),n.onEscape)]}),(function(e,t,n){return n.stopSpaceKeyup?[fd(sd([32]),Ed)]:[]}),(function(e){return e.focusIn})),Pf=Cd.schema(),Lf=Td.schema(),Bf=cf.schema(),Ff=Qd.schema(),zf=If.schema(),Vf=Dd.schema(),Hf=Nf.schema(),Wf=Kf.schema(),$f=ys({branchKey:"mode",branches:Object.freeze({__proto__:null,acyclic:Pf,cyclic:Lf,flow:Bf,flatgrid:Ff,matrix:zf,execution:Vf,menu:Hf,special:Wf}),name:"keying",active:{events:function(e,t){return e.handler.toEvents(e,t)}},apis:{focusIn:function(e,t,n){t.sendFocusIn(t).fold((function(){e.getSystem().triggerFocus(e.element(),e.element())}),(function(o){o(e,t,n)}))},setGridSize:function(t,n,o,i,r){Re(o,"setGridSize")?o.setGridSize(i,r):e.console.error("Layout does not support setGridSize")}},state:wd}),Uf=function(e,t,n,o){var i=e.getSystem().build(o);nu(e,i,n)},qf=function(e,t,n,o){var i=jf(e);G(i,(function(e){return kn(o.element(),e.element())})).each(iu)},jf=function(e,t){return e.components()},Gf=function(e,t,n,o,i){var r=jf(e);return E.from(r[o]).map((function(t){return qf(e,0,0,t),i.each((function(t){Uf(e,0,(function(e,t){var n,i;i=t,li(n=e,o).fold((function(){fi(n,i)}),(function(e){ui(e,i)}))}),t)})),t}))},Xf=ps({fields:[],name:"replacing",apis:Object.freeze({__proto__:null,append:function(e,t,n,o){Uf(e,0,fi,o)},prepend:function(e,t,n,o){Uf(e,0,di,o)},remove:qf,replaceAt:Gf,replaceBy:function(e,t,n,o,i){var r=jf(e);return X(r,o).bind((function(t){return Gf(e,0,0,t,i)}))},set:function(e,t,n,o){Os((function(){var t=H(o,e.getSystem().build);eu(e,t)}),e.element())},contents:jf})}),Yf=function(e,t){var n,i;return{key:e,value:{config:{},me:(n=e,i=Ko(t),ps({fields:[Dt("enabled")],name:n,active:{events:o(i)}})),configAsRaw:o({}),initialConfig:{},state:Ui}}},Zf=function(e,t){t.ignore||(_s(e.element()),t.onFocus(e))},Jf=Object.freeze({__proto__:null,focus:Zf,blur:function(e,t){t.ignore||e.element().dom().blur()},isFocused:function(e){return t=e.element(),n=lr(t).dom(),t.dom()===n.activeElement;var t,n}}),Qf=Object.freeze({__proto__:null,exhibit:function(e,t){return Gi(t.ignore?{}:{attributes:{tabindex:"-1"}})},events:function(e){return Ko([Bo(oo(),(function(t,n){Zf(t,e),n.stop()}))].concat(e.stopMousedown?[Bo(Hn(),(function(e,t){t.event().prevent()}))]:[]))}}),eh=[wa("onFocus"),zt("stopMousedown",!1),zt("ignore",!1)],th=ps({fields:eh,name:"focusing",active:Qf,apis:Jf}),nh=function(e,t,n){var o=t.aria;o.update(e,o,n.get())},oh=function(e,t,n){t.toggleClass.each((function(t){(n.get()?Qi:er)(e.element(),t)}))},ih=function(e,t,n){sh(e,t,n,!n.get())},rh=function(e,t,n){n.set(!0),oh(e,t,n),nh(e,t,n)},ah=function(e,t,n){n.set(!1),oh(e,t,n),nh(e,t,n)},sh=function(e,t,n,o){(o?rh:ah)(e,t,n)},lh=function(e,t,n){sh(e,t,n,t.selected)},uh=Object.freeze({__proto__:null,onLoad:lh,toggle:ih,isOn:function(e,t,n){return n.get()},on:rh,off:ah,set:sh}),ch=Object.freeze({__proto__:null,exhibit:function(){return Gi({})},events:function(e,t){var n,o,i,r=(n=e,o=t,i=ih,Go((function(e){i(e,n,o)}))),a=ds(e,t,lh);return Ko(Y([e.toggleOnExecute?[r]:[],[a]]))}}),dh=function(e,t,n){Ci(e.element(),"aria-expanded",n)},fh=[zt("selected",!1),Mt("toggleClass"),zt("toggleOnExecute",!0),Vt("aria",{mode:"none"},pt("mode",{pressed:[zt("syncWithExpanded",!1),Aa("update",(function(e,t,n){Ci(e.element(),"aria-pressed",n),t.syncWithExpanded&&dh(e,0,n)}))],checked:[Aa("update",(function(e,t,n){Ci(e.element(),"aria-checked",n)}))],expanded:[Aa("update",dh)],selected:[Aa("update",(function(e,t,n){Ci(e.element(),"aria-selected",n)}))],none:[Aa("update",t)]}))],hh=ps({fields:fh,name:"toggling",active:ch,apis:uh,state:{init:function(){var e=Xt(!1);return{get:function(){return e.get()},set:function(t){return e.set(t)},clear:function(){return e.set(!1)},readState:function(){return e.get()}}}}}),gh=function(){var e=function(e,t){t.stop(),ko(e)};return[Bo(Qn(),e),Bo(uo(),e),Wo(Bn()),Wo(Hn())]},mh=function(e){return Ko(Y([e.map((function(e){return Go((function(t,n){e(t),n.stop()}))})).toArray(),gh()]))},ph="alloy.item-hover",vh="alloy.item-focus",yh=function(e){(Ds(e.element()).isNone()||th.isFocused(e))&&(th.isFocused(e)||th.focus(e),So(e,ph,{item:e}))},bh=function(e){So(e,vh,{item:e})},Ch=o(ph),Th=o(vh),xh=[Dt("data"),Dt("components"),Dt("dom"),zt("hasSubmenu",!1),Mt("toggling"),Hu("itemBehaviours",[hh,th,$f,Bu]),zt("ignoreFocus",!1),zt("domModification",{}),Aa("builder",(function(e){return{dom:e.dom,domModification:f(f({},e.domModification),{attributes:f(f(f({role:e.toggling.isSome()?"menuitemcheckbox":"menuitem"},e.domModification.attributes),{"aria-haspopup":e.hasSubmenu}),e.hasSubmenu?{"aria-expanded":!1}:{})}),behaviours:Wu(e.itemBehaviours,[e.toggling.fold(hh.revoke,(function(e){return hh.config(f({aria:{mode:"checked"}},e))})),th.config({ignore:e.ignoreFocus,stopMousedown:e.ignoreFocus,onFocus:function(e){bh(e)}}),$f.config({mode:"execution"}),Bu.config({store:{mode:"memory",initialValue:e.data}}),Yf("item-type-events",g(gh(),[Bo(qn(),yh),Bo(lo(),th.focus)]))]),components:e.components,eventOrder:e.eventOrder}})),zt("eventOrder",{})],Eh=[Dt("dom"),Dt("components"),Aa("builder",(function(e){return{dom:e.dom,components:e.components,events:Ko([(t=lo(),Bo(t,(function(e,t){t.stop()})))])};var t}))],_h=o([fc({name:"widget",overrides:function(e){return{behaviours:gs([Bu.config({store:{mode:"manual",getValue:function(t){return e.data},setValue:function(){}}})])}}})]),Ih=[Dt("uid"),Dt("data"),Dt("components"),Dt("dom"),zt("autofocus",!1),zt("ignoreFocus",!1),Hu("widgetBehaviours",[Bu,th,$f]),zt("domModification",{}),Nc(_h()),Aa("builder",(function(e){var t=_c(0,e,_h()),n=Ic("item-widget",e,t.internals()),o=function(t){return Dc(t,e,"widget").map((function(e){return $f.focusIn(e),e}))},i=function(t,n){return Wc(n.event().target())||e.autofocus&&n.setSource(t.element()),E.none()};return{dom:e.dom,components:n,domModification:e.domModification,events:Ko([Go((function(e,t){o(e).each((function(e){t.stop()}))})),Bo(qn(),yh),Bo(lo(),(function(t,n){e.autofocus?o(t):th.focus(t)}))]),behaviours:Wu(e.widgetBehaviours,[Bu.config({store:{mode:"memory",initialValue:e.data}}),th.config({ignore:e.ignoreFocus,onFocus:function(e){bh(e)}}),$f.config({mode:"special",focusIn:e.autofocus?function(e){o(e)}:bs(),onLeft:i,onRight:i,onEscape:function(t,n){return th.isFocused(t)||e.autofocus?(e.autofocus&&n.setSource(t.element()),E.none()):(th.focus(t),E.some(!0))}})])}}))],Dh=pt("type",{widget:Ih,item:xh,separator:Eh}),Oh=o([mc({factory:{sketch:function(e){var t=ht("menu.spec item",Dh,e);return t.builder(t)}},name:"items",unit:"item",defaults:function(e,t){return t.hasOwnProperty("uid")?t:f(f({},t),{uid:Pi("item")})},overrides:function(e,t){return{type:t.type,ignoreFocus:e.fakeFocus,domModification:{classes:[e.markers.item]}}}})]),wh=o([Dt("value"),Dt("items"),Dt("dom"),Dt("components"),zt("eventOrder",{}),Fu("menuBehaviours",[nd,Bu,qc,$f]),Vt("movement",{mode:"menu",moveOnTab:!0},pt("mode",{grid:[Ma(),Aa("config",(function(e,t){return{mode:"flatgrid",selector:"."+e.markers.item,initSize:{numColumns:t.initSize.numColumns,numRows:t.initSize.numRows},focusManager:e.focusManager}}))],matrix:[Aa("config",(function(e,t){return{mode:"matrix",selectors:{row:t.rowSelector,cell:"."+e.markers.item},focusManager:e.focusManager}})),Dt("rowSelector")],menu:[zt("moveOnTab",!0),Aa("config",(function(e,t){return{mode:"menu",selector:"."+e.markers.item,moveOnTab:t.moveOnTab,focusManager:e.focusManager}}))]})),Ot("markers",Ea()),zt("fakeFocus",!1),zt("focusManager",gd()),wa("onHighlight")]),Rh=o("alloy.menu-focus"),Sh=Vc({name:"Menu",configFields:wh(),partFields:Oh(),factory:function(e,t,n,o){return{uid:e.uid,dom:e.dom,markers:e.markers,behaviours:Vu(e.menuBehaviours,[nd.config({highlightClass:e.markers.selectedItem,itemClass:e.markers.item,onHighlight:e.onHighlight}),Bu.config({store:{mode:"memory",initialValue:e.value}}),qc.config({find:E.some}),$f.config(e.movement.config(e,e.movement))]),events:Ko([Bo(Th(),(function(e,t){var n=t.event();e.getSystem().getByDom(n.target()).each((function(n){nd.highlight(e,n),t.stop(),So(e,Rh(),{menu:e,item:n})}))})),Bo(Ch(),(function(e,t){var n=t.event().item();nd.highlight(e,n)}))]),components:t,eventOrder:e.eventOrder,domModification:{attributes:{role:"menu"}}}}}),kh=function(e,t,n,o){return Oe(n,o).bind((function(o){return Oe(e,o).bind((function(o){var i=kh(e,t,n,o);return E.some([o].concat(i))}))})).getOr([])},Ah=function(e){return"prepared"===e.type?E.some(e.menu):E.none()},Nh=Ah,Mh=o("collapse-item"),Kh=zc({name:"TieredMenu",configFields:[ka("onExecute"),ka("onEscape"),Sa("onOpenMenu"),Sa("onOpenSubmenu"),wa("onRepositionMenu"),wa("onCollapseMenu"),zt("highlightImmediately",!0),kt("data",[Dt("primary"),Dt("menus"),Dt("expansions")]),zt("fakeFocus",!1),wa("onHighlight"),wa("onHover"),Ia(),Dt("dom"),zt("navigateOnHover",!0),zt("stayInDom",!1),Fu("tmenuBehaviours",[$f,nd,qc,Xf]),zt("eventOrder",{})],apis:{collapseMenu:function(e,t){e.collapseMenu(t)},highlightPrimary:function(e,t){e.highlightPrimary(t)},repositionMenus:function(e,t){e.repositionMenus(t)}},factory:function(e,t){var n,o,i=Xt(E.none()),r=function(){var e=Xt({}),t=Xt({}),n=Xt({}),o=Xt(E.none()),i=Xt({}),r=function(t,n,o){return a(t).bind((function(i){return r=t,Ie(e.get(),(function(e,t){return e===r})).bind((function(e){return n(e).map((function(e){return{triggeredMenu:i,triggeringItem:e,triggeringPath:o}}))}));var r}))},a=function(e){return s(e).bind(Ah)},s=function(e){return Oe(t.get(),e)},l=function(t){return Oe(e.get(),t)};return{setMenuBuilt:function(e,n){var o;t.set(f(f({},t.get()),((o={})[e]={type:"prepared",menu:n},o)))},setContents:function(r,a,s,l){o.set(E.some(r)),e.set(s),t.set(a),i.set(l);var u=function(e,t){var n={};Te(e,(function(e,t){W(e,(function(e){n[e]=t}))}));var o=t,i=Ee(t,(function(e,t){return{k:e,v:t}})),r=xe(i,(function(e,t){return[t].concat(kh(n,o,i,t))}));return xe(n,(function(e){return Oe(r,e).getOr([e])}))}(l,s);n.set(u)},expand:function(t){return Oe(e.get(),t).map((function(e){var o=Oe(n.get(),t).getOr([]);return[e].concat(o)}))},refresh:function(e){return Oe(n.get(),e)},collapse:function(e){return Oe(n.get(),e).bind((function(e){return 1<e.length?E.some(e.slice(1)):E.none()}))},lookupMenu:s,lookupItem:l,otherMenus:function(e){var t=i.get();return ee(be(t),e)},getPrimary:function(){return o.get().bind(a)},getMenus:function(){return t.get()},clear:function(){e.set({}),t.set({}),n.set({}),o.set(E.none())},isClear:function(){return o.get().isNone()},getTriggeringPath:function(e,t){var i=U(l(e).toArray(),(function(e){return a(e).isSome()}));return Oe(n.get(),e).bind((function(e){var n=Q(i.concat(e));return function(e){for(var t=[],n=0;n<e.length;n++){var o=e[n];if(!o.isSome())return E.none();t.push(o.getOrDie())}return E.some(t)}(Z(n,(function(e,i){return r(e,t,n.slice(0,i+1)).fold((function(){return o.get().is(e)?[]:[E.none()]}),(function(e){return[E.some(e)]}))})))}))}}}(),a=function(e){return Bu.getValue(e).value},s=function(e,t){nd.highlight(e,t),nd.getHighlighted(t).orThunk((function(){return nd.getFirst(t)})).each((function(t){Ao(e,t.element(),lo())}))},l=function(e,t){return Hc(H(t,(function(t){return e.lookupMenu(t).bind((function(e){return"prepared"===e.type?E.some(e.menu):E.none()}))})))},u=function(t,n,o){var i=l(n,n.otherMenus(o));W(i,(function(n){or(n.element(),[e.markers.backgroundMenu]),e.stayInDom||Xf.remove(t,n)}))},c=function(t,n){var o,r=(o=t,i.get().getOrThunk((function(){var t={},n=ml(o.element(),"."+e.markers.item),r=U(n,(function(e){return"true"===Ti(e,"aria-haspopup")}));return W(r,(function(e){o.getSystem().getByDom(e).each((function(e){var n=a(e);t[n]=e}))})),i.set(E.some(t)),t})));Te(r,(function(e,t){var o=B(n,t);Ci(e.element(),"aria-expanded",o)}))},d=function(t,n,o){return E.from(o[0]).bind((function(i){return n.lookupMenu(i).bind((function(i){if("notbuilt"===i.type)return E.none();var r=i.menu,a=l(n,o.slice(1));return W(a,(function(t){Qi(t.element(),e.markers.backgroundMenu)})),cr(r.element())||Xf.append(t,kr(r)),or(r.element(),[e.markers.backgroundMenu]),s(t,r),u(t,n,o),E.some(r)}))}))};(o=n=n||{})[o.HighlightSubmenu=0]="HighlightSubmenu",o[o.HighlightParent=1]="HighlightParent";var h=function(t,o,i){void 0===i&&(i=n.HighlightSubmenu);var s=a(o);return r.expand(s).bind((function(a){return c(t,a),E.from(a[0]).bind((function(s){return r.lookupMenu(s).bind((function(l){var u=function(e,t,n){if("notbuilt"!==n.type)return n.menu;var o=e.getSystem().build(n.nbMenu());return r.setMenuBuilt(t,o),o}(t,s,l);return cr(u.element())||Xf.append(t,kr(u)),e.onOpenSubmenu(t,o,u,Q(a)),i===n.HighlightSubmenu?(nd.highlightFirst(u),d(t,r,a)):(nd.dehighlightAll(u),E.some(o))}))}))}))},g=function(t,n){var o=a(n);return r.collapse(o).bind((function(o){return c(t,o),d(t,r,o).map((function(o){return e.onCollapseMenu(t,n,o),o}))}))},m=function(t){return function(n,o){return fa(o.getSource(),"."+e.markers.item).bind((function(e){return n.getSystem().getByDom(e).toOption().bind((function(e){return t(n,e).map((function(){return!0}))}))}))}},p=Ko([Bo(Rh(),(function(e,t){var n=t.event().item();r.lookupItem(a(n)).each((function(){var n=t.event().menu();nd.highlight(e,n);var o=a(t.event().item());r.refresh(o).each((function(t){return u(e,r,t)}))}))})),Go((function(t,o){var i=o.event().target();t.getSystem().getByDom(i).each((function(o){0===a(o).indexOf("collapse-item")&&g(t,o),h(t,o,n.HighlightSubmenu).fold((function(){e.onExecute(t,o)}),(function(){}))}))})),Uo((function(t,n){(function(t){var n,o,i=(n=t,o=e.data.primary,xe(e.data.menus,(function(t,i){var r=function(){return Sh.sketch(f(f({},t),{value:i,markers:e.markers,fakeFocus:e.fakeFocus,onHighlight:e.onHighlight,focusManager:(e.fakeFocus?md:gd)()}))};return i===o?{type:"prepared",menu:n.getSystem().build(r())}:{type:"notbuilt",nbMenu:r}}))),a=xe(e.data.menus,(function(e,t){return Z(e.items,(function(e){return"separator"===e.type?[]:[e.data.value]}))}));return r.setContents(e.data.primary,i,e.data.expansions,a),r.getPrimary()})(t).each((function(n){Xf.append(t,kr(n)),e.onOpenMenu(t,n),e.highlightImmediately&&s(t,n)}))}))].concat(e.navigateOnHover?[Bo(Ch(),(function(t,o){var i,s,l=o.event().item();i=t,s=a(l),r.refresh(s).bind((function(e){return c(i,e),d(i,r,e)})),h(t,l,n.HighlightParent),e.onHover(t,l)}))]:[])),v=function(e){return nd.getHighlighted(e).bind(nd.getHighlighted)},y={collapseMenu:function(e){v(e).each((function(t){g(e,t)}))},highlightPrimary:function(e){r.getPrimary().each((function(t){s(e,t)}))},repositionMenus:function(t){r.getPrimary().bind((function(e){return v(t).bind((function(e){var t=a(e),n=De(r.getMenus()),o=Hc(H(n,Nh));return r.getTriggeringPath(t,(function(e){return t=e,re(o,(function(e){if(!e.getSystem().isConnected())return E.none();var n=nd.getCandidates(e);return G(n,(function(e){return a(e)===t}))}));var t}))})).map((function(t){return{primary:e,triggeringPath:t}}))})).fold((function(){E.from(t.components()[0]).filter((function(e){return"menu"===Ti(e.element(),"role")})).each((function(n){e.onRepositionMenu(t,n,[])}))}),(function(n){e.onRepositionMenu(t,n.primary,n.triggeringPath)}))}};return{uid:e.uid,dom:e.dom,markers:e.markers,behaviours:Vu(e.tmenuBehaviours,[$f.config({mode:"special",onRight:m((function(e,t){return Wc(t.element())?E.none():h(e,t,n.HighlightSubmenu)})),onLeft:m((function(e,t){return Wc(t.element())?E.none():g(e,t)})),onEscape:m((function(t,n){return g(t,n).orThunk((function(){return e.onEscape(t,n).map((function(){return t}))}))})),focusIn:function(e,t){r.getPrimary().each((function(t){Ao(e,t.element(),lo())}))}}),nd.config({highlightClass:e.markers.selectedMenu,itemClass:e.markers.menu}),qc.config({find:function(e){return nd.getHighlighted(e)}}),Xf.config({})]),eventOrder:e.eventOrder,apis:y,events:p}},extraApis:{tieredData:function(e,t,n){return{primary:e,menus:t,expansions:n}},singleData:function(e,t){return{primary:e,menus:$e(e,t),expansions:{}}},collapseItem:function(e){return{value:Ri(Mh()),meta:{text:e}}}}}),Ph=zc({name:"InlineView",configFields:[Dt("lazySink"),wa("onShow"),wa("onHide"),Bt("onEscape"),Fu("inlineBehaviours",[yu,Bu,xs]),Ft("fireDismissalEventInstead",[zt("event",To())]),Ft("fireRepositionEventInstead",[zt("event",xo())]),zt("getRelated",E.none),zt("isExtraPart",u),zt("eventOrder",E.none)],factory:function(e,t){var n=function(e,t,n,i){o(e,t,n,(function(){return i.map((function(e){return ta(e)}))}))},o=function(t,n,o,i){var r=e.lazySink(t).getOrDie();yu.openWhileCloaked(t,o,(function(){return Yl.positionWithinBounds(r,n,t,i())})),Bu.setValue(t,E.some({mode:"position",anchor:n,getBounds:i}))},i=function(t,n,o,i){var r,a,s,l,u,c,d,h,g=(r=e,a=t,s=n,u=i,c=function(){return r.lazySink(a)},d="horizontal"===(l=o).type?{layouts:{onLtr:function(){return us()},onRtl:function(){return cs()}}}:{},h=function(e){return 2===e.length?d:{}},Kh.sketch({dom:{tag:"div"},data:l.data,markers:l.menu.markers,highlightImmediately:l.menu.highlightImmediately,onEscape:function(){return yu.close(a),r.onEscape.map((function(e){return e(a)})),E.some(!0)},onExecute:function(){return E.some(!0)},onOpenMenu:function(e,t){Yl.positionWithinBounds(c().getOrDie(),s,t,u())},onOpenSubmenu:function(e,t,n,o){var i=c().getOrDie();Yl.position(i,f({anchor:"submenu",item:t},h(o)),n)},onRepositionMenu:function(e,t,n){var o=c().getOrDie();Yl.positionWithinBounds(o,s,t,u()),W(n,(function(e){var t=h(e.triggeringPath);Yl.position(o,f({anchor:"submenu",item:e.triggeringItem},t),e.triggeredMenu)}))}}));yu.open(t,g),Bu.setValue(t,E.some({mode:"menu",menu:g}))},r=function(t){yu.isOpen(t)&&Bu.getValue(t).each((function(n){switch(n.mode){case"menu":yu.getState(t).each((function(e){Kh.repositionMenus(e)}));break;case"position":var o=e.lazySink(t).getOrDie();Yl.positionWithinBounds(o,n.anchor,t,n.getBounds())}}))},a={setContent:function(e,t){yu.setContent(e,t)},showAt:function(e,t,o){n(e,t,o,E.none())},showWithin:n,showWithinBounds:o,showMenuAt:function(e,t,n){i(e,t,n,(function(){return E.none()}))},showMenuWithinBounds:i,hide:function(e){yu.isOpen(e)&&(Bu.setValue(e,E.none()),yu.close(e))},getContent:function(e){return yu.getState(e)},reposition:r,isOpen:yu.isOpen};return{uid:e.uid,dom:e.dom,behaviours:Vu(e.inlineBehaviours,[yu.config({isPartOf:function(t,n,o){return ga(n,o)||(i=o,e.getRelated(t).exists((function(e){return ga(e,i)})));var i},getAttachPoint:function(t){return e.lazySink(t).getOrDie()},onOpen:function(t){e.onShow(t)},onClose:function(t){e.onHide(t)}}),Bu.config({store:{mode:"memory",initialValue:E.none()}}),xs.config({channels:f(f({},Eu(f({isExtraPart:t.isExtraPart},e.fireDismissalEventInstead.map((function(e){return{fireEventInstead:{event:e.event}}})).getOr({})))),Iu(f(f({},e.fireRepositionEventInstead.map((function(e){return{fireEventInstead:{event:e.event}}})).getOr({})),{doReposition:r})))})]),eventOrder:e.eventOrder,apis:a}},apis:{showAt:function(e,t,n,o){e.showAt(t,n,o)},showWithin:function(e,t,n,o,i){e.showWithin(t,n,o,i)},showWithinBounds:function(e,t,n,o,i){e.showWithinBounds(t,n,o,i)},showMenuAt:function(e,t,n,o){e.showMenuAt(t,n,o)},showMenuWithinBounds:function(e,t,n,o,i){e.showMenuWithinBounds(t,n,o,i)},hide:function(e,t){e.hide(t)},isOpen:function(e,t){return e.isOpen(t)},getContent:function(e,t){return e.getContent(t)},setContent:function(e,t,n){e.setContent(t,n)},reposition:function(e,t){e.reposition(t)}}}),Lh=function(e){return e.x},Bh=function(e,t){return e.x+e.width/2-t.width/2},Fh=function(e,t){return e.x+e.width-t.width},zh=function(e){return e.y},Vh=function(e,t){return e.y+e.height-t.height},Hh=function(e,t,n){return Ka(Fh(e,t),Vh(e,t),n.innerSoutheast(),za(),Ua(e,{right:0,bottom:3}),"layout-inner-se")},Wh=function(e,t,n){return Ka(Lh(e),Vh(e,t),n.innerSouthwest(),Fa(),Ua(e,{left:1,bottom:3}),"layout-inner-sw")},$h=function(e,t,n){return Ka(Fh(e,t),zh(e),n.innerNortheast(),Ba(),Ua(e,{right:0,top:2}),"layout-inner-ne")},Uh=function(e,t,n){return Ka(Lh(e),zh(e),n.innerNorthwest(),La(),Ua(e,{left:1,top:2}),"layout-inner-nw")},qh=function(e,t,n){return Ka(Bh(e,t),zh(e),n.innerNorth(),Va(),Ua(e,{top:2}),"layout-inner-n")},jh=function(e,t,n){return Ka(Bh(e,t),Vh(e,t),n.innerSouth(),Ha(),Ua(e,{bottom:3}),"layout-inner-s")},Gh=tinymce.util.Tools.resolve("tinymce.util.Delay"),Xh=zc({name:"Button",factory:function(e){var t=mh(e.action),n=e.dom.tag,o=function(t){return Oe(e.dom,"attributes").bind((function(e){return Oe(e,t)}))};return{uid:e.uid,dom:e.dom,components:e.components,events:t,behaviours:Wu(e.buttonBehaviours,[th.config({}),$f.config({mode:"execution",useSpace:!0,useEnter:!0})]),domModification:{attributes:function(){if("button"!==n)return{role:o("role").getOr("button")};var e=o("type").getOr("button"),t=o("role").map((function(e){return{role:e}})).getOr({});return f({type:e},t)}()},eventOrder:e.eventOrder}},configFields:[zt("uid",void 0),Dt("dom"),zt("components",[]),Hu("buttonBehaviours",[th,$f]),Mt("action"),Mt("role"),zt("eventOrder",{})]}),Yh=function(e){var t=function(e){return void 0!==e.uid}(e)&&Re(e,"uid")?e.uid:Pi("memento");return{get:function(e){return e.getSystem().getByUid(t).getOrDie()},getOpt:function(e){return e.getSystem().getByUid(t).toOption()},asSpec:function(){return f(f({},e),{uid:t})}}},Zh=function(e){return E.from(e()["temporary-placeholder"]).getOr("!not found!")},Jh=function(e,t){return E.from(t()[e.toLowerCase()]).getOrThunk((function(){return Zh(t)}))},Qh={success:"checkmark",error:"warning",err:"error",warning:"warning",warn:"warning",info:"info"},eg=zc({name:"Notification",factory:function(e){var t,n,o=Yh({dom:{tag:"p",innerHtml:e.translationProvider(e.text)},behaviours:gs([Xf.config({})])}),i=function(e){return{dom:{tag:"div",classes:["tox-bar"],attributes:{style:"width: "+e+"%"}}}},r=function(e){return{dom:{tag:"div",classes:["tox-text"],innerHtml:e+"%"}}},a=Yh({dom:{tag:"div",classes:e.progress?["tox-progress-bar","tox-progress-indicator"]:["tox-progress-bar"]},components:[{dom:{tag:"div",classes:["tox-bar-container"]},components:[i(0)]},r(0)],behaviours:gs([Xf.config({})])}),s={updateProgress:function(e,t){e.getSystem().isConnected()&&a.getOpt(e).each((function(e){Xf.set(e,[{dom:{tag:"div",classes:["tox-bar-container"]},components:[i(t)]},r(t)])}))},updateText:function(e,t){if(e.getSystem().isConnected()){var n=o.get(e);Xf.set(n,[Or(t)])}}},l=Y([e.icon.toArray(),e.level.toArray(),e.level.bind((function(e){return E.from(Qh[e])})).toArray()]),u=Yh(Xh.sketch({dom:{tag:"button",classes:["tox-notification__dismiss","tox-button","tox-button--naked","tox-button--icon"]},components:[{dom:{tag:"div",classes:["tox-icon"],innerHtml:Jh("close",e.iconProvider),attributes:{"aria-label":e.translationProvider("Close")}}}],action:function(t){e.onAction(t)}})),c=[{dom:{tag:"div",classes:["tox-notification__icon"],innerHtml:(t=l,n=e.iconProvider,re(t,(function(e){return E.from(n()[e.toLowerCase()])})).getOrThunk((function(){return Zh(n)})))}},{dom:{tag:"div",classes:["tox-notification__body"]},components:[o.asSpec()],behaviours:gs([Xf.config({})])}];return{uid:e.uid,dom:{tag:"div",attributes:{role:"alert"},classes:e.level.map((function(e){return["tox-notification","tox-notification--in","tox-notification--"+e]})).getOr(["tox-notification","tox-notification--in"])},behaviours:gs([th.config({}),Yf("notification-events",[Bo(jn(),(function(e){u.getOpt(e).each(th.focus)}))])]),components:c.concat(e.progress?[a.asSpec()]:[]).concat(e.closeButton?[u.asSpec()]:[]),apis:s}},configFields:[Mt("level"),Dt("progress"),Dt("icon"),Dt("onAction"),Dt("text"),Dt("iconProvider"),Dt("translationProvider"),Ut("closeButton",!0)],apis:{updateProgress:function(e,t,n){e.updateProgress(t,n)},updateText:function(e,t,n){e.updateText(t,n)}}}),tg=function(t,n){var o=null;return{cancel:function(){null!==o&&(e.clearTimeout(o),o=null)},throttle:function(){for(var i=[],r=0;r<arguments.length;r++)i[r]=arguments[r];null!==o&&e.clearTimeout(o),o=e.setTimeout((function(){t.apply(null,i),o=null}),n)}}},ng=tinymce.util.Tools.resolve("tinymce.dom.TextSeeker"),og=function(e,t,n,o,i){var r=ng(e,(function(t){return(n=e).isBlock(o=t)||B(["BR","IMG","HR","INPUT"],o.nodeName)||"false"===n.getContentEditable(o);var n,o}));return E.from(r.backwards(t,n,o,i))},ig=function(e){return fa(e,"[data-mce-autocompleter]")},rg=function(e){return e.toString().replace(/\u00A0/g," ").replace(/\uFEFF/g,"")},ag=function(e){return""!==e&&-1!=="  \f\n\r\t\v".indexOf(e)},sg=function(e,t){return e.substring(t.length)},lg=function(e,t,n,o){return void 0===o&&(o=0),ig(en(t.startContainer)).fold((function(){return function(e,t,n,o){if(void 0===o&&(o=0),!(i=t).collapsed||3!==i.startContainer.nodeType)return E.none();var i,r=e.getParent(t.startContainer,e.isBlock)||e.getRoot();return og(e,t.startContainer,t.startOffset,(function(e,t,o){return function(e,t,n){var o;for(o=t-1;0<=o;o--){var i=e.charAt(o);if(ag(i))return E.none();if(i===n)break}return E.some(o)}(o,t,n).getOr(t)}),r).bind((function(e){var i=t.cloneRange();if(i.setStart(e.container,e.offset),i.setEnd(t.endContainer,t.endOffset),i.collapsed)return E.none();var r=rg(i);return 0!==r.lastIndexOf(n)||sg(r,n).length<o?E.none():E.some({text:sg(r,n),range:i,triggerChar:n})}))}(e,t,n,o)}),(function(t){var o=e.createRng();o.selectNode(t.dom());var i=rg(o);return E.some({range:o,text:sg(i,n),triggerChar:n})}))},ug=tinymce.util.Tools.resolve("tinymce.util.Promise"),cg=function(e,t){return{container:e,offset:t}},dg=function(t){if(t.nodeType===e.Node.TEXT_NODE)return cg(t,t.data.length);var n=t.childNodes;return 0<n.length?dg(n[n.length-1]):cg(t,n.length)},fg=function(t,n){var o=t.childNodes;return 0<o.length&&n<o.length?fg(o[n],0):0<o.length&&t.nodeType===e.Node.ELEMENT_NODE&&o.length===n?dg(o[o.length-1]):cg(t,n)},hg=function(e,t,n,o){void 0===o&&(o={});var i=t(),r=e.selection.getRng().startContainer.nodeValue,a=U(i.lookupByChar(n.triggerChar),(function(t){return n.text.length>=t.minChars&&t.matches.getOrThunk((function(){return function(e){return function(t){var n,o,i=fg(t.startContainer,t.startOffset);return!og(n=e,(o=i).container,o.offset,(function(e,t){return 0===t?-1:t}),n.getRoot()).filter((function(e){var t=e.container.data.charAt(e.offset-1);return!ag(t)})).isSome()}}(e.dom)}))(n.range,r,n.text)}));if(0===a.length)return E.none();var s=ug.all(H(a,(function(e){return e.fetch(n.text,e.maxResults,o).then((function(t){return{matchText:n.text,items:t,columns:e.columns,onAction:e.onAction}}))})));return E.some({lookupData:s,context:n})},gg=et([wt("type"),Lt("text")]),mg=et([Gt("type",(function(){return"autocompleteitem"})),Gt("active",(function(){return!1})),Gt("disabled",(function(){return!1})),zt("meta",{}),wt("value"),Lt("text"),Lt("icon")]),pg=et([wt("type"),wt("ch"),Ht("minChars",1),zt("columns",1),Ht("maxResults",10),Bt("matches"),St("fetch"),St("onAction")]);(vd=pd=pd||{})[vd.CLOSE_ON_EXECUTE=0]="CLOSE_ON_EXECUTE",vd[vd.BUBBLE_TO_SANDBOX=1]="BUBBLE_TO_SANDBOX";var vg,yg,bg=pd,Cg="tox-menu-nav__js",Tg="tox-collection__item",xg={normal:Cg,color:"tox-swatch"},Eg="tox-collection__item--enabled",_g="tox-collection__item-label",Ig="tox-collection__item-caret",Dg="tox-collection__item--active",Og=function(e){return Oe(xg,e).getOr(Cg)},wg=function(e){return{backgroundMenu:"tox-background-menu",selectedMenu:"tox-selected-menu",selectedItem:"tox-collection__item--active",hasIcons:"tox-menu--has-icons",menu:"color"===e?"tox-swatches":"tox-menu",tieredMenu:"tox-tiered-menu"}},Rg=function(e){var t=wg(e);return{backgroundMenu:t.backgroundMenu,selectedMenu:t.selectedMenu,menu:t.menu,selectedItem:t.selectedItem,item:Og(e)}},Sg=[Sh.parts().items({})],kg=function(e,t,n){var o=wg(n);return{dom:{tag:"div",classes:Y([[o.tieredMenu]])},markers:Rg(n)}},Ag=function(e,t){return function(n){var o=V(n,t);return H(o,(function(t){return{dom:e,components:t}}))}},Ng=function(e,t){var n=[],o=[];return W(e,(function(e,i){t(e,i)?(0<o.length&&n.push(o),o=[],we(e.dom,"innerHtml")&&o.push(e)):o.push(e)})),0<o.length&&n.push(o),H(n,(function(e){return{dom:{tag:"div",classes:["tox-collection__group"]},components:e}}))},Mg=function(e,t,n){return{dom:{tag:"div",classes:["tox-menu","tox-collection"].concat(1===e?["tox-collection--list"]:["tox-collection--grid"])},components:[Sh.parts().items({preprocess:function(n){return"auto"!==e&&1<e?Ag({tag:"div",classes:["tox-collection__group"]},e)(n):Ng(n,(function(e,n){return"separator"===t[n].type}))}})]}},Kg=function(e){return F(e,(function(e){return"icon"in e&&void 0!==e.icon}))},Pg=function(t){return e.console.error(gt(t)),e.console.log(t),E.none()},Lg=function(e,t,n,o,i){var r,a=(r=n,{dom:{tag:"div",classes:["tox-collection","tox-collection--horizontal"]},components:[Sh.parts().items({preprocess:function(e){return Ng(e,(function(e,t){return"separator"===r[t].type}))}})]});return{value:e,dom:a.dom,components:a.components,items:n}},Bg=function(e,t,n,o,r){var a,s,l,u,c,d;return"color"===r?{value:e,dom:(a=o,d={dom:{tag:"div",classes:["tox-menu","tox-swatches-menu"]},components:[{dom:{tag:"div",classes:["tox-swatches"]},components:[Sh.parts().items({preprocess:"auto"!==a?Ag({tag:"div",classes:["tox-swatches__row"]},a):i})]}]}).dom,components:d.components,items:n}:"normal"===r&&"auto"===o?{value:e,dom:(d=Mg(o,n)).dom,components:d.components,items:n}:"normal"===r&&1===o?{value:e,dom:(d=Mg(1,n)).dom,components:d.components,items:n}:"normal"===r?{value:e,dom:(d=Mg(o,n)).dom,components:d.components,items:n}:"listpreview"!==r||"auto"===o?{value:e,dom:(l=t,u=o,c=wg(r),{tag:"div",classes:Y([[c.menu,"tox-menu-"+u+"-column"],l?[c.hasIcons]:[]])}),components:Sg,items:n}:{value:e,dom:(s=o,d={dom:{tag:"div",classes:["tox-menu","tox-collection","tox-collection--toolbar","tox-collection--toolbar-lg"]},components:[Sh.parts().items({preprocess:Ag({tag:"div",classes:["tox-collection__group"]},s)})]}).dom,components:d.components,items:n}},Fg=[Ut("disabled",!1),Lt("text"),Lt("shortcut"),rt("value","value",ze((function(){return Ri("menuitem-value")})),vt()),zt("meta",{})],zg=et([wt("type"),Ut("active",!1),Lt("icon")].concat(Fg)),Vg=et([wt("type"),Rt("fancytype",["inserttable","colorswatch"]),qt("onAction",t)]),Hg=et([wt("type"),qt("onSetup",(function(){return t})),qt("onAction",t),Lt("icon")].concat(Fg)),Wg=et([wt("type"),St("getSubmenuItems"),qt("onSetup",(function(){return t})),Lt("icon")].concat(Fg)),$g=et([wt("type"),Lt("icon"),Ut("active",!1),qt("onSetup",(function(){return t})),St("onAction")].concat(Fg)),Ug=function(e,t,n){var o=ml(e.element(),"."+n);if(0<o.length){var i=X(o,(function(e){var n=e.dom().getBoundingClientRect().top,i=o[0].dom().getBoundingClientRect().top;return Math.abs(n-i)>t})).getOr(o.length);return E.some({numColumns:i,numRows:Math.ceil(o.length/i)})}return E.none()},qg=function(e){return function(e,t){return gs([Yf(e,t)])}(Ri("unnamed-events"),e)},jg=[Dt("lazySink"),Dt("tooltipDom"),zt("exclusive",!0),zt("tooltipComponents",[]),zt("delay",300),$t("mode","normal",["normal","follow-highlight"]),zt("anchor",(function(e){return{anchor:"hotspot",hotspot:e,layouts:{onLtr:o([os,ns,Ja,es,Qa,ts]),onRtl:o([os,ns,Ja,es,Qa,ts])}}})),wa("onHide"),wa("onShow")],Gg=Object.freeze({__proto__:null,init:function(){var t=Xt(E.none()),n=Xt(E.none()),i=function(){t.get().each((function(t){e.clearTimeout(t)}))},r=o("not-implemented");return qi({getTooltip:function(){return n.get()},isShowing:function(){return n.get().isSome()},setTooltip:function(e){n.set(E.some(e))},clearTooltip:function(){n.set(E.none())},clearTimer:i,resetTimer:function(n,o){i(),t.set(E.some(e.setTimeout((function(){n()}),o)))},readState:r})}}),Xg=Ri("tooltip.exclusive"),Yg=Ri("tooltip.show"),Zg=Ri("tooltip.hide"),Jg=function(e,t,n){e.getSystem().broadcastOn([Xg],{})},Qg=Object.freeze({__proto__:null,hideAllExclusive:Jg,setComponents:function(e,t,n,o){n.getTooltip().each((function(e){e.getSystem().isConnected()&&Xf.set(e,o)}))}}),em=ps({fields:jg,name:"tooltipping",active:Object.freeze({__proto__:null,events:function(e,t){var n=function(n){t.getTooltip().each((function(o){iu(o),e.onHide(n,o),t.clearTooltip()})),t.clearTimer()};return Ko(Y([[Bo(Yg,(function(n){t.resetTimer((function(){!function(n){if(!t.isShowing()){Jg(n);var o=e.lazySink(n).getOrDie(),i=n.getSystem().build({dom:e.tooltipDom,components:e.tooltipComponents,events:Ko("normal"===e.mode?[Bo(qn(),(function(e){Ro(n,Yg)})),Bo($n(),(function(e){Ro(n,Zg)}))]:[]),behaviours:gs([Xf.config({})])});t.setTooltip(i),tu(o,i),e.onShow(n,i),Yl.position(o,e.anchor(n),i)}}(n)}),e.delay)})),Bo(Zg,(function(o){t.resetTimer((function(){n(o)}),e.delay)})),Bo(ao(),(function(e,t){B(t.channels(),Xg)&&n(e)})),qo((function(e){n(e)}))],"normal"===e.mode?[Bo(jn(),(function(e){Ro(e,Yg)})),Bo(io(),(function(e){Ro(e,Zg)})),Bo(qn(),(function(e){Ro(e,Yg)})),Bo($n(),(function(e){Ro(e,Zg)}))]:[Bo(Oo(),(function(e,t){Ro(e,Yg)})),Bo(wo(),(function(e){Ro(e,Zg)}))]]))}}),state:Gg,apis:Qg}),tm=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),nm=tinymce.util.Tools.resolve("tinymce.util.I18n"),om=["input","button","textarea","select"],im=function(e,t,n){(t.disabled()?cm:dm)(e,t,n)},rm=function(e,t){return!0===t.useNative&&B(om,Xo(e.element()))},am=function(e){Ci(e.element(),"disabled","disabled")},sm=function(e){_i(e.element(),"disabled")},lm=function(e){Ci(e.element(),"aria-disabled","true")},um=function(e){Ci(e.element(),"aria-disabled","false")},cm=function(e,t,n){t.disableClass.each((function(t){Qi(e.element(),t)})),(rm(e,t)?am:lm)(e),t.onDisabled(e)},dm=function(e,t,n){t.disableClass.each((function(t){er(e.element(),t)})),(rm(e,t)?sm:um)(e),t.onEnabled(e)},fm=function(e,t){return rm(e,t)?Ei(e.element(),"disabled"):"true"===Ti(e.element(),"aria-disabled")},hm=Object.freeze({__proto__:null,enable:dm,disable:cm,isDisabled:fm,onLoad:im,set:function(e,t,n,o){(o?cm:dm)(e,t,n)}}),gm=Object.freeze({__proto__:null,exhibit:function(e,t){return Gi({classes:t.disabled()?t.disableClass.toArray():[]})},events:function(e,t){return Ko([Po(so(),(function(t,n){return fm(t,e)})),ds(e,t,im)])}}),mm=[qt("disabled",u),zt("useNative",!0),Mt("disableClass"),wa("onDisabled"),wa("onEnabled")],pm=ps({fields:mm,name:"disabling",active:gm,apis:hm}),vm=tinymce.util.Tools.resolve("tinymce.EditorManager"),ym=function(e){return e.getParam("height",Math.max(e.getElement().offsetHeight,200))},bm=function(e){return e.getParam("width",tm.DOM.getStyle(e.getElement(),"width"))},Cm=function(e){return E.from(e.getParam("min_width")).filter(A)},Tm=function(e){return E.from(e.getParam("min_height")).filter(A)},xm=function(e){return E.from(e.getParam("max_width")).filter(A)},Em=function(e){return E.from(e.getParam("max_height")).filter(A)},_m=function(e){return!1!==e.getParam("menubar",!0,"boolean")},Im=function(e){var t=e.getParam("toolbar",!0),n=!0===t,o=D(t),i=w(t)&&0<t.length;return!Om(e)&&(i||o||n)},Dm=function(e){var t=z(9,(function(t){return e.getParam("toolbar"+(t+1),!1,"string")})),n=U(t,(function(e){return"string"==typeof e}));return 0<n.length?E.some(n):E.none()},Om=function(e){return Dm(e).fold((function(){return 0<e.getParam("toolbar",[],"string[]").length}),(function(){return!0}))};(yg=vg=vg||{}).default="wrap",yg.floating="floating",yg.sliding="sliding",yg.scrolling="scrolling";var wm,Rm,Sm=function(e){return e.getParam("toolbar_mode","","string")};(Rm=wm=wm||{}).auto="auto",Rm.top="top",Rm.bottom="bottom";var km,Am,Nm=function(e){return e.getParam("toolbar_location",wm.auto,"string")},Mm=function(e){return Nm(e)===wm.bottom},Km=function(e){var t=e.getParam("fixed_toolbar_container","","string");return 0<t.length&&e.inline?da(dr(),t):E.none()},Pm=function(e){return e.inline&&Km(e).isSome()},Lm=function(e){return e.inline&&!_m(e)&&!Im(e)&&!Om(e)},Bm=function(e){return(e.getParam("toolbar_sticky",!1,"boolean")||e.inline)&&!Pm(e)&&!Lm(e)},Fm="silver.readonly",zm=et([Ot("readonly",Tt)]),Vm=function(e,t){var n=e.outerContainer.element();t&&(e.mothership.broadcastOn([bu()],{target:n}),e.uiMothership.broadcastOn([bu()],{target:n})),e.mothership.broadcastOn([Fm],{readonly:t}),e.uiMothership.broadcastOn([Fm],{readonly:t})},Hm=function(e,t){e.on("init",(function(){e.mode.isReadOnly()&&Vm(t,!0)})),e.on("SwitchMode",(function(){return Vm(t,e.mode.isReadOnly())})),e.getParam("readonly",!1,"boolean")&&e.setMode("readonly")},Wm=function(){var e;return xs.config({channels:((e={})[Fm]={schema:zm,onReceive:function(e,t){pm.set(e,t.readonly)}},e)})},$m=function(e){return pm.config({disabled:e,disableClass:"tox-collection__item--state-disabled"})},Um=function(e){return pm.config({disabled:e})},qm=function(e){return pm.config({disabled:e,disableClass:"tox-tbtn--disabled"})},jm=function(e){return pm.config({disabled:e,disableClass:"tox-tbtn--disabled",useNative:!1})},Gm=function(e,t){var n=e.getApi(t);return function(e){e(n)}},Xm=function(e,t){return Uo((function(n){Gm(e,n)((function(n){var o=e.onSetup(n);null!=o&&t.set(o)}))}))},Ym=function(e,t){return qo((function(n){return Gm(e,n)(t.get())}))},Zm={"alloy.execute":["disabling","alloy.base.behaviour","toggling","item-events"]},Jm=function(e){return Z(e,(function(e){return e.toArray()}))},Qm=function(e,n,o,i){var r,a,s=Xt(t);return{type:"item",dom:n.dom,components:Jm(n.optComponents),data:e.data,eventOrder:Zm,hasSubmenu:e.triggersSubmenu,itemBehaviours:gs([Yf("item-events",[(r=e,a=o,Go((function(e,t){Gm(r,e)(r.onAction),r.triggersSubmenu||a!==bg.CLOSE_ON_EXECUTE||(Ro(e,fo()),t.stop())}))),Xm(e,s),Ym(e,s)]),$m((function(){return e.disabled||i.isReadOnly()})),Wm(),Xf.config({})].concat(e.itemBehaviours))}},ep=function(e){return{value:e.value,meta:f({text:e.text.getOr("")},e.meta)}},tp=tinymce.util.Tools.resolve("tinymce.Env"),np=function(e){return{dom:{tag:"div",classes:["tox-collection__item-icon"],innerHtml:e}}},op=function(e){return{dom:{tag:"div",classes:[_g]},components:[Or(nm.translate(e))]}},ip=function(e,t){return{dom:{tag:"div",classes:[_g]},components:[{dom:{tag:e.tag,styles:e.styles},components:[Or(nm.translate(t))]}]}},rp=function(e){return{dom:{tag:"div",classes:["tox-collection__item-accessory"],innerHtml:(t=e,n=tp.mac?{alt:"&#x2325;",ctrl:"&#x2303;",shift:"&#x21E7;",meta:"&#x2318;",access:"&#x2303;&#x2325;"}:{meta:"Ctrl",access:"Shift+Alt"},o=t.split("+"),i=H(o,(function(e){var t=e.toLowerCase().trim();return we(n,t)?n[t]:e})),i.join(tp.mac?"":"+"))}};var t,n,o,i},ap=function(e){return{dom:{tag:"div",classes:["tox-collection__item-checkmark"],innerHtml:Jh("checkmark",e)}}},sp=["list-num-default","list-num-lower-alpha","list-num-lower-greek","list-num-lower-roman","list-num-upper-alpha","list-num-upper-roman"],lp=["list-bull-circle","list-bull-default","list-bull-square"],up=function(e,t,n,o){void 0===o&&(o=E.none());var i,r,s,l,u,c=nm.isRtl()&&e.iconContent.exists((function(e){return B(lp,e)})),d=e.iconContent.map((function(e){return nm.isRtl()&&B(sp,e)?e+"-rtl":e})).map((function(e){return n=e,r=o,E.from((i=t.icons)()[n.toLowerCase()]).or(r).getOrThunk((function(){return Zh(i)}));var n,i,r})),h=E.from(e.meta).fold((function(){return op}),(function(e){return we(e,"style")?a(ip,e.style):op}));return"color"===e.presets?(i=e.ariaLabel,r=e.value,s=t,{dom:(l=d.getOr(""),u={tag:"div",attributes:i.map((function(e){return{title:s.translate(e)}})).getOr({}),classes:["tox-swatch"]},f(f({},u),"custom"===r?{tag:"button",classes:g(u.classes,["tox-swatches__picker-btn"]),innerHtml:l}:"remove"===r?{classes:g(u.classes,["tox-swatch--remove"]),innerHtml:l}:{attributes:f(f({},u.attributes),{"data-mce-color":r}),styles:{"background-color":r}})),optComponents:[]}):function(e,t,n,o,i){var r=n?t.or(E.some("")).map(np):E.none(),a=e.checkMark,s=e.ariaLabel.map((function(e){return{attributes:{title:nm.translate(e)}}})).getOr({});return{dom:f({tag:"div",classes:[Cg,Tg].concat(i?["tox-collection__item-icon-rtl"]:[])},s),optComponents:[r,e.htmlContent.fold((function(){return e.textContent.map(o)}),(function(e){return E.some({dom:{tag:"div",classes:[_g],innerHtml:e}})})),e.shortcutContent.map(rp),a,e.caret]}}(e,d,n,h,c)},cp=o(bc("item-widget",_h())),dp=Ri("cell-over"),fp=Ri("cell-execute"),hp=function(e,t,n){var o,i=function(n){return So(n,fp,{row:e,col:t})},r=function(e,t){t.stop(),i(e)};return Sr({dom:{tag:"div",attributes:((o={role:"button"})["aria-labelledby"]=n,o)},behaviours:gs([Yf("insert-table-picker-cell",[Bo(qn(),th.focus),Bo(so(),i),Bo(Qn(),r),Bo(uo(),r)]),hh.config({toggleClass:"tox-insert-table-picker__selected",toggleOnExecute:!1}),th.config({onFocus:function(n){return So(n,dp,{row:e,col:t})}})])})},gp=function(e){return{value:e}},mp=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,pp=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,vp=function(e){return mp.test(e)||pp.test(e)},yp=function(e){var t=e.toString(16);return 1===t.length?"0"+t:t},bp=function(e){var t=yp(e.red)+yp(e.green)+yp(e.blue);return gp(t)},Cp=Math.min,Tp=Math.max,xp=Math.round,Ep=/^rgb\((\d+),\s*(\d+),\s*(\d+)\)/,_p=/^rgba\((\d+),\s*(\d+),\s*(\d+),\s*(\d?(?:\.\d+)?)\)/,Ip=function(e,t,n,o){return{red:e,green:t,blue:n,alpha:o}},Dp=function(e){var t=parseInt(e,10);return t.toString()===e&&0<=t&&t<=255},Op=function(e){var t,n,o,i=(e.hue||0)%360,r=e.saturation/100,a=e.value/100;if(r=Tp(0,Cp(r,1)),a=Tp(0,Cp(a,1)),0===r)return t=n=o=xp(255*a),Ip(t,n,o,1);var s=i/60,l=a*r,u=l*(1-Math.abs(s%2-1)),c=a-l;switch(Math.floor(s)){case 0:t=l,n=u,o=0;break;case 1:t=u,n=l,o=0;break;case 2:t=0,n=l,o=u;break;case 3:t=0,n=u,o=l;break;case 4:t=u,n=0,o=l;break;case 5:t=l,n=0,o=u;break;default:t=n=o=0}return t=xp(255*(t+c)),n=xp(255*(n+c)),o=xp(255*(o+c)),Ip(t,n,o,1)},wp=function(e){var t=function(e){var t={value:e.value.replace(mp,(function(e,t,n,o){return t+t+n+n+o+o}))},n=pp.exec(t.value);return null===n?["FFFFFF","FF","FF","FF"]:n}(e),n=parseInt(t[1],16),o=parseInt(t[2],16),i=parseInt(t[3],16);return Ip(n,o,i,1)},Rp=function(e,t,n,o){var i=parseInt(e,10),r=parseInt(t,10),a=parseInt(n,10),s=parseFloat(o);return Ip(i,r,a,s)},Sp=function(e){return"rgba("+e.red+","+e.green+","+e.blue+","+e.alpha+")"},kp=Ip(255,0,0,1),Ap=function(e,t){return e.fire("ResizeContent",t)},Np=tinymce.util.Tools.resolve("tinymce.util.LocalStorage"),Mp="tinymce-custom-colors",Kp="choiceitem",Pp=[{type:Kp,text:"Light Green",value:"#BFEDD2"},{type:Kp,text:"Light Yellow",value:"#FBEEB8"},{type:Kp,text:"Light Red",value:"#F8CAC6"},{type:Kp,text:"Light Purple",value:"#ECCAFA"},{type:Kp,text:"Light Blue",value:"#C2E0F4"},{type:Kp,text:"Green",value:"#2DC26B"},{type:Kp,text:"Yellow",value:"#F1C40F"},{type:Kp,text:"Red",value:"#E03E2D"},{type:Kp,text:"Purple",value:"#B96AD9"},{type:Kp,text:"Blue",value:"#3598DB"},{type:Kp,text:"Dark Turquoise",value:"#169179"},{type:Kp,text:"Orange",value:"#E67E23"},{type:Kp,text:"Dark Red",value:"#BA372A"},{type:Kp,text:"Dark Purple",value:"#843FA1"},{type:Kp,text:"Dark Blue",value:"#236FA1"},{type:Kp,text:"Light Gray",value:"#ECF0F1"},{type:Kp,text:"Medium Gray",value:"#CED4D9"},{type:Kp,text:"Gray",value:"#95A5A6"},{type:Kp,text:"Dark Gray",value:"#7E8C8D"},{type:Kp,text:"Navy Blue",value:"#34495E"},{type:Kp,text:"Black",value:"#000000"},{type:Kp,text:"White",value:"#ffffff"}],Lp=function(e){void 0===e&&(e=10);var t,n=Np.getItem(Mp),o=D(n)?JSON.parse(n):[],i=e-(t=o).length<0?t.slice(0,e):t,r=function(e){i.splice(e,1)};return{add:function(t){var n;(-1===(n=L(i,t))?E.none():E.some(n)).each(r),i.unshift(t),i.length>e&&i.pop(),Np.setItem(Mp,JSON.stringify(i))},state:function(){return i.slice(0)}}}(10),Bp=function(e){return!1!==e.getParam("custom_colors")},Fp=function(t){var n=t.getParam("color_map");return void 0!==n?function(t){var n=[],o=e.document.createElement("canvas");o.height=1,o.width=1;for(var i=o.getContext("2d"),r=function(e,t){var n=t/255;return("0"+Math.round(e*n+255*(1-n)).toString(16)).slice(-2).toUpperCase()},a=function(e){if(/^[0-9A-Fa-f]{6}$/.test(e))return"#"+e.toUpperCase();i.clearRect(0,0,o.width,o.height),i.fillStyle="#FFFFFF",i.fillStyle=e,i.fillRect(0,0,1,1);var t=i.getImageData(0,0,1,1).data,n=t[1],a=t[2],s=t[3];return"#"+r(t[0],s)+r(n,s)+r(a,s)},s=0;s<t.length;s+=2)n.push({text:t[s+1],value:a(t[s]),type:"choiceitem"});return n}(n):Pp},zp=function(e){Lp.add(e)},Vp=function(e){var t=Fp(e),n=Math.max(5,Math.ceil(Math.sqrt(t.length)));return e.getParam("color_cols",n,"number")},Hp=function(e,t,n,o){"custom"===n?Gp(e)((function(n){n.each((function(n){zp(n),e.execCommand("mceApplyTextcolor",t,n),o(n)}))}),"#000000"):"remove"===n?(o(""),e.execCommand("mceRemoveTextcolor",t)):(o(n),e.execCommand("mceApplyTextcolor",t,n))},Wp=function(e,t){return e.concat(H(Lp.state(),(function(e){return{type:Kp,text:e,value:e}})).concat((n={type:"choiceitem",text:"Remove color",icon:"color-swatch-remove-color",value:"remove"},t?[n,{type:"choiceitem",text:"Custom color",icon:"color-picker",value:"custom"}]:[n])));var n},$p=function(e,t){return function(n){n(Wp(e,t))}},Up=function(e,t,n){var o,i;e.setIconFill(o="forecolor"===t?"tox-icon-text-color__color":"tox-icon-highlight-bg-color__color",i=n),e.setIconStroke(o,i)},qp=function(e,t,n,o,i){e.ui.registry.addSplitButton(t,{tooltip:o,presets:"color",icon:"forecolor"===t?"text-color":"highlight-bg-color",select:function(t){var o,i,r;return E.from((i=n,(o=e).dom.getParents(o.selection.getStart(),(function(e){var t;(t=e.style["forecolor"===i?"color":"background-color"])&&(r=r||t)})),r)).bind((function(e){return function(e){if("transparent"===e)return E.some(Ip(0,0,0,0));var t=Ep.exec(e);if(null!==t)return E.some(Rp(t[1],t[2],t[3],"1"));var n=_p.exec(e);return null!==n?E.some(Rp(n[1],n[2],n[3],n[4])):E.none()}(e).map((function(e){var n=bp(e).value;return bn(t.toLowerCase(),n)}))})).getOr(!1)},columns:Vp(e),fetch:$p(Fp(e),Bp(e)),onAction:function(t){null!==i.get()&&Hp(e,n,i.get(),(function(){}))},onItemAction:function(o,r){Hp(e,n,r,(function(n){i.set(n),e.fire("TextColorChange",{name:t,color:n})}))},onSetup:function(n){null!==i.get()&&Up(n,t,i.get());var o=function(e){e.name===t&&Up(n,e.name,e.color)};return e.on("TextColorChange",o),function(){e.off("TextColorChange",o)}}})},jp=function(e,n,o,i){e.ui.registry.addNestedMenuItem(n,{text:i,icon:"forecolor"===n?"text-color":"highlight-bg-color",getSubmenuItems:function(){return[{type:"fancymenuitem",fancytype:"colorswatch",onAction:function(n){Hp(e,o,n.value,t)}}]}})},Gp=function(e){return function(t,n){var o,i=(o=t,function(e){var t=e.getData();o(E.from(t.colorpicker)),e.close()});e.windowManager.open({title:"Color Picker",size:"normal",body:{type:"panel",items:[{type:"colorpicker",name:"colorpicker",label:"Color"}]},buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:{colorpicker:n},onAction:function(e,t){"hex-valid"===t.name&&(t.value?e.enable("ok"):e.disable("ok"))},onSubmit:i,onClose:function(){},onCancel:function(){t(E.none())}})}},Xp=function(e,t,n,o,i,r,a,s){var l=Kg(t),u=Yp(t,n,o,"color"!==i?"normal":"color",r,a,s);return Bg(e,l,u,o,i)},Yp=function(e,t,n,o,i,r,a){return Hc(H(e,(function(s){return"choiceitem"===s.type?dt("choicemenuitem",zg,s).fold(Pg,(function(l){return E.some(function(e,t,n,o,i,r,a,s){void 0===s&&(s=!0);var l=up({presets:n,textContent:t?e.text:E.none(),htmlContent:E.none(),ariaLabel:e.text,iconContent:e.icon,shortcutContent:t?e.shortcut:E.none(),checkMark:t?E.some(ap(a.icons)):E.none(),caret:E.none(),value:e.value},a,s);return Ne(Qm({data:ep(e),disabled:e.disabled,getApi:function(e){return{setActive:function(t){hh.set(e,t)},isActive:function(){return hh.isOn(e)},isDisabled:function(){return pm.isDisabled(e)},setDisabled:function(t){return pm.set(e,t)}}},onAction:function(t){return o(e.value)},onSetup:function(e){return e.setActive(i),function(){}},triggersSubmenu:!1,itemBehaviours:[]},l,r,a),{toggling:{toggleClass:Eg,toggleOnExecute:!1,selected:e.active}})}(l,1===n,o,t,r(s.value),i,a,Kg(e)))})):E.none()})))},Zp=function(e,t){var n=Rg(t);return 1===e?{mode:"menu",moveOnTab:!0}:"auto"===e?{mode:"grid",selector:"."+n.item,initSize:{numColumns:1,numRows:1}}:{mode:"matrix",rowSelector:"."+("color"===t?"tox-swatches__row":"tox-collection__group")}},Jp={inserttable:function(e){var t=Ri("size-label"),n=function(e,t,n){for(var o=[],i=0;i<10;i++){for(var r=[],a=0;a<10;a++)r.push(hp(i,a,e));o.push(r)}return o}(t),o=Yh({dom:{tag:"span",classes:["tox-insert-table-picker__label"],attributes:{id:t}},components:[Or("0x0")],behaviours:gs([Xf.config({})])});return{type:"widget",data:{value:Ri("widget-id")},dom:{tag:"div",classes:["tox-fancymenuitem"]},autofocus:!0,components:[cp().widget({dom:{tag:"div",classes:["tox-insert-table-picker"]},components:Z(n,(function(e){return H(e,kr)})).concat(o.asSpec()),behaviours:gs([Yf("insert-table-picker",[Ho(dp,(function(e,t,i){var r=i.event().row(),a=i.event().col();!function(e,t,n,o,i){for(var r=0;r<10;r++)for(var a=0;a<10;a++)hh.set(e[r][a],r<=t&&a<=n)}(n,r,a),Xf.set(o.get(e),[Or(a+1+"x"+(r+1))])})),Ho(fp,(function(t,n,o){e.onAction({numRows:o.event().row()+1,numColumns:o.event().col()+1}),Ro(t,fo())}))]),$f.config({initSize:{numRows:10,numColumns:10},mode:"flatgrid",selector:'[role="button"]'})])})]}},colorswatch:function(e,t){var n=Wp(t.colorinput.getColors(),t.colorinput.hasCustomColors()),o=t.colorinput.getColorCols(),i=Xp(Ri("menu-value"),n,(function(t){e.onAction({value:t})}),o,"color",bg.CLOSE_ON_EXECUTE,(function(){return!1}),t.shared.providers),r=f(f({},i),{markers:Rg("color"),movement:Zp(o,"color")});return{type:"widget",data:{value:Ri("widget-id")},dom:{tag:"div",classes:["tox-fancymenuitem"]},autofocus:!0,components:[cp().widget(Sh.sketch(r))]}}},Qp=function(e){var t=e.text.fold((function(){return{}}),(function(e){return{innerHtml:e}}));return{type:"separator",dom:f({tag:"div",classes:[Tg,"tox-collection__group-heading"]},t),components:[]}};(Am=km=km||{})[Am.ContentFocus=0]="ContentFocus",Am[Am.UiFocus=1]="UiFocus";var ev=function(n,o,i,r,a){var s=Kg(o),l=Hc(H(o,(function(n){var o=function(n){return function(n,o,i,r,a){var s=i.shared.providers,l=function(e){return a?f(f({},e),{shortcut:E.none(),icon:e.text.isSome()?E.none():e.icon}):e};switch(n.type){case"menuitem":return dt("menuitem",Hg,n).fold(Pg,(function(e){return E.some(function(e,t,n,o){void 0===o&&(o=!0);var i=up({presets:"normal",iconContent:e.icon,textContent:e.text,htmlContent:E.none(),ariaLabel:e.text,caret:E.none(),checkMark:E.none(),shortcutContent:e.shortcut},n,o);return Qm({data:ep(e),getApi:function(e){return{isDisabled:function(){return pm.isDisabled(e)},setDisabled:function(t){return pm.set(e,t)}}},disabled:e.disabled,onAction:e.onAction,onSetup:e.onSetup,triggersSubmenu:!1,itemBehaviours:[]},i,t,n)}(l(e),o,s,r))}));case"nestedmenuitem":return dt("nestedmenuitem",Wg,n).fold(Pg,(function(e){return E.some(function(e,n,o,i,r){void 0===i&&(i=!0),void 0===r&&(r=!1);var a=r?{dom:{tag:"div",classes:[Ig],innerHtml:Jh("chevron-down",o.icons)}}:{dom:{tag:"div",classes:[Ig],innerHtml:Jh("chevron-right",o.icons)}},s=up({presets:"normal",iconContent:e.icon,textContent:e.text,htmlContent:E.none(),ariaLabel:e.text,caret:E.some(a),checkMark:E.none(),shortcutContent:e.shortcut},o,i);return Qm({data:ep(e),getApi:function(e){return{isDisabled:function(){return pm.isDisabled(e)},setDisabled:function(t){return pm.set(e,t)}}},disabled:e.disabled,onAction:t,onSetup:e.onSetup,triggersSubmenu:!0,itemBehaviours:[]},s,n,o)}(l(e),o,s,r,a))}));case"togglemenuitem":return dt("togglemenuitem",$g,n).fold(Pg,(function(e){return E.some(function(e,t,n,o){void 0===o&&(o=!0);var i=up({iconContent:e.icon,textContent:e.text,htmlContent:E.none(),ariaLabel:e.text,checkMark:E.some(ap(n.icons)),caret:E.none(),shortcutContent:e.shortcut,presets:"normal",meta:e.meta},n,o);return Ne(Qm({data:ep(e),disabled:e.disabled,getApi:function(e){return{setActive:function(t){hh.set(e,t)},isActive:function(){return hh.isOn(e)},isDisabled:function(){return pm.isDisabled(e)},setDisabled:function(t){return pm.set(e,t)}}},onAction:e.onAction,onSetup:e.onSetup,triggersSubmenu:!1,itemBehaviours:[]},i,t,n),{toggling:{toggleClass:Eg,toggleOnExecute:!1,selected:e.active}})}(l(e),o,s,r))}));case"separator":return dt("separatormenuitem",gg,n).fold(Pg,(function(e){return E.some(Qp(e))}));case"fancymenuitem":return dt("fancymenuitem",Vg,n).fold(Pg,(function(e){return function(e,t){return n=Jp,o=e.fancytype,(Object.prototype.hasOwnProperty.call(n,o)?E.some(n[o]):E.none()).map((function(n){return n(e,t)}));var n,o}(l(e),i)}));default:return e.console.error("Unknown item in general menu",n),E.none()}}(n,i,r,a?!n.hasOwnProperty("text"):s,a)};return"nestedmenuitem"===n.type&&n.getSubmenuItems().length<=0?o(f(f({},n),{disabled:!0})):o(n)})));return(a?Lg:Bg)(n,s,l,1,"normal")},tv=function(e){return Kh.singleData(e.value,e)},nv=o(!0),ov=function(e,t,n){return Ur(e,t,nv,n,!1)},iv=function(e,t,n){return Ur(e,t,nv,n,!0)},rv=$r,av=function(e,t,n){return fa(e,t,n).isSome()};function sv(t,n){var o=null;return{cancel:function(){null!==o&&(e.clearTimeout(o),o=null)},schedule:function(){for(var i=[],r=0;r<arguments.length;r++)i[r]=arguments[r];o=e.setTimeout((function(){t.apply(null,i),o=null}),n)}}}var lv=function(e){var t=e.raw();return void 0===t.touches||1!==t.touches.length?E.none():E.some(t.touches[0])},uv=function(){return wn().browser.isFirefox()},cv=Qe([St("triggerEvent"),zt("stopBackspace",!0)]),dv=function(e,t){var n=Oe(e,"target").map((function(e){return e()})).getOr(t);return Xt(n)},fv=Se([{stopped:[]},{resume:["element"]},{complete:[]}]),hv=function(e,t,n,i,r,a){var s,l,u,c,d=e(t,i),f=(s=n,l=r,u=Xt(!1),c=Xt(!1),{stop:function(){u.set(!0)},cut:function(){c.set(!0)},isStopped:u.get,isCut:c.get,event:o(s),setSource:l.set,getSource:l.get});return d.fold((function(){return a.logEventNoHandlers(t,i),fv.complete()}),(function(e){var n=e.descHandler;return Xi(n)(f),f.isStopped()?(a.logEventStopped(t,e.element,n.purpose()),fv.stopped()):f.isCut()?(a.logEventCut(t,e.element,n.purpose()),fv.complete()):ri(e.element).fold((function(){return a.logNoParent(t,e.element,n.purpose()),fv.complete()}),(function(o){return a.logEventResponse(t,e.element,n.purpose()),fv.resume(o)}))}))},gv=function(e,t,n,o,i,r){return hv(e,t,n,o,i,r).fold((function(){return!0}),(function(o){return gv(e,t,n,o,i,r)}),(function(){return!1}))},mv=function(e,n,i){var r,a,s=(r=n,a=Xt(!1),{stop:function(){a.set(!0)},cut:t,isStopped:a.get,isCut:o(!1),event:o(r),setSource:l("Cannot set source of a broadcasted event"),getSource:l("Cannot get source of a broadcasted event")});return W(e,(function(e){var t=e.descHandler();Xi(t)(s)})),s.isStopped()},pv=function(e,t,n,o,i){var r=dv(n,o);return gv(e,t,n,o,r,i)};function vv(){var e=function(){var e={};return{registerId:function(t,n,i){Te(i,(function(i,r){var s=void 0!==e[r]?e[r]:{};s[n]=function(e,t){return n=a.apply(void 0,[e.handler].concat(t)),i=e.purpose(),{cHandler:n,purpose:o(i)};var n,i}(i,t),e[r]=s}))},unregisterId:function(t){Te(e,(function(e,n){e.hasOwnProperty(t)&&delete e[t]}))},filterByType:function(t){return Oe(e,t).map((function(e){return _e(e,(function(e,t){return function(e,t){return{id:o(e),descHandler:o(t)}}(t,e)}))})).getOr([])},find:function(t,n,o){var i=Oe(e,n);return Kn(o,(function(e){return t=i,Ki(n=e).fold((function(){return E.none()}),(function(e){return t.bind((function(t){return Oe(t,e)})).map((function(e){return function(e,t){return{element:e,descHandler:t}}(n,e)}))}));var t,n}),t)}}}(),t={},n=function(n){Ki(n.element()).each((function(n){delete t[n],e.unregisterId(n)}))};return{find:function(t,n,o){return e.find(t,n,o)},filter:function(t){return e.filterByType(t)},register:function(o){var i=function(e){var t=e.element();return Ki(t).fold((function(){return t=e.element(),n=Ri(Ai+"uid-"),Mi(t,n),n;var t,n}),(function(e){return e}))}(o);Re(t,i)&&function(e,o){var i=t[o];if(i!==e)throw new Error('The tagId "'+o+'" is already used by: '+Ii(i.element())+"\nCannot use it for: "+Ii(e.element())+"\nThe conflicting element is"+(cr(i.element())?" ":" not ")+"already in the DOM");n(e)}(o,i),e.registerId([o],i,o.events()),t[i]=o},unregister:n,getById:function(e){return Oe(t,e)}}}var yv,bv,Cv=zc({name:"Container",factory:function(e){var t=e.dom,n=t.attributes,o=h(t,["attributes"]);return{uid:e.uid,dom:f({tag:"div",attributes:f({role:"presentation"},n)},o),components:e.components,behaviours:zu(e.containerBehaviours),events:e.events,domModification:e.domModification,eventOrder:e.eventOrder}},configFields:[zt("components",[]),Fu("containerBehaviours",[]),zt("events",{}),zt("domModification",{}),zt("eventOrder",{})]}),Tv=function(n){var i=function(e){return ri(n.element()).fold((function(){return!0}),(function(t){return kn(e,t)}))},r=vv(),a=function(e,t){return r.find(i,e,t)},s=function(t,n){var o,i,r,a,s=ht("Getting GUI events settings",cv,n),l=function(e){var t=Xt(E.none()),n=Xt(!1),o=sv((function(t){e.triggerEvent(co(),t),n.set(!0)}),400),i=Ue([{key:Bn(),value:function(e){return lv(e).each((function(i){o.cancel();var r={x:i.clientX,y:i.clientY,target:e.target()};o.schedule(e),n.set(!1),t.set(E.some(r))})),E.none()}},{key:Fn(),value:function(e){return o.cancel(),lv(e).each((function(e){t.get().each((function(n){var o,i,r,a;o=e,i=n,r=Math.abs(o.clientX-i.x),a=Math.abs(o.clientY-i.y),(5<r||5<a)&&t.set(E.none())}))})),E.none()}},{key:zn(),value:function(i){return o.cancel(),t.get().filter((function(e){return kn(e.target,i.target())})).map((function(t){return n.get()?(i.prevent(),!1):e.triggerEvent(uo(),i)}))}}]);return{fireIfReady:function(e,t){return Oe(i,t).bind((function(t){return t(e)}))}}}(s),u=H(["touchstart","touchmove","touchend","touchcancel","gesturestart","mousedown","mouseup","mouseover","mousemove","mouseout","click"].concat(["selectstart","input","contextmenu","change","transitionend","drag","dragstart","dragend","dragenter","dragleave","dragover","drop","keyup"]),(function(e){return ov(t,e,(function(t){l.fireIfReady(t,e).each((function(e){e&&t.kill()})),s.triggerEvent(e,t)&&t.kill()}))})),c=Xt(E.none()),d=ov(t,"paste",(function(t){l.fireIfReady(t,"paste").each((function(e){e&&t.kill()})),s.triggerEvent("paste",t)&&t.kill(),c.set(E.some(e.setTimeout((function(){s.triggerEvent(ro(),t)}),0)))})),f=ov(t,"keydown",(function(e){var t;s.triggerEvent("keydown",e)?e.kill():!0!==s.stopBackspace||8!==(t=e).raw().which||B(["input","textarea"],Xo(t.target()))||av(t.target(),'[contenteditable="true"]')||e.prevent()})),h=(o=t,i=function(e){s.triggerEvent("focusin",e)&&e.kill()},uv()?iv(o,"focus",i):ov(o,"focusin",i)),g=Xt(E.none()),m=(r=t,a=function(t){s.triggerEvent("focusout",t)&&t.kill(),g.set(E.some(e.setTimeout((function(){s.triggerEvent(io(),t)}),0)))},uv()?iv(r,"blur",a):ov(r,"focusout",a));return{unbind:function(){W(u,(function(e){e.unbind()})),f.unbind(),h.unbind(),m.unbind(),d.unbind(),c.get().each(e.clearTimeout),g.get().each(e.clearTimeout)}}}(n.element(),{triggerEvent:function(e,t){return ba(e,t.target(),(function(n){return o=a,i=e,s=n,l=(r=t).target(),pv(o,i,r,l,s);var o,i,r,s,l}))}}),l={debugInfo:o("real"),triggerEvent:function(e,t,n){ba(e,t,(function(o){return pv(a,e,n,t,o)}))},triggerFocus:function(e,n){Ki(e).fold((function(){_s(e)}),(function(i){ba(oo(),e,(function(i){var r,s,l,u,c,d;return r=a,s=oo(),l={originator:o(n),kill:t,prevent:t,target:o(e)},c=i,d=dv(l,u=e),hv(r,s,l,u,d,c),!1}))}))},triggerEscape:function(e,t){l.triggerEvent("keydown",e.element(),t.event())},getByUid:function(e){return v(e)},getByDom:function(e){return y(e)},build:Sr,addToGui:function(e){d(e)},removeFromGui:function(e){f(e)},addToWorld:function(e){u(e)},removeFromWorld:function(e){c(e)},broadcast:function(e){g(e)},broadcastOn:function(e,t){m(e,t)},broadcastEvent:function(e,t){p(e,t)},isConnected:o(!0)},u=function(e){e.connect(l),Jo(e.element())||(r.register(e),W(e.components(),u),l.triggerEvent(go(),e.element(),{target:o(e.element())}))},c=function(e){Jo(e.element())||(W(e.components(),c),r.unregister(e)),e.disconnect()},d=function(e){tu(n,e)},f=function(e){iu(e)},h=function(e){var t=r.filter(ao());W(t,(function(t){var n=t.descHandler();Xi(n)(e)}))},g=function(e){h({universal:o(!0),data:o(e)})},m=function(e,t){h({universal:o(!1),channels:o(e),data:o(t)})},p=function(e,t){var n=r.filter(e);return mv(n,t)},v=function(e){return r.getById(e).fold((function(){return le.error(new Error('Could not find component with uid: "'+e+'" in system.'))}),le.value)},y=function(e){var t=Ki(e).getOr("not found");return v(t)};return u(n),{root:o(n),element:n.element,destroy:function(){s.unbind(),mi(n.element())},add:d,remove:f,getByUid:v,getByDom:y,addToWorld:u,removeFromWorld:c,broadcast:g,broadcastOn:m,broadcastEvent:p}},xv=o([zt("prefix","form-field"),Fu("fieldBehaviours",[qc,Bu])]),Ev=o([gc({schema:[Dt("dom")],name:"label"}),gc({factory:{sketch:function(e){return{uid:e.uid,dom:{tag:"span",styles:{display:"none"},attributes:{"aria-hidden":"true"},innerHtml:e.text}}}},schema:[Dt("text")],name:"aria-descriptor"}),fc({factory:{sketch:function(e){var t=We(e,["factory"]);return e.factory.sketch(t)}},schema:[Dt("factory")],name:"field"})]),_v=Vc({name:"FormField",configFields:xv(),partFields:Ev(),factory:function(e,t,n,o){var i=Vu(e.fieldBehaviours,[qc.config({find:function(t){return Dc(t,e,"field")}}),Bu.config({store:{mode:"manual",getValue:function(e){return qc.getCurrent(e).bind(Bu.getValue)},setValue:function(e,t){qc.getCurrent(e).each((function(e){Bu.setValue(e,t)}))}}})]),r=Ko([Uo((function(t,n){var o=wc(t,e,["label","field","aria-descriptor"]);o.field().each((function(t){var n=Ri(e.prefix);o.label().each((function(e){Ci(e.element(),"for",n),Ci(t.element(),"id",n)})),o["aria-descriptor"]().each((function(n){var o=Ri(e.prefix);Ci(n.element(),"id",o),Ci(t.element(),"aria-describedby",o)}))}))}))]);return{uid:e.uid,dom:e.dom,components:t,behaviours:i,events:r,apis:{getField:function(t){return Dc(t,e,"field")},getLabel:function(t){return Dc(t,e,"label")}}}},apis:{getField:function(e,t){return e.getField(t)},getLabel:function(e,t){return e.getLabel(t)}}}),Iv=Object.freeze({__proto__:null,exhibit:function(e,t){return Gi({attributes:Ue([{key:t.tabAttr,value:"true"}])})}}),Dv=[zt("tabAttr","data-alloy-tabstop")],Ov=ps({fields:Dv,name:"tabstopping",active:Iv}),wv=function(e,t,n,o){var i=Rv(e,t,n,o);return _v.sketch(i)},Rv=function(e,t,n,o){return{dom:Sv(n),components:e.toArray().concat([t]),fieldBehaviours:gs(o)}},Sv=function(e){return{tag:"div",classes:["tox-form__group"].concat(e)}},kv=function(e,t){return _v.parts().label({dom:{tag:"label",classes:["tox-label"],innerHtml:t.translate(e)}})},Av=Ri("form-component-change"),Nv=Ri("form-close"),Mv=Ri("form-cancel"),Kv=Ri("form-action"),Pv=Ri("form-submit"),Lv=Ri("form-block"),Bv=Ri("form-unblock"),Fv=Ri("form-tabchange"),zv=Ri("form-resize"),Vv=o([Mt("data"),zt("inputAttributes",{}),zt("inputStyles",{}),zt("tag","input"),zt("inputClasses",[]),wa("onSetValue"),zt("styles",{}),zt("eventOrder",{}),Fu("inputBehaviours",[Bu,th]),zt("selectOnFocus",!0)]),Hv=function(e){return gs([th.config({onFocus:e.selectOnFocus?function(e){var t=e.element(),n=_r(t);t.dom().setSelectionRange(0,n.length)}:t})])},Wv=function(e){return{tag:e.tag,attributes:f({type:"text"},e.inputAttributes),styles:e.inputStyles,classes:e.inputClasses}},$v=zc({name:"Input",configFields:Vv(),factory:function(e,t){return{uid:e.uid,dom:Wv(e),components:[],behaviours:f(f({},Hv(n=e)),Vu(n.inputBehaviours,[Bu.config({store:f(f({mode:"manual"},n.data.map((function(e){return{initialValue:e}})).getOr({})),{getValue:function(e){return _r(e.element())},setValue:function(e,t){_r(e.element())!==t&&Ir(e.element(),t)}}),onSetValue:n.onSetValue})])),eventOrder:e.eventOrder};var n}}),Uv={},qv={exports:Uv};yv=Uv,bv=qv,function(e){"object"==typeof yv&&void 0!==bv?bv.exports=e():("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).EphoxContactWrapper=e()}((function(){return function e(t,n,o){function i(a,s){if(!n[a]){if(!t[a]){if(r)return r(a,!0);var l=new Error("Cannot find module '"+a+"'");throw l.code="MODULE_NOT_FOUND",l}var u=n[a]={exports:{}};t[a][0].call(u.exports,(function(e){return i(t[a][1][e]||e)}),u,u.exports,e,t,n,o)}return n[a].exports}for(var r=!1,a=0;a<o.length;a++)i(o[a]);return i}({1:[function(e,t,n){var o,i,r=t.exports={};function a(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function l(e){if(o===setTimeout)return setTimeout(e,0);if((o===a||!o)&&setTimeout)return o=setTimeout,setTimeout(e,0);try{return o(e,0)}catch(t){try{return o.call(null,e,0)}catch(t){return o.call(this,e,0)}}}!function(){try{o="function"==typeof setTimeout?setTimeout:a}catch(e){o=a}try{i="function"==typeof clearTimeout?clearTimeout:s}catch(e){i=s}}();var u,c=[],d=!1,f=-1;function h(){d&&u&&(d=!1,u.length?c=u.concat(c):f=-1,c.length&&g())}function g(){if(!d){var e=l(h);d=!0;for(var t=c.length;t;){for(u=c,c=[];++f<t;)u&&u[f].run();f=-1,t=c.length}u=null,d=!1,function(e){if(i===clearTimeout)return clearTimeout(e);if((i===s||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(e);try{i(e)}catch(t){try{return i.call(null,e)}catch(t){return i.call(this,e)}}}(e)}}function m(e,t){this.fun=e,this.array=t}function p(){}r.nextTick=function(e){var t=new Array(arguments.length-1);if(1<arguments.length)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];c.push(new m(e,t)),1!==c.length||d||l(g)},m.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=p,r.addListener=p,r.once=p,r.off=p,r.removeListener=p,r.removeAllListeners=p,r.emit=p,r.prependListener=p,r.prependOnceListener=p,r.listeners=function(e){return[]},r.binding=function(e){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},{}],2:[function(e,t,n){(function(e){function n(){}function o(e){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],u(e,this)}function i(e,t){for(;3===e._state;)e=e._value;0!==e._state?(e._handled=!0,o._immediateFn((function(){var n=1===e._state?t.onFulfilled:t.onRejected;if(null!==n){var o;try{o=n(e._value)}catch(c){return void a(t.promise,c)}r(t.promise,o)}else(1===e._state?r:a)(t.promise,e._value)}))):e._deferreds.push(t)}function r(e,t){try{if(t===e)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"==typeof t||"function"==typeof t)){var n=t.then;if(t instanceof o)return e._state=3,e._value=t,void s(e);if("function"==typeof n)return void u(function(e,t){return function(){e.apply(t,arguments)}}(n,t),e)}e._state=1,e._value=t,s(e)}catch(i){a(e,i)}}function a(e,t){e._state=2,e._value=t,s(e)}function s(e){2===e._state&&0===e._deferreds.length&&o._immediateFn((function(){e._handled||o._unhandledRejectionFn(e._value)}));for(var t=0,n=e._deferreds.length;t<n;t++)i(e,e._deferreds[t]);e._deferreds=null}function l(e,t,n){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.promise=n}function u(e,t){var o=!1;try{e((function(e){o||(o=!0,r(t,e))}),(function(e){o||(o=!0,a(t,e))}))}catch(n){if(o)return;o=!0,a(t,n)}}var c;c=setTimeout,o.prototype.catch=function(e){return this.then(null,e)},o.prototype.then=function(e,t){var o=new this.constructor(n);return i(this,new l(e,t,o)),o},o.all=function(e){var t=Array.prototype.slice.call(e);return new o((function(e,o){if(0===t.length)return e([]);var i=t.length;function r(a,s){try{if(s&&("object"==typeof s||"function"==typeof s)){var l=s.then;if("function"==typeof l)return void l.call(s,(function(e){r(a,e)}),o)}t[a]=s,0==--i&&e(t)}catch(n){o(n)}}for(var a=0;a<t.length;a++)r(a,t[a])}))},o.resolve=function(e){return e&&"object"==typeof e&&e.constructor===o?e:new o((function(t){t(e)}))},o.reject=function(e){return new o((function(t,n){n(e)}))},o.race=function(e){return new o((function(t,n){for(var o=0,i=e.length;o<i;o++)e[o].then(t,n)}))},o._immediateFn="function"==typeof e?function(t){e(t)}:function(e){c(e,0)},o._unhandledRejectionFn=function(e){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",e)},o._setImmediateFn=function(e){o._immediateFn=e},o._setUnhandledRejectionFn=function(e){o._unhandledRejectionFn=e},void 0!==t&&t.exports?t.exports=o:this.Promise||(this.Promise=o)}).call(this,e("timers").setImmediate)},{timers:3}],3:[function(e,t,n){(function(t,o){var i=e("process/browser.js").nextTick,r=Function.prototype.apply,a=Array.prototype.slice,s={},l=0;function u(e,t){this._id=e,this._clearFn=t}n.setTimeout=function(){return new u(r.call(setTimeout,window,arguments),clearTimeout)},n.setInterval=function(){return new u(r.call(setInterval,window,arguments),clearInterval)},n.clearTimeout=n.clearInterval=function(e){e.close()},u.prototype.unref=u.prototype.ref=function(){},u.prototype.close=function(){this._clearFn.call(window,this._id)},n.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},n.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},n._unrefActive=n.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;0<=t&&(e._idleTimeoutId=setTimeout((function(){e._onTimeout&&e._onTimeout()}),t))},n.setImmediate="function"==typeof t?t:function(e){var t=l++,o=!(arguments.length<2)&&a.call(arguments,1);return s[t]=!0,i((function(){s[t]&&(o?e.apply(null,o):e.call(null),n.clearImmediate(t))})),t},n.clearImmediate="function"==typeof o?o:function(e){delete s[e]}}).call(this,e("timers").setImmediate,e("timers").clearImmediate)},{"process/browser.js":1,timers:3}],4:[function(e,t,n){var o=e("promise-polyfill"),i="undefined"!=typeof window?window:Function("return this;")();t.exports={boltExport:i.Promise||o}},{"promise-polyfill":2}]},{},[4])(4)}));var jv,Gv,Xv=qv.exports.boltExport,Yv=function(t){var n=E.none(),o=[],i=function(e){r()?a(e):o.push(e)},r=function(){return n.isSome()},a=function(t){n.each((function(n){e.setTimeout((function(){t(n)}),0)}))};return t((function(e){r()||(n=E.some(e),function(e){W(e,a)}(o),o=[])})),{get:i,map:function(e){return Yv((function(t){i((function(n){t(e(n))}))}))},isReady:r}},Zv={nu:Yv,pure:function(e){return Yv((function(t){t(e)}))}},Jv=function(t){e.setTimeout((function(){throw t}),0)},Qv=function(e){var t=function(t){e().then(t,Jv)};return{map:function(t){return Qv((function(){return e().then(t)}))},bind:function(t){return Qv((function(){return e().then((function(e){return t(e).toPromise()}))}))},anonBind:function(t){return Qv((function(){return e().then((function(){return t.toPromise()}))}))},toLazy:function(){return Zv.nu(t)},toCached:function(){var t=null;return Qv((function(){return null===t&&(t=e()),t}))},toPromise:e,get:t}},ey=function(e){return Qv((function(){return new Xv(e)}))},ty=function(e){return Qv((function(){return Xv.resolve(e)}))},ny=["input","textarea"],oy=function(e){var t=Xo(e);return B(ny,t)},iy=function(e,t){var n=t.getRoot(e).getOr(e.element());er(n,t.invalidClass),t.notify.each((function(t){oy(e.element())&&Ci(e.element(),"aria-invalid",!1),t.getContainer(e).each((function(e){yi(e,t.validHtml)})),t.onValid(e)}))},ry=function(e,t,n,o){var i=t.getRoot(e).getOr(e.element());Qi(i,t.invalidClass),t.notify.each((function(t){oy(e.element())&&Ci(e.element(),"aria-invalid",!0),t.getContainer(e).each((function(e){yi(e,o)})),t.onInvalid(e,o)}))},ay=function(e,t,n){return t.validator.fold((function(){return ty(le.value(!0))}),(function(t){return t.validate(e)}))},sy=function(e,t,n){return t.notify.each((function(t){t.onValidate(e)})),ay(e,t).map((function(n){return e.getSystem().isConnected()?n.fold((function(n){return ry(e,t,0,n),le.error(n)}),(function(n){return iy(e,t),le.value(n)})):le.error("No longer in system")}))},ly=Object.freeze({__proto__:null,markValid:iy,markInvalid:ry,query:ay,run:sy,isInvalid:function(e,t){var n=t.getRoot(e).getOr(e.element());return tr(n,t.invalidClass)}}),uy=Object.freeze({__proto__:null,events:function(e,n){return e.validator.map((function(n){return Ko([Bo(n.onEvent,(function(t){sy(t,e).get(i)}))].concat(n.validateOnLoad?[Uo((function(n){sy(n,e).get(t)}))]:[]))})).getOr({})}}),cy=[Dt("invalidClass"),zt("getRoot",E.none),Ft("notify",[zt("aria","alert"),zt("getContainer",E.none),zt("validHtml",""),wa("onValid"),wa("onInvalid"),wa("onValidate")]),Ft("validator",[Dt("validate"),zt("onEvent","input"),zt("validateOnLoad",!0)])],dy=ps({fields:cy,name:"invalidating",active:uy,apis:ly,extra:{validation:function(e){return function(t){var n=Bu.getValue(t);return ty(e(n))}}}}),fy=Object.freeze({__proto__:null,getCoupled:function(e,t,n,o){return n.getOrCreate(e,t,o)}}),hy=[Ot("others",ct(le.value,vt()))],gy=ps({fields:hy,name:"coupling",apis:fy,state:Object.freeze({__proto__:null,init:function(){var e={},t=o({});return qi({readState:t,getOrCreate:function(t,n,o){var i=be(n.others);if(i)return Oe(e,o).getOrThunk((function(){var i=Oe(n.others,o).getOrDie("No information found for coupled component: "+o)(t),r=t.getSystem().build(i);return e[o]=r}));throw new Error("Cannot find coupled component: "+o+". Known coupled components: "+JSON.stringify(i,null,2))}})}})}),my=o("sink"),py=o(gc({name:my(),overrides:o({dom:{tag:"div"},behaviours:gs([Yl.config({useFixed:c})]),events:Ko([Wo(Xn()),Wo(Hn()),Wo(Qn())])})}));(Gv=jv=jv||{})[Gv.HighlightFirst=0]="HighlightFirst",Gv[Gv.HighlightNone=1]="HighlightNone";var vy=function(e,t){var n=e.getHotspot(t).getOr(t),o=e.getAnchorOverrides();return e.layouts.fold((function(){return{anchor:"hotspot",hotspot:n,overrides:o}}),(function(e){return{anchor:"hotspot",hotspot:n,overrides:o,layouts:e}}))},yy=function(e,t,n,o,i,r,a){var s,l,u,c,d,h,g,m,p,v,y=vy(e,n);return(l=y,c=o,d=i,h=a,g=t,m=u=n,p=(0,(s=e).fetch)(m).map(g),v=Ty(u,s),p.map((function(e){return e.bind((function(e){return E.from(Kh.sketch(f(f({},d.menu()),{uid:Pi(""),data:e,highlightImmediately:h===jv.HighlightFirst,onOpenMenu:function(e,t){var n=v().getOrDie();Yl.position(n,l,t),yu.decloak(c)},onOpenSubmenu:function(e,t,n){var o=v().getOrDie();Yl.position(o,{anchor:"submenu",item:t},n),yu.decloak(c)},onRepositionMenu:function(e,t,n){var o=v().getOrDie();Yl.position(o,l,t),W(n,(function(e){Yl.position(o,{anchor:"submenu",item:e.triggeringItem},e.triggeredMenu)}))},onEscape:function(){return th.focus(u),yu.close(c),E.some(!0)}})))}))}))).map((function(e){return e.fold((function(){yu.isOpen(o)&&yu.close(o)}),(function(e){yu.cloak(o),yu.open(o,e),r(o)})),o}))},by=function(e,t,n,o,i,r,a){return yu.close(o),ty(o)},Cy=function(e,t,n,o,i,r){var a=gy.getCoupled(n,"sandbox");return(yu.isOpen(a)?by:yy)(e,t,n,a,o,i,r)},Ty=function(e,t){return e.getSystem().getByUid(t.uid+"-"+my()).map((function(e){return function(){return le.value(e)}})).getOrThunk((function(){return t.lazySink.fold((function(){return function(){return le.error(new Error("No internal sink is specified, nor could an external sink be found"))}}),(function(t){return function(){return t(e)}}))}))},xy=function(e){yu.getState(e).each((function(e){Kh.repositionMenus(e)}))},Ey=function(e,t,n){var o=ha(),i=Ty(t,e);return{dom:{tag:"div",classes:e.sandboxClasses,attributes:{id:o.id,role:"listbox"}},behaviours:Wu(e.sandboxBehaviours,[Bu.config({store:{mode:"memory",initialValue:t}}),yu.config({onOpen:function(i,r){var a=vy(e,t);o.link(t.element()),e.matchWidth&&function(e,t,n){var o,i=qc.getCurrent(t).getOr(t),r=Hr(e.element());n?mr(i.element(),"min-width",r+"px"):(o=i.element(),Vr.set(o,r))}(a.hotspot,r,e.useMinWidth),e.onOpen(a,i,r),void 0!==n&&void 0!==n.onOpen&&n.onOpen(i,r)},onClose:function(e,i){o.unlink(t.element()),void 0!==n&&void 0!==n.onClose&&n.onClose(e,i)},isPartOf:function(e,n,o){return ga(n,o)||ga(t,o)},getAttachPoint:function(){return i().getOrDie()}}),qc.config({find:function(e){return yu.getState(e).bind((function(e){return qc.getCurrent(e)}))}}),xs.config({channels:f(f({},Eu({isExtraPart:u})),Iu({doReposition:xy}))})])}},_y=function(e){var t=gy.getCoupled(e,"sandbox");xy(t)},Iy=function(){return[zt("sandboxClasses",[]),Hu("sandboxBehaviours",[qc,xs,yu,Bu])]},Dy=o([Dt("dom"),Dt("fetch"),wa("onOpen"),Ra("onExecute"),zt("getHotspot",E.some),zt("getAnchorOverrides",o({})),Js(),Fu("dropdownBehaviours",[hh,gy,$f,th]),Dt("toggleClass"),zt("eventOrder",{}),Mt("lazySink"),zt("matchWidth",!1),zt("useMinWidth",!1),Mt("role")].concat(Iy())),Oy=o([hc({schema:[Ia()],name:"menu",defaults:function(e){return{onExecute:e.onExecute}}}),py()]),wy=Vc({name:"Dropdown",configFields:Dy(),partFields:Oy(),factory:function(e,n,o,i){var r,a=function(e){yu.getState(e).each((function(e){Kh.highlightPrimary(e)}))},s={expand:function(n){hh.isOn(n)||Cy(e,(function(e){return e}),n,i,t,jv.HighlightNone).get(t)},open:function(n){hh.isOn(n)||Cy(e,(function(e){return e}),n,i,t,jv.HighlightFirst).get(t)},isOpen:hh.isOn,close:function(n){hh.isOn(n)&&Cy(e,(function(e){return e}),n,i,t,jv.HighlightFirst).get(t)},repositionMenus:function(e){hh.isOn(e)&&_y(e)}},l=function(e,t){return ko(e),E.some(!0)};return{uid:e.uid,dom:e.dom,components:n,behaviours:Vu(e.dropdownBehaviours,[hh.config({toggleClass:e.toggleClass,aria:{mode:"expanded"}}),gy.config({others:{sandbox:function(t){return Ey(e,t,{onOpen:function(){hh.on(t)},onClose:function(){hh.off(t)}})}}}),$f.config({mode:"special",onSpace:l,onEnter:l,onDown:function(e,t){if(wy.isOpen(e)){var n=gy.getCoupled(e,"sandbox");a(n)}else wy.open(e);return E.some(!0)},onEscape:function(e,t){return wy.isOpen(e)?(wy.close(e),E.some(!0)):E.none()}}),th.config({})]),events:mh(E.some((function(n){Cy(e,(function(e){return e}),n,i,a,jv.HighlightFirst).get(t)}))),eventOrder:f(f({},e.eventOrder),((r={})[so()]=["disabling","toggling","alloy.base.behaviour"],r)),apis:s,domModification:{attributes:f(f({"aria-haspopup":"true"},e.role.fold((function(){return{}}),(function(e){return{role:e}}))),"button"===e.dom.tag?{type:Oe(e.dom,"attributes").bind((function(e){return Oe(e,"type")})).getOr("button")}:{})}}},apis:{open:function(e,t){return e.open(t)},expand:function(e,t){return e.expand(t)},close:function(e,t){return e.close(t)},isOpen:function(e,t){return e.isOpen(t)},repositionMenus:function(e,t){return e.repositionMenus(t)}}}),Ry=ps({fields:[],name:"unselecting",active:Object.freeze({__proto__:null,events:function(){return Ko([Po(to(),o(!0))])},exhibit:function(){return Gi({styles:{"-webkit-user-select":"none","user-select":"none","-ms-user-select":"none","-moz-user-select":"-moz-none"},attributes:{unselectable:"on"}})}})}),Sy=Ri("color-input-change"),ky=Ri("color-swatch-change"),Ay=Ri("color-picker-cancel"),Ny=function(e,t,n){return{hue:e,saturation:t,value:n}},My=Ri("rgb-hex-update"),Ky=Ri("slider-update"),Py=Ri("palette-update"),Ly=gc({schema:[Dt("dom")],name:"label"}),By=function(e){return gc({name:e+"-edge",overrides:function(t){return t.model.manager.edgeActions[e].fold((function(){return{}}),(function(e){return{events:Ko([Fo(Bn(),(function(t,n,o){return e(t,o)}),[t]),Fo(Hn(),(function(t,n,o){return e(t,o)}),[t]),Fo(Wn(),(function(t,n,o){o.mouseIsDown.get()&&e(t,o)}),[t])])}}))}})},Fy=By("top-left"),zy=By("top"),Vy=By("top-right"),Hy=By("right"),Wy=By("bottom-right"),$y=By("bottom"),Uy=By("bottom-left"),qy=[Ly,By("left"),Hy,zy,$y,Fy,Vy,Uy,Wy,fc({name:"thumb",defaults:o({dom:{styles:{position:"absolute"}}}),overrides:function(e){return{events:Ko([Vo(Bn(),e,"spectrum"),Vo(Fn(),e,"spectrum"),Vo(zn(),e,"spectrum"),Vo(Hn(),e,"spectrum"),Vo(Wn(),e,"spectrum"),Vo(Un(),e,"spectrum")])}}}),fc({schema:[Gt("mouseIsDown",(function(){return Xt(!1)}))],name:"spectrum",overrides:function(e){var t=e.model.manager,n=function(n,o){return t.getValueFromEvent(o).map((function(o){return t.setValueFrom(n,e,o)}))};return{behaviours:gs([$f.config({mode:"special",onLeft:function(n){return t.onLeft(n,e)},onRight:function(n){return t.onRight(n,e)},onUp:function(n){return t.onUp(n,e)},onDown:function(n){return t.onDown(n,e)}}),th.config({})]),events:Ko([Bo(Bn(),n),Bo(Fn(),n),Bo(Hn(),n),Bo(Wn(),(function(t,o){e.mouseIsDown.get()&&n(t,o)}))])}}})],jy=o("slider.change.value"),Gy=function(e){var t=e.event().raw();return-1!==t.type.indexOf("touch")?void 0!==t.touches&&1===t.touches.length?E.some(t.touches[0]).map((function(e){return Lr(e.clientX,e.clientY)})):E.none():void 0!==t.clientX?E.some(t).map((function(e){return Lr(e.clientX,e.clientY)})):E.none()},Xy=function(e){return e.model.minX},Yy=function(e){return e.model.minY},Zy=function(e){return e.model.minX-1},Jy=function(e){return e.model.minY-1},Qy=function(e){return e.model.maxX},eb=function(e){return e.model.maxY},tb=function(e){return e.model.maxX+1},nb=function(e){return e.model.maxY+1},ob=function(e,t,n){return t(e)-n(e)},ib=function(e){return ob(e,Qy,Xy)},rb=function(e){return ob(e,eb,Yy)},ab=function(e){return ib(e)/2},sb=function(e){return rb(e)/2},lb=function(e){return e.stepSize},ub=function(e){return e.snapToGrid},cb=function(e){return e.snapStart},db=function(e){return e.rounded},fb=function(e,t){return void 0!==e[t+"-edge"]},hb=function(e){return fb(e,"left")},gb=function(e){return fb(e,"right")},mb=function(e){return fb(e,"top")},pb=function(e){return fb(e,"bottom")},vb=function(e){return e.model.value.get()},yb=function(e){return{x:o(e)}},bb=function(e){return{y:o(e)}},Cb=function(e,t){return{x:o(e),y:o(t)}},Tb=function(e,t){So(e,jy(),{value:t})},xb=function(e,t,n,o){return e<t?e:n<e?n:e===t?t-1:Math.max(t,e-o)},Eb=function(e,t,n,o){return n<e?e:e<t?t:e===n?n+1:Math.min(n,e+o)},_b=function(e,t,n){return Math.max(t,Math.min(n,e))},Ib=function(e){var t=e.min,n=e.max,o=e.range,i=e.value,r=e.step,a=e.snap,s=e.snapStart,l=e.rounded,u=e.minBound,c=e.maxBound,d=e.screenRange,f=e.hasMinEdge?t-1:t,h=e.hasMaxEdge?n+1:n;if(i<u)return f;if(c<i)return h;var g,m,p,v,y,b=(y=u,Math.min(c,Math.max(i,y))-y),C=_b(b/d*o+t,f,h);return a&&t<=C&&C<=n?(g=C,m=t,p=n,v=r,s.fold((function(){var e=Math.round((g-m)/v)*v;return _b(m+e,m-1,p+1)}),(function(e){var t=Math.round((g-e)%v/v),n=Math.floor((g-e)/v),o=Math.floor((p-e)/v),i=e+Math.min(o,n+t)*v;return Math.max(e,i)}))):l?Math.round(C):C},Db=function(e){var t=e.min,n=e.value;return n<t?e.hasMinEdge?0:e.centerMinEdge:e.max<n?e.hasMaxEdge?e.maxBound:e.centerMaxEdge:(n-t)/e.range*e.maxOffset},Ob="left",wb=function(e){return e.element().dom().getBoundingClientRect()},Rb=function(e,t){return e[t]},Sb=function(e){var t=wb(e);return Rb(t,Ob)},kb=function(e){var t=wb(e);return Rb(t,"right")},Ab=function(e){var t=wb(e);return Rb(t,"top")},Nb=function(e){var t=wb(e);return Rb(t,"bottom")},Mb=function(e){var t=wb(e);return Rb(t,"width")},Kb=function(e){var t=wb(e);return Rb(t,"height")},Pb=function(e,t,n){return(e+t)/2-n},Lb=function(e,t){var n=wb(e),o=wb(t),i=Rb(n,Ob),r=Rb(n,"right"),a=Rb(o,Ob);return Pb(i,r,a)},Bb=function(e,t){var n=wb(e),o=wb(t),i=Rb(n,"top"),r=Rb(n,"bottom"),a=Rb(o,"top");return Pb(i,r,a)},Fb=function(e,t){So(e,jy(),{value:t})},zb=function(e){return{x:o(e)}},Vb=function(e,t,n){var o={min:Xy(t),max:Qy(t),range:ib(t),value:n,step:lb(t),snap:ub(t),snapStart:cb(t),rounded:db(t),hasMinEdge:hb(t),hasMaxEdge:gb(t),minBound:Sb(e),maxBound:kb(e),screenRange:Mb(e)};return Ib(o)},Hb=function(e){return function(t,n){return o=t,r=(0<e?Eb:xb)(vb(i=n).x(),Xy(i),Qy(i),lb(i)),Fb(o,zb(r)),E.some(r).map((function(){return!0}));var o,i,r}},Wb=function(e,t,n,o,i,r){var a,s,l,u,c,d,f,h,g,m=(s=r,l=n,u=o,c=i,d=Mb(a=t),f=u.bind((function(e){return E.some(Lb(e,a))})).getOr(0),h=c.bind((function(e){return E.some(Lb(e,a))})).getOr(d),g={min:Xy(s),max:Qy(s),range:ib(s),value:l,hasMinEdge:hb(s),hasMaxEdge:gb(s),minBound:Sb(a),minOffset:0,maxBound:kb(a),maxOffset:d,centerMinEdge:f,centerMaxEdge:h},Db(g));return Sb(t)-Sb(e)+m},$b=Hb(-1),Ub=Hb(1),qb=E.none,jb=E.none,Gb={"top-left":E.none(),top:E.none(),"top-right":E.none(),right:E.some((function(e,t){Tb(e,yb(tb(t)))})),"bottom-right":E.none(),bottom:E.none(),"bottom-left":E.none(),left:E.some((function(e,t){Tb(e,yb(Zy(t)))}))},Xb=Object.freeze({__proto__:null,setValueFrom:function(e,t,n){var o=Vb(e,t,n),i=zb(o);return Fb(e,i),o},setToMin:function(e,t){var n=Xy(t);Fb(e,zb(n))},setToMax:function(e,t){var n=Qy(t);Fb(e,zb(n))},findValueOfOffset:Vb,getValueFromEvent:function(e){return Gy(e).map((function(e){return e.left()}))},findPositionOfValue:Wb,setPositionFromValue:function(e,t,n,o){var i=vb(n),r=Wb(e,o.getSpectrum(e),i.x(),o.getLeftEdge(e),o.getRightEdge(e),n),a=Hr(t.element())/2;mr(t.element(),"left",r-a+"px")},onLeft:$b,onRight:Ub,onUp:qb,onDown:jb,edgeActions:Gb}),Yb=function(e,t){So(e,jy(),{value:t})},Zb=function(e){return{y:o(e)}},Jb=function(e,t,n){var o={min:Yy(t),max:eb(t),range:rb(t),value:n,step:lb(t),snap:ub(t),snapStart:cb(t),rounded:db(t),hasMinEdge:mb(t),hasMaxEdge:pb(t),minBound:Ab(e),maxBound:Nb(e),screenRange:Kb(e)};return Ib(o)},Qb=function(e){return function(t,n){return o=t,r=(0<e?Eb:xb)(vb(i=n).y(),Yy(i),eb(i),lb(i)),Yb(o,Zb(r)),E.some(r).map((function(){return!0}));var o,i,r}},eC=function(e,t,n,o,i,r){var a,s,l,u,c,d,f,h,g,m=(s=r,l=n,u=o,c=i,d=Kb(a=t),f=u.bind((function(e){return E.some(Bb(e,a))})).getOr(0),h=c.bind((function(e){return E.some(Bb(e,a))})).getOr(d),g={min:Yy(s),max:eb(s),range:rb(s),value:l,hasMinEdge:mb(s),hasMaxEdge:pb(s),minBound:Ab(a),minOffset:0,maxBound:Nb(a),maxOffset:d,centerMinEdge:f,centerMaxEdge:h},Db(g));return Ab(t)-Ab(e)+m},tC=E.none,nC=E.none,oC=Qb(-1),iC=Qb(1),rC={"top-left":E.none(),top:E.some((function(e,t){Tb(e,bb(Jy(t)))})),"top-right":E.none(),right:E.none(),"bottom-right":E.none(),bottom:E.some((function(e,t){Tb(e,bb(nb(t)))})),"bottom-left":E.none(),left:E.none()},aC=Object.freeze({__proto__:null,setValueFrom:function(e,t,n){var o=Jb(e,t,n),i=Zb(o);return Yb(e,i),o},setToMin:function(e,t){var n=Yy(t);Yb(e,Zb(n))},setToMax:function(e,t){var n=eb(t);Yb(e,Zb(n))},findValueOfOffset:Jb,getValueFromEvent:function(e){return Gy(e).map((function(e){return e.top()}))},findPositionOfValue:eC,setPositionFromValue:function(e,t,n,o){var i=vb(n),r=eC(e,o.getSpectrum(e),i.y(),o.getTopEdge(e),o.getBottomEdge(e),n),a=Mr(t.element())/2;mr(t.element(),"top",r-a+"px")},onLeft:tC,onRight:nC,onUp:oC,onDown:iC,edgeActions:rC}),sC=function(e,t){So(e,jy(),{value:t})},lC=function(e,t){return{x:o(e),y:o(t)}},uC=function(e,t){return function(n,o){return r=n,a=o,s=0<e?Eb:xb,l=(i=t)?vb(a).x():s(vb(a).x(),Xy(a),Qy(a),lb(a)),u=i?s(vb(a).y(),Yy(a),eb(a),lb(a)):vb(a).y(),sC(r,lC(l,u)),E.some(l).map((function(){return!0}));var i,r,a,s,l,u}},cC=uC(-1,!1),dC=uC(1,!1),fC=uC(-1,!0),hC=uC(1,!0),gC={"top-left":E.some((function(e,t){Tb(e,Cb(Zy(t),Jy(t)))})),top:E.some((function(e,t){Tb(e,Cb(ab(t),Jy(t)))})),"top-right":E.some((function(e,t){Tb(e,Cb(tb(t),Jy(t)))})),right:E.some((function(e,t){Tb(e,Cb(tb(t),sb(t)))})),"bottom-right":E.some((function(e,t){Tb(e,Cb(tb(t),nb(t)))})),bottom:E.some((function(e,t){Tb(e,Cb(ab(t),nb(t)))})),"bottom-left":E.some((function(e,t){Tb(e,Cb(Zy(t),nb(t)))})),left:E.some((function(e,t){Tb(e,Cb(Zy(t),sb(t)))}))},mC=Object.freeze({__proto__:null,setValueFrom:function(e,t,n){var o=Vb(e,t,n.left()),i=Jb(e,t,n.top()),r=lC(o,i);return sC(e,r),r},setToMin:function(e,t){var n=Xy(t),o=Yy(t);sC(e,lC(n,o))},setToMax:function(e,t){var n=Qy(t),o=eb(t);sC(e,lC(n,o))},getValueFromEvent:function(e){return Gy(e)},setPositionFromValue:function(e,t,n,o){var i=vb(n),r=Wb(e,o.getSpectrum(e),i.x(),o.getLeftEdge(e),o.getRightEdge(e),n),a=eC(e,o.getSpectrum(e),i.y(),o.getTopEdge(e),o.getBottomEdge(e),n),s=Hr(t.element())/2,l=Mr(t.element())/2;mr(t.element(),"left",r-s+"px"),mr(t.element(),"top",a-l+"px")},onLeft:cC,onRight:dC,onUp:fC,onDown:hC,edgeActions:gC}),pC=Vc({name:"Slider",configFields:[zt("stepSize",1),zt("onChange",t),zt("onChoose",t),zt("onInit",t),zt("onDragStart",t),zt("onDragEnd",t),zt("snapToGrid",!1),zt("rounded",!0),Mt("snapStart"),Ot("model",pt("mode",{x:[zt("minX",0),zt("maxX",100),Gt("value",(function(e){return Xt(e.mode.minX)})),Dt("getInitialValue"),Aa("manager",Xb)],y:[zt("minY",0),zt("maxY",100),Gt("value",(function(e){return Xt(e.mode.minY)})),Dt("getInitialValue"),Aa("manager",aC)],xy:[zt("minX",0),zt("maxX",100),zt("minY",0),zt("maxY",100),Gt("value",(function(e){return Xt({x:o(e.mode.minX),y:o(e.mode.minY)})})),Dt("getInitialValue"),Aa("manager",mC)]})),Fu("sliderBehaviours",[$f,Bu]),Gt("mouseIsDown",(function(){return Xt(!1)}))],partFields:qy,factory:function(e,t,n,i){var r,a=function(t){return Oc(t,e,"thumb")},s=function(t){return Oc(t,e,"spectrum")},l=function(t){return Dc(t,e,"left-edge")},u=function(t){return Dc(t,e,"right-edge")},c=function(t){return Dc(t,e,"top-edge")},d=function(t){return Dc(t,e,"bottom-edge")},f=e.model,h=f.manager,g=function(t,n){h.setPositionFromValue(t,n,e,{getLeftEdge:l,getRightEdge:u,getTopEdge:c,getBottomEdge:d,getSpectrum:s})},m=function(t,n){f.value.set(n);var o=a(t);return g(t,o),e.onChange(t,o,n),E.some(!0)},p=function(t){var n=e.mouseIsDown.get();e.mouseIsDown.set(!1),n&&Dc(t,e,"thumb").each((function(n){var o=f.value.get();e.onChoose(t,n,o)}))},v=function(t,n){n.stop(),e.mouseIsDown.set(!0),e.onDragStart(t,a(t))},y=function(t,n){n.stop(),e.onDragEnd(t,a(t)),p(t)};return{uid:e.uid,dom:e.dom,components:t,behaviours:Vu(e.sliderBehaviours,[$f.config({mode:"special",focusIn:function(t){return Dc(t,e,"spectrum").map($f.focusIn).map(o(!0))}}),Bu.config({store:{mode:"manual",getValue:function(e){return f.value.get()}}}),xs.config({channels:((r={})[Tu()]={onReceive:p},r)})]),events:Ko([Bo(jy(),(function(e,t){m(e,t.event().value())})),Uo((function(t,n){var o=f.getInitialValue();f.value.set(o);var i=a(t);g(t,i);var r=s(t);e.onInit(t,i,r,f.value.get())})),Bo(Bn(),v),Bo(zn(),y),Bo(Hn(),v),Bo(Un(),y)]),apis:{resetToMin:function(t){h.setToMin(t,e)},resetToMax:function(t){h.setToMax(t,e)},changeValue:m,refresh:g},domModification:{styles:{position:"relative"}}}},apis:{resetToMin:function(e,t){e.resetToMin(t)},resetToMax:function(e,t){e.resetToMax(t)},refresh:function(e,t){e.refresh(t)}}}),vC=[Fu("formBehaviours",[Bu])],yC=function(e){return"<alloy.field."+e+">"},bC=function(e,t){return{uid:e.uid,dom:e.dom,components:t,behaviours:Vu(e.formBehaviours,[Bu.config({store:{mode:"manual",getValue:function(t){var n=Rc(t,e);return xe(n,(function(e,t){return e().bind((function(e){var n,o;return n=qc.getCurrent(e),o=new Error("Cannot find a current component to extract the value from for form part '"+t+"': "+Ii(e.element())),n.fold((function(){return le.error(o)}),le.value)})).map(Bu.getValue)}))},setValue:function(t,n){Te(n,(function(n,o){Dc(t,e,o).each((function(e){qc.getCurrent(e).each((function(e){Bu.setValue(e,n)}))}))}))}}})]),apis:{getField:function(t,n){return Dc(t,e,n).bind(qc.getCurrent)}}}},CC={getField:$i((function(e,t,n){return e.getField(t,n)})),sketch:function(e){var t,n=(t=[],{field:function(e,n){return t.push(e),Tc("form",yC(e),n)},record:function(){return t}}),o=e(n),i=n.record(),r=H(i,(function(e){return fc({name:e,pname:yC(e)})}));return Pc("form",vC,r,bC,o)}},TC=Ri("valid-input"),xC=Ri("invalid-input"),EC=Ri("validating-input"),_C="colorcustom.rgb.",IC=function(){return qc.config({find:E.some})},DC=function(e){return qc.config({find:e.getOpt})},OC=function(e){return qc.config({find:function(t){return li(t.element(),e).bind((function(e){return t.getSystem().getByDom(e).toOption()}))}})},wC={"colorcustom.rgb.red.label":"R","colorcustom.rgb.red.description":"Red component","colorcustom.rgb.green.label":"G","colorcustom.rgb.green.description":"Green component","colorcustom.rgb.blue.label":"B","colorcustom.rgb.blue.description":"Blue component","colorcustom.rgb.hex.label":"#","colorcustom.rgb.hex.description":"Hex color code","colorcustom.rgb.range":"Range 0 to 255","colorcustom.sb.saturation":"Saturation","colorcustom.sb.brightness":"Brightness","colorcustom.sb.picker":"Saturation and Brightness Picker","colorcustom.sb.palette":"Saturation and Brightness Palette","colorcustom.sb.instructions":"Use arrow keys to select saturation and brightness, on x and y axes","colorcustom.hue.hue":"Hue","colorcustom.hue.slider":"Hue Slider","colorcustom.hue.palette":"Hue Palette","colorcustom.hue.instructions":"Use arrow keys to select a hue","aria.color.picker":"Color Picker","aria.input.invalid":"Invalid input"},RC=function(e){return wC[e]},SC=tinymce.util.Tools.resolve("tinymce.Resource"),kC=et([zt("preprocess",i),zt("postprocess",i)]),AC=function(e,t,n){return Bu.config(Ne({store:{mode:"manual",getValue:t,setValue:n}},e.map((function(e){return{store:{initialValue:e}}})).getOr({})))},NC=function(e,t){var n=ht("RepresentingConfigs.memento processors",kC,t);return Bu.config({store:{mode:"manual",getValue:function(t){var o=e.get(t),i=Bu.getValue(o);return n.postprocess(i)},setValue:function(t,o){var i=n.preprocess(o),r=e.get(t);Bu.setValue(r,i)}}})},MC=AC,KC=function(e){return function(e,t,n){return AC(e,(function(e){return t(e.element())}),(function(e,t){return n(e.element(),t)}))}(e,vi,yi)},PC=function(e){return Bu.config({store:{mode:"memory",initialValue:e}})},LC=Ri("alloy-fake-before-tabstop"),BC=Ri("alloy-fake-after-tabstop"),FC=function(e){return{dom:{tag:"div",styles:{width:"1px",height:"1px",outline:"none"},attributes:{tabindex:"0"},classes:e},behaviours:gs([th.config({ignore:!0}),Ov.config({})])}},zC=function(e){return{dom:{tag:"div",classes:["tox-navobj"]},components:[FC([LC]),e,FC([BC])],behaviours:gs([OC(1)])}},VC=function(e,t){So(e,Xn(),{raw:{which:9,shiftKey:t}})},HC=function(e,t){var n=t.element();tr(n,LC)?VC(e,!0):tr(n,BC)&&VC(e,!1)},WC=function(e){return av(e,["."+LC,"."+BC].join(","),o(!1))},$C=!(wn().browser.isIE()||wn().browser.isEdge());function UC(t,n){return GC(e.document.createElement("canvas"),t,n)}function qC(e){var t=UC(e.width,e.height);return jC(t).drawImage(e,0,0),t}function jC(e){return e.getContext("2d")}function GC(e,t,n){return e.width=t,e.height=n,e}function XC(e){return e.naturalWidth||e.width}function YC(e){return e.naturalHeight||e.height}var ZC,JC,QC,eT=window.Promise?window.Promise:(JC=(ZC=function(e){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=null,this._value=null,this._deferreds=[],sT(e,tT(oT,this),tT(iT,this))}).immediateFn||"function"==typeof window.setImmediate&&window.setImmediate||function(t){e.setTimeout(t,1)},QC=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},ZC.prototype.catch=function(e){return this.then(null,e)},ZC.prototype.then=function(e,t){var n=this;return new ZC((function(o,i){nT.call(n,new aT(e,t,o,i))}))},ZC.all=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=Array.prototype.slice.call(1===e.length&&QC(e[0])?e[0]:e);return new ZC((function(e,t){if(0===n.length)return e([]);var o=n.length;function i(r,a){try{if(a&&("object"==typeof a||"function"==typeof a)){var s=a.then;if("function"==typeof s)return void s.call(a,(function(e){i(r,e)}),t)}n[r]=a,0==--o&&e(n)}catch(v){t(v)}}for(var r=0;r<n.length;r++)i(r,n[r])}))},ZC.resolve=function(e){return e&&"object"==typeof e&&e.constructor===ZC?e:new ZC((function(t){t(e)}))},ZC.reject=function(e){return new ZC((function(t,n){n(e)}))},ZC.race=function(e){return new ZC((function(t,n){for(var o=0,i=e;o<i.length;o++)i[o].then(t,n)}))},ZC);function tT(e,t){return function(){return e.apply(t,arguments)}}function nT(e){var t=this;null!==this._state?JC((function(){var n=t._state?e.onFulfilled:e.onRejected;if(null!==n){var o;try{o=n(t._value)}catch(p){return void e.reject(p)}e.resolve(o)}else(t._state?e.resolve:e.reject)(t._value)})):this._deferreds.push(e)}function oT(e){try{if(e===this)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"==typeof e||"function"==typeof e)){var t=e.then;if("function"==typeof t)return void sT(tT(t,e),tT(oT,this),tT(iT,this))}this._state=!0,this._value=e,rT.call(this)}catch(p){iT.call(this,p)}}function iT(e){this._state=!1,this._value=e,rT.call(this)}function rT(){for(var e=0,t=this._deferreds;e<t.length;e++)nT.call(this,t[e]);this._deferreds=[]}function aT(e,t,n,o){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.resolve=n,this.reject=o}function sT(e,t,n){var o=!1;try{e((function(e){o||(o=!0,t(e))}),(function(e){o||(o=!0,n(e))}))}catch(r){if(o)return;o=!0,n(r)}}function lT(t,n,o){return n=n||"image/png",e.HTMLCanvasElement.prototype.toBlob?new eT((function(e,i){t.toBlob((function(t){t?e(t):i()}),n,o)})):function(t){return new eT((function(n,o){(function(t){var n=t.split(","),o=/data:([^;]+)/.exec(n[0]);if(!o)return E.none();for(var i=o[1],r=e.atob(n[1]),a=r.length,s=Math.ceil(a/1024),l=new Array(s),u=0;u<s;++u){for(var c=1024*u,d=Math.min(1024+c,a),f=new Array(d-c),h=c,g=0;h<d;++g,++h)f[g]=r[h].charCodeAt(0);l[u]=new Uint8Array(f)}return E.some(new e.Blob(l,{type:i}))})(t).fold((function(){o("uri is not base64: "+t)}),n)}))}(t.toDataURL(n,o))}function uT(e,t,n){function i(t,n){return e.then((function(e){return function(e,t,n){return e.toDataURL(t=t||"image/png",n)}(e,t,n)}))}return{getType:o(t.type),toBlob:function(){return eT.resolve(t)},toDataURL:o(n),toBase64:function(){return n.split(",")[1]},toAdjustedBlob:function(t,n){return e.then((function(e){return lT(e,t,n)}))},toAdjustedDataURL:i,toAdjustedBase64:function(e,t){return i(e,t).then((function(e){return e.split(",")[1]}))},toCanvas:function(){return e.then(qC)}}}function cT(e,t){return lT(e,t).then((function(t){return uT(eT.resolve(e),t,e.toDataURL())}))}function dT(e,t,n){var o="string"==typeof e?parseFloat(e):e;return n<o?o=n:o<t&&(o=t),o}var fT=[0,.01,.02,.04,.05,.06,.07,.08,.1,.11,.12,.14,.15,.16,.17,.18,.2,.21,.22,.24,.25,.27,.28,.3,.32,.34,.36,.38,.4,.42,.44,.46,.48,.5,.53,.56,.59,.62,.65,.68,.71,.74,.77,.8,.83,.86,.89,.92,.95,.98,1,1.06,1.12,1.18,1.24,1.3,1.36,1.42,1.48,1.54,1.6,1.66,1.72,1.78,1.84,1.9,1.96,2,2.12,2.25,2.37,2.5,2.62,2.75,2.87,3,3.2,3.4,3.6,3.8,4,4.3,4.7,4.9,5,5.5,6,6.5,6.8,7,7.3,7.5,7.8,8,8.4,8.7,9,9.4,9.6,9.8,10];function hT(e,t){for(var n,o=[],i=new Array(25),r=0;r<5;r++){for(var a=0;a<5;a++)o[a]=t[a+5*r];for(a=0;a<5;a++){for(var s=n=0;s<5;s++)n+=e[a+5*s]*o[s];i[a+5*r]=n}}return i}function gT(e,t){return e.toCanvas().then((function(n){return function(e,t,n){var o=jC(e),i=function(e,t){for(var n,o,i,r,a=e.data,s=t[0],l=t[1],u=t[2],c=t[3],d=t[4],f=t[5],h=t[6],g=t[7],m=t[8],p=t[9],v=t[10],y=t[11],b=t[12],C=t[13],T=t[14],x=t[15],E=t[16],_=t[17],I=t[18],D=t[19],O=0;O<a.length;O+=4)a[O]=(n=a[O])*s+(o=a[O+1])*l+(i=a[O+2])*u+(r=a[O+3])*c+d,a[O+1]=n*f+o*h+i*g+r*m+p,a[O+2]=n*v+o*y+i*b+r*C+T,a[O+3]=n*x+o*E+i*_+r*I+D;return e}(o.getImageData(0,0,e.width,e.height),n);return o.putImageData(i,0,0),cT(e,t)}(n,e.getType(),t)}))}function mT(e){return function(t,n){return gT(t,e([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1],n))}}var pT=function(e){return function(t){return gT(t,e)}}([-1,0,0,0,255,0,-1,0,0,255,0,0,-1,0,255,0,0,0,1,0,0,0,0,0,1]),vT=mT((function(e,t){return hT(e,[1,0,0,0,t=dT(255*t,-255,255),0,1,0,0,t,0,0,1,0,t,0,0,0,1,0,0,0,0,0,1])})),yT=mT((function(e,t){var n;return t=dT(t,-1,1),hT(e,[(n=(t*=100)<0?127+t/100*127:127*(n=0==(n=t%1)?fT[t]:fT[Math.floor(t)]*(1-n)+fT[Math.floor(t)+1]*n)+127)/127,0,0,0,.5*(127-n),0,n/127,0,0,.5*(127-n),0,0,n/127,0,.5*(127-n),0,0,0,1,0,0,0,0,0,1])})),bT=function(e){return function(t){return function(e,t){return e.toCanvas().then((function(n){return function(e,t,n){var o=jC(e),i=o.getImageData(0,0,e.width,e.height),r=o.getImageData(0,0,e.width,e.height);return r=function(e,t,n){function o(e,t,n){return n<e?e=n:e<t&&(e=t),e}for(var i=Math.round(Math.sqrt(n.length)),r=Math.floor(i/2),a=e.data,s=t.data,l=e.width,u=e.height,c=0;c<u;c++)for(var d=0;d<l;d++){for(var f=0,h=0,g=0,m=0;m<i;m++)for(var p=0;p<i;p++){var v=o(d+p-r,0,l-1),y=4*(o(c+m-r,0,u-1)*l+v),b=n[m*i+p];f+=a[y]*b,h+=a[1+y]*b,g+=a[2+y]*b}var C=4*(c*l+d);s[C]=o(f,0,255),s[1+C]=o(h,0,255),s[2+C]=o(g,0,255)}return t}(i,r,n),o.putImageData(r,0,0),cT(e,t)}(n,e.getType(),t)}))}(t,e)}}([0,-1,0,-1,5,-1,0,-1,0]),CT=function(e){return function(t,n){return t.toCanvas().then((function(o){return function(t,n,o){for(var i=jC(t),r=new Array(256),a=0;a<r.length;a++)r[a]=e(a,o);var s=function(e,t){for(var n=e.data,o=0;o<n.length;o+=4)n[o]=t[n[o]],n[o+1]=t[n[o+1]],n[o+2]=t[n[o+2]];return e}(i.getImageData(0,0,t.width,t.height),r);return i.putImageData(s,0,0),cT(t,n)}(o,t.getType(),n)}))}}((function(e,t){return 255*Math.pow(e/255,1-t)})),TT=function(e){return pT(e)},xT=function(e){return bT(e)},ET=function(e,t){return CT(e,t)},_T=function(e,t){return vT(e,t)},IT=function(e,t){return yT(e,t)},DT=function(e,t){return function(e,t){return e.toCanvas().then((function(n){return function(e,t,n){var o=UC(e.width,e.height),i=jC(o);return"v"===n?(i.scale(1,-1),i.drawImage(e,0,-o.height)):(i.scale(-1,1),i.drawImage(e,-o.width,0)),cT(o,t)}(n,e.getType(),t)}))}(e,t)},OT=function(e,t){return function(e,t){return e.toCanvas().then((function(n){return function(e,t,n){var o=UC(e.width,e.height),i=jC(o),r=0,a=0;return 90!==(n=n<0?360+n:n)&&270!==n||GC(o,o.height,o.width),90!==n&&180!==n||(r=o.width),270!==n&&180!==n||(a=o.height),i.translate(r,a),i.rotate(n*Math.PI/180),i.drawImage(e,0,0),cT(o,t)}(n,e.getType(),t)}))}(e,t)},wT=function(e,t){return f({dom:{tag:"span",innerHtml:e,classes:["tox-icon","tox-tbtn__icon-wrap"]}},t)},RT=function(e,t){return wT(Jh(e,t),{})},ST=function(e,t){return wT(Jh(e,t),{behaviours:gs([Xf.config({})])})},kT=function(e,t,n){return{dom:{tag:"span",innerHtml:n.translate(e),classes:[t+"__select-label"]},behaviours:gs([Xf.config({})])}},AT=Ri("toolbar.button.execute"),NT={"alloy.execute":["disabling","alloy.base.behaviour","toggling","toolbar-button-events"]},MT=Ri("update-menu-text"),KT=Ri("update-menu-icon"),PT=function(e,n,o){var i=Xt(t),r=e.text.map((function(e){return Yh(kT(e,n,o.providers))})),a=e.icon.map((function(e){return Yh(ST(e,o.providers.icons))})),s=function(e,t){var n=Bu.getValue(e);return th.focus(n),So(n,"keydown",{raw:t.event().raw()}),wy.close(n),E.some(!0)},l=e.role.fold((function(){return{}}),(function(e){return{role:e}})),u=e.tooltip.fold((function(){return{}}),(function(e){var t=o.providers.translate(e);return{title:t,"aria-label":t}}));return Yh(wy.sketch(f(f({},l),{dom:{tag:"button",classes:[n,n+"--select"].concat(H(e.classes,(function(e){return n+"--"+e}))),attributes:f({},u)},components:Jm([a.map((function(e){return e.asSpec()})),r.map((function(e){return e.asSpec()})),E.some({dom:{tag:"div",classes:[n+"__select-chevron"],innerHtml:Jh("chevron-down",o.providers.icons)}})]),matchWidth:!0,useMinWidth:!0,dropdownBehaviours:gs(g(e.dropdownBehaviours,[Um((function(){return e.disabled||o.providers.isReadOnly()})),Wm(),Ry.config({}),Xf.config({}),Yf("dropdown-events",[Xm(e,i),Ym(e,i)]),Yf("menubutton-update-display-text",[Bo(MT,(function(e,t){r.bind((function(t){return t.getOpt(e)})).each((function(e){Xf.set(e,[Or(o.providers.translate(t.event().text()))])}))})),Bo(KT,(function(e,t){a.bind((function(t){return t.getOpt(e)})).each((function(e){Xf.set(e,[ST(t.event().icon(),o.providers.icons)])}))}))])])),eventOrder:Ne(NT,{mousedown:["focusing","alloy.base.behaviour","item-type-events","normal-dropdown-events"]}),sandboxBehaviours:gs([$f.config({mode:"special",onLeft:s,onRight:s})]),lazySink:o.getSink,toggleClass:n+"--active",parts:{menu:kg(0,0,e.presets)},fetch:function(){return ey(e.fetch)}}))).asSpec()},LT=function(e){return"separator"===e.type},BT={type:"separator"},FT=function(e,t){var n=function(e,t){var n=j(e,(function(e,n){return D(n)?""===n?e:"|"===n?0<e.length&&!LT(e[e.length-1])?e.concat([BT]):e:we(t,n.toLowerCase())?e.concat([t[n.toLowerCase()]]):e:e.concat([n])}),[]);return 0<n.length&&LT(n[n.length-1])&&n.pop(),n}(D(e)?e.split(" "):e,t);return q(n,(function(e,n){var o=function(e,t){return we(e,"getSubmenuItems")?(o=t,i=(n=e).getSubmenuItems(),r=FT(i,o),{item:n,menus:Ne(r.menus,$e(n.value,r.items)),expansions:Ne(r.expansions,$e(n.value,n.value))}):{item:e,menus:{},expansions:{}};var n,o,i,r}(function(e){if(LT(e))return e;var t=Oe(e,"value").getOrThunk((function(){return Ri("generated-menu-item")}));return Ne({value:t},e)}(n),t);return{menus:Ne(e.menus,o.menus),items:[o.item].concat(e.items),expansions:Ne(e.expansions,o.expansions)}}),{menus:{},expansions:{},items:[]})},zT=function(e,t,n,o){var i=Ri("primary-menu"),r=FT(e,n.shared.providers.menuItems());if(0===r.items.length)return E.none();var a=ev(i,r.items,t,n,o),s=xe(r.menus,(function(e,o){return ev(o,e,t,n,!1)})),l=Ne(s,$e(i,a));return E.from(Kh.tieredData(i,l,r.expansions))},VT=function(e){return{isDisabled:function(){return pm.isDisabled(e)},setDisabled:function(t){return pm.set(e,t)},setActive:function(t){var n=e.element();t?(Qi(n,"tox-tbtn--enabled"),Ci(n,"aria-pressed",!0)):(er(n,"tox-tbtn--enabled"),_i(n,"aria-pressed"))},isActive:function(){return tr(e.element(),"tox-tbtn--enabled")}}},HT=function(e,t,n,o){return PT({text:e.text,icon:e.icon,tooltip:e.tooltip,role:o,fetch:function(t){e.fetch((function(e){t(zT(e,bg.CLOSE_ON_EXECUTE,n,!1))}))},onSetup:e.onSetup,getApi:VT,columns:1,presets:"normal",classes:[],dropdownBehaviours:[Ov.config({})]},t,n.shared)},WT=function(e,t,n){return function(o){o(H(e,(function(e){var o,i,r=e.text.fold((function(){return{}}),(function(e){return{text:e}}));return f(f({type:e.type,active:!1},r),{onAction:function(e){var o=!e.isActive();e.setActive(o),i.storage.set(o),n.shared.getSink().each((function(e){t().getOpt(e).each((function(e){_s(e.element()),So(e,Kv,{name:i.name,value:i.storage.get()})}))}))},onSetup:(o=i=e,function(e){e.setActive(o.storage.get())})})})))}},$T=function(e,t,n,o,i,r){void 0===n&&(n=[]);var a=t.fold((function(){return{}}),(function(e){return{action:e}})),s=f({buttonBehaviours:gs([Um((function(){return e.disabled||r.isReadOnly()})),Wm(),Ov.config({}),Yf("button press",[Lo("click"),Lo("mousedown")])].concat(n)),eventOrder:{click:["button press","alloy.base.behaviour"],mousedown:["button press","alloy.base.behaviour"]}},a),l=Ne(s,{dom:o});return Ne(l,{components:i})},UT=function(e,t,n,o){void 0===o&&(o=[]);var i={tag:"button",classes:["tox-tbtn"],attributes:e.tooltip.map((function(e){return{"aria-label":n.translate(e),title:n.translate(e)}})).getOr({})},r=e.icon.map((function(e){return RT(e,n.icons)})),a=Jm([r]);return $T(e,t,o,i,a,n)},qT=function(e,t,n,o){void 0===o&&(o=[]);var i=UT(e,E.some(t),n,o);return Xh.sketch(i)},jT=function(e,t,n,o,i){void 0===o&&(o=[]),void 0===i&&(i=[]);var r=n.translate(e.text),a=e.icon?e.icon.map((function(e){return RT(e,n.icons)})):E.none(),s=a.isSome()?Jm([a]):[],l=a.isSome()?{}:{innerHtml:r},u=g(e.primary||e.borderless?["tox-button"]:["tox-button","tox-button--secondary"],a.isSome()?["tox-button--icon"]:[],e.borderless?["tox-button--naked"]:[],i),c=f(f({tag:"button",classes:u},l),{attributes:{title:r}});return $T(e,t,o,c,s,n)},GT=function(e,t,n,o,i){void 0===o&&(o=[]),void 0===i&&(i=[]);var r=jT(e,E.some(t),n,o,i);return Xh.sketch(r)},XT=function(t,n){return function(o){"custom"===n?So(o,Kv,{name:t,value:{}}):"submit"===n?Ro(o,Pv):"cancel"===n?Ro(o,Mv):e.console.error("Unknown button type: ",n)}},YT=function(n,o,i){if("menu"===o){var r=n,a=f(f({},n),{onSetup:function(e){return e.setDisabled(n.disabled),t},fetch:WT(r.items,(function(){return s}),i)}),s=Yh(HT(a,"tox-tbtn",i,E.none()));return s.asSpec()}if("custom"===(c=o)||"cancel"===c||"submit"===c){var l=XT(n.name,o),u=f(f({},n),{borderless:!1});return GT(u,l,i.shared.providers,[])}var c;e.console.error("Unknown footer button type: ",o)},ZT=o([zt("field1Name","field1"),zt("field2Name","field2"),Sa("onLockedChange"),Da(["lockClass"]),zt("locked",!1),Hu("coupledFieldBehaviours",[qc,Bu])]),JT=function(e,t){return fc({factory:_v,name:e,overrides:function(e){return{fieldBehaviours:gs([Yf("coupled-input-behaviour",[Bo(Zn(),(function(n){Dc(n,e,t).bind(qc.getCurrent).each((function(t){Dc(n,e,"lock").each((function(o){hh.isOn(o)&&e.onLockedChange(n,t,o)}))}))}))])])}}})},QT=o([JT("field1","field2"),JT("field2","field1"),fc({factory:Xh,schema:[Dt("dom")],name:"lock",overrides:function(e){return{buttonBehaviours:gs([hh.config({selected:e.locked,toggleClass:e.markers.lockClass,aria:{mode:"pressed"}})])}}})]),ex=Vc({name:"FormCoupledInputs",configFields:ZT(),partFields:QT(),factory:function(e,t,n,o){return{uid:e.uid,dom:e.dom,components:t,behaviours:Wu(e.coupledFieldBehaviours,[qc.config({find:E.some}),Bu.config({store:{mode:"manual",getValue:function(t){var n,o=kc(t,e,["field1","field2"]);return(n={})[e.field1Name]=Bu.getValue(o.field1()),n[e.field2Name]=Bu.getValue(o.field2()),n},setValue:function(t,n){var o=kc(t,e,["field1","field2"]);Re(n,e.field1Name)&&Bu.setValue(o.field1(),n[e.field1Name]),Re(n,e.field2Name)&&Bu.setValue(o.field2(),n[e.field2Name])}}})]),apis:{getField1:function(t){return Dc(t,e,"field1")},getField2:function(t){return Dc(t,e,"field2")},getLock:function(t){return Dc(t,e,"lock")}}}},apis:{getField1:function(e,t){return e.getField1(t)},getField2:function(e,t){return e.getField2(t)},getLock:function(e,t){return e.getLock(t)}}}),tx=function(e){var t=/^\s*(\d+(?:\.\d+)?)\s*(|cm|mm|in|px|pt|pc|em|ex|ch|rem|vw|vh|vmin|vmax|%)\s*$/.exec(e);if(null===t)return le.error(e);var n=parseFloat(t[1]);return le.value({value:n,unit:t[2]})},nx=function(e,t){var n={"":96,px:96,pt:72,cm:2.54,pc:12,mm:25.4,in:1},o=function(e){return Object.prototype.hasOwnProperty.call(n,e)};return e.unit===t?E.some(e.value):o(e.unit)&&o(t)?E.some(n[e.unit]===n[t]?e.value:e.value/n[e.unit]*n[t]):E.none()},ox=function(e){return E.none()},ix=function(e,t){var n=ox,o=Ri("ratio-event"),i=ex.parts().lock({dom:{tag:"button",classes:["tox-lock","tox-button","tox-button--naked","tox-button--icon"],attributes:{title:t.translate(e.label.getOr("Constrain proportions"))}},components:[{dom:{tag:"span",classes:["tox-icon","tox-lock-icon__lock"],innerHtml:Jh("lock",t.icons)}},{dom:{tag:"span",classes:["tox-icon","tox-lock-icon__unlock"],innerHtml:Jh("unlock",t.icons)}}],buttonBehaviours:gs([pm.config({disabled:function(){return e.disabled||t.isReadOnly()}}),Wm(),Ov.config({})])}),r=function(e){return{dom:{tag:"div",classes:["tox-form__group"]},components:e}},a=function(n){return _v.parts().field({factory:$v,inputClasses:["tox-textfield"],inputBehaviours:gs([pm.config({disabled:function(){return e.disabled||t.isReadOnly()}}),Wm(),Ov.config({}),Yf("size-input-events",[Bo(jn(),(function(e,t){So(e,o,{isField1:n})})),Bo(Jn(),(function(t,n){So(t,Av,{name:e.name})}))])]),selectOnFocus:!1})},s=function(e){return{dom:{tag:"label",classes:["tox-label"],innerHtml:t.translate(e)}}},l=ex.parts().field1(r([_v.parts().label(s("Width")),a(!0)])),u=ex.parts().field2(r([_v.parts().label(s("Height")),a(!1)]));return ex.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:[{dom:{tag:"div",classes:["tox-form__controls-h-stack"]},components:[l,u,r([s("&nbsp;"),i])]}],field1Name:"width",field2Name:"height",locked:!0,markers:{lockClass:"tox-locked"},onLockedChange:function(e,t,o){tx(Bu.getValue(e)).each((function(e){n(e).each((function(e){var n,o,i,r;Bu.setValue(t,(-1!==(r=(n=e).value.toFixed((o=n.unit)in(i={"":0,px:0,pt:1,mm:1,pc:2,ex:2,em:2,ch:2,rem:2,cm:3,in:4,"%":4})?i[o]:1)).indexOf(".")&&(r=r.replace(/\.?0*$/,"")),r+n.unit))}))}))},coupledFieldBehaviours:gs([pm.config({disabled:function(){return e.disabled||t.isReadOnly()},onDisabled:function(e){ex.getField1(e).bind(_v.getField).each(pm.disable),ex.getField2(e).bind(_v.getField).each(pm.disable),ex.getLock(e).each(pm.disable)},onEnabled:function(e){ex.getField1(e).bind(_v.getField).each(pm.enable),ex.getField2(e).bind(_v.getField).each(pm.enable),ex.getLock(e).each(pm.enable)}}),Wm(),Yf("size-input-events2",[Bo(o,(function(e,t){var o=t.event().isField1(),i=o?ex.getField1(e):ex.getField2(e),r=o?ex.getField2(e):ex.getField1(e),a=i.map(Bu.getValue).getOr(""),s=r.map(Bu.getValue).getOr("");n=function(e,t){var n,o,i,r=tx(e).toOption();return o=tx(t).toOption(),i=function(e,t){return nx(e,t.unit).map((function(e){return t.value/e})).map((function(e){return n=e,o=t.unit,function(e){return nx(e,o).map((function(e){return{value:e*n,unit:o}}))};var n,o})).getOr(ox)},((n=r).isSome()&&o.isSome()?E.some(i(n.getOrDie(),o.getOrDie())):E.none()).getOr(ox)}(a,s)}))])])})},rx={undo:o(Ri("undo")),redo:o(Ri("redo")),zoom:o(Ri("zoom")),back:o(Ri("back")),apply:o(Ri("apply")),swap:o(Ri("swap")),transform:o(Ri("transform")),tempTransform:o(Ri("temp-transform")),transformApply:o(Ri("transform-apply"))},ax=o("save-state"),sx=o("disable"),lx=o("enable"),ux={formActionEvent:Kv,saveState:ax,disable:sx,enable:lx},cx=tinymce.util.Tools.resolve("tinymce.dom.DomQuery"),dx=tinymce.util.Tools.resolve("tinymce.geom.Rect"),fx=tinymce.util.Tools.resolve("tinymce.util.Observable"),hx=tinymce.util.Tools.resolve("tinymce.util.Tools"),gx=tinymce.util.Tools.resolve("tinymce.util.VK");function mx(e){var t,n;if(e.changedTouches)for(t="screenX screenY pageX pageY clientX clientY".split(" "),n=0;n<t.length;n++)e[t[n]]=e.changedTouches[0][t[n]]}function px(t,n){var o,i,r,a,s=n.document||e.document,l=s.getElementById((n=n||{}).handle||t),u=function(e){if(mx(e),e.button!==i)return c(e);e.deltaX=e.screenX-r,e.deltaY=e.screenY-a,e.preventDefault(),n.drag(e)},c=function(e){mx(e),cx(s).off("mousemove touchmove",u).off("mouseup touchend",c),o.remove(),n.stop&&n.stop(e)};this.destroy=function(){cx(l).off()},cx(l).on("mousedown touchstart",(function(t){var d,f=function(e){var t=Math.max,n=e.documentElement,o=e.body,i=t(n.scrollWidth,o.scrollWidth),r=t(n.clientWidth,o.clientWidth),a=t(n.offsetWidth,o.offsetWidth),s=t(n.scrollHeight,o.scrollHeight),l=t(n.clientHeight,o.clientHeight);return{width:i<a?r:i,height:s<t(n.offsetHeight,o.offsetHeight)?l:s}}(s);mx(t),t.preventDefault(),i=t.button;var h=l;r=t.screenX,a=t.screenY,d=e.window.getComputedStyle?e.window.getComputedStyle(h,null).getPropertyValue("cursor"):h.runtimeStyle.cursor,o=cx("<div></div>").css({position:"absolute",top:0,left:0,width:f.width,height:f.height,zIndex:2147483647,opacity:1e-4,cursor:d}).appendTo(s.body),cx(s).on("mousemove touchmove",u).on("mouseup touchend",c),n.start(t)}))}var vx,yx,bx,Cx,Tx=0,xx=function(e,t,n,o,i){return qT({name:e,icon:E.some(t),disabled:n,tooltip:E.some(e),primary:!1,borderless:!1},o,i)},Ex=function(e,t){t?pm.enable(e):pm.disable(e)},_x=function(n,i){var r,a,s,l=function(t){var n=Xt(t),o=Xt(E.none()),i=function(){var e=[],t=-1;function n(){return 0<t}function o(){return-1!==t&&t<e.length-1}return{data:e,add:function(n){var o=e.splice(++t);return e.push(n),{state:n,removed:o}},undo:function(){if(n())return e[--t]},redo:function(){if(o())return e[++t]},canUndo:n,canRedo:o}}();i.add(t);var r=function(e){n.set(e)},a=function(t){return{blob:t,url:e.URL.createObjectURL(t)}},s=function(t){e.URL.revokeObjectURL(t.url)},l=function(){o.get().each(s),o.set(E.none())},u=function(e){var t=a(e);r(t);var n=i.add(t).removed;return hx.each(n,s),t.url};return{getBlobState:function(){return n.get()},setBlobState:r,addBlobState:u,getTempState:function(){return o.get().fold((function(){return n.get()}),(function(e){return e}))},updateTempState:function(e){var t=a(e);return l(),o.set(E.some(t)),t.url},addTempState:function(e){var t=a(e);return o.set(E.some(t)),t.url},applyTempState:function(e){return o.get().fold((function(){}),(function(t){u(t.blob),e()}))},destroyTempState:l,undo:function(){var e=i.undo();return r(e),e.url},redo:function(){var e=i.redo();return r(e),e.url},getHistoryStates:function(){return{undoEnabled:i.canUndo(),redoEnabled:i.canRedo()}}}}(n.currentState),u=function(e){var t=l.getHistoryStates();y.updateButtonUndoStates(e,t.undoEnabled,t.redoEnabled),So(e,ux.formActionEvent,{name:ux.saveState(),value:t.undoEnabled})},c=function(e){return e.toBlob()},d=function(e){So(e,ux.formActionEvent,{name:ux.disable(),value:{}})},f=function(e){b.getApplyButton(e).each((function(e){pm.enable(e)})),So(e,ux.formActionEvent,{name:ux.enable(),value:{}})},h=function(e,t){return d(e),v.updateSrc(e,t)},g=function(t,n,o,i,r){return d(t),function(t){return function(t){return new eT((function(n){var o=new e.FileReader;o.onloadend=function(){n(o.result)},o.readAsDataURL(t)}))}(t).then((function(n){return uT(function(t){return function(t){return new eT((function(n,o){var i=e.URL.createObjectURL(t),r=new e.Image,a=function(){r.removeEventListener("load",s),r.removeEventListener("error",l)};function s(){a(),n(r)}function l(){a(),o("Unable to load data of type "+t.type+": "+i)}r.addEventListener("load",s),r.addEventListener("error",l),r.src=i,r.complete&&s()}))}(t).then((function(t){!function(t){e.URL.revokeObjectURL(t.src)}(t);var n=UC(XC(t),YC(t));return jC(n).drawImage(t,0,0),n}))}(t),t,n)}))}(n).then(o).then(c).then(i).then((function(e){return h(t,e).then((function(e){return u(t),r(),f(t),e}))})).catch((function(n){return e.console.log(n),f(t),n}))},m=function(e,t,n){var o=l.getBlobState().blob;g(e,o,t,(function(e){return l.updateTempState(e)}),n)},p=function(e){var t=l.getBlobState().url;return l.destroyTempState(),u(e),t},v=function(e){var t=Yh({dom:{tag:"div",classes:["tox-image-tools__image-bg"],attributes:{role:"presentation"}}}),n=Xt(1),o=Xt(E.none()),i=Xt({x:0,y:0,w:1,h:1}),r=Xt({x:0,y:0,w:1,h:1}),a=function(e,r){u.getOpt(e).each((function(e){var a=n.get(),s=Hr(e.element()),l=Mr(e.element()),u=r.dom().naturalWidth*a,c=r.dom().naturalHeight*a,d=Math.max(0,s/2-u/2),f=Math.max(0,l/2-c/2),h={left:d.toString()+"px",top:f.toString()+"px",width:u.toString()+"px",height:c.toString()+"px",position:"absolute"};pr(r,h),t.getOpt(e).each((function(e){pr(e.element(),h)})),o.get().each((function(e){var t=i.get();e.setRect({x:t.x*a+d,y:t.y*a+f,w:t.w*a,h:t.h*a}),e.setClampRect({x:d,y:f,w:u,h:c}),e.setViewPortRect({x:0,y:0,w:s,h:l})}))}))},s=function(e,t){var o,s=Jt("img");return Ci(s,"src",t),o=s.dom(),new ug((function(e){var t=function(){o.removeEventListener("load",t),e(o)};o.complete?e(o):o.addEventListener("load",t)})).then((function(){return u.getOpt(e).map((function(e){var t=wr({element:s});Xf.replaceAt(e,1,E.some(t));var o=r.get(),l={x:0,y:0,w:s.dom().naturalWidth,h:s.dom().naturalHeight};r.set(l);var c,d=dx.inflate(l,-20,-20);return i.set(d),o.w===l.w&&o.h===l.h||(c=s,u.getOpt(e).each((function(e){var t=Hr(e.element()),o=Mr(e.element()),i=c.dom().naturalWidth,r=c.dom().naturalHeight,a=Math.min(t/i,o/r);n.set(1<=a?1:a)}))),a(e,s),s}))}))},l=Cv.sketch({dom:{tag:"div",classes:["tox-image-tools__image"]},components:[t.asSpec(),{dom:{tag:"img",attributes:{src:e}}},{dom:{tag:"div"},behaviours:gs([Yf("image-panel-crop-events",[Uo((function(e){u.getOpt(e).each((function(e){var t=function(e,t,n,o,i){var r,a="tox-",s="tox-crid-"+Tx++,l=[{name:"move",xMul:0,yMul:0,deltaX:1,deltaY:1,deltaW:0,deltaH:0,label:"Crop Mask"},{name:"nw",xMul:0,yMul:0,deltaX:1,deltaY:1,deltaW:-1,deltaH:-1,label:"Top Left Crop Handle"},{name:"ne",xMul:1,yMul:0,deltaX:0,deltaY:1,deltaW:1,deltaH:-1,label:"Top Right Crop Handle"},{name:"sw",xMul:0,yMul:1,deltaX:1,deltaY:0,deltaW:-1,deltaH:1,label:"Bottom Left Crop Handle"},{name:"se",xMul:1,yMul:1,deltaX:0,deltaY:0,deltaW:1,deltaH:1,label:"Bottom Right Crop Handle"}],u=["top","right","bottom","left"],c=function(e,t){return{x:t.x-e.x,y:t.y-e.y,w:t.w,h:t.h}};function d(t,o,i,r){var a,s,l,u,d;a=o.x,s=o.y,l=o.w,u=o.h,(l+=i*t.deltaW)<20&&(l=20),(u+=r*t.deltaH)<20&&(u=20),d=e=dx.clamp({x:a+=i*t.deltaX,y:s+=r*t.deltaY,w:l,h:u},n,"move"===t.name),d=c(n,d),m.fire("updateRect",{rect:d}),g(d)}function f(e){function n(e,t){t.h<0&&(t.h=0),t.w<0&&(t.w=0),cx("#"+s+"-"+e,o).css({left:t.x,top:t.y,width:t.w,height:t.h})}hx.each(l,(function(t){cx("#"+s+"-"+t.name,o).css({left:e.w*t.xMul+e.x,top:e.h*t.yMul+e.y})})),n("top",{x:t.x,y:t.y,w:t.w,h:e.y-t.y}),n("right",{x:e.x+e.w,y:e.y,w:t.w-e.x-e.w+t.x,h:e.h}),n("bottom",{x:t.x,y:e.y+e.h,w:t.w,h:t.h-e.y-e.h+t.y}),n("left",{x:t.x,y:e.y,w:e.x-t.x,h:e.h}),n("move",e)}function h(t){f(e=t)}function g(e){h(function(e,t){return{x:t.x+e.x,y:t.y+e.y,w:t.w,h:t.h}}(n,e))}cx('<div id="'+s+'" class="'+a+'croprect-container" role="grid" aria-dropeffect="execute">').appendTo(o),hx.each(u,(function(e){cx("#"+s,o).append('<div id="'+s+"-"+e+'"class="'+a+'croprect-block" style="display: none" data-mce-bogus="all">')})),hx.each(l,(function(e){cx("#"+s,o).append('<div id="'+s+"-"+e.name+'" class="'+a+"croprect-handle "+a+"croprect-handle-"+e.name+'"style="display: none" data-mce-bogus="all" role="gridcell" tabindex="-1" aria-label="'+e.label+'" aria-grabbed="false" title="'+e.label+'">')})),r=hx.map(l,(function(t){var n;return new px(s,{document:o.ownerDocument,handle:s+"-"+t.name,start:function(){n=e},drag:function(e){d(t,n,e.deltaX,e.deltaY)}})})),f(e),cx(o).on("focusin focusout",(function(e){cx(e.target).attr("aria-grabbed","focus"===e.type?"true":"false")})),cx(o).on("keydown",(function(t){var n;function o(e,t,o,i,r){e.stopPropagation(),e.preventDefault(),d(n,o,i,r)}switch(hx.each(l,(function(e){if(t.target.id===s+"-"+e.name)return n=e,!1})),t.keyCode){case gx.LEFT:o(t,0,e,-10,0);break;case gx.RIGHT:o(t,0,e,10,0);break;case gx.UP:o(t,0,e,0,-10);break;case gx.DOWN:o(t,0,e,0,10);break;case gx.ENTER:case gx.SPACEBAR:t.preventDefault()}}));var m=hx.extend({toggleVisibility:function(e){var t=hx.map(l,(function(e){return"#"+s+"-"+e.name})).concat(hx.map(u,(function(e){return"#"+s+"-"+e}))).join(",");e?cx(t,o).show():cx(t,o).hide()},setClampRect:function(t){n=t,f(e)},setRect:h,getInnerRect:function(){return c(n,e)},setInnerRect:g,setViewPortRect:function(n){t=n,f(e)},destroy:function(){hx.each(r,(function(e){e.destroy()})),r=[]}},fx);return m}({x:10,y:10,w:100,h:100},{x:0,y:0,w:200,h:200},{x:0,y:0,w:200,h:200},e.element().dom());t.toggleVisibility(!1),t.on("updateRect",(function(e){var t=e.rect,o=n.get(),r={x:Math.round(t.x/o),y:Math.round(t.y/o),w:Math.round(t.w/o),h:Math.round(t.h/o)};i.set(r)})),o.set(E.some(t))}))}))])])}],containerBehaviours:gs([Xf.config({}),Yf("image-panel-events",[Uo((function(t){s(t,e)}))])])}),u=Yh(l);return{memContainer:u,updateSrc:s,zoom:function(e,t){var o=n.get(),i=0<t?Math.min(2,o+.1):Math.max(.1,o-.1);n.set(i),u.getOpt(e).each((function(e){var t=e.components()[1].element();a(e,t)}))},showCrop:function(){o.get().each((function(e){e.toggleVisibility(!0)}))},hideCrop:function(){o.get().each((function(e){e.toggleVisibility(!1)}))},getRect:function(){return i.get()},getMeasurements:function(){var e=r.get();return{width:e.w,height:e.h}}}}(n.currentState.url),y=(a=Yh(xx("Undo","undo",!0,(function(e){So(e,rx.undo(),{direction:1})}),r=i)),s=Yh(xx("Redo","redo",!0,(function(e){So(e,rx.redo(),{direction:1})}),r)),{container:Cv.sketch({dom:{tag:"div",classes:["tox-image-tools__toolbar","tox-image-tools__sidebar"]},components:[a.asSpec(),s.asSpec(),xx("Zoom in","zoom-in",!1,(function(e){So(e,rx.zoom(),{direction:1})}),r),xx("Zoom out","zoom-out",!1,(function(e){So(e,rx.zoom(),{direction:-1})}),r)]}),updateButtonUndoStates:function(e,t,n){a.getOpt(e).each((function(e){Ex(e,t)})),s.getOpt(e).each((function(e){Ex(e,n)}))}}),b=function(e,n){var i=function(e,t,o,i){return Yh(GT({name:e,text:e,disabled:o,primary:i,icon:E.none(),borderless:!1},t,n))},r=function(e,t,o,i){return Yh(qT({name:e,icon:E.some(e),tooltip:E.some(t),disabled:i,primary:!1,borderless:!1},o,n))},a=function(e,t){e.map((function(e){var n=e.get(t);n.hasConfigured(pm)&&pm.disable(n)}))},s=function(e,t){e.map((function(e){var n=e.get(t);n.hasConfigured(pm)&&pm.enable(n)}))},l={tag:"div",classes:["tox-image-tools__toolbar","tox-image-tools-edit-panel"]},u=t,c=function(e,t,n){So(e,t,n)},d=function(e){return Ro(e,ux.disable())},f=function(e){return Ro(e,ux.enable())},h=function(e,t){d(e),c(e,rx.transform(),{transform:t}),f(e)},g=function(e){return function(){J.getOpt(e).each((function(e){Xf.set(e,[Y])}))}},m=function(e,t){d(e),c(e,rx.transformApply(),{transform:t,swap:g(e)}),f(e)},p=function(){return i("Back",(function(e){return c(e,rx.back(),{swap:g(e)})}),!1,!1)},v=function(){return Yh({dom:{tag:"div",classes:["tox-spacer"]},behaviours:gs([pm.config({})])})},y=function(){return i("Apply",(function(e){return c(e,rx.apply(),{swap:g(e)})}),!0,!0)},b=[p(),v(),i("Apply",(function(t){m(t,(function(t){var n=e.getRect();return function(e,t,n,o,i){return e.toCanvas().then((function(r){return function(e,t,n,o,i,r){var a=UC(i,r);return jC(a).drawImage(e,-n,-o),cT(a,t)}(r,e.getType(),t,n,o,i)}))}(t,n.x,n.y,n.w,n.h)})),e.hideCrop()}),!1,!0)],C=Cv.sketch({dom:l,components:b.map((function(e){return e.asSpec()})),containerBehaviours:gs([Yf("image-tools-crop-buttons-events",[Bo(ux.disable(),(function(e,t){a(b,e)})),Bo(ux.enable(),(function(e,t){s(b,e)}))])])}),T=Yh(ix({name:"size",label:E.none(),constrain:!0,disabled:!1},n)),x=[p(),v(),T,v(),i("Apply",(function(e){T.getOpt(e).each((function(t){var n,o,i=Bu.getValue(t),r=parseInt(i.width,10),a=parseInt(i.height,10),s=(n=r,o=a,function(e){return function(e,t,n){return function(e,t,n){return e.toCanvas().then((function(o){return function e(t,n,o){var i=XC(t),r=YC(t),a=n/i,s=o/r,l=!1;(a<.5||2<a)&&(a=a<.5?.5:2,l=!0),(s<.5||2<s)&&(s=s<.5?.5:2,l=!0);var u=function(e,t,n){return new eT((function(o){var i=XC(e),r=YC(e),a=Math.floor(i*t),s=Math.floor(r*n),l=UC(a,s);jC(l).drawImage(e,0,0,i,r,0,0,a,s),o(l)}))}(t,a,s);return l?u.then((function(t){return e(t,n,o)})):u}(o,t,n).then((function(t){return cT(t,e.getType())}))}))}(e,t,n)}(e,n,o)});m(e,s)}))}),!1,!0)],_=Cv.sketch({dom:l,components:x.map((function(e){return e.asSpec()})),containerBehaviours:gs([Yf("image-tools-resize-buttons-events",[Bo(ux.disable(),(function(e,t){a(x,e)})),Bo(ux.enable(),(function(e,t){s(x,e)}))])])}),I=function(e,t){return function(n){return e(n,t)}},D=I(DT,"h"),O=I(DT,"v"),w=I(OT,-90),R=I(OT,90),S=function(e,t){var n,o;o=t,d(n=e),c(n,rx.tempTransform(),{transform:o}),f(n)},k=[p(),v(),r("flip-horizontally","Flip horizontally",(function(e){S(e,D)}),!1),r("flip-vertically","Flip vertically",(function(e){S(e,O)}),!1),r("rotate-left","Rotate counterclockwise",(function(e){S(e,w)}),!1),r("rotate-right","Rotate clockwise",(function(e){S(e,R)}),!1),v(),y()],A=Cv.sketch({dom:l,components:k.map((function(e){return e.asSpec()})),containerBehaviours:gs([Yf("image-tools-fliprotate-buttons-events",[Bo(ux.disable(),(function(e,t){a(k,e)})),Bo(ux.enable(),(function(e,t){s(k,e)}))])])}),N=function(e,t,i,r,a){var s=pC.parts().label({dom:{tag:"label",classes:["tox-label"],innerHtml:n.translate(e)}}),l=pC.parts().spectrum({dom:{tag:"div",classes:["tox-slider__rail"],attributes:{role:"presentation"}}}),u=pC.parts().thumb({dom:{tag:"div",classes:["tox-slider__handle"],attributes:{role:"presentation"}}});return Yh(pC.sketch({dom:{tag:"div",classes:["tox-slider"],attributes:{role:"presentation"}},model:{mode:"x",minX:i,maxX:a,getInitialValue:o({x:o(r)})},components:[s,l,u],sliderBehaviours:gs([th.config({})]),onChoose:t}))},M=function(e,t,n,o,i){var r=function(e,t,n,o,i){return[p(),(r=t,N(e,(function(e,t,n){var o=I(r,n.x()/100);h(e,o)}),n,o,i)),y()];var r}(e,t,n,o,i);return Cv.sketch({dom:l,components:r.map((function(e){return e.asSpec()})),containerBehaviours:gs([Yf("image-tools-filter-panel-buttons-events",[Bo(ux.disable(),(function(e,t){a(r,e)})),Bo(ux.enable(),(function(e,t){s(r,e)}))])])})},K=[p(),v(),y()],P=Cv.sketch({dom:l,components:K.map((function(e){return e.asSpec()}))}),L=M("Brightness",_T,-100,0,100),B=M("Contrast",IT,-100,0,100),F=M("Gamma",ET,-100,0,100),z=function(e){return N(e,(function(e,t,n){var o=V.getOpt(e),i=W.getOpt(e),r=H.getOpt(e);o.each((function(t){i.each((function(n){r.each((function(o){var i=function(e,t,n){return function(o){return function(e,t,n,o){return gT(e,function(e,t,n,o){return hT([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1],[t=dT(t,0,2),0,0,0,0,0,n=dT(n,0,2),0,0,0,0,0,o=dT(o,0,2),0,0,0,0,0,1,0,0,0,0,0,1])}(0,t,n,o))}(o,e,t,n)}}(Bu.getValue(t).x()/100,Bu.getValue(o).x()/100,Bu.getValue(n).x()/100);h(e,i)}))}))}))}),0,100,200)},V=z("R"),H=z("G"),W=z("B"),$=[p(),V,H,W,y()],U=Cv.sketch({dom:l,components:$.map((function(e){return e.asSpec()}))}),q=function(e,t,n){return function(o){c(o,rx.swap(),{transform:t,swap:function(){J.getOpt(o).each((function(t){Xf.set(t,[e]),n(t)}))}})}},j=E.some(xT),G=E.some(TT),X=[r("crop","Crop",q(C,E.none(),(function(t){e.showCrop()})),!1),r("resize","Resize",q(_,E.none(),(function(t){T.getOpt(t).each((function(t){var n=e.getMeasurements();Bu.setValue(t,{width:n.width,height:n.height})}))})),!1),r("orientation","Orientation",q(A,E.none(),u),!1),r("brightness","Brightness",q(L,E.none(),u),!1),r("sharpen","Sharpen",q(P,j,u),!1),r("contrast","Contrast",q(B,E.none(),u),!1),r("color-levels","Color levels",q(U,E.none(),u),!1),r("gamma","Gamma",q(F,E.none(),u),!1),r("invert","Invert",q(P,G,u),!1)],Y=Cv.sketch({dom:l,components:X.map((function(e){return e.asSpec()}))}),Z=Cv.sketch({dom:{tag:"div"},components:[Y],containerBehaviours:gs([Xf.config({})])}),J=Yh(Z);return{memContainer:J,getApplyButton:function(e){return J.getOpt(e).map((function(e){var t=e.components()[0];return t.components()[t.components().length-1]}))}}}(v,i);return{dom:{tag:"div",attributes:{role:"presentation"}},components:[b.memContainer.asSpec(),v.memContainer.asSpec(),y.container],behaviours:gs([Bu.config({store:{mode:"manual",getValue:function(){return l.getBlobState()}}}),Yf("image-tools-events",[Bo(rx.undo(),(function(e,t){var n=l.undo();h(e,n).then((function(t){f(e),u(e)}))})),Bo(rx.redo(),(function(e,t){var n=l.redo();h(e,n).then((function(t){f(e),u(e)}))})),Bo(rx.zoom(),(function(e,t){var n=t.event().direction();v.zoom(e,n)})),Bo(rx.back(),(function(e,t){var n,o;o=p(n=e),h(n,o).then((function(e){f(n)})),t.event().swap()(),v.hideCrop()})),Bo(rx.apply(),(function(e,t){l.applyTempState((function(){p(e),t.event().swap()()}))})),Bo(rx.transform(),(function(e,n){return m(e,n.event().transform(),t)})),Bo(rx.tempTransform(),(function(e,n){return o=e,i=n.event().transform(),r=l.getTempState().blob,void g(o,r,i,(function(e){return l.addTempState(e)}),t);var o,i,r})),Bo(rx.transformApply(),(function(e,t){return n=e,o=t.event().transform(),i=t.event().swap(),r=l.getBlobState().blob,void g(n,r,o,(function(e){var t=l.addBlobState(e);return p(n),t}),i);var n,o,i,r})),Bo(rx.swap(),(function(e,t){y.updateButtonUndoStates(e,!1,!1);var n=t.event().transform(),o=t.event().swap();n.fold((function(){o()}),(function(t){m(e,t,o)}))}))]),IC()])}},Ix=zc({name:"HtmlSelect",configFields:[Dt("options"),Fu("selectBehaviours",[th,Bu]),zt("selectClasses",[]),zt("selectAttributes",{}),Mt("data")],factory:function(e,t){var n=H(e.options,(function(e){return{dom:{tag:"option",value:e.value,innerHtml:e.text}}})),o=e.data.map((function(e){return $e("initialValue",e)})).getOr({});return{uid:e.uid,dom:{tag:"select",classes:e.selectClasses,attributes:e.selectAttributes},components:n,behaviours:Vu(e.selectBehaviours,[th.config({}),Bu.config({store:f({mode:"manual",getValue:function(e){return _r(e.element())},setValue:function(t,n){G(e.options,(function(e){return e.value===n})).isSome()&&Ir(t.element(),n)}},o)})])}}}),Dx=function(e,t){var n=e.label.map((function(e){return kv(e,t)})),i=[pm.config({disabled:function(){return e.disabled||t.isReadOnly()}}),Wm(),$f.config({mode:"execution",useEnter:!0!==e.multiline,useControlEnter:!0===e.multiline,execute:function(e){return Ro(e,Pv),E.some(!0)}}),Yf("textfield-change",[Bo(Zn(),(function(t,n){So(t,Av,{name:e.name})})),Bo(ro(),(function(t,n){So(t,Av,{name:e.name})}))]),Ov.config({})],r=e.validation.map((function(e){return dy.config({getRoot:function(e){return ri(e.element())},invalidClass:"tox-invalid",validator:{validate:function(t){var n=Bu.getValue(t),o=e.validator(n);return ty(!0===o?le.value(n):le.error(o))},validateOnLoad:e.validateOnLoad}})})).toArray(),a=e.placeholder.fold(o({}),(function(e){return{placeholder:t.translate(e)}})),s=e.inputMode.fold(o({}),(function(e){return{inputmode:e}})),l=f(f({},a),s),u=_v.parts().field({tag:!0===e.multiline?"textarea":"input",inputAttributes:l,inputClasses:[e.classname],inputBehaviours:gs(Y([i,r])),selectOnFocus:!1,factory:$v}),c=(e.flex?["tox-form__group--stretched"]:[]).concat(e.maximized?["tox-form-group--maximize"]:[]),d=[pm.config({disabled:function(){return e.disabled||t.isReadOnly()},onDisabled:function(e){_v.getField(e).each(pm.disable)},onEnabled:function(e){_v.getField(e).each(pm.enable)}}),Wm()];return wv(n,u,c,d)},Ox=Object.freeze({__proto__:null,events:function(e,t){var n=e.stream.streams.setup(e,t);return Ko([Bo(e.event,n),qo((function(){return t.cancel()}))].concat(e.cancelEvent.map((function(e){return[Bo(e,(function(){return t.cancel()}))]})).getOr([])))}}),wx=function(e){var t=Xt(null);return qi({readState:function(){return{timer:null!==t.get()?"set":"unset"}},setTimer:function(e){t.set(e)},cancel:function(){var e=t.get();null!==e&&e.cancel()}})},Rx=Object.freeze({__proto__:null,throttle:wx,init:function(e){return e.stream.streams.state(e)}}),Sx=[Ot("stream",pt("mode",{throttle:[Dt("delay"),zt("stopEvent",!0),Aa("streams",{setup:function(e,t){var n=e.stream,o=tg(e.onStream,n.delay);return t.setTimer(o),function(e,t){o.throttle(e,t),n.stopEvent&&t.stop()}},state:wx})]})),zt("event","input"),Mt("cancelEvent"),Sa("onStream")],kx=ps({fields:Sx,name:"streaming",active:Ox,state:Rx}),Ax=function(e,t,n){var o=Bu.getValue(n);Bu.setValue(t,o),Mx(t)},Nx=function(e,t){var n=e.element(),o=_r(n),i=n.dom();"number"!==Ti(n,"type")&&t(i,o)},Mx=function(e){Nx(e,(function(e,t){return e.setSelectionRange(t.length,t.length)}))},Kx=o("alloy.typeahead.itemexecute"),Px=o([Mt("lazySink"),Dt("fetch"),zt("minChars",5),zt("responseTime",1e3),wa("onOpen"),zt("getHotspot",E.some),zt("getAnchorOverrides",o({})),zt("layouts",E.none()),zt("eventOrder",{}),jt("model",{},[zt("getDisplayText",(function(e){return void 0!==e.meta&&void 0!==e.meta.text?e.meta.text:e.value})),zt("selectsOver",!0),zt("populateFromBrowse",!0)]),wa("onSetValue"),Ra("onExecute"),wa("onItemExecute"),zt("inputClasses",[]),zt("inputAttributes",{}),zt("inputStyles",{}),zt("matchWidth",!0),zt("useMinWidth",!1),zt("dismissOnBlur",!0),Da(["openClass"]),Mt("initialData"),Fu("typeaheadBehaviours",[th,Bu,kx,$f,hh,gy]),Gt("previewing",(function(){return Xt(!0)}))].concat(Vv()).concat(Iy())),Lx=o([hc({schema:[Ia()],name:"menu",overrides:function(e){return{fakeFocus:!0,onHighlight:function(t,n){e.previewing.get()?t.getSystem().getByUid(e.uid).each((function(o){(function(e,t,n){if(e.selectsOver){var o=Bu.getValue(t),i=e.getDisplayText(o),r=Bu.getValue(n);return 0===e.getDisplayText(r).indexOf(i)?E.some((function(){var e;Ax(0,t,n),e=i.length,Nx(t,(function(t,n){return t.setSelectionRange(e,n.length)}))})):E.none()}return E.none()})(e.model,o,n).fold((function(){return nd.dehighlight(t,n)}),(function(e){return e()}))})):t.getSystem().getByUid(e.uid).each((function(t){e.model.populateFromBrowse&&Ax(0,t,n)})),e.previewing.set(!1)},onExecute:function(t,n){return t.getSystem().getByUid(e.uid).toOption().map((function(e){return So(e,Kx(),{item:n}),!0}))},onHover:function(t,n){e.previewing.set(!1),t.getSystem().getByUid(e.uid).each((function(t){e.model.populateFromBrowse&&Ax(0,t,n)}))}}}})]),Bx=Vc({name:"Typeahead",configFields:Px(),partFields:Lx(),factory:function(e,n,o,i){var r=function(n,o,r){e.previewing.set(!1);var a=gy.getCoupled(n,"sandbox");yu.isOpen(a)?qc.getCurrent(a).each((function(e){nd.getHighlighted(e).fold((function(){r(e)}),(function(){Mo(a,e.element(),"keydown",o)}))})):yy(e,s(n),n,a,i,(function(e){qc.getCurrent(e).each(r)}),jv.HighlightFirst).get(t)},a=Hv(e),s=function(e){return function(t){return t.map((function(t){var n=De(t.menus),o=Z(n,(function(e){return U(e.items,(function(e){return"item"===e.type}))}));return Bu.getState(e).update(H(o,(function(e){return e.data}))),t}))}},l=[th.config({}),Bu.config({onSetValue:e.onSetValue,store:f({mode:"dataset",getDataKey:function(e){return _r(e.element())},getFallbackEntry:function(e){return{value:e,meta:{}}},setValue:function(t,n){Ir(t.element(),e.model.getDisplayText(n))}},e.initialData.map((function(e){return $e("initialValue",e)})).getOr({}))}),kx.config({stream:{mode:"throttle",delay:e.responseTime,stopEvent:!1},onStream:function(n,o){var r=gy.getCoupled(n,"sandbox");if(th.isFocused(n)&&_r(n.element()).length>=e.minChars){var a=qc.getCurrent(r).bind((function(e){return nd.getHighlighted(e).map(Bu.getValue)}));e.previewing.set(!0),yy(e,s(n),n,r,i,(function(t){qc.getCurrent(r).each((function(t){a.fold((function(){e.model.selectsOver&&nd.highlightFirst(t)}),(function(e){nd.highlightBy(t,(function(t){return Bu.getValue(t).value===e.value})),nd.getHighlighted(t).orThunk((function(){return nd.highlightFirst(t),E.none()}))}))}))}),jv.HighlightFirst).get(t)}},cancelEvent:ho()}),$f.config({mode:"special",onDown:function(e,t){return r(e,t,nd.highlightFirst),E.some(!0)},onEscape:function(e){var t=gy.getCoupled(e,"sandbox");return yu.isOpen(t)?(yu.close(t),E.some(!0)):E.none()},onUp:function(e,t){return r(e,t,nd.highlightLast),E.some(!0)},onEnter:function(t){var n=gy.getCoupled(t,"sandbox"),o=yu.isOpen(n);if(o&&!e.previewing.get())return qc.getCurrent(n).bind((function(e){return nd.getHighlighted(e)})).map((function(e){return So(t,Kx(),{item:e}),!0}));var i=Bu.getValue(t);return Ro(t,ho()),e.onExecute(n,t,i),o&&yu.close(n),E.some(!0)}}),hh.config({toggleClass:e.markers.openClass,aria:{mode:"expanded"}}),gy.config({others:{sandbox:function(t){return Ey(e,t,{onOpen:function(){return hh.on(t)},onClose:function(){return hh.off(t)}})}}}),Yf("typeaheadevents",[Go((function(n){var o=t;Cy(e,s(n),n,i,o,jv.HighlightFirst).get(t)})),Bo(Kx(),(function(t,n){var o=gy.getCoupled(t,"sandbox");Ax(0,t,n.event().item()),Ro(t,ho()),e.onItemExecute(t,o,n.event().item(),Bu.getValue(t)),yu.close(o),Mx(t)}))].concat(e.dismissOnBlur?[Bo(io(),(function(e){var t=gy.getCoupled(e,"sandbox");Ds(t.element()).isNone()&&yu.close(t)}))]:[]))];return{uid:e.uid,dom:Wv(Ne(e,{inputAttributes:{role:"combobox","aria-autocomplete":"list","aria-haspopup":"true"}})),behaviours:f(f({},a),Vu(e.typeaheadBehaviours,l)),eventOrder:e.eventOrder}}}),Fx=function(t){return f(f({},t),{toCached:function(){return Fx(t.toCached())},bindFuture:function(e){return Fx(t.bind((function(t){return t.fold((function(e){return ty(le.error(e))}),(function(t){return e(t)}))})))},bindResult:function(e){return Fx(t.map((function(t){return t.bind(e)})))},mapResult:function(e){return Fx(t.map((function(t){return t.map(e)})))},mapError:function(e){return Fx(t.map((function(t){return t.mapError(e)})))},foldResult:function(e,n){return t.map((function(t){return t.fold(e,n)}))},withTimeout:function(n,o){return Fx(ey((function(i){var r=!1,a=e.setTimeout((function(){r=!0,i(le.error(o()))}),n);t.get((function(t){r||(e.clearTimeout(a),i(t))}))})))}})},zx={type:"separator"},Vx=function(e){return{type:"menuitem",value:e.url,text:e.title,meta:{attach:e.attach},onAction:function(){}}},Hx=function(e,t){return{type:"menuitem",value:t,text:e,meta:{attach:void 0},onAction:function(){}}},Wx=function(e,t){return o=e,n=U(t,(function(e){return e.type===o})),H(n,Vx);var n,o},$x=function(e,t){var n=e.toLowerCase();return U(t,(function(e){return bn((void 0!==e.meta&&void 0!==e.meta.text?e.meta.text:e.text).toLowerCase(),n)||bn(e.value.toLowerCase(),n)}))},Ux=Ri("aria-invalid"),qx=function(e,n,o){var i,r,a,s,l,u=n.shared.providers,c=function(t){var n=Bu.getValue(t);o.addToHistory(n.value,e.filetype)},d=_v.parts().field({factory:Bx,dismissOnBlur:!0,inputClasses:["tox-textfield"],sandboxClasses:["tox-dialog__popups"],inputAttributes:{"aria-errormessage":Ux,type:"url"},minChars:0,responseTime:0,fetch:function(t){var i=function(e,t,n){var o=Bu.getValue(t),i=void 0!==o.meta.text?o.meta.text:o.value;return n.getLinkInformation().fold((function(){return[]}),(function(t){var o,r,a,s,l=$x(i,(o=n.getHistory(e),H(o,(function(e){return Hx(e,e)}))));return"file"===e?(r=[l,$x(i,Wx("header",t.targets)),$x(i,Y([(s=t,E.from(s.anchorTop).map((function(e){return Hx("<top>",e)})).toArray()),Wx("anchor",t.targets),(a=t,E.from(a.anchorBottom).map((function(e){return Hx("<bottom>",e)})).toArray())]))],j(r,(function(e,t){return 0===e.length||0===t.length?e.concat(t):e.concat(zx,t)}),[])):l}))}(e.filetype,t,o),r=zT(i,bg.BUBBLE_TO_SANDBOX,n,!1);return ty(r)},getHotspot:function(e){return y.getOpt(e)},onSetValue:function(e,n){e.hasConfigured(dy)&&dy.run(e).get(t)},typeaheadBehaviours:gs(Y([o.getValidationHandler().map((function(t){return dy.config({getRoot:function(e){return ri(e.element())},invalidClass:"tox-control-wrap--status-invalid",notify:{onInvalid:function(e,t){g.getOpt(e).each((function(e){Ci(e.element(),"title",u.translate(t))}))}},validator:{validate:function(n){var o=Bu.getValue(n);return Fx(ey((function(n){t({type:e.filetype,url:o.value},(function(e){if("invalid"===e.status){var t=le.error(e.message);n(t)}else{var o=le.value(e.message);n(o)}}))})))},validateOnLoad:!1}})})).toArray(),[pm.config({disabled:function(){return e.disabled||u.isReadOnly()}}),Ov.config({}),Yf("urlinput-events",Y(["file"===e.filetype?[Bo(Zn(),(function(t){So(t,Av,{name:e.name})}))]:[],[Bo(Jn(),(function(t){So(t,Av,{name:e.name}),c(t)})),Bo(ro(),(function(t){So(t,Av,{name:e.name}),c(t)}))]]))]])),eventOrder:((i={})[Zn()]=["streaming","urlinput-events","invalidating"],i),model:{getDisplayText:function(e){return e.value},selectsOver:!1,populateFromBrowse:!1},markers:{openClass:"tox-textfield--popup-open"},lazySink:n.shared.getSink,parts:{menu:kg(0,0,"normal")},onExecute:function(e,t,n){So(t,Pv,{})},onItemExecute:function(t,n,o,i){c(t),So(t,Av,{name:e.name})}}),h=e.label.map((function(e){return kv(e,u)})),g=Yh((r="invalid",a=E.some(Ux),void 0===(s="warning")&&(s=r),void 0===l&&(l=r),{dom:{tag:"div",classes:["tox-icon","tox-control-wrap__status-icon-"+r],innerHtml:Jh(s,u.icons),attributes:f({title:u.translate(l),"aria-live":"polite"},a.fold((function(){return{}}),(function(e){return{id:e}})))}})),m=Yh({dom:{tag:"div",classes:["tox-control-wrap__status-icon-wrap"]},components:[g.asSpec()]}),p=o.getUrlPicker(e.filetype),v=Ri("browser.url.event"),y=Yh({dom:{tag:"div",classes:["tox-control-wrap"]},components:[d,m.asSpec()],behaviours:gs([pm.config({disabled:function(){return e.disabled||u.isReadOnly()}})])}),b=Yh(GT({name:e.name,icon:E.some("browse"),text:e.label.getOr(""),disabled:e.disabled,primary:!1,borderless:!0},(function(e){return Ro(e,v)}),u,[],["tox-browse-url"]));return _v.sketch({dom:Sv([]),components:h.toArray().concat([{dom:{tag:"div",classes:["tox-form__controls-h-stack"]},components:Y([[y.asSpec()],p.map((function(){return b.asSpec()})).toArray()])}]),fieldBehaviours:gs([pm.config({disabled:function(){return e.disabled||u.isReadOnly()},onDisabled:function(e){_v.getField(e).each(pm.disable),b.getOpt(e).each(pm.disable)},onEnabled:function(e){_v.getField(e).each(pm.enable),b.getOpt(e).each(pm.enable)}}),Wm(),Yf("url-input-events",[Bo(v,(function(t){qc.getCurrent(t).each((function(n){var o=Bu.getValue(n),i=f({fieldname:e.name},o);p.each((function(o){o(i).get((function(o){Bu.setValue(n,o),So(t,Av,{name:e.name})}))}))}))}))])])})},jx=function(e){return function(t,n,o){return Oe(n,"name").fold((function(){return e(n,o)}),(function(i){return t.field(i,e(n,o))}))}},Gx={bar:jx((function(e,t){return{dom:{tag:"div",classes:["tox-bar","tox-form__controls-h-stack"]},components:H(e.items,t.shared.interpreter)}})),collection:jx((function(e,t){return function(e,t){var n,o=e.label.map((function(e){return kv(e,t)})),r=function(e){return function(t,n){fa(n.event().target(),"[data-collection-item-value]").each((function(o){e(t,n,o,Ti(o,"data-collection-item-value"))}))}},a=r((function(n,o,i,r){o.stop(),t.isReadOnly()||So(n,Kv,{name:e.name,value:r})})),s=[Bo(qn(),r((function(e,t,n){_s(n)}))),Bo(Qn(),a),Bo(uo(),a),Bo(jn(),r((function(e,t,n){da(e.element(),"."+Dg).each((function(e){er(e,Dg)})),Qi(n,Dg)}))),Bo(Gn(),r((function(e){da(e.element(),"."+Dg).each((function(e){er(e,Dg)}))}))),Go(r((function(t,n,o,i){So(t,Kv,{name:e.name,value:i})})))],l=function(e,t){return H(ml(e.element(),".tox-collection__item"),t)},u=_v.parts().field({dom:{tag:"div",classes:["tox-collection"].concat(1!==e.columns?["tox-collection--grid"]:["tox-collection--list"])},components:[],factory:{sketch:i},behaviours:gs([pm.config({disabled:t.isReadOnly,onDisabled:function(e){l(e,(function(e){Qi(e,"tox-collection__item--state-disabled"),Ci(e,"aria-disabled",!0)}))},onEnabled:function(e){l(e,(function(e){er(e,"tox-collection__item--state-disabled"),_i(e,"aria-disabled")}))}}),Wm(),Xf.config({}),Bu.config({store:{mode:"memory",initialValue:[]},onSetValue:function(n,o){(function(n,o){var i=H(o,(function(n){var o,i=nm.translate(n.text),r=1===e.columns?'<div class="tox-collection__item-label">'+i+"</div>":"",a='<div class="tox-collection__item-icon">'+n.icon+"</div>",s={_:" "," - ":" ","-":" "},l=i.replace(/\_| \- |\-/g,(function(e){return s[e]}));return'<div class="tox-collection__item'+(t.isReadOnly()?" tox-collection__item--state-disabled":"")+'" tabindex="-1" data-collection-item-value="'+('"'===(o=n.value)?"&quot;":o)+'" title="'+l+'" aria-label="'+l+'">'+a+r+"</div>"})),r=1<e.columns&&"auto"!==e.columns?V(i,e.columns):[i],a=H(r,(function(e){return'<div class="tox-collection__group">'+e.join("")+"</div>"}));yi(n.element(),a.join(""))})(n,o),"auto"===e.columns&&Ug(n,5,"tox-collection__item").each((function(e){$f.setGridSize(n,e.numRows,e.numColumns)})),Ro(n,zv)}}),Ov.config({}),$f.config((n=e.columns,1===n?{mode:"menu",moveOnTab:!1,selector:".tox-collection__item"}:"auto"===n?{mode:"flatgrid",selector:".tox-collection__item",initSize:{numColumns:1,numRows:1}}:{mode:"matrix",selectors:{row:".tox-collection__group",cell:"."+Tg}})),Yf("collection-events",s)]),eventOrder:{"alloy.execute":["disabling","alloy.base.behaviour","collection-events"]}});return wv(o,u,["tox-form__group--collection"],[])}(e,t.shared.providers)})),alertbanner:jx((function(e,t){return Cv.sketch({dom:{tag:"div",attributes:{role:"alert"},classes:["tox-notification","tox-notification--in","tox-notification--"+(n=e).level]},components:[{dom:{tag:"div",classes:["tox-notification__icon"]},components:[Xh.sketch({dom:{tag:"button",classes:["tox-button","tox-button--naked","tox-button--icon"],innerHtml:Jh(n.icon,(o=t.shared.providers).icons),attributes:{title:o.translate(n.iconTooltip)}},action:function(e){So(e,Kv,{name:"alert-banner",value:n.url})}})]},{dom:{tag:"div",classes:["tox-notification__body"],innerHtml:o.translate(n.text)}}]});var n,o})),input:jx((function(e,t){return o=t.shared.providers,Dx({name:(n=e).name,multiline:!1,label:n.label,inputMode:n.inputMode,placeholder:n.placeholder,flex:!1,disabled:n.disabled,classname:"tox-textfield",validation:E.none(),maximized:n.maximized},o);var n,o})),textarea:jx((function(e,t){return o=t.shared.providers,Dx({name:(n=e).name,multiline:!0,label:n.label,inputMode:E.none(),placeholder:n.placeholder,flex:!0,disabled:n.disabled,classname:"tox-textarea",validation:E.none(),maximized:n.maximized},o);var n,o})),label:jx((function(e,t){return i={dom:{tag:"label",innerHtml:(o=t.shared).providers.translate((n=e).label),classes:["tox-label"]}},r=H(n.items,o.interpreter),{dom:{tag:"div",classes:["tox-form__group"]},components:[i].concat(r),behaviours:gs([IC(),Xf.config({}),KC(E.none()),$f.config({mode:"acyclic"})])};var n,o,i,r})),iframe:(vx=function(e,t){return function(e,t){var n,o,i=$C&&e.sandboxed,r=f(f({},e.label.map((function(e){return{title:e}})).getOr({})),i?{sandbox:"allow-scripts allow-same-origin"}:{}),a=(n=i,o=Xt(""),{getValue:function(e){return o.get()},setValue:function(e,t){if(n)Ci(e.element(),"srcdoc",t);else{Ci(e.element(),"src","javascript:''");var i=e.element().dom().contentWindow.document;i.open(),i.write(t),i.close()}o.set(t)}}),s=e.label.map((function(e){return kv(e,t)})),l=_v.parts().field({factory:{sketch:function(e){return zC({uid:e.uid,dom:{tag:"iframe",attributes:r},behaviours:gs([Ov.config({}),th.config({}),MC(E.none(),a.getValue,a.setValue)])})}}});return wv(s,l,["tox-form__group--stretched"],[])}(e,t.shared.providers)},function(e,t,n){var o=Ne(t,{source:"dynamic"});return jx(vx)(e,o,n)}),button:jx((function(e,t){return function(e,t){var n,o,i=XT(e.name,"custom");return n=E.none(),o=_v.parts().field(f({factory:Xh},jT(e,E.some(i),t,[PC(""),IC()]))),wv(n,o,[],[])}(e,t.shared.providers)})),checkbox:jx((function(e,t){return n=e,o=t.shared.providers,r=Bu.config({store:{mode:"manual",getValue:function(e){return e.element().dom().checked},setValue:function(e,t){e.element().dom().checked=t}}}),a=function(e){return e.element().dom().click(),E.some(!0)},s=_v.parts().field({factory:{sketch:i},dom:{tag:"input",classes:["tox-checkbox__input"],attributes:{type:"checkbox"}},behaviours:gs([IC(),pm.config({disabled:function(){return n.disabled||o.isReadOnly()}}),Ov.config({}),th.config({}),r,$f.config({mode:"special",onEnter:a,onSpace:a,stopSpaceKeyup:!0}),Yf("checkbox-events",[Bo(Jn(),(function(e,t){So(e,Av,{name:n.name})}))])])}),l=_v.parts().label({dom:{tag:"span",classes:["tox-checkbox__label"],innerHtml:o.translate(n.label)},behaviours:gs([Ry.config({})])}),c=Yh({dom:{tag:"div",classes:["tox-checkbox__icons"]},components:[(u=function(e){return{dom:{tag:"span",classes:["tox-icon","tox-checkbox-icon__"+e],innerHtml:Jh("checked"===e?"selected":"unselected",o.icons)}}})("checked"),u("unchecked")]}),_v.sketch({dom:{tag:"label",classes:["tox-checkbox"]},components:[s,c.asSpec(),l],fieldBehaviours:gs([pm.config({disabled:function(){return n.disabled||o.isReadOnly()},disableClass:"tox-checkbox--disabled",onDisabled:function(e){_v.getField(e).each(pm.disable)},onEnabled:function(e){_v.getField(e).each(pm.enable)}}),Wm()])});var n,o,r,a,s,l,u,c})),colorinput:jx((function(e,t){return function(e,t,n){var o,i,r=_v.parts().field({factory:$v,inputClasses:["tox-textfield"],onSetValue:function(e){return dy.run(e).get((function(){}))},inputBehaviours:gs([pm.config({disabled:t.providers.isReadOnly}),Wm(),Ov.config({}),dy.config({invalidClass:"tox-textbox-field-invalid",getRoot:function(e){return ri(e.element())},notify:{onValid:function(e){var t=Bu.getValue(e);So(e,Sy,{color:t})}},validator:{validateOnLoad:!1,validate:function(e){var t=Bu.getValue(e);if(0===t.length)return ty(le.value(!0));var n=Jt("span");mr(n,"background-color",t);var o=Cr(n,"background-color").fold((function(){return le.error("blah")}),(function(e){return le.value(t)}));return ty(o)}}})]),selectOnFocus:!1}),a=e.label.map((function(e){return kv(e,t.providers)})),s=function(e,t){So(e,ky,{value:t})},l=Yh((o={dom:{tag:"span",attributes:{"aria-label":t.providers.translate("Color swatch")}},layouts:{onRtl:function(){return[Qa,Ja,os]},onLtr:function(){return[Ja,Qa,os]}},components:[],fetch:$p(n.getColors(),n.hasCustomColors()),columns:n.getColorCols(),presets:"color",onItemAction:function(e,t){l.getOpt(e).each((function(e){"custom"===t?n.colorPicker((function(t){t.fold((function(){return Ro(e,Ay)}),(function(t){s(e,t),zp(t)}))}),"#ffffff"):s(e,"remove"===t?"":t)}))}},wy.sketch({dom:o.dom,components:o.components,toggleClass:"mce-active",dropdownBehaviours:gs([Um((i=t).providers.isReadOnly),Wm(),Ry.config({}),Ov.config({})]),layouts:o.layouts,sandboxClasses:["tox-dialog__popups"],lazySink:i.getSink,fetch:function(e){return ey((function(e){return o.fetch(e)})).map((function(t){return E.from(tv(Ne(Xp(Ri("menu-value"),t,(function(t){o.onItemAction(e,t)}),o.columns,o.presets,bg.CLOSE_ON_EXECUTE,(function(){return!1}),i.providers),{movement:Zp(o.columns,o.presets)})))}))},parts:{menu:kg(0,0,o.presets)}})));return _v.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:a.toArray().concat([{dom:{tag:"div",classes:["tox-color-input"]},components:[r,l.asSpec()]}]),fieldBehaviours:gs([Yf("form-field-events",[Bo(Sy,(function(t,n){l.getOpt(t).each((function(e){mr(e.element(),"background-color",n.event().color())})),So(t,Av,{name:e.name})})),Bo(ky,(function(e,t){_v.getField(e).each((function(n){Bu.setValue(n,t.event().value()),qc.getCurrent(e).each(th.focus)}))})),Bo(Ay,(function(e,t){_v.getField(e).each((function(t){qc.getCurrent(e).each(th.focus)}))}))])])})}(e,t.shared,t.colorinput)})),colorpicker:jx((function(n){var i=function(e,n){return zc({name:"ColourPicker",configFields:[Dt("dom"),zt("onValidHex",t),zt("onInvalidHex",t)],factory:function(i){var r,a,s,l,u,c=function(e,n,o,i){var r=function(o,i,r,a,s){var l,u,c=e(_C+"range"),d=[_v.parts().label({dom:{tag:"label",innerHtml:r,attributes:{"aria-label":a}}}),_v.parts().field({data:s,factory:$v,inputAttributes:f({type:"text"},"hex"===i?{"aria-live":"polite"}:{}),inputClasses:[n("textfield")],inputBehaviours:gs([(l=i,u=o,dy.config({invalidClass:n("invalid"),notify:{onValidate:function(e){So(e,EC,{type:l})},onValid:function(e){So(e,TC,{type:l,value:Bu.getValue(e)})},onInvalid:function(e){So(e,xC,{type:l,value:Bu.getValue(e)})}},validator:{validate:function(t){var n=Bu.getValue(t),o=u(n)?le.value(!0):le.error(e("aria.input.invalid"));return ty(o)},validateOnLoad:!1}})),Ov.config({})]),onSetValue:function(e){dy.isInvalid(e)&&dy.run(e).get(t)}})],h="hex"!==i?[_v.parts()["aria-descriptor"]({text:c})]:[];return{dom:{tag:"div",attributes:{role:"presentation"}},components:d.concat(h)}},a=function(e,t){Bu.setValue(e,{red:t.red,green:t.green,blue:t.blue})},s=Yh({dom:{tag:"div",classes:[n("rgba-preview")],styles:{"background-color":"white"},attributes:{role:"presentation"}}}),l=function(e,t){s.getOpt(e).each((function(e){mr(e.element(),"background-color","#"+t.value)}))};return zc({factory:function(){var t={red:Xt(E.some(255)),green:Xt(E.some(255)),blue:Xt(E.some(255)),hex:Xt(E.some("ffffff"))},u=function(e){return t[e].get()},c=function(e,n){t[e].set(n)},d=function(e){var t=e.green,n=e.blue;c("red",E.some(e.red)),c("green",E.some(t)),c("blue",E.some(n))},f=function(e,t){var n=t.event();"hex"!==n.type()?c(n.type(),E.none()):i(e)},h=function(e,t){var n=t.event();"hex"===n.type()?function(e,t){o(e);var n=gp(t);c("hex",E.some(t));var i=wp(n);a(e,i),d(i),So(e,My,{hex:n}),l(e,n)}(e,n.value()):function(e,t,n){var o=parseInt(n,10);c(t,E.some(o)),u("red").bind((function(e){return u("green").bind((function(t){return u("blue").map((function(n){return Ip(e,t,n,1)}))}))})).each((function(t){var n,o,i=(n=e,o=bp(t),CC.getField(n,"hex").each((function(e){th.isFocused(e)||Bu.setValue(n,{hex:o.value})})),o);l(e,i)}))}(e,n.type(),n.value())},g=function(t){return{label:e(_C+t+".label"),description:e(_C+t+".description")}},m=g("red"),p=g("green"),v=g("blue"),y=g("hex");return Ne(CC.sketch((function(t){return{dom:{tag:"form",classes:[n("rgb-form")],attributes:{"aria-label":e("aria.color.picker")}},components:[t.field("red",_v.sketch(r(Dp,"red",m.label,m.description,255))),t.field("green",_v.sketch(r(Dp,"green",p.label,p.description,255))),t.field("blue",_v.sketch(r(Dp,"blue",v.label,v.description,255))),t.field("hex",_v.sketch(r(vp,"hex",y.label,y.description,"ffffff"))),s.asSpec()],formBehaviours:gs([dy.config({invalidClass:n("form-invalid")}),Yf("rgb-form-events",[Bo(TC,h),Bo(xC,f),Bo(EC,f)])])}})),{apis:{updateHex:function(e,t){var n,o;Bu.setValue(e,{hex:t.value}),n=e,o=wp(t),a(n,o),d(o),l(e,t)}}})},name:"RgbForm",configFields:[],apis:{updateHex:function(e,t,n){e.updateHex(t,n)}},extraApis:{}})}(e,n,i.onValidHex,i.onInvalidHex),d=function(e,t){var n=pC.parts().spectrum({dom:{tag:"canvas",attributes:{role:"presentation"},classes:[t("sv-palette-spectrum")]}}),i=pC.parts().thumb({dom:{tag:"div",attributes:{role:"presentation"},classes:[t("sv-palette-thumb")],innerHtml:"<div class="+t("sv-palette-inner-thumb")+' role="presentation"></div>'}}),r=function(e,t){var n=e.width,o=e.height,i=e.getContext("2d");if(null!==i){i.fillStyle=t,i.fillRect(0,0,n,o);var r=i.createLinearGradient(0,0,n,0);r.addColorStop(0,"rgba(255,255,255,1)"),r.addColorStop(1,"rgba(255,255,255,0)"),i.fillStyle=r,i.fillRect(0,0,n,o);var a=i.createLinearGradient(0,0,0,o);a.addColorStop(0,"rgba(0,0,0,0)"),a.addColorStop(1,"rgba(0,0,0,1)"),i.fillStyle=a,i.fillRect(0,0,n,o)}};return zc({factory:function(e){var a=o({x:o(0),y:o(0)}),s=gs([qc.config({find:E.some}),th.config({})]);return pC.sketch({dom:{tag:"div",attributes:{role:"presentation"},classes:[t("sv-palette")]},model:{mode:"xy",getInitialValue:a},rounded:!1,components:[n,i],onChange:function(e,t,n){So(e,Py,{value:n})},onInit:function(e,t,n,o){r(n.element().dom(),Sp(kp))},sliderBehaviours:s})},name:"SaturationBrightnessPalette",configFields:[],apis:{setRgba:function(e,t,n){var o,i;o=n,i=t.components()[0].element().dom(),r(i,Sp(o))}},extraApis:{}})}(0,n),h={paletteRgba:Xt(kp)},g=Yh(d.sketch({})),m=Yh(c.sketch({})),p=function(e,t){m.getOpt(e).each((function(e){c.updateHex(e,t)}))},v=function(e,t,n){W(n,(function(n){n(e,t)}))};return{uid:i.uid,dom:i.dom,components:[g.asSpec(),(s=n,l=pC.parts().spectrum({dom:{tag:"div",classes:[s("hue-slider-spectrum")],attributes:{role:"presentation"}}}),u=pC.parts().thumb({dom:{tag:"div",classes:[s("hue-slider-thumb")],attributes:{role:"presentation"}}}),pC.sketch({dom:{tag:"div",classes:[s("hue-slider")],attributes:{role:"presentation"}},rounded:!1,model:{mode:"y",getInitialValue:o({y:o(0)})},components:[l,u],sliderBehaviours:gs([th.config({})]),onChange:function(e,t,n){So(e,Ky,{value:n})}})),m.asSpec()],behaviours:gs([Yf("colour-picker-events",[Bo(Py,(a=[p],function(e,t){var n,o,i,r,s,l,u,c,d,f=t.event().value(),g=(r=i=0,s=(n=h.paletteRgba.get()).red/255,l=n.green/255,u=n.blue/255,(c=Math.min(s,Math.min(l,u)))===(d=Math.max(s,Math.max(l,u)))?Ny(0,0,100*(r=c)):(i=60*((i=s===c?3:u===c?1:5)-(s===c?l-u:u===c?s-l:u-s)/(d-c)),o=(d-c)/d,r=d,Ny(Math.round(i),Math.round(100*o),Math.round(100*r)))),m=Ny(g.hue,f.x(),100-f.y()),p=Op(m),y=bp(p);v(e,y,a)})),Bo(Ky,(r=[function(e,t){g.getOpt(e).each((function(e){var n=wp(t);h.paletteRgba.set(n),d.setRgba(e,n)}))},p],function(e,t){var n,o,i,a=(n=t.event().value().y(),o=Ny((100-n)/100*360,100,100),i=Op(o),bp(i));v(e,a,r)}))]),qc.config({find:function(e){return m.getOpt(e)}}),$f.config({mode:"acyclic"})])}}})}(RC,(function(e){return"tox-"+e})),r=Yh(i.sketch({dom:{tag:"div",classes:["tox-color-picker-container"],attributes:{role:"presentation"}},onValidHex:function(e){So(e,Kv,{name:"hex-valid",value:!0})},onInvalidHex:function(e){So(e,Kv,{name:"hex-valid",value:!1})}}));return{dom:{tag:"div"},components:[r.asSpec()],behaviours:gs([Bu.config({store:{mode:"manual",getValue:function(e){var t=r.get(e);return qc.getCurrent(t).bind((function(e){return Bu.getValue(e).hex})).map((function(e){return"#"+e})).getOr("")},setValue:function(t,n){var o=/^#([a-fA-F0-9]{3}(?:[a-fA-F0-9]{3})?)/.exec(n),i=r.get(t);qc.getCurrent(i).fold((function(){e.console.log("Can not find form")}),(function(e){Bu.setValue(e,{hex:E.from(o[1]).getOr("")}),CC.getField(e,"hex").each((function(e){Ro(e,Zn())}))}))}}}),IC()])}})),dropzone:jx((function(e,t){return function(e,t){var n=function(e,t){t.stop()},o=function(e){return function(t,n){W(e,(function(e){e(t,n)}))}},i=function(e,t){if(!pm.isDisabled(e)){var n=t.event().raw();a(e,n.dataTransfer.files)}},r=function(e,t){var n=t.event().raw().target.files;a(e,n)},a=function(t,n){var o,i;Bu.setValue(t,(o=n,i=new RegExp("("+".jpg,.jpeg,.png,.gif".split(/\s*,\s*/).join("|")+")$","i"),U(ie(o),(function(e){return i.test(e.name)})))),So(t,Av,{name:e.name})},s=Yh({dom:{tag:"input",attributes:{type:"file",accept:"image/*"},styles:{display:"none"}},behaviours:gs([Yf("input-file-events",[Wo(Qn()),Wo(uo())])])}),l=e.label.map((function(e){return kv(e,t)})),u=_v.parts().field({factory:{sketch:function(e){return{uid:e.uid,dom:{tag:"div",classes:["tox-dropzone-container"]},behaviours:gs([PC([]),IC(),pm.config({}),hh.config({toggleClass:"dragenter",toggleOnExecute:!1}),Yf("dropzone-events",[Bo("dragenter",o([n,hh.toggle])),Bo("dragleave",o([n,hh.toggle])),Bo("dragover",n),Bo("drop",o([n,i])),Bo(Jn(),r)])]),components:[{dom:{tag:"div",classes:["tox-dropzone"],styles:{}},components:[{dom:{tag:"p",innerHtml:t.translate("Drop an image here")}},Xh.sketch({dom:{tag:"button",innerHtml:t.translate("Browse for an image"),styles:{position:"relative"},classes:["tox-button","tox-button--secondary"]},components:[s.asSpec()],action:function(e){s.get(e).element().dom().click()},buttonBehaviours:gs([Ov.config({}),Um(t.isReadOnly),Wm()])})]}]}}}});return wv(l,u,["tox-form__group--stretched"],[])}(e,t.shared.providers)})),grid:jx((function(e,t){return{dom:{tag:"div",classes:["tox-form__grid","tox-form__grid--"+(n=e).columns+"col"]},components:H(n.items,t.shared.interpreter)};var n})),selectbox:jx((function(e,t){return o=t.shared.providers,i=H((n=e).items,(function(e){return{text:o.translate(e.text),value:e.value}})),r=n.label.map((function(e){return kv(e,o)})),a=_v.parts().field({dom:{},selectAttributes:{size:n.size},options:i,factory:Ix,selectBehaviours:gs([pm.config({disabled:function(){return n.disabled||o.isReadOnly()}}),Ov.config({}),Yf("selectbox-change",[Bo(Jn(),(function(e,t){So(e,Av,{name:n.name})}))])])}),s=1<n.size?E.none():E.some({dom:{tag:"div",classes:["tox-selectfield__icon-js"],innerHtml:Jh("chevron-down",o.icons)}}),l={dom:{tag:"div",classes:["tox-selectfield"]},components:Y([[a],s.toArray()])},_v.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:Y([r.toArray(),[l]]),fieldBehaviours:gs([pm.config({disabled:function(){return n.disabled||o.isReadOnly()},onDisabled:function(e){_v.getField(e).each(pm.disable)},onEnabled:function(e){_v.getField(e).each(pm.enable)}}),Wm()])});var n,o,i,r,a,s,l})),sizeinput:jx((function(e,t){return ix(e,t.shared.providers)})),urlinput:jx((function(e,t){return qx(e,t,t.urlinput)})),customeditor:jx((function(e){var t=Xt(E.none()),n=Yh({dom:{tag:e.tag}}),o=Xt(E.none());return{dom:{tag:"div",classes:["tox-custom-editor"]},behaviours:gs([Yf("editor-foo-events",[Uo((function(i){n.getOpt(i).each((function(n){(Object.prototype.hasOwnProperty.call(e,"init")?e.init(n.element().dom()):SC.load(e.scriptId,e.scriptUrl).then((function(t){return t(n.element().dom(),e.settings)}))).then((function(e){o.get().each((function(t){e.setValue(t)})),o.set(E.none()),t.set(E.some(e))}))}))}))]),Bu.config({store:{mode:"manual",getValue:function(){return t.get().fold((function(){return o.get().getOr("")}),(function(e){return e.getValue()}))},setValue:function(e,n){t.get().fold((function(){o.set(E.some(n))}),(function(e){return e.setValue(n)}))}}}),IC()]),components:[n.asSpec()]}})),htmlpanel:jx((function(e){return Cv.sketch("presentation"===e.presets?{dom:{tag:"div",classes:["tox-form__group"],innerHtml:e.html}}:{dom:{tag:"div",classes:["tox-form__group"],innerHtml:e.html,attributes:{role:"document"}},containerBehaviours:gs([Ov.config({}),th.config({})])})})),imagetools:jx((function(e,t){return _x(e,t.shared.providers)})),table:jx((function(e,t){return o=t.shared.providers,a=function(e){return{dom:{tag:"td",innerHtml:o.translate(e)}}},s=function(e){return{dom:{tag:"tr"},components:H(e,a)}},{dom:{tag:"table",classes:["tox-dialog__table"]},components:[(r=(n=e).header,{dom:{tag:"thead"},components:[{dom:{tag:"tr"},components:H(r,(function(e){return{dom:{tag:"th",innerHtml:o.translate(e)}}}))}]}),(i=n.cells,{dom:{tag:"tbody"},components:H(i,s)})],behaviours:gs([Ov.config({}),th.config({})])};var n,o,i,r,a,s})),panel:jx((function(e,t){return{dom:{tag:"div",classes:(n=e).classes},components:H(n.items,t.shared.interpreter)};var n}))},Xx={field:function(e,t){return t}},Yx=function(e,t,n){var o=Ne(n,{shared:{interpreter:function(t){return Zx(e,t,o)}}});return Zx(e,t,o)},Zx=function(t,n,o){return Oe(Gx,n.type).fold((function(){return e.console.error('Unknown factory type "'+n.type+'", defaulting to container: ',n),n}),(function(e){return e(t,n,o)}))},Jx={valignCentre:[],alignCentre:[],alignLeft:[],alignRight:[],right:[],left:[],bottom:[],top:[]},Qx=function(e,t,n){var o=$s(-12,12,Jx),i={maxHeightFunction:Vs()};return function(){return n()?{anchor:"node",root:fr(ti(e())),node:E.from(e()),bubble:o,layouts:{onRtl:function(){return[Uh]},onLtr:function(){return[$h]}},overrides:i}:{anchor:"hotspot",hotspot:t(),bubble:o,layouts:{onRtl:function(){return[Ja]},onLtr:function(){return[Qa]}},overrides:i}}},eE=function(e,t,n){return function(){return n()?{anchor:"node",root:fr(ti(e())),node:E.from(e()),layouts:{onRtl:function(){return[qh]},onLtr:function(){return[qh]}}}:{anchor:"hotspot",hotspot:t(),layouts:{onRtl:function(){return[os]},onLtr:function(){return[os]}}}}},tE=function(e,t,n){var o,i,r,a=Pm(e),s=function(){return en(e.getContentAreaContainer())},l=function(){return a||!n()};return{inlineDialog:Qx(s,t,l),banner:eE(s,t,l),cursor:(i=e,function(){return{anchor:"selection",root:r(),getSelection:function(){var e=i.selection.getRng();return E.some(rl.range(en(e.startContainer),e.startOffset,en(e.endContainer),e.endOffset))}}}),node:(o=r=function(){return en(e.getBody())},function(e){return{anchor:"node",root:o(),node:e}})}},nE=function(e){return{colorPicker:function(e,t){Gp(i)(e,t)},hasCustomColors:function(){return Bp(o)},getColors:function(){return Fp(n)},getColorCols:(t=n=o=i=e,function(){return Vp(t)})};var t,n,o,i},oE=[{title:"Headings",items:[{title:"Heading 1",format:"h1"},{title:"Heading 2",format:"h2"},{title:"Heading 3",format:"h3"},{title:"Heading 4",format:"h4"},{title:"Heading 5",format:"h5"},{title:"Heading 6",format:"h6"}]},{title:"Inline",items:[{title:"Bold",format:"bold"},{title:"Italic",format:"italic"},{title:"Underline",format:"underline"},{title:"Strikethrough",format:"strikethrough"},{title:"Superscript",format:"superscript"},{title:"Subscript",format:"subscript"},{title:"Code",format:"code"}]},{title:"Blocks",items:[{title:"Paragraph",format:"p"},{title:"Blockquote",format:"blockquote"},{title:"Div",format:"div"},{title:"Pre",format:"pre"}]},{title:"Align",items:[{title:"Left",format:"alignleft"},{title:"Center",format:"aligncenter"},{title:"Right",format:"alignright"},{title:"Justify",format:"alignjustify"}]}],iE=function(e){return j(e,(function(e,t){if(we(t,"items")){var n=iE(t.items);return{customFormats:e.customFormats.concat(n.customFormats),formats:e.formats.concat([{title:t.title,items:n.formats}])}}if(we(t,"inline")||we(t,"block")||we(t,"selector")){var o="custom-"+t.title.toLowerCase();return{customFormats:e.customFormats.concat([{name:o,format:t}]),formats:e.formats.concat([{title:t.title,format:o,icon:t.icon}])}}return f(f({},e),{formats:e.formats.concat(t)})}),{customFormats:[],formats:[]})},rE=function(e){return E.from(e.getParam("style_formats")).filter(w).map((function(t){var n,o,i,r=(n=e,o=iE(t),i=function(e){W(e,(function(e){n.formatter.has(e.name)||n.formatter.register(e.name,e.format)}))},n.formatter?i(o.customFormats):n.on("init",(function(){i(o.customFormats)})),o.formats);return e.getParam("style_formats_merge",!1,"boolean")?oE.concat(r):r})).getOr(oE)},aE=function(e,t,n){var o={type:"formatter",isSelected:t(e.format),getStylePreview:n(e.format)};return Ne(e,o)},sE=function(e,t,n,o){var i=function(t){return H(t,(function(t){var r,a,s,l,u=be(t);if(Re(t,"items")){var c=i(t.items);return Ne(Ne(t,{type:"submenu"}),{getStyleItems:function(){return c}})}return Re(t,"format")?aE(t,n,o):1===u.length&&B(u,"title")?Ne(t,{type:"separator"}):(s={type:"formatter",format:a=Ri((r=t).title),isSelected:n(a),getStylePreview:o(a)},l=Ne(r,s),e.formatter.register(a,l),l)}))};return i(t)},lE=hx.trim,uE=function(e){return function(t){if(t&&1===t.nodeType){if(t.contentEditable===e)return!0;if(t.getAttribute("data-mce-contenteditable")===e)return!0}return!1}},cE=uE("true"),dE=uE("false"),fE=function(e,t,n,o,i){return{type:e,title:t,url:n,level:o,attach:i}},hE=function(e){return e.innerText||e.textContent},gE=function(e){return(t=e)&&"A"===t.nodeName&&void 0!==(t.id||t.name)&&pE(e);var t},mE=function(e){return e&&/^(H[1-6])$/.test(e.nodeName)},pE=function(e){return function(e){for(;e=e.parentNode;){var t=e.contentEditable;if(t&&"inherit"!==t)return cE(e)}return!1}(e)&&!dE(e)},vE=function(e){return mE(e)&&pE(e)},yE=function(e){var t,n,o=(t=e).id?t.id:Ri("h");return fE("header",hE(e),"#"+o,mE(n=e)?parseInt(n.nodeName.substr(1),10):0,(function(){e.id=o}))},bE=function(e){var n=e.id||e.name,o=hE(e);return fE("anchor",o||"#"+n,"#"+n,0,t)},CE=function(e){return 0<lE(e.title).length},TE=function(e){var t=function(e){return H(ml(en(e),"h1,h2,h3,h4,h5,h6,a:not([href])"),(function(e){return e.dom()}))}(e);return U(H(U(t,vE),yE).concat(H(U(t,gE),bE)),CE)},xE="tinymce-url-history",EE=function(e){return D(e)&&/^https?/.test(e)},_E=function(e){return O(e)&&Ie(e,(function(e){return!(w(t=e)&&t.length<=5&&J(t,EE));var t})).isNone()},IE=function(){var t,n=Np.getItem(xE);if(null===n)return{};try{t=JSON.parse(n)}catch(p){if(p instanceof SyntaxError)return e.console.log("Local storage "+xE+" was not valid JSON",p),{};throw p}return _E(t)?t:(e.console.log("Local storage "+xE+" was not valid format",t),{})},DE=function(e){var t=IE();return Object.prototype.hasOwnProperty.call(t,e)?t[e]:[]},OE=function(e,t){if(EE(e)){var n=IE(),o=Object.prototype.hasOwnProperty.call(n,t)?n[t]:[],i=U(o,(function(t){return t!==e}));n[t]=[e].concat(i).slice(0,5),function(e){if(!_E(e))throw new Error("Bad format for history:\n"+JSON.stringify(e));Np.setItem(xE,JSON.stringify(e))}(n)}},wE=function(e){return!!e},RE=function(e){return xe(hx.makeMap(e,/[, ]/),wE)},SE=function(e){return E.from(e.getParam("file_picker_callback")).filter(k)},kE=function(e){return E.from(e).filter(D).getOrUndefined()},AE=function(e){return{getHistory:DE,addToHistory:OE,getLinkInformation:function(){return!1===(t=e).getParam("typeahead_urls")?E.none():E.some({targets:TE(t.getBody()),anchorTop:kE(t.getParam("anchor_top","#top")),anchorBottom:kE(t.getParam("anchor_bottom","#bottom"))});var t},getValidationHandler:function(){return function(e){return E.from(void 0===(n=(t=e).getParam("file_picker_validator_handler",void 0,"function"))?t.getParam("filepicker_validator_handler",void 0,"function"):n);var t,n}(e)},getUrlPicker:function(t){return function(e,t){var n,o,i,r,a=(o=E.some((n=e).getParam("file_picker_types")).filter(wE),i=E.some(n.getParam("file_browser_callback_types")).filter(wE),r=o.or(i).map(RE),SE(n).fold((function(){return!1}),(function(e){return r.fold((function(){return!0}),(function(e){return 0<be(e).length&&e}))})));return R(a)?a?SE(e):E.none():a[t]?SE(e):E.none()}(n=e,o=t).map((function(e){return function(t){return ey((function(i){var r=f({filetype:o,fieldname:t.fieldname},E.from(t.meta).getOr({}));e.call(n,(function(e,t){if(!D(e))throw new Error("Expected value to be string");if(void 0!==t&&!O(t))throw new Error("Expected meta to be a object");i({value:e,meta:t})}),t.value,r)}))}}));var n,o}}},NE=function(e,t,n){var o,i,r=Xt(!1),a={isPositionedAtTop:function(){return"top"===o.get()},getDockingMode:(o=Xt(Mm(t)?"bottom":"top")).get,setDockingMode:o.set},s={shared:{providers:{icons:function(){return t.ui.registry.getAll().icons},menuItems:function(){return t.ui.registry.getAll().menuItems},translate:nm.translate,isReadOnly:function(){return t.mode.isReadOnly()}},interpreter:function(e){return Zx(Xx,e,s)},anchors:tE(t,n,a.isPositionedAtTop),header:a,getSink:function(){return le.value(e)}},urlinput:AE(t),styleselect:function(e){var t=function(t){return function(){return e.formatter.match(t)}},n=function(t){return function(){var n=e.formatter.get(t);return void 0!==n?E.some({tag:0<n.length&&(n[0].inline||n[0].block)||"div",styles:e.dom.parseStyle(e.formatter.getCssText(t))}):E.none()}},o=function(e){var t=e.items;return void 0!==t&&0<t.length?Z(t,o):[e.format]},i=Xt([]),r=Xt([]),a=Xt([]),s=Xt([]),l=Xt(!1);return e.on("PreInit",(function(a){var s=rE(e),l=sE(e,s,t,n);i.set(l),r.set(Z(l,o))})),e.on("addStyleModifications",(function(i){var r=sE(e,i.items,t,n);a.set(r),l.set(i.replace),s.set(Z(r,o))})),{getData:function(){var e=l.get()?[]:i.get(),t=a.get();return e.concat(t)},getFlattenedKeys:function(){var e=l.get()?[]:r.get(),t=s.get();return e.concat(t)}}}(t),colorinput:nE(t),dialog:{isDraggableModal:(i=t,function(){return i.getParam("draggable_modal",!1,"boolean")})},isContextMenuOpen:function(){return r.get()},setContextMenuState:function(e){return r.set(e)}};return s},ME=o((function(e,t){var n,o,i;n=e,o=Math.floor(t),i=Vr.max(n,o,["margin-left","border-left-width","padding-left","padding-right","border-right-width","margin-right"]),mr(n,"max-width",i+"px")})),KE="contexttoolbar-hide",PE=o([Dt("items"),Da(["itemSelector"]),Fu("tgroupBehaviours",[$f])]),LE=o([mc({name:"items",unit:"item"})]),BE=Vc({name:"ToolbarGroup",configFields:PE(),partFields:LE(),factory:function(e,t,n,o){return{uid:e.uid,dom:e.dom,components:t,behaviours:Vu(e.tgroupBehaviours,[$f.config({mode:"flow",selector:e.markers.itemSelector})]),domModification:{attributes:{role:"toolbar"}}}}}),FE=o([Dt("dom"),zt("shell",!0),Fu("toolbarBehaviours",[Xf])]),zE=o([gc({name:"groups",overrides:function(){return{behaviours:gs([Xf.config({})])}}})]),VE=Vc({name:"Toolbar",configFields:FE(),partFields:zE(),factory:function(t,n,o,i){var r=function(e){return t.shell?E.some(e):Dc(e,t,"groups")},a=t.shell?{behaviours:[Xf.config({})],components:[]}:{behaviours:[],components:n};return{uid:t.uid,dom:t.dom,components:a.components,behaviours:Vu(t.toolbarBehaviours,a.behaviours),apis:{setGroups:function(t,n){r(t).fold((function(){throw e.console.error("Toolbar was defined to not be a shell, but no groups container was specified in components"),new Error("Toolbar was defined to not be a shell, but no groups container was specified in components")}),(function(e){Xf.set(e,n)}))}},domModification:{attributes:{role:"group"}}}},apis:{setGroups:function(e,t,n){e.setGroups(t,n)}}}),HE=function(e,t,n){return{within:o(e),extra:o(t),withinWidth:o(n)}},WE=function(e,t,n){var i,r=(i=function(e,t){var i=n(e);return E.some({element:o(e),start:o(t),finish:o(t+i),width:o(i)})},j(e,(function(e,t){return i(t,e.len).fold(o(e),(function(t){return{len:t.finish(),list:e.list.concat([t])}}))}),{len:0,list:[]}).list),a=U(r,(function(e){return e.finish()<=t})),s=q(a,(function(e,t){return e+t.width()}),0),l=r.slice(a.length);return{within:o(a),extra:o(l),withinWidth:o(s)}},$E=function(e){return H(e,(function(e){return e.element()}))},UE=function(e,t){var n=H(t,(function(e){return kr(e)}));VE.setGroups(e,n)},qE=function(e,t,n){var o=Oc(e,t,"primary"),i=gy.getCoupled(e,"overflowGroup");mr(o.element(),"visibility","hidden");var r=t.builtGroups.get().concat([i]),a=re(r,(function(e){return Ds(e.element()).bind((function(t){return e.getSystem().getByDom(t).toOption()}))}));n([]),UE(o,r);var s=function(e,t,n,o){var i,r,a,s,l,u,c,d,f=(0===(i=WE(t,e,n)).extra().length?E.some(i):E.none()).getOrThunk((function(){return WE(t,e-n(o),n)})),h=f.within(),g=f.extra(),m=f.withinWidth();return 1===g.length&&g[0].width()<=n(o)?(c=m,d=$E(h.concat(g)),HE(d,[],c)):1<=g.length?(a=g,s=o,l=m,u=$E(h).concat([s]),HE(u,$E(a),l)):(r=m,HE($E(h),[],r))}(Hr(o.element()),t.builtGroups.get(),(function(e){return Hr(e.element())}),i);0===s.extra().length?(Xf.remove(o,i),n([])):(UE(o,s.within()),n(s.extra())),xr(o.element(),"visibility"),Er(o.element()),a.each(th.focus)},jE=o([Fu("splitToolbarBehaviours",[gy]),Gt("builtGroups",(function(){return Xt([])}))]),GE=o([Da(["overflowToggledClass"]),Bt("getOverflowBounds"),Dt("lazySink"),Gt("overflowGroups",(function(){return Xt([])}))].concat(jE())),XE=o([fc({factory:VE,schema:FE(),name:"primary"}),hc({schema:FE(),name:"overflow"}),hc({name:"overflow-button"}),hc({name:"overflow-group"})]),YE=o([Da(["toggledClass"]),Dt("lazySink"),St("fetch"),Bt("getBounds"),Ft("fireDismissalEventInstead",[zt("event",To())]),Js()]),ZE=o([hc({name:"button",overrides:function(e){return{dom:{attributes:{"aria-haspopup":"true"}},buttonBehaviours:gs([hh.config({toggleClass:e.markers.toggledClass,aria:{mode:"expanded"},toggleOnExecute:!1})])}}}),hc({factory:VE,schema:FE(),name:"toolbar",overrides:function(e){return{toolbarBehaviours:gs([$f.config({mode:"cyclic",onEscape:function(t){return Dc(t,e,"button").each(th.focus),E.none()}})])}}})]),JE=function(e,t){var n=gy.getCoupled(e,"toolbarSandbox");yu.isOpen(n)?yu.close(n):yu.open(n,t.toolbar())},QE=function(e,t,n,o){var i=n.getBounds.map((function(e){return e()})),r=n.lazySink(e).getOrDie();Yl.positionWithinBounds(r,{anchor:"hotspot",hotspot:e,layouts:o,overrides:{maxWidthFunction:ME()}},t,i)},e_=function(e,t,n,o,i){VE.setGroups(t,i),QE(e,t,n,o),hh.on(e)},t_=Vc({name:"FloatingToolbarButton",factory:function(e,t,n,o){return f(f({},Xh.sketch(f(f({},o.button()),{action:function(e){JE(e,o)},buttonBehaviours:Wu({dump:o.button().buttonBehaviours},[gy.config({others:{toolbarSandbox:function(t){return o=t,i=n,r=e,{dom:{tag:"div",attributes:{id:(a=ha()).id}},behaviours:gs([$f.config({mode:"special",onEscape:function(e){return yu.close(e),E.some(!0)}}),yu.config({onOpen:function(e,t){r.fetch().get((function(e){e_(o,t,r,i.layouts,e),a.link(o.element()),$f.focusIn(t)}))},onClose:function(){hh.off(o),th.focus(o),a.unlink(o.element())},isPartOf:function(e,t,n){return ga(t,n)||ga(o,n)},getAttachPoint:function(){return r.lazySink(o).getOrDie()}}),xs.config({channels:f(f({},Eu(f({isExtraPart:u},r.fireDismissalEventInstead.map((function(e){return{fireEventInstead:{event:e.event}}})).getOr({})))),Iu({doReposition:function(){yu.getState(gy.getCoupled(o,"toolbarSandbox")).each((function(e){QE(o,e,r,i.layouts)}))}}))})])};var o,i,r,a}}})])}))),{apis:{setGroups:function(t,o){yu.getState(gy.getCoupled(t,"toolbarSandbox")).each((function(i){e_(t,i,e,n.layouts,o)}))},reposition:function(t){yu.getState(gy.getCoupled(t,"toolbarSandbox")).each((function(o){QE(t,o,e,n.layouts)}))},toggle:function(e){JE(e,o)},getToolbar:function(e){return yu.getState(gy.getCoupled(e,"toolbarSandbox"))}}})},configFields:YE(),partFields:ZE(),apis:{setGroups:function(e,t,n){e.setGroups(t,n)},reposition:function(e,t){e.reposition(t)},toggle:function(e,t){e.toggle(t)},getToolbar:function(e,t){return e.getToolbar(t)}}}),n_=function(e){return H(e,(function(e){return kr(e)}))},o_=function(e,t,n){qE(e,n,(function(o){n.overflowGroups.set(o),t.getOpt(e).each((function(e){t_.setGroups(e,n_(o))}))}))},i_=Vc({name:"SplitFloatingToolbar",configFields:GE(),partFields:XE(),factory:function(e,t,n,o){var i=Yh(t_.sketch({fetch:function(){return ey((function(t){t(n_(e.overflowGroups.get()))}))},layouts:{onLtr:function(){return[Qa,Ja]},onRtl:function(){return[Ja,Qa]},onBottomLtr:function(){return[ts,es]},onBottomRtl:function(){return[es,ts]}},getBounds:n.getOverflowBounds,lazySink:e.lazySink,fireDismissalEventInstead:{},markers:{toggledClass:e.markers.overflowToggledClass},parts:{button:o["overflow-button"](),toolbar:o.overflow()}}));return{uid:e.uid,dom:e.dom,components:t,behaviours:Vu(e.splitToolbarBehaviours,[gy.config({others:{overflowGroup:function(){return BE.sketch(f(f({},o["overflow-group"]()),{items:[i.asSpec()]}))}}})]),apis:{setGroups:function(t,n){e.builtGroups.set(H(n,t.getSystem().build)),o_(t,i,e)},refresh:function(t){return o_(t,i,e)},toggle:function(e){i.getOpt(e).each((function(e){t_.toggle(e)}))},reposition:function(e){i.getOpt(e).each((function(e){t_.reposition(e)}))},getOverflow:function(e){return i.getOpt(e).bind((function(e){return t_.getToolbar(e)}))}},domModification:{attributes:{role:"group"}}}},apis:{setGroups:function(e,t,n){e.setGroups(t,n)},refresh:function(e,t){e.refresh(t)},reposition:function(e,t){e.reposition(t)},toggle:function(e,t){e.toggle(t)},getOverflow:function(e,t){return e.getOverflow(t)}}}),r_=function(e,t){return t.getAnimationRoot.fold((function(){return e.element()}),(function(t){return t(e)}))},a_=function(e){return e.dimension.property},s_=function(e,t){return e.dimension.getDimension(t)},l_=function(e,t){var n=r_(e,t);or(n,[t.shrinkingClass,t.growingClass])},u_=function(e,t){er(e.element(),t.openClass),Qi(e.element(),t.closedClass),mr(e.element(),a_(t),"0px"),Er(e.element())},c_=function(e,t){er(e.element(),t.closedClass),Qi(e.element(),t.openClass),xr(e.element(),a_(t))},d_=function(e,t,n,o){n.setCollapsed(),mr(e.element(),a_(t),s_(t,e.element())),Er(e.element()),l_(e,t),u_(e,t),t.onStartShrink(e),t.onShrunk(e)},f_=function(e,t,n,o){var i=o.getOrThunk((function(){return s_(t,e.element())}));n.setCollapsed(),mr(e.element(),a_(t),i),Er(e.element());var r=r_(e,t);er(r,t.growingClass),Qi(r,t.shrinkingClass),u_(e,t),t.onStartShrink(e)},h_=function(e,t,n){var o=s_(t,e.element());("0px"===o?d_:f_)(e,t,n,E.some(o))},g_=function(e,t,n){var o=r_(e,t),i=tr(o,t.shrinkingClass),r=s_(t,e.element());c_(e,t);var a=s_(t,e.element());(i?function(){mr(e.element(),a_(t),r),Er(e.element())}:function(){u_(e,t)})(),er(o,t.shrinkingClass),Qi(o,t.growingClass),c_(e,t),mr(e.element(),a_(t),a),n.setExpanded(),t.onStartGrow(e)},m_=function(e,t,n){var o=r_(e,t);return!0===tr(o,t.growingClass)},p_=function(e,t,n){var o=r_(e,t);return!0===tr(o,t.shrinkingClass)},v_=Object.freeze({__proto__:null,refresh:function(e,t,n){if(n.isExpanded()){xr(e.element(),a_(t));var o=s_(t,e.element());mr(e.element(),a_(t),o)}},grow:function(e,t,n){n.isExpanded()||g_(e,t,n)},shrink:function(e,t,n){n.isExpanded()&&h_(e,t,n)},immediateShrink:function(e,t,n){n.isExpanded()&&d_(e,t,n,E.none())},hasGrown:function(e,t,n){return n.isExpanded()},hasShrunk:function(e,t,n){return n.isCollapsed()},isGrowing:m_,isShrinking:p_,isTransitioning:function(e,t,n){return!0===m_(e,t)||!0===p_(e,t)},toggleGrow:function(e,t,n){(n.isExpanded()?h_:g_)(e,t,n)},disableTransitions:l_}),y_=Object.freeze({__proto__:null,exhibit:function(e,t,n){return Gi(t.expanded?{classes:[t.openClass],styles:{}}:{classes:[t.closedClass],styles:$e(t.dimension.property,"0px")})},events:function(e,t){return Ko([$o(eo(),(function(n,o){o.event().raw().propertyName===e.dimension.property&&(l_(n,e),t.isExpanded()&&xr(n.element(),e.dimension.property),(t.isExpanded()?e.onGrown:e.onShrunk)(n))}))])}}),b_=[Dt("closedClass"),Dt("openClass"),Dt("shrinkingClass"),Dt("growingClass"),Mt("getAnimationRoot"),wa("onShrunk"),wa("onStartShrink"),wa("onGrown"),wa("onStartGrow"),zt("expanded",!1),Ot("dimension",pt("property",{width:[Aa("property","width"),Aa("getDimension",(function(e){return Hr(e)+"px"}))],height:[Aa("property","height"),Aa("getDimension",(function(e){return Mr(e)+"px"}))]}))],C_=ps({fields:b_,name:"sliding",active:y_,apis:v_,state:Object.freeze({__proto__:null,init:function(e){var t=Xt(e.expanded);return qi({isExpanded:function(){return!0===t.get()},isCollapsed:function(){return!1===t.get()},setCollapsed:a(t.set,!1),setExpanded:a(t.set,!0),readState:function(){return"expanded: "+t.get()}})}})}),T_=o([Da(["closedClass","openClass","shrinkingClass","growingClass","overflowToggledClass"]),wa("onOpened"),wa("onClosed")].concat(jE())),x_=o([fc({factory:VE,schema:FE(),name:"primary"}),fc({factory:VE,schema:FE(),name:"overflow",overrides:function(e){return{toolbarBehaviours:gs([C_.config({dimension:{property:"height"},closedClass:e.markers.closedClass,openClass:e.markers.openClass,shrinkingClass:e.markers.shrinkingClass,growingClass:e.markers.growingClass,onShrunk:function(t){Dc(t,e,"overflow-button").each((function(e){hh.off(e),th.focus(e)})),e.onClosed(t)},onGrown:function(t){$f.focusIn(t),e.onOpened(t)},onStartGrow:function(t){Dc(t,e,"overflow-button").each(hh.on)}}),$f.config({mode:"acyclic",onEscape:function(t){return Dc(t,e,"overflow-button").each(th.focus),E.some(!0)}})])}}}),hc({name:"overflow-button",overrides:function(e){return{buttonBehaviours:gs([hh.config({toggleClass:e.markers.overflowToggledClass,aria:{mode:"pressed"},toggleOnExecute:!1})])}}}),hc({name:"overflow-group"})]),E_=function(e,t){Dc(e,t,"overflow").each((function(n){qE(e,t,(function(e){var t=H(e,(function(e){return kr(e)}));VE.setGroups(n,t)})),Dc(e,t,"overflow-button").each((function(e){C_.hasGrown(n)&&hh.on(e)})),C_.refresh(n)}))},__=Vc({name:"SplitSlidingToolbar",configFields:T_(),partFields:x_(),factory:function(e,t,n,o){var i="alloy.toolbar.toggle";return{uid:e.uid,dom:e.dom,components:t,behaviours:Vu(e.splitToolbarBehaviours,[gy.config({others:{overflowGroup:function(e){return BE.sketch(f(f({},o["overflow-group"]()),{items:[Xh.sketch(f(f({},o["overflow-button"]()),{action:function(t){Ro(e,i)}}))]}))}}}),Yf("toolbar-toggle-events",[Bo(i,(function(t){Dc(t,e,"overflow").each((function(n){E_(t,e),C_.toggleGrow(n)}))}))])]),apis:{setGroups:function(t,n){var o;o=H(n,t.getSystem().build),e.builtGroups.set(o),E_(t,e)},refresh:function(t){return E_(t,e)},toggle:function(t){var n,o;Dc(n=t,o=e,"overflow").each((function(e){E_(n,o),C_.toggleGrow(e)}))}},domModification:{attributes:{role:"group"}}}},apis:{setGroups:function(e,t,n){e.setGroups(t,n)},refresh:function(e,t){e.refresh(t)},toggle:function(e,t){e.toggle(t)}}}),I_=o(Ri("toolbar-height-change")),D_=function(e){var t=e.title.fold((function(){return{}}),(function(e){return{attributes:{title:e}}}));return{dom:f({tag:"div",classes:["tox-toolbar__group"]},t),components:[BE.parts().items({})],items:e.items,markers:{itemSelector:"*:not(.tox-split-button) > .tox-tbtn:not([disabled]), .tox-split-button:not([disabled]), .tox-toolbar-nav-js:not([disabled])"},tgroupBehaviours:gs([Ov.config({}),th.config({})])}},O_=function(e){return BE.sketch(D_(e))},w_=function(e,t){var n=Uo((function(t){var n=H(e.initGroups,O_);VE.setGroups(t,n)}));return gs([jm(e.providers.isReadOnly),Wm(),$f.config({mode:t,onEscape:e.onEscape,selector:".tox-toolbar__group"}),Yf("toolbar-events",[n])])},R_=function(e){var t=e.cyclicKeying?"cyclic":"acyclic";return{uid:e.uid,dom:{tag:"div",classes:["tox-toolbar-overlord"]},parts:{"overflow-group":D_({title:E.none(),items:[]}),"overflow-button":UT({name:"more",icon:E.some("more-drawer"),disabled:!1,tooltip:E.some("More..."),primary:!1,borderless:!1},E.none(),e.providers)},splitToolbarBehaviours:w_(e,t)}},S_=function(e){var t=R_(e),n=i_.parts().primary({dom:{tag:"div",classes:["tox-toolbar__primary"]}});return i_.sketch(f(f({},t),{lazySink:e.getSink,getOverflowBounds:function(){var t=e.moreDrawerData.lazyHeader().element(),n=na(t),o=oi(t),i=na(o),r=Math.max(o.dom().scrollHeight,i.height);return ea(n.x+4,i.y,n.width-8,r)},parts:f(f({},t.parts),{overflow:{dom:{tag:"div",classes:["tox-toolbar__overflow"],attributes:e.attributes}}}),components:[n],markers:{overflowToggledClass:"tox-tbtn--enabled"}}))},k_=function(e){var t=__.parts().primary({dom:{tag:"div",classes:["tox-toolbar__primary"]}}),n=__.parts().overflow({dom:{tag:"div",classes:["tox-toolbar__overflow"]}}),o=R_(e);return __.sketch(f(f({},o),{components:[t,n],markers:{openClass:"tox-toolbar__overflow--open",closedClass:"tox-toolbar__overflow--closed",growingClass:"tox-toolbar__overflow--growing",shrinkingClass:"tox-toolbar__overflow--shrinking",overflowToggledClass:"tox-tbtn--enabled"},onOpened:function(e){e.getSystem().broadcastOn([I_()],{type:"opened"})},onClosed:function(e){e.getSystem().broadcastOn([I_()],{type:"closed"})}}))},A_=function(e){var t=e.cyclicKeying?"cyclic":"acyclic";return VE.sketch({uid:e.uid,dom:{tag:"div",classes:["tox-toolbar"].concat(e.type===vg.scrolling?["tox-toolbar--scrolling"]:[])},components:[VE.parts().groups({})],toolbarBehaviours:w_(e,t)})},N_=[Ut("disabled",!1),Lt("tooltip"),Lt("icon"),Lt("text"),qt("onSetup",(function(){return t}))],M_=et([wt("type"),St("onAction")].concat(N_)),K_=function(e){return dt("toolbarbutton",M_,e)},P_=[Lt("text"),Lt("tooltip"),Lt("icon"),St("fetch"),qt("onSetup",(function(){return t}))],L_=et(g([wt("type")],P_)),B_=function(e){return dt("menubutton",L_,e)},F_=et([wt("type"),Lt("tooltip"),Lt("icon"),Lt("text"),Bt("select"),St("fetch"),qt("onSetup",(function(){return t})),$t("presets","normal",["normal","color","listpreview"]),zt("columns",1),St("onAction"),St("onItemAction")]),z_=[Ut("active",!1)].concat(N_),V_=et(z_.concat([wt("type"),St("onAction")])),H_=function(e){return dt("ToggleButton",V_,e)},W_=et([wt("type"),Ot("items",(yx=[lt([wt("name"),Nt("items",Ct)]),Ct],{extract:function(e,t,n){for(var o=[],i=0,r=yx;i<r.length;i++){var a=r[i].extract(e,t,n);if(a.stype===y.Value)return a;o.push(a)}return je(o)},toString:function(){return"oneOf("+H(yx,(function(e){return e.toString()})).join(", ")+")"}}))].concat(N_)),$_=[qt("predicate",(function(){return!1})),$t("scope","node",["node","editor"]),$t("position","selection",["node","selection","line"])],U_=N_.concat([zt("type","contextformbutton"),zt("primary",!1),St("onAction"),Gt("original",i)]),q_=z_.concat([zt("type","contextformbutton"),zt("primary",!1),St("onAction"),Gt("original",i)]),j_=N_.concat([zt("type","contextformbutton")]),G_=z_.concat([zt("type","contextformtogglebutton")]),X_=pt("type",{contextformbutton:U_,contextformtogglebutton:q_}),Y_=et([zt("type","contextform"),qt("initValue",(function(){return""})),Lt("label"),Nt("commands",X_),Kt("launch",pt("type",{contextformbutton:j_,contextformtogglebutton:G_}))].concat($_)),Z_=et([zt("type","contexttoolbar"),wt("items")].concat($_)),J_=Object.freeze({__proto__:null,getState:function(e,t,n){return n}}),Q_=Object.freeze({__proto__:null,events:function(e,t){var n=function(n,o){e.updateState.each((function(e){var i=e(n,o);t.set(i)})),e.renderComponents.each((function(e){var i=e(o,t.get()),r=H(i,n.getSystem().build);eu(n,r)}))};return Ko([Bo(ao(),(function(t,o){var i=o,r=e.channel;B(i.channels(),r)&&n(t,i.data())})),Uo((function(t,o){e.initialData.each((function(e){n(t,e)}))}))])}}),eI=Object.freeze({__proto__:null,init:function(){var e=Xt(E.none());return{readState:function(){return e.get().fold((function(){return"none"}),(function(e){return e}))},get:function(){return e.get()},set:function(t){return e.set(t)},clear:function(){return e.set(E.none())}}}}),tI=[Dt("channel"),Mt("renderComponents"),Mt("updateState"),Mt("initialData")],nI=ps({fields:tI,name:"reflecting",active:Q_,apis:J_,state:eI}),oI=o([Dt("toggleClass"),Dt("fetch"),Sa("onExecute"),zt("getHotspot",E.some),zt("getAnchorOverrides",o({})),Js(),Sa("onItemExecute"),Mt("lazySink"),Dt("dom"),wa("onOpen"),Fu("splitDropdownBehaviours",[gy,$f,th]),zt("matchWidth",!1),zt("useMinWidth",!1),zt("eventOrder",{}),Mt("role")].concat(Iy())),iI=fc({factory:Xh,schema:[Dt("dom")],name:"arrow",defaults:function(){return{buttonBehaviours:gs([th.revoke()])}},overrides:function(e){return{dom:{tag:"span",attributes:{role:"presentation"}},action:function(t){t.getSystem().getByUid(e.uid).each(ko)},buttonBehaviours:gs([hh.config({toggleOnExecute:!1,toggleClass:e.toggleClass})])}}}),rI=fc({factory:Xh,schema:[Dt("dom")],name:"button",defaults:function(){return{buttonBehaviours:gs([th.revoke()])}},overrides:function(e){return{dom:{tag:"span",attributes:{role:"presentation"}},action:function(t){t.getSystem().getByUid(e.uid).each((function(n){e.onExecute(n,t)}))}}}}),aI=o([iI,rI,gc({factory:{sketch:function(e){return{uid:e.uid,dom:{tag:"span",styles:{display:"none"},attributes:{"aria-hidden":"true"},innerHtml:e.text}}}},schema:[Dt("text")],name:"aria-descriptor"}),hc({schema:[Ia()],name:"menu",defaults:function(e){return{onExecute:function(t,n){t.getSystem().getByUid(e.uid).each((function(o){e.onItemExecute(o,t,n)}))}}}}),py()]),sI=Vc({name:"SplitDropdown",configFields:oI(),partFields:aI(),factory:function(e,n,o,i){var r=function(e){qc.getCurrent(e).each((function(e){nd.highlightFirst(e),$f.focusIn(e)}))},a=function(n){Cy(e,(function(e){return e}),n,i,r,jv.HighlightFirst).get(t)},s=function(t){var n=Oc(t,e,"button");return ko(n),E.some(!0)},l=f(f({},Ko([Uo((function(t,n){Dc(t,e,"aria-descriptor").each((function(e){var n=Ri("aria");Ci(e.element(),"id",n),Ci(t.element(),"aria-describedby",n)}))}))])),mh(E.some(a)));return{uid:e.uid,dom:e.dom,components:n,apis:{repositionMenus:function(e){hh.isOn(e)&&_y(e)}},eventOrder:f(f({},e.eventOrder),{"alloy.execute":["disabling","toggling","alloy.base.behaviour"]}),events:l,behaviours:Vu(e.splitDropdownBehaviours,[gy.config({others:{sandbox:function(t){var n=Oc(t,e,"arrow");return Ey(e,t,{onOpen:function(){hh.on(n),hh.on(t)},onClose:function(){hh.off(n),hh.off(t)}})}}}),$f.config({mode:"special",onSpace:s,onEnter:s,onDown:function(e){return a(e),E.some(!0)}}),th.config({}),hh.config({toggleOnExecute:!1,aria:{mode:"expanded"}})]),domModification:{attributes:{role:e.role.getOr("button"),"aria-haspopup":!0}}}},apis:{repositionMenus:function(e,t){return e.repositionMenus(t)}}}),lI=function(e){return{isDisabled:function(){return pm.isDisabled(e)},setDisabled:function(t){return pm.set(e,t)}}},uI=function(e){return{setActive:function(t){hh.set(e,t)},isActive:function(){return hh.isOn(e)},isDisabled:function(){return pm.isDisabled(e)},setDisabled:function(t){return pm.set(e,t)}}},cI=function(e,t){return e.map((function(e){return{"aria-label":t.translate(e),title:t.translate(e)}})).getOr({})},dI=Ri("focus-button"),fI=["checklist","ordered-list"],hI=["indent","outdent","table-insert-column-after","table-insert-column-before","unordered-list"],gI=function(e,t,n,o,i,r){var a,s=function(e){return nm.isRtl()&&B(fI,e)?e+"-rtl":e},l=nm.isRtl()&&e.exists((function(e){return B(hI,e)}));return{dom:{tag:"button",classes:["tox-tbtn"].concat(t.isSome()?["tox-tbtn--select"]:[]).concat(l?["tox-tbtn__icon-rtl"]:[]),attributes:cI(n,r)},components:Jm([e.map((function(e){return RT(s(e),r.icons)})),t.map((function(e){return kT(e,"tox-tbtn",r)}))]),eventOrder:((a={})[Hn()]=["focusing","alloy.base.behaviour","common-button-display-events"],a),buttonBehaviours:gs([jm(r.isReadOnly),Wm(),Yf("common-button-display-events",[Bo(Hn(),(function(e,t){t.event().prevent(),Ro(e,dI)}))])].concat(o.map((function(n){return nI.config({channel:n,initialData:{icon:e,text:t},renderComponents:function(e,t){return Jm([e.icon.map((function(e){return RT(s(e),r.icons)})),e.text.map((function(e){return kT(e,"tox-tbtn",r)}))])}})})).toArray()).concat(i.getOr([])))}},mI=function(e,n,o){var i,r=Xt(t),a=gI(e.icon,e.text,e.tooltip,E.none(),E.none(),o);return Xh.sketch({dom:a.dom,components:a.components,eventOrder:NT,buttonBehaviours:gs([Yf("toolbar-button-events",[(i={onAction:e.onAction,getApi:n.getApi},Go((function(e,t){Gm(i,e)((function(t){So(e,AT,{buttonApi:t}),i.onAction(t)}))}))),Xm(n,r),Ym(n,r)]),jm((function(){return e.disabled||o.isReadOnly()})),Wm()].concat(n.toolbarButtonBehaviours))})},pI=function(e,t,n){return mI(e,{toolbarButtonBehaviours:[].concat(0<n.length?[Yf("toolbarButtonWith",n)]:[]),getApi:lI,onSetup:e.onSetup},t)},vI=function(e,t,n){return Ne(mI(e,{toolbarButtonBehaviours:[Xf.config({}),hh.config({toggleClass:"tox-tbtn--enabled",aria:{mode:"pressed"},toggleOnExecute:!1})].concat(0<n.length?[Yf("toolbarToggleButtonWith",n)]:[]),getApi:uI,onSetup:e.onSetup},t))},yI=function(e,t){return Bo(AT,(function(n,o){var i,r=e.get(n),a=(i=r,{hide:function(){return Ro(i,fo())},getValue:function(){return Bu.getValue(i)}});t.onAction(a,o.event().buttonApi())}))},bI=function(e,t){var n,o,i,r,a=e.label.fold((function(){return{}}),(function(e){return{"aria-label":e}})),l=Yh($v.sketch({inputClasses:["tox-toolbar-textfield","tox-toolbar-nav-js"],data:e.initValue(),inputAttributes:a,selectOnFocus:!0,inputBehaviours:gs([$f.config({mode:"special",onEnter:function(e){return u.findPrimary(e).map((function(e){return ko(e),!0}))},onLeft:function(e,t){return t.cut(),E.none()},onRight:function(e,t){return t.cut(),E.none()}})])})),u=(n=l,i=t,r=H(o=e.commands,(function(e){return Yh(function(e,t,n){var o,i,r,a,s,l,u,c,d,g,m={backstage:{shared:{providers:n}}};return"contextformtogglebutton"===t.type?(l=e,c=m,d=h((u=t).original,["primary"]),g=ft(H_(f(f({},d),{type:"togglebutton",onAction:function(){}}))),vI(g,c.backstage.shared.providers,[yI(l,u)])):(o=e,r=m,a=h((i=t).original,["primary"]),s=ft(K_(f(f({},a),{type:"button",onAction:function(){}}))),pI(s,r.backstage.shared.providers,[yI(o,i)]))}(n,e,i))})),{asSpecs:function(){return H(r,(function(e){return e.asSpec()}))},findPrimary:function(e){return re(o,(function(t,n){return t.primary?E.from(r[n]).bind((function(t){return t.getOpt(e)})).filter(s(pm.isDisabled)):E.none()}))}});return[{title:E.none(),items:[l.asSpec()]},{title:E.none(),items:u.asSpecs()}]},CI=function(t,n){var o,i,r,a=Yr(e.window),s=ta(en(t.getContentAreaContainer())),l=_m(t)||Im(t)||Om(t),u=(o=s,i=a,{x:r=Math.max(i.x,o.x),width:Math.min(o.right-r,i.width-(r-i.x))}),c=u.x,d=u.width;if(t.inline&&!l)return ea(c,a.y,d,a.height);var f=function(e,t,n,o){var i=en(e.getContainer()),r=da(i,".tox-editor-header").getOr(i),a=ta(r),s=o&&!(a.y>=t.bottom);if(e.inline&&s)return{y:Math.max(a.bottom,n.y),bottom:n.bottom};if(e.inline&&!s)return{y:n.y,bottom:Math.min(a.y,n.bottom)};var l=ta(i);return s?{y:Math.max(a.bottom,n.y),bottom:Math.min(l.bottom,n.bottom)}:{y:Math.max(l.y,n.y),bottom:Math.min(a.y,n.bottom)}}(t,s,a,n.header.isPositionedAtTop()),h=f.y;return ea(c,h,d,f.bottom-h)},TI=function(e,t){var n=U(t,(function(t){return t.predicate(e.dom())})),o=$(n,(function(e){return"contexttoolbar"===e.type}));return{contextToolbars:o.pass,contextForms:o.fail}},xI=Ri("forward-slide"),EI=Ri("backward-slide"),_I=Ri("change-slide-event"),II="tox-pop--resizing",DI=function(e,t,n){var o,i,r,a,s,l=n.dataset;return{items:(o=t,i=n,r=function(e,t,n,r){var s=o.shared.providers.translate(e.title);if("separator"===e.type)return E.some({type:"separator",text:s});if("submenu"!==e.type)return E.some(f({type:"togglemenuitem",text:s,icon:e.icon,active:e.isSelected(r),disabled:n,onAction:i.onAction(e)},e.getStylePreview().fold((function(){return{}}),(function(e){return{meta:{style:e}}}))));var l=Z(e.getStyleItems(),(function(e){return a(e,t,r)}));return 0===t&&l.length<=0?E.none():E.some({type:"nestedmenuitem",text:s,disabled:l.length<=0,getSubmenuItems:function(){return Z(e.getStyleItems(),(function(e){return a(e,t,r)}))}})},a=function(e,t,n){var o="formatter"===e.type&&i.isInvalid(e);return 0===t?o?[]:r(e,t,!1,n).toArray():r(e,t,o,n).toArray()},{validateItems:s=function(e){var t=i.getCurrentValue(),n=i.shouldHide?0:1;return Z(e,(function(e){return a(e,n,t)}))},getFetch:function(e,t){return function(n){var o=t(),i=s(o);n(zT(i,bg.CLOSE_ON_EXECUTE,e,!1))}}}),getStyleItems:"basic"===l.type?function(){return H(l.data,(function(e){return aE(e,n.isSelectedFor,n.getPreviewFor)}))}:l.getData}},OI=function(e,n,o){var i=DI(0,n,o),r=i.items,a=i.getStyleItems;return PT({text:o.icon.isSome()?E.none():E.some(""),icon:o.icon,tooltip:E.from(o.tooltip),role:E.none(),fetch:r.getFetch(n,a),onSetup:function(n){return o.setInitialValue.each((function(e){return e(n.getComponent())})),o.nodeChangeHandler.map((function(t){var o=t(n.getComponent());return e.on("NodeChange",o),function(){e.off("NodeChange",o)}})).getOr(t)},getApi:function(e){return{getComponent:function(){return e}}},columns:1,presets:"normal",classes:o.icon.isSome()?[]:["bespoke"],dropdownBehaviours:[]},"tox-tbtn",n.shared)};(Cx=bx=bx||{})[Cx.SemiColon=0]="SemiColon",Cx[Cx.Space=1]="Space";var wI,RI,SI=function(e,t,n,o){var i,r;return{type:"basic",data:(r=e.getParam(t,n,"string"),i=o===bx.SemiColon?r.replace(/;$/,"").split(";"):r.split(" "),H(i,(function(e){var t=e,n=e,o=e.split("=");return 1<o.length&&(t=o[0],n=o[1]),{title:t,format:n}})))}},kI=[{title:"Left",icon:"align-left",format:"alignleft",command:"JustifyLeft"},{title:"Center",icon:"align-center",format:"aligncenter",command:"JustifyCenter"},{title:"Right",icon:"align-right",format:"alignright",command:"JustifyRight"},{title:"Justify",icon:"align-justify",format:"alignjustify",command:"JustifyFull"}],AI=function(e){var t=function(t){var n=G(kI,(function(t){return e.formatter.match(t.format)})).fold((function(){return"left"}),(function(e){return e.title.toLowerCase()}));So(t,KT,{icon:"align-"+n})},n=E.some((function(e){return function(){return t(e)}})),i=E.some((function(e){return t(e)})),r={type:"basic",data:kI};return{tooltip:"Align",icon:E.some("align-left"),isSelectedFor:function(t){return function(){return e.formatter.match(t)}},getCurrentValue:o(E.none()),getPreviewFor:function(e){return function(){return E.none()}},onAction:function(t){return function(){return G(kI,(function(e){return e.format===t.format})).each((function(t){return e.execCommand(t.command)}))}},setInitialValue:i,nodeChangeHandler:n,dataset:r,shouldHide:!1,isInvalid:function(t){return!e.formatter.canApply(t.format)}}},NI=["-apple-system","Segoe UI","Roboto","Helvetica Neue","sans-serif"],MI=function(e){var t=e.split(/\s*,\s*/);return H(t,(function(e){return e.replace(/^['"]+|['"]+$/g,"")}))},KI=function(e){var t=function(){var t=function(e){return e?MI(e)[0]:""},n=e.queryCommandValue("FontName"),o=r.data,i=n?n.toLowerCase():"";return{matchOpt:G(o,(function(e){var n=e.format;return n.toLowerCase()===i||t(n).toLowerCase()===t(i).toLowerCase()})).orThunk((function(){return function(e){var t;return 0===e.indexOf("-apple-system")&&(t=MI(e.toLowerCase()),J(NI,(function(e){return-1<t.indexOf(e.toLowerCase())})))}(i)?E.from({title:"System Font",format:i}):E.none()})),font:n}},n=function(e){var n=t(),o=n.font,i=n.matchOpt.fold((function(){return o}),(function(e){return e.title}));So(e,MT,{text:i})},o=E.some((function(e){return function(){return n(e)}})),i=E.some((function(e){return n(e)})),r=SI(e,"font_formats","Andale Mono=andale mono,monospace;Arial=arial,helvetica,sans-serif;Arial Black=arial black,sans-serif;Book Antiqua=book antiqua,palatino,serif;Comic Sans MS=comic sans ms,sans-serif;Courier New=courier new,courier,monospace;Georgia=georgia,palatino,serif;Helvetica=helvetica,arial,sans-serif;Impact=impact,sans-serif;Symbol=symbol;Tahoma=tahoma,arial,helvetica,sans-serif;Terminal=terminal,monaco,monospace;Times New Roman=times new roman,times,serif;Trebuchet MS=trebuchet ms,geneva,sans-serif;Verdana=verdana,geneva,sans-serif;Webdings=webdings;Wingdings=wingdings,zapf dingbats",bx.SemiColon);return{tooltip:"Fonts",icon:E.none(),isSelectedFor:function(e){return function(t){return t.exists((function(t){return t.format===e}))}},getCurrentValue:function(){return t().matchOpt},getPreviewFor:function(e){return function(){return E.some({tag:"div",styles:-1===e.indexOf("dings")?{"font-family":e}:{}})}},onAction:function(t){return function(){e.undoManager.transact((function(){e.focus(),e.execCommand("FontName",!1,t.format)}))}},setInitialValue:i,nodeChangeHandler:o,dataset:r,shouldHide:!1,isInvalid:function(){return!1}}},PI={"8pt":"1","10pt":"2","12pt":"3","14pt":"4","18pt":"5","24pt":"6","36pt":"7"},LI=function(e){var t=function(){var t=E.none(),n=s.data,o=e.queryCommandValue("FontSize");if(o)for(var i=function(e){var i=function(e,t){return/[0-9.]+px$/.test(e)?(n=72*parseInt(e,10)/96,o=Math.pow(10,t||0),Math.round(n*o)/o+"pt"):e;var n,o}(o,e),r=Oe(PI,i).getOr("");t=G(n,(function(e){return e.format===o||e.format===i||e.format===r}))},r=3;t.isNone()&&0<=r;r--)i(r);return{matchOpt:t,size:o}},n=o(o(E.none())),i=function(e){var n=t(),o=n.size,i=n.matchOpt.fold((function(){return o}),(function(e){return e.title}));So(e,MT,{text:i})},r=E.some((function(e){return function(){return i(e)}})),a=E.some((function(e){return i(e)})),s=SI(e,"fontsize_formats","8pt 10pt 12pt 14pt 18pt 24pt 36pt",bx.Space);return{tooltip:"Font sizes",icon:E.none(),isSelectedFor:function(e){return function(t){return t.exists((function(t){return t.format===e}))}},getPreviewFor:n,getCurrentValue:function(){return t().matchOpt},onAction:function(t){return function(){e.undoManager.transact((function(){e.focus(),e.execCommand("FontSize",!1,t.format)}))}},setInitialValue:a,nodeChangeHandler:r,dataset:s,shouldHide:!1,isInvalid:function(){return!1}}},BI=function(e,t,n){var o=t();return re(n,(function(t){return G(o,(function(n){return e.formatter.matchNode(t,n.format)}))})).orThunk((function(){return e.formatter.match("p")?E.some({title:"Paragraph",format:"p"}):E.none()}))},FI=function(e){var t=e.selection.getStart(!0)||e.getBody();return e.dom.getParents(t,(function(){return!0}),e.getBody())},zI=function(e,t){return function(n){var o=Xt(E.none()),i=function(){n.setActive(e.formatter.match(t));var i=e.formatter.formatChanged(t,n.setActive).unbind;o.set(E.some(i))};return e.initialized?i():e.on("init",i),function(){return o.get().each((function(e){return e()}))}}},VI=function(e){return function(t){return function(){e.undoManager.transact((function(){e.focus(),e.execCommand("mceToggleFormat",!1,t.format)}))}}},HI=function(e){var t=function(t,n){var o=BI(e,(function(){return r.data}),t).fold((function(){return"Paragraph"}),(function(e){return e.title}));So(n,MT,{text:o})},n=E.some((function(e){return function(n){return t(n.parents,e)}})),i=E.some((function(n){var o=FI(e);t(o,n)})),r=SI(e,"block_formats","Paragraph=p;Heading 1=h1;Heading 2=h2;Heading 3=h3;Heading 4=h4;Heading 5=h5;Heading 6=h6;Preformatted=pre",bx.SemiColon);return{tooltip:"Blocks",icon:E.none(),isSelectedFor:function(t){return function(){return e.formatter.match(t)}},getCurrentValue:o(E.none()),getPreviewFor:function(t){return function(){var n=e.formatter.get(t);return E.some({tag:0<n.length&&(n[0].inline||n[0].block)||"div",styles:e.dom.parseStyle(e.formatter.getCssText(t))})}},onAction:VI(e),setInitialValue:i,nodeChangeHandler:n,dataset:r,shouldHide:!1,isInvalid:function(t){return!e.formatter.canApply(t.format)}}},WI=function(e,t){var n=function(t,n){var o=function(e){var t=e.items;return void 0!==t&&0<t.length?Z(t,o):[{title:e.title,format:e.format}]},i=Z(rE(e),o),r=BI(e,(function(){return i}),t).fold((function(){return"Paragraph"}),(function(e){return e.title}));So(n,MT,{text:r})},i=E.some((function(e){return function(t){return n(t.parents,e)}})),r=E.some((function(t){var o=FI(e);n(o,t)}));return{tooltip:"Formats",icon:E.none(),isSelectedFor:function(t){return function(){return e.formatter.match(t)}},getCurrentValue:o(E.none()),getPreviewFor:function(t){return function(){var n=e.formatter.get(t);return void 0!==n?E.some({tag:0<n.length&&(n[0].inline||n[0].block)||"div",styles:e.dom.parseStyle(e.formatter.getCssText(t))}):E.none()}},onAction:VI(e),setInitialValue:r,nodeChangeHandler:i,shouldHide:e.getParam("style_formats_autohide",!1,"boolean"),isInvalid:function(t){return!e.formatter.canApply(t.format)},dataset:t}},$I=[{name:"history",items:["undo","redo"]},{name:"styles",items:["styleselect"]},{name:"formatting",items:["bold","italic"]},{name:"alignment",items:["alignleft","aligncenter","alignright","alignjustify"]},{name:"indentation",items:["outdent","indent"]},{name:"permanent pen",items:["permanentpen"]},{name:"comments",items:["addcomment"]}],UI=function(e,t){return function(n,o,i){var r=e(n).mapError((function(e){return gt(e)})).getOrDie();return t(r,o,i)}},qI={button:UI(K_,(function(e,t){return pI(e,t.backstage.shared.providers,[])})),togglebutton:UI(H_,(function(e,t){return vI(e,t.backstage.shared.providers,[])})),menubutton:UI(B_,(function(e,t){return HT(e,"tox-tbtn",t.backstage,E.none())})),splitbutton:UI((function(e){return dt("SplitButton",F_,e)}),(function(e,n){return function(e,n){var o,i,r,a,s=Ri("channel-update-split-dropdown-display"),l=function(e){return{isDisabled:function(){return pm.isDisabled(e)},setDisabled:function(t){return pm.set(e,t)},setIconFill:function(t,n){da(e.element(),'svg path[id="'+t+'"], rect[id="'+t+'"]').each((function(e){Ci(e,"fill",n)}))},setIconStroke:function(t,n){da(e.element(),'svg path[id="'+t+'"], rect[id="'+t+'"]').each((function(e){Ci(e,"stroke",n)}))},setActive:function(t){Ci(e.element(),"aria-pressed",t),da(e.element(),"span").each((function(n){e.getSystem().getByDom(n).each((function(e){return hh.set(e,t)}))}))},isActive:function(){return da(e.element(),"span").exists((function(t){return e.getSystem().getByDom(t).exists(hh.isOn)}))}}},u=Xt(t),c={getApi:l,onSetup:e.onSetup};return sI.sketch({dom:{tag:"div",classes:["tox-split-button"],attributes:f({"aria-pressed":!1},cI(e.tooltip,n.providers))},onExecute:function(t){e.onAction(l(t))},onItemExecute:function(e,t,n){},splitDropdownBehaviours:gs([qm(n.providers.isReadOnly),Wm(),Yf("split-dropdown-events",[Bo(dI,th.focus),Xm(c,u),Ym(c,u)]),Ry.config({})]),eventOrder:((o={})[bo()]=["alloy.base.behaviour","split-dropdown-events"],o),toggleClass:"tox-tbtn--enabled",lazySink:n.getSink,fetch:(i=l,r=e,a=n.providers,function(e){return ey((function(e){return r.fetch(e)})).map((function(t){return E.from(tv(Ne(Xp(Ri("menu-value"),t,(function(t){r.onItemAction(i(e),t)}),r.columns,r.presets,bg.CLOSE_ON_EXECUTE,r.select.getOr((function(){return!1})),a),{movement:Zp(r.columns,r.presets),menuBehaviours:qg("auto"!==r.columns?[]:[Uo((function(e,t){Ug(e,4,Og(r.presets)).each((function(t){$f.setGridSize(e,t.numRows,t.numColumns)}))}))])})))}))}),parts:{menu:kg(0,0,e.presets)},components:[sI.parts().button(gI(e.icon,e.text,E.none(),E.some(s),E.some([hh.config({toggleClass:"tox-tbtn--enabled",toggleOnExecute:!1})]),n.providers)),sI.parts().arrow({dom:{tag:"button",classes:["tox-tbtn","tox-split-button__chevron"],innerHtml:Jh("chevron-down",n.providers.icons)},buttonBehaviours:gs([qm(n.providers.isReadOnly),Wm()])}),sI.parts()["aria-descriptor"]({text:n.providers.translate("To open the popup, press Shift+Enter")})]})}(e,n.backstage.shared)})),grouptoolbarbutton:UI((function(e){return dt("GroupToolbarButton",W_,e)}),(function(e,t,n){var o,i,r,a,s,l=n.ui.registry.getAll().buttons,u=((o={})[Ys]=t.backstage.shared.header.isPositionedAtTop()?ma.TopToBottom:ma.BottomToTop,o);switch(Sm(n)){case vg.floating:return r=function(e){return GI(n,{buttons:l,toolbar:e,allowToolbarGroups:!1},t,E.none())},a=u,t_.sketch({lazySink:(s=t.backstage.shared).getSink,fetch:function(){return ey((function(e){e(H(r(i.items),O_))}))},markers:{toggledClass:"tox-tbtn--enabled"},parts:{button:gI((i=e).icon,i.text,i.tooltip,E.none(),E.none(),s.providers),toolbar:{dom:{tag:"div",classes:["tox-toolbar__overflow"],attributes:a}}}});default:throw new Error("Toolbar groups are only supported when using floating toolbar mode")}})),styleSelectButton:function(e,t){return n=e,i=f({type:"advanced"},(o=t.backstage).styleselect),OI(n,o,WI(n,i));var n,o,i},fontsizeSelectButton:function(e,t){return OI(n=e,t.backstage,LI(n));var n},fontSelectButton:function(e,t){return OI(n=e,t.backstage,KI(n));var n},formatButton:function(e,t){return OI(n=e,t.backstage,HI(n));var n},alignMenuButton:function(e,t){return OI(n=e,t.backstage,AI(n));var n}},jI={styleselect:qI.styleSelectButton,fontsizeselect:qI.fontsizeSelectButton,fontselect:qI.fontSelectButton,formatselect:qI.formatButton,align:qI.alignMenuButton},GI=function(t,n,o,i){var r=function(t){var n,o,i,r=t.toolbar;return!1===r?[]:void 0===r||!0===r?(o=t.buttons,i=H($I,(function(e){var t=U(e.items,(function(e){return we(o,e)||we(jI,e)}));return{name:e.name,items:t}})),U(i,(function(e){return 0<e.items.length}))):D(r)?(n=r.split("|"),H(n,(function(e){return{items:e.trim().split(" ")}}))):N(r,(function(e){return we(e,"name")&&we(e,"items")}))?r:(e.console.error("Toolbar type should be string, string[], boolean or ToolbarGroup[]"),[])}(n),a=H(r,(function(r){var a=Z(r.items,(function(r){return 0===r.trim().length?[]:function(t,n,o,i,r,a){return Oe(n,o.toLowerCase()).orThunk((function(){return a.bind((function(e){return re(e,(function(e){return Oe(n,e+o.toLowerCase())}))}))})).fold((function(){return Oe(jI,o.toLowerCase()).map((function(e){return e(t,r)})).orThunk((function(){return E.none()}))}),(function(n){return"grouptoolbarbutton"!==n.type||i?(s=r,l=t,Oe(qI,(a=n).type).fold((function(){return e.console.error("skipping button defined by",a),E.none()}),(function(e){return E.some(e(a,s,l))}))):(e.console.warn("Ignoring the '"+o+"' toolbar button. Group toolbar buttons are only supported when using floating toolbar mode and cannot be nested."),E.none());var a,s,l}))}(t,n.buttons,r,n.allowToolbarGroups,o,i).toArray()}));return{title:E.from(t.translate(r.name)),items:a}}));return U(a,(function(e){return 0<e.items.length}))},XI={valignCentre:[],alignCentre:[],alignLeft:["tox-pop--align-left"],alignRight:["tox-pop--align-right"],right:["tox-pop--right"],left:["tox-pop--left"],bottom:["tox-pop--bottom"],top:["tox-pop--top"]},YI={maxHeightFunction:Vs(),maxWidthFunction:ME()},ZI={onLtr:function(){return[ns,os,es,Ja,ts,Qa,qh,jh,$h,Hh,Uh,Wh]},onRtl:function(){return[ns,os,ts,Qa,es,Ja,qh,jh,Uh,Wh,$h,Hh]}},JI={onLtr:function(){return[os,Ja,Qa,es,ts,ns,qh,jh,$h,Hh,Uh,Wh]},onRtl:function(){return[os,Qa,Ja,ts,es,ns,qh,jh,Uh,Wh,$h,Hh]}},QI=function(e,t,n,o){var i,r,a=wn().deviceType.isTouch,s=Sr((i={sink:n,onEscape:function(){return e.focus(),E.some(!0)}},r=Xt([]),Ph.sketch({dom:{tag:"div",classes:["tox-pop"]},fireDismissalEventInstead:{event:"doNotDismissYet"},onShow:function(e){r.set([]),Ph.getContent(e).each((function(e){xr(e.element(),"visibility")})),er(e.element(),II),xr(e.element(),"width")},inlineBehaviours:gs([Yf("context-toolbar-events",[$o(eo(),(function(e,t){er(e.element(),II),xr(e.element(),"width")})),Bo(_I,(function(e,t){xr(e.element(),"width");var n=Hr(e.element());Ph.setContent(e,t.event().contents()),Qi(e.element(),II);var o=Hr(e.element());mr(e.element(),"width",n+"px"),Ph.getContent(e).each((function(n){t.event().focus().bind((function(t){return _s(t),Ds(e.element())})).orThunk((function(){return $f.focusIn(n),Is()}))})),Gh.setTimeout((function(){mr(e.element(),"width",o+"px")}),0)})),Bo(xI,(function(e,t){Ph.getContent(e).each((function(e){r.set(r.get().concat([{bar:e,focus:Is()}]))})),So(e,_I,{contents:t.event().forwardContents(),focus:E.none()})})),Bo(EI,(function(e,t){oe(r.get()).each((function(t){r.set(r.get().slice(0,r.get().length-1)),So(e,_I,{contents:kr(t.bar),focus:t.focus})}))}))]),$f.config({mode:"special",onEscape:function(e){return oe(r.get()).fold((function(){return i.onEscape()}),(function(t){return Ro(e,EI),E.some(!0)}))}})]),lazySink:function(){return le.value(i.sink)}}))),l=function(){return CI(e,o.backstage.shared)},u=function(){if(a()&&o.backstage.isContextMenuOpen())return!0;var t,n,i,r,s=(t=g.get().filter((function(e){return cr(en(e))})).map((function(e){return e.getBoundingClientRect()})).getOrThunk((function(){return e.selection.getRng().getBoundingClientRect()})),n=e.inline?jr().top():na(en(e.getBody())).y,{y:t.top+n,bottom:t.bottom+n}),u=l();return i=s.bottom,r=u.bottom,!(Math.max(s.y,u.y)<=Math.min(i,r))},c=function(){Ph.hide(s)},d=function(){h.get().each((function(e){var t=s.element();xr(t,"display"),u()?mr(t,"display","none"):Yl.positionWithinBounds(n,e,s,E.some(l()))}))},h=Xt(E.none()),g=Xt(E.none()),m=Xt(null),p=function(t){return{dom:{tag:"div",classes:["tox-pop__dialog"]},components:[t],behaviours:gs([$f.config({mode:"acyclic"}),Yf("pop-dialog-wrap-events",[Uo((function(t){e.shortcuts.add("ctrl+F9","focus statusbar",(function(){return $f.focusIn(t)}))})),qo((function(t){e.shortcuts.remove("ctrl+F9")}))])])}},v=Ke((function(){return function(e,t){var n={},o=[],i=[],r={},a={},s=function(e,s){var l=ft(dt("ContextForm",Y_,s));(n[e]=l).launch.map((function(n){r["form:"+e]=f(f({},s.launch),{type:"contextformtogglebutton"===n.type?"togglebutton":"button",onAction:function(){t(l)}})})),"editor"===l.scope?i.push(l):o.push(l),a[e]=l},l=be(e);return W(l,(function(t){var n=e[t];"contextform"===n.type?s(t,n):"contexttoolbar"===n.type&&function(e,t){dt("ContextToolbar",Z_,t).each((function(n){"editor"===t.scope?i.push(n):o.push(n),a[e]=n}))}(t,n)})),{forms:n,inNodeScope:o,inEditorScope:i,lookupTable:a,formNavigators:r}}(t,(function(e){var t=y([e]);So(s,xI,{forwardContents:p(t)})}))})),y=function(t){var n=e.ui.registry.getAll().buttons,i=v(),r=f(f({},n),i.formNavigators),a=Sm(e)===vg.scrolling?vg.scrolling:vg.default,s=Y(H(t,(function(t){return"contexttoolbar"===t.type?GI(e,{buttons:r,toolbar:t.items,allowToolbarGroups:!1},o,E.some(["form:"])):bI(t,o.backstage.shared.providers)})));return A_({type:a,uid:Ri("context-toolbar"),initGroups:s,onEscape:E.none,cyclicKeying:!0,providers:o.backstage.shared.providers})};e.on("contexttoolbar-show",(function(t){var n=v();Oe(n.lookupTable,t.toolbarKey).each((function(n){b([n],t.target===e?E.none():E.some(t)),Ph.getContent(s).each($f.focusIn)}))}));var b=function(e,t){if(T(),!a()||!o.backstage.isContextMenuOpen()){var n=y(e),i=t.map(en),r=function(e,t){var n,i,r="node"===e?o.backstage.shared.anchors.node(t):o.backstage.shared.anchors.cursor();return Ne(r,(n=e,i=a(),"line"===n?{bubble:$s(12,0,XI),layouts:{onLtr:function(){return[is]},onRtl:function(){return[rs]}},overrides:YI}:{bubble:$s(0,12,XI),layouts:i?JI:ZI,overrides:YI}))}(e[0].position,i);h.set(E.some(r)),g.set(t);var c=s.element();xr(c,"display"),Ph.showWithinBounds(s,r,p(n),(function(){return E.some(l())})),u()&&mr(c,"display","none")}},C=function(){if(e.hasFocus()){var t,n,o,i,r,a,l=v();t=l,i=en((n=e).getBody()),r=function(e){return kn(e,i)},a=en(n.selection.getNode()),(r(o=a)||An(i,o)?function(e,t,n){var o=TI(e,t);if(0<o.contextForms.length)return E.some({elem:e,toolbars:[o.contextForms[0]]});var i=TI(e,n);if(0<i.contextForms.length)return E.some({elem:e,toolbars:[i.contextForms[0]]});if(0<o.contextToolbars.length||0<i.contextToolbars.length){var r=function(e){if(e.length<=1)return e;var t=function(t){return F(e,(function(e){return e.position===t}))},n=function(t){return U(e,(function(e){return e.position===t}))},o=t("selection"),i=t("node");if(o||i){if(i&&o){var r=n("node"),a=H(n("selection"),(function(e){return f(f({},e),{position:"node"})}));return r.concat(a)}return n(o?"selection":"node")}return n("line")}(o.contextToolbars.concat(i.contextToolbars));return E.some({elem:e,toolbars:r})}return E.none()}(a,t.inNodeScope,t.inEditorScope).orThunk((function(){return function(e,t,n){return e(t)?E.none():Mn(t,(function(e){var t=TI(e,n.inNodeScope),o=t.contextForms,i=0<o.length?o:function(e){if(e.length<=1)return e;var t=function(t){return G(e,(function(e){return e.position===t}))};return t("selection").orThunk((function(){return t("node")})).orThunk((function(){return t("line")})).map((function(e){return e.position})).fold((function(){return[]}),(function(t){return U(e,(function(e){return e.position===t}))}))}(t.contextToolbars);return 0<i.length?E.some({elem:e,toolbars:i}):E.none()}),e)}(r,a,t)})):E.none()).fold((function(){h.set(E.none()),Ph.hide(s)}),(function(e){b(e.toolbars,E.some(e.elem.dom()))}))}},T=function(){var e=m.get();null!==e&&(Gh.clearTimeout(e),m.set(null))},x=function(e){T(),m.set(e)};e.on("init",(function(){e.on(KE,c),e.on("ScrollContent ScrollWindow longpress",d),e.on("click keyup focus SetContent ObjectResized ResizeEditor",(function(){x(Gh.setEditorTimeout(e,C,0))})),e.on("focusout",(function(t){Gh.setEditorTimeout(e,(function(){Ds(n.element()).isNone()&&Ds(s.element()).isNone()&&(h.set(E.none()),Ph.hide(s))}),0)})),e.on("SwitchMode",(function(){e.mode.isReadOnly()&&(h.set(E.none()),Ph.hide(s))})),e.on("NodeChange",(function(t){Ds(s.element()).fold((function(){x(Gh.setEditorTimeout(e,C,0))}),(function(e){}))}))}))},eD=Mc,tD=vc,nD=o([zt("shell",!1),Dt("makeItem"),zt("setupItem",t),Hu("listBehaviours",[Xf])]),oD=gc({name:"items",overrides:function(){return{behaviours:gs([Xf.config({})])}}}),iD=o([oD]),rD=Vc({name:o("CustomList")(),configFields:nD(),partFields:iD(),factory:function(t,n,o,i){var r=t.shell?{behaviours:[Xf.config({})],components:[]}:{behaviours:[],components:n};return{uid:t.uid,dom:t.dom,components:r.components,behaviours:Vu(t.listBehaviours,r.behaviours),apis:{setItems:function(n,o){(function(e){return t.shell?E.some(e):Dc(e,t,"items")})(n).fold((function(){throw e.console.error("Custom List was defined to not be a shell, but no item container was specified in components"),new Error("Custom List was defined to not be a shell, but no item container was specified in components")}),(function(e){var i=Xf.contents(e),r=o.length,a=r-i.length,s=0<a?z(a,(function(){return t.makeItem()})):[],l=i.slice(r);W(l,(function(t){return Xf.remove(e,t)})),W(s,(function(t){return Xf.append(e,t)}));var u=Xf.contents(e);W(u,(function(e,i){t.setupItem(n,e,o[i],i)}))}))}}}},apis:{setItems:function(e,t,n){e.setItems(t,n)}}}),aD=function(e){return(Cr(e,"position").is("fixed")?E.none():ai(e)).orThunk((function(){var t=Jt("span");return ri(e).bind((function(e){fi(e,t);var n=ai(t);return mi(t),n}))}))},sD=function(e){return aD(e).map(Fr).getOrThunk((function(){return Lr(0,0)}))},lD=Se([{static:[]},{absolute:["positionCss"]},{fixed:["positionCss"]}]),uD=function(e,t){var n=e.element();Qi(n,t.transitionClass),er(n,t.fadeOutClass),Qi(n,t.fadeInClass),t.onShow(e)},cD=function(e,t){var n=e.element();Qi(n,t.transitionClass),er(n,t.fadeInClass),Qi(n,t.fadeOutClass),t.onHide(e)},dD=function(e,t,n){return J(e,(function(e){switch(e){case"bottom":return t.bottom<=n.bottom;case"top":return t.y>=n.y}}))},fD=function(e,t){return t.getInitialPosition().map((function(t){return ea(t.bounds.x,t.bounds.y,Hr(e),Mr(e))}))},hD=function(e,t,n){return n.getInitialPosition().bind((function(o){switch(n.setInitialPosition(E.none()),o.position){case"static":return E.some(lD.static());case"absolute":var i=aD(e).map(ta).getOrThunk((function(){return ta(dr())}));return E.some(lD.absolute(ws("absolute",Oe(o.style,"left").map((function(e){return t.x-i.x})),Oe(o.style,"top").map((function(e){return t.y-i.y})),Oe(o.style,"right").map((function(e){return i.right-t.right})),Oe(o.style,"bottom").map((function(e){return i.bottom-t.bottom})))));default:return E.none()}}))},gD=function(e,t){W(["left","right","top","bottom","position"],(function(t){return xr(e.element(),t)})),t.onUndocked(e)},mD=function(e,t,n){Rs(e.element(),n),("fixed"===n.position()?t.onDocked:t.onUndocked)(e)},pD=function(e,t,n,o,i){void 0===i&&(i=!1),t.contextual.each((function(t){t.lazyContext(e).each((function(r){var a,s,l=(a=r).y<(s=o).bottom&&a.bottom>s.y;l!==n.isVisible()&&(n.setVisible(l),i&&!l?(nr(e.element(),[t.fadeOutClass]),t.onHide(e)):(l?uD:cD)(e,t))}))}))},vD=function(e,t,n){var o,i,r,a,s;e.getSystem().isConnected()&&(r=n,a=(i=t).lazyViewport(o=e),(s=r.isDocked())&&pD(o,i,r,a),function(e,t,n){var o,i,r,a=e.element();return Cr(a,"position").is("fixed")?(i=t,fD(o=a,r=n).filter((function(e){return dD(r.getModes(),e,i)})).bind((function(e){return hD(o,e,r)}))):function(e,t,n){var o=ta(e);if(dD(n.getModes(),o,t))return E.none();!function(e,t,n){n.setInitialPosition(E.some({style:function(e){var t={},n=e.dom();if(ir(n))for(var o=0;o<n.style.length;o++){var i=n.style.item(o);t[i]=n.style[i]}return t}(e),position:yr(e,"position")||"static",bounds:t}))}(e,o,n);var i=oa(),r=t.y-i.y,a=i.bottom-t.bottom,s=o.y<=t.y;return E.some(lD.fixed(ws("fixed",E.some(o.x-i.x),s?E.some(r):E.none(),E.none(),s?E.none():E.some(a))))}(a,t,n)}(o,a,r).each((function(e){r.setDocked(!s),e.fold((function(){return gD(o,i)}),(function(e){return mD(o,i,e)}),(function(e){pD(o,i,r,a,!0),mD(o,i,e)}))})))},yD=function(e,n,o){o.isDocked()&&function(e,n,o){var i,r,a=e.element();o.setDocked(!1),i=o,r=e.element(),fD(r,i).bind((function(e){return hD(r,e,i)})).each((function(o){o.fold((function(){return gD(e,n)}),(function(t){return mD(e,n,t)}),t)})),o.setVisible(!0),n.contextual.each((function(t){or(a,[t.fadeInClass,t.fadeOutClass,t.transitionClass]),t.onShow(e)})),vD(e,n,o)}(e,n,o)},bD=Object.freeze({__proto__:null,refresh:vD,reset:yD,isDocked:function(e,t,n){return n.isDocked()},getModes:function(e,t,n){return n.getModes()},setModes:function(e,t,n,o){return n.setModes(o)}}),CD=Object.freeze({__proto__:null,events:function(e,t){return Ko([$o(eo(),(function(n,o){e.contextual.each((function(e){tr(n.element(),e.transitionClass)&&(or(n.element(),[e.transitionClass,e.fadeInClass]),(t.isVisible()?e.onShown:e.onHidden)(n)),o.stop()}))})),Bo(vo(),(function(n,o){vD(n,e,t)})),Bo(yo(),(function(n,o){yD(n,e,t)}))])}}),TD=[Ft("contextual",[wt("fadeInClass"),wt("fadeOutClass"),wt("transitionClass"),St("lazyContext"),wa("onShow"),wa("onShown"),wa("onHide"),wa("onHidden")]),qt("lazyViewport",oa),Vt("modes",["top","bottom"],tt(Ct)),wa("onDocked"),wa("onUndocked")],xD=ps({fields:TD,name:"docking",active:CD,apis:bD,state:Object.freeze({__proto__:null,init:function(e){var t=Xt(!1),n=Xt(!0),o=Xt(E.none()),i=Xt(e.modes);return qi({isDocked:t.get,setDocked:t.set,getInitialPosition:o.get,setInitialPosition:o.set,isVisible:n.get,setVisible:n.set,getModes:i.get,setModes:i.set,readState:function(){return"docked:  "+t.get()+", visible: "+n.get()+", modes: "+i.get().join(",")}})}})}),ED={fadeInClass:"tox-editor-dock-fadein",fadeOutClass:"tox-editor-dock-fadeout",transitionClass:"tox-editor-dock-transition"},_D="tox-tinymce--toolbar-sticky-on",ID="tox-tinymce--toolbar-sticky-off",DD=function(e){var t=e.element();ri(t).each((function(n){var o,i="padding-"+xD.getModes(e)[0];if(xD.isDocked(e)){var r=Hr(n);mr(t,"width",r+"px"),mr(n,i,Kr(o=t)+(parseInt(yr(o,"margin-top"),10)||0)+(parseInt(yr(o,"margin-bottom"),10)||0)+"px")}else xr(t,"width"),xr(n,i)}))},OD=function(e,t){t?(er(e,ED.fadeOutClass),nr(e,[ED.transitionClass,ED.fadeInClass])):(er(e,ED.fadeInClass),nr(e,[ED.fadeOutClass,ED.transitionClass]))},wD=function(e,t){var n=en(e.getContainer());t?(Qi(n,_D),er(n,ID)):(Qi(n,ID),er(n,_D))},RD=function(e,t){var n,o=Xt(E.none()),i=t.getSink,r=function(e){i().each((function(t){return e(t.element())}))},a=function(t){e.inline||DD(t),wD(e,xD.isDocked(t)),t.getSystem().broadcastOn([Cu()],{}),i().each((function(e){return e.getSystem().broadcastOn([Cu()],{})}))},s=e.inline?[]:[xs.config({channels:((n={})[I_()]={onReceive:DD},n)})];return g([th.config({}),xD.config({contextual:f({lazyContext:function(t){var n=Kr(t.element()),o=e.inline?e.getContentAreaContainer():e.getContainer(),i=ta(en(o)),r=i.height-n,a=i.y+(B(xD.getModes(t),"top")?0:n);return E.some(ea(i.x,a,i.width,r))},onShow:function(){r((function(e){return OD(e,!0)}))},onShown:function(e){r((function(e){return or(e,[ED.transitionClass,ED.fadeInClass])})),o.get().each((function(t){var n,i,r;n=e.element(),r=ti(i=t),Is(r).filter((function(e){return!kn(i,e)})).filter((function(e){return kn(e,en(r.dom().body))||An(n,e)})).each((function(){return _s(i)})),o.set(E.none())}))},onHide:function(e){var t,n;o.set((t=e.element(),n=i,Ds(t).orThunk((function(){return n().toOption().bind((function(e){return Ds(e.element())}))})))),r((function(e){return OD(e,!1)}))},onHidden:function(){r((function(e){return or(e,[ED.transitionClass])}))}},ED),modes:[t.header.getDockingMode()],onDocked:a,onUndocked:a})],s)},SD=Object.freeze({__proto__:null,setup:function(e,t,n){e.inline||(t.header.isPositionedAtTop()||e.on("ResizeEditor",(function(){n().each(xD.reset)})),e.on("ResizeWindow ResizeEditor",(function(){n().each(DD)})),e.on("SkinLoaded",(function(){n().each((function(e){xD.isDocked(e)?xD.reset(e):xD.refresh(e)}))})),e.on("FullscreenStateChanged",(function(){n().each(xD.reset)}))),e.on("AfterScrollIntoView",(function(e){n().each((function(t){xD.refresh(t);var n=t.element();Ld(n)&&function(e,t){var n=ti(t),o=n.dom().defaultView.innerHeight,i=jr(n),r=en(e.elm),a=na(r),s=Mr(r),l=a.y,u=l+s,c=Fr(t),d=Mr(t),f=c.top(),h=f+d,g=Math.abs(f-i.top())<2,m=Math.abs(h-(i.top()+o))<2;if(g&&l<h)Gr(i.left(),l-d,n);else if(m&&f<u){var p=l-o+s+d;Gr(i.left(),p,n)}}(e,n)}))})),e.on("PostRender",(function(){wD(e,!1)}))},isDocked:function(e){return e().map(xD.isDocked).getOr(!1)},getBehaviours:RD}),kD=t,AD=u,ND=o([]),MD=Object.freeze({__proto__:null,setup:kD,isDocked:AD,getBehaviours:ND}),KD=zc({factory:function(e,t){var n={focus:$f.focusIn,setMenus:function(e,n){var o=H(n,(function(e){var n=B_({type:"menubutton",text:e.text,fetch:function(t){t(e.getItems())}}).mapError((function(e){return gt(e)})).getOrDie();return HT(n,"tox-mbtn",t.backstage,E.some("menuitem"))}));Xf.set(e,o)}};return{uid:e.uid,dom:e.dom,components:[],behaviours:gs([Xf.config({}),Yf("menubar-events",[Uo((function(t){e.onSetup(t)})),Bo(qn(),(function(e,t){da(e.element(),".tox-mbtn--active").each((function(n){fa(t.event().target(),".tox-mbtn").each((function(t){kn(n,t)||e.getSystem().getByDom(n).each((function(n){e.getSystem().getByDom(t).each((function(e){wy.expand(e),wy.close(n),th.focus(e)}))}))}))}))})),Bo(Eo(),(function(e,t){t.event().prevFocus().bind((function(t){return e.getSystem().getByDom(t).toOption()})).each((function(n){t.event().newFocus().bind((function(t){return e.getSystem().getByDom(t).toOption()})).each((function(e){wy.isOpen(n)&&(wy.expand(e),wy.close(n))}))}))}))]),$f.config({mode:"flow",selector:".tox-mbtn",onEscape:function(t){return e.onEscape(t),E.some(!0)}}),Ov.config({})]),apis:n,domModification:{attributes:{role:"menubar"}}}},name:"silver.Menubar",configFields:[Dt("dom"),Dt("uid"),Dt("onEscape"),Dt("backstage"),zt("onSetup",t)],apis:{focus:function(e,t){e.focus(t)},setMenus:function(e,t,n){e.setMenus(t,n)}}}),PD="container",LD=[Fu("slotBehaviours",[])],BD=function(e){return"<alloy.field."+e+">"},FD=function(e,t){var n,o=function(t){return Sc(e)},i=function(t,n){return function(o,i){return Dc(o,e,i).map((function(e){return t(e,i)})).getOr(n)}},r=function(e,t){return"true"!==Ti(e.element(),"aria-hidden")},a=i(r,!1),s=i((function(e,t){if(r(e)){var n=e.element();mr(n,"display","none"),Ci(n,"aria-hidden","true"),So(e,_o(),{name:t,visible:!1})}})),l=i((function(e,t){if(!r(e)){var n=e.element();xr(n,"display"),_i(n,"aria-hidden"),So(e,_o(),{name:t,visible:!0})}})),u={getSlotNames:o,getSlot:function(t,n){return Dc(t,e,n)},isShowing:a,hideSlot:n=s,hideAllSlots:function(e){return function(e,t){W(t,(function(t){return n(e,t)}))}(e,o())},showSlot:l};return{uid:e.uid,dom:e.dom,components:t,behaviours:zu(e.slotBehaviours),apis:u}},zD=xe({getSlotNames:function(e,t){return e.getSlotNames(t)},getSlot:function(e,t,n){return e.getSlot(t,n)},isShowing:function(e,t,n){return e.isShowing(t,n)},hideSlot:function(e,t,n){return e.hideSlot(t,n)},hideAllSlots:function(e,t){return e.hideAllSlots(t)},showSlot:function(e,t,n){return e.showSlot(t,n)}},(function(e){return $i(e)})),VD=f(f({},zD),{sketch:function(e){var t,n=(t=[],{slot:function(e,n){return t.push(e),Tc(PD,BD(e),n)},record:function(){return t}}),o=e(n),i=n.record(),r=H(i,(function(e){return fc({name:e,pname:BD(e)})}));return Pc(PD,LD,r,FD,o)}}),HD=et([Lt("icon"),Lt("tooltip"),qt("onShow",t),qt("onHide",t),qt("onSetup",(function(){return t}))]),WD=function(e){return{element:function(){return e.element().dom()}}},$D=function(e,n){var o=H(be(n),(function(e){var t=ft(dt("sidebar",HD,n[e]));return{name:e,getApi:WD,onSetup:t.onSetup,onShow:t.onShow,onHide:t.onHide}}));return H(o,(function(n){var i=Xt(t);return e.slot(n.name,{dom:{tag:"div",classes:["tox-sidebar__pane"]},behaviours:qg([Xm(n,i),Ym(n,i),Bo(_o(),(function(e,t){var n=t.event();G(o,(function(e){return e.name===n.name()})).each((function(t){(n.visible()?t.onShow:t.onHide)(t.getApi(e))}))}))])})}))},UD=function(e){return qc.getCurrent(e).bind((function(e){return C_.isGrowing(e)||C_.hasGrown(e)?qc.getCurrent(e).bind((function(e){return G(VD.getSlotNames(e),(function(t){return VD.isShowing(e,t)}))})):E.none()}))},qD=Ri("FixSizeEvent"),jD=Ri("AutoSizeEvent"),GD=function(e){var t,n,o=Zt(e),i=si(o),r=(n=void 0!==(t=o).dom().attributes?t.dom().attributes:[],j(n,(function(e,t){var n;return"class"===t.name?e:f(f({},e),((n={})[t.name]=t.value,n))}),{})),a=Array.prototype.slice.call(o.dom().classList,0),s=0===i.length?{}:{innerHtml:vi(o)};return f({tag:Xo(o),classes:a,attributes:r},s)},XD=tD.optional({factory:KD,name:"menubar",schema:[Dt("backstage")]}),YD=tD.optional({factory:{sketch:function(e){return rD.sketch({uid:e.uid,dom:e.dom,listBehaviours:gs([$f.config({mode:"acyclic",selector:".tox-toolbar"})]),makeItem:function(){return A_({type:e.type,uid:Ri("multiple-toolbar-item"),cyclicKeying:!1,initGroups:[],providers:e.providers,onEscape:function(){return E.none()}})},setupItem:function(e,t,n,o){VE.setGroups(t,n)},shell:!0})}},name:"multiple-toolbar",schema:[Dt("dom"),Dt("onEscape")]}),ZD=tD.optional({factory:{sketch:function(e){var t;return((t=e).type===vg.sliding?k_:t.type===vg.floating?S_:A_)({type:e.type,uid:e.uid,onEscape:function(){return e.onEscape(),E.some(!0)},cyclicKeying:!1,initGroups:[],getSink:e.getSink,providers:e.providers,moreDrawerData:{lazyToolbar:e.lazyToolbar,lazyMoreButton:e.lazyMoreButton,lazyHeader:e.lazyHeader},attributes:e.attributes})}},name:"toolbar",schema:[Dt("dom"),Dt("onEscape"),Dt("getSink")]}),JD=tD.optional({factory:{sketch:function(e){return{uid:e.uid,dom:e.dom,components:e.components,behaviours:gs((e.sticky?RD:ND)(e.editor,e.sharedBackstage))}}},name:"header",schema:[Dt("dom")]}),QD=tD.optional({name:"socket",schema:[Dt("dom")]}),eO=tD.optional({factory:{sketch:function(e){return{uid:e.uid,dom:{tag:"div",classes:["tox-sidebar"],attributes:{role:"complementary"}},components:[{dom:{tag:"div",classes:["tox-sidebar__slider"]},components:[],behaviours:gs([Ov.config({}),th.config({}),C_.config({dimension:{property:"width"},closedClass:"tox-sidebar--sliding-closed",openClass:"tox-sidebar--sliding-open",shrinkingClass:"tox-sidebar--sliding-shrinking",growingClass:"tox-sidebar--sliding-growing",onShrunk:function(e){qc.getCurrent(e).each(VD.hideAllSlots),Ro(e,jD)},onGrown:function(e){Ro(e,jD)},onStartGrow:function(e){So(e,qD,{width:Cr(e.element(),"width").getOr("")})},onStartShrink:function(e){So(e,qD,{width:Hr(e.element())+"px"})}}),Xf.config({}),qc.config({find:function(e){var t=Xf.contents(e);return ne(t)}})])}],behaviours:gs([OC(0),Yf("sidebar-sliding-events",[Bo(qD,(function(e,t){mr(e.element(),"width",t.event().width())})),Bo(jD,(function(e,t){xr(e.element(),"width")}))])])}}},name:"sidebar",schema:[Dt("dom")]}),tO=tD.optional({factory:{sketch:function(e){return{uid:e.uid,dom:{tag:"div",attributes:{"aria-hidden":"true"},classes:["tox-throbber"],styles:{display:"none"}},behaviours:gs([Xf.config({})]),components:[]}}},name:"throbber",schema:[Dt("dom")]}),nO=Vc({name:"OuterContainer",factory:function(e,t,n){var o={getSocket:function(t){return eD.getPart(t,e,"socket")},setSidebar:function(t,n){eD.getPart(t,e,"sidebar").each((function(e){return function(e,t){qc.getCurrent(e).each((function(e){return Xf.set(e,[(n=t,VD.sketch((function(e){return{dom:{tag:"div",classes:["tox-sidebar__pane-container"]},components:$D(e,n),slotBehaviours:qg([Uo((function(e){return VD.hideAllSlots(e)}))])}})))]);var n}))}(e,n)}))},toggleSidebar:function(t,n){eD.getPart(t,e,"sidebar").each((function(e){return t=n,void qc.getCurrent(e).each((function(e){qc.getCurrent(e).each((function(n){C_.hasGrown(e)?VD.isShowing(n,t)?C_.shrink(e):(VD.hideAllSlots(n),VD.showSlot(n,t)):(VD.hideAllSlots(n),VD.showSlot(n,t),C_.grow(e))}))}));var t}))},whichSidebar:function(t){return eD.getPart(t,e,"sidebar").bind(UD).getOrNull()},getHeader:function(t){return eD.getPart(t,e,"header")},getToolbar:function(t){return eD.getPart(t,e,"toolbar")},setToolbar:function(t,n){eD.getPart(t,e,"toolbar").each((function(e){e.getApis().setGroups(e,n)}))},setToolbars:function(t,n){eD.getPart(t,e,"multiple-toolbar").each((function(e){rD.setItems(e,n)}))},refreshToolbar:function(t){eD.getPart(t,e,"toolbar").each((function(e){return e.getApis().refresh(e)}))},getThrobber:function(t){return eD.getPart(t,e,"throbber")},focusToolbar:function(t){eD.getPart(t,e,"toolbar").orThunk((function(){return eD.getPart(t,e,"multiple-toolbar")})).each((function(e){$f.focusIn(e)}))},setMenubar:function(t,n){eD.getPart(t,e,"menubar").each((function(e){KD.setMenus(e,n)}))},focusMenubar:function(t){eD.getPart(t,e,"menubar").each((function(e){KD.focus(e)}))}};return{uid:e.uid,dom:e.dom,components:t,apis:o,behaviours:e.behaviours}},configFields:[Dt("dom"),Dt("behaviours")],partFields:[JD,XD,ZD,YD,QD,eO,tO],apis:{getSocket:function(e,t){return e.getSocket(t)},setSidebar:function(e,t,n){e.setSidebar(t,n)},toggleSidebar:function(e,t,n){e.toggleSidebar(t,n)},whichSidebar:function(e,t){return e.whichSidebar(t)},getHeader:function(e,t){return e.getHeader(t)},getToolbar:function(e,t){return e.getToolbar(t)},setToolbar:function(e,t,n){var o=H(n,(function(e){return O_(e)}));e.setToolbar(t,o)},setToolbars:function(e,t,n){var o=H(n,(function(e){return H(e,O_)}));e.setToolbars(t,o)},refreshToolbar:function(e,t){return e.refreshToolbar(t)},getThrobber:function(e,t){return e.getThrobber(t)},setMenubar:function(e,t,n){e.setMenubar(t,n)},focusMenubar:function(e,t){e.focusMenubar(t)},focusToolbar:function(e,t){e.focusToolbar(t)}}}),oO={file:{title:"File",items:"newdocument restoredraft | preview | print | deleteallconversations"},edit:{title:"Edit",items:"undo redo | cut copy paste pastetext | selectall | searchreplace"},view:{title:"View",items:"code | visualaid visualchars visualblocks | spellchecker | preview fullscreen | showcomments"},insert:{title:"Insert",items:"image link media addcomment pageembed template codesample inserttable | charmap emoticons hr | pagebreak nonbreaking anchor toc | insertdatetime"},format:{title:"Format",items:"bold italic underline strikethrough superscript subscript codeformat | formats blockformats fontformats fontsizes align | forecolor backcolor | removeformat"},tools:{title:"Tools",items:"spellchecker spellcheckerlanguage | a11ycheck code wordcount"},table:{title:"Table",items:"inserttable | cell row column | advtablesort | tableprops deletetable"},help:{title:"Help",items:"help"}},iO=function(e){return"string"==typeof e?e.split(" "):e},rO=function(e,t){var n=f(f({},oO),t.menus),o=0<be(t.menus).length,i=iO(void 0===t.menubar||!0===t.menubar?"file edit view insert format tools table help":!1===t.menubar?"":t.menubar),r=U(i,(function(e){return o&&t.menus.hasOwnProperty(e)&&t.menus[e].hasOwnProperty("items")||oO.hasOwnProperty(e)})),a=H(r,(function(o){var i,r,a,s=n[o];return i={title:s.title,items:iO(s.items)},r=t,a=e.getParam("removed_menuitems","").split(/[ ,]/),{text:i.title,getItems:function(){return Z(i.items,(function(e){var t=e.toLowerCase();return 0===t.trim().length||F(a,(function(e){return e===t}))?[]:"separator"===t||"|"===t?[{type:"separator"}]:r.menuItems[t]?[r.menuItems[t]]:[]}))}}}));return U(a,(function(e){return 0<e.getItems().length&&F(e.getItems(),(function(e){return"separator"!==e.type}))}))},aO=function(e){var t=function(){e._skinLoaded=!0,e.fire("SkinLoaded")};return function(){e.initialized?t():e.on("init",t)}},sO=function(e,t){var n,o=function(e){var t=e.getParam("skin"),n=e.getParam("skin_url");if(!1!==t){var o=t||"oxide";n=n?e.documentBaseURI.toAbsolute(n):vm.baseURL+"/skins/ui/"+o}return n}(t);o&&(n=o+"/skin.min.css",t.contentCSS.push(o+(e?"/content.inline":"/content")+".min.css")),0==(!1===t.getParam("skin"))&&n?t.ui.styleSheetLoader.load(n,aO(t),function(e,t){return function(){return e.fire("SkinLoadError",{message:"Skin could not be loaded"})}}(t)):aO(t)()},lO=a(sO,!1),uO=a(sO,!0),cO=function(e,t,n,o){var i=t.outerContainer,r=n.toolbar,a=n.buttons;if(N(r,D)){var s=r.map((function(t){return GI(e,{toolbar:t,buttons:a,allowToolbarGroups:n.allowToolbarGroups},{backstage:o},E.none())}));nO.setToolbars(i,s)}else nO.setToolbar(i,GI(e,n,{backstage:o},E.none()))},dO=tm.DOM,fO=wn(),hO=fO.os.isiOS()&&fO.os.version.major<=12,gO=Object.freeze({__proto__:null,render:function(t,n,o,i,r){var a=Xt(0);lO(t);var s,l=en(r.targetNode),u=(s=lr(l),rr(s)?s:en(ni(s).dom().body));su(l,n.mothership,ci),au(u,n.uiMothership),t.on("PostRender",(function(){cO(t,n,o,i),a.set(t.getWin().innerWidth),nO.setMenubar(n.outerContainer,rO(t,o)),nO.setSidebar(n.outerContainer,o.sidebar),function(e,t){var n=e.getWin(),o=e.getDoc().documentElement,i=Xt(Lr(n.innerWidth,n.innerHeight)),r=Xt(Lr(o.offsetWidth,o.offsetHeight)),a=function(){var t=i.get();t.left()===n.innerWidth&&t.top()===n.innerHeight||(i.set(Lr(n.innerWidth,n.innerHeight)),Ap(e))},s=function(){var t=e.getDoc().documentElement,n=r.get();n.left()===t.offsetWidth&&n.top()===t.offsetHeight||(r.set(Lr(t.offsetWidth,t.offsetHeight)),Ap(e))},l=function(t){return e.fire("ScrollContent",t)};dO.bind(n,"resize",a),dO.bind(n,"scroll",l);var u=iv(en(e.getBody()),"load",s),c=t.uiMothership.element();e.on("hide",(function(){mr(c,"display","none")})),e.on("show",(function(){xr(c,"display")})),e.on("NodeChange",s),e.on("remove",(function(){u.unbind(),dO.unbind(n,"resize",a),dO.unbind(n,"scroll",l)}))}(t,n)}));var c,d,f=nO.getSocket(n.outerContainer).getOrDie("Could not find expected socket element");if(hO){pr(f.element(),{overflow:"scroll","-webkit-overflow-scrolling":"touch"});var h=(c=function(){t.fire("ScrollContent")},d=null,{cancel:function(){null!==d&&(e.clearTimeout(d),d=null)},throttle:function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];null===d&&(d=e.setTimeout((function(){c.apply(null,t),d=null}),20))}});ov(f.element(),"scroll",h.throttle)}Hm(t,n),t.addCommand("ToggleSidebar",(function(e,o){nO.toggleSidebar(n.outerContainer,o),t.fire("ToggleSidebar")})),t.addQueryValueHandler("ToggleSidebar",(function(){return nO.whichSidebar(n.outerContainer)}));var g=Sm(t);return g!==vg.sliding&&g!==vg.floating||t.on("ResizeWindow ResizeEditor ResizeContent",(function(){var e=t.getWin().innerWidth;e!==a.get()&&(nO.refreshToolbar(n.outerContainer),a.set(e))})),{iframeContainer:f.element().dom(),editorContainer:n.outerContainer.element().dom()}}}),mO=function(e){return/^[0-9\.]+(|px)$/i.test(""+e)?E.some(parseInt(""+e,10)):E.none()},pO=function(e){return A(e)?e+"px":e},vO=function(e,t,n){var o=t.filter((function(t){return e<t})),i=n.filter((function(t){return t<e}));return o.or(i).getOr(e)},yO=function(e){var t=bm(e),n=Cm(e),o=xm(e);return mO(t).map((function(e){return vO(e,n,o)}))},bO=function(e,t){var n=ta(e);return{pos:t?n.y:n.bottom,bounds:n}},CO=Object.freeze({__proto__:null,render:function(e,t,n,o,i){var r=t.mothership,a=t.uiMothership,s=t.outerContainer,l=Xt(null),u=en(i.targetNode),c=function(e,t,n,o,i){var r=n.uiMothership,a=n.outerContainer,s=tm.DOM,l=Pm(e),u=Bm(e),c=xm(e).or(yO(e)),d=o.shared.header,f=d.isPositionedAtTop,h=Sm(e),g=h===vg.sliding||h===vg.floating,m=Xt(!1),p=function(){return m.get()&&!e.removed},v=function(e){return g?e.fold((function(){return 0}),(function(e){return 1<e.components().length?Mr(e.components()[1].element()):0})):0},y=function(){r.broadcastOn([Cu()],{})},b=function(e){if(void 0===e&&(e=!1),p()){var n,o,r,s,d;if(l||(n=c.getOrThunk((function(){var e=mO(yr(dr(),"margin-left")).getOr(0);return Hr(dr())-Fr(t).left()+e})),mr(i.get().element(),"max-width",n+"px")),g&&nO.refreshToolbar(a),l||(o=nO.getToolbar(a),r=v(o),s=ta(t),d=f()?Math.max(s.y-Mr(i.get().element())+r,0):s.bottom,pr(a.element(),{position:"absolute",top:Math.round(d)+"px",left:Math.round(s.x)+"px"})),u){var h=i.get();e?xD.reset(h):xD.refresh(h)}y()}},C=function(n){if(void 0===n&&(n=!0),!l&&u&&p()){var o=d.getDockingMode(),r=function(n){switch(Nm(e)){case wm.auto:var o=nO.getToolbar(a),i=v(o),r=Mr(n.element())-i,s=ta(t);if(s.y>r)return"top";var l=oi(t),u=Math.max(l.dom().scrollHeight,Mr(l));return s.bottom<u-r||oa().bottom<s.bottom-r?"bottom":"top";case wm.bottom:return"bottom";case wm.top:default:return"top"}}(i.get());r!==o&&(function(e){var t=i.get();xD.setModes(t,[e]),d.setDockingMode(e);var n=f()?ma.TopToBottom:ma.BottomToTop;Ci(t.element(),Ys,n)}(r),n&&b(!0))}};return{isVisible:p,isPositionedAtTop:f,show:function(){m.set(!0),mr(a.element(),"display","flex"),s.addClass(e.getBody(),"mce-edit-focus"),xr(r.element(),"display"),C(!1),b()},hide:function(){m.set(!1),n.outerContainer&&(mr(a.element(),"display","none"),s.removeClass(e.getBody(),"mce-edit-focus")),mr(r.element(),"display","none")},update:b,updateMode:C,repositionPopups:y}}(e,u,t,o,l);uO(e);var d=function(){if(l.get())c.show();else{l.set(nO.getHeader(s).getOrDie());var i=Km(e).getOr(dr());au(i,r),au(i,a),cO(e,t,n,o),nO.setMenubar(s,rO(e,n)),c.show(),function(e,t,n){var o=Xt(bO(t,n.isPositionedAtTop())),i=function(i){var r=bO(t,n.isPositionedAtTop()),a=r.pos,s=r.bounds,l=o.get(),u=l.pos,c=l.bounds,d=s.height!==c.height||s.width!==c.width;o.set({pos:a,bounds:s}),d&&Ap(e,i),n.isVisible()&&(u!==a?n.update(!0):d&&(n.updateMode(),n.repositionPopups()))};e.on("activate",n.show),e.on("deactivate",n.hide),e.on("SkinLoaded ResizeWindow",(function(){return n.update(!0)})),e.on("NodeChange keydown",(function(e){Gh.requestAnimationFrame((function(){return i(e)}))})),e.on("ScrollWindow",(function(){return n.updateMode()}));var r=function(){return e=function(e){e.unbind()},t=Xt(E.none()),n=function(){t.get().each(e)},{clear:function(){n(),t.set(E.none())},isSet:function(){return t.get().isSome()},set:function(e){n(),t.set(E.some(e))}};var e,t,n}();r.set(iv(en(e.getBody()),"load",i)),e.on("remove",(function(){r.clear()}))}(e,u,c),e.nodeChanged()}};return e.on("focus show",d),e.on("blur hide",c.hide),e.on("init",(function(){e.hasFocus()&&d()})),Hm(e,t),{editorContainer:s.element().dom()}}}),TO=function(e,t){return function(){e.execCommand("mceToggleFormat",!1,t)}},xO=function(e,t,n){var o=function(){return!!t.undoManager&&t.undoManager[n]()},i=function(){e.setDisabled(t.mode.isReadOnly()||!o())};return e.setDisabled(!o()),t.on("Undo Redo AddUndo TypingUndo ClearUndos SwitchMode",i),function(){return t.off("Undo Redo AddUndo TypingUndo ClearUndos SwitchMode",i)}},EO=function(e,t){return{anchor:"makeshift",x:e,y:t}},_O=function(e){return"longpress"===e.type||0===e.type.indexOf("touch")},IO=function(e,t){return"contextmenu"===t.type||"longpress"===t.type?e.inline?function(e){if(_O(e)){var t=e.touches[0];return EO(t.pageX,t.pageY)}return EO(e.pageX,e.pageY)}(t):function(e,t){var n,o=tm.DOM.getPos(e);return EO((n=t).x+o.x,n.y+o.y)}(e.getContentAreaContainer(),function(e){if(_O(e)){var t=e.touches[0];return EO(t.clientX,t.clientY)}return EO(e.clientX,e.clientY)}(t)):DO(e)},DO=function(e){return{anchor:"selection",root:en(e.selection.getNode())}},OO=function(e){return{anchor:"node",node:E.some(en(e.selection.getNode())),root:en(e.getBody())}},wO=function(e,t,n,o,i,r){var a,s,l=n(),u=(a=e,s=t,r?OO(a):IO(a,s));zT(l,bg.CLOSE_ON_EXECUTE,o,!1).map((function(e){t.preventDefault(),Ph.showMenuAt(i,u,{menu:{markers:Rg("normal")},data:e})}))},RO={onLtr:function(){return[os,Ja,Qa,es,ts,ns,qh,jh,$h,Hh,Uh,Wh]},onRtl:function(){return[os,Qa,Ja,ts,es,ns,qh,jh,Uh,Wh,$h,Hh]}},SO={valignCentre:[],alignCentre:[],alignLeft:["tox-pop--align-left"],alignRight:["tox-pop--align-right"],right:["tox-pop--right"],left:["tox-pop--left"],bottom:["tox-pop--bottom"],top:["tox-pop--top"]},kO=function(e,t,n,o,i,r){var a=wn(),s=a.os.isiOS(),l=a.os.isOSX(),u=a.os.isAndroid(),c=a.deviceType.isTouch(),d=function(){var a=n();!function(e,t,n,o,i,r,a){var s,l,u,c=(s=e,l=t,u=r?OO(s):IO(s,l),f({bubble:$s(0,12,SO),layouts:RO,overrides:{maxWidthFunction:ME(),maxHeightFunction:Vs()}},u));zT(n,bg.CLOSE_ON_EXECUTE,o,!0).map((function(n){t.preventDefault(),Ph.showMenuWithinBounds(i,c,{menu:{markers:Rg("normal"),highlightImmediately:a},data:n,type:"horizontal"},(function(){return E.some(CI(e,o.shared))})),e.fire(KE)}))}(e,t,a,o,i,r,!(u||s||l&&c))};if(!l&&!s||r)u&&!r&&e.selection.setCursorLocation(t.target,0),d();else{var h=function(){!function(e){var t=e.selection.getRng(),n=function(){Gh.setEditorTimeout(e,(function(){e.selection.setRng(t)}),10),r()};e.once("touchend",n);var o=function(e){e.preventDefault(),e.stopImmediatePropagation()};e.on("mousedown",o,!0);var i=function(){return r()};e.once("longpresscancel",i);var r=function(){e.off("touchend",n),e.off("longpresscancel",i),e.off("mousedown",o)}}(e),d()};!function(e,t){var n=e.selection;if(n.isCollapsed()||t.touches.length<1)return!1;var o=t.touches[0],i=n.getRng();return vl(e.getWin(),rl.domRange(i)).exists((function(e){return e.left()<=o.clientX&&e.right()>=o.clientX&&e.top()<=o.clientY&&e.bottom()>=o.clientY}))}(e,t)?(e.once("selectionchange",h),e.once("touchend",(function(){return e.off("selectionchange",h)}))):h()}},AO=function(e){return"string"==typeof e?e.split(/[ ,]/):e},NO=function(e){return e.getParam("contextmenu_never_use_native",!1,"boolean")},MO=function(e){return D(e)?"|"===e:"separator"===e.type},KO={type:"separator"},PO=function(e){if(D(e))return e;switch(e.type){case"separator":return KO;case"submenu":return{type:"nestedmenuitem",text:e.text,icon:e.icon,getSubmenuItems:function(){var t=e.getSubmenuItems();return D(t)?t:H(t,PO)}};default:return{type:"menuitem",text:e.text,icon:e.icon,onAction:(t=e.onAction,function(){return t()})}}var t},LO=function(e,t){if(0===t.length)return e;var n=oe(e).filter((function(e){return!MO(e)})).fold((function(){return[]}),(function(e){return[KO]}));return e.concat(n).concat(t).concat([KO])},BO=function(e,t,n){var o=wn().deviceType.isTouch,i=Sr(Ph.sketch({dom:{tag:"div"},lazySink:t,onEscape:function(){return e.focus()},onShow:function(){return n.setContextMenuState(!0)},onHide:function(){return n.setContextMenuState(!1)},fireDismissalEventInstead:{},inlineBehaviours:gs([Yf("dismissContextMenu",[Bo(To(),(function(t,n){yu.close(t),e.focus()}))])])})),r=function(e){return Ph.hide(i)},a=function(t){if(NO(e)&&t.preventDefault(),(!t.ctrlKey||NO(e))&&!1!==e.getParam("contextmenu")){var r,a="longpress"!==(r=t).type&&(2!==r.button||r.target===e.getBody()&&""===r.pointerType);(o()?kO:wO)(e,t,(function(){var n,o,i,r=a?e.selection.getStart(!0):t.target,s=e.ui.registry.getAll(),l=function(e){return n=(t=e).ui.registry.getAll().contextMenus,E.from(t.getParam("contextmenu")).map(AO).getOrThunk((function(){return U(AO("link linkchecker image imagetools table spellchecker configurepermanentpen"),(function(e){return we(n,e)}))}));var t,n}(e);return n=s.contextMenus,o=r,0<(i=j(l,(function(e,t){if(we(n,t)){var i=n[t].update(o);if(D(i))return LO(e,i.split(" "));if(0<i.length){var r=H(i,PO);return LO(e,r)}return e}return e.concat([t])}),[])).length&&MO(i[i.length-1])&&i.pop(),i}),n,i,a)}};e.on("init",(function(){var t="ResizeEditor ScrollContent ScrollWindow longpresscancel"+(o()?"":" ResizeWindow");e.on(t,r),e.on("longpress contextmenu",a)}))},FO=Se([{offset:["x","y"]},{absolute:["x","y"]},{fixed:["x","y"]}]),zO=function(e){return function(t){return t.translate(-e.left(),-e.top())}},VO=function(e){return function(t){return t.translate(e.left(),e.top())}},HO=function(e){return function(t,n){return j(e,(function(e,t){return t(e)}),Lr(t,n))}},WO=function(e,t,n){return e.fold(HO([VO(n),zO(t)]),HO([zO(t)]),HO([]))},$O=function(e,t,n){return e.fold(HO([VO(n)]),HO([]),HO([VO(t)]))},UO=function(e,t,n){return e.fold(HO([]),HO([zO(n)]),HO([VO(t),zO(n)]))},qO=function(e,t,n){var o=e.fold((function(e,t){return{position:E.some("absolute"),left:E.some(e+"px"),top:E.some(t+"px")}}),(function(e,t){return{position:E.some("absolute"),left:E.some(e-n.left()+"px"),top:E.some(t-n.top()+"px")}}),(function(e,t){return{position:E.some("fixed"),left:E.some(e+"px"),top:E.some(t+"px")}}));return f({right:E.none(),bottom:E.none()},o)},jO=function(e,t,n,o){var i=function(e,i){return function(r,a){var s=e(t,n,o);return i(r.getOr(s.left()),a.getOr(s.top()))}};return e.fold(i(UO,GO),i($O,XO),i(WO,YO))},GO=FO.offset,XO=FO.absolute,YO=FO.fixed,ZO=function(e,t){var n=Ti(e,t);return function(e){return void 0===e}(n)?NaN:parseInt(n,10)},JO=function(e,t,n,o){return re(e,(function(e){var i,r,a,s,l,u,c,d;return i=t,r=e.sensor,a=e.range.left(),s=e.range.top(),c=$O(i,l=n,u=o),d=$O(r,l,u),Math.abs(c.left()-d.left())<=a&&Math.abs(c.top()-d.top())<=s?E.some({output:jO(e.output,t,n,o),extra:e.extra}):E.none()}))},QO=function(e,t,n,o,i){var r=t.getSnapPoints(e);return JO(r,n,o,i).orThunk((function(){return j(r,(function(e,t){var r,a,s,l,u,c,d,f,h=(r=n,a=t.sensor,t.range.left(),t.range.top(),u=$O(r,s=o,l=i),c=$O(a,s,l),d=Math.abs(u.left()-c.left()),f=Math.abs(u.top()-c.top()),Lr(d,f));return e.deltas.fold((function(){return{deltas:E.some(h),snap:E.some(t)}}),(function(n){return(h.left()+h.top())/2<=(n.left()+n.top())/2?{deltas:E.some(h),snap:E.some(t)}:e}))}),{deltas:E.none(),snap:E.none()}).snap.map((function(e){return{output:jO(e.output,n,o,i),extra:e.extra}}))}))},ew=function(e,t,n,o,i){var r=t.getSnapPoints(e);return JO(r,n,o,i)},tw=Object.freeze({__proto__:null,snapTo:function(e,t,n,o){var i,r=t.getTarget(e.element());if(t.repositionTarget){var a=ti(e.element()),s=jr(a),l=sD(r),u={coord:jO((i=o).output,i.output,s,l),extra:i.extra},c=qO(u.coord,0,l);vr(r,c)}}}),nw="data-initial-z-index",ow=function(e,t){var n;e.getSystem().addToGui(t),ri((n=t).element()).filter(Zo).each((function(e){Cr(e,"z-index").each((function(t){Ci(e,nw,t)})),mr(e,"z-index",yr(n.element(),"z-index"))}))},iw=function(e){ri(e.element()).filter(Zo).each((function(e){xi(e,nw).fold((function(){return xr(e,"z-index")}),(function(t){return mr(e,"z-index",t)})),_i(e,nw)})),e.getSystem().removeFromGui(e)},rw=function(e,t,n){return e.getSystem().build(Cv.sketch({dom:{styles:{left:"0px",top:"0px",width:"100%",height:"100%",position:"fixed","z-index":"1000000000000000"},classes:[t]},events:n}))},aw=Ft("snaps",[Dt("getSnapPoints"),wa("onSensor"),Dt("leftAttr"),Dt("topAttr"),zt("lazyViewport",oa),zt("mustSnap",!1)]),sw=[zt("useFixed",u),Dt("blockerClass"),zt("getTarget",i),zt("onDrag",t),zt("repositionTarget",!0),zt("onDrop",t),qt("getBounds",oa),aw],lw=function(e,t){return{bounds:e.getBounds(),height:Kr(t.element()),width:Wr(t.element())}},uw=function(e,t,n,o,i){var r=n.update(o,i),a=n.getStartData().getOrThunk((function(){return lw(t,e)}));r.each((function(n){!function(e,t,n,o){var i=t.getTarget(e.element());if(t.repositionTarget){var r=ti(e.element()),a=jr(r),s=sD(i),l=function(e){return t=Cr(e,"left"),n=Cr(e,"top"),o=Cr(e,"position"),i=function(e,t,n){return("fixed"===n?YO:GO)(parseInt(e,10),parseInt(t,10))},(t.isSome()&&n.isSome()&&o.isSome()?E.some(i(t.getOrDie(),n.getOrDie(),o.getOrDie())):E.none()).getOrThunk((function(){var t=Fr(e);return XO(t.left(),t.top())}));var t,n,o,i}(i),u=function(e,t,n,o,i,r,a){var s,l,u,c,d,f,h,g,m,p=t.fold((function(){var e,t,a,s=(e=n,t=r.left(),a=r.top(),e.fold((function(e,n){return GO(e+t,n+a)}),(function(e,n){return XO(e+t,n+a)}),(function(e,n){return YO(e+t,n+a)}))),l=WO(s,o,i);return YO(l.left(),l.top())}),(function(t){var a=function(e,t,n,o,i,r){var a,s,l,u=function(e,t,n,o){return i=t,r=e.element(),a=ZO(r,i.leftAttr),s=ZO(r,i.topAttr),(isNaN(a)||isNaN(s)?E.none():E.some(Lr(a,s))).fold((function(){return n}),(function(e){return YO(e.left()+o.left(),e.top()+o.top())}));var i,r,a,s}(e,t,n,o),c=(t.mustSnap?QO:ew)(e,t,u,i,r),d=WO(u,i,r);return a=t,s=d,l=e.element(),Ci(l,a.leftAttr,s.left()+"px"),Ci(l,a.topAttr,s.top()+"px"),c.fold((function(){return{coord:YO(d.left(),d.top()),extra:E.none()}}),(function(e){return{coord:e.output,extra:e.extra}}))}(e,t,n,r,o,i);return a.extra.each((function(n){t.onSensor(e,n)})),a.coord}));return d=(c=a).bounds,f=$O(s=p,l=o,u=i),h=Ls(f.left(),d.x,d.x+d.width-c.width),g=Ls(f.top(),d.y,d.y+d.height-c.height),m=XO(h,g),s.fold((function(){var e=UO(m,l,u);return GO(e.left(),e.top())}),(function(){return m}),(function(){var e=WO(m,l,u);return YO(e.left(),e.top())}))}(e,t.snaps,l,a,s,o,n),c=qO(u,0,s);vr(i,c)}t.onDrag(e,i,o)}(e,t,a,n)}))},cw=function(e,t,n,o){t.each(iw),n.snaps.each((function(t){!function(e,t){var n,o;n=t,o=e.element(),_i(o,n.leftAttr),_i(o,n.topAttr)}(e,t)}));var i=n.getTarget(e.element());o.reset(),n.onDrop(e,i)},dw=function(e){return function(t,n){var o=function(e){n.setStartData(lw(t,e))};return Ko(g([Bo(vo(),(function(e){n.getStartData().each((function(){return o(e)}))}))],e(t,n,o)))}},fw=Object.freeze({__proto__:null,getData:function(e){return E.from(Lr(e.x(),e.y()))},getDelta:function(e,t){return Lr(t.left()-e.left(),t.top()-e.top())}}),hw=function(e,t,n){return[Bo(Hn(),(function(o,i){if(0===i.event().raw().button){i.stop();var r,a=function(){return cw(o,E.some(l),e,t)},s=sv(a,200),l=rw(o,e.blockerClass,(r={drop:a,delayDrop:s.schedule,forceDrop:a,move:function(n){s.cancel(),uw(o,e,t,fw,n)}},Ko([Bo(Hn(),r.forceDrop),Bo(Un(),r.drop),Bo(Wn(),(function(e,t){r.move(t.event())})),Bo($n(),r.delayDrop)])));n(o),ow(o,l)}}))]},gw=g(sw,[Aa("dragger",{handlers:dw(hw)})]),mw=Object.freeze({__proto__:null,getData:function(e){var t,n=e.raw().touches;return 1===n.length?E.some(Lr((t=n[0]).clientX,t.clientY)):E.none()},getDelta:function(e,t){return Lr(t.left()-e.left(),t.top()-e.top())}}),pw=function(e,t,n){var o=Xt(E.none());return[Bo(Bn(),(function(i,r){r.stop();var a,s=function(){cw(i,o.get(),e,t),o.set(E.none())},l=rw(i,e.blockerClass,(a={drop:s,delayDrop:function(){},forceDrop:s,move:function(n){uw(i,e,t,mw,n)}},Ko([Bo(Bn(),a.forceDrop),Bo(zn(),a.drop),Bo(Vn(),a.drop),Bo(Fn(),(function(e,t){a.move(t.event())}))])));o.set(E.some(l)),n(i),ow(i,l)})),Bo(Fn(),(function(n,o){o.stop(),uw(n,e,t,mw,o.event())})),Bo(zn(),(function(n,i){i.stop(),cw(n,o.get(),e,t),o.set(E.none())})),Bo(Vn(),(function(n){cw(n,o.get(),e,t),o.set(E.none())}))]},vw=gw,yw=g(sw,[Aa("dragger",{handlers:dw(pw)})]),bw=g(sw,[Aa("dragger",{handlers:dw((function(e,t,n){return g(hw(e,t,n),pw(e,t,n))}))})]),Cw=ys({branchKey:"mode",branches:Object.freeze({__proto__:null,mouse:vw,touch:yw,mouseOrTouch:bw}),name:"dragging",active:{events:function(e,t){return e.dragger.handlers(e,t)}},extra:{snap:function(e){return{sensor:e.sensor,range:e.range,output:e.output,extra:E.from(e.extra)}}},state:Object.freeze({__proto__:null,init:function(){var e=E.none(),t=E.none(),n=o({});return qi({readState:n,reset:function(){e=E.none(),t=E.none()},update:function(t,n){return t.getData(n).bind((function(n){return o=t,i=n,r=e.map((function(e){return o.getDelta(e,i)})),e=E.some(i),r;var o,i,r}))},getStartData:function(){return t},setStartData:function(e){t=E.some(e)}})}}),apis:tw}),Tw=function(e,t,n,o,i,r){return e.fold((function(){return Cw.snap({sensor:XO(n-20,o-20),range:Lr(i,r),output:XO(E.some(n),E.some(o)),extra:{td:t}})}),(function(e){var i=n-20,r=o-20,a=e.element().dom().getBoundingClientRect();return Cw.snap({sensor:XO(i,r),range:Lr(40,40),output:XO(E.some(n-a.width/2),E.some(o-a.height/2)),extra:{td:t}})}))},xw=function(e,t,n){return{getSnapPoints:e,leftAttr:"data-drag-left",topAttr:"data-drag-top",onSensor:function(e,o){var i,r,a=o.td;i=t.get(),r=a,i.exists((function(e){return kn(e,r)}))||(t.set(E.some(a)),n(a))},mustSnap:!0}},Ew=function(e){return Yh(Xh.sketch({dom:{tag:"div",classes:["tox-selector"]},buttonBehaviours:gs([Cw.config({mode:"mouseOrTouch",blockerClass:"blocker",snaps:e}),Ry.config({})]),eventOrder:{mousedown:["dragging","alloy.base.behaviour"],touchstart:["dragging","alloy.base.behaviour"]}}))},_w=function(e,t){var n=Xt([]),o=Xt([]),i=Xt(!1),r=Xt(E.none()),a=Xt(E.none()),s=function(e){var n=na(e);return Tw(d.getOpt(t),e,n.x,n.y,n.width,n.height)},l=function(e){var n=na(e);return Tw(f.getOpt(t),e,n.right,n.bottom,n.width,n.height)},u=xw((function(){return H(n.get(),(function(e){return s(e)}))}),r,(function(t){a.get().each((function(n){e.fire("TableSelectorChange",{start:t,finish:n})}))})),c=xw((function(){return H(o.get(),(function(e){return l(e)}))}),a,(function(t){r.get().each((function(n){e.fire("TableSelectorChange",{start:n,finish:t})}))})),d=Ew(u),f=Ew(c),h=Sr(d.asSpec()),g=Sr(f.asSpec()),m=function(t,n,o,i){var r=o(n);Cw.snapTo(t,r),function(t,n,o,i){var r=n.dom().getBoundingClientRect();xr(t.element(),"display");var a=ii(en(e.getBody())).dom().innerHeight,s=o(r),l=i(r,a);(s||l)&&mr(t.element(),"display","none")}(t,n,(function(e){return e[i]<0}),(function(e,t){return e[i]>t}))},p=function(e){return m(h,e,s,"top")},v=function(e){return m(g,e,l,"bottom")};wn().deviceType.isTouch()&&(e.on("TableSelectionChange",(function(e){i.get()||(tu(t,h),tu(t,g),i.set(!0)),r.set(E.some(e.start)),a.set(E.some(e.finish)),e.otherCells.each((function(t){n.set(t.upOrLeftCells),o.set(t.downOrRightCells),p(e.start),v(e.finish)}))})),e.on("ResizeEditor ResizeWindow ScrollContent",(function(){r.get().each(p),a.get().each(v)})),e.on("TableSelectionClear",(function(){i.get()&&(iu(h),iu(g),i.set(!1)),r.set(E.none()),a.set(E.none())})))};(RI=wI=wI||{})[RI.None=0]="None",RI[RI.Both=1]="Both",RI[RI.Vertical=2]="Vertical";var Iw=function(e){if(1===e.nodeType){if("BR"===e.nodeName||e.getAttribute("data-mce-bogus"))return!0;if("bookmark"===e.getAttribute("data-mce-type"))return!0}return!1},Dw=function(e,t){var n,o,i,r,a,s;return{dom:{tag:"div",classes:["tox-statusbar"]},components:(a=function(){var n,o,i,r,a=[];return e.getParam("elementpath",!0,"boolean")&&a.push(function(e,t,n){return t.delimiter||(t.delimiter="»"),{dom:{tag:"div",classes:["tox-statusbar__path"],attributes:{role:"navigation"}},behaviours:gs([$f.config({mode:"flow",selector:"div[role=button]"}),pm.config({disabled:n.isReadOnly}),Wm(),Ov.config({}),Xf.config({}),Yf("elementPathEvents",[Uo((function(o,i){e.shortcuts.add("alt+F11","focus statusbar elementpath",(function(){return $f.focusIn(o)})),e.on("NodeChange",(function(i){var r,a,s=function(t){for(var n=[],o=t.length;0<o--;){var i=t[o];if(1===i.nodeType&&!Iw(i)){var r=e.fire("ResolveName",{name:i.nodeName.toLowerCase(),target:i});if(r.isDefaultPrevented()||n.push({name:r.name,element:i}),r.isPropagationStopped())break}}return n}(i.parents);Xf.set(o,0<s.length?(r=H(s||[],(function(t,o){return Xh.sketch({dom:{tag:"div",classes:["tox-statusbar__path-item"],attributes:{role:"button","data-index":o,"tab-index":-1,"aria-level":o+1},innerHtml:t.name},action:function(n){e.focus(),e.selection.select(t.element),e.nodeChanged()},buttonBehaviours:gs([Um(n.isReadOnly),Wm()])})})),a={dom:{tag:"div",classes:["tox-statusbar__path-divider"],attributes:{"aria-hidden":!0},innerHtml:" "+t.delimiter+" "}},j(r.slice(1),(function(e,t){var n=e;return n.push(a),n.push(t),n}),[r[0]])):[])}))}))])]),components:[]}}(e,{},t)),bn(e.getParam("plugins","","string"),"wordcount")&&a.push((n=e,i=function(e,t,n){return Xf.set(e,[Or(o.translate(["{0} "+n,t[n]]))])},Xh.sketch({dom:{tag:"button",classes:["tox-statusbar__wordcount"]},components:[],buttonBehaviours:gs([Um((o=t).isReadOnly),Wm(),Ov.config({}),Xf.config({}),Bu.config({store:{mode:"memory",initialValue:{mode:"words",count:{words:0,characters:0}}}}),Yf("wordcount-events",[Go((function(e){var t=Bu.getValue(e),n="words"===t.mode?"characters":"words";Bu.setValue(e,{mode:n,count:t.count}),i(e,t.count,n)})),Uo((function(e){n.on("wordCountUpdate",(function(t){var n=Bu.getValue(e).mode;Bu.setValue(e,{mode:n,count:t.wordCount}),i(e,t.wordCount,n)}))}))])]),eventOrder:{"alloy.execute":["disabling","alloy.base.behaviour","wordcount-events"]}}))),e.getParam("branding",!0,"boolean")&&a.push({dom:{tag:"span",classes:["tox-statusbar__branding"],innerHtml:'<a href="https://www.tiny.cloud/?utm_campaign=editor_referral&amp;utm_medium=poweredby&amp;utm_source=tinymce&amp;utm_content=v5" rel="noopener" target="_blank" tabindex="-1" aria-label="'+(r=nm.translate(["Powered by {0}","Tiny"]))+'">'+r+"</a>"}}),0<a.length?[{dom:{tag:"div",classes:["tox-statusbar__text-container"]},components:a}]:[]}(),o=!bn((n=e).getParam("plugins","","string"),"autoresize"),(s=!1===(i=n.getParam("resize",o))?wI.None:"both"===i?wI.Both:wI.Vertical)!==wI.None&&a.push((r=s,{dom:{tag:"div",classes:["tox-statusbar__resize-handle"],attributes:{title:t.translate("Resize"),"aria-hidden":"true"},innerHtml:Jh("resize-handle",t.icons)},behaviours:gs([Cw.config({mode:"mouse",repositionTarget:!1,onDrag:function(t,n,o){!function(e,t,n){var o,i,r,a,s,l,u=en(e.getContainer()),c=(o=e,i=t,r=n,a=Mr(u),s=Hr(u),(l={}).height=vO(a+i.top(),Tm(o),Em(o)),r===wI.Both&&(l.width=vO(s+i.left(),Cm(o),xm(o))),l);Te(c,(function(e,t){return mr(u,t,pO(e))})),e.fire("ResizeEditor")}(e,o,r)},blockerClass:"tox-blocker"})])})),a)}},Ow=function(t){var n,o=t.inline,i=o?CO:gO,r=Bm(t)?SD:MD,a=E.none(),s=wn(),l=s.browser.isIE()?["tox-platform-ie"]:[],u=s.deviceType.isTouch()?["tox-platform-touch"]:[],c=Mm(t),d=nm.isRtl()?{attributes:{dir:"rtl"}}:{},h={attributes:((n={})[Ys]=c?ma.BottomToTop:ma.TopToBottom,n)},g=function(){return a.bind(nO.getHeader)},m=Sr({dom:f({tag:"div",classes:["tox","tox-silver-sink","tox-tinymce-aux"].concat(l).concat(u)},d),behaviours:gs([Yl.config({useFixed:function(){return r.isDocked(g)}})])}),p=function(){return le.value(m)},v=Yh({dom:{tag:"div",classes:["tox-anchorbar"]}}),y=function(){return a.bind((function(e){return nO.getThrobber(e)})).getOrDie("Could not find throbber element")},b=NE(m,t,(function(){return a.bind((function(e){return v.getOpt(e)})).getOrDie("Could not find a anchor bar element")})),C=nO.parts().menubar({dom:{tag:"div",classes:["tox-menubar"]},backstage:b,onEscape:function(){t.focus()}}),T=Sm(t),x=nO.parts().toolbar(f({dom:{tag:"div",classes:["tox-toolbar"]},getSink:p,providers:b.shared.providers,onEscape:function(){t.focus()},type:T,lazyToolbar:function(){return a.bind((function(e){return nO.getToolbar(e)})).getOrDie("Could not find more toolbar element")},lazyHeader:function(){return g().getOrDie("Could not find header element")}},h)),_=nO.parts()["multiple-toolbar"]({dom:{tag:"div",classes:["tox-toolbar-overlord"]},providers:b.shared.providers,onEscape:function(){},type:T}),I=nO.parts().socket({dom:{tag:"div",classes:["tox-edit-area"]}}),D=nO.parts().sidebar({dom:{tag:"div",classes:["tox-sidebar"]}}),O=nO.parts().throbber({dom:{tag:"div",classes:["tox-throbber"]},backstage:b}),w=t.getParam("statusbar",!0,"boolean")&&!o?E.some(Dw(t,b.shared.providers)):E.none(),R={dom:{tag:"div",classes:["tox-sidebar-wrap"]},components:[I,D]},S=Om(t),k=Im(t),N=_m(t),M=nO.parts().header({dom:f({tag:"div",classes:["tox-editor-header"]},h),components:Y([N?[C]:[],S?[_]:k?[x]:[],Pm(t)?[]:[v.asSpec()]]),sticky:Bm(t),editor:t,sharedBackstage:b.shared}),K=Y([c?[]:[M],o?[]:[R],c?[M]:[]]),P=Y([[{dom:{tag:"div",classes:["tox-editor-container"]},components:K}],o?[]:w.toArray(),[O]]),L=Lm(t),B=f(f({role:"application"},nm.isRtl()?{dir:"rtl"}:{}),L?{"aria-hidden":"true"}:{}),F=Sr(nO.sketch({dom:{tag:"div",classes:["tox","tox-tinymce"].concat(o?["tox-tinymce-inline"]:[]).concat(c?["tox-tinymce--toolbar-bottom"]:[]).concat(u).concat(l),styles:f({visibility:"hidden"},L?{opacity:"0",border:"0"}:{}),attributes:B},components:P,behaviours:gs([$f.config({mode:"cyclic",selector:".tox-menubar, .tox-toolbar, .tox-toolbar__primary, .tox-toolbar__overflow--open, .tox-sidebar__overflow--open, .tox-statusbar__path, .tox-statusbar__wordcount, .tox-statusbar__branding a"})])}));a=E.some(F),t.shortcuts.add("alt+F9","focus menubar",(function(){nO.focusMenubar(F)})),t.shortcuts.add("alt+F10","focus toolbar",(function(){nO.focusToolbar(F)}));var z,V,H,$,U,q,j,G,X,Z,J,Q,ee,te,ne,oe,ie=Tv(F),re=Tv(m);return z=t,V=ie,H=re,$=function(e,t){W([V,H],(function(n){n.broadcastEvent(e,t)}))},U=function(e,t){W([V,H],(function(n){n.broadcastOn([e],t)}))},q=function(e){return U(bu(),{target:e.target()})},j=ov(en(e.document),"touchstart",q),G=ov(en(e.document),"touchmove",(function(e){return $(mo(),e)})),X=ov(en(e.document),"touchend",(function(e){return $(po(),e)})),Z=ov(en(e.document),"mousedown",q),J=ov(en(e.document),"mouseup",(function(e){0===e.raw().button&&U(Tu(),{target:e.target()})})),Q=function(e){return U(bu(),{target:en(e.target)})},ee=function(e){0===e.button&&U(Tu(),{target:en(e.target)})},te=function(e){return $(vo(),rv(e))},ne=function(e){U(Cu(),{}),$(yo(),rv(e))},oe=function(){return U(Cu(),{})},z.on("PostRender",(function(){z.on("click",Q),z.on("tap",Q),z.on("mouseup",ee),z.on("ScrollWindow",te),z.on("ResizeWindow",ne),z.on("ResizeEditor",oe)})),z.on("remove",(function(){z.off("click",Q),z.off("tap",Q),z.off("mouseup",ee),z.off("ScrollWindow",te),z.off("ResizeWindow",ne),z.off("ResizeEditor",oe),Z.unbind(),j.unbind(),G.unbind(),X.unbind(),J.unbind()})),z.on("detach",(function(){lu(V),lu(H),V.destroy(),H.destroy()})),{mothership:ie,uiMothership:re,backstage:b,renderUI:function(){var e,n,o,a,s,l,u,c;r.setup(t,b.shared,g),function(e,t){var n,o,i,r;!function(e){hx.each([{name:"alignleft",text:"Align left",cmd:"JustifyLeft",icon:"align-left"},{name:"aligncenter",text:"Align center",cmd:"JustifyCenter",icon:"align-center"},{name:"alignright",text:"Align right",cmd:"JustifyRight",icon:"align-right"},{name:"alignjustify",text:"Justify",cmd:"JustifyFull",icon:"align-justify"}],(function(t){e.ui.registry.addToggleButton(t.name,{tooltip:t.text,onAction:function(){return e.execCommand(t.cmd)},icon:t.icon,onSetup:zI(e,t.name)})})),e.ui.registry.addButton("alignnone",{tooltip:"No alignment",onAction:function(){return e.execCommand("JustifyNone")},icon:"align-none"})}(e),function(e){var t;(function(e){var t,n;!function(e){hx.each([{name:"bold",text:"Bold",icon:"bold"},{name:"italic",text:"Italic",icon:"italic"},{name:"underline",text:"Underline",icon:"underline"},{name:"strikethrough",text:"Strikethrough",icon:"strike-through"},{name:"subscript",text:"Subscript",icon:"subscript"},{name:"superscript",text:"Superscript",icon:"superscript"}],(function(t,n){e.ui.registry.addToggleButton(t.name,{tooltip:t.text,icon:t.icon,onSetup:zI(e,t.name),onAction:TO(e,t.name)})}));for(var t=1;t<=6;t++){var n="h"+t;e.ui.registry.addToggleButton(n,{text:n.toUpperCase(),tooltip:"Heading "+t,onSetup:zI(e,n),onAction:TO(e,n)})}}(e),t=e,hx.each([{name:"cut",text:"Cut",action:"Cut",icon:"cut"},{name:"copy",text:"Copy",action:"Copy",icon:"copy"},{name:"paste",text:"Paste",action:"Paste",icon:"paste"},{name:"help",text:"Help",action:"mceHelp",icon:"help"},{name:"selectall",text:"Select all",action:"SelectAll",icon:"select-all"},{name:"newdocument",text:"New document",action:"mceNewDocument",icon:"new-document"},{name:"removeformat",text:"Clear formatting",action:"RemoveFormat",icon:"remove-formatting"},{name:"remove",text:"Remove",action:"Delete",icon:"remove"}],(function(e){t.ui.registry.addButton(e.name,{tooltip:e.text,icon:e.icon,onAction:function(){return t.execCommand(e.action)}})})),n=e,hx.each([{name:"blockquote",text:"Blockquote",action:"mceBlockQuote",icon:"quote"}],(function(e){n.ui.registry.addToggleButton(e.name,{tooltip:e.text,icon:e.icon,onAction:function(){return n.execCommand(e.action)},onSetup:zI(n,e.name)})}))})(e),t=e,hx.each([{name:"bold",text:"Bold",action:"Bold",icon:"bold",shortcut:"Meta+B"},{name:"italic",text:"Italic",action:"Italic",icon:"italic",shortcut:"Meta+I"},{name:"underline",text:"Underline",action:"Underline",icon:"underline",shortcut:"Meta+U"},{name:"strikethrough",text:"Strikethrough",action:"Strikethrough",icon:"strike-through",shortcut:""},{name:"subscript",text:"Subscript",action:"Subscript",icon:"subscript",shortcut:""},{name:"superscript",text:"Superscript",action:"Superscript",icon:"superscript",shortcut:""},{name:"removeformat",text:"Clear formatting",action:"RemoveFormat",icon:"remove-formatting",shortcut:""},{name:"newdocument",text:"New document",action:"mceNewDocument",icon:"new-document",shortcut:""},{name:"cut",text:"Cut",action:"Cut",icon:"cut",shortcut:"Meta+X"},{name:"copy",text:"Copy",action:"Copy",icon:"copy",shortcut:"Meta+C"},{name:"paste",text:"Paste",action:"Paste",icon:"paste",shortcut:"Meta+V"},{name:"selectall",text:"Select all",action:"SelectAll",icon:"select-all",shortcut:"Meta+A"}],(function(e){t.ui.registry.addMenuItem(e.name,{text:e.text,icon:e.icon,shortcut:e.shortcut,onAction:function(){return t.execCommand(e.action)}})})),t.ui.registry.addMenuItem("codeformat",{text:"Code",icon:"sourcecode",onAction:TO(t,"code")})}(e),function(e,t){var n,o,i,r,a,s,l,u,c,d,h,g,m,p;i=DI(0,o=t,AI(n=e)),n.ui.registry.addNestedMenuItem("align",{text:o.shared.providers.translate("Align"),getSubmenuItems:function(){return i.items.validateItems(i.getStyleItems())}}),s=DI(0,a=t,KI(r=e)),r.ui.registry.addNestedMenuItem("fontformats",{text:a.shared.providers.translate("Fonts"),getSubmenuItems:function(){return s.items.validateItems(s.getStyleItems())}}),l=e,c=f({type:"advanced"},(u=t).styleselect),d=DI(0,u,WI(l,c)),l.ui.registry.addNestedMenuItem("formats",{text:"Formats",getSubmenuItems:function(){return d.items.validateItems(d.getStyleItems())}}),g=DI(0,t,HI(h=e)),h.ui.registry.addNestedMenuItem("blockformats",{text:"Blocks",getSubmenuItems:function(){return g.items.validateItems(g.getStyleItems())}}),p=DI(0,t,LI(m=e)),m.ui.registry.addNestedMenuItem("fontsizes",{text:"Font sizes",getSubmenuItems:function(){return p.items.validateItems(p.getStyleItems())}})}(e,t),function(e){var t,n;(t=e).ui.registry.addMenuItem("undo",{text:"Undo",icon:"undo",shortcut:"Meta+Z",onSetup:function(e){return xO(e,t,"hasUndo")},onAction:function(){return t.execCommand("undo")}}),t.ui.registry.addMenuItem("redo",{text:"Redo",icon:"redo",shortcut:"Meta+Y",onSetup:function(e){return xO(e,t,"hasRedo")},onAction:function(){return t.execCommand("redo")}}),(n=e).ui.registry.addButton("undo",{tooltip:"Undo",icon:"undo",onSetup:function(e){return xO(e,n,"hasUndo")},onAction:function(){return n.execCommand("undo")}}),n.ui.registry.addButton("redo",{tooltip:"Redo",icon:"redo",onSetup:function(e){return xO(e,n,"hasRedo")},onAction:function(){return n.execCommand("redo")}})}(e),function(e){!function(e){e.addCommand("mceApplyTextcolor",(function(t,n){var o,i,r;i=t,r=n,(o=e).undoManager.transact((function(){o.focus(),o.formatter.apply(i,{value:r}),o.nodeChanged()}))})),e.addCommand("mceRemoveTextcolor",(function(t){var n,o;o=t,(n=e).undoManager.transact((function(){n.focus(),n.formatter.remove(o,{value:null},null,!0),n.nodeChanged()}))}))}(e);var t=Xt(null),n=Xt(null);qp(e,"forecolor","forecolor","Text color",t),qp(e,"backcolor","hilitecolor","Background color",n),jp(e,"forecolor","forecolor","Text color"),jp(e,"backcolor","hilitecolor","Background color")}(e),(o=n=e).ui.registry.addButton("visualaid",{tooltip:"Visual aids",text:"Visual aids",onAction:function(){return o.execCommand("mceToggleVisualAid")}}),(i=n).ui.registry.addToggleMenuItem("visualaid",{text:"Visual aids",onSetup:function(e){return function(e,t){e.setActive(t.hasVisual);var n=function(t){e.setActive(t.hasVisual)};return t.on("VisualAid",n),function(){return t.off("VisualAid",n)}}(e,i)},onAction:function(){i.execCommand("mceToggleVisualAid")}}),(r=e).ui.registry.addButton("outdent",{tooltip:"Decrease indent",icon:"outdent",onSetup:function(e){return function(e,t){e.setDisabled(!t.queryCommandState("outdent"));var n=function(){e.setDisabled(!t.queryCommandState("outdent"))};return t.on("NodeChange",n),function(){return t.off("NodeChange",n)}}(e,r)},onAction:function(){return r.execCommand("outdent")}}),r.ui.registry.addButton("indent",{tooltip:"Increase indent",icon:"indent",onAction:function(){return r.execCommand("indent")}})}(t,b),BO(t,p,b),n=(e=t).ui.registry.getAll().sidebars,W(be(n),(function(t){var o=n[t],i=function(){return E.from(e.queryCommandValue("ToggleSidebar")).is(t)};e.ui.registry.addToggleButton(t,{icon:o.icon,tooltip:o.tooltip,onAction:function(n){e.execCommand("ToggleSidebar",!1,t),n.setActive(i())},onSetup:function(t){var n=function(){return t.setActive(i())};return e.on("ToggleSidebar",n),function(){e.off("ToggleSidebar",n)}}})})),o=t,a=y,s=b.shared,l=Xt(!1),u=Xt(E.none()),c=function(e){e!==l.get()&&(function(e,t,n){var o=e.element();!0===t?(Xf.set(e,[{dom:{tag:"div",attributes:{"aria-label":n.translate("Loading...")},classes:["tox-throbber__busy-spinner"]},components:[{dom:GD('<div class="tox-spinner"><div></div><div></div><div></div></div>')}],behaviours:gs([$f.config({mode:"special",onTab:function(){return E.some(!0)},onShiftTab:function(){return E.some(!0)}}),th.config({})])}]),xr(o,"display"),_i(o,"aria-hidden")):(Xf.set(e,[]),mr(o,"display","none"),Ci(o,"aria-hidden","true"))}(a(),e,s.providers),l.set(e))},o.on("ProgressState",(function(e){if(u.get().each(Gh.clearTimeout),A(e.time)){var t=Gh.setEditorTimeout(o,(function(){return c(e.state)}),e.time);u.set(E.some(t))}else c(e.state),u.set(E.none())})),xe(t.getParam("toolbar_groups",{},"object"),(function(e,n){t.ui.registry.addGroupToolbarButton(n,e)}));var d,h=t.ui.registry.getAll(),v=h.buttons,C=h.menuItems,x=h.contextToolbars,_=h.sidebars,I=Dm(t),D={menuItems:C,menus:(d=t.getParam("menu"))?xe(d,(function(e){return f(f({},e),{items:e.items})})):{},menubar:t.getParam("menubar"),toolbar:I.getOrThunk((function(){return t.getParam("toolbar",!0)})),allowToolbarGroups:T===vg.floating,buttons:v,sidebar:_};QI(t,x,m,{backstage:b}),_w(t,m);var O=t.getElement(),w=function(){var e,n=pO(function(e){var t,n,o,i;return(n=ym(t=e),o=Tm(t),i=Em(t),mO(n).map((function(e){return vO(e,o,i)}))).getOr(ym(e))}(t)),o=pO(yO(e=t).getOr(bm(e)));return t.inline||(Tr("div","width",o)&&mr(F.element(),"width",o),Tr("div","height",n)?mr(F.element(),"height",n):mr(F.element(),"height","200px")),n}();return i.render(t,{mothership:ie,uiMothership:re,outerContainer:F},D,b,{targetNode:O,height:w})},getUi:function(){return{channels:{broadcastAll:re.broadcast,broadcastOn:re.broadcastOn,register:function(){}}}}}},ww=o([Dt("lazySink"),Mt("dragBlockClass"),qt("getBounds",oa),zt("useTabstopAt",o(!0)),zt("eventOrder",{}),Fu("modalBehaviours",[$f]),Ra("onExecute"),ka("onEscape")]),Rw={sketch:i},Sw=o([gc({name:"draghandle",overrides:function(e,t){return{behaviours:gs([Cw.config({mode:"mouse",getTarget:function(e){return ca(e,'[role="dialog"]').getOr(e)},blockerClass:e.dragBlockClass.getOrDie(new Error("The drag blocker class was not specified for a dialog with a drag handle: \n"+JSON.stringify(t,null,2)).message),getBounds:e.getDragBounds})])}}}),fc({schema:[Dt("dom")],name:"title"}),fc({factory:Rw,schema:[Dt("dom")],name:"close"}),fc({factory:Rw,schema:[Dt("dom")],name:"body"}),gc({factory:Rw,schema:[Dt("dom")],name:"footer"}),hc({factory:{sketch:function(e,t){return f(f({},e),{dom:t.dom,components:t.components})}},schema:[zt("dom",{tag:"div",styles:{position:"fixed",left:"0px",top:"0px",right:"0px",bottom:"0px"}}),zt("components",[])],name:"blocker"})]),kw=Vc({name:"ModalDialog",configFields:ww(),partFields:Sw(),factory:function(e,t,n,o){var r=Ri("alloy.dialog.busy"),a=Ri("alloy.dialog.idle"),s=gs([$f.config({mode:"special",onTab:function(){return E.some(!0)},onShiftTab:function(){return E.some(!0)}}),th.config({})]),l=Ri("modal-events"),u=f(f({},e.eventOrder),{"alloy.system.attached":[l].concat(e.eventOrder["alloy.system.attached"]||[])});return{uid:e.uid,dom:e.dom,components:t,apis:{show:function(t){var n=e.lazySink(t).getOrDie(),i=Xt(E.none()),l=o.blocker(),u=n.getSystem().build(f(f({},l),{components:l.components.concat([kr(t)]),behaviours:gs([th.config({}),Yf("dialog-blocker-events",[$o(jn(),(function(){$f.focusIn(t)})),Bo(a,(function(e,n){Ei(t.element(),"aria-busy")&&(_i(t.element(),"aria-busy"),i.get().each((function(e){return Xf.remove(t,e)})))})),Bo(r,(function(e,n){Ci(t.element(),"aria-busy","true");var o=n.event().getBusySpec();i.get().each((function(e){Xf.remove(t,e)}));var r=o(t,s),a=e.getSystem().build(r);i.set(E.some(a)),Xf.append(t,kr(a)),a.hasConfigured($f)&&$f.focusIn(a)}))])])}));tu(n,u),$f.focusIn(t)},hide:function(e){ri(e.element()).each((function(t){e.getSystem().getByDom(t).each((function(e){iu(e)}))}))},getBody:function(t){return Oc(t,e,"body")},getFooter:function(t){return Oc(t,e,"footer")},setIdle:function(e){Ro(e,a)},setBusy:function(e,t){So(e,r,{getBusySpec:t})}},eventOrder:u,domModification:{attributes:{role:"dialog","aria-modal":"true"}},behaviours:Vu(e.modalBehaviours,[Xf.config({}),$f.config({mode:"cyclic",onEnter:e.onExecute,onEscape:e.onEscape,useTabstopAt:e.useTabstopAt}),Yf(l,[Uo((function(t){var n,o,r,a,s,l;n=t.element(),o=Oc(t,e,"title").element(),r=E.from(Ti(n,"id")).fold((function(){var e=Ri("dialog-label");return Ci(o,"id",e),e}),i),Ci(n,"aria-labelledby",r),a=t.element(),s=Oc(t,e,"body").element(),l=E.from(Ti(a,"id")).fold((function(){var e=Ri("dialog-describe");return Ci(s,"id",e),e}),i),Ci(a,"aria-describedby",l)}))])])}},apis:{show:function(e,t){e.show(t)},hide:function(e,t){e.hide(t)},getBody:function(e,t){return e.getBody(t)},getFooter:function(e,t){return e.getFooter(t)},setBusy:function(e,t,n){e.setBusy(t,n)},setIdle:function(e,t){e.setIdle(t)}}}),Aw=et([wt("type"),wt("name")].concat(Fg)),Nw=Tt,Mw=[rt("name","name",ze((function(){return Ri("button-name")})),Ct),Lt("icon"),$t("align","end",["start","end"]),Ut("primary",!1),Ut("disabled",!1)],Kw=g(Mw,[wt("text")]),Pw=g([Rt("type",["submit","cancel","custom"])],Kw),Lw=g([Rt("type",["menu"]),Lt("text"),Lt("tooltip"),Lt("icon"),Nt("items",Aw)],Mw),Bw=pt("type",{submit:Pw,cancel:Pw,custom:Pw,menu:Lw}),Fw=[wt("type"),wt("text"),Rt("level",["info","warn","error","success"]),wt("icon"),zt("url","")],zw=et(Fw),Vw=[wt("type"),wt("text"),Ut("disabled",!1),Ut("primary",!1),rt("name","name",ze((function(){return Ri("button-name")})),Ct),Lt("icon"),Ut("borderless",!1)],Hw=et(Vw),Ww=[wt("type"),wt("name"),wt("label"),Ut("disabled",!1)],$w=et(Ww),Uw=Tt,qw=[wt("type"),wt("name")],jw=qw.concat([Lt("label")]),Gw=et(jw),Xw=Ct,Yw=et(jw),Zw=Ct,Jw=et(jw),Qw=tt(st),eR=function(e){return[wt("type"),Ot("columns",bt),e]},tR=jw.concat([Ut("sandboxed",!0)]),nR=et(tR),oR=Ct,iR=jw.concat([Lt("inputMode"),Lt("placeholder"),Ut("maximized",!1),Ut("disabled",!1)]),rR=et(iR),aR=Ct,sR=jw.concat([At("items",[wt("text"),wt("value")]),Ht("size",1),Ut("disabled",!1)]),lR=et(sR),uR=Ct,cR=jw.concat([Ut("constrain",!0),Ut("disabled",!1)]),dR=et(cR),fR=et([wt("width"),wt("height")]),hR=jw.concat([Lt("placeholder"),Ut("maximized",!1),Ut("disabled",!1)]),gR=et(hR),mR=Ct,pR=jw.concat([$t("filetype","file",["image","media","file"]),zt("disabled",!1)]),vR=et(pR),yR=et([wt("value"),zt("meta",{})]),bR=qw.concat([Wt("tag","textarea"),wt("scriptId"),wt("scriptUrl"),Vt("settings",void 0,_t)]),CR=qw.concat([Wt("tag","textarea"),St("init")]),TR=ut((function(e){return dt("customeditor.old",Qe(CR),e).orThunk((function(){return dt("customeditor.new",Qe(bR),e)}))})),xR=Ct,ER=[wt("type"),wt("html"),$t("presets","presentation",["presentation","document"])],_R=et(ER),IR=jw.concat([Ot("currentState",et([Dt("blob"),wt("url")]))]),DR=et(IR),OR=jw.concat([zt("columns","auto")]),wR=et(OR),RR=lt([wt("value"),wt("text"),wt("icon")]),SR=[wt("type"),Nt("header",Ct),Nt("cells",tt(Ct))],kR=et(SR),AR=function(e){return rt("items","items",Be(),tt(ut((function(t){return dt("Checking item of "+e,NR,t).fold((function(e){return le.error(gt(e))}),(function(e){return le.value(e)}))}))))},NR=function(e){return{extract:function(t,n,o){return e().extract(t,n,o)},toString:function(){return e().toString()}}}((function(){return mt("type",{alertbanner:zw,bar:et((t=AR("bar"),[wt("type"),t])),button:Hw,checkbox:$w,colorinput:Gw,colorpicker:Yw,dropzone:Jw,grid:et(eR(AR("grid"))),iframe:nR,input:rR,selectbox:lR,sizeinput:dR,textarea:gR,urlinput:vR,customeditor:TR,htmlpanel:_R,imagetools:DR,collection:wR,label:et((e=AR("label"),[wt("type"),wt("label"),e])),table:kR,panel:KR});var e,t})),MR=[wt("type"),zt("classes",[]),Nt("items",NR)],KR=et(MR),PR=[rt("name","name",ze((function(){return Ri("tab-name")})),Ct),wt("title"),Nt("items",NR)],LR=[wt("type"),At("tabs",PR)],BR=et(LR),FR=Kw,zR=Bw,VR=et([wt("title"),Ot("body",mt("type",{panel:KR,tabpanel:BR})),Wt("size","normal"),Nt("buttons",zR),zt("initialData",{}),qt("onAction",t),qt("onChange",t),qt("onSubmit",t),qt("onClose",t),qt("onCancel",t),zt("onTabChange",t)]),HR=function(e){return O(e)?[e].concat(Z(De(e),HR)):w(e)?Z(e,HR):[]},WR=function(e){return D(e.type)&&D(e.name)},$R={checkbox:Uw,colorinput:Xw,colorpicker:Zw,dropzone:Qw,input:aR,iframe:oR,sizeinput:fR,selectbox:uR,size:fR,textarea:mR,urlinput:yR,customeditor:xR,collection:RR,togglemenuitem:Nw},UR=function(e){var t=U(HR(e),WR),n=Z(t,(function(e){return E.from($R[e.type]).fold((function(){return[]}),(function(t){return[Ot(e.name,t)]}))}));return et(n)},qR=et(g([Rt("type",["cancel","custom"])],FR)),jR=et([wt("title"),wt("url"),Pt("height"),Pt("width"),Kt("buttons",tt(qR)),qt("onAction",t),qt("onCancel",t),qt("onClose",t),qt("onMessage",t)]),GR=function(e){return{internalDialog:ft(dt("dialog",VR,e)),dataValidator:UR(e),initialData:e.initialData}},XR={open:function(e,t){var n=GR(t);return e(n.internalDialog,n.initialData,n.dataValidator)},openUrl:function(e,t){return e(ft(dt("dialog",jR,t)))},redial:function(e){return GR(e)}},YR=function(e){var t=[],n={};return Te(e,(function(e,o){e.fold((function(){t.push(o)}),(function(e){n[o]=e}))})),0<t.length?le.error(t):le.value(n)},ZR=zc({name:"TabButton",configFields:[zt("uid",void 0),Dt("value"),rt("dom","dom",Ve((function(){return{attributes:{role:"tab",id:Ri("aria"),"aria-selected":"false"}}})),vt()),Mt("action"),zt("domModification",{}),Fu("tabButtonBehaviours",[th,$f,Bu]),Dt("view")],factory:function(e,t){return{uid:e.uid,dom:e.dom,components:e.components,events:mh(e.action),behaviours:Vu(e.tabButtonBehaviours,[th.config({}),$f.config({mode:"execution",useSpace:!0,useEnter:!0}),Bu.config({store:{mode:"memory",initialValue:e.value}})]),domModification:e.domModification}}}),JR=o([Dt("tabs"),Dt("dom"),zt("clickToDismiss",!1),Fu("tabbarBehaviours",[nd,$f]),Da(["tabClass","selectedClass"])]),QR=mc({factory:ZR,name:"tabs",unit:"tab",overrides:function(e){var n=function(e,t){nd.dehighlight(e,t),So(e,Do(),{tabbar:e,button:t})},o=function(e,t){nd.highlight(e,t),So(e,Io(),{tabbar:e,button:t})};return{action:function(i){var r=i.getSystem().getByUid(e.uid).getOrDie(),a=nd.isHighlighted(r,i);(a&&e.clickToDismiss?n:a?t:o)(r,i)},domModification:{classes:[e.markers.tabClass]}}}}),eS=o([QR]),tS=Vc({name:"Tabbar",configFields:JR(),partFields:eS(),factory:function(e,t,n,o){return{uid:e.uid,dom:e.dom,components:t,"debug.sketcher":"Tabbar",domModification:{attributes:{role:"tablist"}},behaviours:Vu(e.tabbarBehaviours,[nd.config({highlightClass:e.markers.selectedClass,itemClass:e.markers.tabClass,onHighlight:function(e,t){Ci(t.element(),"aria-selected","true")},onDehighlight:function(e,t){Ci(t.element(),"aria-selected","false")}}),$f.config({mode:"flow",getInitial:function(e){return nd.getHighlighted(e).map((function(e){return e.element()}))},selector:"."+e.markers.tabClass,executeOnMove:!0})])}}}),nS=zc({name:"Tabview",configFields:[Fu("tabviewBehaviours",[Xf])],factory:function(e,t){return{uid:e.uid,dom:e.dom,behaviours:Vu(e.tabviewBehaviours,[Xf.config({})]),domModification:{attributes:{role:"tabpanel"}}}}}),oS=o([zt("selectFirst",!0),wa("onChangeTab"),wa("onDismissTab"),zt("tabs",[]),Fu("tabSectionBehaviours",[])]),iS=fc({factory:tS,schema:[Dt("dom"),kt("markers",[Dt("tabClass"),Dt("selectedClass")])],name:"tabbar",defaults:function(e){return{tabs:e.tabs}}}),rS=fc({factory:nS,name:"tabview"}),aS=o([iS,rS]),sS=Vc({name:"TabSection",configFields:oS(),partFields:aS(),factory:function(e,t,n,o){var i=function(t,n){Dc(t,e,"tabbar").each((function(e){n(e).each(ko)}))};return{uid:e.uid,dom:e.dom,components:t,behaviours:zu(e.tabSectionBehaviours),events:Ko(Y([e.selectFirst?[Uo((function(e,t){i(e,nd.getFirst)}))]:[],[Bo(Io(),(function(t,n){var o,i,r=n.event().button();i=Bu.getValue(o=r),Dc(o,e,"tabview").each((function(t){G(e.tabs,(function(e){return e.value===i})).each((function(n){var i=n.view();xi(o.element(),"id").each((function(e){Ci(t.element(),"aria-labelledby",e)})),Xf.set(t,i),e.onChangeTab(t,o,i)}))}))})),Bo(Do(),(function(t,n){var o=n.event().button();e.onDismissTab(t,o)}))]])),apis:{getViewItems:function(t){return Dc(t,e,"tabview").map((function(e){return Xf.contents(e)})).getOr([])},showTab:function(e,t){i(e,(function(e){var n=nd.getCandidates(e);return G(n,(function(e){return Bu.getValue(e)===t})).filter((function(t){return!nd.isHighlighted(e,t)}))}))}}}},apis:{getViewItems:function(e,t){return e.getViewItems(t)},showTab:function(e,t,n){e.showTab(t,n)}}}),lS=function(e,t){mr(e,"height",t+"px"),wn().browser.isIE()?xr(e,"flex-basis"):mr(e,"flex-basis",t+"px")},uS=function(t,n,o){ca(t,'[role="dialog"]').each((function(t){da(t,'[role="tablist"]').each((function(i){o.get().map((function(o){return mr(n,"height","0"),mr(n,"flex-basis","0"),Math.min(o,function(t,n,o){var i,r=oi(t).dom(),a=ca(t,".tox-dialog-wrap").getOr(t);i="fixed"===yr(a,"position")?Math.max(r.clientHeight,e.window.innerHeight):Math.max(r.offsetHeight,r.scrollHeight);var s=Mr(n),l=n.dom().offsetLeft>=o.dom().offsetLeft+Hr(o)?Math.max(Mr(o),s):s,u=parseInt(yr(t,"margin-top"),10)||0,c=parseInt(yr(t,"margin-bottom"),10)||0;return i-(Mr(t)+u+c-l)}(t,n,i))})).each((function(e){lS(n,e)}))}))}))},cS=function(e){return da(e,'[role="tabpanel"]')},dS=function(e){var t;return{smartTabHeight:(t=Xt(E.none()),{extraEvents:[Uo((function(n){var o=n.element();cS(o).each((function(i){var r;mr(i,"visibility","hidden"),n.getSystem().getByDom(i).toOption().each((function(n){var o,r,a,s=(r=i,a=n,H(o=e,(function(e,t){Xf.set(a,o[t].view());var n=r.dom().getBoundingClientRect();return Xf.set(a,[]),n.height}))),l=ne(te(s,(function(e,t){return t<e?-1:e<t?1:0})));t.set(l)})),uS(o,i,t),xr(i,"visibility"),r=n,ne(e).each((function(e){return sS.showTab(r,e.value)})),Gh.requestAnimationFrame((function(){uS(o,i,t)}))}))})),Bo(yo(),(function(e){var n=e.element();cS(n).each((function(e){uS(n,e,t)}))})),Bo(zv,(function(e,n){var o=e.element();cS(o).each((function(e){var n=Is();mr(e,"visibility","hidden");var i=Cr(e,"height").map((function(e){return parseInt(e,10)}));xr(e,"height"),xr(e,"flex-basis");var r=e.dom().getBoundingClientRect().height;i.forall((function(e){return e<r}))?(t.set(E.from(r)),uS(o,e,t)):i.each((function(t){lS(e,t)})),xr(e,"visibility"),n.each(_s)}))}))],selectFirst:!1}),naiveTabHeight:{extraEvents:[],selectFirst:!0}}},fS="send-data-to-section",hS="send-data-to-view",gS=Ri("update-dialog"),mS=Ri("update-title"),pS=Ri("update-body"),vS=Ri("update-footer"),yS=Ri("body-send-message"),bS=function(t,n,o,i){return{dom:{tag:"div",classes:["tox-dialog__content-js"],attributes:f(f({},n.map((function(e){return{id:e}})).getOr({})),i?{"aria-live":"polite"}:{})},components:[],behaviours:gs([OC(0),nI.config({channel:pS,updateState:function(e,t){return E.some({isTabPanel:function(){return"tabpanel"===t.body.type}})},renderComponents:function(t){switch(t.body.type){case"tabpanel":return[(a=t.body,l=o,u=Xt({}),c=function(e){var t=Bu.getValue(e),n=YR(t).getOr({}),o=u.get(),i=Ne(o,n);u.set(i)},d=function(e){var t=u.get();Bu.setValue(e,t)},f=Xt(null),h=H(a.tabs,(function(e){return{value:e.name,dom:{tag:"div",classes:["tox-dialog__body-nav-item"],innerHtml:l.shared.providers.translate(e.title)},view:function(){return[CC.sketch((function(t){return{dom:{tag:"div",classes:["tox-form"]},components:H(e.items,(function(e){return Yx(t,e,l)})),formBehaviours:gs([$f.config({mode:"acyclic",useTabstopAt:s(WC)}),Yf("TabView.form.events",[Uo(d),qo(c)]),xs.config({channels:Ue([{key:fS,value:{onReceive:c}},{key:hS,value:{onReceive:d}}])})])}}))]}}})),g=dS(h).smartTabHeight,sS.sketch({dom:{tag:"div",classes:["tox-dialog__body"]},onChangeTab:function(e,t,n){var o=Bu.getValue(t);So(e,Fv,{name:o,oldName:f.get()}),f.set(o)},tabs:h,components:[sS.parts().tabbar({dom:{tag:"div",classes:["tox-dialog__body-nav"]},components:[tS.parts().tabs({})],markers:{tabClass:"tox-tab",selectedClass:"tox-dialog__body-nav-item--active"},tabbarBehaviours:gs([Ov.config({})])}),sS.parts().tabview({dom:{tag:"div",classes:["tox-dialog__body-content"]}})],selectFirst:g.selectFirst,tabSectionBehaviours:gs([Yf("tabpanel",g.extraEvents),$f.config({mode:"acyclic"}),qc.config({find:function(e){return ne(sS.getViewItems(e))}}),Bu.config({store:{mode:"manual",getValue:function(e){return e.getSystem().broadcastOn([fS],{}),u.get()},setValue:function(e,t){u.set(t),e.getSystem().broadcastOn([hS],{})}}})])}))];default:return[(n=t.body,i=o,{dom:{tag:"div",classes:["tox-dialog__body"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-content"]},components:[(r=Yh(CC.sketch((function(e){return{dom:{tag:"div",classes:["tox-form"].concat(n.classes)},components:H(n.items,(function(t){return Yx(e,t,i)}))}})))).asSpec()]}],behaviours:gs([$f.config({mode:"acyclic",useTabstopAt:s(WC)}),DC(r),NC(r,{postprocess:function(t){return YR(t).fold((function(t){return e.console.error(t),{}}),(function(e){return e}))}})])})]}var n,i,r,a,l,u,c,d,f,h,g},initialData:t})])}},CS=tp.deviceType.isTouch(),TS=function(e,t){return{dom:{tag:"div",styles:{display:"none"},classes:["tox-dialog__header"]},components:[e,t]}},xS=function(e,t){return kw.parts().close(Xh.sketch({dom:{tag:"button",classes:["tox-button","tox-button--icon","tox-button--naked"],attributes:{type:"button","aria-label":t.translate("Close")}},action:e,buttonBehaviours:gs([Ov.config({})])}))},ES=function(){return kw.parts().title({dom:{tag:"div",classes:["tox-dialog__title"],innerHtml:"",styles:{display:"none"}}})},_S=function(e,t){return kw.parts().body({dom:{tag:"div",classes:["tox-dialog__body"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-content"]},components:[{dom:GD("<p>"+t.translate(e)+"</p>")}]}]})},IS=function(e){return kw.parts().footer({dom:{tag:"div",classes:["tox-dialog__footer"]},components:e})},DS=function(e,t){return[Cv.sketch({dom:{tag:"div",classes:["tox-dialog__footer-start"]},components:e}),Cv.sketch({dom:{tag:"div",classes:["tox-dialog__footer-end"]},components:t})]},OS=function(e){var t,n="tox-dialog",o=n+"-wrap",i=o+"__backdrop",r=n+"__disable-scroll";return kw.sketch({lazySink:e.lazySink,onEscape:function(t){return e.onEscape(t),E.some(!0)},useTabstopAt:function(e){return!WC(e)},dom:{tag:"div",classes:[n].concat(e.extraClasses),styles:f({position:"relative"},e.extraStyles)},components:g([e.header,e.body],e.footer.toArray()),parts:{blocker:{dom:GD('<div class="'+o+'"></div>'),components:[{dom:{tag:"div",classes:CS?[i,i+"--opaque"]:[i]}}]}},dragBlockClass:o,modalBehaviours:gs(g([th.config({}),Yf("dialog-events",e.dialogEvents.concat([$o(jn(),(function(e,t){$f.focusIn(e)}))])),Yf("scroll-lock",[Uo((function(){Qi(dr(),r)})),qo((function(){er(dr(),r)}))])],e.extraBehaviours)),eventOrder:f(((t={})[so()]=["dialog-events"],t[bo()]=["scroll-lock","dialog-events","alloy.base.behaviour"],t[Co()]=["alloy.base.behaviour","dialog-events","scroll-lock"],t),e.eventOrder)})},wS=function(e){return Xh.sketch({dom:{tag:"button",classes:["tox-button","tox-button--icon","tox-button--naked"],attributes:{type:"button","aria-label":e.translate("Close"),title:e.translate("Close")}},components:[{dom:{tag:"div",classes:["tox-icon"],innerHtml:'<svg width="24" height="24" xmlns="http://www.w3.org/2000/svg"><path d="M17.953 7.453L13.422 12l4.531 4.547-1.406 1.406L12 13.422l-4.547 4.531-1.406-1.406L10.578 12 6.047 7.453l1.406-1.406L12 10.578l4.547-4.531z" fill-rule="evenodd"></path></svg>'}}],action:function(e){Ro(e,Mv)}})},RS=function(e,t,n){var o=function(e){return[Or(n.translate(e.title))]};return{dom:{tag:"div",classes:["tox-dialog__title"],attributes:f({},t.map((function(e){return{id:e}})).getOr({}))},components:o(e),behaviours:gs([nI.config({channel:mS,renderComponents:o})])}},SS=function(){return{dom:GD('<div class="tox-dialog__draghandle"></div>')}},kS=function(e,t){return n={title:t.shared.providers.translate(e),draggable:t.dialog.isDraggableModal()},o=t.shared.providers,i=kw.parts().title(RS(n,E.none(),o)),r=kw.parts().draghandle(SS()),a=kw.parts().close(wS(o)),s=[i].concat(n.draggable?[r]:[]).concat([a]),Cv.sketch({dom:GD('<div class="tox-dialog__header"></div>'),components:s});var n,o,i,r,a,s},AS=function(e,t){return{onClose:function(){return t.closeWindow()},onBlock:function(t){kw.setBusy(e(),(function(e,n){return{dom:{tag:"div",classes:["tox-dialog__busy-spinner"],attributes:{"aria-label":t.message()},styles:{left:"0px",right:"0px",bottom:"0px",top:"0px",position:"absolute"}},behaviours:n,components:[{dom:GD('<div class="tox-spinner"><div></div><div></div><div></div></div>')}]}}))},onUnblock:function(){kw.setIdle(e())}}},NS=function(e,t,n,o){var i;return Sr(OS(f(f({},e),{lazySink:o.shared.getSink,extraBehaviours:g([nI.config({channel:gS,updateState:function(e,t){return E.some(t)},initialData:t}),PC({})],e.extraBehaviours),onEscape:function(e){Ro(e,Mv)},dialogEvents:n,eventOrder:((i={})[ao()]=["reflecting","receiving"],i[bo()]=["scroll-lock","reflecting","messages","dialog-events","alloy.base.behaviour"],i[Co()]=["alloy.base.behaviour","dialog-events","messages","reflecting","scroll-lock"],i)})))},MS=function(e){return H(e,(function(e){return"menu"===e.type?(n=H((t=e).items,(function(e){var t=Xt(!1);return f(f({},e),{storage:t})})),f(f({},t),{items:n})):e;var t,n}))},KS=function(e){return j(e,(function(e,t){return"menu"!==t.type?e:j(t.items,(function(e,t){return e[t.name]=t.storage,e}),e)}),{})},PS=function(e,t){return[Ho(jn(),HC),e(Nv,(function(e,n){t.onClose(),n.onClose()})),e(Mv,(function(e,t,n,o){t.onCancel(e),Ro(o,Nv)})),Bo(Bv,(function(e,n){return t.onUnblock()})),Bo(Lv,(function(e,n){return t.onBlock(n.event())}))]},LS=function(e,t){var n=function(t,n){return Bo(t,(function(t,i){o(t,(function(o,r){n(e(),o,i.event(),t)}))}))},o=function(e,t){nI.getState(e).get().each((function(n){t(n,e)}))};return g(PS(n,t),[n(Kv,(function(e,t,n){t.onAction(e,{name:n.name()})}))])},BS=function(e,t,n){var o=function(t,n){return Bo(t,(function(t,o){i(t,(function(i,r){n(e(),i,o.event(),t)}))}))},i=function(e,t){nI.getState(e).get().each((function(n){t(n.internalDialog,e)}))};return g(PS(o,t),[o(Pv,(function(e,t){return t.onSubmit(e)})),o(Av,(function(e,t,n){t.onChange(e,{name:n.name()})})),o(Kv,(function(e,t,o,i){var r=function(){return $f.focusIn(i)},a=function(e){return Ei(e,"disabled")||xi(e,"aria-disabled").exists((function(e){return"true"===e}))},s=Is();t.onAction(e,{name:o.name(),value:o.value()}),Is().fold(r,(function(e){a(e)||s.exists((function(t){return An(e,t)&&a(t)}))?r():n().toOption().filter((function(t){return!An(t.element(),e)})).each(r)}))})),o(Fv,(function(e,t,n){t.onTabChange(e,{newTabName:n.name(),oldTabName:n.oldName()})})),qo((function(t){var n=e();Bu.setValue(t,n.getData())}))])},FS=function(e,t){var n=t.map((function(e){return e.footerButtons})).getOr([]),o=$(n,(function(e){return"start"===e.align})),i=function(e,t){return Cv.sketch({dom:{tag:"div",classes:["tox-dialog__footer-"+e]},components:H(t,(function(e){return e.memento.asSpec()}))})};return[i("start",o.pass),i("end",o.fail)]},zS=function(e,t){return{dom:GD('<div class="tox-dialog__footer"></div>'),components:[],behaviours:gs([nI.config({channel:vS,initialData:e,updateState:function(e,n){var o=H(n.buttons,(function(e){var n,o=Yh(YT(n=e,n.type,t));return{name:e.name,align:e.align,memento:o}}));return E.some({lookupByName:function(e,t){return n=e,i=t,G(o,(function(e){return e.name===i})).bind((function(e){return e.memento.getOpt(n)}));var n,i},footerButtons:o})},renderComponents:FS})])}},VS=function(e,t){return kw.parts().footer(zS(e,t))},HS=function(e,t){if(e.getRoot().getSystem().isConnected()){var n=qc.getCurrent(e.getFormWrapper()).getOr(e.getFormWrapper());return CC.getField(n,t).fold((function(){var o=e.getFooter();return nI.getState(o).get().bind((function(e){return e.lookupByName(n,t)}))}),(function(e){return E.some(e)}))}return E.none()},WS=function(e,t,n){var o=function(t){var n=e.getRoot();n.getSystem().isConnected()&&t(n)},i={getData:function(){var t=e.getRoot(),o=t.getSystem().isConnected()?e.getFormWrapper():t,i=Bu.getValue(o),r=xe(n,(function(e){return e.get()}));return f(f({},i),r)},setData:function(t){o((function(o){var r,a,s=i.getData(),l=f(f({},s),t),u=(r=l,a=e.getRoot(),nI.getState(a).get().map((function(e){return ft(dt("data",e.dataValidator,r))})).getOr(r)),c=e.getFormWrapper();Bu.setValue(c,u),Te(n,(function(e,t){we(l,t)&&e.set(l[t])}))}))},disable:function(t){HS(e,t).each(pm.disable)},enable:function(t){HS(e,t).each(pm.enable)},focus:function(t){HS(e,t).each(th.focus)},block:function(e){if(!D(e))throw new Error("The dialogInstanceAPI.block function should be passed a blocking message of type string as an argument");o((function(t){So(t,Lv,{message:e})}))},unblock:function(){o((function(e){Ro(e,Bv)}))},showTab:function(t){o((function(n){var o=e.getBody();nI.getState(o).get().exists((function(e){return e.isTabPanel()}))&&qc.getCurrent(o).each((function(e){sS.showTab(e,t)}))}))},redial:function(e){o((function(n){var o=t(e);n.getSystem().broadcastOn([gS],o),n.getSystem().broadcastOn([mS],o.internalDialog),n.getSystem().broadcastOn([pS],o.internalDialog),n.getSystem().broadcastOn([vS],o.internalDialog),i.setData(o.initialData)}))},close:function(){o((function(e){Ro(e,Nv)}))}};return i},$S=tinymce.util.Tools.resolve("tinymce.util.URI"),US=["insertContent","setContent","execCommand","close","block","unblock"],qS=function(e){return O(e)&&-1!==US.indexOf(e.mceAction)};d.add("silver",(function(t){var n=Ow(t),i=n.uiMothership,r=n.backstage,a=n.renderUI,l=n.getUi;!function(t,n){var o=Xt(E.none()),i=Xt(!1),r=Sr(Ph.sketch({dom:{tag:"div",classes:["tox-autocompleter"]},components:[],fireDismissalEventInstead:{},inlineBehaviours:gs([Yf("dismissAutocompleter",[Bo(To(),(function(){return l()}))])]),lazySink:n.getSink})),a=function(){return o.get().isSome()},s=function(){a()&&Ph.hide(r)},l=function(){if(a()){var e=o.get().map((function(e){return e.element}));ig(e.getOr(en(t.selection.getNode()))).each(pi),s(),o.set(E.none()),i.set(!1)}},u=Ke((function(){return function(e){var t,n,o=e.ui.registry.getAll().popups,i=xe(o,(function(e){return dt("Autocompleter",pg,e).fold((function(e){throw new Error(gt(e))}),(function(e){return e}))})),r=(t=_e(i,(function(e){return e.ch})),n={},W(t,(function(e){n[e]={}})),be(n)),a=De(i);return{dataset:i,triggerChars:r,lookupByChar:function(e){return U(a,(function(t){return t.ch===e}))}}}(t)})),c=function(d){var f;f=d,o.get().map((function(e){return lg(t.dom,t.selection.getRng(),e.triggerChar).bind((function(e){return hg(t,u,e,f)}))})).getOrThunk((function(){return function(e,t){var n,o,i=t(),r=e.selection.getRng();return n=e.dom,o=r,re(i.triggerChars,(function(e){return lg(n,o,e)})).bind((function(n){return hg(e,t,n)}))}(t,u)})).fold(l,(function(u){!function(e){if(!a()){var n=function(e,t){return ig(en(e.selection.getNode())).getOrThunk((function(){var n=Zt('<span data-mce-autocompleter="1" data-mce-bogus="1"></span>',e.getDoc());return fi(n,en(t.extractContents())),t.insertNode(n.dom()),ri(n).each((function(e){return e.dom().normalize()})),function(e,t){var n=function(e){for(var o=si(e),i=o.length-1;0<=i;i--){var r=o[i];if(t(r))return E.some(r);var a=n(r);if(a.isSome())return a}return E.none()};return n(e)}(n,gl).map((function(t){var n;e.selection.setCursorLocation(t.dom(),"img"===Xo(n=t)?1:fl(n).fold((function(){return si(n).length}),(function(e){return e.length})))})),n}))}(t,e.range);o.set(E.some({triggerChar:e.triggerChar,element:n,matchLength:e.text.length})),i.set(!1)}}(u.context),u.lookupData.then((function(a){o.get().map((function(o){var d,f,h,g=u.context;if(o.triggerChar===g.triggerChar){var m=(d=g.triggerChar,h=re(f=a,(function(e){return E.from(e.columns)})).getOr(1),Z(f,(function(o){return function(e,t,n,o,i,r){var a=1===o,s=!a||Kg(e);return Hc(H(e,(function(e){return"separator"===e.type?dt("Autocompleter.Separator",gg,e).fold(Pg,(function(e){return E.some(Qp(e))})):dt("Autocompleter.Item",mg,e).fold(Pg,(function(e){return E.some(function(e,t,n,o,i,r,a,s){void 0===s&&(s=!0);var l,u,c=up({presets:"normal",textContent:E.none(),htmlContent:n?e.text.map((function(e){return function(e,t){var n=nm.translate(e),o=tm.DOM.encode(n);if(0<t.length){var i=new RegExp(t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"gi");return o.replace(i,(function(e){return'<span class="tox-autocompleter-highlight">'+e+"</span>"}))}return o}(e,t)})):E.none(),ariaLabel:e.text,iconContent:e.icon,shortcutContent:E.none(),checkMark:E.none(),caret:E.none(),value:e.value},a.providers,s,e.icon);return Qm({data:ep(e),disabled:e.disabled,getApi:function(){return{}},onAction:function(t){return i(e.value,e.meta)},onSetup:function(){return function(){}},triggersSubmenu:!1,itemBehaviours:(l=e.meta,u=a,Oe(l,"tooltipWorker").map((function(e){return[em.config({lazySink:u.getSink,tooltipDom:{tag:"div",classes:["tox-tooltip-worker-container"]},tooltipComponents:[],anchor:function(e){return{anchor:"submenu",item:e,overrides:{maxHeightFunction:Vs}}},mode:"follow-highlight",onShow:function(t,n){e((function(e){em.setComponents(t,[wr({element:en(e)})])}))}})]})).getOr([]))},c,r,a.providers)}(e,t,a,0,n,i,r,s))}))})))}(o.items,o.matchText,(function(n,r){var a=t.selection.getRng();lg(t.dom,a,d).fold((function(){return e.console.error("Lost context. Cursor probably moved")}),(function(e){var t=e.range,a={hide:function(){l()},reload:function(e){s(),c(e)}};i.set(!0),o.onAction(a,t,n,r),i.set(!1)}))}),h,bg.BUBBLE_TO_SANDBOX,n)})));0<m.length?function(e,n,o,i){e.matchLength=n.text.length;var a,s,l,u,c,d,f,h=re(o,(function(e){return E.from(e.columns)})).getOr(1);Ph.showAt(r,{anchor:"node",root:en(t.getBody()),node:E.from(e.element)},Sh.sketch((a=Bg("autocompleter-value",!0,i,h,"normal"),s=h,u="normal",c=((l=km.ContentFocus)===km.ContentFocus?md:gd)(),d=Zp(s,u),f=Rg(u),{dom:a.dom,components:a.components,items:a.items,value:a.value,markers:{selectedItem:f.selectedItem,item:f.item},movement:d,fakeFocus:l===km.ContentFocus,focusManager:c,menuBehaviours:qg("auto"!==s?[]:[Uo((function(e,t){Ug(e,4,f.item).each((function(t){$f.setGridSize(e,t.numRows,t.numColumns)}))}))])}))),Ph.getContent(r).each(nd.highlightFirst)}(o,g,a,m):(10<=g.text.length-o.matchLength?l:s)()}}))}))}))};!function(e,t){t.on("keypress compositionend",e.onKeypress.throttle),t.on("remove",e.onKeypress.cancel);var n=function(e,t){So(e,Xn(),{raw:t})};t.on("keydown",(function(t){var o=function(){return e.getView().bind(nd.getHighlighted)};8===t.which&&e.onKeypress.throttle(t),e.isActive()&&(27===t.which&&e.cancelIfNecessary(),e.isMenuOpen()?13===t.which?(o().each(ko),t.preventDefault()):40===t.which?(o().fold((function(){e.getView().each(nd.highlightFirst)}),(function(e){n(e,t)})),t.preventDefault(),t.stopImmediatePropagation()):37!==t.which&&38!==t.which&&39!==t.which||o().each((function(e){n(e,t),t.preventDefault(),t.stopImmediatePropagation()})):13!==t.which&&38!==t.which&&40!==t.which||e.cancelIfNecessary())})),t.on("NodeChange",(function(t){e.isActive()&&!e.isProcessingAction()&&ig(en(t.element)).isNone()&&e.cancelIfNecessary()}))}({onKeypress:tg((function(e){27!==e.which&&c()}),50),cancelIfNecessary:l,isMenuOpen:function(){return Ph.isOpen(r)},isActive:a,isProcessingAction:i.get,getView:function(){return Ph.getContent(r)}},t)}(t,r.shared);var u=function(t){var n,o,i,r,a=t.backstage,l=t.editor,u=Bm(l),c=(o=(n=t).backstage.shared,{open:function(e,t){var i=function(){kw.hide(l),t()},r=Yh(YT({name:"close-alert",text:"OK",primary:!0,align:"end",disabled:!1,icon:E.none()},"cancel",n.backstage)),a=ES(),s=xS(i,o.providers),l=Sr(OS({lazySink:function(){return o.getSink()},header:TS(a,s),body:_S(e,o.providers),footer:E.some(IS(DS([],[r.asSpec()]))),onEscape:i,extraClasses:["tox-alert-dialog"],extraBehaviours:[],extraStyles:{},dialogEvents:[Bo(Mv,i)],eventOrder:{}}));kw.show(l);var u=r.get(l);th.focus(u)}}),d=(r=(i=t).backstage.shared,{open:function(e,t){var n=function(e){kw.hide(u),t(e)},o=Yh(YT({name:"yes",text:"Yes",primary:!0,align:"end",disabled:!1,icon:E.none()},"submit",i.backstage)),a=YT({name:"no",text:"No",primary:!1,align:"end",disabled:!1,icon:E.none()},"cancel",i.backstage),s=ES(),l=xS((function(){return n(!1)}),r.providers),u=Sr(OS({lazySink:function(){return r.getSink()},header:TS(s,l),body:_S(e,r.providers),footer:E.some(IS(DS([],[a,o.asSpec()]))),onEscape:function(){return n(!1)},extraClasses:["tox-confirm-dialog"],extraBehaviours:[],extraStyles:{},dialogEvents:[Bo(Mv,(function(){return n(!1)})),Bo(Pv,(function(){return n(!0)}))],eventOrder:{}}));kw.show(u);var c=o.get(u);th.focus(c)}}),h=function(e,t,n,o){return XR.open((function(e,i,r){var s,c,d,h=ft(dt("data",r,i)),m=(s=Xt(E.none()),{clear:function(){s.set(E.none())},set:function(e){s.set(E.some(e))},isSet:function(){return s.get().isSome()},on:function(e){s.get().each(e)}}),p=a.shared.header.isPositionedAtTop(),v=function(){return m.on((function(e){Ph.reposition(e),xD.refresh(e)}))},y=function(e,t,n,o){var i,r,a,s,l,u,c,d=Ri("dialog-label"),f=Ri("dialog-content"),h=Yh((a={title:e.internalDialog.title,draggable:!0},s=d,l=n.shared.providers,Cv.sketch({dom:GD('<div class="tox-dialog__header"></div>'),components:[RS(a,E.some(s),l),SS(),wS(l)],containerBehaviours:gs([Cw.config({mode:"mouse",blockerClass:"blocker",getTarget:function(e){return fa(e,'[role="dialog"]').getOrDie()},snaps:{getSnapPoints:function(){return[]},leftAttr:"data-drag-left",topAttr:"data-drag-top"}})])}))),g=Yh((u=n,c=o,bS({body:e.internalDialog.body},E.some(f),u,c))),m=MS(e.internalDialog.buttons),p=KS(m),v=Yh(zS({buttons:m},n)),y=BS((function(){return C}),{onBlock:function(){},onUnblock:function(){},onClose:function(){return t.closeWindow()}},n.shared.getSink),b=Sr({dom:{tag:"div",classes:["tox-dialog","tox-dialog-inline"],attributes:((i={role:"dialog"})["aria-labelledby"]=d,i["aria-describedby"]=""+f,i)},eventOrder:((r={})[ao()]=[nI.name(),xs.name()],r[so()]=["execute-on-form"],r[bo()]=["reflecting","execute-on-form"],r),behaviours:gs([$f.config({mode:"cyclic",onEscape:function(e){return Ro(e,Nv),E.some(!0)},useTabstopAt:function(e){return!WC(e)&&("button"!==Xo(e)||"disabled"!==Ti(e,"disabled"))}}),nI.config({channel:gS,updateState:function(e,t){return E.some(t)},initialData:e}),th.config({}),Yf("execute-on-form",y.concat([$o(jn(),(function(e,t){$f.focusIn(e)}))])),PC({})]),components:[h.asSpec(),g.asSpec(),v.asSpec()]}),C=WS({getRoot:function(){return b},getFooter:function(){return v.get(b)},getBody:function(){return g.get(b)},getFormWrapper:function(){var e=g.get(b);return qc.getCurrent(e).getOr(e)}},t.redial,p);return{dialog:b,instanceApi:C}}({dataValidator:r,initialData:h,internalDialog:e},{redial:XR.redial,closeWindow:function(){m.on(Ph.hide),l.off("ResizeEditor",v),m.clear(),n(y.instanceApi)}},a,o),b=Sr(Ph.sketch(f(f({lazySink:a.shared.getSink,dom:{tag:"div",classes:[]},fireDismissalEventInstead:{}},p?{}:{fireRepositionEventInstead:{}}),{inlineBehaviours:gs(g([Yf("window-manager-inline-events",[Bo(To(),(function(e,t){Ro(y.dialog,Mv)}))])],(c=l,d=p,u&&d?[]:[xD.config({contextual:{lazyContext:function(){return E.some(ta(en(c.getContentAreaContainer())))},fadeInClass:"tox-dialog-dock-fadein",fadeOutClass:"tox-dialog-dock-fadeout",transitionClass:"tox-dialog-dock-transition"},modes:["top"]})]))),isExtraPart:function(e,t){return av(n=t,".tox-alert-dialog")||av(n,".tox-confirm-dialog");var n}})));return m.set(b),Ph.showWithin(b,t,kr(y.dialog),E.some(dr())),u&&p||(xD.refresh(b),l.on("ResizeEditor",v)),y.instanceApi.setData(h),$f.focusIn(y.dialog),y.instanceApi}),e)};return{open:function(e,t,n){return void 0!==t&&"toolbar"===t.inline?h(e,a.shared.anchors.inlineDialog(),n,t.ariaAttrs):void 0!==t&&"cursor"===t.inline?h(e,a.shared.anchors.cursor(),n,t.ariaAttrs):function(e,t){return XR.open((function(e,n,o){var i=n,r=function(e,t,n){var o,i,r=kS(e.internalDialog.title,n),a=(o=n,i=bS({body:e.internalDialog.body},E.none(),o,!1),kw.parts().body(i)),s=MS(e.internalDialog.buttons),l=KS(s),u=VS({buttons:s},n),c=BS((function(){return g}),AS((function(){return h}),t),n.shared.getSink),d="normal"!==e.internalDialog.size?"large"===e.internalDialog.size?["tox-dialog--width-lg"]:["tox-dialog--width-md"]:[],f={header:r,body:a,footer:E.some(u),extraClasses:d,extraBehaviours:[],extraStyles:{}},h=NS(f,e,c,n),g=WS({getRoot:function(){return h},getBody:function(){return kw.getBody(h)},getFooter:function(){return kw.getFooter(h)},getFormWrapper:function(){var e=kw.getBody(h);return qc.getCurrent(e).getOr(e)}},t.redial,l);return{dialog:h,instanceApi:g}}({dataValidator:o,initialData:i,internalDialog:e},{redial:XR.redial,closeWindow:function(){kw.hide(r.dialog),t(r.instanceApi)}},a);return kw.show(r.dialog),r.instanceApi.setData(i),r.instanceApi}),e)}(e,n)},openUrl:function(t,n){return function(t,n){return XR.openUrl((function(t){var o=function(t,n,o,i){var r,a,l,u,c=kS(t.title,i),d=(a={dom:{tag:"div",classes:["tox-dialog__content-js"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-iframe"]},components:[zC({dom:{tag:"iframe",attributes:{src:t.url}},behaviours:gs([Ov.config({}),th.config({})])})]}],behaviours:gs([$f.config({mode:"acyclic",useTabstopAt:s(WC)})])},kw.parts().body(a)),h=t.buttons.bind((function(e){return 0===e.length?E.none():E.some(VS({buttons:e},i))})),g=LS((function(){return x}),AS((function(){return T}),n)),m=f(f({},t.height.fold((function(){return{}}),(function(e){return{height:e+"px","max-height":e+"px"}}))),t.width.fold((function(){return{}}),(function(e){return{width:e+"px","max-width":e+"px"}}))),p=t.width.isNone()&&t.height.isNone()?["tox-dialog--width-lg"]:[],v=new $S(t.url,{base_uri:new $S(e.window.location.href)}),y=v.protocol+"://"+v.host+(v.port?":"+v.port:""),b=Xt(E.none()),C=[Yf("messages",[Uo((function(){var n=ov(en(e.window),"message",(function(e){if(v.isSameOrigin(new $S(e.raw().origin))){var n=e.raw().data;qS(n)?function(e,t,n){switch(n.mceAction){case"insertContent":e.insertContent(n.content);break;case"setContent":e.setContent(n.content);break;case"execCommand":var o=!!R(n.ui)&&n.ui;e.execCommand(n.cmd,o,n.value);break;case"close":t.close();break;case"block":t.block(n.message);break;case"unblock":t.unblock()}}(o,x,n):!qS(i=n)&&O(i)&&we(i,"mceAction")&&t.onMessage(x,n)}var i}));b.set(E.some(n))})),qo((function(){b.get().each((function(e){return e.unbind()}))}))]),xs.config({channels:((r={})[yS]={onReceive:function(e,t){da(e.element(),"iframe").each((function(e){e.dom().contentWindow.postMessage(t,y)}))}},r)})],T=NS({header:c,body:d,footer:h,extraClasses:p,extraBehaviours:C,extraStyles:m},t,g,i),x=(u=function(e){l.getSystem().isConnected()&&e(l)},{block:function(e){if(!D(e))throw new Error("The urlDialogInstanceAPI.block function should be passed a blocking message of type string as an argument");u((function(t){So(t,Lv,{message:e})}))},unblock:function(){u((function(e){Ro(e,Bv)}))},close:function(){u((function(e){Ro(e,Nv)}))},sendMessage:function(e){u((function(t){t.getSystem().broadcastOn([yS],e)}))}});return{dialog:l=T,instanceApi:x}}(t,{closeWindow:function(){kw.hide(o.dialog),n(o.instanceApi)}},l,a);return kw.show(o.dialog),o.instanceApi}),t)}(t,n)},alert:function(e,t){c.open(e,(function(){t()}))},close:function(e){e.close()},confirm:function(e,t){d.open(e,(function(e){t(e)}))}}}({editor:t,backstage:r});return{renderUI:a,getWindowManagerImpl:o(u),getNotificationManagerImpl:function(){return function(e,t,n){var o=t.backstage;return{open:function(e,i){var r=!e.closeButton&&e.timeout&&(0<e.timeout||e.timeout<0),a=function(){i(),Ph.hide(l)},s=Sr(eg.sketch({text:e.text,level:B(["success","error","warning","warn","info"],e.type)?e.type:void 0,progress:!0===e.progressBar,icon:E.from(e.icon),closeButton:!r,onAction:a,iconProvider:o.shared.providers.icons,translationProvider:o.shared.providers.translate})),l=Sr(Ph.sketch(f({dom:{tag:"div",classes:["tox-notifications-container"]},lazySink:t.backstage.shared.getSink,fireDismissalEventInstead:{}},o.shared.header.isPositionedAtTop()?{}:{fireRepositionEventInstead:{}})));return n.add(l),0<e.timeout&&Gh.setTimeout((function(){a()}),e.timeout),{close:a,moveTo:function(e,t){Ph.showAt(l,{anchor:"makeshift",x:e,y:t},kr(s))},moveRel:function(e,n){if("banner"!==n){var o=function(e){switch(e){case"bc-bc":return jh;case"tc-tc":return qh;case"tc-bc":return ns;case"bc-tc":default:return os}}(n),i={anchor:"node",root:dr(),node:E.some(en(e)),layouts:{onRtl:function(){return[o]},onLtr:function(){return[o]}}};Ph.showAt(l,i,kr(s))}else Ph.showAt(l,t.backstage.shared.anchors.banner(),kr(s))},text:function(e){eg.updateText(s,e)},settings:e,getEl:function(){return s.element().dom()},progressBar:{value:function(e){eg.updateProgress(s,e)}}}},close:function(e){e.close()},reposition:function(e){var t;W(e,(function(e){return e.moveTo(0,0)})),0<(t=e).length&&(ne(t).each((function(e){return e.moveRel(null,"banner")})),W(t,(function(e,n){0<n&&e.moveRel(t[n-1].getEl(),"bc-tc")})))},getArgs:function(e){return e.settings}}}(0,{backstage:r},i)},ui:l()}}))}(window),function(e){"use strict";var t,n,o,i,r=tinymce.util.Tools.resolve("tinymce.PluginManager"),a=tinymce.util.Tools.resolve("tinymce.util.VK"),s=function(e){return function(t){return o=typeof(n=t),(null===n?"null":"object"==o&&(Array.prototype.isPrototypeOf(n)||n.constructor&&"Array"===n.constructor.name)?"array":"object"==o&&(String.prototype.isPrototypeOf(n)||n.constructor&&"String"===n.constructor.name)?"string":o)===e;var n,o}},l=function(e){return function(t){return typeof t===e}},u=s("string"),c=s("array"),d=function(e){return t===e},f=l("boolean"),h=l("function"),g=function(e){var t=e.getParam("link_assume_external_targets",!1);return f(t)&&t?1:!u(t)||"http"!==t&&"https"!==t?0:t},m=function(e){return e.getParam("default_link_target")},p=function(e){return e.getParam("target_list",!0)},v=function(e){return e.getParam("rel_list",[],"array")},y=function(e){return e.getParam("allow_unsafe_link_target",!1,"boolean")},b=function(){},C=function(e){return function(){return e}},T=C(!1),x=C(!(t=null)),E=function(){return _},_=(n=function(e){return e.isNone()},{fold:function(e,t){return e()},is:T,isSome:T,isNone:x,getOr:i=function(e){return e},getOrThunk:o=function(e){return e()},getOrDie:function(e){throw new Error(e||"error: getOrDie called on none.")},getOrNull:C(null),getOrUndefined:C(void 0),or:i,orThunk:o,map:E,each:b,bind:E,exists:T,forall:x,filter:E,equals:n,equals_:n,toArray:function(){return[]},toString:C("none()")}),I=function(e){var t=C(e),n=function(){return i},o=function(t){return t(e)},i={fold:function(t,n){return n(e)},is:function(t){return e===t},isSome:x,isNone:T,getOr:t,getOrThunk:t,getOrDie:t,getOrNull:t,getOrUndefined:t,or:n,orThunk:n,map:function(t){return I(t(e))},each:function(t){t(e)},bind:o,exists:o,forall:o,filter:function(t){return t(e)?i:_},toArray:function(){return[e]},toString:function(){return"some("+e+")"},equals:function(t){return t.is(e)},equals_:function(t,n){return t.fold(T,(function(t){return n(e,t)}))}};return i},D={some:I,none:E,from:function(e){return null==e?_:I(e)}},O=Array.prototype.indexOf,w=Array.prototype.push,R=function(e){for(var t=[],n=0,o=e.length;n<o;++n){if(!c(e[n]))throw new Error("Arr.flatten item "+n+" was not an array, input: "+e);w.apply(t,e[n])}return t},S=function(e,t){for(var n=0;n<e.length;n++){var o=t(e[n],n);if(o.isSome())return o}return D.none()},k=function(e,t){return e?D.some(t):D.none()},A=tinymce.util.Tools.resolve("tinymce.util.Tools"),N=function(e){return u(e.value)?e.value:""},M=function(e){return void 0===e&&(e=N),function(t){return D.from(t).map((function(t){return n=e,o=[],A.each(t,(function(e){var t=u(e.text)?e.text:u(e.title)?e.title:"";if(void 0===e.menu){var i=n(e);o.push({text:t,value:i})}})),o;var n,o}))}},K=function(e){return M(N)(e)},P=M,L=function(e,t){return function(n){return{name:e,type:"selectbox",label:t,items:n}}},B=N,F=function(){return(F=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},z=Object.keys,V=function(e){return!(!/(^|[ ,])rtc([, ]|$)/.test(e.getParam("plugins","","string"))||!r.get("rtc"))},H=function(e){return/^\w+:/i.test(e)},W=function(e){return e.getAttribute("data-mce-href")||e.getAttribute("href")},$=function(e,t){var n,o=["noopener"],i=e?e.split(/\s+/):[],r=function(e){return e.filter((function(e){return-1===A.inArray(o,e)}))},a=t?0<(n=r(n=i)).length?n.concat(o):o:r(i);return 0<a.length?A.trim(a.sort().join(" ")):""},U=function(e,t){return t=t||e.selection.getNode(),Y(t)?e.dom.select("a[href]",t)[0]:e.dom.getParent(t,"a[href]")},q=function(e,t){return(t?t.innerText||t.textContent:e.getContent({format:"text"})).replace(/\uFEFF/g,"")},j=function(e){return e&&"A"===e.nodeName&&!!W(e)},G=function(e){return 0<A.grep(e,j).length},X=function(e){return!(/</.test(e)&&(!/^<a [^>]+>[^<]+<\/a>$/.test(e)||-1===e.indexOf("href=")))},Y=function(e){return e&&"FIGURE"===e.nodeName&&/\bimage\b/i.test(e.className)},Z=function(e,t,n){var o,i,r,a,s,l,u;V(e)?e.execCommand("createlink",!1,(i=(o=n).class,r=o.href,a=o.rel,s=o.target,l=o.text,u=o.title,function(e,t){var n,o={};return function(e,t,n,o){!function(e,t){for(var n=z(e),o=0,i=n.length;o<i;o++){var r=n[o];t(e[r],r)}}(e,(function(e,i){(t(e,i)?n:o)(e,i)}))}(e,(function(e,t){return!1===d(e)}),(n=o,function(e,t){n[t]=e}),b),o}({class:i.getOrNull(),href:r,rel:a.getOrNull(),target:s.getOrNull(),text:l.getOrNull(),title:u.getOrNull()}))):function(e,t,n){var o=e.selection.getNode(),i=U(e,o),r=function(e,t){var n,o,i=F({},t);if(!(0<v(e).length)&&!1===y(e)){var r=$(i.rel,"_blank"===i.target);i.rel=r||null}return D.from(i.target).isNone()&&!1===p(e)&&(i.target=m(e)),i.href=(n=i.href,"http"!==(o=g(e))&&"https"!==o||H(n)?n:o+"://"+n),i}(e,function(e){return t=function(t,n){return e[n].each((function(e){t[n]=0<e.length?e:null})),t},n={href:e.href},function(e,t){for(var n=0,o=e.length;n<o;n++)t(e[n])}(["title","rel","class","target"],(function(e){n=t(n,e)})),n;var t,n}(n));e.undoManager.transact((function(){var a,s,l,u,c,d,f;n.href===t.href&&t.attach(),i?(e.focus(),c=e,d=i,f=r,n.text.each((function(e){d.hasOwnProperty("innerText")?d.innerText=e:d.textContent=e})),c.dom.setAttribs(d,f),c.selection.select(d)):(a=e,l=n.text,u=r,Y(s=o)?ee(a,s,u):l.fold((function(){a.execCommand("mceInsertLink",!1,u)}),(function(e){a.insertContent(a.dom.createHTML("a",u,a.dom.encode(e)))})))}))}(e,t,n)},J=function(e){var t;V(e)?e.execCommand("unlink"):(t=e).undoManager.transact((function(){var e=t.selection.getNode();if(Y(e))Q(t,e);else{var n=t.dom.getParent(e,"a[href]",t.getBody());n&&t.dom.remove(n,!0)}t.focus()}))},Q=function(e,t){var n=e.dom.select("img",t)[0];if(n){var o=e.dom.getParents(n,"a[href]",t)[0];o&&(o.parentNode.insertBefore(n,o),e.dom.remove(o))}},ee=function(e,t,n){var o=e.dom.select("img",t)[0];if(o){var i=e.dom.create("a",n);o.parentNode.insertBefore(i,o),i.appendChild(o)}},te=tinymce.util.Tools.resolve("tinymce.util.Delay"),ne=tinymce.util.Tools.resolve("tinymce.util.Promise"),oe=function(e){var t=e.href;return 0<t.indexOf("@")&&-1===t.indexOf("/")&&-1===t.indexOf("mailto:")?D.some({message:"The URL you entered seems to be an email address. Do you want to add the required mailto: prefix?",preprocess:function(e){return F(F({},e),{href:"mailto:"+t})}}):D.none()},ie=function(e,t){return S([oe,(n=g(e),o=e.getParam("link_default_protocol","http","string"),function(e){var t=e.href;return 1===n&&!H(t)||0===n&&/^\s*www[\.|\d\.]/i.test(t)?D.some({message:"The URL you entered seems to be an external link. Do you want to add the required "+o+":// prefix?",preprocess:function(e){return F(F({},e),{href:o+"://"+t})}}):D.none()})],(function(e){return e(t)})).fold((function(){return ne.resolve(t)}),(function(n){return new ne((function(o){var i,r,a,s;r=n.message,a=function(e){o(e?n.preprocess(t):t)},s=(i=e).selection.getRng(),te.setEditorTimeout(i,(function(){i.windowManager.confirm(r,(function(e){i.selection.setRng(s),a(e)}))}))}))}));var n,o},re=function(e){var t=function(e,t){return R(function(e,t){for(var n=e.length,o=new Array(n),i=0;i<n;i++)o[i]=t(e[i]);return o}(e,(function(e){var t=e.name||e.id;return t?[{text:t,value:"#"+t}]:[]})))}(e.dom.select("a:not([href])"));return 0<t.length?D.some([{text:"None",value:""}].concat(t)):D.none()},ae=function(e){var t=e.getParam("link_class_list",[],"array");return 0<t.length?K(t):D.none()},se=tinymce.util.Tools.resolve("tinymce.util.XHR"),le=function(e,t){var n=v(e);if(0<n.length){var o=t.is("_blank");return(!1===y(e)?P((function(e){return $(B(e),o)})):K)(n)}return D.none()},ue=[{text:"Current window",value:""},{text:"New window",value:"_blank"}],ce=function(e){var t=p(e);return c(t)?K(t).orThunk((function(){return D.some(ue)})):!1===t?D.none():D.some(ue)},de=function(e,t,n){var o=e.getAttrib(t,n);return null!==o&&0<o.length?D.some(o):D.none()},fe=function(e,t){return e.dom.getParent(t,"a[href]")},he=function(e){return fe(e,e.selection.getStart())},ge=function(t,n){if(n){var o=W(n);if(/^#/.test(o)){var i=t.$(o);i.length&&t.selection.scrollIntoView(i[0],!0)}else!function(t){var n=e.document.createElement("a");n.target="_blank",n.href=t,n.rel="noreferrer noopener";var o,i,r=e.document.createEvent("MouseEvents");r.initMouseEvent("click",!0,!0,e.window,0,0,0,0,0,!1,!1,!1,!1,0,null),i=r,e.document.body.appendChild(o=n),o.dispatchEvent(i),e.document.body.removeChild(o)}(n.href)}},me=function(e){return function(){!function(e){var t,n;(n=U(t=e),function(e,t){return function(e){var t=function(t){return e.convertURL(t.value||t.url,"href")},n=e.getParam("link_list");return new ne((function(e){u(n)?se.send({url:n,success:function(t){return e(function(t){try{return D.some(JSON.parse(t))}catch(e){return D.none()}}(t))},error:function(t){return e(D.none())}}):h(n)?n((function(t){return e(D.some(t))})):e(D.from(n))})).then((function(e){return e.bind(P(t)).map((function(e){return 0<e.length?[{text:"None",value:""}].concat(e):e}))}))}(e).then((function(n){var o,i,r,a,s,l,u,c,d=(i=t,r=(o=e).dom,a=X(o.selection.getContent())?D.some(q(o.selection,i)):D.none(),s=i?D.some(r.getAttrib(i,"href")):D.none(),l=i?D.from(r.getAttrib(i,"target")):D.none(),u=de(r,i,"rel"),c=de(r,i,"class"),{url:s,text:a,title:de(r,i,"title"),target:l,rel:u,linkClass:c});return{anchor:d,catalogs:{targets:ce(e),rels:le(e,d.target),classes:ae(e),anchor:re(e),link:n},optNode:D.from(t),flags:{titleEnabled:e.getParam("link_title",!0,"boolean")}}}))}(t,n)).then((function(t){var n,o,i,r,a,s,l,u,c,d,f,h,g;return r=function(e){var t=e.getData();if(!t.url.value)return J(n),void e.close();var i=function(e){return D.from(t[e]).filter((function(t){return!o.anchor[e].is(t)}))},r={href:t.url.value,text:i("text"),target:i("target"),rel:i("rel"),class:i("linkClass"),title:i("title")},a={href:t.url.value,attach:void 0!==t.url.meta&&t.url.meta.attach?t.url.meta.attach:function(){}};ie(n,r).then((function(e){Z(n,a,e)})),e.close()},a=n=e,c=(i=o=t).anchor.text.map((function(){return{name:"text",type:"input",label:"Text to display"}})).toArray(),d=i.flags.titleEnabled?[{name:"title",type:"input",label:"Title"}]:[],s=D.from(m(a)),f={url:{value:u=(l=i.anchor).url.getOr(""),meta:{original:{value:u}}},text:l.text.getOr(""),title:l.title.getOr(""),anchor:u,link:u,rel:l.rel.getOr(""),target:l.target.or(s).getOr(""),linkClass:l.linkClass.getOr("")},g=function(e,t){var n={text:e.text,title:e.title};return{onChange:function(e,o){var i=o.name;return"url"===i?function(e){var t,o=k(n.text.length<=0,D.from((t=e.url).meta.text).getOr(t.value)),i=k(n.title.length<=0,D.from(e.url.meta.title).getOr(""));return o.isSome()||i.isSome()?D.some(F(F({},o.map((function(e){return{text:e}})).getOr({})),i.map((function(e){return{title:e}})).getOr({}))):D.none()}(e()):function(e,t){return-1<O.call(["anchor","link"],t)}(0,i)?function(e,o){var i,r,a=(i=t,("link"===(r=o.name)?i.link:"anchor"===r?i.anchor:D.none()).getOr([]));return function(e,t,n,o){var i,r=o[t],a=0<e.length;return void 0!==r?(i=r,S(n,(function(e){return k(e.value===i,e)})).map((function(t){return{url:{value:t.value,meta:{text:a?e:t.text,attach:b}},text:a?e:t.text}}))):D.none()}(n.text,o.name,a,e)}(e(),o):(("text"===i||"title"===i)&&(n[i]=e()[i]),D.none())}}}(f,h=i.catalogs),{title:"Insert/Edit Link",size:"normal",body:{type:"panel",items:R([[{name:"url",type:"urlinput",filetype:"file",label:"URL"}],c,d,function(e){for(var t=[],n=function(e){t.push(e)},o=0;o<e.length;o++)e[o].each(n);return t}([h.anchor.map(L("anchor","Anchors")),h.rels.map(L("rel","Rel")),h.targets.map(L("target","Open link in...")),h.link.map(L("link","Link list")),h.classes.map(L("linkClass","Class"))])])},buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:f,onChange:function(e,t){g.onChange(e.getData,{name:t.name}).each((function(t){e.setData(t)}))},onSubmit:r}})).then((function(t){e.windowManager.open(t)}))}(e)}},pe=function(e){return function(){ge(e,he(e))}},ve=function(e){e.on("click",(function(t){var n=fe(e,t.target);n&&a.metaKeyPressed(t)&&(t.preventDefault(),ge(e,n))})),e.on("keydown",(function(t){var n,o=he(e);o&&13===t.keyCode&&!0===(n=t).altKey&&!1===n.shiftKey&&!1===n.ctrlKey&&!1===n.metaKey&&(t.preventDefault(),ge(e,o))}))},ye=function(e){return function(t){var n=function(n){return t.setActive(!e.mode.isReadOnly()&&!!U(e,n.element))};return e.on("NodeChange",n),function(){return e.off("NodeChange",n)}}},be=function(e){return function(t){var n=e.dom.getParents(e.selection.getStart());t.setDisabled(!G(n));var o=function(e){return t.setDisabled(!G(e.parents))};return e.on("NodeChange",o),function(){return e.off("NodeChange",o)}}};r.add("link",(function(e){var t,n,o,i,r,a,s;(t=e).ui.registry.addToggleButton("link",{icon:"link",tooltip:"Insert/edit link",onAction:me(t),onSetup:ye(t)}),t.ui.registry.addButton("openlink",{icon:"new-tab",tooltip:"Open link",onAction:pe(t),onSetup:be(t)}),t.ui.registry.addButton("unlink",{icon:"unlink",tooltip:"Remove link",onAction:function(){return J(t)},onSetup:be(t)}),(n=e).ui.registry.addMenuItem("openlink",{text:"Open link",icon:"new-tab",onAction:pe(n),onSetup:be(n)}),n.ui.registry.addMenuItem("link",{icon:"link",text:"Link...",shortcut:"Meta+K",onAction:me(n)}),n.ui.registry.addMenuItem("unlink",{icon:"unlink",text:"Remove link",onAction:function(){return J(n)},onSetup:be(n)}),(o=e).ui.registry.addContextMenu("link",{update:function(e){return G(o.dom.getParents(e,"a"))?"link unlink openlink":"link"}}),r=function(e){var t=i.selection.getNode();return e.setDisabled(!U(i,t)),function(){}},(i=e).ui.registry.addContextForm("quicklink",{launch:{type:"contextformtogglebutton",icon:"link",tooltip:"Link",onSetup:ye(i)},label:"Link",predicate:function(e){return!!U(i,e)&&i.getParam("link_context_toolbar",!1,"boolean")},initValue:function(){var e=U(i);return e?W(e):""},commands:[{type:"contextformtogglebutton",icon:"link",tooltip:"Link",primary:!0,onSetup:function(e){var t=i.selection.getNode();return e.setActive(!!U(i,t)),ye(i)(e)},onAction:function(e){var t=U(i),n=e.getValue();if(t)i.undoManager.transact((function(){i.dom.setAttrib(t,"href",n),i.selection.collapse(!1),e.hide()}));else{var o={href:n,attach:function(){}},r=X(i.selection.getContent())?D.some(q(i.selection,t)).filter((function(e){return 0<e.length})).or(D.from(n)):D.none();Z(i,o,{href:n,text:r,title:D.none(),rel:D.none(),target:D.none(),class:D.none()}),e.hide()}}},{type:"contextformbutton",icon:"unlink",tooltip:"Remove link",onSetup:r,onAction:function(e){J(i),e.hide()}},{type:"contextformbutton",icon:"new-tab",tooltip:"Open link",onSetup:r,onAction:function(e){pe(i)(),e.hide()}}]}),ve(e),(a=e).addCommand("mceLink",(function(){a.getParam("link_quicklink",!1,"boolean")?a.fire("contexttoolbar-show",{toolbarKey:"quicklink"}):me(a)()})),(s=e).addShortcut("Meta+K","",(function(){s.execCommand("mceLink")}))}))}(window),function(e){"use strict";var t,n,o,i=function(e){var t=e;return{get:function(){return t},set:function(e){t=e}}},r=tinymce.util.Tools.resolve("tinymce.PluginManager"),a=function(e,t){return e.fire("PastePlainTextToggle",{state:t})},s=function(e,t){e.addCommand("mceTogglePlainTextPaste",(function(){var n,o;n=e,"text"===(o=t).pasteFormat.get()?(o.pasteFormat.set("html"),a(n,!1)):(o.pasteFormat.set("text"),a(n,!0)),n.focus()})),e.addCommand("mceInsertClipboardContent",(function(e,n){n.content&&t.pasteHtml(n.content,n.internal),n.text&&t.pasteText(n.text)}))},l=function(e){return function(){return e}},u=l(!1),c=l(!0),d=function(){return f},f=(t=function(e){return e.isNone()},{fold:function(e,t){return e()},is:u,isSome:u,isNone:c,getOr:o=function(e){return e},getOrThunk:n=function(e){return e()},getOrDie:function(e){throw new Error(e||"error: getOrDie called on none.")},getOrNull:l(null),getOrUndefined:l(void 0),or:o,orThunk:n,map:d,each:function(){},bind:d,exists:u,forall:c,filter:d,equals:t,equals_:t,toArray:function(){return[]},toString:l("none()")}),h=function(e){var t=l(e),n=function(){return i},o=function(t){return t(e)},i={fold:function(t,n){return n(e)},is:function(t){return e===t},isSome:c,isNone:u,getOr:t,getOrThunk:t,getOrDie:t,getOrNull:t,getOrUndefined:t,or:n,orThunk:n,map:function(t){return h(t(e))},each:function(t){t(e)},bind:o,exists:o,forall:o,filter:function(t){return t(e)?i:f},toArray:function(){return[e]},toString:function(){return"some("+e+")"},equals:function(t){return t.is(e)},equals_:function(t,n){return t.fold(u,(function(t){return n(e,t)}))}};return i},g={some:h,none:d,from:function(e){return null==e?f:h(e)}},m=Array.prototype.slice,p=function(e,t){for(var n=e.length,o=new Array(n),i=0;i<n;i++)o[i]=t(e[i],i);return o},v=function(e,t){for(var n=0,o=e.length;n<o;n++)t(e[n],n)},y="function"==typeof Array.from?Array.from:function(e){return m.call(e)},b=tinymce.util.Tools.resolve("tinymce.Env"),C=tinymce.util.Tools.resolve("tinymce.util.Delay"),T=tinymce.util.Tools.resolve("tinymce.util.Promise"),x=tinymce.util.Tools.resolve("tinymce.util.VK"),E=function(e){return e.getParam("paste_data_images",!1)},_=function(e){return e.getParam("paste_retain_style_properties")},I=function(e){return e.getParam("validate")},D=function(e){return e.getParam("paste_data_images",!1,"boolean")},O="x-tinymce/html",w="\x3c!-- "+O+" --\x3e",R=function(e){return-1!==e.indexOf(w)},S=tinymce.util.Tools.resolve("tinymce.util.Tools"),k=tinymce.util.Tools.resolve("tinymce.html.Entities"),A=tinymce.util.Tools.resolve("tinymce.html.DomParser"),N=tinymce.util.Tools.resolve("tinymce.html.Serializer"),M=" ",K=tinymce.util.Tools.resolve("tinymce.html.Node"),P=tinymce.util.Tools.resolve("tinymce.html.Schema");function L(e,t){return S.each(t,(function(t){e=t.constructor===RegExp?e.replace(t,""):e.replace(t[0],t[1])})),e}function B(e){return L(e,[/^[\s\S]*<body[^>]*>\s*|\s*<\/body[^>]*>[\s\S]*$/gi,/<!--StartFragment-->|<!--EndFragment-->/g,[/( ?)<span class="Apple-converted-space">\u00a0<\/span>( ?)/g,function(e,t,n){return t||n?M:" "}],/<br class="Apple-interchange-newline">/g,/<br>$/i])}function F(e){return/<font face="Times New Roman"|class="?Mso|style="[^"]*\bmso-|style='[^'']*\bmso-|w:WordDocument/i.test(e)||/class="OutlineElement/.test(e)||/id="?docs\-internal\-guid\-/.test(e)}function z(e){var t;return e=e.replace(/^[\u00a0 ]+/,""),S.each([/^[IVXLMCD]{1,2}\.[ \u00a0]/,/^[ivxlmcd]{1,2}\.[ \u00a0]/,/^[a-z]{1,2}[\.\)][ \u00a0]/,/^[A-Z]{1,2}[\.\)][ \u00a0]/,/^[0-9]+\.[ \u00a0]/,/^[\u3007\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u4e03\u516b\u4e5d]+\.[ \u00a0]/,/^[\u58f1\u5f10\u53c2\u56db\u4f0d\u516d\u4e03\u516b\u4e5d\u62fe]+\.[ \u00a0]/],(function(n){if(n.test(e))return!(t=!0)})),t}function V(e,t,n,o){var i,r={},a=e.dom.parseStyle(o);return S.each(a,(function(a,s){switch(s){case"mso-list":(i=/\w+ \w+([0-9]+)/i.exec(o))&&(n._listLevel=parseInt(i[1],10)),/Ignore/i.test(a)&&n.firstChild&&(n._listIgnore=!0,n.firstChild._listIgnore=!0);break;case"horiz-align":s="text-align";break;case"vert-align":s="vertical-align";break;case"font-color":case"mso-foreground":s="color";break;case"mso-background":case"mso-highlight":s="background";break;case"font-weight":case"font-style":return void("normal"!==a&&(r[s]=a));case"mso-element":if(/^(comment|comment-list)$/i.test(a))return void n.remove()}0!==s.indexOf("mso-comment")?0!==s.indexOf("mso-")&&("all"===_(e)||t&&t[s])&&(r[s]=a):n.remove()})),/(bold)/i.test(r["font-weight"])&&(delete r["font-weight"],n.wrap(new K("b",1))),/(italic)/i.test(r["font-style"])&&(delete r["font-style"],n.wrap(new K("i",1))),(r=e.dom.serializeStyle(r,n.name))||null}var H=function(e,t){return{content:e,cancelled:t}},W=function(e,t){return e.insertContent(t,{merge:e.getParam("paste_merge_formats",!0),paste:!0}),!0},$=function(e){return/^https?:\/\/[\w\?\-\/+=.&%@~#]+$/i.test(e)},U=function(e){return $(e)&&/.(gif|jpe?g|png)$/.test(e)},q=function(e,t,n){return!(!1!==e.selection.isCollapsed()||!$(t)||(i=t,r=n,(o=e).undoManager.extra((function(){r(o,i)}),(function(){o.execCommand("mceInsertLink",!1,i)})),0));var o,i,r},j=function(e,t,n){return!!U(t)&&(i=t,r=n,(o=e).undoManager.extra((function(){r(o,i)}),(function(){o.insertContent('<img src="'+i+'">')})),!0);var o,i,r},G=function(e){return"\n"===e||"\r"===e},X=function(e,t,n,o){var i,r,a,s,l=(a=n,function(e,t,n,o){var i,r,a,s,l,u=e.fire("PastePreProcess",{content:t,internal:n,wordContent:o}),c=function(e,t){var n=A({},e.schema);n.addNodeFilter("meta",(function(e){S.each(e,(function(e){return e.remove()}))}));var o=n.parse(t,{forced_root_block:!1,isRootContent:!0});return N({validate:I(e)},e.schema).serialize(o)}(e,u.content);return e.hasEventListeners("PastePostProcess")&&!u.isDefaultPrevented()?(r=n,a=o,s=(i=e).dom.create("div",{style:"display:none"},c),l=i.fire("PastePostProcess",{node:s,internal:r,wordContent:a}),H(l.node.innerHTML,l.isDefaultPrevented())):H(c,u.isDefaultPrevented())}(i=e,(s=F(r=t))?function(e,t){return e.getParam("paste_enable_default_filters",!0)?function(e,t){var n,o=_(e);o&&(n=S.makeMap(o.split(/[, ]/))),t=L(t,[/<br class="?Apple-interchange-newline"?>/gi,/<b[^>]+id="?docs-internal-[^>]*>/gi,/<!--[\s\S]+?-->/gi,/<(!|script[^>]*>.*?<\/script(?=[>\s])|\/?(\?xml(:\w+)?|img|meta|link|style|\w:\w+)(?=[\s\/>]))[^>]*>/gi,[/<(\/?)s>/gi,"<$1strike>"],[/&nbsp;/gi,M],[/<span\s+style\s*=\s*"\s*mso-spacerun\s*:\s*yes\s*;?\s*"\s*>([\s\u00a0]*)<\/span>/gi,function(e,t){return 0<t.length?t.replace(/./," ").slice(Math.floor(t.length/2)).split("").join(M):""}]]);var i=e.getParam("paste_word_valid_elements","-strong/b,-em/i,-u,-span,-p,-ol,-ul,-li,-h1,-h2,-h3,-h4,-h5,-h6,-p/div,-a[href|name],sub,sup,strike,br,del,table[width],tr,td[colspan|rowspan|width],th[colspan|rowspan|width],thead,tfoot,tbody"),r=P({valid_elements:i,valid_children:"-li[p]"});S.each(r.elements,(function(e){e.attributes.class||(e.attributes.class={},e.attributesOrder.push("class")),e.attributes.style||(e.attributes.style={},e.attributesOrder.push("style"))}));var a=A({},r);a.addAttributeFilter("style",(function(t){for(var o,i=t.length;i--;)(o=t[i]).attr("style",V(e,n,o,o.attr("style"))),"span"===o.name&&o.parent&&!o.attributes.length&&o.unwrap()})),a.addAttributeFilter("class",(function(e){for(var t,n,o=e.length;o--;)n=(t=e[o]).attr("class"),/^(MsoCommentReference|MsoCommentText|msoDel)$/i.test(n)&&t.remove(),t.attr("class",null)})),a.addNodeFilter("del",(function(e){for(var t=e.length;t--;)e[t].remove()})),a.addNodeFilter("a",(function(e){for(var t,n,o,i=e.length;i--;)if(n=(t=e[i]).attr("href"),o=t.attr("name"),n&&-1!==n.indexOf("#_msocom_"))t.remove();else if(n&&0===n.indexOf("file://")&&(n=(n=n.split("#")[1])&&"#"+n),n||o){if(o&&!/^_?(?:toc|edn|ftn)/i.test(o)){t.unwrap();continue}t.attr({href:n,name:o})}else t.unwrap()}));var s=a.parse(t);return e.getParam("paste_convert_word_fake_lists",!0)&&function(e){var t,n,o=1;function i(e){var t="";if(3===e.type)return e.value;if(e=e.firstChild)for(;t+=i(e),e=e.next;);return t}function r(e,t){if(3!==e.type||!t.test(e.value)){if(e=e.firstChild)do{if(!r(e,t))return}while(e=e.next);return 1}e.value=e.value.replace(t,"")}function a(e,i,a){var s=e._listLevel||o;s!==o&&(t=s<o?t&&t.parent.parent:(n=t,null)),t&&t.name===i?t.append(e):(n=n||t,t=new K(i,1),1<a&&t.attr("start",""+a),e.wrap(t)),e.name="li",o<s&&n&&n.lastChild.append(t),o=s,function e(t){if(t._listIgnore)t.remove();else if(t=t.firstChild)for(;e(t),t=t.next;);}(e),r(e,/^\u00a0+/),r(e,/^\s*([\u2022\u00b7\u00a7\u25CF]|\w+\.)/),r(e,/^\u00a0+/)}for(var s=[],l=e.firstChild;null!=l;)if(s.push(l),null!==(l=l.walk()))for(;void 0!==l&&l.parent!==e;)l=l.walk();for(var u=0;u<s.length;u++)if("p"===(e=s[u]).name&&e.firstChild){var c=i(e);if(/^[\s\u00a0]*[\u2022\u00b7\u00a7\u25CF]\s*/.test(c)){a(e,"ul");continue}if(z(c)){var d=/([0-9]+)\./.exec(c),f=1;d&&(f=parseInt(d[1],10)),a(e,"ol",f);continue}if(e._listLevel){a(e,"ul",1);continue}t=null}else n=t,t=null}(s),N({validate:I(e)},r).serialize(s)}(e,t):t}(i,r):r,a,s));!1===l.cancelled&&function(e,t,n){var o,i;n||!1===e.getParam("smart_paste",!0)?W(e,t):(o=e,i=t,S.each([q,j,W],(function(e){return!0!==e(o,i,W)})))}(e,l.content,o)},Y=function(e,t,n){var o=n||R(t);X(e,t.replace(w,""),o,!1)},Z=function(e,t){var n,o,i,r=e.dom.encode(t).replace(/\r\n/g,"\n"),a=function(e,t){var n,o,i,r=(n=e.getParam("paste_tab_spaces",4,"number"))<=0?"":new Array(n+1).join(" "),a=t.replace(/\t/g,r);return(i={pcIsSpace:!(o=function(e,t){return-1!==" \f\t\v".indexOf(t)||t===M?e.pcIsSpace||""===e.str||e.str.length===a.length-1||(o=e.str.length+1)<(n=a).length&&0<=o&&G(n[o])?{pcIsSpace:!1,str:e.str+M}:{pcIsSpace:!0,str:e.str+" "}:{pcIsSpace:G(t),str:e.str+t};var n,o}),str:""},v(a,(function(e){i=o(i,e)})),i).str}(e,r),s=(n=a,o=e.getParam("forced_root_block"),i=e.getParam("forced_root_block_attrs"),o?function(e,t,n){var o=e.split(/\n\n/),i=function(e,t){var n,o=[],i="<"+e;if("object"==typeof t){for(n in t)t.hasOwnProperty(n)&&o.push(n+'="'+k.encodeAllRaw(t[n])+'"');o.length&&(i+=" "+o.join(" "))}return i+">"}(t,n),r="</"+t+">",a=S.map(o,(function(e){return e.split(/\n/).join("<br />")}));return 1===a.length?a[0]:S.map(a,(function(e){return i+e+r})).join("")}(n,!0===o?"p":o,i):n.replace(/\r?\n/g,"<br>"));X(e,s,!1,!0)},J=function(e){var t={};if(e){if(e.getData){var n=e.getData("Text");n&&0<n.length&&-1===n.indexOf("data:text/mce-internal,")&&(t["text/plain"]=n)}if(e.types)for(var o=0;o<e.types.length;o++){var i=e.types[o];try{t[i]=e.getData(i)}catch(l){t[i]=""}}}return t},Q=function(e,t){return t in e&&0<e[t].length},ee=function(e){return Q(e,"text/html")||Q(e,"text/plain")},te=function(e){var t=0;return function(){return"mceclip"+t++}}(),ne=function(t,n,o){var i,r,a,s="paste"===n.type?n.clipboardData:n.dataTransfer;if(D(t)&&s){var l=(r=(i=s).items?p(y(i.items),(function(e){return e.getAsFile()})):[],a=i.files?y(i.files):[],function(e,t){for(var n=[],o=0,i=e.length;o<i;o++){var r=e[o];t(r)&&n.push(r)}return n}(0<r.length?r:a,(function(e){return/^image\/(jpeg|png|gif|bmp)$/.test(e.type)})));if(0<l.length)return n.preventDefault(),T.all(p(l,(function(e){return new T((function(t){var n=e.getAsFile?e.getAsFile():e,o=new window.FileReader;o.onload=function(){t({blob:n,uri:o.result})},o.readAsDataURL(n)}))}))).then((function(n){o&&t.selection.setRng(o),v(n,(function(n){!function(t,n){var o,i,r,a,s,l=(o=/data:([^;]+);base64,([a-z0-9\+\/=]+)/i.exec(n.uri))?{type:o[1],data:decodeURIComponent(o[2])}:{type:null,data:null},u=l.data,c=l.type,d=te(),f=t.getParam("images_reuse_filename")&&n.blob.name?(i=t,(r=n.blob.name.match(/([\s\S]+?)\.(?:jpeg|jpg|png|gif)$/i))?i.dom.encode(r[1]):null):d,h=new e.Image;if(h.src=n.uri,a=h,!(s=t.getParam("images_dataimg_filter"))||s(a)){var g=t.editorUpload.blobCache,m=void 0,p=g.getByData(u,c);p?m=p:(m=g.create(d,n.blob,u,f),g.add(m)),Y(t,'<img src="'+m.blobUri()+'">',!1)}else Y(t,'<img src="'+n.uri+'">',!1)}(t,n)}))})),!0}return!1},oe=function(e){return x.metaKeyPressed(e)&&86===e.keyCode||e.shiftKey&&45===e.keyCode},ie=function(t){return b.ie&&t.inline?e.document.body:t.getBody()},re=function(e){return e.dom.get("mcepastebin")},ae=function(e,t){var n,o=re(e);return(n=o)&&"mcepastebin"===n.id&&function(e,t){return t===e}(t,o.innerHTML)},se=function(e,t,n,o){!function(e,t,n){if(o=e,!1!==b.iOS||"function"!=typeof(null==o?void 0:o.setData))return!1;try{return e.clearData(),e.setData("text/html",t),e.setData("text/plain",n),e.setData(O,t),!0}catch(a){return!1}var o}(e.clipboardData,t.html,t.text)?n(t.html,o):(e.preventDefault(),o())},le=function(e){return function(t,n){var o=w+t,i=e.dom.create("div",{contenteditable:"false","data-mce-bogus":"all"}),r=e.dom.create("div",{contenteditable:"true"},o);e.dom.setStyles(i,{position:"fixed",top:"0",left:"-3000px",width:"1000px",overflow:"hidden"}),i.appendChild(r),e.dom.add(e.getBody(),i);var a=e.selection.getRng();r.focus();var s=e.dom.createRng();s.selectNodeContents(r),e.selection.setRng(s),C.setTimeout((function(){e.selection.setRng(a),i.parentNode.removeChild(i),n()}),0)}},ue=function(e){return{html:e.selection.getContent({contextual:!0}),text:e.selection.getContent({format:"text"})}},ce=function(e){return!e.selection.isCollapsed()||!!(t=e).dom.getParent(t.selection.getStart(),"td[data-mce-selected],th[data-mce-selected]",t.getBody());var t},de=tinymce.util.Tools.resolve("tinymce.dom.RangeUtils"),fe=function(e,t){return de.getCaretRangeFromPoint(t.clientX,t.clientY,e.getDoc())},he=function(e,t){e.focus(),e.selection.setRng(t)};function ge(e,t){e.on("PastePreProcess",(function(n){n.content=t(e,n.content,n.internal,n.wordContent)}))}function me(e,t){if(!F(t))return t;var n=[];return S.each(e.schema.getBlockElements(),(function(e,t){n.push(t)})),t=L(t,[[new RegExp("(?:<br>&nbsp;[\\s\\r\\n]+|<br>)*(<\\/?("+n.join("|")+")[^>]*>)(?:<br>&nbsp;[\\s\\r\\n]+|<br>)*","g"),"$1"]]),L(t,[[/<br><br>/g,"<BR><BR>"],[/<br>/g," "],[/<BR><BR>/g,"<br>"]])}function pe(e,t,n,o){if(o||n)return t;var i,r=e.getParam("paste_webkit_styles");if(!1===e.getParam("paste_remove_styles_if_webkit",!0)||"all"===r)return t;if(r&&(i=r.split(/[, ]/)),i){var a=e.dom,s=e.selection.getNode();t=t.replace(/(<[^>]+) style="([^"]*)"([^>]*>)/gi,(function(e,t,n,o){var r=a.parseStyle(a.decode(n)),l={};if("none"===i)return t+o;for(var u=0;u<i.length;u++){var c=r[i[u]],d=a.getStyle(s,i[u],!0);/color/.test(i[u])&&(c=a.toHex(c),d=a.toHex(d)),d!==c&&(l[i[u]]=c)}return(l=a.serializeStyle(l,"span"))?t+' style="'+l+'"'+o:t+o}))}else t=t.replace(/(<[^>]+) style="([^"]*)"([^>]*>)/gi,"$1$3");return t.replace(/(<[^>]+) data-mce-style="([^"]+)"([^>]*>)/gi,(function(e,t,n,o){return t+' style="'+n+'"'+o}))}function ve(e,t){e.$("a",t).find("font,u").each((function(t,n){e.dom.remove(n,!0)}))}var ye=function(e,t){return function(n){n.setActive("text"===t.pasteFormat.get());var o=function(e){return n.setActive(e.state)};return e.on("PastePlainTextToggle",o),function(){return e.off("PastePlainTextToggle",o)}}};r.add("paste",(function(t){if(0==!(!/(^|[ ,])powerpaste([, ]|$)/.test(t.getParam("plugins"))||!r.get("powerpaste")||(void 0!==e.window.console&&e.window.console.log&&e.window.console.log("PowerPaste is incompatible with Paste plugin! Remove 'paste' from the 'plugins' option."),0))){var n=i(!1),o=i(t.getParam("paste_as_text",!1)?"text":"html"),a=(f=o,h=function(e){var t=i(null),n="%MCEPASTEBIN%";return{create:function(){return function(e,t,n){var o=e.dom,i=e.getBody();t.set(e.selection.getRng());var r=e.dom.add(ie(e),"div",{id:"mcepastebin",class:"mce-pastebin",contentEditable:!0,"data-mce-bogus":"all",style:"position: fixed; top: 50%; width: 10px; height: 10px; overflow: hidden; opacity: 0"},"%MCEPASTEBIN%");(b.ie||b.gecko)&&o.setStyle(r,"left","rtl"===o.getStyle(i,"direction",!0)?65535:-65535),o.bind(r,"beforedeactivate focusin focusout",(function(e){e.stopPropagation()})),function(e,t,n){var o;ie(o=e)!==o.getBody()&&e.dom.bind(t,"paste keyup",(function(t){ae(e,"%MCEPASTEBIN%")||e.fire("paste")}))}(e,r),r.focus(),e.selection.select(r,!0)}(e,t)},remove:function(){return function(e,t){if(re(e)){for(var n=void 0,o=t.get();n=e.dom.get("mcepastebin");)e.dom.remove(n),e.dom.unbind(n);o&&e.selection.setRng(o)}t.set(null)}(e,t)},getEl:function(){return re(e)},getHtml:function(){return function(e){var t=function(t,n){t.appendChild(n),e.dom.remove(n,!0)},n=S.grep(ie(e).childNodes,(function(e){return"mcepastebin"===e.id})),o=n.shift();S.each(n,(function(e){t(o,e)}));for(var i=e.dom.select("div[id=mcepastebin]",o),r=i.length-1;0<=r;r--){var a=e.dom.create("div");o.insertBefore(a,i[r]),t(a,i[r])}return o?o.innerHTML:""}(e)},getLastRng:function(){return t.get()},isDefault:function(){return ae(e,n)},isDefaultContent:function(e){return e===n}}}(d=t),d.on("PreInit",(function(){return function(t,n,o){var r;(function(t,n,o){var r,a,s=(r=i(g.none()),{clear:function(){r.set(g.none())},set:function(e){r.set(g.some(e))},isSet:function(){return r.get().isSome()},on:function(e){r.get().each(e)}});function l(e,o,i,r){var a;Q(e,"text/html")?a=e["text/html"]:(a=n.getHtml(),r=r||R(a),n.isDefaultContent(a)&&(i=!0)),a=B(a),n.remove();var s=!1===r&&!/<(?:\/?(?!(?:div|p|br|span)>)\w+|(?:(?!(?:span style="white-space:\s?pre;?">)|br\s?\/>))\w+\s[^>]+)>/i.test(a),l=U(a);a.length&&(!s||l)||(i=!0),(i||l)&&(a=Q(e,"text/plain")&&s?e["text/plain"]:function(e){var t=P(),n=A({},t),o="",i=t.getShortEndedElements(),r=S.makeMap("script noscript style textarea video audio iframe object"," "),a=t.getBlockElements();return e=L(e,[/<!\[[^\]]+\]>/g]),function e(t){var n=t.name,s=t;if("br"!==n){if("wbr"!==n)if(i[n]&&(o+=" "),r[n])o+=" ";else{if(3===t.type&&(o+=t.value),!t.shortEnded&&(t=t.firstChild))for(;e(t),t=t.next;);a[n]&&s.next&&(o+="\n","p"===n&&(o+="\n"))}}else o+="\n"}(n.parse(e)),o}(a)),n.isDefaultContent(a)?o||t.windowManager.alert("Please use Ctrl+V/Cmd+V keyboard shortcuts to paste contents."):i?Z(t,a):Y(t,a,r)}t.on("keydown",(function(o){function i(e){oe(e)&&!e.isDefaultPrevented()&&n.remove()}if(oe(o)&&!o.isDefaultPrevented()){if((a=o.shiftKey&&86===o.keyCode)&&b.webkit&&-1!==e.navigator.userAgent.indexOf("Version/"))return;if(o.stopImmediatePropagation(),s.set(o),window.setTimeout((function(){s.clear()}),100),b.ie&&a)return o.preventDefault(),void t.fire("paste",{ieFake:!0});n.remove(),n.create(),t.once("keyup",i),t.once("paste",(function(){t.off("keyup",i)}))}})),t.on("paste",(function(i){var r,u=s.isSet(),c=J(i.clipboardData||t.getDoc().dataTransfer),d="text"===o.get()||a,f=Q(c,O);a=!1,i.isDefaultPrevented()||(r=i.clipboardData,-1!==e.navigator.userAgent.indexOf("Android")&&r&&r.items&&0===r.items.length)?n.remove():ee(c)||!ne(t,i,n.getLastRng()||t.selection.getRng())?(u||i.preventDefault(),!b.ie||u&&!i.ieFake||Q(c,"text/html")||(n.create(),t.dom.bind(n.getEl(),"paste",(function(e){e.stopPropagation()})),t.getDoc().execCommand("Paste",!1,null),c["text/html"]=n.getHtml()),Q(c,"text/html")?(i.preventDefault(),f=f||R(c["text/html"]),l(c,u,d,f)):C.setEditorTimeout(t,(function(){l(c,u,d,f)}),0)):n.remove()}))})(t,n,o),t.parser.addNodeFilter("img",(function(e,n,o){var i,a=function(e){e.attr("data-mce-object")||r===b.transparentSrc||e.remove()};if(!D(t)&&(i=o).data&&!0===i.data.paste)for(var s=e.length;s--;)(r=e[s].attr("src"))&&(0===r.indexOf("webkit-fake-url")?a(e[s]):t.getParam("allow_html_data_urls",!1,"boolean")||0!==r.indexOf("data:")||a(e[s]))}))}(d,h,f)})),{pasteFormat:f,pasteHtml:function(e,t){return Y(d,e,t)},pasteText:function(e){return Z(d,e)},pasteImageData:function(e,t){return ne(d,e,t)},getDataTransferItems:J,hasHtmlOrText:ee,hasContentType:Q}),l=function(e){b.webkit&&ge(e,pe),b.ie&&(ge(e,me),function(e,t){e.on("PastePostProcess",(function(n){t(e,n.node)}))}(e,ve))}(t);return(u=t).ui.registry.addToggleButton("pastetext",{active:!1,icon:"paste-text",tooltip:"Paste as text",onAction:function(){return u.execCommand("mceTogglePlainTextPaste")},onSetup:ye(u,c=a)}),u.ui.registry.addToggleMenuItem("pastetext",{text:"Paste as text",icon:"paste-text",onAction:function(){return u.execCommand("mceTogglePlainTextPaste")},onSetup:ye(u,c)}),s(t,a),function(e){var t=e.plugins.paste,n=e.getParam("paste_preprocess");n&&e.on("PastePreProcess",(function(e){n.call(t,t,e)}));var o=e.getParam("paste_postprocess");o&&e.on("PastePostProcess",(function(e){o.call(t,t,e)}))}(t),function(e){var t,n;e.on("cut",(t=e,function(e){ce(t)&&se(e,ue(t),le(t),(function(){if(b.browser.isChrome()){var e=t.selection.getRng();C.setEditorTimeout(t,(function(){t.selection.setRng(e),t.execCommand("Delete")}),0)}else t.execCommand("Delete")}))})),e.on("copy",(n=e,function(e){ce(n)&&se(e,ue(n),le(n),(function(){}))}))}(t),function(e,t,n){e.getParam("paste_block_drop",!1)&&e.on("dragend dragover draggesture dragdrop drop drag",(function(e){e.preventDefault(),e.stopPropagation()})),E(e)||e.on("drop",(function(e){var t=e.dataTransfer;t&&t.files&&0<t.files.length&&e.preventDefault()})),e.on("drop",(function(o){var i=fe(e,o);if(!o.isDefaultPrevented()&&!n.get()){var r,a=t.getDataTransferItems(o.dataTransfer),s=t.hasContentType(a,O);if((t.hasHtmlOrText(a)&&(!(r=a["text/plain"])||0!==r.indexOf("file://"))||!t.pasteImageData(o,i))&&i&&e.getParam("paste_filter_drop",!0)){var l=a["mce-internal"]||a["text/html"]||a["text/plain"];l&&(o.preventDefault(),C.setEditorTimeout(e,(function(){e.undoManager.transact((function(){a["mce-internal"]&&e.execCommand("Delete"),he(e,i),l=B(l),a["text/html"]?t.pasteHtml(l,s):t.pasteText(l)}))})))}}})),e.on("dragstart",(function(e){n.set(!0)})),e.on("dragover dragend",(function(t){E(e)&&!1===n.get()&&(t.preventDefault(),he(e,fe(e,t))),"dragend"===t.type&&n.set(!1)}))}(t,a,n),{clipboard:a,quirks:l}}var u,c,d,f,h}))}(window),function(e){"use strict";var t=tinymce.util.Tools.resolve("tinymce.PluginManager"),n=function(){},o=function(e){return function(){return e}},i=function(e){return e};function r(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return function(){for(var n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];var i=t.concat(n);return e.apply(null,i)}}var a,s,l,u,c=function(e){return function(t){return!e(t)}},d=o(!1),f=o(!0),h=function(){return g},g=(a=function(e){return e.isNone()},{fold:function(e,t){return e()},is:d,isSome:d,isNone:f,getOr:l=function(e){return e},getOrThunk:s=function(e){return e()},getOrDie:function(e){throw new Error(e||"error: getOrDie called on none.")},getOrNull:o(null),getOrUndefined:o(void 0),or:l,orThunk:s,map:h,each:n,bind:h,exists:d,forall:f,filter:h,equals:a,equals_:a,toArray:function(){return[]},toString:o("none()")}),m=function(e){var t=o(e),n=function(){return r},i=function(t){return t(e)},r={fold:function(t,n){return n(e)},is:function(t){return e===t},isSome:f,isNone:d,getOr:t,getOrThunk:t,getOrDie:t,getOrNull:t,getOrUndefined:t,or:n,orThunk:n,map:function(t){return m(t(e))},each:function(t){t(e)},bind:i,exists:i,forall:i,filter:function(t){return t(e)?r:g},toArray:function(){return[e]},toString:function(){return"some("+e+")"},equals:function(t){return t.is(e)},equals_:function(t,n){return t.fold(d,(function(t){return n(e,t)}))}};return r},p={some:m,none:h,from:function(e){return null==e?g:m(e)}},v=function(e){return function(t){return o=typeof(n=t),(null===n?"null":"object"==o&&(Array.prototype.isPrototypeOf(n)||n.constructor&&"Array"===n.constructor.name)?"array":"object"==o&&(String.prototype.isPrototypeOf(n)||n.constructor&&"String"===n.constructor.name)?"string":o)===e;var n,o}},y=function(e){return function(t){return typeof t===e}},b=v("string"),C=v("object"),T=v("array"),x=y("boolean"),E=function(e){return!(null===(t=e)||void 0===t);var t},_=y("function"),I=y("number"),D=Array.prototype.slice,O=Array.prototype.indexOf,w=Array.prototype.push,R=function(e,t){return-1<O.call(e,t)},S=function(e,t){for(var n=0,o=e.length;n<o;n++)if(t(e[n],n))return!0;return!1},k=function(e,t){for(var n=[],o=0;o<e;o++)n.push(t(o));return n},A=function(e,t){for(var n=e.length,o=new Array(n),i=0;i<n;i++)o[i]=t(e[i],i);return o},N=function(e,t){for(var n=0,o=e.length;n<o;n++)t(e[n],n)},M=function(e,t){for(var n=[],o=0,i=e.length;o<i;o++){var r=e[o];t(r,o)&&n.push(r)}return n},K=function(e,t,n){return function(e,t){for(var n=e.length-1;0<=n;n--)t(e[n])}(e,(function(e){n=t(n,e)})),n},P=function(e,t,n){return N(e,(function(e){n=t(n,e)})),n},L=function(e,t){return function(e,t,n){for(var o=0,i=e.length;o<i;o++){var r=e[o];if(t(r,o))return p.some(r);if(n(r,o))break}return p.none()}(e,t,d)},B=function(e,t){for(var n=0,o=e.length;n<o;n++)if(t(e[n],n))return p.some(n);return p.none()},F=function(e){for(var t=[],n=0,o=e.length;n<o;++n){if(!T(e[n]))throw new Error("Arr.flatten item "+n+" was not an array, input: "+e);w.apply(t,e[n])}return t},z=function(e,t){return F(A(e,t))},V=function(e,t){for(var n=0,o=e.length;n<o;++n)if(!0!==t(e[n],n))return!1;return!0},H=function(e){return 0===e.length?p.none():p.some(e[e.length-1])},W=function(e,t){for(var n=0;n<e.length;n++){var o=t(e[n],n);if(o.isSome())return o}return p.none()},$=Object.keys,U=Object.hasOwnProperty,q=function(e,t){for(var n=$(e),o=0,i=n.length;o<i;o++){var r=n[o];t(e[r],r)}},j=function(e,t){return G(e,(function(e,n){return{k:n,v:t(e,n)}}))},G=function(e,t){var n={};return q(e,(function(e,o){var i=t(e,o);n[i.k]=i.v})),n},X=function(e,t){return Y(e,t)?p.from(e[t]):p.none()},Y=function(e,t){return U.call(e,t)},Z=(void 0!==e.window||Function("return this;")(),function(e){return e.dom().nodeName.toLowerCase()}),J=function(e){return e.dom().nodeType},Q=function(e){return function(t){return J(t)===e}},ee=function(e){return 8===J(e)||"#comment"===Z(e)},te=Q(1),ne=Q(3),oe=Q(9),ie=Q(11),re=function(t,n,o){if(!(b(o)||x(o)||I(o)))throw e.console.error("Invalid call to Attr.set. Key ",n,":: Value ",o,":: Element ",t),new Error("Attribute value was not simple");t.setAttribute(n,o+"")},ae=function(e,t,n){re(e.dom(),t,n)},se=function(e,t){var n=e.dom();q(t,(function(e,t){re(n,t,e)}))},le=function(e,t){var n=e.dom().getAttribute(t);return null===n?void 0:n},ue=function(e,t){return p.from(le(e,t))},ce=function(e,t){var n=e.dom();return!(!n||!n.hasAttribute)&&n.hasAttribute(t)},de=function(e,t){e.dom().removeAttribute(t)},fe=function(e){return P(e.dom().attributes,(function(e,t){return e[t.name]=t.value,e}),{})},he=function(e,t,n){return""===t||e.length>=t.length&&e.substr(n,n+t.length)===t},ge=function(e,t){return-1!==e.indexOf(t)},me=function(e,t){return he(e,t,e.length-t.length)},pe=(u=/^\s+|\s+$/g,function(e){return e.replace(u,"")}),ve=function(e){return 0<e.length},ye=function(e){return void 0!==e.style&&_(e.style.getPropertyValue)},be=function(e){if(null==e)throw new Error("Node cannot be null or undefined");return{dom:o(e)}},Ce={fromHtml:function(t,n){var o=(n||e.document).createElement("div");if(o.innerHTML=t,!o.hasChildNodes()||1<o.childNodes.length)throw e.console.error("HTML does not have a single root node",t),new Error("HTML must have a single root node");return be(o.childNodes[0])},fromTag:function(t,n){var o=(n||e.document).createElement(t);return be(o)},fromText:function(t,n){var o=(n||e.document).createTextNode(t);return be(o)},fromDom:be,fromPoint:function(e,t,n){var o=e.dom();return p.from(o.elementFromPoint(t,n)).map(be)}},Te=function(){return(Te=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},xe=function(e){var t,n=!1;return function(){for(var o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];return n||(n=!0,t=e.apply(null,o)),t}},Ee=function(){return _e(0,0)},_e=function(e,t){return{major:e,minor:t}},Ie=function(e,t){var n=String(t).toLowerCase();return 0===e.length?Ee():function(e,t){var n=function(e,t){for(var n=0;n<e.length;n++){var o=e[n];if(o.test(t))return o}}(e,t);if(!n)return{major:0,minor:0};var o=function(e){return Number(t.replace(n,"$"+e))};return _e(o(1),o(2))}(e,n)},De=Ee,Oe="Firefox",we=function(e){var t=e.current,n=function(e){return function(){return t===e}};return{current:t,version:e.version,isEdge:n("Edge"),isChrome:n("Chrome"),isIE:n("IE"),isOpera:n("Opera"),isFirefox:n(Oe),isSafari:n("Safari")}},Re=function(){return we({current:void 0,version:De()})},Se=we,ke=(o("Edge"),o("Chrome"),o("IE"),o("Opera"),o(Oe),o("Safari"),"Windows"),Ae="Android",Ne="Solaris",Me="FreeBSD",Ke="ChromeOS",Pe=function(e){var t=e.current,n=function(e){return function(){return t===e}};return{current:t,version:e.version,isWindows:n(ke),isiOS:n("iOS"),isAndroid:n(Ae),isOSX:n("OSX"),isLinux:n("Linux"),isSolaris:n(Ne),isFreeBSD:n(Me),isChromeOS:n(Ke)}},Le=function(){return Pe({current:void 0,version:De()})},Be=Pe,Fe=(o(ke),o("iOS"),o(Ae),o("Linux"),o("OSX"),o(Ne),o(Me),o(Ke),function(e,t){var n=String(t).toLowerCase();return L(e,(function(e){return e.search(n)}))}),ze=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,Ve=function(e){return function(t){return ge(t,e)}},He=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(e){return ge(e,"edge/")&&ge(e,"chrome")&&ge(e,"safari")&&ge(e,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,ze],search:function(e){return ge(e,"chrome")&&!ge(e,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(e){return ge(e,"msie")||ge(e,"trident")}},{name:"Opera",versionRegexes:[ze,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:Ve("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:Ve("firefox")},{name:"Safari",versionRegexes:[ze,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(e){return(ge(e,"safari")||ge(e,"mobile/"))&&ge(e,"applewebkit")}}],We=[{name:"Windows",search:Ve("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(e){return ge(e,"iphone")||ge(e,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:Ve("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:Ve("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:Ve("linux"),versionRegexes:[]},{name:"Solaris",search:Ve("sunos"),versionRegexes:[]},{name:"FreeBSD",search:Ve("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:Ve("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],$e={browsers:o(He),oses:o(We)},Ue=function(t){return e.window.matchMedia(t).matches},qe=xe((function(){return function(e,t){var n,i,r,a,s,l,u,c,d,f,h,g,m=$e.browsers(),p=$e.oses(),v=function(e,t){return Fe(e,t).map((function(e){var n=Ie(e.versionRegexes,t);return{current:e.name,version:n}}))}(m,e).fold(Re,Se),y=function(e,t){return Fe(e,t).map((function(e){var n=Ie(e.versionRegexes,t);return{current:e.name,version:n}}))}(p,e).fold(Le,Be);return{browser:v,os:y,deviceType:(i=v,r=e,a=t,s=(n=y).isiOS()&&!0===/ipad/i.test(r),l=n.isiOS()&&!s,u=n.isiOS()||n.isAndroid(),c=u||a("(pointer:coarse)"),d=s||!l&&u&&a("(min-device-width:768px)"),f=l||u&&!d,h=i.isSafari()&&n.isiOS()&&!1===/safari/i.test(r),g=!f&&!d&&!h,{isiPad:o(s),isiPhone:o(l),isTablet:o(d),isPhone:o(f),isTouch:o(c),isAndroid:n.isAndroid,isiOS:n.isiOS,isWebView:o(h),isDesktop:o(g)})}}(e.navigator.userAgent,Ue)})),je=function(){return qe()},Ge=function(e,t){var n=e.dom();if(1!==n.nodeType)return!1;var o=n;if(void 0!==o.matches)return o.matches(t);if(void 0!==o.msMatchesSelector)return o.msMatchesSelector(t);if(void 0!==o.webkitMatchesSelector)return o.webkitMatchesSelector(t);if(void 0!==o.mozMatchesSelector)return o.mozMatchesSelector(t);throw new Error("Browser lacks native selectors")},Xe=function(e){return 1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType||0===e.childElementCount},Ye=function(e,t){return e.dom()===t.dom()},Ze=function(t,n){return je().browser.isIE()?function(t,n){return o=t.dom(),i=n.dom(),r=e.Node.DOCUMENT_POSITION_CONTAINED_BY,0!=(o.compareDocumentPosition(i)&r);var o,i,r}(t,n):(o=n,(i=t.dom())!==(r=o.dom())&&i.contains(r));var o,i,r},Je=Ge,Qe=function(e){return Ce.fromDom(e.dom().ownerDocument)},et=function(e){return p.from(e.dom().parentNode).map(Ce.fromDom)},tt=function(e,t){for(var n=_(t)?t:d,o=e.dom(),i=[];null!=o.parentNode;){var r=o.parentNode,a=Ce.fromDom(r);if(i.push(a),!0===n(a))break;o=r}return i},nt=function(e){return p.from(e.dom().previousSibling).map(Ce.fromDom)},ot=function(e){return p.from(e.dom().nextSibling).map(Ce.fromDom)},it=function(e){return A(e.dom().childNodes,Ce.fromDom)},rt=function(e,t){var n=e.dom().childNodes;return p.from(n[t]).map(Ce.fromDom)},at=_(e.Element.prototype.attachShadow)&&_(e.Node.prototype.getRootNode),st=o(at),lt=at?function(e){return Ce.fromDom(e.dom().getRootNode())}:function(e){return oe(e)?e:Qe(e)},ut=function(e){return Ce.fromDom(e.dom().host)},ct=function(e){var t,n,o=ne(e)?e.dom().parentNode:e.dom();return null!=o&&null!==o.ownerDocument&&function(e){var t=lt(e);return ie(t)?p.some(t):p.none()}(Ce.fromDom(o)).fold((function(){return o.ownerDocument.body.contains(o)}),(t=ct,n=ut,function(e){return t(n(e))}))},dt=function(e){var t=e.dom().body;if(null==t)throw new Error("Body is not available yet");return Ce.fromDom(t)},ft=function(t,n,o){if(!b(o))throw e.console.error("Invalid call to CSS.set. Property ",n,":: Value ",o,":: Element ",t),new Error("CSS value must be a string: "+o);ye(t)&&t.style.setProperty(n,o)},ht=function(e,t,n){var o=e.dom();ft(o,t,n)},gt=function(e,t){var n=e.dom();q(t,(function(e,t){ft(n,t,e)}))},mt=function(t,n){var o=t.dom(),i=e.window.getComputedStyle(o).getPropertyValue(n);return""!==i||ct(t)?i:pt(o,n)},pt=function(e,t){return ye(e)?e.style.getPropertyValue(t):""},vt=function(e,t){var n=e.dom(),o=pt(n,t);return p.from(o).filter((function(e){return 0<e.length}))},yt=function(e,t){var n,o,i=e.dom();o=t,ye(n=i)&&n.style.removeProperty(o),ue(e,"style").map(pe).is("")&&de(e,"style")},bt=function(e,t){et(e).each((function(n){n.dom().insertBefore(t.dom(),e.dom())}))},Ct=function(e,t){ot(e).fold((function(){et(e).each((function(e){xt(e,t)}))}),(function(e){bt(e,t)}))},Tt=function(e,t){rt(e,0).fold((function(){xt(e,t)}),(function(n){e.dom().insertBefore(t.dom(),n.dom())}))},xt=function(e,t){e.dom().appendChild(t.dom())},Et=function(e,t){bt(e,t),xt(t,e)},_t=function(e,t){N(t,(function(n,o){Ct(0===o?e:t[o-1],n)}))},It=function(e,t){N(t,(function(t){xt(e,t)}))},Dt=function(e){e.dom().textContent="",N(it(e),(function(e){Ot(e)}))},Ot=function(e){var t=e.dom();null!==t.parentNode&&t.parentNode.removeChild(t)},wt=function(e){var t,n=it(e);0<n.length&&(t=e,N(n,(function(e){bt(t,e)}))),Ot(e)},Rt=function(e,t,n){return{element:o(e),rowspan:o(t),colspan:o(n)}},St=function(e,t,n){return{element:o(e),cells:o(t),section:o(n)}},kt=function(e,t){return{element:o(e),isNew:o(t)}},At=function(e,t){return{cells:o(e),section:o(t)}},Nt=function(e,t){var n=[];return N(it(e),(function(e){t(e)&&(n=n.concat([e])),n=n.concat(Nt(e,t))})),n},Mt=function(e,t,n){return o=function(e){return Ge(e,t)},M(tt(e,n),o);var o},Kt=function(e,t){return n=function(e){return Ge(e,t)},M(it(e),n);var n},Pt=function(t,n){return o=n,r=void 0===(i=t)?e.document:i.dom(),Xe(r)?[]:A(r.querySelectorAll(o),Ce.fromDom);var o,i,r};function Lt(e,t,n,o,i){return e(n,o)?p.some(n):_(i)&&i(n)?p.none():t(n,o,i)}var Bt=function(e,t,n){for(var i=e.dom(),r=_(n)?n:o(!1);i.parentNode;){var a=Ce.fromDom(i=i.parentNode);if(t(a))return p.some(a);if(r(a))break}return p.none()},Ft=function(e,t,n){return Bt(e,(function(e){return Ge(e,t)}),n)},zt=function(e,t){return n=function(e){return Ge(e,t)},L(e.dom().childNodes,(function(e){return n(Ce.fromDom(e))})).map(Ce.fromDom);var n},Vt=function(t,n){return o=n,r=void 0===(i=t)?e.document:i.dom(),Xe(r)?p.none():p.from(r.querySelector(o)).map(Ce.fromDom);var o,i,r},Ht=function(e,t,n){return Lt((function(e,t){return Ge(e,t)}),Ft,e,t,n)},Wt=function(e,t,n){return void 0===n&&(n=0),ue(e,t).map((function(e){return parseInt(e,10)})).getOr(n)},$t=function(e,t){return Wt(e,t,1)},Ut=function(e){return 1<$t(e,"colspan")},qt=function(e){return 1<$t(e,"rowspan")},jt=function(e,t){return parseInt(mt(e,t),10)},Gt=o(10),Xt=o(10),Yt=function(e,t){return Zt(e,t,o(!0))},Zt=function(e,t,n){return z(it(e),(function(e){return Ge(e,t)?n(e)?[e]:[]:Zt(e,t,n)}))},Jt=function(e,t){return function(e,t,n){return void 0===n&&(n=d),n(t)?p.none():R(e,Z(t))?p.some(t):Ft(t,e.join(","),(function(e){return Ge(e,"table")||n(e)}))}(["td","th"],e,t)},Qt=function(e){return Yt(e,"th,td")},en=function(e,t){return Ht(e,"table",t)},tn=function(e){return Yt(e,"tr")},nn=function(e){var t=tn(e);return A(t,(function(e){var t=e,n=et(t).map((function(e){var t=Z(e);return"tfoot"===t||"thead"===t||"tbody"===t?t:"tbody"})).getOr("tbody"),o=A(Qt(e),(function(e){var t=Wt(e,"rowspan",1),n=Wt(e,"colspan",1);return Rt(e,t,n)}));return St(t,o,n)}))},on=function(e,t){return e+","+t},rn=function(e,t){var n=z(e.all,(function(e){return e.cells()}));return M(n,t)},an=function(e){var t={},n=[],i=e.length,r=0;return N(e,(function(e,i){var a=[];N(e.cells(),(function(e){for(var n=0;void 0!==t[on(i,n)];)n++;for(var s,l,u,c=(s=e.element(),l=e.rowspan(),u=e.colspan(),{element:o(s),rowspan:o(l),colspan:o(u),row:o(i),column:o(n)}),d=0;d<e.colspan();d++)for(var f=0;f<e.rowspan();f++){var h=n+d,g=on(i+f,h);t[g]=c,r=Math.max(r,h+1)}a.push(c)})),n.push(St(e.element(),a,e.section()))})),{grid:{rows:o(i),columns:o(r)},access:t,all:n}},sn=function(e){var t=nn(e);return an(t)},ln=an,un=function(e,t,n){var o=e.access[on(t,n)];return void 0!==o?p.some(o):p.none()},cn=function(e,t,n){var o=rn(e,(function(e){return n(t,e.element())}));return 0<o.length?p.some(o[0]):p.none()},dn=rn,fn=function(e){var t=A(e.all,(function(e){return e.cells()}));return F(t)},hn=function(e,t){var n,o,i,r,a,s,l,u,c,d,f=function(e){return Ge(e.element(),t)},h=nn(e),g=ln(h),m=(o=f,i=(n=g).grid.columns(),r=n.grid.rows(),a=i,l=s=0,q(n.access,(function(e){if(o(e)){var t=e.row(),n=t+e.rowspan()-1,i=e.column(),u=i+e.colspan()-1;t<r?r=t:s<n&&(s=n),i<a?a=i:l<u&&(l=u)}})),{minRow:r,minCol:a,maxRow:s,maxCol:l}),p="th:not("+t+"),td:not("+t+")",v=Zt(e,"th,td",(function(e){return Ge(e,p)}));return N(v,Ot),function(e,t,n,o){for(var i,r,a,s=t.grid.columns(),l=t.grid.rows(),u=0;u<l;u++)for(var c=!1,d=0;d<s;d++)u<n.minRow||u>n.maxRow||d<n.minCol||d>n.maxCol||(un(t,u,d).filter(o).isNone()?(i=c,r=e[u].element(),a=Ce.fromTag("td"),xt(a,Ce.fromTag("br")),(i?xt:Tt)(r,a)):c=!0)}(h,g,m,f),c=m,d=M(Yt(u=e,"tr"),(function(e){return 0===e.dom().childElementCount})),N(d,Ot),c.minCol!==c.maxCol&&c.minRow!==c.maxRow||N(Yt(u,"th,td"),(function(e){de(e,"rowspan"),de(e,"colspan")})),de(u,"width"),de(u,"height"),yt(u,"width"),yt(u,"height"),e},gn=function(e,t){var n=function(t){return e(t)?p.from(t.dom().nodeValue):p.none()};return{get:function(t){if(!e(t))throw new Error("Can only get text value of a text node");return n(t).getOr("")},getOption:n,set:function(t,n){if(!e(t))throw new Error("Can only set raw text value of a text node");t.dom().nodeValue=n}}}(ne),mn=function(e){return gn.get(e)},pn=function(e){return gn.getOption(e)},vn=function(e,t){return gn.set(e,t)},yn=function(e){return"img"===Z(e)?1:pn(e).fold((function(){return it(e).length}),(function(e){return e.length}))},bn=["img","br"],Cn=function(e){return pn(e).filter((function(e){return 0!==e.trim().length||-1<e.indexOf(" ")})).isSome()||R(bn,Z(e))},Tn=function(e){return t=Cn,(n=function(e){for(var o=0;o<e.childNodes.length;o++){var i=Ce.fromDom(e.childNodes[o]);if(t(i))return p.some(i);var r=n(e.childNodes[o]);if(r.isSome())return r}return p.none()})(e.dom());var t,n},xn=function(e){return En(e,Cn)},En=function(e,t){var n=function(e){for(var o=it(e),i=o.length-1;0<=i;i--){var r=o[i];if(t(r))return p.some(r);var a=n(r);if(a.isSome())return a}return p.none()};return n(e)},_n=function(e,t){return Ce.fromDom(e.dom().cloneNode(t))},In=function(e){return _n(e,!1)},Dn=function(e){return _n(e,!0)},On=function(){var e=Ce.fromTag("td");return xt(e,Ce.fromTag("br")),e},wn=function(e,t,n){var o=function(e,t){var n,o,i,r=(n=e,o=Ce.fromTag(t),i=fe(n),se(o,i),o),a=it(Dn(e));return It(r,a),r}(e,t);return q(n,(function(e,t){null===e?de(o,t):ae(o,t,e)})),o},Rn=function(e){return e},Sn=function(e){return function(){return Ce.fromTag("tr",e.dom())}},kn=function(e,t,n){return{row:Sn(t),cell:function(t){var o,i,r,a,s,l,u=Qe(t.element()),c=Ce.fromTag(Z(t.element()),u.dom()),d=n.getOr(["strong","em","b","i","span","font","h1","h2","h3","h4","h5","h6","p","div"]),f=0<d.length?(o=t.element(),i=c,r=d,Tn(o).map((function(e){var t=r.join(","),n=Mt(e,t,(function(e){return Ye(e,o)}));return K(n,(function(e,t){var n=In(t);return de(n,"contenteditable"),xt(e,n),n}),i)})).getOr(i)):c;return xt(f,Ce.fromTag("br")),a=c,s=t.element().dom(),l=a.dom(),ye(s)&&ye(l)&&(l.style.cssText=s.style.cssText),yt(c,"height"),1!==t.colspan()&&yt(t.element(),"width"),e(t.element(),c),c},replace:wn,gap:On}},An=function(e){return{row:Sn(e),cell:On,replace:Rn,gap:On}},Nn=function(e,t){var n=t.column(),o=t.column()+t.colspan()-1,i=t.row(),r=t.row()+t.rowspan()-1;return n<=e.finishCol()&&o>=e.startCol()&&i<=e.finishRow()&&r>=e.startRow()},Mn=function(e,t){return t.column()>=e.startCol()&&t.column()+t.colspan()-1<=e.finishCol()&&t.row()>=e.startRow()&&t.row()+t.rowspan()-1<=e.finishRow()},Kn=function(e,t,n){var i=cn(e,t,Ye),r=cn(e,n,Ye);return i.bind((function(e){return r.map((function(t){return function(e,t){return n=Math.min(e.row(),t.row()),i=Math.min(e.column(),t.column()),r=Math.max(e.row()+e.rowspan()-1,t.row()+t.rowspan()-1),a=Math.max(e.column()+e.colspan()-1,t.column()+t.colspan()-1),{startRow:o(n),startCol:o(i),finishRow:o(r),finishCol:o(a)};var n,i,r,a}(e,t)}))}))},Pn=function(e,t,n){return Kn(e,t,n).map((function(t){var n=dn(e,r(Nn,t));return A(n,(function(e){return e.element()}))}))},Ln=function(e,t){return cn(e,t,(function(e,t){return Ze(t,e)})).map((function(e){return e.element()}))},Bn=function(e,t,n,o,i){var r=Fn(e),a=Ye(e,n)?p.some(t):Ln(r,t),s=Ye(e,i)?p.some(o):Ln(r,o);return a.bind((function(e){return s.bind((function(t){return Pn(r,e,t)}))}))},Fn=sn,zn=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","li","table","thead","tbody","tfoot","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"];function Vn(){return{up:o({selector:Ft,closest:Ht,predicate:Bt,all:tt}),down:o({selector:Pt,predicate:Nt}),styles:o({get:mt,getRaw:vt,set:ht,remove:yt}),attrs:o({get:le,set:ae,remove:de,copyTo:function(e,t){var n=fe(e);se(t,n)}}),insert:o({before:bt,after:Ct,afterAll:_t,append:xt,appendAll:It,prepend:Tt,wrap:Et}),remove:o({unwrap:wt,remove:Ot}),create:o({nu:Ce.fromTag,clone:function(e){return Ce.fromDom(e.dom().cloneNode(!1))},text:Ce.fromText}),query:o({comparePosition:function(e,t){return e.dom().compareDocumentPosition(t.dom())},prevSibling:nt,nextSibling:ot}),property:o({children:it,name:Z,parent:et,document:function(e){return e.dom().ownerDocument},isText:ne,isComment:ee,isElement:te,getText:mn,setText:vn,isBoundary:function(e){return!!te(e)&&("body"===Z(e)||R(zn,Z(e)))},isEmptyTag:function(e){return!!te(e)&&R(["br","img","hr","input"],Z(e))},isNonEditable:function(e){return te(e)&&"false"===le(e,"contenteditable")}}),eq:Ye,is:Je}}var Hn=function(e,t,n,i){void 0===i&&(i=d);var a=[t].concat(e.up().all(t)),s=[n].concat(e.up().all(n)),l=function(e){return B(e,i).fold((function(){return e}),(function(t){return e.slice(0,t+1)}))},u=l(a),c=l(s),f=L(u,(function(t){return S(c,r(e.eq,t))}));return{firstpath:o(u),secondpath:o(c),shared:o(f)}},Wn=Vn(),$n=function(e,t){return function(e,t,n){return 0<n.length?function(e,t,n,o){var i=t(e,n);return K(o,(function(n,o){var i=t(e,o);return function(e,t,n){return t.bind((function(t){return n.filter(r(e.eq,t))}))}(e,n,i)}),i)}(e,t,(o=n)[0],o.slice(1)):p.none();var o}(Wn,(function(t,n){return e(n)}),t)},Un=function(e){return Ft(e,"table")},qn=function(e,t,n){var o=function(e){return function(t){return void 0!==n&&n(t)||Ye(t,e)}};return Ye(e,t)?p.some({boxes:p.some([e]),start:e,finish:t}):Un(e).bind((function(i){return Un(t).bind((function(r){if(Ye(i,r))return p.some({boxes:(u=e,c=t,d=Fn(i),Pn(d,u,c)),start:e,finish:t});if(Ze(i,r)){var a=0<(s=Mt(t,"td,th",o(i))).length?s[s.length-1]:t;return p.some({boxes:Bn(i,e,i,t,r),start:e,finish:a})}if(Ze(r,i)){var s,l=0<(s=Mt(e,"td,th",o(r))).length?s[s.length-1]:e;return p.some({boxes:Bn(r,e,i,t,r),start:e,finish:l})}return Hn(Wn,e,t,void 0).shared().bind((function(a){return Ht(a,"table",n).bind((function(n){var a=Mt(t,"td,th",o(n)),s=0<a.length?a[a.length-1]:t,l=Mt(e,"td,th",o(n)),u=0<l.length?l[l.length-1]:e;return p.some({boxes:Bn(n,e,i,t,r),start:u,finish:s})}))}));var u,c,d}))}))},jn=function(e,t){var n=Pt(e,t);return 0<n.length?p.some(n):p.none()},Gn=function(e,t,n){return Vt(e,t).bind((function(t){return Vt(e,n).bind((function(e){return $n(Un,[t,e]).map((function(n){return{first:o(t),last:o(e),table:o(n)}}))}))}))},Xn="data-mce-selected",Yn="td[data-mce-selected],th[data-mce-selected]",Zn="[data-mce-selected]",Jn="data-mce-first-selected",Qn="td[data-mce-first-selected],th[data-mce-first-selected]",eo="data-mce-last-selected",to="td[data-mce-last-selected],th[data-mce-last-selected]",no=Object.freeze({__proto__:null,selected:Xn,selectedSelector:Yn,attributeSelector:Zn,firstSelected:Jn,firstSelectedSelector:Qn,lastSelected:eo,lastSelectedSelector:to}),oo=function(t){if(!T(t))throw new Error("cases must be an array");if(0===t.length)throw new Error("there must be at least one case");var n=[],o={};return N(t,(function(i,r){var a=$(i);if(1!==a.length)throw new Error("one and only one name per case");var s=a[0],l=i[s];if(void 0!==o[s])throw new Error("duplicate key detected:"+s);if("cata"===s)throw new Error("cannot have a case named cata (sorry)");if(!T(l))throw new Error("case arguments must be an array");n.push(s),o[s]=function(){var o=arguments.length;if(o!==l.length)throw new Error("Wrong number of arguments to case "+s+". Expected "+l.length+" ("+l+"), got "+o);for(var i=new Array(o),a=0;a<i.length;a++)i[a]=arguments[a];return{fold:function(){if(arguments.length!==t.length)throw new Error("Wrong number of arguments to fold. Expected "+t.length+", got "+arguments.length);return arguments[r].apply(null,i)},match:function(e){var t=$(e);if(n.length!==t.length)throw new Error("Wrong number of arguments to match. Expected: "+n.join(",")+"\nActual: "+t.join(","));if(!V(n,(function(e){return R(t,e)})))throw new Error("Not all branches were specified when using match. Specified: "+t.join(", ")+"\nRequired: "+n.join(", "));return e[s].apply(null,i)},log:function(t){e.console.log(t,{constructors:n,constructor:s,params:i})}}}})),o},io=oo([{none:[]},{multiple:["elements"]},{single:["selection"]}]),ro=function(e,t,n,o){return e.fold(t,n,o)},ao=io.none,so=io.multiple,lo=io.single,uo=function(e,t){return ro(t.get(),o([]),i,o([e]))},co=function(e){return{element:o(e),mergable:p.none,unmergable:p.none,selection:o([e])}},fo=function(e,t,n){return{element:o(n),mergable:o((a=t,ro(e.get(),p.none,(function(e,t){return 0===e.length?p.none():function(e,t,n){return Gn(e,"td[data-mce-first-selected],th[data-mce-first-selected]","td[data-mce-last-selected],th[data-mce-last-selected]").bind((function(t){var n=function(t){return Ye(e,t)},o=Ft(t.first(),"thead,tfoot,tbody,table",n),i=Ft(t.last(),"thead,tfoot,tbody,table",n);return o.bind((function(e){return i.bind((function(n){return Ye(e,n)?(o=t.table(),i=t.first(),a=t.last(),function(e,t,n){return Kn(e,t,n).bind((function(t){return function(e,t){for(var n=!0,o=r(Mn,t),i=t.startRow();i<=t.finishRow();i++)for(var a=t.startCol();a<=t.finishCol();a++)n=n&&un(e,i,a).exists(o);return n?p.some(t):p.none()}(e,t)}))}(Fn(o),i,a)):p.none();var o,i,a}))}))}))}(a).bind((function(t){return 1<e.length?p.some({bounds:o(t),cells:o(e)}):p.none()}))}),p.none))),unmergable:o(0<(i=uo(n,e)).length&&V(i,(function(e){return ce(e,"rowspan")&&1<parseInt(le(e,"rowspan"),10)||ce(e,"colspan")&&1<parseInt(le(e,"colspan"),10)}))?p.some(i):p.none()),selection:o(uo(n,e))};var i,a},ho=function(e,t){return{left:o(e),top:o(t),translate:function(n,o){return ho(e+n,t+o)}}},go=ho,mo=function(e,t){return void 0!==e?e:void 0!==t?t:0},po=function(e){var t=e.dom().ownerDocument,n=t.body,o=t.defaultView,i=t.documentElement;if(n===e.dom())return go(n.offsetLeft,n.offsetTop);var r=mo(o.pageYOffset,i.scrollTop),a=mo(o.pageXOffset,i.scrollLeft),s=mo(i.clientTop,n.clientTop),l=mo(i.clientLeft,n.clientLeft);return vo(e).translate(a-l,r-s)},vo=function(e){var t,n=e.dom(),o=n.ownerDocument.body;return o===n?go(o.offsetLeft,o.offsetTop):ct(e)?(t=n.getBoundingClientRect(),go(t.left,t.top)):go(0,0)},yo=function(e){var t=p.from(e.dom().documentElement).map(Ce.fromDom).getOr(e);return{parent:o(t),view:o(e),origin:o(go(0,0))}};function bo(e,t){var n=function(n){var o=t(n);if(o<=0||null===o){var i=mt(n,e);return parseFloat(i)||0}return o},o=function(e,t){return P(t,(function(t,n){var o=mt(e,n),i=void 0===o?0:parseInt(o,10);return isNaN(i)?t:t+i}),0)};return{set:function(t,n){if(!I(n)&&!n.match(/^[0-9]+$/))throw new Error(e+".set accepts only positive integer values. Value was "+n);var o=t.dom();ye(o)&&(o.style[e]=n+"px")},get:n,getOuter:n,aggregate:o,max:function(e,t,n){var i=o(e,n);return i<t?t-i:0}}}var Co=bo("height",(function(e){var t=e.dom();return ct(e)?t.getBoundingClientRect().height:t.offsetHeight})),To=function(e){return Co.get(e)},xo=function(e){return Co.getOuter(e)},Eo=bo("width",(function(e){return e.dom().offsetWidth})),_o=function(e){return Eo.get(e)},Io=function(e){return Eo.getOuter(e)},Do=function(e,t){return{row:e,y:t}},Oo=function(e,t){return{col:e,x:t}},wo=function(e){return po(e).left()+Io(e)},Ro=function(e){return po(e).left()},So=function(e,t){return Oo(e,Ro(t))},ko=function(e,t){return Oo(e,wo(t))},Ao=function(e){return po(e).top()},No=function(e,t){return Do(e,Ao(t))},Mo=function(e,t){return Do(e,Ao(t)+xo(t))},Ko=function(e,t,n){if(0===n.length)return[];var o=A(n.slice(1),(function(t,n){return t.map((function(t){return e(n,t)}))})),i=n[n.length-1].map((function(e){return t(n.length-1,e)}));return o.concat([i])},Po={delta:i,positions:function(e){return Ko(No,Mo,e)},edge:Ao},Lo={delta:i,edge:Ro,positions:function(e){return Ko(So,ko,e)}},Bo={delta:function(e){return-e},edge:wo,positions:function(e){return Ko(ko,So,e)}},Fo=function(e){var t=e.grid,n=k(t.columns(),i),r=k(t.rows(),i);return A(n,(function(t){return zo((function(){return z(r,(function(n){return un(e,n,t).filter((function(e){return e.column()===t})).fold(o([]),(function(e){return[e]}))}))}),(function(e){return 1===e.colspan()}),(function(){return un(e,0,t)}))}))},zo=function(e,t,n){var o=e();return L(o,t).orThunk((function(){return p.from(o[0]).orThunk(n)})).map((function(e){return e.element()}))},Vo=function(e){var t=e.grid,n=k(t.rows(),i),r=k(t.columns(),i);return A(n,(function(t){return zo((function(){return z(r,(function(n){return un(e,t,n).filter((function(e){return e.row()===t})).fold(o([]),(function(e){return[e]}))}))}),(function(e){return 1===e.rowspan()}),(function(){return un(e,t,0)}))}))},Ho=function(e,t){if(t<0||t>=e.length-1)return p.none();var n=e[t].fold((function(){var n,o,i=(n=e.slice(0,t),(o=D.call(n,0)).reverse(),o);return W(i,(function(e,t){return e.map((function(e){return{value:e,delta:t+1}}))}))}),(function(e){return p.some({value:e,delta:0})})),o=e[t+1].fold((function(){var n=e.slice(t+1);return W(n,(function(e,t){return e.map((function(e){return{value:e,delta:t+1}}))}))}),(function(e){return p.some({value:e,delta:1})}));return n.bind((function(e){return o.map((function(t){var n=t.delta+e.delta;return Math.abs(t.value-e.value)/n}))}))},Wo=function(){var e=je().browser;return e.isIE()||e.isEdge()},$o=function(e,t,n){return o=mt(e,t),i=n,r=parseFloat(o),isNaN(r)?i:r;var o,i,r},Uo=function(e){return Wo()?(n=(t=e).dom().getBoundingClientRect().width,"border-box"===mt(t,"box-sizing")?n:n-$o(t,"padding-left",0)-$o(t,"padding-right",0)-($o(t,"border-left-width",0)+$o(t,"border-right-width",0))):$o(e,"width",_o(e));var t,n},qo=/(\d+(\.\d+)?)(\w|%)*/,jo=/(\d+(\.\d+)?)%/,Go=/(\d+(\.\d+)?)px|em/,Xo=function(e,t){ht(e,"width",t+"px")},Yo=function(e,t){ht(e,"width",t+"%")},Zo=function(e,t){ht(e,"height",t+"px")},Jo=function(e){return vt(e,"width").fold((function(){return p.from(le(e,"width"))}),(function(e){return p.some(e)}))},Qo=function(e,t){return e/t.pixelWidth()*100},ei=function(e,t){return Jo(e).fold((function(){var n=_o(e);return Qo(n,t)}),(function(n){return function(e,t,n){var o=jo.exec(t);if(null!==o)return parseFloat(o[1]);var i=Uo(e);return Qo(i,n)}(e,n,t)}))},ti=function(e,t){return Jo(e).fold((function(){return Uo(e)}),(function(n){return function(e,t,n){var o=Go.exec(t);if(null!==o)return parseInt(o[1],10);var i=jo.exec(t);return null===i?Uo(e):parseFloat(i[1])/100*n.pixelWidth()}(e,n,t)}))},ni=function(e){return function(e){var t,n=vt(t=e,"height").getOrThunk((function(){return function(e){return Wo()?(n=(t=e).dom().getBoundingClientRect().height,"border-box"===mt(t,"box-sizing")?n:n-$o(t,"padding-top",0)-$o(t,"padding-bottom",0)-($o(t,"border-top-width",0)+$o(t,"border-bottom-width",0))):$o(e,"height",To(e));var t,n}(t)+"px"}));return n?function(e,t,n,o){var i,r,a,s,l,u=parseInt(e,10);return me(e,"%")&&"table"!==Z(t)?(r=u,a=n,s=o,l=en(i=t).map((function(e){var t=a(e);return Math.floor(r/100*t)})).getOr(r),s(i,l),l):u}(n,e,To,Zo):To(e)}(t=e)/$t(t,"rowspan");var t},oi=function(e,t,n){ht(e,"width",t+n)},ii=function(e){return function(e,t){var n=p.from(e.dom().offsetParent).map(Ce.fromDom).getOr(dt(Qe(e)));return t(e)/t(n)*100}(e,_o)+"%"},ri=o(jo),ai=o(Go),si=function(e,t,n){return vt(e,t).fold((function(){return n(e)+"px"}),(function(e){return e}))},li=function(e,t){return si(e,"width",(function(e){return ti(e,t)}))},ui=function(e){return si(e,"height",ni)},ci=function(e,t,n,o,i){var r=Fo(e),a=A(r,(function(e){return e.map(t.edge)}));return A(r,(function(e,t){return e.filter(c(Ut)).fold((function(){var e=Ho(a,t);return o(e)}),(function(e){return n(e,i)}))}))},di=function(e){return e.map((function(e){return e+"px"})).getOr("")},fi=function(e,t,n){return ci(e,t,ei,(function(e){return e.fold((function(){return n.minCellWidth()}),(function(e){return e/n.pixelWidth()*100}))}),n)},hi=function(e,t,n){return ci(e,t,ti,(function(e){return e.getOrThunk(n.minCellWidth)}),n)},gi=function(e,t,n,o){var i=Vo(e),r=A(i,(function(e){return e.map(t.edge)}));return A(i,(function(e,t){return e.filter(c(qt)).fold((function(){var e=Ho(r,t);return o(e)}),(function(e){return n(e)}))}))},mi=oo([{invalid:["raw"]},{pixels:["value"]},{percent:["value"]}]),pi=function(e,t,n){var o=n.substring(0,n.length-e.length),i=parseFloat(o);return o===i.toString()?t(i):mi.invalid(n)},vi=Te(Te({},mi),{from:function(e){return me(e,"%")?pi("%",mi.percent,e):me(e,"px")?pi("px",mi.pixels,e):mi.invalid(e)}}),yi=function(e,t,n){var i,r,a=vi.from(n),s=V(e,(function(e){return"0px"===e}))?(i=e.length,r=a.fold((function(){return o("")}),(function(e){return o(e/i+"px")}),(function(e){return o(e/i+"px")})),k(i,r)):function(e,t,n){return e.fold((function(){return t}),(function(e){return i=(o=e)/n,A(t,(function(e){return vi.from(e).fold((function(){return e}),(function(e){return e*i+"px"}),(function(e){return e/100*o+"px"}))}));var o,i}),(function(e){return o=n,A(t,(function(e){return vi.from(e).fold((function(){return e}),(function(e){return e/o*100+"%"}),(function(e){return e+"%"}))}));var o}))}(a,e,t);return Ci(s)},bi=function(e,t){return 0===e.length?t:K(e,(function(e,t){return vi.from(t).fold(o(0),i,i)+e}),0)},Ci=function(e){if(0===e.length)return e;var t,n,i=K(e,(function(e,t){var n=vi.from(t).fold((function(){return{value:t,remainder:0}}),(function(e){return t=e,{value:(n=Math.floor(t))+"px",remainder:t-n};var t,n}),(function(e){return{value:e+"%",remainder:0}}));return{output:[n.value].concat(e.output),remainder:e.remainder+n.remainder}}),{output:[],remainder:0}),r=i.output;return r.slice(0,r.length-1).concat([(t=r[r.length-1],n=Math.round(i.remainder),vi.from(t).fold(o(t),(function(e){return e+n+"px"}),(function(e){return e+n+"%"})))])},Ti=vi.from,xi=function(e){return Ti(e).fold(o("px"),o("px"),o("%"))},Ei=function(e,t,n,o,i){var r=sn(e),a=r.all,s=fn(r);t.each((function(t){var n,a,l=xi(t),u=_o(e),c=ci(r,o,li,di,i),d=yi(c,u,t);n=d,a=l,N(s,(function(e){var t=n.slice(e.column(),e.colspan()+e.column()),o=bi(t,Gt());ht(e.element(),"width",o+a)})),ht(e,"width",t)})),n.each((function(t){var n,o,i,l=xi(t),u=To(e),c=gi(r,Po,ui,di),d=yi(c,u,t);n=d,o=a,i=l,N(s,(function(e){var t=n.slice(e.row(),e.rowspan()+e.row()),o=bi(t,Xt());ht(e.element(),"height",o+i)})),N(o,(function(e,t){ht(e.element(),"height",n[t])})),ht(e,"height",t)}))},_i=function(e){return Jo(e).exists((function(e){return jo.test(e)}))},Ii=function(e){return Jo(e).exists((function(e){return Go.test(e)}))},Di=ii,Oi={ltr:Lo,rtl:Bo},wi=function(e){var t=function(t){return e(t).isRtl()?Oi.rtl:Oi.ltr};return{delta:function(e,n){return t(n).delta(e,n)},edge:function(e){return t(e).edge(e)},positions:function(e,n){return t(n).positions(e,n)}}},Ri=function(e){var t=(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];if(e.length!==t.length)throw new Error('Wrong number of arguments to struct. Expected "['+e.length+']", got '+t.length+" arguments");var i={};return N(e,(function(e,n){i[e]=o(t[n])})),i}}).apply(null,e),n=[];return{bind:function(e){if(void 0===e)throw new Error("Event bind error: undefined handler");n.push(e)},unbind:function(e){n=M(n,(function(t){return t!==e}))},trigger:function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];var i=t.apply(null,e);N(n,(function(e){e(i)}))}}},Si=function(e){return{registry:j(e,(function(e){return{bind:e.bind,unbind:e.unbind}})),trigger:j(e,(function(e){return e.trigger}))}},ki=oo([{none:[]},{only:["index"]},{left:["index","next"]},{middle:["prev","index","next"]},{right:["prev","index"]}]),Ai=Te({},ki),Ni=function(e,t,n){for(var o=0,i=e;i<t;i++)o+=void 0!==n[i]?n[i]:0;return o},Mi=function(e,t){var n=fn(e);return A(n,(function(e){var n=Ni(e.column(),e.column()+e.colspan(),t);return{element:e.element(),width:n,colspan:e.colspan()}}))},Ki=function(e){var t,n,i,r,a=Ce.fromDom(function(e){if(st()&&E(e.target)){var t=Ce.fromDom(e.target);if(te(t)&&function(e){return E(e.dom().shadowRoot)}(Ce.fromDom(e.target))&&e.composed&&e.composedPath){var n=e.composedPath();if(n)return 0===(o=n).length?p.none():p.some(o[0])}}var o;return p.from(e.target)}(e).getOr(e.target)),s=function(){return e.stopPropagation()},l=function(){return e.preventDefault()},u=(t=l,n=s,function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];return t(n.apply(null,e))});return i=e.clientX,r=e.clientY,{target:o(a),x:o(i),y:o(r),stop:s,prevent:l,kill:u,raw:o(e)}},Pi=function(e,t,n,o){e.dom().removeEventListener(t,n,o)},Li=o(!0),Bi=function(e,t,n){return function(e,t,n,o,i){var a,s,l=(a=n,s=o,function(e){a(e)&&s(Ki(e))});return e.dom().addEventListener(t,l,!1),{unbind:r(Pi,e,t,l,!1)}}(e,t,Li,n)},Fi=Ki,zi=function(e){return void 0!==e.dom().classList},Vi=function(e,t){zi(e)?e.dom().classList.add(t):function(e,t){return o=t,i=function(e,t){var n=le(e,"class");return void 0===n||""===n?[]:n.split(" ")}(n=e).concat([o]),ae(n,"class",i.join(" ")),!0;var n,o,i}(e,t)},Hi=function(e,t){return zi(e)&&e.dom().classList.contains(t)},Wi=function(e){var t=e.replace(/\./g,"-");return{resolve:function(e){return t+"-"+e}}},$i=Wi("ephox-dragster").resolve,Ui=function(e){return e.slice(0).sort()},qi=function(e,t){var n=M(t,(function(t){return!R(e,t)}));0<n.length&&function(e){throw new Error("Unsupported keys for object: "+Ui(e).join(", "))}(n)},ji=function(e){return function(e,t,n){if(0===t.length)throw new Error("You must specify at least one required field.");var o;return function(e,t){if(!T(t))throw new Error("The "+e+" fields must be an array. Was: "+t+".");N(t,(function(t){if(!b(t))throw new Error("The value "+t+" in the "+e+" fields was not a string.")}))}("required",t),o=Ui(t),L(o,(function(e,t){return t<o.length-1&&e===o[t+1]})).each((function(e){throw new Error("The field: "+e+" occurs more than once in the combined fields: ["+o.join(", ")+"].")})),function(o){var i=$(o);V(t,(function(e){return R(i,e)}))||function(e,t){throw new Error("All required keys ("+Ui(e).join(", ")+") were not specified. Specified keys were: "+Ui(t).join(", ")+".")}(t,i),e(t,i);var r=M(t,(function(e){return!n.validate(o[e],e)}));return 0<r.length&&function(e,t){throw new Error("All values need to be of type: "+t+". Keys ("+Ui(e).join(", ")+") were not.")}(r,n.label),o}}(qi,e,{validate:_,label:"function"})},Gi=ji(["compare","extract","mutate","sink"]),Xi=ji(["element","start","stop","destroy"]),Yi=ji(["forceDrop","drop","move","delayDrop"]),Zi=Gi({compare:function(e,t){return go(t.left()-e.left(),t.top()-e.top())},extract:function(e){return p.some(go(e.x(),e.y()))},sink:function(e,t){var n=function(e){var t=Te({layerClass:$i("blocker")},e),n=Ce.fromTag("div");return ae(n,"role","presentation"),gt(n,{position:"fixed",left:"0px",top:"0px",width:"100%",height:"100%"}),Vi(n,$i("blocker")),Vi(n,t.layerClass),{element:function(){return n},destroy:function(){Ot(n)}}}(t),o=Bi(n.element(),"mousedown",e.forceDrop),i=Bi(n.element(),"mouseup",e.drop),r=Bi(n.element(),"mousemove",e.move),a=Bi(n.element(),"mouseout",e.delayDrop);return Xi({element:n.element,start:function(e){xt(e,n.element())},stop:function(){Ot(n.element())},destroy:function(){n.destroy(),i.unbind(),r.unbind(),a.unbind(),o.unbind()}})},mutate:function(e,t){e.mutate(t.left(),t.top())}}),Ji=function(e){return"true"===le(e,"contenteditable")},Qi=Wi("ephox-snooker").resolve,er=Qi("resizer-bar"),tr=Qi("resizer-rows"),nr=Qi("resizer-cols"),or=function(e){var t=Pt(e.parent(),"."+er);N(t,Ot)},ir=function(e,t,n){var o=e.origin();N(t,(function(t){t.each((function(t){var i=n(o,t);Vi(i,er),xt(e.parent(),i)}))}))},rr=function(e,t,n,o){or(e);var i=sn(t);!function(e,t,n,o,i,r){var a=po(t);!function(e,t,n,o){ir(e,t,(function(e,t){var i,r,a,s,l,u=(i=t.row,r=n.left()-e.left(),a=t.y-e.top(),s=o,l=Ce.fromTag("div"),gt(l,{position:"absolute",left:r+"px",top:a-3.5+"px",height:"7px",width:s+"px"}),se(l,{"data-row":i,role:"presentation"}),l);return Vi(u,tr),u}))}(e,0<n.length?i.positions(n,t):[],a,Io(t)),function(e,t,n,o){ir(e,t,(function(e,t){var i,r,a,s,l,u=(i=t.col,r=t.x-e.left(),a=n.top()-e.top(),s=o,l=Ce.fromTag("div"),gt(l,{position:"absolute",left:r-3.5+"px",top:a+"px",height:s+"px",width:"7px"}),se(l,{"data-column":i,role:"presentation"}),l);return Vi(u,nr),u}))}(e,0<o.length?r.positions(o,t):[],a,xo(t))}(e,t,Vo(i),Fo(i),n,o)},ar=function(e,t){var n=Pt(e.parent(),"."+er);N(n,t)},sr=function(e){ar(e,(function(e){ht(e,"display","none")}))},lr=function(e){ar(e,(function(e){ht(e,"display","block")}))},ur=Qi("resizer-bar-dragging"),cr=function(t,o,i){var a=function(){var e,t=Si({drag:Ri(["xDelta","yDelta","target"])}),n=p.none(),o={mutate:function(t,n){e.trigger.drag(t,n)},events:(e=Si({drag:Ri(["xDelta","yDelta"])})).registry};return o.events.drag.bind((function(e){n.each((function(n){t.trigger.drag(e.xDelta(),e.yDelta(),n)}))})),{assign:function(e){n=p.some(e)},get:function(){return n},mutate:o.mutate,events:t.registry}}(),s=function(t,o){return void 0===o&&(o={}),function(t,o,i){var r,a,s=!1,l=Si({start:Ri([]),stop:Ri([])}),u=function(){var e={onEvent:n,reset:n},t=function(){var e=p.none(),t=Si({move:Ri(["info"])});return{onEvent:function(n,o){o.extract(n).each((function(n){var i,r,a;(i=o,r=n,a=e.map((function(e){return i.compare(e,r)})),e=p.some(r),a).each((function(e){t.trigger.move(e)}))}))},reset:function(){e=p.none()},events:t.registry}}(),o=e;return{on:function(){o.reset(),o=t},off:function(){o.reset(),o=e},isOn:function(){return o===t},onEvent:function(e,t){o.onEvent(e,t)},events:t.events}}(),c=function(){h.stop(),u.isOn()&&(u.off(),l.trigger.stop())},d=(r=c,a=null,{cancel:function(){null!==a&&(e.clearTimeout(a),a=null)},throttle:function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];null!==a&&e.clearTimeout(a),a=e.setTimeout((function(){r.apply(null,t),a=null}),200)}});u.events.move.bind((function(e){o.mutate(t,e.info())}));var f=function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];s&&e.apply(null,t)}},h=o.sink(Yi({forceDrop:c,drop:f(c),move:f((function(e){d.cancel(),u.onEvent(e,o)})),delayDrop:f(d.throttle)}),i);return{element:h.element,go:function(e){h.start(e),u.on(),l.trigger.start()},on:function(){s=!0},off:function(){s=!1},destroy:function(){h.destroy()},events:l.registry}}(t,void 0!==o.mode?o.mode:Zi,o)}(a,{}),l=p.none(),u=function(e,t){return p.from(le(e,t))};a.events.drag.bind((function(e){u(e.target(),"data-row").each((function(t){var n=jt(e.target(),"top");ht(e.target(),"top",n+e.yDelta()+"px")})),u(e.target(),"data-column").each((function(t){var n=jt(e.target(),"left");ht(e.target(),"left",n+e.xDelta()+"px")}))}));var c=function(e,t){return jt(e,t)-Wt(e,"data-initial-"+t,0)};s.events.stop.bind((function(){a.get().each((function(e){l.each((function(n){u(e,"data-row").each((function(t){var o=c(e,"top");de(e,"data-initial-top"),m.trigger.adjustHeight(n,o,parseInt(t,10))})),u(e,"data-column").each((function(t){var o=c(e,"left");de(e,"data-initial-left"),m.trigger.adjustWidth(n,o,parseInt(t,10))})),rr(t,n,i,o)}))}))}));var d=function(e,n){m.trigger.startAdjust(),a.assign(e),ae(e,"data-initial-"+n,jt(e,n)),Vi(e,ur),ht(e,"opacity","0.2"),s.go(t.parent())},f=Bi(t.parent(),"mousedown",(function(e){var t,n;t=e.target(),Hi(t,tr)&&d(e.target(),"top"),n=e.target(),Hi(n,nr)&&d(e.target(),"left")})),h=function(e){return Ye(e,t.view())},g=Bi(t.view(),"mouseover",(function(e){(function(e){return Ht(e,"table",h).filter((function(e){return Ht(e,"[contenteditable]",h).exists(Ji)}))})(e.target()).fold((function(){ct(e.target())&&or(t)}),(function(e){l=p.some(e),rr(t,e,i,o)}))})),m=Si({adjustHeight:Ri(["table","delta","row"]),adjustWidth:Ri(["table","delta","column"]),startAdjust:Ri([])});return{destroy:function(){f.unbind(),g.unbind(),s.destroy(),or(t)},refresh:function(e){rr(t,e,i,o)},on:s.on,off:s.off,hideBars:r(sr,t),showBars:r(lr,t),events:m.registry}},dr=function(e,t){return e.fire("newrow",{node:t})},fr=function(e,t){return e.fire("newcell",{node:t})},hr={"border-collapse":"collapse",width:"100%"},gr={border:"1"},mr=function(e){return e.getParam("table_sizing_mode","auto")},pr=function(e){return e.getParam("table_responsive_width")},vr=function(e){return e.getParam("table_default_attributes",gr,"object")},yr=function(e){return e.getParam("table_default_styles",function(e){if(_r(e)){var t=e.getBody().offsetWidth;return Te(Te({},hr),{width:t+"px"})}return Ir(e)?function(e,t){var o,i,r,a,s={};return o=function(e,t){return"width"!==t},a=s,i=function(e,t){a[t]=e},r=n,q(e,(function(e,t){(o(0,t)?i:r)(e,t)})),s}(hr):hr}(e),"object")},br=function(e){return e.getParam("table_cell_advtab",!0,"boolean")},Cr=function(e){return e.getParam("table_row_advtab",!0,"boolean")},Tr=function(e){return e.getParam("table_advtab",!0,"boolean")},xr=function(e){return e.getParam("table_style_by_css",!1,"boolean")},Er=function(e){return"relative"===mr(e)||!0===pr(e)},_r=function(e){return"fixed"===mr(e)||!1===pr(e)},Ir=function(e){return"responsive"===mr(e)},Dr=function(e){var t="section",n=e.getParam("table_header_type",t,"string");return R(["section","cells","sectionCells","auto"],n)?n:t},Or=function(e){var t=e.getParam("table_clone_elements");return b(t)?p.some(t.split(/[ ,]/)):Array.isArray(t)?p.some(t):p.none()},wr=function(e){return e.nodeName.toLowerCase()},Rr=function(e){return Ce.fromDom(e.getBody())},Sr=function(e){return e.getBoundingClientRect().width},kr=function(e){return e.getBoundingClientRect().height},Ar=function(e){return function(t){return Ye(t,Rr(e))}},Nr=function(e){return/^\d+(\.\d+)?$/.test(e)?e+"px":e},Mr=function(e){de(e,"data-mce-style"),N(Qt(e),(function(e){return de(e,"data-mce-style")}))},Kr=function(e,t){var n=e.dom.getStyle(t,"width")||e.dom.getAttrib(t,"width");return p.from(n).filter(ve)},Pr=function(e){return/^(\d+(\.\d+)?)%$/.test(e)},Lr={isRtl:o(!1)},Br={isRtl:o(!0)},Fr=function(e){return"rtl"==("rtl"===mt(e,"direction")?"rtl":"ltr")?Br:Lr},zr=function(e){var t=e;return{get:function(){return t},set:function(e){t=e}}},Vr=function(e,t){var n=zr(parseFloat(e)),o=zr(_o(t));return{width:n.get,pixelWidth:o.get,getWidths:fi,getCellDelta:function(e){return e/o.get()*100},singleColumnWidth:function(e,t){return[100-e]},minCellWidth:function(){return Gt()/o.get()*100},setElementWidth:Yo,adjustTableWidth:function(e){var i=n.get(),r=i+e/100*i;Yo(t,r),n.set(r),o.set(_o(t))},label:"percent"}},Hr=function(e,t){var n=zr(e),o=n.get;return{width:o,pixelWidth:o,getWidths:hi,getCellDelta:i,singleColumnWidth:function(e,t){return[Math.max(Gt(),e+t)-e]},minCellWidth:Gt,setElementWidth:Xo,adjustTableWidth:function(e){var i=o()+e;Xo(t,i),n.set(i)},label:"pixel"}},Wr=function(e){return Jo(e).fold((function(){return function(e){var t=function(){return _o(e)},i=o(0);return{width:t,pixelWidth:t,getWidths:hi,getCellDelta:i,singleColumnWidth:o([0]),minCellWidth:i,setElementWidth:n,adjustTableWidth:n,label:"none"}}(e)}),(function(t){return function(e,t){var n=ri().exec(t);if(null!==n)return Vr(n[1],e);var o=ai().exec(t);if(null!==o){var i=parseInt(o[1],10);return Hr(i,e)}var r=_o(e);return Hr(r,e)}(e,t)}))},$r=Hr,Ur=Vr,qr=function(e,t){if(Er(e)){var n=Kr(e,t.dom()).filter(Pr).getOrThunk((function(){return Di(t)}));return Ur(n,t)}return _r(e)?$r(_o(t),t):Wr(t)},jr=function(e){de(e,"width")},Gr=function(e,t){var n,o,i,r;o=wi(Fr),i=qr(e,t),r=ii(n=t),Ei(n,p.some(r),p.none(),o,i),jr(n)},Xr=function(e,t){!function(e,t,n){var o=_o(e)+"px";Ei(e,p.some(o),p.none(),t,n),jr(e)}(t,wi(Fr),qr(e,t))},Yr=function(e){yt(e,"width"),N(Qt(e),(function(e){yt(e,"width"),jr(e)})),jr(e)},Zr=function(e,t){return{element:o(e),offset:o(t)}},Jr=function(e,t,n){return e.property().isText(t)&&0===e.property().getText(t).trim().length||e.property().isComment(t)?n(t).bind((function(t){return Jr(e,t,n).orThunk((function(){return p.some(t)}))})):p.none()},Qr=function(e,t){return e.property().isText(t)?e.property().getText(t).length:e.property().children(t).length},ea=function(e,t){var n=Jr(e,t,e.query().prevSibling).getOr(t);if(e.property().isText(n))return Zr(n,Qr(e,n));var o=e.property().children(n);return 0<o.length?ea(e,o[o.length-1]):Zr(n,Qr(e,n))},ta=ea,na=Vn(),oa=function(e,t){Jo(e).bind((function(e){var t=qo.exec(e);return null!==t?p.some({width:o(parseFloat(t[1])),unit:o(t[3])}):p.none()})).each((function(n){var o=n.width()/2;oi(e,o,n.unit()),oi(t,o,n.unit())}))},ia=function(e){return sn(e).grid},ra=function(e){for(var t=[],n=function(e){t.push(e)},o=0;o<e.length;o++)e[o].each(n);return t},aa=function(e,t,n,o){n===o?de(e,t):ae(e,t,n)},sa=function(e,t,n){e.cells()[t]=n},la=function(e,t){return At(t,e.section())},ua=function(e,t){var n=e.cells(),o=A(n,t);return At(o,e.section())},ca=function(e,t){return e.cells()[t]},da=function(e,t){return ca(e,t).element()},fa=function(e){return e.cells().length},ha=function(e,t){if(0===e.length)return 0;var n=e[0];return B(e,(function(e){return!t(n.element(),e.element())})).fold((function(){return e.length}),(function(e){return e}))},ga=function(e,t,n){for(var o=[],i=0;i<e.grid.rows();i++){for(var r=[],a=0;a<e.grid.columns();a++){var s=un(e,i,a).map((function(e){return kt(e.element(),n)})).getOrThunk((function(){return kt(t.gap(),!0)}));r.push(s)}var l=At(r,e.all[i].section());o.push(l)}return o},ma=function(e,t){return function(e,t){return A(e,(function(e){var n,i,r,a,s,l=(n=e.details(),W(n,(function(e){return et(e.element()).map((function(e){var t=et(e).isNone();return kt(e,t)}))})).getOrThunk((function(){return kt(t.row(),!0)})));return i=l.element(),r=e.details(),a=e.section(),s=l.isNew(),{element:o(i),cells:o(r),section:o(a),isNew:o(s)}}))}(function(e,t){var n=A(e,(function(e){return A(e.cells(),(function(){return!1}))}));return A(e,(function(i,r){var a,s;return a=z(i.cells(),(function(i,a){if(!1!==n[r][a])return[];var s,l,u,c,d=function(e,t,n,o){var i,r=e[t].cells().slice(n),a=ha(r,o),s=(i=n,A(e,(function(e){return ca(e,i)})).slice(t));return{colspan:a,rowspan:ha(s,o)}}(e,r,a,t);return function(e,t,o,i){for(var r=e;r<e+o;r++)for(var a=t;a<t+i;a++)n[r][a]=!0}(r,a,d.rowspan,d.colspan),[(s=i.element(),l=d.rowspan,u=d.colspan,c=i.isNew(),{element:o(s),rowspan:o(l),colspan:o(u),isNew:o(c)})]})),s=i.section(),{details:o(a),section:o(s)}}))}(e,Ye),t)},pa=function(e,t){return W(e.all,(function(e){return L(e.cells(),(function(e){return Ye(t,e.element())}))}))},va=function(e,t,n,i,a){return function(s,l,u,c,d,f){var h=sn(l);return t(h,u).map((function(t){var n=ga(h,c,!1),i=e(n,t,Ye,a(c)),r=ma(i.grid(),c);return{grid:o(r),cursor:i.cursor}})).fold((function(){return p.none()}),(function(e){var t=function(e,t){var n=[],o=[],i=H(Kt(e,"caption,colgroup")).fold((function(){return r(Tt,e)}),(function(e){return r(Ct,e)})),a=function(t,r){0<t.length?function(t,r){var a=zt(e,r).getOrThunk((function(){var t=Ce.fromTag(r,Qe(e).dom());return"thead"===r?i(t):xt(e,t),t}));Dt(a);var s=A(t,(function(e){e.isNew()&&n.push(e.element());var t=e.element();return Dt(t),N(e.cells(),(function(e){e.isNew()&&o.push(e.element()),aa(e.element(),"colspan",e.colspan(),1),aa(e.element(),"rowspan",e.rowspan(),1),xt(t,e.element())})),t}));It(a,s)}(t,r):zt(e,r).each(Ot)},s=[],l=[],u=[];return N(t,(function(e){switch(e.section()){case"thead":s.push(e);break;case"tbody":l.push(e);break;case"tfoot":u.push(e)}})),a(s,"thead"),a(l,"tbody"),a(u,"tfoot"),{newRows:n,newCells:o}}(l,e.grid()),a=p.from(f).getOrThunk((function(){return Wr(l)}));return n(l,e.grid(),d,a),i(l),rr(s,l,Po,d),p.some({cursor:e.cursor,newRows:o(t.newRows),newCells:o(t.newCells)})}))}},ya=function(e,t){return Jt(t.element()).bind((function(t){return pa(e,t)}))},ba=function(e,t){var n=A(t.selection(),(function(t){return Jt(t).bind((function(t){return pa(e,t)}))})),o=ra(n);return 0<o.length?p.some({cells:o,generators:t.generators,clipboard:t.clipboard}):p.none()},Ca=function(e,t){var n=A(t.selection(),(function(t){return Jt(t).bind((function(t){return pa(e,t)}))})),o=ra(n);return 0<o.length?p.some(o):p.none()},Ta=function(e,t,n,o){for(var i=!0,r=0;r<e.length;r++)for(var a=0;a<fa(e[0]);a++){var s=n(da(e[r],a),t);!0===s&&!1===i?sa(e[r],a,kt(o(),!0)):!0===s&&(i=!1)}return e},xa=function(e){return{is:function(t){return e===t},isValue:f,isError:d,getOr:o(e),getOrThunk:o(e),getOrDie:o(e),or:function(t){return xa(e)},orThunk:function(t){return xa(e)},fold:function(t,n){return n(e)},map:function(t){return xa(t(e))},mapError:function(t){return xa(e)},each:function(t){t(e)},bind:function(t){return t(e)},exists:function(t){return t(e)},forall:function(t){return t(e)},toOption:function(){return p.some(e)}}},Ea=function(e){return{is:d,isValue:d,isError:f,getOr:i,getOrThunk:function(e){return e()},getOrDie:function(){return t=String(e),function(){throw new Error(t)}();var t},or:function(e){return e},orThunk:function(e){return e()},fold:function(t,n){return t(e)},map:function(t){return Ea(e)},mapError:function(t){return Ea(t(e))},each:n,bind:function(t){return Ea(e)},exists:d,forall:f,toOption:p.none}},_a={value:xa,error:Ea,fromOption:function(e,t){return e.fold((function(){return Ea(t)}),xa)}},Ia=function(e,t){return{rowDelta:0,colDelta:fa(e[0])-fa(t[0])}},Da=function(e,t){return{rowDelta:e.length-t.length,colDelta:0}},Oa=function(e,t){return A(e,(function(){return kt(t.cell(),!0)}))},wa=function(e,t,n){return e.concat(k(t,(function(){return la(e[e.length-1],Oa(e[e.length-1].cells(),n))})))},Ra=function(e,t,n){return A(e,(function(e){return la(e,e.cells().concat(Oa(k(t,i),n)))}))},Sa=function(e,t,n){return(t.rowDelta<0?wa:i)((t.colDelta<0?Ra:i)(e,Math.abs(t.colDelta),n),Math.abs(t.rowDelta),n)},ka=function(e,t,n,o,i){var r,a,s,l;r=t,s=i,l=o.cell,0<(a=e)&&a<r[0].cells().length&&N(r,(function(e){var t=e.cells()[a-1],n=e.cells()[a];s(n.element(),t.element())&&sa(e,a,kt(l(),!0))}));var u=Da(n,t),c=Sa(n,u,o),d=Da(t,c),f=Sa(t,d,o);return A(f,(function(t,n){var o=t.cells().slice(0,e).concat(c[n].cells()).concat(t.cells().slice(e,t.cells().length));return la(t,o)}))},Aa=function(e,t,n,o,i){!function(e,t,n,o){if(0<t&&t<e.length){var i=e[t-1].cells(),r=(a=n,P(i,(function(e,t){return S(e,(function(e){return a(e.element(),t.element())}))?e:e.concat([t])}),[]));N(r,(function(i){for(var r=p.none(),a=function(t){for(var a=function(a){var s=e[t].cells()[a];n(s.element(),i.element())&&(r.isNone()&&(r=p.some(o())),r.each((function(n){sa(e[t],a,kt(n,!0))})))},s=0;s<fa(e[0]);s++)a(s)},s=t;s<e.length;s++)a(s)}))}var a}(t,e,i,o.cell);var r=Ia(n,t),a=Sa(n,r,o),s=Ia(t,a),l=Sa(t,s,o);return l.slice(0,e).concat(a).concat(l.slice(e,l.length))},Na=function(e,t,n,o,i){var r=e.slice(0,t),a=e.slice(t),s=ua(e[n],(function(n,r){return 0<t&&t<e.length&&o(da(e[t-1],r),da(e[t],r))?ca(e[t],r):kt(i(n.element(),o),!0)}));return r.concat([s]).concat(a)},Ma=function(e,t,n,o,i){return A(e,(function(e){var r,a,s,l,u,c,d,f=0<t&&t<fa(e)&&o(da(e,t-1),da(e,t))?ca(e,t):kt(i(da(e,n),o),!0);return a=t,s=f,u=(l=(r=e).cells()).slice(0,a),c=l.slice(a),d=u.concat([s]).concat(c),la(r,d)}))},Ka=function(e,t,n,o){return A(e,(function(e){return ua(e,(function(e){return i=e,S(t,(function(e){return n(i.element(),e.element())}))?kt(o(e.element(),n),!0):e;var i}))}))},Pa=function(e,t,n,o){return void 0!==da(e[t],n)&&0<t&&o(da(e[t-1],n),da(e[t],n))},La=function(e,t,n){return 0<t&&n(da(e,t-1),da(e,t))},Ba=function(e,t,n,o){var i=z(e,(function(o,i){return Pa(e,i,t,n)||La(o,t,n)?[]:[ca(o,t)]}));return Ka(e,i,n,o)},Fa=function(e,t,n,o){var i=e[t],r=z(i.cells(),(function(o,r){return Pa(e,t,r,n)||La(i,r,n)?[]:[o]}));return Ka(e,r,n,o)},za=ji(["cell","row","replace","gap"]),Va=function(e){var t=Wt(e,"colspan",1),n=Wt(e,"rowspan",1);return{element:o(e),colspan:o(t),rowspan:o(n)}},Ha=function(e,t){void 0===t&&(t=Va),za(e);var n=zr(p.none()),o=function(o){var r=function(n){var o=t(n);return e.cell(o)}(o);return n.get().isNone()&&n.set(p.some(r)),i=p.some({item:o,replacement:r}),r},i=p.none();return{getOrInit:function(e,t){return i.fold((function(){return o(e)}),(function(n){return t(e,n.item)?n.replacement:o(e)}))},cursor:n.get}},Wa=function(e,t){return function(n){var o=zr(p.none());za(n);var i=[],r=function(r){var a=n.replace(r,t,{scope:e});return i.push({item:r,sub:a}),o.get().isNone()&&o.set(p.some(a)),a};return{replaceOrInit:function(e,t){return n=e,o=t,L(i,(function(e){return o(e.item,n)})).fold((function(){return r(e)}),(function(n){return t(e,n.item)?n.sub:r(e)}));var n,o},cursor:o.get}}},$a=function(e){za(e);var t=zr(p.none());return{combine:function(n){return t.get().isNone()&&t.set(p.some(n)),function(){var t=e.cell({element:o(n),colspan:o(1),rowspan:o(1)});return yt(t,"width"),yt(n,"width"),t}},cursor:t.get}},Ua=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","table","thead","tfoot","tbody","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"],qa=Vn(),ja=function(e){return t=e,n=qa.property().name(t),R(Ua,n);var t,n},Ga=function(e){return t=e,n=qa.property().name(t),R(["ol","ul"],n);var t,n},Xa=function(e){0===Qt(e).length&&Ot(e)},Ya=function(e,t){return{grid:o(e),cursor:o(t)}},Za=function(e,t,n){return Ja(e,t,n).orThunk((function(){return Ja(e,0,0)}))},Ja=function(e,t,n){return p.from(e[t]).bind((function(e){return p.from(e.cells()[n]).bind((function(e){return p.from(e.element())}))}))},Qa=function(e,t,n){return Ya(e,Ja(e,t,n))},es=function(e){return P(e,(function(e,t){return S(e,(function(e){return e.row()===t.row()}))?e:e.concat([t])}),[]).sort((function(e,t){return e.row()-t.row()}))},ts=function(e){return P(e,(function(e,t){return S(e,(function(e){return e.column()===t.column()}))?e:e.concat([t])}),[]).sort((function(e,t){return e.column()-t.column()}))},ns=function(e,t,n){var o,i=(o=n,A(e,(function(e){var t=A(Qt(e),(function(e){var t=Wt(e,"rowspan",1),n=Wt(e,"colspan",1);return Rt(e,t,n)}));return St(e,t,o.section())}))),r=ln(i);return ga(r,t,!0)},os=function(e,t){var n=M(e,t);return 0===n.length?p.some("td"):n.length===e.length?p.some("th"):p.none()},is=function(e,t,n,o){var i=ln(t),r=o.getWidths(i,n,o),a=Mi(i,r);N(a,(function(e){o.setElementWidth(e.element,e.width)}))},rs=va((function(e,t,n,o){var i=t[0].row(),r=t[0].row(),a=es(t),s=P(a,(function(e,t){return Na(e,r,i,n,o.getOrInit)}),e);return Qa(s,r,t[0].column())}),Ca,n,n,Ha),as=va((function(e,t,n,o){var i=es(t),r=i[i.length-1].row(),a=i[i.length-1].row()+i[i.length-1].rowspan(),s=P(i,(function(e,t){return Na(e,a,r,n,o.getOrInit)}),e);return Qa(s,a,t[0].column())}),Ca,n,n,Ha),ss=va((function(e,t,n,o){var i=ts(t),r=i[0].column(),a=i[0].column(),s=P(i,(function(e,t){return Ma(e,a,r,n,o.getOrInit)}),e);return Qa(s,t[0].row(),a)}),Ca,is,n,Ha),ls=va((function(e,t,n,o){var i=t[t.length-1].column(),r=t[t.length-1].column()+t[t.length-1].colspan(),a=ts(t),s=P(a,(function(e,t){return Ma(e,r,i,n,o.getOrInit)}),e);return Qa(s,t[0].row(),r)}),Ca,is,n,Ha),us=va((function(e,t,n,o){var i,r,a,s,l=ts(t),u=(i=e,r=l[0].column(),a=l[l.length-1].column(),s=A(i,(function(e){var t=e.cells().slice(0,r).concat(e.cells().slice(a+1));return At(t,e.section())})),M(s,(function(e){return 0<e.cells().length}))),c=Za(u,t[0].row(),t[0].column());return Ya(u,c)}),Ca,is,Xa,Ha),cs=va((function(e,t,n,o){var i,r,a,s=es(t),l=(i=e,r=s[0].row(),a=s[s.length-1].row(),i.slice(0,r).concat(i.slice(a+1))),u=Za(l,t[0].row(),t[0].column());return Ya(l,u)}),Ca,n,Xa,Ha),ds=va((function(e,t,n,o){var i=Ba(e,t.column(),n,o.replaceOrInit);return Qa(i,t.row(),t.column())}),ya,n,n,Wa("row","th")),fs=va((function(e,t,n,o){var i=Ba(e,t.column(),n,o.replaceOrInit);return Qa(i,t.row(),t.column())}),ya,n,n,Wa(null,"td")),hs=(va((function(e,t,n,o){var i=Fa(e,t.row(),n,o.replaceOrInit);return Qa(i,t.row(),t.column())}),ya,n,n,Wa("col","th")),va((function(e,t,n,o){var i=Fa(e,t.row(),n,o.replaceOrInit);return Qa(i,t.row(),t.column())}),ya,n,n,Wa(null,"td")),va((function(e,t,n,i){var r=t.cells();!function(e){var t,n=function(e){return"br"===Z(e)},o=0===(t=z(e,(function(e){var t=it(e);return V(t,(function(e){return n(e)||ne(e)&&0===mn(e).trim().length}))?[]:t.concat(function(e){return xn(e).bind((function(t){var o=ot(t).map((function(e){return!!ja(e)||!!function(e){return t=e,R(["br","img","hr","input"],qa.property().name(t));var t}(e)&&"img"!==Z(e)})).getOr(!1);return et(t).map((function(i){return!0===o||"li"===Z(r=i)||Bt(r,Ga).isSome()||n(t)||ja(i)&&!Ye(e,i)?[]:[Ce.fromTag("br")];var r}))})).getOr([])}(e))}))).length?[Ce.fromTag("br")]:t;Dt(e[0]),It(e[0],o)}(r);var a=function(e,t,n){if(0===e.length)return e;for(var o=t.startRow();o<=t.finishRow();o++)for(var i=t.startCol();i<=t.finishCol();i++)sa(e[o],i,kt(n(),!1));return e}(e,t.bounds(),o(r[0]));return Ya(a,p.from(r[0]))}),(function(e,t){return t.mergable()}),n,n,$a)),gs=va((function(e,t,n,o){var i=K(t,(function(e,t){return Ta(e,t,n,o.combine(t))}),e);return Ya(i,p.from(t[0]))}),(function(e,t){return t.unmergable()}),is,n,$a),ms=va((function(e,t,n,i){var a,s,l,u,c,d=(a=t.clipboard(),s=t.generators(),l=sn(a),ga(l,s,!0));return function(e,t,n,o,i){return function(e,t,n){if(e.row()>=t.length||e.column()>fa(t[0]))return _a.error("invalid start address out of table bounds, row: "+e.row()+", column: "+e.column());var o=t.slice(e.row()),i=o[0].cells().slice(e.column()),r=fa(n[0]);return _a.value({rowDelta:o.length-n.length,colDelta:i.length-r})}(e,t,n).map((function(a){var s=Sa(t,a,o);return function(e,t,n,o,i){for(var a,s,l,u,c,d=e.row(),f=e.column(),h=d+n.length,g=f+fa(n[0]),m=d;m<h;m++)for(var p=f;p<g;p++){c=u=void 0,u=r(i,ca((a=t)[s=m],l=p).element()),c=a[s],1<a.length&&1<fa(c)&&(0<l&&u(da(c,l-1))||l<c.cells().length-1&&u(da(c,l+1))||0<s&&u(da(a[s-1],l))||s<a.length-1&&u(da(a[s+1],l)))&&Ta(t,da(t[m],p),i,o.cell);var v=da(n[m-d],p-f),y=o.replace(v);sa(t[m],p,kt(y,!0))}return t}(e,s,n,o,i)}))}((u=t.row(),c=t.column(),{row:o(u),column:o(c)}),e,d,t.generators(),n).fold((function(){return Ya(e,p.some(t.element()))}),(function(e){var n=Za(e,t.row(),t.column());return Ya(e,n)}))}),(function(e,t){return Jt(t.element()).bind((function(n){return pa(e,n).map((function(e){return Te(Te({},e),{generators:t.generators,clipboard:t.clipboard})}))}))}),is,n,Ha),ps=va((function(e,t,n,o){var i=e[t.cells[0].row()],r=t.cells[0].column(),a=ns(t.clipboard(),t.generators(),i),s=ka(r,e,a,t.generators(),n),l=Za(s,t.cells[0].row(),t.cells[0].column());return Ya(s,l)}),ba,n,n,Ha),vs=va((function(e,t,n,o){var i=e[t.cells[0].row()],r=t.cells[t.cells.length-1].column()+t.cells[t.cells.length-1].colspan(),a=ns(t.clipboard(),t.generators(),i),s=ka(r,e,a,t.generators(),n),l=Za(s,t.cells[0].row(),t.cells[0].column());return Ya(s,l)}),ba,n,n,Ha),ys=va((function(e,t,n,o){var i=e[t.cells[0].row()],r=t.cells[0].row(),a=ns(t.clipboard(),t.generators(),i),s=Aa(r,e,a,t.generators(),n),l=Za(s,t.cells[0].row(),t.cells[0].column());return Ya(s,l)}),ba,n,n,Ha),bs=va((function(e,t,n,o){var i=e[t.cells[0].row()],r=t.cells[t.cells.length-1].row()+t.cells[t.cells.length-1].rowspan(),a=ns(t.clipboard(),t.generators(),i),s=Aa(r,e,a,t.generators(),n),l=Za(s,t.cells[0].row(),t.cells[0].column());return Ya(s,l)}),ba,n,n,Ha),Cs=function(e,t){var n=sn(e);return Ca(n,t).bind((function(e){var t=e[e.length-1],o=e[0].column(),i=t.column()+t.colspan(),r=F(A(n.all,(function(e){return M(e.cells(),(function(e){return e.column()>=o&&e.column()<i}))})));return os(r,(function(e){return"th"===Z(e.element())}))})).getOr("")},Ts=function(e){return wr(e.parentNode)},xs=function(e,t){var n="thead"===Ts(t),o=!S(t.cells,(function(e){return"th"!==wr(e)}));return n||o?p.some({thead:n,ths:o}):p.none()},Es=function(e,t){return"thead"===(n=xs(0,t).fold((function(){return Ts(t)}),(function(e){return"thead"})))?"header":"tfoot"===n?"footer":"body";var n},_s=function(e,t,n){var o=e.getParent(t,"table"),i=t.parentNode,r=wr(i);if(n!==r){var a=e.select(n,o)[0];if(!a){a=e.create(n);var s=o.firstChild;"thead"===n?H(Kt(Ce.fromDom(o),"caption,colgroup")).fold((function(){return o.insertBefore(a,s)}),(function(t){return e.insertAfter(a,t.dom())})):o.appendChild(a)}"tbody"===n&&"thead"===r&&a.firstChild?a.insertBefore(t,a.firstChild):a.appendChild(t),i.hasChildNodes()||e.remove(i)}},Is=function(e,t,n,o){return N(t,(function(t){var i=wr(t)!==n?e.rename(t,n):t;e.setAttrib(i,"scope",o)}))},Ds=function(e,t,n){var o,i=e.dom;if("header"===n){var r=Dr(e),a="auto"===r?(o=en(Ce.fromDom(t.cells[0])).map((function(e){return tn(e)})).getOr([]),W(o,(function(e){return xs(0,e.dom())})).map((function(e){return e.thead&&e.ths?"sectionCells":e.thead?"section":"cells"})).getOr("section")):r;Is(i,t.cells,"section"===a?"td":"th","col"),_s(i,t,"cells"===a?"tbody":"thead")}else Is(i,t.cells,"td",null),_s(i,t,"footer"===n?"tfoot":"tbody")},Os=function(e){return{get:function(){var t=Rr(e);return jn(t,Yn).fold((function(){return void 0===e.selection.getStart()?ao():lo(e.selection)}),(function(e){return so(e)}))}}},ws=function(e){return function(t){return p.from(t.dom.getParent(t.selection.getStart(),e)).map((function(e){return Ce.fromDom(e)}))}},Rs=ws("th,td"),Ss=ws("th,td,caption"),ks=function(e){return Rs(e).map((function(t){return uo(t,Os(e))})).map((function(e){return A(e,(function(e){return e.dom()}))})).getOr([])},As=function(e){var t,n,o,i=Rs(e);return n=i.bind((function(e){return en(e)})).map((function(e){return tn(e)})).map((function(e){return A(e,(function(e){return e.dom()}))})),o=function(t,n){return M(n,(function(n){return S(n.cells,(function(n){return"1"===e.dom.getAttrib(n,Xn)||n===t.dom()}))}))},((t=i).isSome()&&n.isSome()?p.some(o(t.getOrDie(),n.getOrDie())):p.none()).getOr([])},Ns={styles:{"border-collapse":"collapse",width:"100%"},attributes:{border:"1"}},Ms=function(e,t,n,o){return k(e,(function(e){return function(e,t,n,o){for(var i=Ce.fromTag("tr"),r=0;r<e;r++){var a=Ce.fromTag(o<t||r<n?"th":"td");r<n&&ae(a,"scope","row"),o<t&&ae(a,"scope","col"),xt(a,Ce.fromTag("br")),xt(i,a)}return i}(t,n,o,e)}))},Ks=function(e,t){e.selection.select(t.dom(),!0),e.selection.collapse(!0)},Ps=function(e,t,n,o,i){var a=yr(e),s={styles:a,attributes:vr(e)},l=function(e,t,n,o,i,r){void 0===r&&(r=Ns);var a=Ce.fromTag("table"),s="cells"!==i;gt(a,r.styles),se(a,r.attributes);var l=Math.min(e,n);if(s&&0<n){var u=Ce.fromTag("thead");xt(a,u);var c=Ms(n,t,"sectionCells"===i?l:0,o);It(u,c)}var d=Ce.fromTag("tbody");xt(a,d);var f=Ms(s?e-l:e,t,s?0:n,o);return It(d,f),a}(n,t,i,o,Dr(e),s);ae(l,"data-mce-id","__mce");var u,c,d,f=(u=l,c=Ce.fromTag("div"),d=Ce.fromDom(u.dom().cloneNode(!0)),xt(c,d),c.dom().innerHTML);return e.insertContent(f),Vt(Rr(e),'table[data-mce-id="__mce"]').map((function(t){var n,o,i;return _r(e)?Xr(e,t):Ir(e)?Yr(t):(Er(e)||b(n=a.width)&&-1!==n.indexOf("%"))&&Gr(e,t),Mr(t),de(t,"data-mce-id"),o=e,N(Pt(t,"tr"),(function(e){dr(o,e.dom()),N(Pt(e,"th,td"),(function(e){fr(o,e.dom())}))})),i=e,Vt(t,"td,th").each(r(Ks,i)),t.dom()})).getOr(null)},Ls=function(e,t,n,o,i){void 0===o&&(o={});var r=function(e){return I(e)&&0<e};return r(t)&&r(n)?Ps(e,n,t,o.headerColumns||0,o.headerRows||0):(console.error(i),null)},Bs=function(e){return function(){return e().fold((function(){return[]}),(function(e){return A(e,(function(e){return e.dom()}))}))}},Fs=function(e){return function(t){var n=0<t.length?p.some(A(t,Ce.fromDom)):p.none();e(n)}},zs=tinymce.util.Tools.resolve("tinymce.util.Tools"),Vs=function(e,t,n){return function(t,o){for(var i=0;i<o.length;i++){var r=e.getStyle(o[i],n);if(void 0===t&&(t=r),t!==r)return""}return t}(void 0,e.select("td,th",t))},Hs=function(e,t,n){n&&e.formatter.apply("align"+n,{},t)},Ws=function(e,t){zs.each("left center right".split(" "),(function(n){e.formatter.remove("align"+n,{},t)}))},$s=function(e,t){return(t||[]).concat(A(e,(function(e){return{text:e.text||e.title,value:e.value}})))},Us=function(e){return function(t){return he(t,"rgb",0)?e.toHex(t):t}},qs=function(e,t){var n=Ce.fromDom(t);return{borderwidth:vt(n,"border-width").getOr(""),borderstyle:vt(n,"border-style").getOr(""),bordercolor:vt(n,"border-color").map(Us(e)).getOr(""),backgroundcolor:vt(n,"background-color").map(Us(e)).getOr("")}},js=function(e){var t=e[0],n=e.slice(1);return N(n,(function(e){N($(t),(function(n){q(e,(function(e,o){var i=t[n];""!==i&&n===o&&i!==e&&(t[n]="")}))}))})),t},Gs=function(e){var t=[{name:"borderstyle",type:"selectbox",label:"Border style",items:[{text:"Select...",value:""},{text:"Solid",value:"solid"},{text:"Dotted",value:"dotted"},{text:"Dashed",value:"dashed"},{text:"Double",value:"double"},{text:"Groove",value:"groove"},{text:"Ridge",value:"ridge"},{text:"Inset",value:"inset"},{text:"Outset",value:"outset"},{text:"None",value:"none"},{text:"Hidden",value:"hidden"}]},{name:"bordercolor",type:"colorinput",label:"Border color"},{name:"backgroundcolor",type:"colorinput",label:"Background color"}];return{title:"Advanced",name:"advanced",items:"cell"===e?[{name:"borderwidth",type:"input",label:"Border width"}].concat(t):t}},Xs=function(e,t,n,o){return L(e,(function(e){return n.formatter.matchNode(o,t+e)})).getOr("")},Ys=r(Xs,["left","center","right"],"align"),Zs=r(Xs,["top","middle","bottom"],"valign"),Js=[{name:"width",type:"input",label:"Width"},{name:"height",type:"input",label:"Height"},{name:"celltype",type:"selectbox",label:"Cell type",items:[{text:"Cell",value:"td"},{text:"Header cell",value:"th"}]},{name:"scope",type:"selectbox",label:"Scope",items:[{text:"None",value:""},{text:"Row",value:"row"},{text:"Column",value:"col"},{text:"Row group",value:"rowgroup"},{text:"Column group",value:"colgroup"}]},{name:"halign",type:"selectbox",label:"H Align",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{name:"valign",type:"selectbox",label:"V Align",items:[{text:"None",value:""},{text:"Top",value:"top"},{text:"Middle",value:"middle"},{text:"Bottom",value:"bottom"}]}],Qs=function(e){return(0<(t=$s(e.getParam("table_cell_class_list",[],"array"))).length?p.some({name:"class",type:"selectbox",label:"Class",items:t}):p.none()).fold((function(){return Js}),(function(e){return Js.concat(e)}));var t},el=function(e){return function(t,n){var o=t.dom;return{setAttrib:function(t,i){e&&!i||o.setAttrib(n,t,i)},setStyle:function(t,i){e&&!i||o.setStyle(n,t,i)},setFormat:function(o,i){e&&!i||(""===i?t.formatter.remove(o,{value:null},n,!0):t.formatter.apply(o,{value:i},n))}}}},tl={normal:el(!1),ifTruthy:el(!0)},nl=function(e,t,n){var o=n.getData();n.close(),e.undoManager.transact((function(){(function(e,t,n){var o=e.dom,i=1===t.length;N(t,(function(t){var r,a,s,l,u,c,d,f=n.celltype&&wr(t)!==n.celltype?o.rename(t,n.celltype):t,h=i?tl.normal(e,f):tl.ifTruthy(e,f);(r=h).setAttrib("scope",(a=n).scope),r.setAttrib("class",a.class),r.setStyle("width",Nr(a.width)),r.setStyle("height",Nr(a.height)),br(e)&&((s=h).setFormat("tablecellbackgroundcolor",(l=n).backgroundcolor),s.setFormat("tablecellbordercolor",l.bordercolor),s.setFormat("tablecellborderstyle",l.borderstyle),s.setFormat("tablecellborderwidth",Nr(l.borderwidth))),i&&(Ws(e,f),u=e,c=f,zs.each("top middle bottom".split(" "),(function(e){u.formatter.remove("valign"+e,{},c)}))),n.halign&&Hs(e,f,n.halign),n.valign&&(d=n.valign)&&e.formatter.apply("valign"+d,{},f)}))})(e,t,o),e.focus()}))},ol=function(e){var t=ks(e);if(0!==t.length){var n=A(t,(function(t){return o=t,i=br(n=e),Te({width:(r=n.dom).getStyle(o,"width")||r.getAttrib(o,"width"),height:r.getStyle(o,"height")||r.getAttrib(o,"height"),scope:r.getAttrib(o,"scope"),celltype:wr(o),class:r.getAttrib(o,"class",""),halign:Ys(n,o),valign:Zs(n,o)},i?qs(r,o):{});var n,o,i,r})),o=js(n),i={type:"tabpanel",tabs:[{title:"General",name:"general",items:Qs(e)},Gs("cell")]},a={type:"panel",items:[{type:"grid",columns:2,items:Qs(e)}]};e.windowManager.open({title:"Cell Properties",size:"normal",body:br(e)?i:a,buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:o,onSubmit:r(nl,e,t)})}},il=[{type:"selectbox",name:"type",label:"Row type",items:[{text:"Header",value:"header"},{text:"Body",value:"body"},{text:"Footer",value:"footer"}]},{type:"selectbox",name:"align",label:"Alignment",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{label:"Height",name:"height",type:"input"}],rl=function(e){return(0<(t=$s(e.getParam("table_row_class_list",[],"array"))).length?p.some({name:"class",type:"selectbox",label:"Class",items:t}):p.none()).fold((function(){return il}),(function(e){return il.concat(e)}));var t},al=function(e,t,n,o){var i=o.getData();o.close(),e.undoManager.transact((function(){(function(e,t,n,o){var i=1===t.length;N(t,(function(t){o.type!==wr(t.parentNode)&&Ds(e,t,o.type);var r,a,s,l,u=i?tl.normal(e,t):tl.ifTruthy(e,t);(r=u).setAttrib("scope",(a=o).scope),r.setAttrib("class",a.class),r.setStyle("height",Nr(a.height)),Cr(e)&&((s=u).setStyle("background-color",(l=o).backgroundcolor),s.setStyle("border-color",l.bordercolor),s.setStyle("border-style",l.borderstyle)),o.align!==n.align&&(Ws(e,t),Hs(e,t,o.align))}))})(e,t,n,i),e.focus()}))},sl=function(e){var t=As(e);if(0!==t.length){var n=A(t,(function(t){return o=t,i=Cr(n=e),Te({height:(r=n.dom).getStyle(o,"height")||r.getAttrib(o,"height"),scope:r.getAttrib(o,"scope"),class:r.getAttrib(o,"class",""),type:Es(0,o),align:Ys(n,o)},i?qs(r,o):{});var n,o,i,r})),o=js(n),i={type:"tabpanel",tabs:[{title:"General",name:"general",items:rl(e)},Gs("row")]},a={type:"panel",items:[{type:"grid",columns:2,items:rl(e)}]};e.windowManager.open({title:"Row Properties",size:"normal",body:Cr(e)?i:a,buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:o,onSubmit:r(al,e,t,o)})}},ll=tinymce.util.Tools.resolve("tinymce.Env"),ul=function(e,t,n,o){if("TD"===t.tagName||"TH"===t.tagName)b(n)?e.setStyle(t,n,o):e.setStyle(t,n);else if(t.children)for(var i=0;i<t.children.length;i++)ul(e,t.children[i],n,o)},cl=function(e,t,n){var o,i=e.dom,r=n.getData();n.close(),""===r.class&&delete r.class,e.undoManager.transact((function(){if(!t){var n=parseInt(r.cols,10)||1,a=parseInt(r.rows,10)||1;t=Ps(e,n,a,0,0)}!function(e,t,n){var o,i=e.dom,r={},a={};if(r.class=n.class,a.height=Nr(n.height),i.getAttrib(t,"width")&&!xr(e)?r.width=(o=n.width)?o.replace(/px$/,""):"":a.width=Nr(n.width),xr(e)?(a["border-width"]=Nr(n.border),a["border-spacing"]=Nr(n.cellspacing)):(r.border=n.border,r.cellpadding=n.cellpadding,r.cellspacing=n.cellspacing),xr(e)&&t.children)for(var s=0;s<t.children.length;s++)ul(i,t.children[s],{"border-width":Nr(n.border),padding:Nr(n.cellpadding)}),Tr(e)&&ul(i,t.children[s],{"border-color":n.bordercolor});Tr(e)&&(a["background-color"]=n.backgroundcolor,a["border-color"]=n.bordercolor,a["border-style"]=n.borderstyle),r.style=i.serializeStyle(Te(Te({},yr(e)),a)),i.setAttribs(t,Te(Te({},vr(e)),r))}(e,t,r),(o=i.select("caption",t)[0])&&!r.caption&&i.remove(o),!o&&r.caption&&((o=i.create("caption")).innerHTML=ll.ie?" ":'<br data-mce-bogus="1"/>',t.insertBefore(o,t.firstChild)),""===r.align?Ws(e,t):Hs(e,t,r.align),e.focus(),e.addVisual()}))},dl=function(e,t){var n,o,i,a,s,l,u,c,d=e.dom,f=function(e,t){var n,o,i,r,a=yr(e),s=vr(e),l=t?(n=e.dom,{borderstyle:X(a,"border-style").getOr(""),bordercolor:Us(n)(X(a,"border-color").getOr("")),backgroundcolor:Us(n)(X(a,"background-color").getOr(""))}):{};return Te(Te(Te(Te(Te(Te({},{height:"",width:"100%",cellspacing:"",cellpadding:"",caption:!1,class:"",align:"",border:""}),a),s),l),(r=a["border-width"],xr(e)&&r?{border:r}:X(s,"border").fold((function(){return{}}),(function(e){return{border:e}})))),(o=X(a,"border-spacing").or(X(s,"cellspacing")).fold((function(){return{}}),(function(e){return{cellspacing:e}})),i=X(a,"border-padding").or(X(s,"cellpadding")).fold((function(){return{}}),(function(e){return{cellpadding:e}})),Te(Te({},o),i)))}(e,Tr(e));!1===t?(n=d.getParent(e.selection.getStart(),"table"))?(i=n,a=Tr(o=e),f=Te({width:(c=o.dom).getStyle(i,"width")||c.getAttrib(i,"width"),height:c.getStyle(i,"height")||c.getAttrib(i,"height"),cellspacing:c.getStyle(i,"border-spacing")||c.getAttrib(i,"cellspacing"),cellpadding:c.getAttrib(i,"cellpadding")||Vs(o.dom,i,"padding"),border:(s=c,l=i,u=vt(Ce.fromDom(l),"border-width"),xr(o)&&u.isSome()?u.getOr(""):s.getAttrib(l,"border")||Vs(o.dom,l,"border-width")||Vs(o.dom,l,"border")),caption:!!c.select("caption",i)[0],class:c.getAttrib(i,"class",""),align:Ys(o,i)},a?qs(c,i):{})):Tr(e)&&(f.borderstyle="",f.bordercolor="",f.backgroundcolor=""):(f.cols="1",f.rows="1",Tr(e)&&(f.borderstyle="",f.bordercolor="",f.backgroundcolor=""));var h=$s(e.getParam("table_class_list",[],"array"));0<h.length&&f.class&&(f.class=f.class.replace(/\s*mce\-item\-table\s*/g,""));var g,m,p,v,y={type:"grid",columns:2,items:(g=h,m=t?[{type:"input",name:"cols",label:"Cols",inputMode:"numeric"},{type:"input",name:"rows",label:"Rows",inputMode:"numeric"}]:[],p=e.getParam("table_appearance_options",!0,"boolean")?[{type:"input",name:"cellspacing",label:"Cell spacing",inputMode:"numeric"},{type:"input",name:"cellpadding",label:"Cell padding",inputMode:"numeric"},{type:"input",name:"border",label:"Border width"},{type:"label",label:"Caption",items:[{type:"checkbox",name:"caption",label:"Show caption"}]}]:[],v=0<g.length?[{type:"selectbox",name:"class",label:"Class",items:g}]:[],m.concat([{type:"input",name:"width",label:"Width"},{type:"input",name:"height",label:"Height"}]).concat(p).concat([{type:"selectbox",name:"align",label:"Alignment",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]}]).concat(v))},b=Tr(e)?{type:"tabpanel",tabs:[{title:"General",name:"general",items:[y]},Gs("table")]}:{type:"panel",items:[y]};e.windowManager.open({title:"Table Properties",size:"normal",body:b,onSubmit:r(cl,e,n),buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:f})},fl=oo([{none:["current"]},{first:["current"]},{middle:["current","target"]},{last:["current"]}]),hl=Te(Te({},fl),{none:function(e){return void 0===e&&(e=void 0),fl.none(e)}}),gl=function(e,t){return en(e,t).bind((function(t){var n=Qt(t);return B(n,(function(t){return Ye(e,t)})).map((function(e){return{index:e,all:n}}))}))},ml=function(e,t,n,i){return{start:o(e),soffset:o(t),finish:o(n),foffset:o(i)}},pl=oo([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),vl={before:pl.before,on:pl.on,after:pl.after,cata:function(e,t,n,o){return e.fold(t,n,o)},getStart:function(e){return e.fold(i,i,i)}},yl=oo([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),bl={domRange:yl.domRange,relative:yl.relative,exact:yl.exact,exactFromRange:function(e){return yl.exact(e.start(),e.soffset(),e.finish(),e.foffset())},getWin:function(e){var t=e.match({domRange:function(e){return Ce.fromDom(e.startContainer)},relative:function(e,t){return vl.getStart(e)},exact:function(e,t,n,o){return e}});return Ce.fromDom(t.dom().ownerDocument.defaultView)},range:ml},Cl=function(e,t,n){var o,i,r=e.document.createRange();return o=r,t.fold((function(e){o.setStartBefore(e.dom())}),(function(e,t){o.setStart(e.dom(),t)}),(function(e){o.setStartAfter(e.dom())})),i=r,n.fold((function(e){i.setEndBefore(e.dom())}),(function(e,t){i.setEnd(e.dom(),t)}),(function(e){i.setEndAfter(e.dom())})),r},Tl=function(e,t,n,o,i){var r=e.document.createRange();return r.setStart(t.dom(),n),r.setEnd(o.dom(),i),r},xl=function(e){return{left:o(e.left),top:o(e.top),right:o(e.right),bottom:o(e.bottom),width:o(e.width),height:o(e.height)}},El=oo([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),_l=function(e,t,n){return t(Ce.fromDom(n.startContainer),n.startOffset,Ce.fromDom(n.endContainer),n.endOffset)},Il=function(e,t){var n,i,r,a=(n=e,t.match({domRange:function(e){return{ltr:o(e),rtl:p.none}},relative:function(e,t){return{ltr:xe((function(){return Cl(n,e,t)})),rtl:xe((function(){return p.some(Cl(n,t,e))}))}},exact:function(e,t,o,i){return{ltr:xe((function(){return Tl(n,e,t,o,i)})),rtl:xe((function(){return p.some(Tl(n,o,i,e,t))}))}}}));return(r=(i=a).ltr()).collapsed?i.rtl().filter((function(e){return!1===e.collapsed})).map((function(e){return El.rtl(Ce.fromDom(e.endContainer),e.endOffset,Ce.fromDom(e.startContainer),e.startOffset)})).getOrThunk((function(){return _l(0,El.ltr,r)})):_l(0,El.ltr,r)},Dl=function(e,t){return Il(e,t).match({ltr:function(t,n,o,i){var r=e.document.createRange();return r.setStart(t.dom(),n),r.setEnd(o.dom(),i),r},rtl:function(t,n,o,i){var r=e.document.createRange();return r.setStart(o.dom(),i),r.setEnd(t.dom(),n),r}})},Ol=function(e,t,n){return t>=e.left&&t<=e.right&&n>=e.top&&n<=e.bottom},wl=function(e,t,n,o){return ne(t)?function(e,t,n,o){var i=e.dom().createRange();i.selectNode(t.dom());var r=i.getClientRects();return W(r,(function(e){return Ol(e,n,o)?p.some(e):p.none()})).map((function(i){return function(e,t,n,o,i){var r=function(n){var o=e.dom().createRange();return o.setStart(t.dom(),n),o.collapse(!0),o},a=mn(t).length,s=function(e,t,n,o,i){if(0===i)return 0;if(t===o)return i-1;for(var r=o,a=1;a<i;a++){var s=e(a),l=Math.abs(t-s.left);if(n<=s.bottom){if(n<s.top||r<l)return a-1;r=l}}return 0}((function(e){return r(e).getBoundingClientRect()}),n,o,i.right,a);return r(s)}(e,t,n,o,i)}))}(e,t,n,o):(r=t,a=n,s=o,l=(i=e).dom().createRange(),u=it(r),W(u,(function(e){return l.selectNode(e.dom()),Ol(l.getBoundingClientRect(),a,s)?wl(i,e,a,s):p.none()})));var i,r,a,s,l,u},Rl=function(e,t){return t-e.left<e.right-t},Sl=function(e,t,n){var o=e.dom().createRange();return o.selectNode(t.dom()),o.collapse(n),o},kl=function(e,t,n){var o=e.dom().createRange();o.selectNode(t.dom());var i=o.getBoundingClientRect(),r=Rl(i,n);return(!0===r?Tn:xn)(t).map((function(t){return Sl(e,t,r)}))},Al=function(e,t,n){var o=t.dom().getBoundingClientRect(),i=Rl(o,n);return p.some(Sl(e,t,i))},Nl=document.caretPositionFromPoint?function(e,t,n){return p.from(e.dom().caretPositionFromPoint(t,n)).bind((function(t){if(null===t.offsetNode)return p.none();var n=e.dom().createRange();return n.setStart(t.offsetNode,t.offset),n.collapse(),p.some(n)}))}:document.caretRangeFromPoint?function(e,t,n){return p.from(e.dom().caretRangeFromPoint(t,n))}:function(e,t,n){return Ce.fromPoint(e,t,n).bind((function(o){var i=function(){return n=e,r=t,(0===it(i=o).length?Al:kl)(n,i,r);var n,i,r};return 0===it(o).length?i():function(e,t,n,o){var i=e.dom().createRange();i.selectNode(t.dom());var r=i.getBoundingClientRect();return function(e,t,n,o){var i=e.dom().createRange();i.selectNode(t.dom());var r=i.getBoundingClientRect(),a=Math.max(r.left,Math.min(r.right,n)),s=Math.max(r.top,Math.min(r.bottom,o));return wl(e,t,a,s)}(e,t,Math.max(r.left,Math.min(r.right,n)),Math.max(r.top,Math.min(r.bottom,o)))}(e,o,t,n).orThunk(i)}))},Ml=function(e,t){var n=Z(e);return"input"===n?vl.after(e):R(["br","img"],n)?0===t?vl.before(e):vl.after(e):vl.on(e,t)},Kl=function(e,t){var n=e.fold(vl.before,Ml,vl.after),o=t.fold(vl.before,Ml,vl.after);return bl.relative(n,o)},Pl=function(e,t,n,o){var i=Ml(e,t),r=Ml(n,o);return bl.relative(i,r)},Ll=function(e,t){p.from(e.getSelection()).each((function(e){e.removeAllRanges(),e.addRange(t)}))},Bl=function(e,t,n,o,i){var r=Tl(e,t,n,o,i);Ll(e,r)},Fl=function(e,t){return Il(e,t).match({ltr:function(t,n,o,i){Bl(e,t,n,o,i)},rtl:function(t,n,o,i){var r,a,s,l,u=e.getSelection();if(u.setBaseAndExtent)u.setBaseAndExtent(t.dom(),n,o.dom(),i);else if(u.extend)try{a=n,s=o,l=i,(r=u).collapse(t.dom(),a),r.extend(s.dom(),l)}catch(d){Bl(e,o,i,t,n)}else Bl(e,o,i,t,n)}})},zl=function(e,t,n,o,i){var r=Pl(t,n,o,i);Fl(e,r)},Vl=function(e,t,n){var o=Kl(t,n);Fl(e,o)},Hl=function(e){var t=Ce.fromDom(e.anchorNode),n=Ce.fromDom(e.focusNode);return function(e,t,n,o){var i,r,a,s,l,u=(r=t,a=n,s=o,(l=Qe(i=e).dom().createRange()).setStart(i.dom(),r),l.setEnd(a.dom(),s),l),c=Ye(e,n)&&t===o;return u.collapsed&&!c}(t,e.anchorOffset,n,e.focusOffset)?p.some(ml(t,e.anchorOffset,n,e.focusOffset)):function(e){if(0<e.rangeCount){var t=e.getRangeAt(0),n=e.getRangeAt(e.rangeCount-1);return p.some(ml(Ce.fromDom(t.startContainer),t.startOffset,Ce.fromDom(n.endContainer),n.endOffset))}return p.none()}(e)},Wl=function(e){return p.from(e.getSelection()).filter((function(e){return 0<e.rangeCount})).bind(Hl).map((function(e){return bl.exact(e.start(),e.soffset(),e.finish(),e.foffset())}))},$l=tinymce.util.Tools.resolve("tinymce.util.VK"),Ul=function(e,t,n,o){return Gl(e,t,gl(i=n,void 0).fold((function(){return hl.none(i)}),(function(e){return e.index+1<e.all.length?hl.middle(i,e.all[e.index+1]):hl.last(i)})),o);var i},ql=function(e,t,n,o){return Gl(e,t,gl(i=n,void 0).fold((function(){return hl.none()}),(function(e){return 0<=e.index-1?hl.middle(i,e.all[e.index-1]):hl.first(i)})),o);var i},jl=function(e,t){return function(e){var t=bl.getWin(e).dom(),n=function(e,n,o,i){return Tl(t,e,n,o,i)},o=e.match({domRange:function(e){var t=Ce.fromDom(e.startContainer),n=Ce.fromDom(e.endContainer);return Pl(t,e.startOffset,n,e.endOffset)},relative:Kl,exact:Pl});return Il(t,o).match({ltr:n,rtl:n})}(bl.exact(t,0,t,0))},Gl=function(e,t,n,o,i){return n.fold(p.none,p.none,(function(e,t){return Tn(t).map((function(e){return jl(0,e)}))}),(function(n){return en(n,t).bind((function(t){var i,r=co(n);return e.undoManager.transact((function(){o.insertRowsAfter(t,r)})),i=Pt(t,"tr"),H(i).bind((function(e){return Vt(e,"td,th").map((function(e){return jl(0,e)}))}))}))}))},Xl=["table","li","dl"],Yl=function(e,t,n,o){if(e.keyCode===$l.TAB){var i=Rr(t),r=function(e){var t=Z(e);return Ye(e,i)||R(Xl,t)},a=t.selection.getRng();if(a.collapsed){var s=Ce.fromDom(a.startContainer);Jt(s,r).each((function(i){e.preventDefault(),(e.shiftKey?ql:Ul)(t,r,i,n,o).each((function(e){t.selection.setRng(e)}))}))}}},Zl=function(e,t){return{selection:o(e),kill:o(t)}},Jl=function(e,t,n,i){return{start:o(vl.on(e,t)),finish:o(vl.on(n,i))}},Ql=function(e,t){var n=Dl(e,t);return ml(Ce.fromDom(n.startContainer),n.startOffset,Ce.fromDom(n.endContainer),n.endOffset)},eu=Jl,tu=function(e,t,n,o,i){return Ye(n,o)?p.none():qn(n,o,t).bind((function(t){var o=t.boxes.getOr([]);return 0<o.length?(i(e,o,t.start,t.finish),p.some(Zl(p.some(eu(n,0,n,yn(n))),!0))):p.none()}))},nu=function(e,t){return{item:o(e),mode:o(t)}},ou=function(e,t,n,o){return void 0===o&&(o=iu),e.property().parent(t).map((function(e){return nu(e,o)}))},iu=function(e,t,n,o){return void 0===o&&(o=ru),n.sibling(e,t).map((function(e){return nu(e,o)}))},ru=function(e,t,n,o){void 0===o&&(o=ru);var i=e.property().children(t);return n.first(i).map((function(e){return nu(e,o)}))},au=[{current:ou,next:iu,fallback:p.none()},{current:iu,next:ru,fallback:p.some(ou)},{current:ru,next:ru,fallback:p.some(iu)}],su=function(e,t,n,o,i){return void 0===i&&(i=au),L(i,(function(e){return e.current===n})).bind((function(n){return n.current(e,t,o,n.next).orThunk((function(){return n.fallback.bind((function(n){return su(e,t,n,o)}))}))}))},lu=function(e,t,n,o,i,r){return su(e,t,o,i).bind((function(t){return r(t.item())?p.none():n(t.item())?p.some(t.item()):lu(e,t.item(),n,t.mode(),i,r)}))},uu=function(e){return function(t){return 0===e.property().children(t).length}},cu=function(e,t,n,o){return lu(e,t,n,iu,{sibling:function(e,t){return e.query().prevSibling(t)},first:function(e){return 0<e.length?p.some(e[e.length-1]):p.none()}},o)},du=function(e,t,n,o){return lu(e,t,n,iu,{sibling:function(e,t){return e.query().nextSibling(t)},first:function(e){return 0<e.length?p.some(e[0]):p.none()}},o)},fu=Vn(),hu=function(e,t){return cu(n=fu,e,uu(n),t);var n},gu=function(e,t){return du(n=fu,e,uu(n),t);var n},mu=oo([{none:["message"]},{success:[]},{failedUp:["cell"]},{failedDown:["cell"]}]),pu=function(e){return Ht(e,"tr")},vu=Te(Te({},mu),{verify:function(e,t,n,o,i,r,a){return Ht(o,"td,th",a).bind((function(n){return Ht(t,"td,th",a).map((function(t){return Ye(n,t)?Ye(o,n)&&yn(n)===i?r(t):mu.none("in same cell"):$n(pu,[n,t]).fold((function(){return i=n,a=(o=e).getRect(t),(s=o.getRect(i)).right>a.left&&s.left<a.right?mu.success():r(t);var o,i,a,s}),(function(e){return r(t)}))}))})).getOr(mu.none("default"))},cata:function(e,t,n,o,i){return e.fold(t,n,o,i)}}),yu=function(e){return"br"===Z(e)},bu=function(e,t,n){return t(e,n).bind((function(e){return ne(e)&&0===mn(e).trim().length?bu(e,t,n):p.some(e)}))},Cu=function(e,t){return{left:e.left,top:e.top+t,right:e.right,bottom:e.bottom+t}},Tu=function(e,t){return{left:e.left,top:e.top-t,right:e.right,bottom:e.bottom-t}},xu=function(e,t,n){return{left:e.left+t,top:e.top+n,right:e.right+t,bottom:e.bottom+n}},Eu=function(e){return{left:e.left,top:e.top,right:e.right,bottom:e.bottom}},_u=function(e,t){return p.some(e.getRect(t))},Iu=function(e,t,n){return te(t)?_u(e,t).map(Eu):ne(t)?(o=e,i=t,(0<=(r=n)&&r<yn(i)?o.getRangedRect(i,r,i,r+1):0<r?o.getRangedRect(i,r-1,i,r):p.none()).map(Eu)):p.none();var o,i,r},Du=function(e,t){return te(t)?_u(e,t).map(Eu):ne(t)?e.getRangedRect(t,0,t,yn(t)).map(Eu):p.none()},Ou=oo([{none:[]},{retry:["caret"]}]),wu=function(e,t,n){return Lt((function(e,t){return t(e)}),Bt,t,ja,void 0).fold(o(!1),(function(t){return Du(e,t).exists((function(e){return(t=n).left<(o=e).left||Math.abs(o.right-t.left)<1||t.left>o.right;var t,o}))}))},Ru={point:function(e){return e.bottom},adjuster:function(e,t,n,o,i){var r=Cu(i,5);return Math.abs(n.bottom-o.bottom)<1||n.top>i.bottom?Ou.retry(r):n.top===i.bottom?Ou.retry(Cu(i,1)):wu(e,t,i)?Ou.retry(xu(r,5,0)):Ou.none()},move:Cu,gather:gu},Su=function(e,t,n,o,i){return 0===i?p.some(o):(s=e,l=o.left,u=t.point(o),s.elementFromPoint(l,u).filter((function(e){return"table"===Z(e)})).isSome()?(a=i-1,Su(e,r=t,n,r.move(o,5),a)):e.situsFromPoint(o.left,t.point(o)).bind((function(r){return r.start().fold(p.none,(function(r){return Du(e,r).bind((function(a){return t.adjuster(e,r,a,n,o).fold(p.none,(function(o){return Su(e,t,n,o,i-1)}))})).orThunk((function(){return p.some(o)}))}),p.none)})));var r,a,s,l,u},ku=function(e,t,n){var o,i,r,a=e.move(n,5),s=Su(t,e,n,a,100).getOr(a);return r=t,((o=e).point(i=s)>r.getInnerHeight()?p.some(o.point(i)-r.getInnerHeight()):o.point(i)<0?p.some(-o.point(i)):p.none()).fold((function(){return t.situsFromPoint(s.left,e.point(s))}),(function(n){return t.scrollBy(0,n),t.situsFromPoint(s.left,e.point(s)-n)}))},Au={tryUp:r(ku,{point:function(e){return e.top},adjuster:function(e,t,n,o,i){var r=Tu(i,5);return Math.abs(n.top-o.top)<1||n.bottom<i.top?Ou.retry(r):n.bottom===i.top?Ou.retry(Tu(i,1)):wu(e,t,i)?Ou.retry(xu(r,5,0)):Ou.none()},move:Tu,gather:hu}),tryDown:r(ku,Ru),ieTryUp:function(e,t){return e.situsFromPoint(t.left,t.top-5)},ieTryDown:function(e,t){return e.situsFromPoint(t.left,t.bottom+5)},getJumpSize:o(5)},Nu=function(e,t,n,o,i,r){return 0===r?p.none():Pu(e,t,n,o,i).bind((function(a){var s=e.fromSitus(a),l=vu.verify(e,n,o,s.finish(),s.foffset(),i.failure,t);return vu.cata(l,(function(){return p.none()}),(function(){return p.some(a)}),(function(a){return Ye(n,a)&&0===o?Mu(e,n,o,Tu,i):Nu(e,t,a,0,i,r-1)}),(function(a){return Ye(n,a)&&o===yn(a)?Mu(e,n,o,Cu,i):Nu(e,t,a,yn(a),i,r-1)}))}))},Mu=function(e,t,n,o,i){return Iu(e,t,n).bind((function(t){return Ku(e,i,o(t,Au.getJumpSize()))}))},Ku=function(e,t,n){var o=je().browser;return o.isChrome()||o.isSafari()||o.isFirefox()||o.isEdge()?t.otherRetry(e,n):o.isIE()?t.ieRetry(e,n):p.none()},Pu=function(e,t,n,o,i){return Iu(e,n,o).bind((function(t){return Ku(e,i,t)}))},Lu=function(e,t,n,i,a){return Ht(i,"td,th",t).bind((function(i){return Ht(i,"table",t).bind((function(s){return function(e,t){return Bt(e,(function(e){return et(e).exists((function(e){return Ye(e,t)}))}),void 0).isSome()}(a,s)?function(e,t,n){return e.getSelection().bind((function(i){return function(e,t,n,i){var a,s,l;return(yu(t)?(a=e,s=t,(l=i).traverse(s).orThunk((function(){return bu(s,l.gather,a)})).map(l.relative)):function(e,t,n,i){return rt(a=t,s=n).filter(yu).orThunk((function(){return rt(a,s-1).filter(yu)})).bind((function(t){return i.traverse(t).fold((function(){return bu(t,i.gather,e).map(i.relative)}),(function(e){return function(e){return et(e).bind((function(t){var n=it(t);return function(e,t){return B(e,r(Ye,t))}(n,e).map((function(i){return{parent:o(t),children:o(n),element:o(e),index:o(i)}}))}))}(e).map((function(e){return vl.on(e.parent(),e.index())}))}))}));var a,s}(e,t,n,i)).map((function(e){return{start:o(e),finish:o(e)}}))}(t,i.finish(),i.foffset(),n).fold((function(){return p.some(Zr(i.finish(),i.foffset()))}),(function(o){var r=e.fromSitus(o),a=vu.verify(e,i.finish(),i.foffset(),r.finish(),r.foffset(),n.failure,t);return vu.cata(a,(function(e){return p.none()}),(function(){return p.none()}),(function(e){return p.some(Zr(e,0))}),(function(e){return p.some(Zr(e,yn(e)))}))}))}))}(l=e,u=t,c=n).bind((function(e){return Nu(l,u,e.element(),e.offset(),c,20).map(l.fromSitus)})).bind((function(e){return Ht(e.finish(),"td,th",t).map((function(t){return{start:o(i),finish:o(t),range:o(e)}}))})):p.none();var l,u,c}))}))},Bu=function(e,t,n,o,i,r){return je().browser.isIE()?p.none():r(o,t).orThunk((function(){return Lu(e,t,n,o,i).map((function(e){var t=e.range();return Zl(p.some(eu(t.start(),t.soffset(),t.finish(),t.foffset())),!0)}))}))},Fu=function(e,t){return Ht(e,"tr",t).bind((function(e){return Ht(e,"table",t).bind((function(n){var o=Pt(n,"tr");return Ye(e,o[0])?cu(fu,n,(function(e){return xn(e).isSome()}),t).map((function(e){var t=yn(e);return Zl(p.some(eu(e,t,e,t)),!0)})):p.none()}))}))},zu=function(e,t){return Ht(e,"tr",t).bind((function(e){return Ht(e,"table",t).bind((function(n){var o=Pt(n,"tr");return Ye(e,o[o.length-1])?du(fu,n,(function(e){return Tn(e).isSome()}),t).map((function(e){return Zl(p.some(eu(e,0,e,0)),!0)})):p.none()}))}))},Vu=function(e,t,n,o,i,r,a){return Lu(e,n,o,i,r).bind((function(e){return tu(t,n,e.start(),e.finish(),a)}))},Hu=function(e,t){return Ht(e,"td,th",t)},Wu={traverse:ot,gather:gu,relative:vl.before,otherRetry:Au.tryDown,ieRetry:Au.ieTryDown,failure:vu.failedDown},$u={traverse:nt,gather:hu,relative:vl.before,otherRetry:Au.tryUp,ieRetry:Au.ieTryUp,failure:vu.failedUp},Uu=function(e){return function(t){return t===e}},qu=Uu(38),ju=Uu(40),Gu=function(e){return 37<=e&&e<=40},Xu={isBackward:Uu(37),isForward:Uu(39)},Yu={isBackward:Uu(39),isForward:Uu(37)},Zu=function(e){return{left:e.left(),top:e.top(),right:e.right(),bottom:e.bottom(),width:e.width(),height:e.height()}},Ju=function(t){return{elementFromPoint:function(e,n){return Ce.fromPoint(Ce.fromDom(t.document),e,n)},getRect:function(e){return e.dom().getBoundingClientRect()},getRangedRect:function(e,n,o,i){var r=bl.exact(e,n,o,i);return function(e,t){var n,o,i;return 0<(i=0<(o=(n=Dl(e,t)).getClientRects()).length?o[0]:n.getBoundingClientRect()).width||0<i.height?p.some(i).map(xl):p.none()}(t,r).map(Zu)},getSelection:function(){return Wl(t).map((function(e){return Ql(t,e)}))},fromSitus:function(e){var n=bl.relative(e.start(),e.finish());return Ql(t,n)},situsFromPoint:function(e,n){return function(e,t,n){return o=t,i=n,r=Ce.fromDom(e.document),Nl(r,o,i).map((function(e){return ml(Ce.fromDom(e.startContainer),e.startOffset,Ce.fromDom(e.endContainer),e.endOffset)}));var o,i,r}(t,e,n).map((function(e){return Jl(e.start(),e.soffset(),e.finish(),e.foffset())}))},clearSelection:function(){t.getSelection().removeAllRanges()},collapseSelection:function(e){void 0===e&&(e=!1),Wl(t).each((function(n){return n.fold((function(t){return t.collapse(e)}),(function(n,o){var i=e?n:o;Vl(t,i,i)}),(function(n,o,i,r){var a=e?n:i,s=e?o:r;zl(t,a,s,a,s)}))}))},setSelection:function(e){zl(t,e.start(),e.soffset(),e.finish(),e.foffset())},setRelativeSelection:function(e,n){Vl(t,e,n)},selectContents:function(e){!function(e,t){var n,o,i=(n=t,function(e,t){e.selectNodeContents(t.dom())}(o=e.document.createRange(),n),o);Ll(e,i)}(t,e)},getInnerHeight:function(){return t.innerHeight},getScrollY:function(){var n,o,i,r;return(n=Ce.fromDom(t.document),o=void 0!==n?n.dom():e.document,i=o.body.scrollLeft||o.documentElement.scrollLeft,r=o.body.scrollTop||o.documentElement.scrollTop,go(i,r)).top()},scrollBy:function(n,o){var i,r,a;i=n,r=o,(void 0!==(a=Ce.fromDom(t.document))?a.dom():e.document).defaultView.scrollBy(i,r)}}},Qu=function(e,t){return{rows:e,cols:t}},ec=function(e){return!1===Hi(Ce.fromDom(e.target),"ephox-snooker-resizer-bar")};function tc(e,t,o){var i=function(t,n,o){var i=function(e){de(e,t.selected),de(e,t.firstSelected),de(e,t.lastSelected)},r=function(e){ae(e,t.selected,"1")},a=function(t){s(t),function(e){e.fire("TableSelectionClear")}(e)},s=function(e){var n=Pt(e,t.selectedSelector);N(n,i)};return{clearBeforeUpdate:s,clear:a,selectRange:function(e,o,i,s){a(e),N(o,r),ae(i,t.firstSelected,"1"),ae(s,t.lastSelected,"1"),n(o,i,s)},selectedSelector:t.selectedSelector,firstSelectedSelector:t.firstSelectedSelector,lastSelectedSelector:t.lastSelectedSelector}}(no,(function(t,i,r){o.targets().each((function(o){en(i).each((function(a){var s=Or(e),l=kn(n,Ce.fromDom(e.getDoc()),s),u=function(e,t,n){var o=sn(e);return Ca(o,t).map((function(e){var t,i,r,a,s,l,u,c,d,f=ga(o,n,!1);return{upOrLeftCells:(t=e,i=n,r=f.slice(0,t[t.length-1].row()+1),a=ma(r,i),z(a,(function(e){var n=e.cells().slice(0,t[t.length-1].column()+1);return A(n,(function(e){return e.element()}))}))),downOrRightCells:(l=e,u=n,c=(s=f).slice(l[0].row()+l[0].rowspan()-1,s.length),d=ma(c,u),z(d,(function(e){var t=e.cells().slice(l[0].column()+l[0].colspan()-1,+e.cells().length);return A(t,(function(e){return e.element()}))})))}}))}(a,o,l);!function(e,t,n,o,i){e.fire("TableSelectionChange",{cells:t,start:n,finish:o,otherCells:i})}(e,t,i,r,u)}))}))}));return e.on("init",(function(o){var a=e.getWin(),s=Rr(e),l=Ar(e),u=function(e,t,n,o){var i=function(e,t,n,o){var i=p.none(),r=function(){i=p.none()};return{mousedown:function(e){o.clear(t),i=Hu(e.target(),n)},mouseover:function(r){i.each((function(i){o.clearBeforeUpdate(t),Hu(r.target(),n).each((function(r){qn(i,r,n).each((function(n){var a=n.boxes.getOr([]);(1<a.length||1===a.length&&!Ye(i,r))&&(o.selectRange(t,a,n.start,n.finish),e.selectContents(r))}))}))}))},mouseup:function(e){i.each(r)}}}(Ju(e),t,n,o);return{mousedown:i.mousedown,mouseover:i.mouseover,mouseup:i.mouseup}}(a,s,l,i),c=function(e,t,n,o){var i=Ju(e),a=function(){return o.clear(t),p.none()};return{keydown:function(e,s,l,u,c,d){var f=e.raw(),h=f.which,g=!0===f.shiftKey;return jn(t,o.selectedSelector).fold((function(){return ju(h)&&g?r(Vu,i,t,n,Wu,u,s,o.selectRange):qu(h)&&g?r(Vu,i,t,n,$u,u,s,o.selectRange):ju(h)?r(Bu,i,n,Wu,u,s,zu):qu(h)?r(Bu,i,n,$u,u,s,Fu):p.none}),(function(e){var n=function(n){return function(){return W(n,(function(n){return i=t,function(e,t,n,o,i){return r=i,L(e,(function(e){return Ge(e,r)})).bind((function(e){return function(e,t,n){return en(e).bind((function(o){var i,r,a,s=Fn(o);return r=t,a=n,cn(i=s,e,Ye).bind((function(e){var t=0<r?e.row()+e.rowspan()-1:e.row(),n=0<a?e.column()+e.colspan()-1:e.column();return un(i,t+r,n+a).map((function(e){return e.element()}))}))}))}(e,t,n).bind((function(e){return n=o,Ft(t=e,"table").bind((function(e){return Vt(e,n).bind((function(e){return qn(e,t).bind((function(e){return e.boxes.map((function(t){return{boxes:t,start:e.start,finish:e.finish}}))}))}))}));var t,n}))}));var r}(e,n.rows,n.cols,(r=o).firstSelectedSelector,r.lastSelectedSelector).map((function(e){return r.clearBeforeUpdate(i),r.selectRange(i,e.boxes,e.start,e.finish),e.boxes}));var i,r})).fold((function(){return Gn(t,o.firstSelectedSelector,o.lastSelectedSelector).map((function(e){var n=ju(h)||d.isForward(h)?vl.after:vl.before;return i.setRelativeSelection(vl.on(e.first(),0),n(e.table())),o.clear(t),Zl(p.none(),!0)}))}),(function(e){return p.some(Zl(p.none(),!0))}))}};return ju(h)&&g?n([Qu(1,0)]):qu(h)&&g?n([Qu(-1,0)]):d.isBackward(h)&&g?n([Qu(0,-1),Qu(-1,0)]):d.isForward(h)&&g?n([Qu(0,1),Qu(1,0)]):Gu(h)&&0==g?a:p.none}))()},keyup:function(e,i,r,a,s){return jn(t,o.selectedSelector).fold((function(){var l,u,c,d,f,h,g,m=e.raw();return 0!=(!0===m.shiftKey)&&Gu(m.which)?(l=t,u=n,d=r,h=s,g=o.selectRange,Ye(c=i,f=a)&&d===h?p.none():Ht(c,"td,th",u).bind((function(e){return Ht(f,"td,th",u).bind((function(t){return tu(l,u,e,t,g)}))}))):p.none()}),p.none)}}}(a,s,l,i),d=function(e,t,n,o){var i=Ju(e);return function(e,r){o.clearBeforeUpdate(t),qn(e,r,n).each((function(e){var n=e.boxes.getOr([]);o.selectRange(t,n,e.start,e.finish),i.selectContents(r),i.collapseSelection()}))}}(a,s,l,i);e.on("TableSelectorChange",(function(e){return d(e.start,e.finish)}));var f,h,g=function(t,n){!0===t.raw().shiftKey&&(n.kill()&&t.kill(),n.selection().each((function(t){var n=bl.relative(t.start(),t.finish()),o=Dl(a,n);e.selection.setRng(o)})))},m=function(e){return 0===e.button},v=(f=zr(Ce.fromDom(s)),h=zr(0),{touchEnd:function(e){var t=Ce.fromDom(e.target);if("td"===Z(t)||"th"===Z(t)){var n=f.get(),o=h.get();Ye(n,t)&&e.timeStamp-o<300&&(e.preventDefault(),d(t,t))}f.set(t),h.set(e.timeStamp)}});e.on("mousedown",(function(e){m(e)&&ec(e)&&u.mousedown(Fi(e))})),e.on("mouseover",(function(e){var t;(void 0===(t=e).buttons||ll.browser.isEdge()&&0===t.buttons||0!=(1&t.buttons))&&ec(e)&&u.mouseover(Fi(e))})),e.on("mouseup",(function(e){m(e)&&ec(e)&&u.mouseup(Fi(e))})),e.on("touchend",v.touchEnd),e.on("keyup",(function(t){var n=Fi(t);if(n.raw().shiftKey&&Gu(n.raw().which)){var o=e.selection.getRng(),i=Ce.fromDom(o.startContainer),r=Ce.fromDom(o.endContainer);c.keyup(n,i,o.startOffset,r,o.endOffset).each((function(e){g(n,e)}))}})),e.on("keydown",(function(n){var o=Fi(n);t().each((function(e){return e.hideBars()}));var i=e.selection.getRng(),r=Ce.fromDom(e.selection.getStart()),a=Ce.fromDom(i.startContainer),s=Ce.fromDom(i.endContainer),l=Fr(r).isRtl()?Yu:Xu;c.keydown(o,a,i.startOffset,s,i.endOffset,l).each((function(e){g(o,e)})),t().each((function(e){return e.showBars()}))})),e.on("NodeChange",(function(){var t=e.selection,o=Ce.fromDom(t.getStart()),r=Ce.fromDom(t.getEnd());$n(en,[o,r]).fold((function(){return i.clear(s)}),n)}))})),{clear:i.clear}}var nc={tablecellbackgroundcolor:{selector:"td,th",styles:{backgroundColor:"%value"},remove_similar:!0},tablecellbordercolor:{selector:"td,th",styles:{borderColor:"%value"},remove_similar:!0},tablecellborderstyle:{selector:"td,th",styles:{borderStyle:"%value"},remove_similar:!0},tablecellborderwidth:{selector:"td,th",styles:{borderWidth:"%value"},remove_similar:!0}};t.add("table",(function(t){var i=Os(t),a=function(e,t){var n=zr(p.none()),o=zr([]),i=function(){return Ss(e).bind((function(e){return en(e).map((function(n){return"caption"===Z(e)?co(e):fo(t,n,e)}))}))},r=function(){n.set(xe(i)()),N(o.get(),(function(e){return e()}))},a=function(e,t){var i=function(){return n.get().fold((function(){e.setDisabled(!0)}),(function(n){e.setDisabled(t(n))}))};return i(),o.set(o.get().concat([i])),function(){o.set(M(o.get(),(function(e){return e!==i})))}};return e.on("NodeChange ExecCommand TableSelectorChange",r),{onSetupTable:function(e){return a(e,(function(e){return!1}))},onSetupCellOrRow:function(e){return a(e,(function(e){return"caption"===Z(e.element())}))},onSetupPasteable:function(e){return function(t){return a(t,(function(t){return"caption"===Z(t.element())||e().isNone()}))}},onSetupMergeable:function(e){return a(e,(function(e){return e.mergable().isNone()}))},onSetupUnmergeable:function(e){return a(e,(function(e){return e.unmergable().isNone()}))},resetTargets:r,targets:function(){return n.get()}}}(t,i),s=function(t){var n,i,r=p.none(),a=p.none(),s=p.none(),l=function(e){return"TABLE"===e.nodeName};return t.on("init",(function(){var n,i,l=wi(Fr),u=(n=t).inline?function(e,t){return{parent:o(t),view:o(e),origin:o(go(0,0))}}(Rr(n),function(){var t=Ce.fromTag("div");return gt(t,{position:"static",height:"0",width:"0",padding:"0",margin:"0",border:"0"}),xt(dt(Ce.fromDom(e.document)),t),t}()):yo(Ce.fromDom(n.getDoc()));if(s=p.some(u),i=t.getParam("object_resizing",!0),(b(i)?"table"===i:i)&&t.getParam("table_resize_bars",!0,"boolean")){var c=function(e,t,n){var i=Po,r=cr(e,t,i),a=Si({beforeResize:Ri(["table"]),afterResize:Ri(["table"]),startDrag:Ri([])});return r.events.adjustHeight.bind((function(e){var t=e.table();a.trigger.beforeResize(t),function(e,t,n,i){var r,a,s,l=sn(e),u=gi(l,i,ni,(function(e){return e.getOrThunk(Xt)})),c=A(u,(function(e,o){return n===o?Math.max(t+e,Xt()):e})),d=(r=c,a=fn(l),A(a,(function(e){var t=Ni(e.row(),e.row()+e.rowspan(),r);return{element:e.element,height:o(t),rowspan:e.rowspan}}))),f=(s=c,A(l.all,(function(e,t){return{element:e.element,height:o(s[t])}})));N(f,(function(e){Zo(e.element(),e.height())})),N(d,(function(e){Zo(e.element(),e.height())}));var h=K(c,(function(e,t){return e+t}),0);Zo(e,h)}(t,i.delta(e.delta(),t),e.row(),i),a.trigger.afterResize(t)})),r.events.startAdjust.bind((function(e){a.trigger.startDrag()})),r.events.adjustWidth.bind((function(e){var i=e.table();a.trigger.beforeResize(i);var r,s,l,u,c,d,f,h,g,m,p,v=t.delta(e.delta(),i),y=n(i);r=i,s=v,l=e.column(),u=t,d=(c=y).getCellDelta(s),f=sn(r),g=function(e,t,n,i){var r,a,s=e.slice(0),l=(a=t,0===(r=e).length?Ai.none():1===r.length?Ai.only(0):0===a?Ai.left(0,1):a===r.length-1?Ai.right(a-1,a):0<a&&a<r.length-1?Ai.middle(a-1,a,a+1):Ai.none()),u=function(e){return A(e,o(0))},c=o(u(s)),d=function(e,t){if(0<=n){var o=Math.max(i.minCellWidth(),s[t]-n);return u(s.slice(0,e)).concat([n,o-s[t]]).concat(u(s.slice(t+1)))}var r=Math.max(i.minCellWidth(),s[e]+n),a=s[e]-r;return u(s.slice(0,e)).concat([r-s[e],a]).concat(u(s.slice(t+1)))};return l.fold(c,(function(e){return i.singleColumnWidth(s[e],n)}),d,(function(e,t,n){return d(t,n)}),(function(e,t){if(0<=n)return u(s.slice(0,t)).concat([n]);var o=Math.max(i.minCellWidth(),s[t]+n);return u(s.slice(0,t)).concat([o-s[t]])}))}(h=c.getWidths(f,u,c),l,d,c),m=A(g,(function(e,t){return e+h[t]})),p=Mi(f,m),N(p,(function(e){c.setElementWidth(e.element,e.width)})),l===f.grid.columns()-1&&c.adjustTableWidth(d),a.trigger.afterResize(i)})),{on:r.on,off:r.off,hideBars:r.hideBars,showBars:r.showBars,destroy:r.destroy,events:a.registry}}(u,l,(function(e){return qr(t,e)}));c.on(),c.events.startDrag.bind((function(e){r=p.some(t.selection.getRng())})),c.events.beforeResize.bind((function(e){var n,o,i,r,a=e.table().dom();n=t,i=Sr(o=a),r=kr(a),n.fire("ObjectResizeStart",{target:o,width:i,height:r})})),c.events.afterResize.bind((function(e){var n,o,i,a,s=e.table(),l=s.dom();Mr(s),r.each((function(e){t.selection.setRng(e),t.focus()})),n=t,i=Sr(o=l),a=kr(l),n.fire("ObjectResized",{target:o,width:i,height:a}),t.undoManager.add()})),a=p.some(c)}})),t.on("ObjectResizeStart",(function(e){var o=e.target;if(l(o)){var r=Ce.fromDom(o);!Ii(r)&&_r(t)?Xr(t,r):!_i(r)&&Er(t)&&Gr(t,r),n=e.width,i=Kr(t,o).getOr("")}})),t.on("ObjectResized",(function(e){var o=e.target;if(l(o)){var r=Ce.fromDom(o);if(""===i||!Pr(i)&&Ir(t))Gr(t,r);else if(Pr(i)){var a=parseFloat(i.replace("%",""));ht(r,"width",e.width*a/n+"%")}else N(Qt(r),(function(e){var t=mt(e,"width");ht(e,"width",t),de(e,"width")}));Mr(r)}})),t.on("SwitchMode",(function(){a.each((function(e){t.mode.isReadOnly()?e.hideBars():e.showBars()}))})),{lazyResize:function(){return a},lazyWire:function(){return s.getOr(yo(Ce.fromDom(t.getBody())))},destroy:function(){a.each((function(e){e.destroy()})),s.each((function(e){t.inline&&Ot(e.parent())}))}}}(t),l=tc(t,s.lazyResize,a),u=function(e,t){var o=function(e){return"table"===Z(Rr(e))},i=Or(e),r=function(t,n,o,r){return function(a,s){Mr(a);var l=r(),u=Ce.fromDom(e.getDoc()),c=wi(Fr),d=kn(o,u,i),f=qr(e,a);return n(a)?t(l,a,s,d,c,f).bind((function(t){return N(t.newRows(),(function(t){dr(e,t.dom())})),N(t.newCells(),(function(t){fr(e,t.dom())})),t.cursor().map((function(t){var n=ta(na,t),o=e.dom.createRng();return o.setStart(n.element().dom(),n.offset()),o.setEnd(n.element().dom(),n.offset()),o}))})):p.none()}},a=r(cs,(function(t){return!1===o(e)||1<ia(t).rows()}),n,t),s=r(us,(function(t){return!1===o(e)||1<ia(t).columns()}),n,t),l=r(rs,f,n,t),u=r(as,f,n,t),c=r(ss,f,oa,t),d=r(ls,f,oa,t),h=r(hs,f,n,t),g=r(gs,f,n,t),m=r(ps,f,n,t),v=r(vs,f,n,t),y=r(ys,f,n,t),b=r(bs,f,n,t),C=r(ms,f,n,t),T=function(e,t){return X(e,"type").filter((function(e){return R(t,e)}))};return{deleteRow:a,deleteColumn:s,insertRowsBefore:l,insertRowsAfter:u,insertColumnsBefore:c,insertColumnsAfter:d,mergeCells:h,unmergeCells:g,pasteColsBefore:m,pasteColsAfter:v,pasteRowsBefore:y,pasteRowsAfter:b,pasteCells:C,setTableCellType:function(e,t){return T(t,["td","th"]).each((function(t){Is(e.dom,ks(e),t,null)}))},setTableRowType:function(e,t){return T(t,["header","body","footer"]).each((function(t){A(As(e),(function(n){return Ds(e,n,t)}))}))},makeColumnHeader:r(ds,f,n,t),unmakeColumnHeader:r(fs,f,n,t),getTableRowType:function(e){var t=As(e);if(0<t.length){var n=A(t,(function(e){return Es(0,e)})),o=R(n,"header"),i=R(n,"footer");if(o||i){var r=R(n,"body");return!o||r||i?o||r||!i?"":"footer":"header"}return"body"}},getTableCellType:function(e){return os(ks(e),(function(e){return"th"===wr(e)})).getOr("")},getTableColType:Cs}}(t,s.lazyWire),d=function(){var e=zr(p.none()),t=zr(p.none()),n=function(e){e.set(p.none())};return{getRows:e.get,setRows:function(o){e.set(o),n(t)},clearRows:function(){return n(e)},getColumns:t.get,setColumns:function(o){t.set(o),n(e)},clearColumns:function(){return n(t)}}}();return function(e,t,i,a,s){var l=Ar(e),u=function(e){return en(e,l)},d=function(t){return Rs(e).each((function(n){u(n).each((function(o){var r=fo(a,o,n);t(o,r).each((function(t){e.selection.setRng(t),e.focus(),i.clear(o),Mr(o)}))}))}))},f=function(){return Rs(e).map((function(t){return u(t).bind((function(o){return function(e,t,n){var o=sn(e);return Ca(o,t).map((function(e){var t=ga(o,n,!1).slice(e[0].row(),e[e.length-1].row()+e[e.length-1].rowspan()),i=ma(t,n);return A(i,(function(e){var t=In(e.element());return N(e.cells(),(function(e){var n=Dn(e.element());aa(n,"colspan",e.colspan(),1),aa(n,"rowspan",e.rowspan(),1),xt(t,n)})),t}))}))}(o,fo(a,o,t),kn(n,Ce.fromDom(e.getDoc()),p.none()))}))}))},h=function(){return Rs(e).map((function(e){return u(e).bind((function(t){return function(e,t){var n=sn(e);return Ca(n,t).map((function(e){var t=e[e.length-1],o=e[0].column(),i=t.column()+t.colspan();return A(n.all,(function(e){var t=M(e.cells(),(function(e){return e.column()>=o&&e.column()<i})),n=A(t,(function(e){var t,n,r,a,s=Dn(e.element());return r=i-o,a=$t(t=s,n="colspan"),1===r||a<=1?de(t,n):ae(t,n,Math.min(r,a)),s})),r=Ce.fromTag("tr");return It(r,n),r}))}))}(t,fo(a,t,e))}))}))},g=function(t,n){return n().each((function(n){var r=A(n,(function(e){return Dn(e)}));Rs(e).each((function(n){return u(n).each((function(s){var l,u,c=An(Ce.fromDom(e.getDoc())),d=(l=r,u=c,{selection:o(uo(n,a)),clipboard:o(l),generators:o(u)});t(s,d).each((function(t){e.selection.setRng(t),e.focus(),i.clear(s)}))}))}))}))};q({mceTableSplitCells:function(){return d(t.unmergeCells)},mceTableMergeCells:function(){return d(t.mergeCells)},mceTableInsertRowBefore:function(){return d(t.insertRowsBefore)},mceTableInsertRowAfter:function(){return d(t.insertRowsAfter)},mceTableInsertColBefore:function(){return d(t.insertColumnsBefore)},mceTableInsertColAfter:function(){return d(t.insertColumnsAfter)},mceTableDeleteCol:function(){return d(t.deleteColumn)},mceTableDeleteRow:function(){return d(t.deleteRow)},mceTableCutCol:function(e){return h().each((function(e){s.setColumns(e),d(t.deleteColumn)}))},mceTableCutRow:function(e){return f().each((function(e){s.setRows(e),d(t.deleteRow)}))},mceTableCopyCol:function(e){return h().each((function(e){return s.setColumns(e)}))},mceTableCopyRow:function(e){return f().each((function(e){return s.setRows(e)}))},mceTablePasteColBefore:function(e){return g(t.pasteColsBefore,s.getColumns)},mceTablePasteColAfter:function(e){return g(t.pasteColsAfter,s.getColumns)},mceTablePasteRowBefore:function(e){return g(t.pasteRowsBefore,s.getRows)},mceTablePasteRowAfter:function(e){return g(t.pasteRowsAfter,s.getRows)},mceTableDelete:function(){return Ss(e).each((function(t){en(t,l).filter(c(l)).each((function(t){var n=Ce.fromText("");if(Ct(t,n),Ot(t),e.dom.isEmpty(e.getBody()))e.setContent(""),e.selection.setCursorLocation();else{var o=e.dom.createRng();o.setStart(n.dom(),0),o.setEnd(n.dom(),0),e.selection.setRng(o),e.nodeChanged()}}))}))},mceTableSizingMode:function(t,n){return o=n,Ss(e).each((function(t){Ir(e)||_r(e)||Er(e)||en(t,l).each((function(t){"relative"!==o||_i(t)?"fixed"!==o||Ii(t)?"responsive"!==o||function(e){return Jo(e).isNone()}(t)||Yr(t):Xr(e,t):Gr(e,t),Mr(t)}))}));var o}},(function(t,n){return e.addCommand(n,t)})),q({mceTableCellType:function(n,o){return t.setTableCellType(e,o)},mceTableRowType:function(n,o){return t.setTableRowType(e,o)}},(function(t,n){return e.addCommand(n,t)})),e.addCommand("mceTableColType",(function(e,n){return X(n,"type").each((function(e){return d("th"===e?t.makeColumnHeader:t.unmakeColumnHeader)}))})),q({mceTableProps:r(dl,e,!1),mceTableRowProps:r(sl,e),mceTableCellProps:r(ol,e)},(function(t,n){return e.addCommand(n,(function(){return t()}))})),e.addCommand("mceInsertTable",(function(t,n){C(n)&&0<$(n).length?Ls(e,n.rows,n.columns,n.options,"Invalid values for mceInsertTable - rows and columns values are required to insert a table."):dl(e,!0)})),e.addCommand("mceTableApplyCellStyle",(function(t,n){if(C(n)){var o=ks(e);0!==o.length&&q(n,(function(t,n){var i="tablecell"+n.toLowerCase().replace("-","");e.formatter.has(i)&&b(t)&&N(o,(function(n){tl.normal(e,n).setFormat(i,t)}))}))}}))}(t,u,l,i,d),function(e,t,n){var o=Ar(e);q({mceTableRowType:function(){return t.getTableRowType(e)},mceTableCellType:function(){return t.getTableCellType(e)},mceTableColType:function(){return Rs(e).bind((function(e){return en(e,o).map((function(o){var i=fo(n,o,e);return t.getTableColType(o,i)}))})).getOr("")}},(function(t,n){return e.addQueryValueHandler(n,t)}))}(t,u,i),function(t,i,r,a){t.on("BeforeGetContent",(function(e){!0===e.selection&&ro(i.get(),n,(function(n){e.preventDefault(),en(n[0]).map(Dn).map((function(e){return[hn(e,Zn)]})).each((function(n){var o;e.content="text"===e.format?A(n,(function(e){return e.dom().innerText})).join(""):(o=t,A(n,(function(e){return o.selection.serializer.serialize(e.dom(),{})})).join(""))}))}),n)})),t.on("BeforeSetContent",(function(n){!0===n.selection&&!0===n.paste&&p.from(t.dom.getParent(t.selection.getStart(),"th,td")).each((function(i){var s=Ce.fromDom(i);en(s).each((function(i){var l,u,c,d=M((l=n.content,(u=e.document.createElement("div")).innerHTML=l,it(Ce.fromDom(u))),(function(e){return"meta"!==Z(e)}));if(1===d.length&&"table"===Z(d[0])){n.preventDefault();var f=Ce.fromDom(t.getDoc()),h=An(f),g=(c=d[0],{element:o(s),clipboard:o(c),generators:o(h)});r.pasteCells(i,g).each((function(e){t.selection.setRng(e),t.focus(),a.clear(i)}))}}))}))}))}(t,i,u,l),function(e,t,n){var o=function(t){return function(){return e.execCommand(t)}},i=function(t){var n=t.numRows,o=t.numColumns;e.undoManager.transact((function(){Ps(e,o,n,0,0)})),e.addVisual()},r={text:"Table properties",onSetup:t.onSetupTable,onAction:o("mceTableProps")},a={text:"Delete table",icon:"table-delete-table",onSetup:t.onSetupTable,onAction:o("mceTableDelete")};e.ui.registry.addMenuItem("tableinsertrowbefore",{text:"Insert row before",icon:"table-insert-row-above",onAction:o("mceTableInsertRowBefore"),onSetup:t.onSetupCellOrRow}),e.ui.registry.addMenuItem("tableinsertrowafter",{text:"Insert row after",icon:"table-insert-row-after",onAction:o("mceTableInsertRowAfter"),onSetup:t.onSetupCellOrRow}),e.ui.registry.addMenuItem("tabledeleterow",{text:"Delete row",icon:"table-delete-row",onAction:o("mceTableDeleteRow"),onSetup:t.onSetupCellOrRow}),e.ui.registry.addMenuItem("tablerowprops",{text:"Row properties",icon:"table-row-properties",onAction:o("mceTableRowProps"),onSetup:t.onSetupCellOrRow}),e.ui.registry.addMenuItem("tablecutrow",{text:"Cut row",icon:"cut-row",onAction:o("mceTableCutRow"),onSetup:t.onSetupCellOrRow}),e.ui.registry.addMenuItem("tablecopyrow",{text:"Copy row",icon:"duplicate-row",onAction:o("mceTableCopyRow"),onSetup:t.onSetupCellOrRow}),e.ui.registry.addMenuItem("tablepasterowbefore",{text:"Paste row before",icon:"paste-row-before",onAction:o("mceTablePasteRowBefore"),onSetup:t.onSetupPasteable(n.getRows)}),e.ui.registry.addMenuItem("tablepasterowafter",{text:"Paste row after",icon:"paste-row-after",onAction:o("mceTablePasteRowAfter"),onSetup:t.onSetupPasteable(n.getRows)}),e.ui.registry.addMenuItem("tableinsertcolumnbefore",{text:"Insert column before",icon:"table-insert-column-before",onAction:o("mceTableInsertColBefore"),onSetup:t.onSetupCellOrRow}),e.ui.registry.addMenuItem("tableinsertcolumnafter",{text:"Insert column after",icon:"table-insert-column-after",onAction:o("mceTableInsertColAfter"),onSetup:t.onSetupCellOrRow}),e.ui.registry.addMenuItem("tabledeletecolumn",{text:"Delete column",icon:"table-delete-column",onAction:o("mceTableDeleteCol"),onSetup:t.onSetupCellOrRow}),e.ui.registry.addMenuItem("tablecutcolumn",{text:"Cut column",icon:"cut-column",onAction:o("mceTableCutCol"),onSetup:t.onSetupCellOrRow}),e.ui.registry.addMenuItem("tablecopycolumn",{text:"Copy column",icon:"duplicate-column",onAction:o("mceTableCopyCol"),onSetup:t.onSetupCellOrRow}),e.ui.registry.addMenuItem("tablepastecolumnbefore",{text:"Paste column before",icon:"paste-column-before",onAction:o("mceTablePasteColBefore"),onSetup:t.onSetupPasteable(n.getColumns)}),e.ui.registry.addMenuItem("tablepastecolumnafter",{text:"Paste column after",icon:"paste-column-after",onAction:o("mceTablePasteColAfter"),onSetup:t.onSetupPasteable(n.getColumns)}),e.ui.registry.addMenuItem("tablecellprops",{text:"Cell properties",icon:"table-cell-properties",onAction:o("mceTableCellProps"),onSetup:t.onSetupCellOrRow}),e.ui.registry.addMenuItem("tablemergecells",{text:"Merge cells",icon:"table-merge-cells",onAction:o("mceTableMergeCells"),onSetup:t.onSetupMergeable}),e.ui.registry.addMenuItem("tablesplitcells",{text:"Split cell",icon:"table-split-cells",onAction:o("mceTableSplitCells"),onSetup:t.onSetupUnmergeable}),!1===e.getParam("table_grid",!0,"boolean")?e.ui.registry.addMenuItem("inserttable",{text:"Table",icon:"table",onAction:o("mceInsertTable")}):e.ui.registry.addNestedMenuItem("inserttable",{text:"Table",icon:"table",getSubmenuItems:function(){return[{type:"fancymenuitem",fancytype:"inserttable",onAction:i}]}}),e.ui.registry.addMenuItem("inserttabledialog",{text:"Insert table",icon:"table",onAction:o("mceInsertTable")}),e.ui.registry.addMenuItem("tableprops",r),e.ui.registry.addMenuItem("deletetable",a),e.ui.registry.addNestedMenuItem("row",{type:"nestedmenuitem",text:"Row",getSubmenuItems:function(){return"tableinsertrowbefore tableinsertrowafter tabledeleterow tablerowprops | tablecutrow tablecopyrow tablepasterowbefore tablepasterowafter"}}),e.ui.registry.addNestedMenuItem("column",{type:"nestedmenuitem",text:"Column",getSubmenuItems:function(){return"tableinsertcolumnbefore tableinsertcolumnafter tabledeletecolumn"}}),e.ui.registry.addNestedMenuItem("cell",{type:"nestedmenuitem",text:"Cell",getSubmenuItems:function(){return"tablecellprops tablemergecells tablesplitcells"}}),e.ui.registry.addContextMenu("table",{update:function(){return t.resetTargets(),t.targets().fold((function(){return""}),(function(e){return"caption"===Z(e.element())?"tableprops deletetable":"cell row column | advtablesort | tableprops deletetable"}))}})}(t,a,d),function(e,t,n){e.ui.registry.addMenuButton("table",{tooltip:"Table",icon:"table",fetch:function(e){return e("inserttable | cell row column | advtablesort | tableprops deletetable")}});var o=function(t){return function(){return e.execCommand(t)}};e.ui.registry.addButton("tableprops",{tooltip:"Table properties",onAction:o("mceTableProps"),icon:"table",onSetup:t.onSetupTable}),e.ui.registry.addButton("tabledelete",{tooltip:"Delete table",onAction:o("mceTableDelete"),icon:"table-delete-table",onSetup:t.onSetupTable}),e.ui.registry.addButton("tablecellprops",{tooltip:"Cell properties",onAction:o("mceTableCellProps"),icon:"table-cell-properties",onSetup:t.onSetupCellOrRow}),e.ui.registry.addButton("tablemergecells",{tooltip:"Merge cells",onAction:o("mceTableMergeCells"),icon:"table-merge-cells",onSetup:t.onSetupMergeable}),e.ui.registry.addButton("tablesplitcells",{tooltip:"Split cell",onAction:o("mceTableSplitCells"),icon:"table-split-cells",onSetup:t.onSetupUnmergeable}),e.ui.registry.addButton("tableinsertrowbefore",{tooltip:"Insert row before",onAction:o("mceTableInsertRowBefore"),icon:"table-insert-row-above",onSetup:t.onSetupCellOrRow}),e.ui.registry.addButton("tableinsertrowafter",{tooltip:"Insert row after",onAction:o("mceTableInsertRowAfter"),icon:"table-insert-row-after",onSetup:t.onSetupCellOrRow}),e.ui.registry.addButton("tabledeleterow",{tooltip:"Delete row",onAction:o("mceTableDeleteRow"),icon:"table-delete-row",onSetup:t.onSetupCellOrRow}),e.ui.registry.addButton("tablerowprops",{tooltip:"Row properties",onAction:o("mceTableRowProps"),icon:"table-row-properties",onSetup:t.onSetupCellOrRow}),e.ui.registry.addButton("tableinsertcolbefore",{tooltip:"Insert column before",onAction:o("mceTableInsertColBefore"),icon:"table-insert-column-before",onSetup:t.onSetupCellOrRow}),e.ui.registry.addButton("tableinsertcolafter",{tooltip:"Insert column after",onAction:o("mceTableInsertColAfter"),icon:"table-insert-column-after",onSetup:t.onSetupCellOrRow}),e.ui.registry.addButton("tabledeletecol",{tooltip:"Delete column",onAction:o("mceTableDeleteCol"),icon:"table-delete-column",onSetup:t.onSetupCellOrRow}),e.ui.registry.addButton("tablecutrow",{tooltip:"Cut row",icon:"cut-row",onAction:o("mceTableCutRow"),onSetup:t.onSetupCellOrRow}),e.ui.registry.addButton("tablecopyrow",{tooltip:"Copy row",icon:"duplicate-row",onAction:o("mceTableCopyRow"),onSetup:t.onSetupCellOrRow}),e.ui.registry.addButton("tablepasterowbefore",{tooltip:"Paste row before",icon:"paste-row-before",onAction:o("mceTablePasteRowBefore"),onSetup:t.onSetupPasteable(n.getRows)}),e.ui.registry.addButton("tablepasterowafter",{tooltip:"Paste row after",icon:"paste-row-after",onAction:o("mceTablePasteRowAfter"),onSetup:t.onSetupPasteable(n.getRows)}),e.ui.registry.addButton("tablecutcol",{tooltip:"Cut column",icon:"cut-column",onAction:o("mceTableCutCol"),onSetup:t.onSetupCellOrRow}),e.ui.registry.addButton("tablecopycol",{tooltip:"Copy column",icon:"duplicate-column",onAction:o("mceTableCopyCol"),onSetup:t.onSetupCellOrRow}),e.ui.registry.addButton("tablepastecolbefore",{tooltip:"Paste column before",icon:"paste-column-before",onAction:o("mceTablePasteColBefore"),onSetup:t.onSetupPasteable(n.getColumns)}),e.ui.registry.addButton("tablepastecolafter",{tooltip:"Paste column after",icon:"paste-column-after",onAction:o("mceTablePasteColAfter"),onSetup:t.onSetupPasteable(n.getColumns)}),e.ui.registry.addButton("tableinsertdialog",{tooltip:"Insert table",onAction:o("mceInsertTable"),icon:"table"})}(t,a,d),function(e){var t=e.getParam("table_toolbar","tableprops tabledelete | tableinsertrowbefore tableinsertrowafter tabledeleterow | tableinsertcolbefore tableinsertcolafter tabledeletecol");0<t.length&&e.ui.registry.addContextToolbar("table",{predicate:function(t){return e.dom.is(t,"table")&&e.getBody().contains(t)},items:t,scope:"node",position:"node"})}(t),t.on("PreInit",(function(){t.serializer.addTempAttr(Jn),t.serializer.addTempAttr(eo),function(e){e.formatter.register(nc)}(t)})),function(e){return e.getParam("table_tab_navigation",!0,"boolean")}(t)&&t.on("keydown",(function(e){Yl(e,t,u,s.lazyWire)})),t.on("remove",(function(){s.destroy()})),function(e,t,n,o){return{insertTable:function(t,n,o){return void 0===o&&(o={}),Ls(e,n,t,o,"Invalid values for insertTable - rows and columns values are required to insert a table.")},setClipboardRows:Fs(t.setRows),getClipboardRows:Bs(t.getRows),setClipboardCols:Fs(t.setColumns),getClipboardCols:Bs(t.getColumns),resizeHandler:n,selectionTargets:o}}(t,d,s,a)}))}(window),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(e.echarts={})}(this,(function(e){"use strict";var t,n=2311,o=function(){return n++},i="object"==typeof wx&&"function"==typeof wx.getSystemInfoSync?{browser:{},os:{},node:!1,wxa:!0,canvasSupported:!0,svgSupported:!1,touchEventsSupported:!0,domSupported:!1}:"undefined"==typeof document&&"undefined"!=typeof self?{browser:{},os:{},node:!1,worker:!0,canvasSupported:!0,domSupported:!1}:"undefined"==typeof navigator?{browser:{},os:{},node:!0,worker:!1,canvasSupported:!0,svgSupported:!0,domSupported:!1}:function(e){var t={},n=e.match(/Firefox\/([\d.]+)/),o=e.match(/MSIE\s([\d.]+)/)||e.match(/Trident\/.+?rv:(([\d.]+))/),i=e.match(/Edge\/([\d.]+)/),r=/micromessenger/i.test(e);return n&&(t.firefox=!0,t.version=n[1]),o&&(t.ie=!0,t.version=o[1]),i&&(t.edge=!0,t.version=i[1]),r&&(t.weChat=!0),{browser:t,os:{},node:!1,canvasSupported:!!document.createElement("canvas").getContext,svgSupported:"undefined"!=typeof SVGRect,touchEventsSupported:"ontouchstart"in window&&!t.ie&&!t.edge,pointerEventsSupported:"onpointerdown"in window&&(t.edge||t.ie&&11<=t.version),domSupported:"undefined"!=typeof document}}(navigator.userAgent),r={"[object Function]":1,"[object RegExp]":1,"[object Date]":1,"[object Error]":1,"[object CanvasGradient]":1,"[object CanvasPattern]":1,"[object Image]":1,"[object Canvas]":1},a={"[object Int8Array]":1,"[object Uint8Array]":1,"[object Uint8ClampedArray]":1,"[object Int16Array]":1,"[object Uint16Array]":1,"[object Int32Array]":1,"[object Uint32Array]":1,"[object Float32Array]":1,"[object Float64Array]":1},s=Object.prototype.toString,l=Array.prototype,u=l.forEach,c=l.filter,d=l.slice,f=l.map,h=l.reduce,g={};function m(e,n){"createCanvas"===e&&(t=null),g[e]=n}function p(e){if(null==e||"object"!=typeof e)return e;var t=e,n=s.call(e);if("[object Array]"===n){if(!Z(e)){t=[];for(var o=0,i=e.length;o<i;o++)t[o]=p(e[o])}}else if(a[n]){if(!Z(e)){var l=e.constructor;if(e.constructor.from)t=l.from(e);else for(t=new l(e.length),o=0,i=e.length;o<i;o++)t[o]=p(e[o])}}else if(!r[n]&&!Z(e)&&!z(e))for(var u in t={},e)e.hasOwnProperty(u)&&(t[u]=p(e[u]));return t}function v(e,t,n){if(!L(t)||!L(e))return n?p(t):e;for(var o in t)if(t.hasOwnProperty(o)){var i=e[o],r=t[o];!L(r)||!L(i)||M(r)||M(i)||z(r)||z(i)||B(r)||B(i)||Z(r)||Z(i)?!n&&o in e||(e[o]=p(t[o])):v(i,r,n)}return e}function y(e,t){for(var n=e[0],o=1,i=e.length;o<i;o++)n=v(n,e[o],t);return n}function b(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}function C(e,t,n){for(var o in t)t.hasOwnProperty(o)&&(n?null!=t[o]:null==e[o])&&(e[o]=t[o]);return e}function T(){return g.createCanvas()}function x(){return t=t||T().getContext("2d")}function E(e,t){if(e){if(e.indexOf)return e.indexOf(t);for(var n=0,o=e.length;n<o;n++)if(e[n]===t)return n}return-1}function _(e,t){var n=e.prototype;function o(){}for(var i in o.prototype=t.prototype,e.prototype=new o,n)n.hasOwnProperty(i)&&(e.prototype[i]=n[i]);(e.prototype.constructor=e).superClass=t}function I(e,t,n){C(e="prototype"in e?e.prototype:e,t="prototype"in t?t.prototype:t,n)}function D(e){if(e)return"string"!=typeof e&&"number"==typeof e.length}function O(e,t,n){if(e&&t)if(e.forEach&&e.forEach===u)e.forEach(t,n);else if(e.length===+e.length)for(var o=0,i=e.length;o<i;o++)t.call(n,e[o],o,e);else for(var r in e)e.hasOwnProperty(r)&&t.call(n,e[r],r,e)}function w(e,t,n){if(e&&t){if(e.map&&e.map===f)return e.map(t,n);for(var o=[],i=0,r=e.length;i<r;i++)o.push(t.call(n,e[i],i,e));return o}}function R(e,t,n,o){if(e&&t){if(e.reduce&&e.reduce===h)return e.reduce(t,n,o);for(var i=0,r=e.length;i<r;i++)n=t.call(o,n,e[i],i,e);return n}}function S(e,t,n){if(e&&t){if(e.filter&&e.filter===c)return e.filter(t,n);for(var o=[],i=0,r=e.length;i<r;i++)t.call(n,e[i],i,e)&&o.push(e[i]);return o}}function k(e,t,n){if(e&&t)for(var o=0,i=e.length;o<i;o++)if(t.call(n,e[o],o,e))return e[o]}function A(e,t){var n=d.call(arguments,2);return function(){return e.apply(t,n.concat(d.call(arguments)))}}function N(e){var t=d.call(arguments,1);return function(){return e.apply(this,t.concat(d.call(arguments)))}}function M(e){return"[object Array]"===s.call(e)}function K(e){return"function"==typeof e}function P(e){return"[object String]"===s.call(e)}function L(e){var t=typeof e;return"function"==t||!!e&&"object"==t}function B(e){return!!r[s.call(e)]}function F(e){return!!a[s.call(e)]}function z(e){return"object"==typeof e&&"number"==typeof e.nodeType&&"object"==typeof e.ownerDocument}function V(e){return e!=e}function H(e){for(var t=0,n=arguments.length;t<n;t++)if(null!=arguments[t])return arguments[t]}function W(e,t){return null!=e?e:t}function $(e,t,n){return null!=e?e:null!=t?t:n}function U(){return Function.call.apply(d,arguments)}function q(e){if("number"==typeof e)return[e,e,e,e];var t=e.length;return 2===t?[e[0],e[1],e[0],e[1]]:3===t?[e[0],e[1],e[2],e[1]]:e}function j(e,t){if(!e)throw new Error(t)}function G(e){return null==e?null:"function"==typeof e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}g.createCanvas=function(){return document.createElement("canvas")};var X="__ec_primitive__";function Y(e){e[X]=!0}function Z(e){return e[X]}function J(e){var t=M(e);this.data={};var n=this;function o(e,o){t?n.set(e,o):n.set(o,e)}e instanceof J?e.each(o):e&&O(e,o)}function Q(e){return new J(e)}function ee(e,t){for(var n=new e.constructor(e.length+t.length),o=0;o<e.length;o++)n[o]=e[o];var i=e.length;for(o=0;o<t.length;o++)n[o+i]=t[o];return n}function te(){}J.prototype={constructor:J,get:function(e){return this.data.hasOwnProperty(e)?this.data[e]:null},set:function(e,t){return this.data[e]=t},each:function(e,t){for(var n in void 0!==t&&(e=A(e,t)),this.data)this.data.hasOwnProperty(n)&&e(this.data[n],n)},removeKey:function(e){delete this.data[e]}};var ne=(Object.freeze||Object)({$override:m,clone:p,merge:v,mergeAll:y,extend:b,defaults:C,createCanvas:T,getContext:x,indexOf:E,inherits:_,mixin:I,isArrayLike:D,each:O,map:w,reduce:R,filter:S,find:k,bind:A,curry:N,isArray:M,isFunction:K,isString:P,isObject:L,isBuiltInObject:B,isTypedArray:F,isDom:z,eqNaN:V,retrieve:H,retrieve2:W,retrieve3:$,slice:U,normalizeCssArray:q,assert:j,trim:G,setAsPrimitive:Y,isPrimitive:Z,createHashMap:Q,concatArray:ee,noop:te}),oe="undefined"==typeof Float32Array?Array:Float32Array;function ie(e,t){var n=new oe(2);return null==e&&(e=0),null==t&&(t=0),n[0]=e,n[1]=t,n}function re(e,t){return e[0]=t[0],e[1]=t[1],e}function ae(e){var t=new oe(2);return t[0]=e[0],t[1]=e[1],t}function se(e,t,n){return e[0]=t,e[1]=n,e}function le(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e}function ue(e,t,n,o){return e[0]=t[0]+n[0]*o,e[1]=t[1]+n[1]*o,e}function ce(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e}function de(e){return Math.sqrt(fe(e))}function fe(e){return e[0]*e[0]+e[1]*e[1]}function he(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e}function ge(e,t){var n=de(t);return 0===n?(e[0]=0,e[1]=0):(e[0]=t[0]/n,e[1]=t[1]/n),e}function me(e,t){return Math.sqrt((e[0]-t[0])*(e[0]-t[0])+(e[1]-t[1])*(e[1]-t[1]))}var pe=me;function ve(e,t){return(e[0]-t[0])*(e[0]-t[0])+(e[1]-t[1])*(e[1]-t[1])}var ye=ve;function be(e,t,n,o){return e[0]=t[0]+o*(n[0]-t[0]),e[1]=t[1]+o*(n[1]-t[1]),e}function Ce(e,t,n){var o=t[0],i=t[1];return e[0]=n[0]*o+n[2]*i+n[4],e[1]=n[1]*o+n[3]*i+n[5],e}function Te(e,t,n){return e[0]=Math.min(t[0],n[0]),e[1]=Math.min(t[1],n[1]),e}function xe(e,t,n){return e[0]=Math.max(t[0],n[0]),e[1]=Math.max(t[1],n[1]),e}var Ee=(Object.freeze||Object)({create:ie,copy:re,clone:ae,set:se,add:le,scaleAndAdd:ue,sub:ce,len:de,length:de,lenSquare:fe,lengthSquare:fe,mul:function(e,t,n){return e[0]=t[0]*n[0],e[1]=t[1]*n[1],e},div:function(e,t,n){return e[0]=t[0]/n[0],e[1]=t[1]/n[1],e},dot:function(e,t){return e[0]*t[0]+e[1]*t[1]},scale:he,normalize:ge,distance:me,dist:pe,distanceSquare:ve,distSquare:ye,negate:function(e,t){return e[0]=-t[0],e[1]=-t[1],e},lerp:be,applyTransform:Ce,min:Te,max:xe});function _e(){this.on("mousedown",this._dragStart,this),this.on("mousemove",this._drag,this),this.on("mouseup",this._dragEnd,this)}function Ie(e,t){return{target:e,topTarget:t&&t.topTarget}}_e.prototype={constructor:_e,_dragStart:function(e){for(var t=e.target;t&&!t.draggable;)t=t.parent;t&&((this._draggingTarget=t).dragging=!0,this._x=e.offsetX,this._y=e.offsetY,this.dispatchToElement(Ie(t,e),"dragstart",e.event))},_drag:function(e){var t=this._draggingTarget;if(t){var n=e.offsetX,o=e.offsetY,i=n-this._x,r=o-this._y;this._x=n,this._y=o,t.drift(i,r,e),this.dispatchToElement(Ie(t,e),"drag",e.event);var a=this.findHover(n,o,t).target,s=this._dropTarget;t!==(this._dropTarget=a)&&(s&&a!==s&&this.dispatchToElement(Ie(s,e),"dragleave",e.event),a&&a!==s&&this.dispatchToElement(Ie(a,e),"dragenter",e.event))}},_dragEnd:function(e){var t=this._draggingTarget;t&&(t.dragging=!1),this.dispatchToElement(Ie(t,e),"dragend",e.event),this._dropTarget&&this.dispatchToElement(Ie(this._dropTarget,e),"drop",e.event),this._draggingTarget=null,this._dropTarget=null}};var De=Array.prototype.slice,Oe=function(e){this._$handlers={},this._$eventProcessor=e};function we(e,t,n,o,i,r){var a=e._$handlers;if("function"==typeof n&&(i=o,o=n,n=null),!o||!t)return e;n=function(e,t){var n=e._$eventProcessor;return null!=t&&n&&n.normalizeQuery&&(t=n.normalizeQuery(t)),t}(e,n),a[t]||(a[t]=[]);for(var s=0;s<a[t].length;s++)if(a[t][s].h===o)return e;var l={h:o,one:r,query:n,ctx:i||e,callAtLast:o.zrEventfulCallAtLast},u=a[t].length-1,c=a[t][u];return c&&c.callAtLast?a[t].splice(u,0,l):a[t].push(l),e}Oe.prototype={constructor:Oe,one:function(e,t,n,o){return we(this,e,t,n,o,!0)},on:function(e,t,n,o){return we(this,e,t,n,o,!1)},isSilent:function(e){var t=this._$handlers;return!t[e]||!t[e].length},off:function(e,t){var n=this._$handlers;if(!e)return this._$handlers={},this;if(t){if(n[e]){for(var o=[],i=0,r=n[e].length;i<r;i++)n[e][i].h!==t&&o.push(n[e][i]);n[e]=o}n[e]&&0===n[e].length&&delete n[e]}else delete n[e];return this},trigger:function(e){var t=this._$handlers[e],n=this._$eventProcessor;if(t){var o=arguments,i=o.length;3<i&&(o=De.call(o,1));for(var r=t.length,a=0;a<r;){var s=t[a];if(n&&n.filter&&null!=s.query&&!n.filter(e,s.query))a++;else{switch(i){case 1:s.h.call(s.ctx);break;case 2:s.h.call(s.ctx,o[1]);break;case 3:s.h.call(s.ctx,o[1],o[2]);break;default:s.h.apply(s.ctx,o)}s.one?(t.splice(a,1),r--):a++}}}return n&&n.afterTrigger&&n.afterTrigger(e),this},triggerWithContext:function(e){var t=this._$handlers[e],n=this._$eventProcessor;if(t){var o=arguments,i=o.length;4<i&&(o=De.call(o,1,o.length-1));for(var r=o[o.length-1],a=t.length,s=0;s<a;){var l=t[s];if(n&&n.filter&&null!=l.query&&!n.filter(e,l.query))s++;else{switch(i){case 1:l.h.call(r);break;case 2:l.h.call(r,o[1]);break;case 3:l.h.call(r,o[1],o[2]);break;default:l.h.apply(r,o)}l.one?(t.splice(s,1),a--):s++}}}return n&&n.afterTrigger&&n.afterTrigger(e),this}};var Re=Math.log(2);function Se(e,t,n,o,i,r){var a=o+"-"+i,s=e.length;if(r.hasOwnProperty(a))return r[a];if(1===t){var l=Math.round(Math.log((1<<s)-1&~i)/Re);return e[n][l]}for(var u=o|1<<n,c=n+1;o&1<<c;)c++;for(var d=0,f=0,h=0;f<s;f++){var g=1<<f;g&i||(d+=(h%2?-1:1)*e[n][f]*Se(e,t-1,c,u,i|g,r),h++)}return r[a]=d}function ke(e,t){var n=[[e[0],e[1],1,0,0,0,-t[0]*e[0],-t[0]*e[1]],[0,0,0,e[0],e[1],1,-t[1]*e[0],-t[1]*e[1]],[e[2],e[3],1,0,0,0,-t[2]*e[2],-t[2]*e[3]],[0,0,0,e[2],e[3],1,-t[3]*e[2],-t[3]*e[3]],[e[4],e[5],1,0,0,0,-t[4]*e[4],-t[4]*e[5]],[0,0,0,e[4],e[5],1,-t[5]*e[4],-t[5]*e[5]],[e[6],e[7],1,0,0,0,-t[6]*e[6],-t[6]*e[7]],[0,0,0,e[6],e[7],1,-t[7]*e[6],-t[7]*e[7]]],o={},i=Se(n,8,0,0,0,o);if(0!==i){for(var r=[],a=0;a<8;a++)for(var s=0;s<8;s++)null==r[s]&&(r[s]=0),r[s]+=((a+s)%2?-1:1)*Se(n,7,0===a?1:0,1<<a,1<<s,o)/i*t[a];return function(e,t,n){var o=t*r[6]+n*r[7]+1;e[0]=(t*r[0]+n*r[1]+r[2])/o,e[1]=(t*r[3]+n*r[4]+r[5])/o}}}var Ae="___zrEVENTSAVED",Ne=[];function Me(e,t,n,o,r){if(t.getBoundingClientRect&&i.domSupported&&!Ke(t)){var a=t[Ae]||(t[Ae]={}),s=function(e,t,n){for(var o=n?"invTrans":"trans",i=t[o],r=t.srcCoords,a=!0,s=[],l=[],u=0;u<4;u++){var c=e[u].getBoundingClientRect(),d=2*u,f=c.left,h=c.top;s.push(f,h),a=a&&r&&f===r[d]&&h===r[1+d],l.push(e[u].offsetLeft,e[u].offsetTop)}return a&&i?i:(t.srcCoords=s,t[o]=n?ke(l,s):ke(s,l))}(function(e,t){var n=t.markers;if(n)return n;n=t.markers=[];for(var o=["left","right"],i=["top","bottom"],r=0;r<4;r++){var a=document.createElement("div"),s=r%2,l=(r>>1)%2;a.style.cssText=["position: absolute","visibility: hidden","padding: 0","margin: 0","border-width: 0","user-select: none","width:0","height:0",o[s]+":0",i[l]+":0",o[1-s]+":auto",i[1-l]+":auto",""].join("!important;"),e.appendChild(a),n.push(a)}return n}(t,a),a,r);if(s)return s(e,n,o),!0}return!1}function Ke(e){return"CANVAS"===e.nodeName.toUpperCase()}var Pe="undefined"!=typeof window&&!!window.addEventListener,Le=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,Be=[];function Fe(e,t,n,o){return n=n||{},o||!i.canvasSupported?ze(e,t,n):i.browser.firefox&&null!=t.layerX&&t.layerX!==t.offsetX?(n.zrX=t.layerX,n.zrY=t.layerY):null!=t.offsetX?(n.zrX=t.offsetX,n.zrY=t.offsetY):ze(e,t,n),n}function ze(e,t,n){if(i.domSupported&&e.getBoundingClientRect){var o=t.clientX,r=t.clientY;if(Ke(e)){var a=e.getBoundingClientRect();return n.zrX=o-a.left,void(n.zrY=r-a.top)}if(Me(Be,e,o,r))return n.zrX=Be[0],void(n.zrY=Be[1])}n.zrX=n.zrY=0}function Ve(e){return e||window.event}function He(e,t,n){if(null!=(t=Ve(t)).zrX)return t;var o=t.type;if(o&&0<=o.indexOf("touch")){var i="touchend"!==o?t.targetTouches[0]:t.changedTouches[0];i&&Fe(e,i,t,n)}else Fe(e,t,t,n),t.zrDelta=t.wheelDelta?t.wheelDelta/120:-(t.detail||0)/3;var r=t.button;return null==t.which&&void 0!==r&&Le.test(t.type)&&(t.which=1&r?1:2&r?3:4&r?2:0),t}function We(e,t,n,o){Pe?e.addEventListener(t,n,o):e.attachEvent("on"+t,n)}var $e=Pe?function(e){e.preventDefault(),e.stopPropagation(),e.cancelBubble=!0}:function(e){e.returnValue=!1,e.cancelBubble=!0};function Ue(e){return 2===e.which||3===e.which}function qe(){this._track=[]}function je(e){var t=e[1][0]-e[0][0],n=e[1][1]-e[0][1];return Math.sqrt(t*t+n*n)}qe.prototype={constructor:qe,recognize:function(e,t,n){return this._doTrack(e,t,n),this._recognize(e)},clear:function(){return this._track.length=0,this},_doTrack:function(e,t,n){var o=e.touches;if(o){for(var i={points:[],touches:[],target:t,event:e},r=0,a=o.length;r<a;r++){var s=o[r],l=Fe(n,s,{});i.points.push([l.zrX,l.zrY]),i.touches.push(s)}this._track.push(i)}},_recognize:function(e){for(var t in Ge)if(Ge.hasOwnProperty(t)){var n=Ge[t](this._track,e);if(n)return n}}};var Ge={pinch:function(e,t){var n=e.length;if(n){var o=(e[n-1]||{}).points,i=(e[n-2]||{}).points||o;if(i&&1<i.length&&o&&1<o.length){var r=je(o)/je(i);isFinite(r)||(r=1),t.pinchScale=r;var a=function(e){return[(e[0][0]+e[1][0])/2,(e[0][1]+e[1][1])/2]}(o);return t.pinchX=a[0],t.pinchY=a[1],{type:"pinch",target:e[0].target,event:t}}}}},Xe="silent";function Ye(){$e(this.event)}function Ze(){}function Je(e,t,n,o){Oe.call(this),this.storage=e,this.painter=t,this.painterRoot=o,n=n||new Ze,this.proxy=null,this._hovered={},_e.call(this),this.setHandlerProxy(n)}Ze.prototype.dispose=function(){};var Qe=["click","dblclick","mousewheel","mouseout","mouseup","mousedown","mousemove","contextmenu"];function et(e,t,n){if(e[e.rectHover?"rectContain":"contain"](t,n)){for(var o,i=e;i;){if(i.clipPath&&!i.clipPath.contain(t,n))return!1;i.silent&&(o=!0),i=i.parent}return!o||Xe}return!1}function tt(e,t,n){var o=e.painter;return t<0||t>o.getWidth()||n<0||n>o.getHeight()}Je.prototype={constructor:Je,setHandlerProxy:function(e){this.proxy&&this.proxy.dispose(),e&&(O(Qe,(function(t){e.on&&e.on(t,this[t],this)}),this),e.handler=this),this.proxy=e},mousemove:function(e){var t=e.zrX,n=e.zrY,o=tt(this,t,n),i=this._hovered,r=i.target;r&&!r.__zr&&(r=(i=this.findHover(i.x,i.y)).target);var a=this._hovered=o?{x:t,y:n}:this.findHover(t,n),s=a.target,l=this.proxy;l.setCursor&&l.setCursor(s?s.cursor:"default"),r&&s!==r&&this.dispatchToElement(i,"mouseout",e),this.dispatchToElement(a,"mousemove",e),s&&s!==r&&this.dispatchToElement(a,"mouseover",e)},mouseout:function(e){var t=e.zrEventControl,n=e.zrIsToLocalDOM;"only_globalout"!==t&&this.dispatchToElement(this._hovered,"mouseout",e),"no_globalout"!==t&&(n||this.trigger("globalout",{type:"globalout",event:e}))},resize:function(e){this._hovered={}},dispatch:function(e,t){var n=this[e];n&&n.call(this,t)},dispose:function(){this.proxy.dispose(),this.storage=this.proxy=this.painter=null},setCursorStyle:function(e){var t=this.proxy;t.setCursor&&t.setCursor(e)},dispatchToElement:function(e,t,n){var o=(e=e||{}).target;if(!o||!o.silent){for(var i="on"+t,r=function(e,t,n){return{type:e,event:n,target:t.target,topTarget:t.topTarget,cancelBubble:!1,offsetX:n.zrX,offsetY:n.zrY,gestureEvent:n.gestureEvent,pinchX:n.pinchX,pinchY:n.pinchY,pinchScale:n.pinchScale,wheelDelta:n.zrDelta,zrByTouch:n.zrByTouch,which:n.which,stop:Ye}}(t,e,n);o&&(o[i]&&(r.cancelBubble=o[i].call(o,r)),o.trigger(t,r),o=o.parent,!r.cancelBubble););r.cancelBubble||(this.trigger(t,r),this.painter&&this.painter.eachOtherLayer((function(e){"function"==typeof e[i]&&e[i].call(e,r),e.trigger&&e.trigger(t,r)})))}},findHover:function(e,t,n){for(var o=this.storage.getDisplayList(),i={x:e,y:t},r=o.length-1;0<=r;r--){var a;if(o[r]!==n&&!o[r].ignore&&(a=et(o[r],e,t))&&(i.topTarget||(i.topTarget=o[r]),a!==Xe)){i.target=o[r];break}}return i},processGesture:function(e,t){this._gestureMgr||(this._gestureMgr=new qe);var n=this._gestureMgr;"start"===t&&n.clear();var o=n.recognize(e,this.findHover(e.zrX,e.zrY,null).target,this.proxy.dom);if("end"===t&&n.clear(),o){var i=o.type;e.gestureEvent=i,this.dispatchToElement({target:o.target},i,o.event)}}},O(["click","mousedown","mouseup","mousewheel","dblclick","contextmenu"],(function(e){Je.prototype[e]=function(t){var n,o,i=t.zrX,r=t.zrY,a=tt(this,i,r);if("mouseup"===e&&a||(o=(n=this.findHover(i,r)).target),"mousedown"===e)this._downEl=o,this._downPoint=[t.zrX,t.zrY],this._upEl=o;else if("mouseup"===e)this._upEl=o;else if("click"===e){if(this._downEl!==this._upEl||!this._downPoint||4<pe(this._downPoint,[t.zrX,t.zrY]))return;this._downPoint=null}this.dispatchToElement(n,e,t)}})),I(Je,Oe),I(Je,_e);var nt="undefined"==typeof Float32Array?Array:Float32Array;function ot(){var e=new nt(6);return it(e),e}function it(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e}function rt(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e}function at(e,t,n){var o=t[1]*n[0]+t[3]*n[1],i=t[0]*n[2]+t[2]*n[3],r=t[1]*n[2]+t[3]*n[3],a=t[0]*n[4]+t[2]*n[5]+t[4],s=t[1]*n[4]+t[3]*n[5]+t[5];return e[0]=t[0]*n[0]+t[2]*n[1],e[1]=o,e[2]=i,e[3]=r,e[4]=a,e[5]=s,e}function st(e,t,n){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4]+n[0],e[5]=t[5]+n[1],e}function lt(e,t,n){var o=t[0],i=t[2],r=t[4],a=t[1],s=t[3],l=t[5],u=Math.sin(n),c=Math.cos(n);return e[0]=o*c+a*u,e[1]=-o*u+a*c,e[2]=i*c+s*u,e[3]=-i*u+c*s,e[4]=c*r+u*l,e[5]=c*l-u*r,e}function ut(e,t,n){var o=n[0],i=n[1];return e[0]=t[0]*o,e[1]=t[1]*i,e[2]=t[2]*o,e[3]=t[3]*i,e[4]=t[4]*o,e[5]=t[5]*i,e}function ct(e,t){var n=t[0],o=t[2],i=t[4],r=t[1],a=t[3],s=t[5],l=n*a-r*o;return l?(e[0]=a*(l=1/l),e[1]=-r*l,e[2]=-o*l,e[3]=n*l,e[4]=(o*s-a*i)*l,e[5]=(r*i-n*s)*l,e):null}function dt(e){var t=ot();return rt(t,e),t}var ft=(Object.freeze||Object)({create:ot,identity:it,copy:rt,mul:at,translate:st,rotate:lt,scale:ut,invert:ct,clone:dt}),ht=it;function gt(e){return 5e-5<e||e<-5e-5}var mt=function(e){(e=e||{}).position||(this.position=[0,0]),null==e.rotation&&(this.rotation=0),e.scale||(this.scale=[1,1]),this.origin=this.origin||null},pt=mt.prototype;pt.transform=null,pt.needLocalTransform=function(){return gt(this.rotation)||gt(this.position[0])||gt(this.position[1])||gt(this.scale[0]-1)||gt(this.scale[1]-1)};var vt=[];pt.updateTransform=function(){var e=this.parent,t=e&&e.transform,n=this.needLocalTransform(),o=this.transform;if(n||t){o=o||ot(),n?this.getLocalTransform(o):ht(o),t&&(n?at(o,e.transform,o):rt(o,e.transform)),this.transform=o;var i=this.globalScaleRatio;if(null!=i&&1!==i){this.getGlobalScale(vt);var r=vt[0]<0?-1:1,a=vt[1]<0?-1:1,s=((vt[0]-r)*i+r)/vt[0]||0,l=((vt[1]-a)*i+a)/vt[1]||0;o[0]*=s,o[1]*=s,o[2]*=l,o[3]*=l}this.invTransform=this.invTransform||ot(),ct(this.invTransform,o)}else o&&ht(o)},pt.getLocalTransform=function(e){return mt.getLocalTransform(this,e)},pt.setTransform=function(e){var t=this.transform,n=e.dpr||1;t?e.setTransform(n*t[0],n*t[1],n*t[2],n*t[3],n*t[4],n*t[5]):e.setTransform(n,0,0,n,0,0)},pt.restoreTransform=function(e){var t=e.dpr||1;e.setTransform(t,0,0,t,0,0)};var yt=[],bt=ot();pt.setLocalTransform=function(e){if(e){var t=e[0]*e[0]+e[1]*e[1],n=e[2]*e[2]+e[3]*e[3],o=this.position,i=this.scale;gt(t-1)&&(t=Math.sqrt(t)),gt(n-1)&&(n=Math.sqrt(n)),e[0]<0&&(t=-t),e[3]<0&&(n=-n),o[0]=e[4],o[1]=e[5],i[0]=t,i[1]=n,this.rotation=Math.atan2(-e[1]/n,e[0]/t)}},pt.decomposeTransform=function(){if(this.transform){var e=this.parent,t=this.transform;e&&e.transform&&(at(yt,e.invTransform,t),t=yt);var n=this.origin;n&&(n[0]||n[1])&&(bt[4]=n[0],bt[5]=n[1],at(yt,t,bt),yt[4]-=n[0],yt[5]-=n[1],t=yt),this.setLocalTransform(t)}},pt.getGlobalScale=function(e){var t=this.transform;return e=e||[],t?(e[0]=Math.sqrt(t[0]*t[0]+t[1]*t[1]),e[1]=Math.sqrt(t[2]*t[2]+t[3]*t[3]),t[0]<0&&(e[0]=-e[0]),t[3]<0&&(e[1]=-e[1])):(e[0]=1,e[1]=1),e},pt.transformCoordToLocal=function(e,t){var n=[e,t],o=this.invTransform;return o&&Ce(n,n,o),n},pt.transformCoordToGlobal=function(e,t){var n=[e,t],o=this.transform;return o&&Ce(n,n,o),n},mt.getLocalTransform=function(e,t){ht(t=t||[]);var n=e.origin,o=e.scale||[1,1],i=e.rotation||0,r=e.position||[0,0];return n&&(t[4]-=n[0],t[5]-=n[1]),ut(t,t,o),i&&lt(t,t,i),n&&(t[4]+=n[0],t[5]+=n[1]),t[4]+=r[0],t[5]+=r[1],t};var Ct={linear:function(e){return e},quadraticIn:function(e){return e*e},quadraticOut:function(e){return e*(2-e)},quadraticInOut:function(e){return(e*=2)<1?.5*e*e:-.5*(--e*(e-2)-1)},cubicIn:function(e){return e*e*e},cubicOut:function(e){return--e*e*e+1},cubicInOut:function(e){return(e*=2)<1?.5*e*e*e:.5*((e-=2)*e*e+2)},quarticIn:function(e){return e*e*e*e},quarticOut:function(e){return 1- --e*e*e*e},quarticInOut:function(e){return(e*=2)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2)},quinticIn:function(e){return e*e*e*e*e},quinticOut:function(e){return--e*e*e*e*e+1},quinticInOut:function(e){return(e*=2)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2)},sinusoidalIn:function(e){return 1-Math.cos(e*Math.PI/2)},sinusoidalOut:function(e){return Math.sin(e*Math.PI/2)},sinusoidalInOut:function(e){return.5*(1-Math.cos(Math.PI*e))},exponentialIn:function(e){return 0===e?0:Math.pow(1024,e-1)},exponentialOut:function(e){return 1===e?1:1-Math.pow(2,-10*e)},exponentialInOut:function(e){return 0===e?0:1===e?1:(e*=2)<1?.5*Math.pow(1024,e-1):.5*(2-Math.pow(2,-10*(e-1)))},circularIn:function(e){return 1-Math.sqrt(1-e*e)},circularOut:function(e){return Math.sqrt(1- --e*e)},circularInOut:function(e){return(e*=2)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)},elasticIn:function(e){var t,n=.1;return 0===e?0:1===e?1:(t=!n||n<1?(n=1,.1):.4*Math.asin(1/n)/(2*Math.PI),-n*Math.pow(2,10*(e-=1))*Math.sin((e-t)*(2*Math.PI)/.4))},elasticOut:function(e){var t,n=.1;return 0===e?0:1===e?1:(t=!n||n<1?(n=1,.1):.4*Math.asin(1/n)/(2*Math.PI),n*Math.pow(2,-10*e)*Math.sin((e-t)*(2*Math.PI)/.4)+1)},elasticInOut:function(e){var t,n=.1;return 0===e?0:1===e?1:(t=!n||n<1?(n=1,.1):.4*Math.asin(1/n)/(2*Math.PI),(e*=2)<1?n*Math.pow(2,10*(e-=1))*Math.sin((e-t)*(2*Math.PI)/.4)*-.5:n*Math.pow(2,-10*(e-=1))*Math.sin((e-t)*(2*Math.PI)/.4)*.5+1)},backIn:function(e){return e*e*(2.70158*e-1.70158)},backOut:function(e){return--e*e*(2.70158*e+1.70158)+1},backInOut:function(e){var t=2.5949095;return(e*=2)<1?e*e*((1+t)*e-t)*.5:.5*((e-=2)*e*((1+t)*e+t)+2)},bounceIn:function(e){return 1-Ct.bounceOut(1-e)},bounceOut:function(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},bounceInOut:function(e){return e<.5?.5*Ct.bounceIn(2*e):.5*Ct.bounceOut(2*e-1)+.5}};function Tt(e){this._target=e.target,this._life=e.life||1e3,this._delay=e.delay||0,this._initialized=!1,this.loop=null!=e.loop&&e.loop,this.gap=e.gap||0,this.easing=e.easing||"Linear",this.onframe=e.onframe,this.ondestroy=e.ondestroy,this.onrestart=e.onrestart,this._pausedTime=0,this._paused=!1}function xt(){this.head=null,this.tail=null,this._len=0}Tt.prototype={constructor:Tt,step:function(e,t){if(this._initialized||(this._startTime=e+this._delay,this._initialized=!0),this._paused)this._pausedTime+=t;else{var n=(e-this._startTime-this._pausedTime)/this._life;if(!(n<0)){n=Math.min(n,1);var o=this.easing,i="string"==typeof o?Ct[o]:o,r="function"==typeof i?i(n):n;return this.fire("frame",r),1===n?this.loop?(this.restart(e),"restart"):(this._needsRemove=!0,"destroy"):null}}},restart:function(e){this._startTime=e-(e-this._startTime-this._pausedTime)%this._life+this.gap,this._pausedTime=0,this._needsRemove=!1},fire:function(e,t){this[e="on"+e]&&this[e](this._target,t)},pause:function(){this._paused=!0},resume:function(){this._paused=!1}};var Et=xt.prototype;function _t(e){this._list=new xt,this._map={},this._maxSize=e||10,this._lastRemovedEntry=null}Et.insert=function(e){var t=new It(e);return this.insertEntry(t),t},Et.insertEntry=function(e){this.head?((this.tail.next=e).prev=this.tail,e.next=null,this.tail=e):this.head=this.tail=e,this._len++},Et.remove=function(e){var t=e.prev,n=e.next;t?t.next=n:this.head=n,n?n.prev=t:this.tail=t,e.next=e.prev=null,this._len--},Et.len=function(){return this._len},Et.clear=function(){this.head=this.tail=null,this._len=0};var It=function(e){this.value=e},Dt=_t.prototype;Dt.put=function(e,t){var n=this._list,o=this._map,i=null;if(null==o[e]){var r=n.len(),a=this._lastRemovedEntry;if(r>=this._maxSize&&0<r){var s=n.head;n.remove(s),delete o[s.key],i=s.value,this._lastRemovedEntry=s}a?a.value=t:a=new It(t),a.key=e,n.insertEntry(a),o[e]=a}return i},Dt.get=function(e){var t=this._map[e],n=this._list;if(null!=t)return t!==n.tail&&(n.remove(t),n.insertEntry(t)),t.value},Dt.clear=function(){this._list.clear(),this._map={}};var Ot={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function wt(e){return(e=Math.round(e))<0?0:255<e?255:e}function Rt(e){return e<0?0:1<e?1:e}function St(e){return e.length&&"%"===e.charAt(e.length-1)?wt(parseFloat(e)/100*255):wt(parseInt(e,10))}function kt(e){return e.length&&"%"===e.charAt(e.length-1)?Rt(parseFloat(e)/100):Rt(parseFloat(e))}function At(e,t,n){return n<0?n+=1:1<n&&(n-=1),6*n<1?e+(t-e)*n*6:2*n<1?t:3*n<2?e+(t-e)*(2/3-n)*6:e}function Nt(e,t,n){return e+(t-e)*n}function Mt(e,t,n,o,i){return e[0]=t,e[1]=n,e[2]=o,e[3]=i,e}function Kt(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}var Pt=new _t(20),Lt=null;function Bt(e,t){Lt&&Kt(Lt,t),Lt=Pt.put(e,Lt||t.slice())}function Ft(e,t){if(e){t=t||[];var n=Pt.get(e);if(n)return Kt(t,n);var o,i=(e+="").replace(/ /g,"").toLowerCase();if(i in Ot)return Kt(t,Ot[i]),Bt(e,t),t;if("#"===i.charAt(0))return 4===i.length?0<=(o=parseInt(i.substr(1),16))&&o<=4095?(Mt(t,(3840&o)>>4|(3840&o)>>8,240&o|(240&o)>>4,15&o|(15&o)<<4,1),Bt(e,t),t):void Mt(t,0,0,0,1):7===i.length?0<=(o=parseInt(i.substr(1),16))&&o<=16777215?(Mt(t,(16711680&o)>>16,(65280&o)>>8,255&o,1),Bt(e,t),t):void Mt(t,0,0,0,1):void 0;var r=i.indexOf("("),a=i.indexOf(")");if(-1!==r&&a+1===i.length){var s=i.substr(0,r),l=i.substr(r+1,a-(r+1)).split(","),u=1;switch(s){case"rgba":if(4!==l.length)return void Mt(t,0,0,0,1);u=kt(l.pop());case"rgb":return 3!==l.length?void Mt(t,0,0,0,1):(Mt(t,St(l[0]),St(l[1]),St(l[2]),u),Bt(e,t),t);case"hsla":return 4!==l.length?void Mt(t,0,0,0,1):(l[3]=kt(l[3]),zt(l,t),Bt(e,t),t);case"hsl":return 3!==l.length?void Mt(t,0,0,0,1):(zt(l,t),Bt(e,t),t);default:return}}Mt(t,0,0,0,1)}}function zt(e,t){var n=(parseFloat(e[0])%360+360)%360/360,o=kt(e[1]),i=kt(e[2]),r=i<=.5?i*(o+1):i+o-i*o,a=2*i-r;return Mt(t=t||[],wt(255*At(a,r,n+1/3)),wt(255*At(a,r,n)),wt(255*At(a,r,n-1/3)),1),4===e.length&&(t[3]=e[3]),t}function Vt(e,t){var n=Ft(e);if(n){for(var o=0;o<3;o++)n[o]=t<0?n[o]*(1-t)|0:(255-n[o])*t+n[o]|0,255<n[o]?n[o]=255:e[o]<0&&(n[o]=0);return jt(n,4===n.length?"rgba":"rgb")}}function Ht(e){var t=Ft(e);if(t)return((1<<24)+(t[0]<<16)+(t[1]<<8)+ +t[2]).toString(16).slice(1)}function Wt(e,t,n){if(t&&t.length&&0<=e&&e<=1){n=n||[];var o=e*(t.length-1),i=Math.floor(o),r=Math.ceil(o),a=t[i],s=t[r],l=o-i;return n[0]=wt(Nt(a[0],s[0],l)),n[1]=wt(Nt(a[1],s[1],l)),n[2]=wt(Nt(a[2],s[2],l)),n[3]=Rt(Nt(a[3],s[3],l)),n}}function $t(e,t,n){if(t&&t.length&&0<=e&&e<=1){var o=e*(t.length-1),i=Math.floor(o),r=Math.ceil(o),a=Ft(t[i]),s=Ft(t[r]),l=o-i,u=jt([wt(Nt(a[0],s[0],l)),wt(Nt(a[1],s[1],l)),wt(Nt(a[2],s[2],l)),Rt(Nt(a[3],s[3],l))],"rgba");return n?{color:u,leftIndex:i,rightIndex:r,value:o}:u}}function Ut(e,t,n,o){if(e=Ft(e))return e=function(e){if(e){var t,n,o=e[0]/255,i=e[1]/255,r=e[2]/255,a=Math.min(o,i,r),s=Math.max(o,i,r),l=s-a,u=(s+a)/2;if(0==l)n=t=0;else{n=u<.5?l/(s+a):l/(2-s-a);var c=((s-o)/6+l/2)/l,d=((s-i)/6+l/2)/l,f=((s-r)/6+l/2)/l;o===s?t=f-d:i===s?t=1/3+c-f:r===s&&(t=2/3+d-c),t<0&&(t+=1),1<t&&(t-=1)}var h=[360*t,n,u];return null!=e[3]&&h.push(e[3]),h}}(e),null!=t&&(e[0]=function(e){return(e=Math.round(e))<0?0:360<e?360:e}(t)),null!=n&&(e[1]=kt(n)),null!=o&&(e[2]=kt(o)),jt(zt(e),"rgba")}function qt(e,t){if((e=Ft(e))&&null!=t)return e[3]=Rt(t),jt(e,"rgba")}function jt(e,t){if(e&&e.length){var n=e[0]+","+e[1]+","+e[2];return"rgba"!==t&&"hsva"!==t&&"hsla"!==t||(n+=","+e[3]),t+"("+n+")"}}var Gt=(Object.freeze||Object)({parse:Ft,lift:Vt,toHex:Ht,fastLerp:Wt,fastMapToColor:Wt,lerp:$t,mapToColor:$t,modifyHSL:Ut,modifyAlpha:qt,stringify:jt}),Xt=Array.prototype.slice;function Yt(e,t){return e[t]}function Zt(e,t,n){e[t]=n}function Jt(e,t,n){return(t-e)*n+e}function Qt(e,t,n){return.5<n?t:e}function en(e,t,n,o,i){var r=e.length;if(1===i)for(var a=0;a<r;a++)o[a]=Jt(e[a],t[a],n);else{var s=r&&e[0].length;for(a=0;a<r;a++)for(var l=0;l<s;l++)o[a][l]=Jt(e[a][l],t[a][l],n)}}function tn(e,t,n){var o=e.length,i=t.length;if(o!==i)if(i<o)e.length=i;else for(var r=o;r<i;r++)e.push(1===n?t[r]:Xt.call(t[r]));var a=e[0]&&e[0].length;for(r=0;r<e.length;r++)if(1===n)isNaN(e[r])&&(e[r]=t[r]);else for(var s=0;s<a;s++)isNaN(e[r][s])&&(e[r][s]=t[r][s])}function nn(e,t,n){if(e===t)return!0;var o=e.length;if(o!==t.length)return!1;if(1===n){for(var i=0;i<o;i++)if(e[i]!==t[i])return!1}else{var r=e[0].length;for(i=0;i<o;i++)for(var a=0;a<r;a++)if(e[i][a]!==t[i][a])return!1}return!0}function on(e,t,n,o,i,r,a,s,l){var u=e.length;if(1===l)for(var c=0;c<u;c++)s[c]=rn(e[c],t[c],n[c],o[c],i,r,a);else{var d=e[0].length;for(c=0;c<u;c++)for(var f=0;f<d;f++)s[c][f]=rn(e[c][f],t[c][f],n[c][f],o[c][f],i,r,a)}}function rn(e,t,n,o,i,r,a){var s=.5*(n-e),l=.5*(o-t);return(2*(t-n)+s+l)*a+(-3*(t-n)-2*s-l)*r+s*i+t}function an(e){if(D(e)){var t=e.length;if(D(e[0])){for(var n=[],o=0;o<t;o++)n.push(Xt.call(e[o]));return n}return Xt.call(e)}return e}function sn(e){return e[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.floor(e[2]),"rgba("+e.join(",")+")"}function ln(e,t,n,o,i,r){var a=e._getter,s=e._setter,l="spline"===t,u=o.length;if(u){var c,d=D(o[0].value),f=!1,h=!1,g=d?function(e){var t=e[e.length-1].value;return D(t&&t[0])?2:1}(o):0;o.sort((function(e,t){return e.time-t.time})),c=o[u-1].time;for(var m=[],p=[],v=o[0].value,y=!0,b=0;b<u;b++){m.push(o[b].time/c);var C=o[b].value;if(d&&nn(C,v,g)||!d&&C===v||(y=!1),"string"==typeof(v=C)){var T=Ft(C);T?(C=T,f=!0):h=!0}p.push(C)}if(r||!y){var x=p[u-1];for(b=0;b<u-1;b++)d?tn(p[b],x,g):!isNaN(p[b])||isNaN(x)||h||f||(p[b]=x);d&&tn(a(e._target,i),x,g);var E,_,I,O,w,R=0,S=0;if(f)var k=[0,0,0,0];var A=new Tt({target:e._target,life:c,loop:e._loop,delay:e._delay,onframe:function(e,t){var n;if(t<0)n=0;else if(t<S){for(n=Math.min(R+1,u-1);0<=n&&!(m[n]<=t);n--);n=Math.min(n,u-2)}else{for(n=R;n<u&&!(m[n]>t);n++);n=Math.min(n-1,u-2)}S=t;var o=m[(R=n)+1]-m[n];if(0!=o)if(E=(t-m[n])/o,l)if(I=p[n],_=p[0===n?n:n-1],O=p[u-2<n?u-1:n+1],w=p[u-3<n?u-1:n+2],d)on(_,I,O,w,E,E*E,E*E*E,a(e,i),g);else{if(f)r=on(_,I,O,w,E,E*E,E*E*E,k,1),r=sn(k);else{if(h)return Qt(I,O,E);r=rn(_,I,O,w,E,E*E,E*E*E)}s(e,i,r)}else if(d)en(p[n],p[n+1],E,a(e,i),g);else{var r;if(f)en(p[n],p[n+1],E,k,1),r=sn(k);else{if(h)return Qt(p[n],p[n+1],E);r=Jt(p[n],p[n+1],E)}s(e,i,r)}},ondestroy:n});return t&&"spline"!==t&&(A.easing=t),A}}}function un(e,t,n,o){this._tracks={},this._target=e,this._loop=t||!1,this._getter=n||Yt,this._setter=o||Zt,this._clipCount=0,this._delay=0,this._doneList=[],this._onframeList=[],this._clipList=[]}un.prototype={when:function(e,t){var n=this._tracks;for(var o in t)if(t.hasOwnProperty(o)){if(!n[o]){n[o]=[];var i=this._getter(this._target,o);if(null==i)continue;0!==e&&n[o].push({time:0,value:an(i)})}n[o].push({time:e,value:t[o]})}return this},during:function(e){return this._onframeList.push(e),this},pause:function(){for(var e=0;e<this._clipList.length;e++)this._clipList[e].pause();this._paused=!0},resume:function(){for(var e=0;e<this._clipList.length;e++)this._clipList[e].resume();this._paused=!1},isPaused:function(){return!!this._paused},_doneCallback:function(){this._tracks={},this._clipList.length=0;for(var e=this._doneList,t=e.length,n=0;n<t;n++)e[n].call(this)},start:function(e,t){function n(){--r||i._doneCallback()}var o,i=this,r=0;for(var a in this._tracks)if(this._tracks.hasOwnProperty(a)){var s=ln(this,e,n,this._tracks[a],a,t);s&&(this._clipList.push(s),r++,this.animation&&this.animation.addClip(s),o=s)}if(o){var l=o.onframe;o.onframe=function(e,t){l(e,t);for(var n=0;n<i._onframeList.length;n++)i._onframeList[n](e,t)}}return r||this._doneCallback(),this},stop:function(e){for(var t=this._clipList,n=this.animation,o=0;o<t.length;o++){var i=t[o];e&&i.onframe(this._target,1),n&&n.removeClip(i)}t.length=0},delay:function(e){return this._delay=e,this},done:function(e){return e&&this._doneList.push(e),this},getClips:function(){return this._clipList}};var cn=1;"undefined"!=typeof window&&(cn=Math.max(window.devicePixelRatio||1,1));var dn=cn;function fn(){this.animators=[]}function hn(e,t,n,o,i,r,a,s){P(o)?(r=i,i=o,o=0):K(i)?(r=i,i="linear",o=0):K(o)?(r=o,o=0):n=K(n)?(r=n,500):n||500,e.stopAnimation(),function e(t,n,o,i,r,a,s){var l={},u=0;for(var c in i)i.hasOwnProperty(c)&&(null!=o[c]?L(i[c])&&!D(i[c])?e(t,n?n+"."+c:c,o[c],i[c],r,a,s):(s?(l[c]=o[c],gn(t,n,c,i[c])):l[c]=i[c],u++):null==i[c]||s||gn(t,n,c,i[c]));0<u&&t.animate(n,!1).when(null==r?500:r,l).delay(a||0)}(e,"",e,t,n,o,s);var l=e.animators.slice(),u=l.length;function c(){--u||r&&r()}u||r&&r();for(var d=0;d<l.length;d++)l[d].done(c).start(i,a)}function gn(e,t,n,o){if(t){var i={};i[t]={},i[t][n]=o,e.attr(i)}else e.attr(n,o)}fn.prototype={constructor:fn,animate:function(e,t){var n,o=!1,i=this,r=this.__zr;if(e){var a=e.split("."),s=i;o="shape"===a[0];for(var l=0,u=a.length;l<u;l++)s=s&&s[a[l]];s&&(n=s)}else n=i;if(n){var c=i.animators,d=new un(n,t);return d.during((function(e){i.dirty(o)})).done((function(){c.splice(E(c,d),1)})),c.push(d),r&&r.animation.addAnimator(d),d}},stopAnimation:function(e){for(var t=this.animators,n=t.length,o=0;o<n;o++)t[o].stop(e);return t.length=0,this},animateTo:function(e,t,n,o,i,r){hn(this,e,t,n,o,i,r)},animateFrom:function(e,t,n,o,i,r){hn(this,e,t,n,o,i,r,!0)}};var mn=function(e){mt.call(this,e),Oe.call(this,e),fn.call(this,e),this.id=e.id||o()};mn.prototype={type:"element",name:"",__zr:null,ignore:!1,clipPath:null,isGroup:!1,drift:function(e,t){switch(this.draggable){case"horizontal":t=0;break;case"vertical":e=0}var n=this.transform;(n=n||(this.transform=[1,0,0,1,0,0]))[4]+=e,n[5]+=t,this.decomposeTransform(),this.dirty(!1)},beforeUpdate:function(){},afterUpdate:function(){},update:function(){this.updateTransform()},traverse:function(e,t){},attrKV:function(e,t){if("position"===e||"scale"===e||"origin"===e){if(t){var n=this[e];(n=n||(this[e]=[]))[0]=t[0],n[1]=t[1]}}else this[e]=t},hide:function(){this.ignore=!0,this.__zr&&this.__zr.refresh()},show:function(){this.ignore=!1,this.__zr&&this.__zr.refresh()},attr:function(e,t){if("string"==typeof e)this.attrKV(e,t);else if(L(e))for(var n in e)e.hasOwnProperty(n)&&this.attrKV(n,e[n]);return this.dirty(!1),this},setClipPath:function(e){var t=this.__zr;t&&e.addSelfToZr(t),this.clipPath&&this.clipPath!==e&&this.removeClipPath(),(this.clipPath=e).__zr=t,(e.__clipTarget=this).dirty(!1)},removeClipPath:function(){var e=this.clipPath;e&&(e.__zr&&e.removeSelfFromZr(e.__zr),e.__zr=null,e.__clipTarget=null,this.clipPath=null,this.dirty(!1))},addSelfToZr:function(e){this.__zr=e;var t=this.animators;if(t)for(var n=0;n<t.length;n++)e.animation.addAnimator(t[n]);this.clipPath&&this.clipPath.addSelfToZr(e)},removeSelfFromZr:function(e){this.__zr=null;var t=this.animators;if(t)for(var n=0;n<t.length;n++)e.animation.removeAnimator(t[n]);this.clipPath&&this.clipPath.removeSelfFromZr(e)}},I(mn,fn),I(mn,mt),I(mn,Oe);var pn,vn,yn,bn,Cn=Ce,Tn=Math.min,xn=Math.max;function En(e,t,n,o){n<0&&(e+=n,n=-n),o<0&&(t+=o,o=-o),this.x=e,this.y=t,this.width=n,this.height=o}En.prototype={constructor:En,union:function(e){var t=Tn(e.x,this.x),n=Tn(e.y,this.y);this.width=xn(e.x+e.width,this.x+this.width)-t,this.height=xn(e.y+e.height,this.y+this.height)-n,this.x=t,this.y=n},applyTransform:(pn=[],vn=[],yn=[],bn=[],function(e){if(e){pn[0]=yn[0]=this.x,pn[1]=bn[1]=this.y,vn[0]=bn[0]=this.x+this.width,vn[1]=yn[1]=this.y+this.height,Cn(pn,pn,e),Cn(vn,vn,e),Cn(yn,yn,e),Cn(bn,bn,e),this.x=Tn(pn[0],vn[0],yn[0],bn[0]),this.y=Tn(pn[1],vn[1],yn[1],bn[1]);var t=xn(pn[0],vn[0],yn[0],bn[0]),n=xn(pn[1],vn[1],yn[1],bn[1]);this.width=t-this.x,this.height=n-this.y}}),calculateTransform:function(e){var t=e.width/this.width,n=e.height/this.height,o=ot();return st(o,o,[-this.x,-this.y]),ut(o,o,[t,n]),st(o,o,[e.x,e.y]),o},intersect:function(e){if(!e)return!1;e instanceof En||(e=En.create(e));var t=this;return!(t.x+t.width<e.x||e.x+e.width<t.x||t.y+t.height<e.y||e.y+e.height<t.y)},contain:function(e,t){var n=this;return e>=n.x&&e<=n.x+n.width&&t>=n.y&&t<=n.y+n.height},clone:function(){return new En(this.x,this.y,this.width,this.height)},copy:function(e){this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height},plain:function(){return{x:this.x,y:this.y,width:this.width,height:this.height}}},En.create=function(e){return new En(e.x,e.y,e.width,e.height)};var _n=function(e){for(var t in mn.call(this,e=e||{}),e)e.hasOwnProperty(t)&&(this[t]=e[t]);this._children=[],this.__storage=null,this.__dirty=!0};function In(e,t,n,o){var i=t+1;if(i===n)return 1;if(o(e[i++],e[t])<0){for(;i<n&&o(e[i],e[i-1])<0;)i++;!function(e,t,n){for(n--;t<n;){var o=e[t];e[t++]=e[n],e[n--]=o}}(e,t,i)}else for(;i<n&&0<=o(e[i],e[i-1]);)i++;return i-t}function Dn(e,t,n,o,i){for(o===t&&o++;o<n;o++){for(var r,a=e[o],s=t,l=o;s<l;)i(a,e[r=s+l>>>1])<0?l=r:s=1+r;var u=o-s;switch(u){case 3:e[s+3]=e[s+2];case 2:e[s+2]=e[s+1];case 1:e[s+1]=e[s];break;default:for(;0<u;)e[s+u]=e[s+u-1],u--}e[s]=a}}function On(e,t,n,o,i,r){var a=0,s=0,l=1;if(0<r(e,t[n+i])){for(s=o-i;l<s&&0<r(e,t[n+i+l]);)(l=1+((a=l)<<1))<=0&&(l=s);s<l&&(l=s),a+=i,l+=i}else{for(s=i+1;l<s&&r(e,t[n+i-l])<=0;)(l=1+((a=l)<<1))<=0&&(l=s);s<l&&(l=s);var u=a;a=i-l,l=i-u}for(a++;a<l;){var c=a+(l-a>>>1);0<r(e,t[n+c])?a=c+1:l=c}return l}function wn(e,t,n,o,i,r){var a=0,s=0,l=1;if(r(e,t[n+i])<0){for(s=i+1;l<s&&r(e,t[n+i-l])<0;)(l=1+((a=l)<<1))<=0&&(l=s);s<l&&(l=s);var u=a;a=i-l,l=i-u}else{for(s=o-i;l<s&&0<=r(e,t[n+i+l]);)(l=1+((a=l)<<1))<=0&&(l=s);s<l&&(l=s),a+=i,l+=i}for(a++;a<l;){var c=a+(l-a>>>1);r(e,t[n+c])<0?l=c:a=c+1}return l}function Rn(e,t){var n,o,i=7,r=0,a=[];function s(s){var l=n[s],u=o[s],c=n[s+1],d=o[s+1];o[s]=u+d,s===r-3&&(n[s+1]=n[s+2],o[s+1]=o[s+2]),r--;var f=wn(e[c],e,l,u,0,t);l+=f,0!=(u-=f)&&0!==(d=On(e[l+u-1],e,c,d,d-1,t))&&(u<=d?function(n,o,r,s){var l=0;for(l=0;l<o;l++)a[l]=e[n+l];var u=0,c=r,d=n;if(e[d++]=e[c++],0!=--s){if(1===o){for(l=0;l<s;l++)e[d+l]=e[c+l];return e[d+s]=a[u]}for(var f,h,g,m=i;;){h=f=0,g=!1;do{if(t(e[c],a[u])<0){if(e[d++]=e[c++],h++,(f=0)==--s){g=!0;break}}else if(e[d++]=a[u++],f++,h=0,1==--o){g=!0;break}}while((f|h)<m);if(g)break;do{if(0!==(f=wn(e[c],a,u,o,0,t))){for(l=0;l<f;l++)e[d+l]=a[u+l];if(d+=f,u+=f,(o-=f)<=1){g=!0;break}}if(e[d++]=e[c++],0==--s){g=!0;break}if(0!==(h=On(a[u],e,c,s,0,t))){for(l=0;l<h;l++)e[d+l]=e[c+l];if(d+=h,c+=h,0==(s-=h)){g=!0;break}}if(e[d++]=a[u++],1==--o){g=!0;break}m--}while(7<=f||7<=h);if(g)break;m<0&&(m=0),m+=2}if((i=m)<1&&(i=1),1===o){for(l=0;l<s;l++)e[d+l]=e[c+l];e[d+s]=a[u]}else{if(0===o)throw new Error;for(l=0;l<o;l++)e[d+l]=a[u+l]}}else for(l=0;l<o;l++)e[d+l]=a[u+l]}(l,u,c,d):function(n,o,r,s){var l=0;for(l=0;l<s;l++)a[l]=e[r+l];var u=n+o-1,c=s-1,d=r+s-1,f=0,h=0;if(e[d--]=e[u--],0!=--o){if(1===s){for(h=1+(d-=o),f=1+(u-=o),l=o-1;0<=l;l--)e[h+l]=e[f+l];return e[d]=a[c]}for(var g=i;;){var m=0,p=0,v=!1;do{if(t(a[c],e[u])<0){if(e[d--]=e[u--],m++,(p=0)==--o){v=!0;break}}else if(e[d--]=a[c--],p++,m=0,1==--s){v=!0;break}}while((m|p)<g);if(v)break;do{if(0!=(m=o-wn(a[c],e,n,o,o-1,t))){for(o-=m,h=1+(d-=m),f=1+(u-=m),l=m-1;0<=l;l--)e[h+l]=e[f+l];if(0===o){v=!0;break}}if(e[d--]=a[c--],1==--s){v=!0;break}if(0!=(p=s-On(e[u],a,0,s,s-1,t))){for(s-=p,h=1+(d-=p),f=1+(c-=p),l=0;l<p;l++)e[h+l]=a[f+l];if(s<=1){v=!0;break}}if(e[d--]=e[u--],0==--o){v=!0;break}g--}while(7<=m||7<=p);if(v)break;g<0&&(g=0),g+=2}if((i=g)<1&&(i=1),1===s){for(h=1+(d-=o),f=1+(u-=o),l=o-1;0<=l;l--)e[h+l]=e[f+l];e[d]=a[c]}else{if(0===s)throw new Error;for(f=d-(s-1),l=0;l<s;l++)e[f+l]=a[l]}}else for(f=d-(s-1),l=0;l<s;l++)e[f+l]=a[l]}(l,u,c,d))}n=[],o=[],this.mergeRuns=function(){for(;1<r;){var e=r-2;if(1<=e&&o[e-1]<=o[e]+o[e+1]||2<=e&&o[e-2]<=o[e]+o[e-1])o[e-1]<o[e+1]&&e--;else if(o[e]>o[e+1])break;s(e)}},this.forceMergeRuns=function(){for(;1<r;){var e=r-2;0<e&&o[e-1]<o[e+1]&&e--,s(e)}},this.pushRun=function(e,t){n[r]=e,o[r]=t,r+=1}}function Sn(e,t,n,o){var i=(o=o||e.length)-(n=n||0);if(!(i<2)){var r=0;if(i<32)Dn(e,n,o,n+(r=In(e,n,o,t)),t);else{var a=new Rn(e,t),s=function(e){for(var t=0;32<=e;)t|=1&e,e>>=1;return e+t}(i);do{if((r=In(e,n,o,t))<s){var l=i;s<l&&(l=s),Dn(e,n,n+l,n+r,t),r=l}a.pushRun(n,r),a.mergeRuns(),i-=r,n+=r}while(0!==i);a.forceMergeRuns()}}}function kn(e,t){return e.zlevel===t.zlevel?e.z===t.z?e.z2-t.z2:e.z-t.z:e.zlevel-t.zlevel}function An(){this._roots=[],this._displayList=[],this._displayListLen=0}_n.prototype={constructor:_n,isGroup:!0,type:"group",silent:!1,children:function(){return this._children.slice()},childAt:function(e){return this._children[e]},childOfName:function(e){for(var t=this._children,n=0;n<t.length;n++)if(t[n].name===e)return t[n]},childCount:function(){return this._children.length},add:function(e){return e&&e!==this&&e.parent!==this&&(this._children.push(e),this._doAdd(e)),this},addBefore:function(e,t){if(e&&e!==this&&e.parent!==this&&t&&t.parent===this){var n=this._children,o=n.indexOf(t);0<=o&&(n.splice(o,0,e),this._doAdd(e))}return this},_doAdd:function(e){e.parent&&e.parent.remove(e);var t=(e.parent=this).__storage,n=this.__zr;t&&t!==e.__storage&&(t.addToStorage(e),e instanceof _n&&e.addChildrenToStorage(t)),n&&n.refresh()},remove:function(e){var t=this.__zr,n=this.__storage,o=this._children,i=E(o,e);return i<0||(o.splice(i,1),e.parent=null,n&&(n.delFromStorage(e),e instanceof _n&&e.delChildrenFromStorage(n)),t&&t.refresh()),this},removeAll:function(){var e,t,n=this._children,o=this.__storage;for(t=0;t<n.length;t++)e=n[t],o&&(o.delFromStorage(e),e instanceof _n&&e.delChildrenFromStorage(o)),e.parent=null;return n.length=0,this},eachChild:function(e,t){for(var n=this._children,o=0;o<n.length;o++)e.call(t,n[o],o);return this},traverse:function(e,t){for(var n=0;n<this._children.length;n++){var o=this._children[n];e.call(t,o),"group"===o.type&&o.traverse(e,t)}return this},addChildrenToStorage:function(e){for(var t=0;t<this._children.length;t++){var n=this._children[t];e.addToStorage(n),n instanceof _n&&n.addChildrenToStorage(e)}},delChildrenFromStorage:function(e){for(var t=0;t<this._children.length;t++){var n=this._children[t];e.delFromStorage(n),n instanceof _n&&n.delChildrenFromStorage(e)}},dirty:function(){return this.__dirty=!0,this.__zr&&this.__zr.refresh(),this},getBoundingRect:function(e){for(var t=null,n=new En(0,0,0,0),o=e||this._children,i=[],r=0;r<o.length;r++){var a=o[r];if(!a.ignore&&!a.invisible){var s=a.getBoundingRect(),l=a.getLocalTransform(i);l?(n.copy(s),n.applyTransform(l),(t=t||n.clone()).union(n)):(t=t||s.clone()).union(s)}}return t||n}},_(_n,mn),An.prototype={constructor:An,traverse:function(e,t){for(var n=0;n<this._roots.length;n++)this._roots[n].traverse(e,t)},getDisplayList:function(e,t){return t=t||!1,e&&this.updateDisplayList(t),this._displayList},updateDisplayList:function(e){this._displayListLen=0;for(var t=this._roots,n=this._displayList,o=0,r=t.length;o<r;o++)this._updateAndAddDisplayable(t[o],null,e);n.length=this._displayListLen,i.canvasSupported&&Sn(n,kn)},_updateAndAddDisplayable:function(e,t,n){if(!e.ignore||n){e.beforeUpdate(),e.__dirty&&e.update(),e.afterUpdate();var o=e.clipPath;if(o){t=t?t.slice():[];for(var i=o,r=e;i;)i.parent=r,i.updateTransform(),t.push(i),i=(r=i).clipPath}if(e.isGroup){for(var a=e._children,s=0;s<a.length;s++){var l=a[s];e.__dirty&&(l.__dirty=!0),this._updateAndAddDisplayable(l,t,n)}e.__dirty=!1}else e.__clipPaths=t,this._displayList[this._displayListLen++]=e}},addRoot:function(e){e.__storage!==this&&(e instanceof _n&&e.addChildrenToStorage(this),this.addToStorage(e),this._roots.push(e))},delRoot:function(e){if(null==e){for(var t=0;t<this._roots.length;t++){var n=this._roots[t];n instanceof _n&&n.delChildrenFromStorage(this)}return this._roots=[],this._displayList=[],void(this._displayListLen=0)}if(e instanceof Array){t=0;for(var o=e.length;t<o;t++)this.delRoot(e[t])}else{var i=E(this._roots,e);0<=i&&(this.delFromStorage(e),this._roots.splice(i,1),e instanceof _n&&e.delChildrenFromStorage(this))}},addToStorage:function(e){return e&&(e.__storage=this,e.dirty(!1)),this},delFromStorage:function(e){return e&&(e.__storage=null),this},dispose:function(){this._renderList=this._roots=null},displayableSortFunc:kn};var Nn={shadowBlur:1,shadowOffsetX:1,shadowOffsetY:1,textShadowBlur:1,textShadowOffsetX:1,textShadowOffsetY:1,textBoxShadowBlur:1,textBoxShadowOffsetX:1,textBoxShadowOffsetY:1},Mn=function(e,t,n){return Nn.hasOwnProperty(t)?n*e.dpr:n},Kn=[["shadowBlur",0],["shadowOffsetX",0],["shadowOffsetY",0],["shadowColor","#000"],["lineCap","butt"],["lineJoin","miter"],["miterLimit",10]],Pn=function(e){this.extendFrom(e,!1)};function Ln(e,t,n){var o=null==t.x?0:t.x,i=null==t.x2?1:t.x2,r=null==t.y?0:t.y,a=null==t.y2?0:t.y2;return t.global||(o=o*n.width+n.x,i=i*n.width+n.x,r=r*n.height+n.y,a=a*n.height+n.y),o=isNaN(o)?0:o,i=isNaN(i)?1:i,r=isNaN(r)?0:r,a=isNaN(a)?0:a,e.createLinearGradient(o,r,i,a)}function Bn(e,t,n){var o=n.width,i=n.height,r=Math.min(o,i),a=null==t.x?.5:t.x,s=null==t.y?.5:t.y,l=null==t.r?.5:t.r;return t.global||(a=a*o+n.x,s=s*i+n.y,l*=r),e.createRadialGradient(a,s,0,a,s,l)}for(var Fn=Pn.prototype={constructor:Pn,fill:"#000",stroke:null,opacity:1,fillOpacity:null,strokeOpacity:null,lineDash:null,lineDashOffset:0,shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,lineWidth:1,strokeNoScale:!1,text:null,font:null,textFont:null,fontStyle:null,fontWeight:null,fontSize:null,fontFamily:null,textTag:null,textFill:"#000",textStroke:null,textWidth:null,textHeight:null,textStrokeWidth:0,textLineHeight:null,textPosition:"inside",textRect:null,textOffset:null,textAlign:null,textVerticalAlign:null,textDistance:5,textShadowColor:"transparent",textShadowBlur:0,textShadowOffsetX:0,textShadowOffsetY:0,textBoxShadowColor:"transparent",textBoxShadowBlur:0,textBoxShadowOffsetX:0,textBoxShadowOffsetY:0,transformText:!1,textRotation:0,textOrigin:null,textBackgroundColor:null,textBorderColor:null,textBorderWidth:0,textBorderRadius:0,textPadding:null,rich:null,truncate:null,blend:null,bind:function(e,t,n){var o=this,i=n&&n.style,r=!i||1!==e.__attrCachedBy;e.__attrCachedBy=1;for(var a=0;a<Kn.length;a++){var s=Kn[a],l=s[0];!r&&o[l]===i[l]||(e[l]=Mn(e,l,o[l]||s[1]))}!r&&o.fill===i.fill||(e.fillStyle=o.fill),!r&&o.stroke===i.stroke||(e.strokeStyle=o.stroke),!r&&o.opacity===i.opacity||(e.globalAlpha=null==o.opacity?1:o.opacity),!r&&o.blend===i.blend||(e.globalCompositeOperation=o.blend||"source-over"),this.hasStroke()&&(e.lineWidth=o.lineWidth/(this.strokeNoScale&&t&&t.getLineScale?t.getLineScale():1))},hasFill:function(){var e=this.fill;return null!=e&&"none"!==e},hasStroke:function(){var e=this.stroke;return null!=e&&"none"!==e&&0<this.lineWidth},extendFrom:function(e,t){if(e)for(var n in e)!e.hasOwnProperty(n)||!0!==t&&(!1===t?this.hasOwnProperty(n):null==e[n])||(this[n]=e[n])},set:function(e,t){"string"==typeof e?this[e]=t:this.extendFrom(e,!0)},clone:function(){var e=new this.constructor;return e.extendFrom(this,!0),e},getGradient:function(e,t,n){for(var o=("radial"===t.type?Bn:Ln)(e,t,n),i=t.colorStops,r=0;r<i.length;r++)o.addColorStop(i[r].offset,i[r].color);return o}},zn=0;zn<Kn.length;zn++){var Vn=Kn[zn];Vn[0]in Fn||(Fn[Vn[0]]=Vn[1])}function Hn(e,t){this.image=e,this.repeat=t,this.type="pattern"}function Wn(){return!1}function $n(e,t,n){var o=T(),i=t.getWidth(),r=t.getHeight(),a=o.style;return a&&(a.position="absolute",a.left=0,a.top=0,a.width=i+"px",a.height=r+"px",o.setAttribute("data-zr-dom-id",e)),o.width=i*n,o.height=r*n,o}function Un(e,t,n){var o;n=n||dn,"string"==typeof e?o=$n(e,t,n):L(e)&&(e=(o=e).id),this.id=e;var i=(this.dom=o).style;i&&(o.onselectstart=Wn,i["-webkit-user-select"]="none",i["user-select"]="none",i["-webkit-touch-callout"]="none",i["-webkit-tap-highlight-color"]="rgba(0,0,0,0)",i.padding=0,i.margin=0,i["border-width"]=0),this.domBack=null,this.ctxBack=null,this.painter=t,this.config=null,this.clearColor=0,this.motionBlur=!1,this.lastFrameAlpha=.7,this.dpr=n}Pn.getGradient=Fn.getGradient,Un.prototype={constructor:Un,__dirty:!0,__used:!(Hn.prototype.getCanvasPattern=function(e){return e.createPattern(this.image,this.repeat||"repeat")}),__drawIndex:0,__startIndex:0,__endIndex:0,incremental:!1,getElementCount:function(){return this.__endIndex-this.__startIndex},initContext:function(){this.ctx=this.dom.getContext("2d"),this.ctx.dpr=this.dpr},createBackBuffer:function(){var e=this.dpr;this.domBack=$n("back-"+this.id,this.painter,e),this.ctxBack=this.domBack.getContext("2d"),1!==e&&this.ctxBack.scale(e,e)},resize:function(e,t){var n=this.dpr,o=this.dom,i=o.style,r=this.domBack;i&&(i.width=e+"px",i.height=t+"px"),o.width=e*n,o.height=t*n,r&&(r.width=e*n,r.height=t*n,1!==n&&this.ctxBack.scale(n,n))},clear:function(e,t){var n,o=this.dom,i=this.ctx,r=o.width,a=o.height,s=(t=t||this.clearColor,this.motionBlur&&!e),l=this.lastFrameAlpha,u=this.dpr;if(s&&(this.domBack||this.createBackBuffer(),this.ctxBack.globalCompositeOperation="copy",this.ctxBack.drawImage(o,0,0,r/u,a/u)),i.clearRect(0,0,r,a),t&&"transparent"!==t&&(t.colorStops?(n=t.__canvasGradient||Pn.getGradient(i,t,{x:0,y:0,width:r,height:a}),t.__canvasGradient=n):t.image&&(n=Hn.prototype.getCanvasPattern.call(t,i)),i.save(),i.fillStyle=n||t,i.fillRect(0,0,r,a),i.restore()),s){var c=this.domBack;i.save(),i.globalAlpha=l,i.drawImage(c,0,0,r,a),i.restore()}}};var qn="undefined"!=typeof window&&(window.requestAnimationFrame&&window.requestAnimationFrame.bind(window)||window.msRequestAnimationFrame&&window.msRequestAnimationFrame.bind(window)||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame)||function(e){setTimeout(e,16)},jn=new _t(50);function Gn(e){if("string"!=typeof e)return e;var t=jn.get(e);return t&&t.image}function Xn(e,t,n,o,i){if(e){if("string"!=typeof e)return e;if(t&&t.__zrImageSrc===e||!n)return t;var r=jn.get(e),a={hostEl:n,cb:o,cbPayload:i};return r?Zn(t=r.image)||r.pending.push(a):((t=new Image).onload=t.onerror=Yn,jn.put(e,t.__cachedImgObj={image:t,pending:[a]}),t.src=t.__zrImageSrc=e),t}return t}function Yn(){var e=this.__cachedImgObj;this.onload=this.onerror=this.__cachedImgObj=null;for(var t=0;t<e.pending.length;t++){var n=e.pending[t],o=n.cb;o&&o(this,n.cbPayload),n.hostEl.dirty()}e.pending.length=0}function Zn(e){return e&&e.width&&e.height}var Jn={},Qn=0,eo=/\{([a-zA-Z0-9_]+)\|([^}]*)\}/g,to="12px sans-serif",no={};function oo(e,t){var n=e+":"+(t=t||to);if(Jn[n])return Jn[n];for(var o,i,r=(e+"").split("\n"),a=0,s=0,l=r.length;s<l;s++)a=Math.max((o=r[s],i=t,no.measureText(o,i)).width,a);return 5e3<Qn&&(Qn=0,Jn={}),Qn++,Jn[n]=a}function io(e,t,n,o,i,r,a,s){return a?function(e,t,n,o,i,r,a,s){var l=mo(e,{rich:a,truncate:s,font:t,textAlign:n,textPadding:i,textLineHeight:r}),u=l.outerWidth,c=l.outerHeight;return new En(ro(0,u,n),ao(0,c,o),u,c)}(e,t,n,o,i,r,a,s):function(e,t,n,o,i,r,a){var s=go(e,t,i,r,a),l=oo(e,t);i&&(l+=i[1]+i[3]);var u=s.outerHeight,c=new En(ro(0,l,n),ao(0,u,o),l,u);return c.lineHeight=s.lineHeight,c}(e,t,n,o,i,r,s)}function ro(e,t,n){return"right"===n?e-=t:"center"===n&&(e-=t/2),e}function ao(e,t,n){return"middle"===n?e-=t/2:"bottom"===n&&(e-=t),e}function so(e,t,n){var o=t.textDistance,i=n.x,r=n.y;o=o||0;var a=n.height,s=n.width,l=a/2,u="left",c="top";switch(t.textPosition){case"left":i-=o,r+=l,u="right",c="middle";break;case"right":i+=o+s,r+=l,c="middle";break;case"top":i+=s/2,r-=o,u="center",c="bottom";break;case"bottom":i+=s/2,r+=a+o,u="center";break;case"inside":i+=s/2,r+=l,u="center",c="middle";break;case"insideLeft":i+=o,r+=l,c="middle";break;case"insideRight":i+=s-o,r+=l,u="right",c="middle";break;case"insideTop":i+=s/2,r+=o,u="center";break;case"insideBottom":i+=s/2,r+=a-o,u="center",c="bottom";break;case"insideTopLeft":i+=o,r+=o;break;case"insideTopRight":i+=s-o,r+=o,u="right";break;case"insideBottomLeft":i+=o,r+=a-o,c="bottom";break;case"insideBottomRight":i+=s-o,r+=a-o,u="right",c="bottom"}return(e=e||{}).x=i,e.y=r,e.textAlign=u,e.textVerticalAlign=c,e}function lo(e,t,n,o,i){if(!t)return"";var r=(e+"").split("\n");i=uo(t,n,o,i);for(var a=0,s=r.length;a<s;a++)r[a]=co(r[a],i);return r.join("\n")}function uo(e,t,n,o){(o=b({},o)).font=t,n=W(n,"..."),o.maxIterations=W(o.maxIterations,2);var i=o.minChar=W(o.minChar,0);o.cnCharWidth=oo("国",t);var r=o.ascCharWidth=oo("a",t);o.placeholder=W(o.placeholder,"");for(var a=e=Math.max(0,e-1),s=0;s<i&&r<=a;s++)a-=r;var l=oo(n,t);return a<l&&(n="",l=0),a=e-l,o.ellipsis=n,o.ellipsisWidth=l,o.contentWidth=a,o.containerWidth=e,o}function co(e,t){var n=t.containerWidth,o=t.font,i=t.contentWidth;if(!n)return"";var r=oo(e,o);if(r<=n)return e;for(var a=0;;a++){if(r<=i||a>=t.maxIterations){e+=t.ellipsis;break}var s=0===a?fo(e,i,t.ascCharWidth,t.cnCharWidth):0<r?Math.floor(e.length*i/r):0;r=oo(e=e.substr(0,s),o)}return""===e&&(e=t.placeholder),e}function fo(e,t,n,o){for(var i=0,r=0,a=e.length;r<a&&i<t;r++){var s=e.charCodeAt(r);i+=0<=s&&s<=127?n:o}return r}function ho(e){return oo("国",e)}function go(e,t,n,o,i){null!=e&&(e+="");var r=W(o,ho(t)),a=e?e.split("\n"):[],s=a.length*r,l=s,u=!0;if(n&&(l+=n[0]+n[2]),e&&i){u=!1;var c=i.outerHeight,d=i.outerWidth;if(null!=c&&c<l)e="",a=[];else if(null!=d)for(var f=uo(d-(n?n[1]+n[3]:0),t,i.ellipsis,{minChar:i.minChar,placeholder:i.placeholder}),h=0,g=a.length;h<g;h++)a[h]=co(a[h],f)}return{lines:a,height:s,outerHeight:l,lineHeight:r,canCacheByTextString:u}}function mo(e,t){var n={lines:[],width:0,height:0};if(null!=e&&(e+=""),!e)return n;for(var o,i=eo.lastIndex=0;null!=(o=eo.exec(e));){var r=o.index;i<r&&po(n,e.substring(i,r)),po(n,o[2],o[1]),i=eo.lastIndex}i<e.length&&po(n,e.substring(i,e.length));var a=n.lines,s=0,l=0,u=[],c=t.textPadding,d=t.truncate,f=d&&d.outerWidth,h=d&&d.outerHeight;c&&(null!=f&&(f-=c[1]+c[3]),null!=h&&(h-=c[0]+c[2]));for(var g=0;g<a.length;g++){for(var m=a[g],p=0,v=0,y=0;y<m.tokens.length;y++){var b=(R=m.tokens[y]).styleName&&t.rich[R.styleName]||{},C=R.textPadding=b.textPadding,T=R.font=b.font||t.font,x=R.textHeight=W(b.textHeight,ho(T));if(C&&(x+=C[0]+C[2]),R.height=x,R.lineHeight=$(b.textLineHeight,t.textLineHeight,x),R.textAlign=b&&b.textAlign||t.textAlign,R.textVerticalAlign=b&&b.textVerticalAlign||"middle",null!=h&&s+R.lineHeight>h)return{lines:[],width:0,height:0};R.textWidth=oo(R.text,T);var E=b.textWidth,_=null==E||"auto"===E;if("string"==typeof E&&"%"===E.charAt(E.length-1))R.percentWidth=E,u.push(R),E=0;else{if(_){E=R.textWidth;var I=b.textBackgroundColor,D=I&&I.image;D&&Zn(D=Gn(D))&&(E=Math.max(E,D.width*x/D.height))}var O=C?C[1]+C[3]:0;E+=O;var w=null!=f?f-v:null;null!=w&&w<E&&(!_||w<O?(R.text="",R.textWidth=E=0):(R.text=lo(R.text,w-O,T,d.ellipsis,{minChar:d.minChar}),R.textWidth=oo(R.text,T),E=R.textWidth+O))}v+=R.width=E,b&&(p=Math.max(p,R.lineHeight))}m.width=v,s+=m.lineHeight=p,l=Math.max(l,v)}for(n.outerWidth=n.width=W(t.textWidth,l),n.outerHeight=n.height=W(t.textHeight,s),c&&(n.outerWidth+=c[1]+c[3],n.outerHeight+=c[0]+c[2]),g=0;g<u.length;g++){var R,S=(R=u[g]).percentWidth;R.width=parseInt(S,10)/100*l}return n}function po(e,t,n){for(var o=""===t,i=t.split("\n"),r=e.lines,a=0;a<i.length;a++){var s=i[a],l={styleName:n,text:s,isLineHolder:!s&&!o};if(a)r.push({tokens:[l]});else{var u=(r[r.length-1]||(r[0]={tokens:[]})).tokens,c=u.length;1===c&&u[0].isLineHolder?u[0]=l:!s&&c&&!o||u.push(l)}}}function vo(e){var t=(e.fontSize||e.fontFamily)&&[e.fontStyle,e.fontWeight,(e.fontSize||12)+"px",e.fontFamily||"sans-serif"].join(" ");return t&&G(t)||e.textFont||e.font}function yo(e,t){var n,o,i,r,a,s=t.x,l=t.y,u=t.width,c=t.height,d=t.r;u<0&&(s+=u,u=-u),c<0&&(l+=c,c=-c),"number"==typeof d?n=o=i=r=d:d instanceof Array?1===d.length?n=o=i=r=d[0]:2===d.length?(n=i=d[0],o=r=d[1]):3===d.length?(n=d[0],o=r=d[1],i=d[2]):(n=d[0],o=d[1],i=d[2],r=d[3]):n=o=i=r=0,u<n+o&&(n*=u/(a=n+o),o*=u/a),u<i+r&&(i*=u/(a=i+r),r*=u/a),c<o+i&&(o*=c/(a=o+i),i*=c/a),c<n+r&&(n*=c/(a=n+r),r*=c/a),e.moveTo(s+n,l),e.lineTo(s+u-o,l),0!==o&&e.arc(s+u-o,l+o,o,-Math.PI/2,0),e.lineTo(s+u,l+c-i),0!==i&&e.arc(s+u-i,l+c-i,i,0,Math.PI/2),e.lineTo(s+r,l+c),0!==r&&e.arc(s+r,l+c-r,r,Math.PI/2,Math.PI),e.lineTo(s,l+n),0!==n&&e.arc(s+n,l+n,n,Math.PI,1.5*Math.PI)}no.measureText=function(e,t){var n=x();return n.font=t||to,n.measureText(e)};var bo=to,Co={left:1,right:1,center:1},To={top:1,bottom:1,middle:1},xo=[["textShadowBlur","shadowBlur",0],["textShadowOffsetX","shadowOffsetX",0],["textShadowOffsetY","shadowOffsetY",0],["textShadowColor","shadowColor","transparent"]],Eo={},_o={};function Io(e){return Do(e),O(e.rich,Do),e}function Do(e){if(e){e.font=vo(e);var t=e.textAlign;"middle"===t&&(t="center"),e.textAlign=null==t||Co[t]?t:"left";var n=e.textVerticalAlign||e.textBaseline;"center"===n&&(n="middle"),e.textVerticalAlign=null==n||To[n]?n:"top",e.textPadding&&(e.textPadding=q(e.textPadding))}}function Oo(e,t,n,o,i,r){o.rich?function(e,t,n,o,i,r){9!==r&&(t.__attrCachedBy=0);var a=e.__textCotentBlock;a&&!e.__dirtyText||(a=e.__textCotentBlock=mo(n,o)),function(e,t,n,o,i){var r=n.width,a=n.outerWidth,s=n.outerHeight,l=o.textPadding,u=No(_o,e,o,i),c=u.baseX,d=u.baseY,f=u.textAlign,h=u.textVerticalAlign;wo(t,o,i,c,d);var g=ro(c,a,f),m=ao(d,s,h),p=g,v=m;l&&(p+=l[3],v+=l[0]);var y=p+r;So(o)&&ko(e,t,o,g,m,a,s);for(var b=0;b<n.lines.length;b++){for(var C,T=n.lines[b],x=T.tokens,E=x.length,_=T.lineHeight,I=T.width,D=0,O=p,w=y,R=E-1;D<E&&(!(C=x[D]).textAlign||"left"===C.textAlign);)Ro(e,t,C,o,_,v,O,"left"),I-=C.width,O+=C.width,D++;for(;0<=R&&"right"===(C=x[R]).textAlign;)Ro(e,t,C,o,_,v,w,"right"),I-=C.width,w-=C.width,R--;for(O+=(r-(O-p)-(y-w)-I)/2;D<=R;)Ro(e,t,C=x[D],o,_,v,O+C.width/2,"center"),O+=C.width,D++;v+=_}}(e,t,a,o,i)}(e,t,n,o,i,r):function(e,t,n,o,i,r){var a,s=So(o),l=!1,u=2===t.__attrCachedBy;9!==r?(r&&(a=r.style,l=!s&&u&&a),t.__attrCachedBy=s?0:2):u&&(t.__attrCachedBy=0);var c=o.font||bo;l&&c===(a.font||bo)||(t.font=c);var d=e.__computedFont;e.__styleFont!==c&&(e.__styleFont=c,d=e.__computedFont=t.font);var f=o.textPadding,h=e.__textCotentBlock;h&&!e.__dirtyText||(h=e.__textCotentBlock=go(n,d,f,o.textLineHeight,o.truncate));var g=h.outerHeight,m=h.lines,p=h.lineHeight,v=No(_o,e,o,i),y=v.baseX,b=v.baseY,C=v.textAlign||"left",T=v.textVerticalAlign;wo(t,o,i,y,b);var x=ao(b,g,T),E=y,_=x;if(s||f){var I=oo(n,d);f&&(I+=f[1]+f[3]);var D=ro(y,I,C);s&&ko(e,t,o,D,x,I,g),f&&(E=Bo(y,C,f),_+=f[0])}t.textAlign=C,t.textBaseline="middle",t.globalAlpha=o.opacity||1;for(var O=0;O<xo.length;O++){var w=xo[O],R=w[0],S=w[1],k=o[R];l&&k===a[R]||(t[S]=Mn(t,S,k||w[2]))}_+=p/2;var A=o.textStrokeWidth,N=!l||A!==(l?a.textStrokeWidth:null),M=!l||N||o.textStroke!==a.textStroke,K=Ko(o.textStroke,A),P=Po(o.textFill);if(K&&(N&&(t.lineWidth=A),M&&(t.strokeStyle=K)),P&&(l&&o.textFill===a.textFill||(t.fillStyle=P)),1===m.length)K&&t.strokeText(m[0],E,_),P&&t.fillText(m[0],E,_);else for(O=0;O<m.length;O++)K&&t.strokeText(m[O],E,_),P&&t.fillText(m[O],E,_),_+=p}(e,t,n,o,i,r)}function wo(e,t,n,o,i){if(n&&t.textRotation){var r=t.textOrigin;"center"===r?(o=n.width/2+n.x,i=n.height/2+n.y):r&&(o=r[0]+n.x,i=r[1]+n.y),e.translate(o,i),e.rotate(-t.textRotation),e.translate(-o,-i)}}function Ro(e,t,n,o,i,r,a,s){var l=o.rich[n.styleName]||{};l.text=n.text;var u=n.textVerticalAlign,c=r+i/2;"top"===u?c=r+n.height/2:"bottom"===u&&(c=r+i-n.height/2),!n.isLineHolder&&So(l)&&ko(e,t,l,"right"===s?a-n.width:"center"===s?a-n.width/2:a,c-n.height/2,n.width,n.height);var d=n.textPadding;d&&(a=Bo(a,s,d),c-=n.height/2-d[2]-n.textHeight/2),Mo(t,"shadowBlur",$(l.textShadowBlur,o.textShadowBlur,0)),Mo(t,"shadowColor",l.textShadowColor||o.textShadowColor||"transparent"),Mo(t,"shadowOffsetX",$(l.textShadowOffsetX,o.textShadowOffsetX,0)),Mo(t,"shadowOffsetY",$(l.textShadowOffsetY,o.textShadowOffsetY,0)),Mo(t,"textAlign",s),Mo(t,"textBaseline","middle"),Mo(t,"font",n.font||bo);var f=Ko(l.textStroke||o.textStroke,g),h=Po(l.textFill||o.textFill),g=W(l.textStrokeWidth,o.textStrokeWidth);f&&(Mo(t,"lineWidth",g),Mo(t,"strokeStyle",f),t.strokeText(n.text,a,c)),h&&(Mo(t,"fillStyle",h),t.fillText(n.text,a,c))}function So(e){return!!(e.textBackgroundColor||e.textBorderWidth&&e.textBorderColor)}function ko(e,t,n,o,i,r,a){var s=n.textBackgroundColor,l=n.textBorderWidth,u=n.textBorderColor,c=P(s);if(Mo(t,"shadowBlur",n.textBoxShadowBlur||0),Mo(t,"shadowColor",n.textBoxShadowColor||"transparent"),Mo(t,"shadowOffsetX",n.textBoxShadowOffsetX||0),Mo(t,"shadowOffsetY",n.textBoxShadowOffsetY||0),c||l&&u){t.beginPath();var d=n.textBorderRadius;d?yo(t,{x:o,y:i,width:r,height:a,r:d}):t.rect(o,i,r,a),t.closePath()}if(c)if(Mo(t,"fillStyle",s),null!=n.fillOpacity){var f=t.globalAlpha;t.globalAlpha=n.fillOpacity*n.opacity,t.fill(),t.globalAlpha=f}else t.fill();else if(L(s)){var h=s.image;(h=Xn(h,null,e,Ao,s))&&Zn(h)&&t.drawImage(h,o,i,r,a)}l&&u&&(Mo(t,"lineWidth",l),Mo(t,"strokeStyle",u),null!=n.strokeOpacity?(f=t.globalAlpha,t.globalAlpha=n.strokeOpacity*n.opacity,t.stroke(),t.globalAlpha=f):t.stroke())}function Ao(e,t){t.image=e}function No(e,t,n,o){var i=n.x||0,r=n.y||0,a=n.textAlign,s=n.textVerticalAlign;if(o){var l=n.textPosition;if(l instanceof Array)i=o.x+Lo(l[0],o.width),r=o.y+Lo(l[1],o.height);else{var u=t&&t.calculateTextPosition?t.calculateTextPosition(Eo,n,o):so(Eo,n,o);i=u.x,r=u.y,a=a||u.textAlign,s=s||u.textVerticalAlign}var c=n.textOffset;c&&(i+=c[0],r+=c[1])}return(e=e||{}).baseX=i,e.baseY=r,e.textAlign=a,e.textVerticalAlign=s,e}function Mo(e,t,n){return e[t]=Mn(e,t,n),e[t]}function Ko(e,t){return null==e||t<=0||"transparent"===e||"none"===e?null:e.image||e.colorStops?"#000":e}function Po(e){return null==e||"none"===e?null:e.image||e.colorStops?"#000":e}function Lo(e,t){return"string"==typeof e?0<=e.lastIndexOf("%")?parseFloat(e)/100*t:parseFloat(e):e}function Bo(e,t,n){return"right"===t?e-n[1]:"center"===t?e+n[3]/2-n[1]/2:e+n[3]}function Fo(e,t){return null!=e&&(e||t.textBackgroundColor||t.textBorderWidth&&t.textBorderColor||t.textPadding)}function zo(){}var Vo=new En;function Ho(e){for(var t in mn.call(this,e=e||{}),e)e.hasOwnProperty(t)&&"style"!==t&&(this[t]=e[t]);this.style=new Pn(e.style,this),this._rect=null,this.__clipPaths=null}function Wo(e){Ho.call(this,e)}Ho.prototype={constructor:Ho,type:"displayable",__dirty:!0,invisible:!(zo.prototype={constructor:zo,drawRectText:function(e,t){var n=this.style;t=n.textRect||t,this.__dirty&&Io(n);var o=n.text;if(null!=o&&(o+=""),Fo(o,n)){e.save();var i=this.transform;n.transformText?this.setTransform(e):i&&(Vo.copy(t),Vo.applyTransform(i),t=Vo),Oo(this,e,o,n,t,9),e.restore()}}}),z:0,z2:0,zlevel:0,draggable:!1,dragging:!1,silent:!1,culling:!1,cursor:"pointer",rectHover:!1,progressive:!1,incremental:!1,globalScaleRatio:1,beforeBrush:function(e){},afterBrush:function(e){},brush:function(e,t){},getBoundingRect:function(){},contain:function(e,t){return this.rectContain(e,t)},traverse:function(e,t){e.call(t,this)},rectContain:function(e,t){var n=this.transformCoordToLocal(e,t);return this.getBoundingRect().contain(n[0],n[1])},dirty:function(){this.__dirty=this.__dirtyText=!0,this._rect=null,this.__zr&&this.__zr.refresh()},animateStyle:function(e){return this.animate("style",e)},attrKV:function(e,t){"style"!==e?mn.prototype.attrKV.call(this,e,t):this.style.set(t)},setStyle:function(e,t){return this.style.set(e,t),this.dirty(!1),this},useStyle:function(e){return this.style=new Pn(e,this),this.dirty(!1),this},calculateTextPosition:null},_(Ho,mn),I(Ho,zo),Wo.prototype={constructor:Wo,type:"image",brush:function(e,t){var n=this.style,o=n.image;n.bind(e,this,t);var i=this._image=Xn(o,this._image,this,this.onload);if(i&&Zn(i)){var r=n.x||0,a=n.y||0,s=n.width,l=n.height,u=i.width/i.height;if(null==s&&null!=l?s=l*u:null==l&&null!=s?l=s/u:null==s&&null==l&&(s=i.width,l=i.height),this.setTransform(e),n.sWidth&&n.sHeight){var c=n.sx||0,d=n.sy||0;e.drawImage(i,c,d,n.sWidth,n.sHeight,r,a,s,l)}else if(n.sx&&n.sy){var f=s-(c=n.sx),h=l-(d=n.sy);e.drawImage(i,c,d,f,h,r,a,s,l)}else e.drawImage(i,r,a,s,l);null!=n.text&&(this.restoreTransform(e),this.drawRectText(e,this.getBoundingRect()))}},getBoundingRect:function(){var e=this.style;return this._rect||(this._rect=new En(e.x||0,e.y||0,e.width||0,e.height||0)),this._rect}},_(Wo,Ho);var $o=314159;function Uo(e){return parseInt(e,10)}var qo=new En(0,0,0,0),jo=new En(0,0,0,0);function Go(e,t,n){this.type="canvas";var o=!e.nodeName||"CANVAS"===e.nodeName.toUpperCase();this._opts=n=b({},n||{}),this.dpr=n.devicePixelRatio||dn,this._singleCanvas=o;var i=(this.root=e).style;i&&(i["-webkit-tap-highlight-color"]="transparent",i["-webkit-user-select"]=i["user-select"]=i["-webkit-touch-callout"]="none",e.innerHTML=""),this.storage=t;var r=this._zlevelList=[],a=this._layers={};if(this._layerConfig={},this._needsManuallyCompositing=!1,o){var s=e.width,l=e.height;null!=n.width&&(s=n.width),null!=n.height&&(l=n.height),this.dpr=n.devicePixelRatio||1,e.width=s*this.dpr,e.height=l*this.dpr,this._width=s,this._height=l;var u=new Un(e,this,this.dpr);u.__builtin__=!0,u.initContext(),(a[$o]=u).zlevel=$o,r.push($o),this._domRoot=e}else{this._width=this._getSize(0),this._height=this._getSize(1);var c=this._domRoot=function(e,t){var n=document.createElement("div");return n.style.cssText=["position:relative","width:"+e+"px","height:"+t+"px","padding:0","margin:0","border-width:0"].join(";")+";",n}(this._width,this._height);e.appendChild(c)}this._hoverlayer=null,this._hoverElements=[]}function Xo(e){this.stage=(e=e||{}).stage||{},this.onframe=e.onframe||function(){},this._clips=[],this._running=!1,this._paused=!1,Oe.call(this)}Go.prototype={constructor:Go,getType:function(){return"canvas"},isSingleCanvas:function(){return this._singleCanvas},getViewportRoot:function(){return this._domRoot},getViewportRootOffset:function(){var e=this.getViewportRoot();if(e)return{offsetLeft:e.offsetLeft||0,offsetTop:e.offsetTop||0}},refresh:function(e){var t=this.storage.getDisplayList(!0),n=this._zlevelList;this._redrawId=Math.random(),this._paintList(t,e,this._redrawId);for(var o=0;o<n.length;o++){var i=this._layers[n[o]];!i.__builtin__&&i.refresh&&i.refresh(0===o?this._backgroundColor:null)}return this.refreshHover(),this},addHover:function(e,t){if(!e.__hoverMir){var n=new e.constructor({style:e.style,shape:e.shape,z:e.z,z2:e.z2,silent:e.silent});return(n.__from=e).__hoverMir=n,t&&n.setStyle(t),this._hoverElements.push(n),n}},removeHover:function(e){var t=this._hoverElements,n=E(t,e.__hoverMir);0<=n&&t.splice(n,1),e.__hoverMir=null},clearHover:function(e){for(var t=this._hoverElements,n=0;n<t.length;n++){var o=t[n].__from;o&&(o.__hoverMir=null)}t.length=0},refreshHover:function(){var e=this._hoverElements,t=e.length,n=this._hoverlayer;if(n&&n.clear(),t){Sn(e,this.storage.displayableSortFunc);var o={};(n=n||(this._hoverlayer=this.getLayer(1e5))).ctx.save();for(var i=0;i<t;){var r=e[i],a=r.__from;a&&a.__zr?(i++,a.invisible||(r.transform=a.transform,r.invTransform=a.invTransform,r.__clipPaths=a.__clipPaths,this._doPaintEl(r,n,!0,o))):(e.splice(i,1),a.__hoverMir=null,t--)}n.ctx.restore()}},getHoverLayer:function(){return this.getLayer(1e5)},_paintList:function(e,t,n){if(this._redrawId===n){t=t||!1,this._updateLayerStatus(e);var o=this._doPaintList(e,t);if(this._needsManuallyCompositing&&this._compositeManually(),!o){var i=this;qn((function(){i._paintList(e,t,n)}))}}},_compositeManually:function(){var e=this.getLayer($o).ctx,t=this._domRoot.width,n=this._domRoot.height;e.clearRect(0,0,t,n),this.eachBuiltinLayer((function(o){o.virtual&&e.drawImage(o.dom,0,0,t,n)}))},_doPaintList:function(e,t){for(var n=[],o=0;o<this._zlevelList.length;o++)(s=this._layers[this._zlevelList[o]]).__builtin__&&s!==this._hoverlayer&&(s.__dirty||t)&&n.push(s);for(var r=!0,a=0;a<n.length;a++){var s,l=(s=n[a]).ctx,u={};l.save();var c=t?s.__startIndex:s.__drawIndex,d=!t&&s.incremental&&Date.now,f=d&&Date.now(),h=s.zlevel===this._zlevelList[0]?this._backgroundColor:null;if(s.__startIndex===s.__endIndex)s.clear(!1,h);else if(c===s.__startIndex){var g=e[c];g.incremental&&g.notClear&&!t||s.clear(!1,h)}-1===c&&(console.error("For some unknown reason. drawIndex is -1"),c=s.__startIndex);for(var m=c;m<s.__endIndex;m++){var p=e[m];if(this._doPaintEl(p,s,t,u),p.__dirty=p.__dirtyText=!1,d&&15<Date.now()-f)break}s.__drawIndex=m,s.__drawIndex<s.__endIndex&&(r=!1),u.prevElClipPaths&&l.restore(),l.restore()}return i.wxa&&O(this._layers,(function(e){e&&e.ctx&&e.ctx.draw&&e.ctx.draw()})),r},_doPaintEl:function(e,t,n,o){var i=t.ctx,r=e.transform;if((t.__dirty||n)&&!e.invisible&&0!==e.style.opacity&&(!r||r[0]||r[3])&&(!e.culling||!function(e,t,n){return qo.copy(e.getBoundingRect()),e.transform&&qo.applyTransform(e.transform),jo.width=t,jo.height=n,!qo.intersect(jo)}(e,this._width,this._height))){var a=e.__clipPaths,s=o.prevElClipPaths;s&&!function(e,t){if(e===t)return!1;if(!e||!t||e.length!==t.length)return!0;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!0;return!1}(a,s)||(s&&(i.restore(),o.prevElClipPaths=null,o.prevEl=null),a&&(i.save(),function(e,t){for(var n=0;n<e.length;n++){var o=e[n];o.setTransform(t),t.beginPath(),o.buildPath(t,o.shape),t.clip(),o.restoreTransform(t)}}(a,i),o.prevElClipPaths=a)),e.beforeBrush&&e.beforeBrush(i),e.brush(i,o.prevEl||null),(o.prevEl=e).afterBrush&&e.afterBrush(i)}},getLayer:function(e,t){this._singleCanvas&&!this._needsManuallyCompositing&&(e=$o);var n=this._layers[e];return n||((n=new Un("zr_"+e,this,this.dpr)).zlevel=e,n.__builtin__=!0,this._layerConfig[e]?v(n,this._layerConfig[e],!0):this._layerConfig[e-.01]&&v(n,this._layerConfig[e-.01],!0),t&&(n.virtual=t),this.insertLayer(e,n),n.initContext()),n},insertLayer:function(e,t){var n=this._layers,o=this._zlevelList,i=o.length,r=null,a=-1,s=this._domRoot;if(n[e]);else if(function(e){return!!e&&(!!e.__builtin__||"function"==typeof e.resize&&"function"==typeof e.refresh)}(t)){if(0<i&&e>o[0]){for(a=0;a<i-1&&!(o[a]<e&&o[a+1]>e);a++);r=n[o[a]]}if(o.splice(a+1,0,e),!(n[e]=t).virtual)if(r){var l=r.dom;l.nextSibling?s.insertBefore(t.dom,l.nextSibling):s.appendChild(t.dom)}else s.firstChild?s.insertBefore(t.dom,s.firstChild):s.appendChild(t.dom)}},eachLayer:function(e,t){var n,o,i=this._zlevelList;for(o=0;o<i.length;o++)e.call(t,this._layers[n=i[o]],n)},eachBuiltinLayer:function(e,t){var n,o,i,r=this._zlevelList;for(i=0;i<r.length;i++)(n=this._layers[o=r[i]]).__builtin__&&e.call(t,n,o)},eachOtherLayer:function(e,t){var n,o,i,r=this._zlevelList;for(i=0;i<r.length;i++)(n=this._layers[o=r[i]]).__builtin__||e.call(t,n,o)},getLayers:function(){return this._layers},_updateLayerStatus:function(e){function t(e){i&&(i.__endIndex!==e&&(i.__dirty=!0),i.__endIndex=e)}if(this.eachBuiltinLayer((function(e,t){e.__dirty=e.__used=!1})),this._singleCanvas)for(var n=1;n<e.length;n++)if((a=e[n]).zlevel!==e[n-1].zlevel||a.incremental){this._needsManuallyCompositing=!0;break}var o,i=null,r=0;for(n=0;n<e.length;n++){var a,s,l=(a=e[n]).zlevel;o!==l&&(o=l,r=0),a.incremental?((s=this.getLayer(l+.001,this._needsManuallyCompositing)).incremental=!0,r=1):s=this.getLayer(l+(0<r?.01:0),this._needsManuallyCompositing),s!==i&&(s.__used=!0,s.__startIndex!==n&&(s.__dirty=!0),s.__startIndex=n,s.__drawIndex=s.incremental?-1:n,t(n),i=s),a.__dirty&&(s.__dirty=!0,s.incremental&&s.__drawIndex<0&&(s.__drawIndex=n))}t(n),this.eachBuiltinLayer((function(e,t){!e.__used&&0<e.getElementCount()&&(e.__dirty=!0,e.__startIndex=e.__endIndex=e.__drawIndex=0),e.__dirty&&e.__drawIndex<0&&(e.__drawIndex=e.__startIndex)}))},clear:function(){return this.eachBuiltinLayer(this._clearLayer),this},_clearLayer:function(e){e.clear()},setBackgroundColor:function(e){this._backgroundColor=e},configLayer:function(e,t){if(t){var n=this._layerConfig;n[e]?v(n[e],t,!0):n[e]=t;for(var o=0;o<this._zlevelList.length;o++){var i=this._zlevelList[o];i!==e&&i!==e+.01||v(this._layers[i],n[e],!0)}}},delLayer:function(e){var t=this._layers,n=this._zlevelList,o=t[e];o&&(o.dom.parentNode.removeChild(o.dom),delete t[e],n.splice(E(n,e),1))},resize:function(e,t){if(this._domRoot.style){var n=this._domRoot;n.style.display="none";var o=this._opts;if(null!=e&&(o.width=e),null!=t&&(o.height=t),e=this._getSize(0),t=this._getSize(1),n.style.display="",this._width!==e||t!==this._height){for(var i in n.style.width=e+"px",n.style.height=t+"px",this._layers)this._layers.hasOwnProperty(i)&&this._layers[i].resize(e,t);O(this._progressiveLayers,(function(n){n.resize(e,t)})),this.refresh(!0)}this._width=e,this._height=t}else{if(null==e||null==t)return;this._width=e,this._height=t,this.getLayer($o).resize(e,t)}return this},clearLayer:function(e){var t=this._layers[e];t&&t.clear()},dispose:function(){this.root.innerHTML="",this.root=this.storage=this._domRoot=this._layers=null},getRenderedCanvas:function(e){if(this._singleCanvas&&!this._compositeManually)return this._layers[$o].dom;var t=new Un("image",this,(e=e||{}).pixelRatio||this.dpr);if(t.initContext(),t.clear(!1,e.backgroundColor||this._backgroundColor),e.pixelRatio<=this.dpr){this.refresh();var n=t.dom.width,o=t.dom.height,i=t.ctx;this.eachLayer((function(e){e.__builtin__?i.drawImage(e.dom,0,0,n,o):e.renderToCanvas&&(t.ctx.save(),e.renderToCanvas(t.ctx),t.ctx.restore())}))}else for(var r={},a=this.storage.getDisplayList(!0),s=0;s<a.length;s++)this._doPaintEl(a[s],t,!0,r);return t.dom},getWidth:function(){return this._width},getHeight:function(){return this._height},_getSize:function(e){var t=this._opts,n=["width","height"][e],o=["clientWidth","clientHeight"][e],i=["paddingLeft","paddingTop"][e],r=["paddingRight","paddingBottom"][e];if(null!=t[n]&&"auto"!==t[n])return parseFloat(t[n]);var a=this.root,s=document.defaultView.getComputedStyle(a);return(a[o]||Uo(s[n])||Uo(a.style[n]))-(Uo(s[i])||0)-(Uo(s[r])||0)|0},pathToImage:function(e,t){t=t||this.dpr;var n=document.createElement("canvas"),o=n.getContext("2d"),i=e.getBoundingRect(),r=e.style,a=r.shadowBlur*t,s=r.shadowOffsetX*t,l=r.shadowOffsetY*t,u=r.hasStroke()?r.lineWidth:0,c=Math.max(u/2,a-s),d=Math.max(u/2,s+a),f=Math.max(u/2,a-l),h=Math.max(u/2,l+a),g=i.width+c+d,m=i.height+f+h;n.width=g*t,n.height=m*t,o.scale(t,t),o.clearRect(0,0,g,m),o.dpr=t;var p={position:e.position,rotation:e.rotation,scale:e.scale};e.position=[c-i.x,f-i.y],e.rotation=0,e.scale=[1,1],e.updateTransform(),e&&e.brush(o);var v=new Wo({style:{x:0,y:0,image:n}});return null!=p.position&&(v.position=e.position=p.position),null!=p.rotation&&(v.rotation=e.rotation=p.rotation),null!=p.scale&&(v.scale=e.scale=p.scale),v}},Xo.prototype={constructor:Xo,addClip:function(e){this._clips.push(e)},addAnimator:function(e){e.animation=this;for(var t=e.getClips(),n=0;n<t.length;n++)this.addClip(t[n])},removeClip:function(e){var t=E(this._clips,e);0<=t&&this._clips.splice(t,1)},removeAnimator:function(e){for(var t=e.getClips(),n=0;n<t.length;n++)this.removeClip(t[n]);e.animation=null},_update:function(){for(var e=(new Date).getTime()-this._pausedTime,t=e-this._time,n=this._clips,o=n.length,i=[],r=[],a=0;a<o;a++){var s=n[a],l=s.step(e,t);l&&(i.push(l),r.push(s))}for(a=0;a<o;)n[a]._needsRemove?(n[a]=n[o-1],n.pop(),o--):a++;for(o=i.length,a=0;a<o;a++)r[a].fire(i[a]);this._time=e,this.onframe(t),this.trigger("frame",t),this.stage.update&&this.stage.update()},_startLoop:function(){var e=this;this._running=!0,qn((function t(){e._running&&(qn(t),e._paused||e._update())}))},start:function(){this._time=(new Date).getTime(),this._pausedTime=0,this._startLoop()},stop:function(){this._running=!1},pause:function(){this._paused||(this._pauseStart=(new Date).getTime(),this._paused=!0)},resume:function(){this._paused&&(this._pausedTime+=(new Date).getTime()-this._pauseStart,this._paused=!1)},clear:function(){this._clips=[]},isFinished:function(){return!this._clips.length},animate:function(e,t){var n=new un(e,(t=t||{}).loop,t.getter,t.setter);return this.addAnimator(n),n}},I(Xo,Oe);var Yo,Zo,Jo=i.domSupported,Qo=(Zo={pointerdown:1,pointerup:1,pointermove:1,pointerout:1},{mouse:Yo=["click","dblclick","mousewheel","mouseout","mouseup","mousedown","mousemove","contextmenu"],touch:["touchstart","touchend","touchmove"],pointer:w(Yo,(function(e){var t=e.replace("mouse","pointer");return Zo.hasOwnProperty(t)?t:e}))}),ei=["mousemove","mouseup"],ti=["pointermove","pointerup"];function ni(e){return"mousewheel"===e&&i.browser.firefox?"DOMMouseScroll":e}function oi(e){var t=e.pointerType;return"pen"===t||"touch"===t}function ii(e){e&&(e.zrByTouch=!0)}function ri(e,t){for(var n=t,o=!1;n&&9!==n.nodeType&&!(o=n.domBelongToZr||n!==t&&n===e.painterRoot);)n=n.parentNode;return o}function ai(e,t){this.type=t.type,this.target=this.currentTarget=e.dom,this.pointerType=t.pointerType,this.clientX=t.clientX,this.clientY=t.clientY}var si=ai.prototype;si.stopPropagation=si.stopImmediatePropagation=si.preventDefault=te;var li={mousedown:function(e){e=He(this.dom,e),this._mayPointerCapture=[e.zrX,e.zrY],this.trigger("mousedown",e)},mousemove:function(e){e=He(this.dom,e);var t=this._mayPointerCapture;!t||e.zrX===t[0]&&e.zrY===t[1]||fi(this,!0),this.trigger("mousemove",e)},mouseup:function(e){e=He(this.dom,e),fi(this,!1),this.trigger("mouseup",e)},mouseout:function(e){e=He(this.dom,e),this._pointerCapturing&&(e.zrEventControl="no_globalout"),e.zrIsToLocalDOM=ri(this,e.toElement||e.relatedTarget),this.trigger("mouseout",e)},touchstart:function(e){ii(e=He(this.dom,e)),this._lastTouchMoment=new Date,this.handler.processGesture(e,"start"),li.mousemove.call(this,e),li.mousedown.call(this,e)},touchmove:function(e){ii(e=He(this.dom,e)),this.handler.processGesture(e,"change"),li.mousemove.call(this,e)},touchend:function(e){ii(e=He(this.dom,e)),this.handler.processGesture(e,"end"),li.mouseup.call(this,e),+new Date-this._lastTouchMoment<300&&li.click.call(this,e)},pointerdown:function(e){li.mousedown.call(this,e)},pointermove:function(e){oi(e)||li.mousemove.call(this,e)},pointerup:function(e){li.mouseup.call(this,e)},pointerout:function(e){oi(e)||li.mouseout.call(this,e)}};O(["click","mousewheel","dblclick","contextmenu"],(function(e){li[e]=function(t){t=He(this.dom,t),this.trigger(e,t)}}));var ui={pointermove:function(e){oi(e)||ui.mousemove.call(this,e)},pointerup:function(e){ui.mouseup.call(this,e)},mousemove:function(e){this.trigger("mousemove",e)},mouseup:function(e){var t=this._pointerCapturing;fi(this,!1),this.trigger("mouseup",e),t&&(e.zrEventControl="only_globalout",this.trigger("mouseout",e))}};function ci(e,t,n,o){e.mounted[t]=n,e.listenerOpts[t]=o,We(e.domTarget,ni(t),n,o)}function di(e){var t,n,o,i=e.mounted;for(var r in i)i.hasOwnProperty(r)&&(t=e.domTarget,n=ni(r),o=i[r],Pe?t.removeEventListener(n,o,e.listenerOpts[r]):t.detachEvent("on"+n,o));e.mounted={}}function fi(e,t){if(e._mayPointerCapture=null,Jo&&e._pointerCapturing^t){e._pointerCapturing=t;var n=e._globalHandlerScope;t?function(e,t){function n(n){ci(t,n,(function(o){o=Ve(o),ri(e,o.target)||(o=function(e,t){return He(e.dom,new ai(e,t),!0)}(e,o),t.domHandlers[n].call(e,o))}),{capture:!0})}i.pointerEventsSupported?O(ti,n):i.touchEventsSupported||O(ei,n)}(e,n):di(n)}}function hi(e,t){this.domTarget=e,this.domHandlers=t,this.mounted={},this.listenerOpts={},this.touchTimer=null,this.touching=!1}function gi(e,t){Oe.call(this),this.dom=e,this.painterRoot=t,this._localHandlerScope=new hi(e,li),Jo&&(this._globalHandlerScope=new hi(document,ui)),this._pointerCapturing=!1,this._mayPointerCapture=null,function(e,t){var n=t.domHandlers;i.pointerEventsSupported?O(Qo.pointer,(function(o){ci(t,o,(function(t){n[o].call(e,t)}))})):(i.touchEventsSupported&&O(Qo.touch,(function(o){ci(t,o,(function(i){n[o].call(e,i),function(e){e.touching=!0,null!=e.touchTimer&&(clearTimeout(e.touchTimer),e.touchTimer=null),e.touchTimer=setTimeout((function(){e.touching=!1,e.touchTimer=null}),700)}(t)}))})),O(Qo.mouse,(function(o){ci(t,o,(function(i){i=Ve(i),t.touching||n[o].call(e,i)}))})))}(this,this._localHandlerScope)}var mi=gi.prototype;mi.dispose=function(){di(this._localHandlerScope),Jo&&di(this._globalHandlerScope)},mi.setCursor=function(e){this.dom.style&&(this.dom.style.cursor=e||"default")},I(gi,Oe);var pi=!i.canvasSupported,vi={canvas:Go},yi={};function bi(e,t){var n=new Ti(o(),e,t);return yi[n.id]=n}function Ci(e,t){vi[e]=t}var Ti=function(e,t,n){n=n||{},this.dom=t,this.id=e;var o=this,r=new An,a=n.renderer;if(pi){if(!vi.vml)throw new Error("You need to require 'zrender/vml/vml' to support IE8");a="vml"}else a&&vi[a]||(a="canvas");var s=new vi[a](t,r,n,e);this.storage=r,this.painter=s;var l=i.node||i.worker?null:new gi(s.getViewportRoot(),s.root);this.handler=new Je(r,s,l,s.root),this.animation=new Xo({stage:{update:A(this.flush,this)}}),this.animation.start();var u=r.delFromStorage,c=r.addToStorage;r.delFromStorage=function(e){u.call(r,e),e&&e.removeSelfFromZr(o)},r.addToStorage=function(e){c.call(r,e),e.addSelfToZr(o)}};Ti.prototype={constructor:Ti,getId:function(){return this.id},add:function(e){this.storage.addRoot(e),this._needsRefresh=!0},remove:function(e){this.storage.delRoot(e),this._needsRefresh=!0},configLayer:function(e,t){this.painter.configLayer&&this.painter.configLayer(e,t),this._needsRefresh=!0},setBackgroundColor:function(e){this.painter.setBackgroundColor&&this.painter.setBackgroundColor(e),this._needsRefresh=!0},refreshImmediately:function(){this._needsRefresh=this._needsRefreshHover=!1,this.painter.refresh(),this._needsRefresh=this._needsRefreshHover=!1},refresh:function(){this._needsRefresh=!0},flush:function(){var e;this._needsRefresh&&(e=!0,this.refreshImmediately()),this._needsRefreshHover&&(e=!0,this.refreshHoverImmediately()),e&&this.trigger("rendered")},addHover:function(e,t){if(this.painter.addHover){var n=this.painter.addHover(e,t);return this.refreshHover(),n}},removeHover:function(e){this.painter.removeHover&&(this.painter.removeHover(e),this.refreshHover())},clearHover:function(){this.painter.clearHover&&(this.painter.clearHover(),this.refreshHover())},refreshHover:function(){this._needsRefreshHover=!0},refreshHoverImmediately:function(){this._needsRefreshHover=!1,this.painter.refreshHover&&this.painter.refreshHover()},resize:function(e){this.painter.resize((e=e||{}).width,e.height),this.handler.resize()},clearAnimation:function(){this.animation.clear()},getWidth:function(){return this.painter.getWidth()},getHeight:function(){return this.painter.getHeight()},pathToImage:function(e,t){return this.painter.pathToImage(e,t)},setCursorStyle:function(e){this.handler.setCursorStyle(e)},findHover:function(e,t){return this.handler.findHover(e,t)},on:function(e,t,n){this.handler.on(e,t,n)},off:function(e,t){this.handler.off(e,t)},trigger:function(e,t){this.handler.trigger(e,t)},clear:function(){this.storage.delRoot(),this.painter.clear()},dispose:function(){this.animation.stop(),this.clear(),this.storage.dispose(),this.painter.dispose(),this.handler.dispose(),this.animation=this.storage=this.painter=this.handler=null,function(e){delete yi[e]}(this.id)}};var xi=(Object.freeze||Object)({version:"4.3.2",init:bi,dispose:function(e){if(e)e.dispose();else{for(var t in yi)yi.hasOwnProperty(t)&&yi[t].dispose();yi={}}return this},getInstance:function(e){return yi[e]},registerPainter:Ci}),Ei=O,_i=L,Ii=M,Di="series\0";function Oi(e){return e instanceof Array?e:null==e?[]:[e]}function wi(e,t,n){if(e){e[t]=e[t]||{},e.emphasis=e.emphasis||{},e.emphasis[t]=e.emphasis[t]||{};for(var o=0,i=n.length;o<i;o++){var r=n[o];!e.emphasis[t].hasOwnProperty(r)&&e[t].hasOwnProperty(r)&&(e.emphasis[t][r]=e[t][r])}}}var Ri=["fontStyle","fontWeight","fontSize","fontFamily","rich","tag","color","textBorderColor","textBorderWidth","width","height","lineHeight","align","verticalAlign","baseline","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","textShadowColor","textShadowBlur","textShadowOffsetX","textShadowOffsetY","backgroundColor","borderColor","borderWidth","borderRadius","padding"];function Si(e){return!_i(e)||Ii(e)||e instanceof Date?e:e.value}function ki(e,t){t=(t||[]).slice();var n=w(e||[],(function(e,t){return{exist:e}}));return Ei(t,(function(e,o){if(_i(e)){for(var i=0;i<n.length;i++)if(!n[i].option&&null!=e.id&&n[i].exist.id===e.id+"")return n[i].option=e,void(t[o]=null);for(i=0;i<n.length;i++){var r=n[i].exist;if(!(n[i].option||null!=r.id&&null!=e.id||null==e.name||Mi(e)||Mi(r)||r.name!==e.name+""))return n[i].option=e,void(t[o]=null)}}})),Ei(t,(function(e,t){if(_i(e)){for(var o=0;o<n.length;o++)if(!n[o].option&&!Mi(n[o].exist)&&null==e.id){n[o].option=e;break}o>=n.length&&n.push({option:e})}})),n}function Ai(e){var t=Q();Ei(e,(function(e,n){var o=e.exist;o&&t.set(o.id,e)})),Ei(e,(function(e,n){var o=e.option;j(!o||null==o.id||!t.get(o.id)||t.get(o.id)===e,"id duplicates: "+(o&&o.id)),o&&null!=o.id&&t.set(o.id,e),e.keyInfo||(e.keyInfo={})})),Ei(e,(function(e,n){var o=e.exist,i=e.option,r=e.keyInfo;if(_i(i)){if(r.name=null!=i.name?i.name+"":o?o.name:Di+n,o)r.id=o.id;else if(null!=i.id)r.id=i.id+"";else for(var a=0;r.id="\0"+r.name+"\0"+a++,t.get(r.id););t.set(r.id,e)}}))}function Ni(e){var t=e.name;return!(!t||!t.indexOf(Di))}function Mi(e){return _i(e)&&e.id&&0===(e.id+"").indexOf("\0_ec_\0")}function Ki(e,t){return null!=t.dataIndexInside?t.dataIndexInside:null!=t.dataIndex?M(t.dataIndex)?w(t.dataIndex,(function(t){return e.indexOfRawIndex(t)})):e.indexOfRawIndex(t.dataIndex):null!=t.name?M(t.name)?w(t.name,(function(t){return e.indexOfName(t)})):e.indexOfName(t.name):void 0}function Pi(){var e="__\0ec_inner_"+Li+++"_"+Math.random().toFixed(5);return function(t){return t[e]||(t[e]={})}}var Li=0;function Bi(e,t,n){if(P(t)){var o={};o[t+"Index"]=0,t=o}var i=n&&n.defaultMainType;!i||Fi(t,i+"Index")||Fi(t,i+"Id")||Fi(t,i+"Name")||(t[i+"Index"]=0);var r={};return Ei(t,(function(o,i){if(o=t[i],"dataIndex"!==i&&"dataIndexInside"!==i){var a=i.match(/^(\w+)(Index|Id|Name)$/)||[],s=a[1],l=(a[2]||"").toLowerCase();if(!(!s||!l||null==o||"index"===l&&"none"===o||n&&n.includeMainTypes&&E(n.includeMainTypes,s)<0)){var u={mainType:s};"index"===l&&"all"===o||(u[l]=o);var c=e.queryComponents(u);r[s+"Models"]=c,r[s+"Model"]=c[0]}}else r[i]=o})),r}function Fi(e,t){return e&&e.hasOwnProperty(t)}function zi(e,t,n){e.setAttribute?e.setAttribute(t,n):e[t]=n}function Vi(e){return"auto"===e?i.domSupported?"html":"richText":e||"html"}function Hi(e,t){var n=Q(),o=[];return O(e,(function(e){var i=t(e);(n.get(i)||(o.push(i),n.set(i,[]))).push(e)})),{keys:o,buckets:n}}var Wi="___EC__COMPONENT__CONTAINER___";function $i(e){var t={main:"",sub:""};return e&&(e=e.split("."),t.main=e[0]||"",t.sub=e[1]||""),t}function Ui(e){(e.$constructor=e).extend=function(e){function t(){e.$constructor?e.$constructor.apply(this,arguments):n.apply(this,arguments)}var n=this;return b(t.prototype,e),t.extend=this.extend,t.superCall=Gi,t.superApply=Xi,_(t,this),t.superClass=n,t}}var qi=0;function ji(e){var t=["__\0is_clz",qi++,Math.random().toFixed(3)].join("_");e.prototype[t]=!0,e.isInstance=function(e){return!(!e||!e[t])}}function Gi(e,t){var n=U(arguments,2);return this.superClass.prototype[t].apply(e,n)}function Xi(e,t,n){return this.superClass.prototype[t].apply(e,n)}function Yi(e,t){t=t||{};var n={};if(e.registerClass=function(e,t){return t&&(function(e){j(/^[a-zA-Z0-9_]+([.][a-zA-Z0-9_]+)?$/.test(e),'componentType "'+e+'" illegal')}(t),(t=$i(t)).sub?t.sub!==Wi&&((function(e){var t=n[e.main];return t&&t[Wi]||((t=n[e.main]={})[Wi]=!0),t}(t))[t.sub]=e):n[t.main]=e),e},e.getClass=function(e,t,o){var i=n[e];if(i&&i[Wi]&&(i=t?i[t]:null),o&&!i)throw new Error(t?"Component "+e+"."+(t||"")+" not exists. Load it first.":e+".type should be specified.");return i},e.getClassesByMainType=function(e){e=$i(e);var t=[],o=n[e.main];return o&&o[Wi]?O(o,(function(e,n){n!==Wi&&t.push(e)})):t.push(o),t},e.hasClass=function(e){return e=$i(e),!!n[e.main]},e.getAllClassMainTypes=function(){var e=[];return O(n,(function(t,n){e.push(n)})),e},e.hasSubTypes=function(e){e=$i(e);var t=n[e.main];return t&&t[Wi]},e.parseClassType=$i,t.registerWhenExtend){var o=e.extend;o&&(e.extend=function(t){var n=o.call(this,t);return e.registerClass(n,t.type)})}return e}function Zi(e){for(var t=0;t<e.length;t++)e[t][1]||(e[t][1]=e[t][0]);return function(t,n,o){for(var i={},r=0;r<e.length;r++){var a=e[r][1];if(!(n&&0<=E(n,a)||o&&E(o,a)<0)){var s=t.getShallow(a);null!=s&&(i[e[r][0]]=s)}}return i}}var Ji=Zi([["lineWidth","width"],["stroke","color"],["opacity"],["shadowBlur"],["shadowOffsetX"],["shadowOffsetY"],["shadowColor"]]),Qi={getLineStyle:function(e){var t=Ji(this,e);return t.lineDash=this.getLineDash(t.lineWidth),t},getLineDash:function(e){null==e&&(e=1);var t=this.get("type"),n=Math.max(e,2),o=4*e;return"solid"!==t&&null!=t&&("dashed"===t?[o,o]:[n,n])}},er=Zi([["fill","color"],["shadowBlur"],["shadowOffsetX"],["shadowOffsetY"],["opacity"],["shadowColor"]]),tr={getAreaStyle:function(e,t){return er(this,e,t)}},nr=Math.pow,or=Math.sqrt,ir=1e-8,rr=1e-4,ar=or(3),sr=1/3,lr=ie(),ur=ie(),cr=ie();function dr(e){return-ir<e&&e<ir}function fr(e){return ir<e||e<-ir}function hr(e,t,n,o,i){var r=1-i;return r*r*(r*e+3*i*t)+i*i*(i*o+3*r*n)}function gr(e,t,n,o,i){var r=1-i;return 3*(((t-e)*r+2*(n-t)*i)*r+(o-n)*i*i)}function mr(e,t,n,o,i){var r=6*n-12*t+6*e,a=9*t+3*o-3*e-9*n,s=3*t-3*e,l=0;if(dr(a))fr(r)&&0<=(c=-s/r)&&c<=1&&(i[l++]=c);else{var u=r*r-4*a*s;if(dr(u))i[0]=-r/(2*a);else if(0<u){var c,d=or(u),f=(-r-d)/(2*a);0<=(c=(-r+d)/(2*a))&&c<=1&&(i[l++]=c),0<=f&&f<=1&&(i[l++]=f)}}return l}function pr(e,t,n,o,i,r){var a=(t-e)*i+e,s=(n-t)*i+t,l=(o-n)*i+n,u=(s-a)*i+a,c=(l-s)*i+s,d=(c-u)*i+u;r[0]=e,r[1]=a,r[2]=u,r[3]=d,r[4]=d,r[5]=c,r[6]=l,r[7]=o}function vr(e,t,n,o){var i=1-o;return i*(i*e+2*o*t)+o*o*n}function yr(e,t,n,o){return 2*((1-o)*(t-e)+o*(n-t))}function br(e,t,n){var o=e+n-2*t;return 0==o?.5:(e-t)/o}function Cr(e,t,n,o,i){var r=(t-e)*o+e,a=(n-t)*o+t,s=(a-r)*o+r;i[0]=e,i[1]=r,i[2]=s,i[3]=s,i[4]=a,i[5]=n}var Tr=Math.min,xr=Math.max,Er=Math.sin,_r=Math.cos,Ir=2*Math.PI,Dr=ie(),Or=ie(),wr=ie();function Rr(e,t,n){if(0!==e.length){var o,i=e[0],r=i[0],a=i[0],s=i[1],l=i[1];for(o=1;o<e.length;o++)r=Tr(r,(i=e[o])[0]),a=xr(a,i[0]),s=Tr(s,i[1]),l=xr(l,i[1]);t[0]=r,t[1]=s,n[0]=a,n[1]=l}}function Sr(e,t,n,o,i,r){i[0]=Tr(e,n),i[1]=Tr(t,o),r[0]=xr(e,n),r[1]=xr(t,o)}var kr=[],Ar=[];function Nr(e,t,n,o,i,r,a,s,l,u){var c,d=mr,f=hr,h=d(e,n,i,a,kr);for(l[0]=1/0,l[1]=1/0,u[0]=-1/0,u[1]=-1/0,c=0;c<h;c++){var g=f(e,n,i,a,kr[c]);l[0]=Tr(g,l[0]),u[0]=xr(g,u[0])}for(h=d(t,o,r,s,Ar),c=0;c<h;c++){var m=f(t,o,r,s,Ar[c]);l[1]=Tr(m,l[1]),u[1]=xr(m,u[1])}l[0]=Tr(e,l[0]),u[0]=xr(e,u[0]),l[0]=Tr(a,l[0]),u[0]=xr(a,u[0]),l[1]=Tr(t,l[1]),u[1]=xr(t,u[1]),l[1]=Tr(s,l[1]),u[1]=xr(s,u[1])}function Mr(e,t,n,o,i,r,a,s,l){var u=Te,c=xe,d=Math.abs(i-r);if(d%Ir<1e-4&&1e-4<d)return s[0]=e-n,s[1]=t-o,l[0]=e+n,void(l[1]=t+o);if(Dr[0]=_r(i)*n+e,Dr[1]=Er(i)*o+t,Or[0]=_r(r)*n+e,Or[1]=Er(r)*o+t,u(s,Dr,Or),c(l,Dr,Or),(i%=Ir)<0&&(i+=Ir),(r%=Ir)<0&&(r+=Ir),r<i&&!a?r+=Ir:i<r&&a&&(i+=Ir),a){var f=r;r=i,i=f}for(var h=0;h<r;h+=Math.PI/2)i<h&&(wr[0]=_r(h)*n+e,wr[1]=Er(h)*o+t,u(s,wr,s),c(l,wr,l))}var Kr={M:1,L:2,C:3,Q:4,A:5,Z:6,R:7},Pr=[],Lr=[],Br=[],Fr=[],zr=Math.min,Vr=Math.max,Hr=Math.cos,Wr=Math.sin,$r=Math.sqrt,Ur=Math.abs,qr="undefined"!=typeof Float32Array,jr=function(e){this._saveData=!e,this._saveData&&(this.data=[]),this._ctx=null};function Gr(e,t,n,o,i,r,a){if(0===i)return!1;var s,l=i;if(t+l<a&&o+l<a||a<t-l&&a<o-l||e+l<r&&n+l<r||r<e-l&&r<n-l)return!1;if(e===n)return Math.abs(r-e)<=l/2;var u=(s=(t-o)/(e-n))*r-a+(e*o-n*t)/(e-n);return u*u/(s*s+1)<=l/2*l/2}function Xr(e,t,n,o,i,r,a,s,l,u,c){if(0===l)return!1;var d=l;return!(t+d<c&&o+d<c&&r+d<c&&s+d<c||c<t-d&&c<o-d&&c<r-d&&c<s-d||e+d<u&&n+d<u&&i+d<u&&a+d<u||u<e-d&&u<n-d&&u<i-d&&u<a-d)&&function(e,t,n,o,i,r,a,s,l,u,c){var d,f,h,g,m,p=.005,v=1/0;lr[0]=l,lr[1]=u;for(var y=0;y<1;y+=.05)ur[0]=hr(e,n,i,a,y),ur[1]=hr(t,o,r,s,y),(g=ye(lr,ur))<v&&(d=y,v=g);v=1/0;for(var b=0;b<32&&!(p<rr);b++)h=d+p,ur[0]=hr(e,n,i,a,f=d-p),ur[1]=hr(t,o,r,s,f),g=ye(ur,lr),0<=f&&g<v?(d=f,v=g):(cr[0]=hr(e,n,i,a,h),cr[1]=hr(t,o,r,s,h),m=ye(cr,lr),h<=1&&m<v?(d=h,v=m):p*=.5);return or(v)}(e,t,n,o,i,r,a,s,u,c)<=d/2}function Yr(e,t,n,o,i,r,a,s,l){if(0===a)return!1;var u=a;return!(t+u<l&&o+u<l&&r+u<l||l<t-u&&l<o-u&&l<r-u||e+u<s&&n+u<s&&i+u<s||s<e-u&&s<n-u&&s<i-u)&&function(e,t,n,o,i,r,a,s,l){var u,c=.005,d=1/0;lr[0]=a,lr[1]=s;for(var f=0;f<1;f+=.05)ur[0]=vr(e,n,i,f),ur[1]=vr(t,o,r,f),(p=ye(lr,ur))<d&&(u=f,d=p);d=1/0;for(var h=0;h<32&&!(c<rr);h++){var g=u-c,m=u+c;ur[0]=vr(e,n,i,g),ur[1]=vr(t,o,r,g);var p=ye(ur,lr);if(0<=g&&p<d)u=g,d=p;else{cr[0]=vr(e,n,i,m),cr[1]=vr(t,o,r,m);var v=ye(cr,lr);m<=1&&v<d?(u=m,d=v):c*=.5}}return or(d)}(e,t,n,o,i,r,s,l)<=u/2}jr.prototype={constructor:jr,_xi:0,_yi:0,_x0:0,_y0:0,_ux:0,_uy:0,_len:0,_lineDash:null,_dashOffset:0,_dashIdx:0,_dashSum:0,setScale:function(e,t,n){this._ux=Ur((n=n||0)/dn/e)||0,this._uy=Ur(n/dn/t)||0},getContext:function(){return this._ctx},beginPath:function(e){return(this._ctx=e)&&e.beginPath(),e&&(this.dpr=e.dpr),this._saveData&&(this._len=0),this._lineDash&&(this._lineDash=null,this._dashOffset=0),this},moveTo:function(e,t){return this.addData(Kr.M,e,t),this._ctx&&this._ctx.moveTo(e,t),this._x0=e,this._y0=t,this._xi=e,this._yi=t,this},lineTo:function(e,t){var n=Ur(e-this._xi)>this._ux||Ur(t-this._yi)>this._uy||this._len<5;return this.addData(Kr.L,e,t),this._ctx&&n&&(this._needsDash()?this._dashedLineTo(e,t):this._ctx.lineTo(e,t)),n&&(this._xi=e,this._yi=t),this},bezierCurveTo:function(e,t,n,o,i,r){return this.addData(Kr.C,e,t,n,o,i,r),this._ctx&&(this._needsDash()?this._dashedBezierTo(e,t,n,o,i,r):this._ctx.bezierCurveTo(e,t,n,o,i,r)),this._xi=i,this._yi=r,this},quadraticCurveTo:function(e,t,n,o){return this.addData(Kr.Q,e,t,n,o),this._ctx&&(this._needsDash()?this._dashedQuadraticTo(e,t,n,o):this._ctx.quadraticCurveTo(e,t,n,o)),this._xi=n,this._yi=o,this},arc:function(e,t,n,o,i,r){return this.addData(Kr.A,e,t,n,n,o,i-o,0,r?0:1),this._ctx&&this._ctx.arc(e,t,n,o,i,r),this._xi=Hr(i)*n+e,this._yi=Wr(i)*n+t,this},arcTo:function(e,t,n,o,i){return this._ctx&&this._ctx.arcTo(e,t,n,o,i),this},rect:function(e,t,n,o){return this._ctx&&this._ctx.rect(e,t,n,o),this.addData(Kr.R,e,t,n,o),this},closePath:function(){this.addData(Kr.Z);var e=this._ctx,t=this._x0,n=this._y0;return e&&(this._needsDash()&&this._dashedLineTo(t,n),e.closePath()),this._xi=t,this._yi=n,this},fill:function(e){e&&e.fill(),this.toStatic()},stroke:function(e){e&&e.stroke(),this.toStatic()},setLineDash:function(e){if(e instanceof Array){this._lineDash=e;for(var t=this._dashIdx=0,n=0;n<e.length;n++)t+=e[n];this._dashSum=t}return this},setLineDashOffset:function(e){return this._dashOffset=e,this},len:function(){return this._len},setData:function(e){var t=e.length;this.data&&this.data.length===t||!qr||(this.data=new Float32Array(t));for(var n=0;n<t;n++)this.data[n]=e[n];this._len=t},appendPath:function(e){e instanceof Array||(e=[e]);for(var t=e.length,n=0,o=this._len,i=0;i<t;i++)n+=e[i].len();for(qr&&this.data instanceof Float32Array&&(this.data=new Float32Array(o+n)),i=0;i<t;i++)for(var r=e[i].data,a=0;a<r.length;a++)this.data[o++]=r[a];this._len=o},addData:function(e){if(this._saveData){var t=this.data;this._len+arguments.length>t.length&&(this._expandData(),t=this.data);for(var n=0;n<arguments.length;n++)t[this._len++]=arguments[n];this._prevCmd=e}},_expandData:function(){if(!(this.data instanceof Array)){for(var e=[],t=0;t<this._len;t++)e[t]=this.data[t];this.data=e}},_needsDash:function(){return this._lineDash},_dashedLineTo:function(e,t){var n,o,i=this._dashSum,r=this._dashOffset,a=this._lineDash,s=this._ctx,l=this._xi,u=this._yi,c=e-l,d=t-u,f=$r(c*c+d*d),h=l,g=u,m=a.length;for(r<0&&(r=i+r),h-=(r%=i)*(c/=f),g-=r*(d/=f);0<c&&h<=e||c<0&&e<=h||0===c&&(0<d&&g<=t||d<0&&t<=g);)h+=c*(n=a[o=this._dashIdx]),g+=d*n,this._dashIdx=(o+1)%m,0<c&&h<l||c<0&&l<h||0<d&&g<u||d<0&&u<g||s[o%2?"moveTo":"lineTo"](0<=c?zr(h,e):Vr(h,e),0<=d?zr(g,t):Vr(g,t));this._dashOffset=-$r((c=h-e)*c+(d=g-t)*d)},_dashedBezierTo:function(e,t,n,o,i,r){var a,s,l,u,c,d=this._dashSum,f=this._dashOffset,h=this._lineDash,g=this._ctx,m=this._xi,p=this._yi,v=hr,y=0,b=this._dashIdx,C=h.length,T=0;for(f<0&&(f=d+f),f%=d,a=0;a<1;a+=.1)s=v(m,e,n,i,a+.1)-v(m,e,n,i,a),l=v(p,t,o,r,a+.1)-v(p,t,o,r,a),y+=$r(s*s+l*l);for(;b<C&&!(f<(T+=h[b]));b++);for(a=(T-f)/y;a<=1;)u=v(m,e,n,i,a),c=v(p,t,o,r,a),b%2?g.moveTo(u,c):g.lineTo(u,c),a+=h[b]/y,b=(b+1)%C;b%2!=0&&g.lineTo(i,r),this._dashOffset=-$r((s=i-u)*s+(l=r-c)*l)},_dashedQuadraticTo:function(e,t,n,o){var i=n,r=o;n=(n+2*e)/3,o=(o+2*t)/3,this._dashedBezierTo(e=(this._xi+2*e)/3,t=(this._yi+2*t)/3,n,o,i,r)},toStatic:function(){var e=this.data;e instanceof Array&&(e.length=this._len,qr&&(this.data=new Float32Array(e)))},getBoundingRect:function(){Pr[0]=Pr[1]=Br[0]=Br[1]=Number.MAX_VALUE,Lr[0]=Lr[1]=Fr[0]=Fr[1]=-Number.MAX_VALUE;for(var e,t,n,o,i,r,a,s,l,u,c,d,f,h,g=this.data,m=0,p=0,v=0,y=0,b=0;b<g.length;){var C=g[b++];switch(1===b&&(v=m=g[b],y=p=g[b+1]),C){case Kr.M:m=v=g[b++],p=y=g[b++],Br[0]=v,Br[1]=y,Fr[0]=v,Fr[1]=y;break;case Kr.L:Sr(m,p,g[b],g[b+1],Br,Fr),m=g[b++],p=g[b++];break;case Kr.C:Nr(m,p,g[b++],g[b++],g[b++],g[b++],g[b],g[b+1],Br,Fr),m=g[b++],p=g[b++];break;case Kr.Q:t=p,n=g[b++],o=g[b++],r=g[b+1],a=Br,s=Fr,u=l=void 0,u=vr,c=xr(Tr((l=br)(e=m,n,i=g[b]),1),0),d=xr(Tr(l(t,o,r),1),0),f=u(e,n,i,c),h=u(t,o,r,d),a[0]=Tr(e,i,f),a[1]=Tr(t,r,h),s[0]=xr(e,i,f),s[1]=xr(t,r,h),m=g[b++],p=g[b++];break;case Kr.A:var T=g[b++],x=g[b++],E=g[b++],_=g[b++],I=g[b++],D=g[b++]+I;b+=1;var O=1-g[b++];1===b&&(v=Hr(I)*E+T,y=Wr(I)*_+x),Mr(T,x,E,_,I,D,O,Br,Fr),m=Hr(D)*E+T,p=Wr(D)*_+x;break;case Kr.R:Sr(v=m=g[b++],y=p=g[b++],v+g[b++],y+g[b++],Br,Fr);break;case Kr.Z:m=v,p=y}Te(Pr,Pr,Br),xe(Lr,Lr,Fr)}return 0===b&&(Pr[0]=Pr[1]=Lr[0]=Lr[1]=0),new En(Pr[0],Pr[1],Lr[0]-Pr[0],Lr[1]-Pr[1])},rebuildPath:function(e){for(var t,n,o,i,r,a,s=this.data,l=this._ux,u=this._uy,c=this._len,d=0;d<c;){var f=s[d++];switch(1===d&&(t=o=s[d],n=i=s[d+1]),f){case Kr.M:t=o=s[d++],n=i=s[d++],e.moveTo(o,i);break;case Kr.L:r=s[d++],a=s[d++],(Ur(r-o)>l||Ur(a-i)>u||d===c-1)&&(e.lineTo(r,a),o=r,i=a);break;case Kr.C:e.bezierCurveTo(s[d++],s[d++],s[d++],s[d++],s[d++],s[d++]),o=s[d-2],i=s[d-1];break;case Kr.Q:e.quadraticCurveTo(s[d++],s[d++],s[d++],s[d++]),o=s[d-2],i=s[d-1];break;case Kr.A:var h=s[d++],g=s[d++],m=s[d++],p=s[d++],v=s[d++],y=s[d++],b=s[d++],C=s[d++],T=p<m?m:p,x=p<m?1:m/p,E=p<m?p/m:1,_=v+y;.001<Math.abs(m-p)?(e.translate(h,g),e.rotate(b),e.scale(x,E),e.arc(0,0,T,v,_,1-C),e.scale(1/x,1/E),e.rotate(-b),e.translate(-h,-g)):e.arc(h,g,T,v,_,1-C),1===d&&(t=Hr(v)*m+h,n=Wr(v)*p+g),o=Hr(_)*m+h,i=Wr(_)*p+g;break;case Kr.R:t=o=s[d],n=i=s[d+1],e.rect(s[d++],s[d++],s[d++],s[d++]);break;case Kr.Z:e.closePath(),o=t,i=n}}}},jr.CMD=Kr;var Zr=2*Math.PI;function Jr(e){return(e%=Zr)<0&&(e+=Zr),e}var Qr=2*Math.PI;function ea(e,t,n,o,i,r,a,s,l){if(0===a)return!1;var u=a;s-=e,l-=t;var c=Math.sqrt(s*s+l*l);if(n<c-u||c+u<n)return!1;if(Math.abs(o-i)%Qr<1e-4)return!0;if(r){var d=o;o=Jr(i),i=Jr(d)}else o=Jr(o),i=Jr(i);i<o&&(i+=Qr);var f=Math.atan2(l,s);return f<0&&(f+=Qr),o<=f&&f<=i||o<=f+Qr&&f+Qr<=i}function ta(e,t,n,o,i,r){if(t<r&&o<r||r<t&&r<o)return 0;if(o===t)return 0;var a=o<t?1:-1,s=(r-t)/(o-t);1!=s&&0!=s||(a=o<t?.5:-.5);var l=s*(n-e)+e;return l===i?1/0:i<l?a:0}var na=jr.CMD,oa=2*Math.PI,ia=[-1,-1,-1],ra=[-1,-1];function aa(e,t,n,o,i,r,a,s,l,u){if(t<u&&o<u&&r<u&&s<u||u<t&&u<o&&u<r&&u<s)return 0;var c,d=function(e,t,n,o,i,r){var a=o+3*(t-n)-e,s=3*(n-2*t+e),l=3*(t-e),u=e-i,c=s*s-3*a*l,d=s*l-9*a*u,f=l*l-3*s*u,h=0;if(dr(c)&&dr(d))dr(s)?r[0]=0:0<=(_=-l/s)&&_<=1&&(r[h++]=_);else{var g=d*d-4*c*f;if(dr(g)){var m=d/c,p=-m/2;0<=(_=-s/a+m)&&_<=1&&(r[h++]=_),0<=p&&p<=1&&(r[h++]=p)}else if(0<g){var v=or(g),y=c*s+1.5*a*(-d+v),b=c*s+1.5*a*(-d-v);0<=(_=(-s-((y=y<0?-nr(-y,sr):nr(y,sr))+(b=b<0?-nr(-b,sr):nr(b,sr))))/(3*a))&&_<=1&&(r[h++]=_)}else{var C=(2*c*s-3*a*d)/(2*or(c*c*c)),T=Math.acos(C)/3,x=or(c),E=Math.cos(T),_=(-s-2*x*E)/(3*a),I=(p=(-s+x*(E+ar*Math.sin(T)))/(3*a),(-s+x*(E-ar*Math.sin(T)))/(3*a));0<=_&&_<=1&&(r[h++]=_),0<=p&&p<=1&&(r[h++]=p),0<=I&&I<=1&&(r[h++]=I)}}return h}(t,o,r,s,u,ia);if(0===d)return 0;for(var f,h,g=0,m=-1,p=0;p<d;p++){var v=ia[p],y=0===v||1===v?.5:1;hr(e,n,i,a,v)<l||(m<0&&(m=mr(t,o,r,s,ra),ra[1]<ra[0]&&1<m&&(c=ra[0],ra[0]=ra[1],ra[1]=c),f=hr(t,o,r,s,ra[0]),1<m&&(h=hr(t,o,r,s,ra[1]))),g+=2===m?v<ra[0]?f<t?y:-y:v<ra[1]?h<f?y:-y:s<h?y:-y:v<ra[0]?f<t?y:-y:s<f?y:-y)}return g}function sa(e,t,n,o,i,r,a,s){if(t<s&&o<s&&r<s||s<t&&s<o&&s<r)return 0;var l=function(e,t,n,o,i){var r=e-2*t+n,a=2*(t-e),s=e-o,l=0;if(dr(r))fr(a)&&0<=(c=-s/a)&&c<=1&&(i[l++]=c);else{var u=a*a-4*r*s;if(dr(u))0<=(c=-a/(2*r))&&c<=1&&(i[l++]=c);else if(0<u){var c,d=or(u),f=(-a-d)/(2*r);0<=(c=(-a+d)/(2*r))&&c<=1&&(i[l++]=c),0<=f&&f<=1&&(i[l++]=f)}}return l}(t,o,r,s,ia);if(0===l)return 0;var u=br(t,o,r);if(0<=u&&u<=1){for(var c=0,d=vr(t,o,r,u),f=0;f<l;f++){var h=0===ia[f]||1===ia[f]?.5:1;vr(e,n,i,ia[f])<a||(c+=ia[f]<u?d<t?h:-h:r<d?h:-h)}return c}return h=0===ia[0]||1===ia[0]?.5:1,vr(e,n,i,ia[0])<a?0:r<t?h:-h}function la(e,t,n,o,i,r,a,s){if(n<(s-=t)||s<-n)return 0;var l=Math.sqrt(n*n-s*s);ia[0]=-l,ia[1]=l;var u=Math.abs(o-i);if(u<1e-4)return 0;if(u%oa<1e-4){i=oa;var c=r?1:-1;return a>=ia[o=0]+e&&a<=ia[1]+e?c:0}r?(l=o,o=Jr(i),i=Jr(l)):(o=Jr(o),i=Jr(i)),i<o&&(i+=oa);for(var d=0,f=0;f<2;f++){var h=ia[f];if(a<h+e){var g=Math.atan2(s,h);c=r?1:-1,g<0&&(g=oa+g),(o<=g&&g<=i||o<=g+oa&&g+oa<=i)&&(g>Math.PI/2&&g<1.5*Math.PI&&(c=-c),d+=c)}}return d}function ua(e,t,n,o,i){for(var r=0,a=0,s=0,l=0,u=0,c=0;c<e.length;){var d=e[c++];switch(d===na.M&&1<c&&(n||(r+=ta(a,s,l,u,o,i))),1===c&&(l=a=e[c],u=s=e[c+1]),d){case na.M:a=l=e[c++],s=u=e[c++];break;case na.L:if(n){if(Gr(a,s,e[c],e[c+1],t,o,i))return!0}else r+=ta(a,s,e[c],e[c+1],o,i)||0;a=e[c++],s=e[c++];break;case na.C:if(n){if(Xr(a,s,e[c++],e[c++],e[c++],e[c++],e[c],e[c+1],t,o,i))return!0}else r+=aa(a,s,e[c++],e[c++],e[c++],e[c++],e[c],e[c+1],o,i)||0;a=e[c++],s=e[c++];break;case na.Q:if(n){if(Yr(a,s,e[c++],e[c++],e[c],e[c+1],t,o,i))return!0}else r+=sa(a,s,e[c++],e[c++],e[c],e[c+1],o,i)||0;a=e[c++],s=e[c++];break;case na.A:var f=e[c++],h=e[c++],g=e[c++],m=e[c++],p=e[c++],v=e[c++];c+=1;var y=1-e[c++],b=Math.cos(p)*g+f,C=Math.sin(p)*m+h;1<c?r+=ta(a,s,b,C,o,i):(l=b,u=C);var T=(o-f)*m/g+f;if(n){if(ea(f,h,m,p,p+v,y,t,T,i))return!0}else r+=la(f,h,m,p,p+v,y,T,i);a=Math.cos(p+v)*g+f,s=Math.sin(p+v)*m+h;break;case na.R:if(l=a=e[c++],u=s=e[c++],b=l+e[c++],C=u+e[c++],n){if(Gr(l,u,b,u,t,o,i)||Gr(b,u,b,C,t,o,i)||Gr(b,C,l,C,t,o,i)||Gr(l,C,l,u,t,o,i))return!0}else r+=ta(b,u,b,C,o,i),r+=ta(l,C,l,u,o,i);break;case na.Z:if(n){if(Gr(a,s,l,u,t,o,i))return!0}else r+=ta(a,s,l,u,o,i);a=l,s=u}}return n||function(e,t){return Math.abs(e-t)<1e-4}(s,u)||(r+=ta(a,s,l,u,o,i)||0),0!==r}var ca=Hn.prototype.getCanvasPattern,da=Math.abs,fa=new jr(!0);function ha(e){Ho.call(this,e),this.path=null}function ga(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}ha.prototype={constructor:ha,type:"path",__dirtyPath:!0,strokeContainThreshold:5,segmentIgnoreThreshold:0,subPixelOptimize:!1,brush:function(e,t){var n,o=this.style,i=this.path||fa,r=o.hasStroke(),a=o.hasFill(),s=o.fill,l=o.stroke,u=a&&!!s.colorStops,c=r&&!!l.colorStops,d=a&&!!s.image,f=r&&!!l.image;o.bind(e,this,t),this.setTransform(e),this.__dirty&&(u&&(n=n||this.getBoundingRect(),this._fillGradient=o.getGradient(e,s,n)),c&&(n=n||this.getBoundingRect(),this._strokeGradient=o.getGradient(e,l,n))),u?e.fillStyle=this._fillGradient:d&&(e.fillStyle=ca.call(s,e)),c?e.strokeStyle=this._strokeGradient:f&&(e.strokeStyle=ca.call(l,e));var h=o.lineDash,g=o.lineDashOffset,m=!!e.setLineDash,p=this.getGlobalScale();if(i.setScale(p[0],p[1],this.segmentIgnoreThreshold),this.__dirtyPath||h&&!m&&r?(i.beginPath(e),h&&!m&&(i.setLineDash(h),i.setLineDashOffset(g)),this.buildPath(i,this.shape,!1),this.path&&(this.__dirtyPath=!1)):(e.beginPath(),this.path.rebuildPath(e)),a)if(null!=o.fillOpacity){var v=e.globalAlpha;e.globalAlpha=o.fillOpacity*o.opacity,i.fill(e),e.globalAlpha=v}else i.fill(e);h&&m&&(e.setLineDash(h),e.lineDashOffset=g),r&&(null!=o.strokeOpacity?(v=e.globalAlpha,e.globalAlpha=o.strokeOpacity*o.opacity,i.stroke(e),e.globalAlpha=v):i.stroke(e)),h&&m&&e.setLineDash([]),null!=o.text&&(this.restoreTransform(e),this.drawRectText(e,this.getBoundingRect()))},buildPath:function(e,t,n){},createPathProxy:function(){this.path=new jr},getBoundingRect:function(){var e=this._rect,t=this.style,n=!e;if(n){var o=this.path;o=o||(this.path=new jr),this.__dirtyPath&&(o.beginPath(),this.buildPath(o,this.shape,!1)),e=o.getBoundingRect()}if(this._rect=e,t.hasStroke()){var i=this._rectWithStroke||(this._rectWithStroke=e.clone());if(this.__dirty||n){i.copy(e);var r=t.lineWidth,a=t.strokeNoScale?this.getLineScale():1;t.hasFill()||(r=Math.max(r,this.strokeContainThreshold||4)),1e-10<a&&(i.width+=r/a,i.height+=r/a,i.x-=r/a/2,i.y-=r/a/2)}return i}return e},contain:function(e,t){var n=this.transformCoordToLocal(e,t),o=this.getBoundingRect(),i=this.style;if(o.contain(e=n[0],t=n[1])){var r=this.path.data;if(i.hasStroke()){var a=i.lineWidth,s=i.strokeNoScale?this.getLineScale():1;if(1e-10<s&&(i.hasFill()||(a=Math.max(a,this.strokeContainThreshold)),function(e,t,n,o){return ua(e,t,!0,n,o)}(r,a/s,e,t)))return!0}if(i.hasFill())return function(e,t,n){return ua(e,0,!1,t,n)}(r,e,t)}return!1},dirty:function(e){null==e&&(e=!0),e&&(this.__dirtyPath=e,this._rect=null),this.__dirty=this.__dirtyText=!0,this.__zr&&this.__zr.refresh(),this.__clipTarget&&this.__clipTarget.dirty()},animateShape:function(e){return this.animate("shape",e)},attrKV:function(e,t){"shape"===e?(this.setShape(t),this.__dirtyPath=!0,this._rect=null):Ho.prototype.attrKV.call(this,e,t)},setShape:function(e,t){var n=this.shape;if(n){if(L(e))for(var o in e)e.hasOwnProperty(o)&&(n[o]=e[o]);else n[e]=t;this.dirty(!0)}return this},getLineScale:function(){var e=this.transform;return e&&1e-10<da(e[0]-1)&&1e-10<da(e[3]-1)?Math.sqrt(da(e[0]*e[3]-e[2]*e[1])):1}},ha.extend=function(e){function t(t){ha.call(this,t),e.style&&this.style.extendFrom(e.style,!1);var n=e.shape;if(n){this.shape=this.shape||{};var o=this.shape;for(var i in n)!o.hasOwnProperty(i)&&n.hasOwnProperty(i)&&(o[i]=n[i])}e.init&&e.init.call(this,t)}for(var n in _(t,ha),e)"style"!==n&&"shape"!==n&&(t.prototype[n]=e[n]);return t},_(ha,Ho);var ma=jr.CMD,pa=[[],[],[]],va=Math.sqrt,ya=Math.atan2,ba=Math.sqrt,Ca=Math.sin,Ta=Math.cos,xa=Math.PI,Ea=function(e,t){return(e[0]*t[0]+e[1]*t[1])/(ga(e)*ga(t))},_a=function(e,t){return(e[0]*t[1]<e[1]*t[0]?-1:1)*Math.acos(Ea(e,t))};function Ia(e,t,n,o,i,r,a,s,l,u,c){var d=l*(xa/180),f=Ta(d)*(e-n)/2+Ca(d)*(t-o)/2,h=-1*Ca(d)*(e-n)/2+Ta(d)*(t-o)/2,g=f*f/(a*a)+h*h/(s*s);1<g&&(a*=ba(g),s*=ba(g));var m=(i===r?-1:1)*ba((a*a*(s*s)-a*a*(h*h)-s*s*(f*f))/(a*a*(h*h)+s*s*(f*f)))||0,p=m*a*h/s,v=m*-s*f/a,y=(e+n)/2+Ta(d)*p-Ca(d)*v,b=(t+o)/2+Ca(d)*p+Ta(d)*v,C=_a([1,0],[(f-p)/a,(h-v)/s]),T=[(f-p)/a,(h-v)/s],x=[(-1*f-p)/a,(-1*h-v)/s],E=_a(T,x);Ea(T,x)<=-1&&(E=xa),1<=Ea(T,x)&&(E=0),0===r&&0<E&&(E-=2*xa),1===r&&E<0&&(E+=2*xa),c.addData(u,y,b,a,s,C,E,d,r)}var Da=/([mlvhzcqtsa])([^mlvhzcqtsa]*)/gi,Oa=/-?([0-9]*\.)?[0-9]+([eE]-?[0-9]+)?/g;function wa(e,t){var n=function(e){if(!e)return new jr;for(var t,n=0,o=0,i=n,r=o,a=new jr,s=jr.CMD,l=e.match(Da),u=0;u<l.length;u++){for(var c,d=l[u],f=d.charAt(0),h=d.match(Oa)||[],g=h.length,m=0;m<g;m++)h[m]=parseFloat(h[m]);for(var p=0;p<g;){var v,y,b,C,T,x,E,_=n,I=o;switch(f){case"l":n+=h[p++],o+=h[p++],a.addData(c=s.L,n,o);break;case"L":n=h[p++],o=h[p++],a.addData(c=s.L,n,o);break;case"m":n+=h[p++],o+=h[p++],a.addData(c=s.M,n,o),i=n,r=o,f="l";break;case"M":n=h[p++],o=h[p++],a.addData(c=s.M,n,o),i=n,r=o,f="L";break;case"h":n+=h[p++],a.addData(c=s.L,n,o);break;case"H":n=h[p++],a.addData(c=s.L,n,o);break;case"v":o+=h[p++],a.addData(c=s.L,n,o);break;case"V":o=h[p++],a.addData(c=s.L,n,o);break;case"C":a.addData(c=s.C,h[p++],h[p++],h[p++],h[p++],h[p++],h[p++]),n=h[p-2],o=h[p-1];break;case"c":a.addData(c=s.C,h[p++]+n,h[p++]+o,h[p++]+n,h[p++]+o,h[p++]+n,h[p++]+o),n+=h[p-2],o+=h[p-1];break;case"S":v=n,y=o;var D=a.len(),O=a.data;t===s.C&&(v+=n-O[D-4],y+=o-O[D-3]),_=h[p++],I=h[p++],n=h[p++],o=h[p++],a.addData(c=s.C,v,y,_,I,n,o);break;case"s":v=n,y=o,D=a.len(),O=a.data,t===s.C&&(v+=n-O[D-4],y+=o-O[D-3]),_=n+h[p++],I=o+h[p++],n+=h[p++],o+=h[p++],a.addData(c=s.C,v,y,_,I,n,o);break;case"Q":_=h[p++],I=h[p++],n=h[p++],o=h[p++],a.addData(c=s.Q,_,I,n,o);break;case"q":_=h[p++]+n,I=h[p++]+o,n+=h[p++],o+=h[p++],a.addData(c=s.Q,_,I,n,o);break;case"T":v=n,y=o,D=a.len(),O=a.data,t===s.Q&&(v+=n-O[D-4],y+=o-O[D-3]),n=h[p++],o=h[p++],a.addData(c=s.Q,v,y,n,o);break;case"t":v=n,y=o,D=a.len(),O=a.data,t===s.Q&&(v+=n-O[D-4],y+=o-O[D-3]),n+=h[p++],o+=h[p++],a.addData(c=s.Q,v,y,n,o);break;case"A":b=h[p++],C=h[p++],T=h[p++],x=h[p++],E=h[p++],Ia(_=n,I=o,n=h[p++],o=h[p++],x,E,b,C,T,c=s.A,a);break;case"a":b=h[p++],C=h[p++],T=h[p++],x=h[p++],E=h[p++],Ia(_=n,I=o,n+=h[p++],o+=h[p++],x,E,b,C,T,c=s.A,a)}}"z"!==f&&"Z"!==f||(a.addData(c=s.Z),n=i,o=r),t=c}return a.toStatic(),a}(e);return(t=t||{}).buildPath=function(e){if(e.setData)e.setData(n.data),(t=e.getContext())&&e.rebuildPath(t);else{var t=e;n.rebuildPath(t)}},t.applyTransform=function(e){(function(e,t){var n,o,i,r,a,s=e.data,l=ma.M,u=ma.C,c=ma.L,d=ma.R,f=ma.A,h=ma.Q;for(r=i=0;i<s.length;){switch(n=s[i++],r=i,o=0,n){case l:case c:o=1;break;case u:o=3;break;case h:o=2;break;case f:var g=t[4],m=t[5],p=va(t[0]*t[0]+t[1]*t[1]),v=va(t[2]*t[2]+t[3]*t[3]),y=ya(-t[1]/v,t[0]/p);s[i]*=p,s[i++]+=g,s[i]*=v,s[i++]+=m,s[i++]*=p,s[i++]*=v,s[i++]+=y,s[i++]+=y,r=i+=2;break;case d:b[0]=s[i++],b[1]=s[i++],Ce(b,b,t),s[r++]=b[0],s[r++]=b[1],b[0]+=s[i++],b[1]+=s[i++],Ce(b,b,t),s[r++]=b[0],s[r++]=b[1]}for(a=0;a<o;a++){var b;(b=pa[a])[0]=s[i++],b[1]=s[i++],Ce(b,b,t),s[r++]=b[0],s[r++]=b[1]}}})(n,e),this.dirty(!0)},t}function Ra(e,t){return new ha(wa(e,t))}var Sa=function(e){Ho.call(this,e)};function ka(e){return i.browser.ie&&11<=i.browser.version?function(){var t,n=this.__clipPaths,o=this.style;if(n)for(var i=0;i<n.length;i++){var r=n[i],a=r&&r.shape,s=r&&r.type;if(a&&("sector"===s&&a.startAngle===a.endAngle||"rect"===s&&(!a.width||!a.height))){for(var l=0;l<Na.length;l++)Na[l][2]=o[Na[l][0]],o[Na[l][0]]=Na[l][1];t=!0;break}}if(e.apply(this,arguments),t)for(l=0;l<Na.length;l++)o[Na[l][0]]=Na[l][2]}:e}Sa.prototype={constructor:Sa,type:"text",brush:function(e,t){var n=this.style;this.__dirty&&Io(n),n.fill=n.stroke=n.shadowBlur=n.shadowColor=n.shadowOffsetX=n.shadowOffsetY=null;var o=n.text;null!=o&&(o+=""),Fo(o,n)?(this.setTransform(e),Oo(this,e,o,n,null,t),this.restoreTransform(e)):e.__attrCachedBy=0},getBoundingRect:function(){var e=this.style;if(this.__dirty&&Io(e),!this._rect){var t=e.text;null!=t?t+="":t="";var n=io(e.text+"",e.font,e.textAlign,e.textVerticalAlign,e.textPadding,e.textLineHeight,e.rich);if(n.x+=e.x||0,n.y+=e.y||0,Ko(e.textStroke,e.textStrokeWidth)){var o=e.textStrokeWidth;n.x-=o/2,n.y-=o/2,n.width+=o,n.height+=o}this._rect=n}return this._rect}},_(Sa,Ho);var Aa=ha.extend({type:"circle",shape:{cx:0,cy:0,r:0},buildPath:function(e,t,n){n&&e.moveTo(t.cx+t.r,t.cy),e.arc(t.cx,t.cy,t.r,0,2*Math.PI,!0)}}),Na=[["shadowBlur",0],["shadowColor","#000"],["shadowOffsetX",0],["shadowOffsetY",0]],Ma=ha.extend({type:"sector",shape:{cx:0,cy:0,r0:0,r:0,startAngle:0,endAngle:2*Math.PI,clockwise:!0},brush:ka(ha.prototype.brush),buildPath:function(e,t){var n=t.cx,o=t.cy,i=Math.max(t.r0||0,0),r=Math.max(t.r,0),a=t.startAngle,s=t.endAngle,l=t.clockwise,u=Math.cos(a),c=Math.sin(a);e.moveTo(u*i+n,c*i+o),e.lineTo(u*r+n,c*r+o),e.arc(n,o,r,a,s,!l),e.lineTo(Math.cos(s)*i+n,Math.sin(s)*i+o),0!==i&&e.arc(n,o,i,s,a,l),e.closePath()}}),Ka=ha.extend({type:"ring",shape:{cx:0,cy:0,r:0,r0:0},buildPath:function(e,t){var n=t.cx,o=t.cy,i=2*Math.PI;e.moveTo(n+t.r,o),e.arc(n,o,t.r,0,i,!1),e.moveTo(n+t.r0,o),e.arc(n,o,t.r0,0,i,!0)}});function Pa(e,t,n,o,i,r,a){var s=.5*(n-e),l=.5*(o-t);return(2*(t-n)+s+l)*a+(-3*(t-n)-2*s-l)*r+s*i+t}function La(e,t,n){var o=t.points,i=t.smooth;if(o&&2<=o.length){if(i&&"spline"!==i){var r=function(e,t,n,o){var i,r,a,s,l=[],u=[],c=[],d=[];if(o){a=[1/0,1/0],s=[-1/0,-1/0];for(var f=0,h=e.length;f<h;f++)Te(a,a,e[f]),xe(s,s,e[f]);Te(a,a,o[0]),xe(s,s,o[1])}for(f=0,h=e.length;f<h;f++){var g=e[f];if(n)i=e[f?f-1:h-1],r=e[(f+1)%h];else{if(0===f||f===h-1){l.push(ae(e[f]));continue}i=e[f-1],r=e[f+1]}ce(u,r,i),he(u,u,t);var m=me(g,i),p=me(g,r),v=m+p;0!==v&&(m/=v,p/=v),he(c,u,-m),he(d,u,p);var y=le([],g,c),b=le([],g,d);o&&(xe(y,y,a),Te(y,y,s),xe(b,b,a),Te(b,b,s)),l.push(y),l.push(b)}return n&&l.push(l.shift()),l}(o,i,n,t.smoothConstraint);e.moveTo(o[0][0],o[0][1]);for(var a=o.length,s=0;s<(n?a:a-1);s++){var l=r[2*s],u=r[2*s+1],c=o[(s+1)%a];e.bezierCurveTo(l[0],l[1],u[0],u[1],c[0],c[1])}}else{"spline"===i&&(o=function(e,t){for(var n=e.length,o=[],i=0,r=1;r<n;r++)i+=me(e[r-1],e[r]);var a=i/2;for(a=a<n?n:a,r=0;r<a;r++){var s,l,u,c=r/(a-1)*(t?n:n-1),d=Math.floor(c),f=c-d,h=e[d%n];u=t?(s=e[(d-1+n)%n],l=e[(d+1)%n],e[(d+2)%n]):(s=e[0===d?d:d-1],l=e[n-2<d?n-1:d+1],e[n-3<d?n-1:d+2]);var g=f*f,m=f*g;o.push([Pa(s[0],h[0],l[0],u[0],f,g,m),Pa(s[1],h[1],l[1],u[1],f,g,m)])}return o}(o,n)),e.moveTo(o[0][0],o[0][1]),s=1;for(var d=o.length;s<d;s++)e.lineTo(o[s][0],o[s][1])}n&&e.closePath()}}var Ba=ha.extend({type:"polygon",shape:{points:null,smooth:!1,smoothConstraint:null},buildPath:function(e,t){La(e,t,!0)}}),Fa=ha.extend({type:"polyline",shape:{points:null,smooth:!1,smoothConstraint:null},style:{stroke:"#000",fill:null},buildPath:function(e,t){La(e,t,!1)}}),za=Math.round;function Va(e,t,n){if(t){var o=t.x1,i=t.x2,r=t.y1,a=t.y2;e.x1=o,e.x2=i,e.y1=r,e.y2=a;var s=n&&n.lineWidth;s&&(za(2*o)===za(2*i)&&(e.x1=e.x2=Wa(o,s,!0)),za(2*r)===za(2*a)&&(e.y1=e.y2=Wa(r,s,!0)))}}function Ha(e,t,n){if(t){var o=t.x,i=t.y,r=t.width,a=t.height;e.x=o,e.y=i,e.width=r,e.height=a;var s=n&&n.lineWidth;s&&(e.x=Wa(o,s,!0),e.y=Wa(i,s,!0),e.width=Math.max(Wa(o+r,s,!1)-e.x,0===r?0:1),e.height=Math.max(Wa(i+a,s,!1)-e.y,0===a?0:1))}}function Wa(e,t,n){if(!t)return e;var o=za(2*e);return(o+za(t))%2==0?o/2:(o+(n?1:-1))/2}var $a={},Ua=ha.extend({type:"rect",shape:{r:0,x:0,y:0,width:0,height:0},buildPath:function(e,t){var n,o,i,r;this.subPixelOptimize?(Ha($a,t,this.style),n=$a.x,o=$a.y,i=$a.width,r=$a.height,$a.r=t.r,t=$a):(n=t.x,o=t.y,i=t.width,r=t.height),t.r?yo(e,t):e.rect(n,o,i,r),e.closePath()}}),qa={},ja=ha.extend({type:"line",shape:{x1:0,y1:0,x2:0,y2:0,percent:1},style:{stroke:"#000",fill:null},buildPath:function(e,t){var n,o,i,r;r=this.subPixelOptimize?(Va(qa,t,this.style),n=qa.x1,o=qa.y1,i=qa.x2,qa.y2):(n=t.x1,o=t.y1,i=t.x2,t.y2);var a=t.percent;0!==a&&(e.moveTo(n,o),a<1&&(i=n*(1-a)+i*a,r=o*(1-a)+r*a),e.lineTo(i,r))},pointAt:function(e){var t=this.shape;return[t.x1*(1-e)+t.x2*e,t.y1*(1-e)+t.y2*e]}}),Ga=[];function Xa(e,t,n){return null===e.cpx2||null===e.cpy2?[(n?gr:hr)(e.x1,e.cpx1,e.cpx2,e.x2,t),(n?gr:hr)(e.y1,e.cpy1,e.cpy2,e.y2,t)]:[(n?yr:vr)(e.x1,e.cpx1,e.x2,t),(n?yr:vr)(e.y1,e.cpy1,e.y2,t)]}function Ya(e){this.colorStops=e||[]}var Za=ha.extend({type:"bezier-curve",shape:{x1:0,y1:0,x2:0,y2:0,cpx1:0,cpy1:0,percent:1},style:{stroke:"#000",fill:null},buildPath:function(e,t){var n=t.x1,o=t.y1,i=t.x2,r=t.y2,a=t.cpx1,s=t.cpy1,l=t.cpx2,u=t.cpy2,c=t.percent;0!==c&&(e.moveTo(n,o),null==l||null==u?(c<1&&(Cr(n,a,i,c,Ga),a=Ga[1],i=Ga[2],Cr(o,s,r,c,Ga),s=Ga[1],r=Ga[2]),e.quadraticCurveTo(a,s,i,r)):(c<1&&(pr(n,a,l,i,c,Ga),a=Ga[1],l=Ga[2],i=Ga[3],pr(o,s,u,r,c,Ga),s=Ga[1],u=Ga[2],r=Ga[3]),e.bezierCurveTo(a,s,l,u,i,r)))},pointAt:function(e){return Xa(this.shape,e,!1)},tangentAt:function(e){var t=Xa(this.shape,e,!0);return ge(t,t)}}),Ja=ha.extend({type:"arc",shape:{cx:0,cy:0,r:0,startAngle:0,endAngle:2*Math.PI,clockwise:!0},style:{stroke:"#000",fill:null},buildPath:function(e,t){var n=t.cx,o=t.cy,i=Math.max(t.r,0),r=t.startAngle,a=t.endAngle,s=t.clockwise,l=Math.cos(r),u=Math.sin(r);e.moveTo(l*i+n,u*i+o),e.arc(n,o,i,r,a,!s)}}),Qa=ha.extend({type:"compound",shape:{paths:null},_updatePathDirty:function(){for(var e=this.__dirtyPath,t=this.shape.paths,n=0;n<t.length;n++)e=e||t[n].__dirtyPath;this.__dirtyPath=e,this.__dirty=this.__dirty||e},beforeBrush:function(){this._updatePathDirty();for(var e=this.shape.paths||[],t=this.getGlobalScale(),n=0;n<e.length;n++)e[n].path||e[n].createPathProxy(),e[n].path.setScale(t[0],t[1],e[n].segmentIgnoreThreshold)},buildPath:function(e,t){for(var n=t.paths||[],o=0;o<n.length;o++)n[o].buildPath(e,n[o].shape,!0)},afterBrush:function(){for(var e=this.shape.paths||[],t=0;t<e.length;t++)e[t].__dirtyPath=!1},getBoundingRect:function(){return this._updatePathDirty(),ha.prototype.getBoundingRect.call(this)}});function es(e,t,n,o,i,r){this.x=null==e?0:e,this.y=null==t?0:t,this.x2=null==n?1:n,this.y2=null==o?0:o,this.type="linear",this.global=r||!1,Ya.call(this,i)}function ts(e,t,n,o,i){this.x=null==e?.5:e,this.y=null==t?.5:t,this.r=null==n?.5:n,this.type="radial",this.global=i||!1,Ya.call(this,o)}function ns(e){Ho.call(this,e),this._displayables=[],this._temporaryDisplayables=[],this._cursor=0,this.notClear=!0}Ya.prototype={constructor:Ya,addColorStop:function(e,t){this.colorStops.push({offset:e,color:t})}},es.prototype={constructor:es},_(es,Ya),ts.prototype={constructor:ts},_(ts,Ya),ns.prototype.incremental=!0,ns.prototype.clearDisplaybles=function(){this._displayables=[],this._temporaryDisplayables=[],this._cursor=0,this.dirty(),this.notClear=!1},ns.prototype.addDisplayable=function(e,t){t?this._temporaryDisplayables.push(e):this._displayables.push(e),this.dirty()},ns.prototype.addDisplayables=function(e,t){t=t||!1;for(var n=0;n<e.length;n++)this.addDisplayable(e[n],t)},ns.prototype.eachPendingDisplayable=function(e){for(var t=this._cursor;t<this._displayables.length;t++)e&&e(this._displayables[t]);for(t=0;t<this._temporaryDisplayables.length;t++)e&&e(this._temporaryDisplayables[t])},ns.prototype.update=function(){this.updateTransform();for(var e=this._cursor;e<this._displayables.length;e++)(t=this._displayables[e]).parent=this,t.update(),t.parent=null;for(e=0;e<this._temporaryDisplayables.length;e++){var t;(t=this._temporaryDisplayables[e]).parent=this,t.update(),t.parent=null}},ns.prototype.brush=function(e,t){for(var n=this._cursor;n<this._displayables.length;n++)(o=this._displayables[n]).beforeBrush&&o.beforeBrush(e),o.brush(e,n===this._cursor?null:this._displayables[n-1]),o.afterBrush&&o.afterBrush(e);for(this._cursor=n,n=0;n<this._temporaryDisplayables.length;n++){var o;(o=this._temporaryDisplayables[n]).beforeBrush&&o.beforeBrush(e),o.brush(e,0===n?null:this._temporaryDisplayables[n-1]),o.afterBrush&&o.afterBrush(e)}this._temporaryDisplayables=[],this.notClear=!0};var os=[];ns.prototype.getBoundingRect=function(){if(!this._rect){for(var e=new En(1/0,1/0,-1/0,-1/0),t=0;t<this._displayables.length;t++){var n=this._displayables[t],o=n.getBoundingRect().clone();n.needLocalTransform()&&o.applyTransform(n.getLocalTransform(os)),e.union(o)}this._rect=e}return this._rect},ns.prototype.contain=function(e,t){var n=this.transformCoordToLocal(e,t);if(this.getBoundingRect().contain(n[0],n[1]))for(var o=0;o<this._displayables.length;o++)if(this._displayables[o].contain(e,t))return!0;return!1},_(ns,Ho);var is=Math.max,rs=Math.min,as={},ss={color:"textFill",textBorderColor:"textStroke",textBorderWidth:"textStrokeWidth"},ls="emphasis",us="normal",cs=1,ds={},fs={};function hs(e){return ha.extend(e)}function gs(e,t){fs[e]=t}function ms(e){if(fs.hasOwnProperty(e))return fs[e]}function ps(e,t,n,o){var i=Ra(e,t);return n&&("center"===o&&(n=ys(n,i.getBoundingRect())),Cs(i,n)),i}function vs(e,t,n){var o=new Wo({style:{image:e,x:t.x,y:t.y,width:t.width,height:t.height},onload:function(e){"center"===n&&o.setStyle(ys(t,{width:e.width,height:e.height}))}});return o}function ys(e,t){var n,o=t.width/t.height,i=e.height*o;return n=i<=e.width?e.height:(i=e.width)/o,{x:e.x+e.width/2-i/2,y:e.y+e.height/2-n/2,width:i,height:n}}var bs=function(e,t){for(var n=[],o=e.length,i=0;i<o;i++){var r=e[i];r.path||r.createPathProxy(),r.__dirtyPath&&r.buildPath(r.path,r.shape,!0),n.push(r.path)}var a=new ha(t);return a.createPathProxy(),a.buildPath=function(e){e.appendPath(n);var t=e.getContext();t&&e.rebuildPath(t)},a};function Cs(e,t){if(e.applyTransform){var n=e.getBoundingRect().calculateTransform(t);e.applyTransform(n)}}var Ts=Wa;function xs(e){return null!=e&&"none"!==e}var Es=Q(),_s=0;function Is(e){var t=e.__hoverStl;if(t&&!e.__highlighted){var n=e.__zr,o=e.useHoverLayer&&n&&"canvas"===n.painter.type;if(e.__highlighted=o?"layer":"plain",!(e.isGroup||!n&&e.useHoverLayer)){var i=e,r=e.style;o&&(r=(i=n.addHover(e)).style),qs(r),o||function(e){if(e.__hoverStlDirty){e.__hoverStlDirty=!1;var t=e.__hoverStl;if(t){var n=e.__cachedNormalStl={};e.__cachedNormalZ2=e.z2;var o=e.style;for(var i in t)null!=t[i]&&(n[i]=o[i]);n.fill=o.fill,n.stroke=o.stroke}else e.__cachedNormalStl=e.__cachedNormalZ2=null}}(i),r.extendFrom(t),Ds(r,t,"fill"),Ds(r,t,"stroke"),Us(r),o||(e.dirty(!1),e.z2+=1)}}}function Ds(e,t,n){!xs(t[n])&&xs(e[n])&&(e[n]=function(e){if("string"!=typeof e)return e;var t=Es.get(e);return t||(t=Vt(e,-.1),_s<1e4&&(Es.set(e,t),_s++)),t}(e[n]))}function Os(e){var t=e.__highlighted;if(t&&(e.__highlighted=!1,!e.isGroup))if("layer"===t)e.__zr&&e.__zr.removeHover(e);else{var n=e.style,o=e.__cachedNormalStl;o&&(qs(n),e.setStyle(o),Us(n));var i=e.__cachedNormalZ2;null!=i&&e.z2-i==1&&(e.z2=i)}}function ws(e,t,n){var o,i=us,r=us;e.__highlighted&&(i=ls,o=!0),t(e,n),e.__highlighted&&(r=ls,o=!0),e.isGroup&&e.traverse((function(e){e.isGroup||t(e,n)})),o&&e.__highDownOnUpdate&&e.__highDownOnUpdate(i,r)}function Rs(e,t){t=e.__hoverStl=!1!==t&&(e.hoverStyle||t||{}),e.__hoverStlDirty=!0,e.__highlighted&&(e.__cachedNormalStl=null,Os(e),Is(e))}function Ss(e){Ms(this,e)||this.__highByOuter||ws(this,Is)}function ks(e){Ms(this,e)||this.__highByOuter||ws(this,Os)}function As(e){this.__highByOuter|=1<<(e||0),ws(this,Is)}function Ns(e){(this.__highByOuter&=~(1<<(e||0)))||ws(this,Os)}function Ms(e,t){return e.__highDownSilentOnTouch&&t.zrByTouch}function Ks(e,t){Ps(e,!0),ws(e,Rs,t)}function Ps(e,t){var n=!1===t;if(e.__highDownSilentOnTouch=e.highDownSilentOnTouch,e.__highDownOnUpdate=e.highDownOnUpdate,!n||e.__highDownDispatcher){var o=n?"off":"on";e[o]("mouseover",Ss)[o]("mouseout",ks),e[o]("emphasis",As)[o]("normal",Ns),e.__highByOuter=e.__highByOuter||0,e.__highDownDispatcher=!n}}function Ls(e){return!(!e||!e.__highDownDispatcher)}function Bs(e){var t=ds[e];return null==t&&cs<=32&&(t=ds[e]=cs++),t}function Fs(e,t,n,o,i,r,a){var s,l=(i=i||as).labelFetcher,u=i.labelDataIndex,c=i.labelDimIndex,d=i.labelProp,f=n.getShallow("show"),h=o.getShallow("show");(f||h)&&(l&&(s=l.getFormattedLabel(u,"normal",null,c,d)),null==s&&(s=K(i.defaultText)?i.defaultText(u,i):i.defaultText));var g=f?s:null,m=h?W(l?l.getFormattedLabel(u,"emphasis",null,c,d):null,s):null;null==g&&null==m||(Vs(e,n,r,i),Vs(t,o,a,i,!0)),e.text=g,t.text=m}function zs(e,t,n){var o=e.style;t&&(qs(o),e.setStyle(t),Us(o)),o=e.__hoverStl,n&&o&&(qs(o),b(o,n),Us(o))}function Vs(e,t,n,o,i){return Hs(e,t,o,i),n&&b(e,n),e}function Hs(e,t,n,o){if((n=n||as).isRectText){var i;n.getTextPosition?i=n.getTextPosition(t,o):"outside"===(i=t.getShallow("position")||(o?null:"inside"))&&(i="top"),e.textPosition=i,e.textOffset=t.getShallow("offset");var r=t.getShallow("rotate");null!=r&&(r*=Math.PI/180),e.textRotation=r,e.textDistance=W(t.getShallow("distance"),o?null:5)}var a,s=t.ecModel,l=s&&s.option.textStyle,u=function(e){for(var t;e&&e!==e.ecModel;){var n=(e.option||as).rich;if(n)for(var o in t=t||{},n)n.hasOwnProperty(o)&&(t[o]=1);e=e.parentModel}return t}(t);if(u)for(var c in a={},u)if(u.hasOwnProperty(c)){var d=t.getModel(["rich",c]);Ws(a[c]={},d,l,n,o)}return e.rich=a,Ws(e,t,l,n,o,!0),n.forceRich&&!n.textStyle&&(n.textStyle={}),e}function Ws(e,t,n,o,i,r){n=!i&&n||as,e.textFill=$s(t.getShallow("color"),o)||n.color,e.textStroke=$s(t.getShallow("textBorderColor"),o)||n.textBorderColor,e.textStrokeWidth=W(t.getShallow("textBorderWidth"),n.textBorderWidth),i||(r&&(e.insideRollbackOpt=o,Us(e)),null==e.textFill&&(e.textFill=o.autoColor)),e.fontStyle=t.getShallow("fontStyle")||n.fontStyle,e.fontWeight=t.getShallow("fontWeight")||n.fontWeight,e.fontSize=t.getShallow("fontSize")||n.fontSize,e.fontFamily=t.getShallow("fontFamily")||n.fontFamily,e.textAlign=t.getShallow("align"),e.textVerticalAlign=t.getShallow("verticalAlign")||t.getShallow("baseline"),e.textLineHeight=t.getShallow("lineHeight"),e.textWidth=t.getShallow("width"),e.textHeight=t.getShallow("height"),e.textTag=t.getShallow("tag"),r&&o.disableBox||(e.textBackgroundColor=$s(t.getShallow("backgroundColor"),o),e.textPadding=t.getShallow("padding"),e.textBorderColor=$s(t.getShallow("borderColor"),o),e.textBorderWidth=t.getShallow("borderWidth"),e.textBorderRadius=t.getShallow("borderRadius"),e.textBoxShadowColor=t.getShallow("shadowColor"),e.textBoxShadowBlur=t.getShallow("shadowBlur"),e.textBoxShadowOffsetX=t.getShallow("shadowOffsetX"),e.textBoxShadowOffsetY=t.getShallow("shadowOffsetY")),e.textShadowColor=t.getShallow("textShadowColor")||n.textShadowColor,e.textShadowBlur=t.getShallow("textShadowBlur")||n.textShadowBlur,e.textShadowOffsetX=t.getShallow("textShadowOffsetX")||n.textShadowOffsetX,e.textShadowOffsetY=t.getShallow("textShadowOffsetY")||n.textShadowOffsetY}function $s(e,t){return"auto"!==e?e:t&&t.autoColor?t.autoColor:null}function Us(e){var t,n=e.textPosition,o=e.insideRollbackOpt;if(o&&null==e.textFill){var i=o.autoColor,r=o.useInsideStyle,a=!1!==r&&(!0===r||o.isRectText&&n&&"string"==typeof n&&0<=n.indexOf("inside")),s=!a&&null!=i;(a||s)&&(t={textFill:e.textFill,textStroke:e.textStroke,textStrokeWidth:e.textStrokeWidth}),a&&(e.textFill="#fff",null==e.textStroke&&(e.textStroke=i,null==e.textStrokeWidth&&(e.textStrokeWidth=2))),s&&(e.textFill=i)}e.insideRollback=t}function qs(e){var t=e.insideRollback;t&&(e.textFill=t.textFill,e.textStroke=t.textStroke,e.textStrokeWidth=t.textStrokeWidth,e.insideRollback=null)}function js(e,t){var n=t&&t.getModel("textStyle");return G([e.fontStyle||n&&n.getShallow("fontStyle")||"",e.fontWeight||n&&n.getShallow("fontWeight")||"",(e.fontSize||n&&n.getShallow("fontSize")||12)+"px",e.fontFamily||n&&n.getShallow("fontFamily")||"sans-serif"].join(" "))}function Gs(e,t,n,o,i,r){if("function"==typeof i&&(r=i,i=null),o&&o.isAnimationEnabled()){var a=e?"Update":"",s=o.getShallow("animationDuration"+a),l=o.getShallow("animationEasing"+a),u=o.getShallow("animationDelay"+a);"function"==typeof u&&(u=u(i,o.getAnimationDelayParams?o.getAnimationDelayParams(t,i):null)),"function"==typeof s&&(s=s(i)),0<s?t.animateTo(n,s,u||0,l,r,!!r):(t.stopAnimation(),t.attr(n),r&&r())}else t.stopAnimation(),t.attr(n),r&&r()}function Xs(e,t,n,o,i){Gs(!0,e,t,n,o,i)}function Ys(e,t,n,o,i){Gs(!1,e,t,n,o,i)}function Zs(e,t){for(var n=it([]);e&&e!==t;)at(n,e.getLocalTransform(),n),e=e.parent;return n}function Js(e,t,n){return t&&!D(t)&&(t=mt.getLocalTransform(t)),n&&(t=ct([],t)),Ce([],e,t)}function Qs(e,t,n){var o=0===t[4]||0===t[5]||0===t[0]?1:Math.abs(2*t[4]/t[0]),i=0===t[4]||0===t[5]||0===t[2]?1:Math.abs(2*t[4]/t[2]),r=["left"===e?-o:"right"===e?o:0,"top"===e?-i:"bottom"===e?i:0];return r=Js(r,t,n),Math.abs(r[0])>Math.abs(r[1])?0<r[0]?"right":"left":0<r[1]?"bottom":"top"}function el(e,t,n,o){if(e&&t){var i,r=(i={},e.traverse((function(e){!e.isGroup&&e.anid&&(i[e.anid]=e)})),i);t.traverse((function(e){if(!e.isGroup&&e.anid){var t=r[e.anid];if(t){var o=a(e);e.attr(a(t)),Xs(e,o,n,e.dataIndex)}}}))}function a(e){var t={position:ae(e.position),rotation:e.rotation};return e.shape&&(t.shape=b({},e.shape)),t}}function tl(e,t){return w(e,(function(e){var n=e[0];n=is(n,t.x),n=rs(n,t.x+t.width);var o=e[1];return o=is(o,t.y),[n,o=rs(o,t.y+t.height)]}))}function nl(e,t,n){var o=(t=b({rectHover:!0},t)).style={strokeNoScale:!0};if(n=n||{x:-1,y:-1,width:2,height:2},e)return 0===e.indexOf("image://")?(o.image=e.slice(8),C(o,n),new Wo(t)):ps(e.replace("path://",""),t,n,"center")}function ol(e,t,n,o,i){for(var r=0,a=i[i.length-1];r<i.length;r++){var s=i[r];if(il(e,t,n,o,s[0],s[1],a[0],a[1]))return!0;a=s}}function il(e,t,n,o,i,r,a,s){var l=n-e,u=o-t,c=a-i,d=s-r,f=rl(c,d,l,u);if(function(e){return e<=1e-6&&-1e-6<=e}(f))return!1;var h=e-i,g=t-r,m=rl(h,g,l,u)/f;if(m<0||1<m)return!1;var p=rl(h,g,c,d)/f;return!(p<0||1<p)}function rl(e,t,n,o){return e*o-n*t}gs("circle",Aa),gs("sector",Ma),gs("ring",Ka),gs("polygon",Ba),gs("polyline",Fa),gs("rect",Ua),gs("line",ja),gs("bezierCurve",Za),gs("arc",Ja);var al=(Object.freeze||Object)({Z2_EMPHASIS_LIFT:1,CACHED_LABEL_STYLE_PROPERTIES:ss,extendShape:hs,extendPath:function(e,t){return function(e,t){return ha.extend(wa(e,t))}(e,t)},registerShape:gs,getShapeClass:ms,makePath:ps,makeImage:vs,mergePath:bs,resizePath:Cs,subPixelOptimizeLine:function(e){return Va(e.shape,e.shape,e.style),e},subPixelOptimizeRect:function(e){return Ha(e.shape,e.shape,e.style),e},subPixelOptimize:Ts,setElementHoverStyle:Rs,setHoverStyle:Ks,setAsHighDownDispatcher:Ps,isHighDownDispatcher:Ls,getHighlightDigit:Bs,setLabelStyle:Fs,modifyLabelStyle:zs,setTextStyle:Vs,setText:function(e,t,n){var o,i={isRectText:!0};!1===n?o=!0:i.autoColor=n,Hs(e,t,i,o)},getFont:js,updateProps:Xs,initProps:Ys,getTransform:Zs,applyTransform:Js,transformDirection:Qs,groupTransition:el,clipPointsByRect:tl,clipRectByRect:function(e,t){var n=is(e.x,t.x),o=rs(e.x+e.width,t.x+t.width),i=is(e.y,t.y),r=rs(e.y+e.height,t.y+t.height);if(n<=o&&i<=r)return{x:n,y:i,width:o-n,height:r-i}},createIcon:nl,linePolygonIntersect:ol,lineLineIntersect:il,Group:_n,Image:Wo,Text:Sa,Circle:Aa,Sector:Ma,Ring:Ka,Polygon:Ba,Polyline:Fa,Rect:Ua,Line:ja,BezierCurve:Za,Arc:Ja,IncrementalDisplayable:ns,CompoundPath:Qa,LinearGradient:es,RadialGradient:ts,BoundingRect:En}),sl=["textStyle","color"],ll={getTextColor:function(e){var t=this.ecModel;return this.getShallow("color")||(!e&&t?t.get(sl):null)},getFont:function(){return js({fontStyle:this.getShallow("fontStyle"),fontWeight:this.getShallow("fontWeight"),fontSize:this.getShallow("fontSize"),fontFamily:this.getShallow("fontFamily")},this.ecModel)},getTextRect:function(e){return io(e,this.getFont(),this.getShallow("align"),this.getShallow("verticalAlign")||this.getShallow("baseline"),this.getShallow("padding"),this.getShallow("lineHeight"),this.getShallow("rich"),this.getShallow("truncateText"))}},ul=Zi([["fill","color"],["stroke","borderColor"],["lineWidth","borderWidth"],["opacity"],["shadowBlur"],["shadowOffsetX"],["shadowOffsetY"],["shadowColor"],["textPosition"],["textAlign"]]),cl={getItemStyle:function(e,t){var n=ul(this,e,t),o=this.getBorderLineDash();return o&&(n.lineDash=o),n},getBorderLineDash:function(){var e=this.get("borderType");return"solid"===e||null==e?null:"dashed"===e?[5,5]:[1,1]}},dl=I,fl=Pi();function hl(e,t,n){this.parentModel=t,this.ecModel=n,this.option=e}function gl(e,t,n){for(var o=0;o<t.length&&(!t[o]||null!=(e=e&&"object"==typeof e?e[t[o]]:null));o++);return null==e&&n&&(e=n.get(t)),e}function ml(e,t){var n=fl(e).getParent;return n?n.call(e,t):e.parentModel}hl.prototype={constructor:hl,init:null,mergeOption:function(e){v(this.option,e,!0)},get:function(e,t){return null==e?this.option:gl(this.option,this.parsePath(e),!t&&ml(this,e))},getShallow:function(e,t){var n=this.option,o=null==n?n:n[e],i=!t&&ml(this,e);return null==o&&i&&(o=i.getShallow(e)),o},getModel:function(e,t){var n;return new hl(null==e?this.option:gl(this.option,e=this.parsePath(e)),t=t||(n=ml(this,e))&&n.getModel(e),this.ecModel)},isEmpty:function(){return null==this.option},restoreData:function(){},clone:function(){return new this.constructor(p(this.option))},setReadOnly:function(e){},parsePath:function(e){return"string"==typeof e&&(e=e.split(".")),e},customizeGetParent:function(e){fl(this).getParent=e},isAnimationEnabled:function(){if(!i.node){if(null!=this.option.animation)return!!this.option.animation;if(this.parentModel)return this.parentModel.isAnimationEnabled()}}},Ui(hl),ji(hl),dl(hl,Qi),dl(hl,tr),dl(hl,ll),dl(hl,cl);var pl=0;function vl(e){return[e||"",pl++,Math.random().toFixed(5)].join("_")}var yl=1e-4;function bl(e,t,n,o){var i=t[1]-t[0],r=n[1]-n[0];if(0==i)return 0==r?n[0]:(n[0]+n[1])/2;if(o)if(0<i){if(e<=t[0])return n[0];if(e>=t[1])return n[1]}else{if(e>=t[0])return n[0];if(e<=t[1])return n[1]}else{if(e===t[0])return n[0];if(e===t[1])return n[1]}return(e-t[0])/i*r+n[0]}function Cl(e,t){switch(e){case"center":case"middle":e="50%";break;case"left":case"top":e="0%";break;case"right":case"bottom":e="100%"}return"string"==typeof e?function(e){return e.replace(/^\s+|\s+$/g,"")}(e).match(/%$/)?parseFloat(e)/100*t:parseFloat(e):null==e?NaN:+e}function Tl(e,t,n){return null==t&&(t=10),t=Math.min(Math.max(0,t),20),e=(+e).toFixed(t),n?e:+e}function xl(e){return e.sort((function(e,t){return e-t})),e}function El(e){if(e=+e,isNaN(e))return 0;for(var t=1,n=0;Math.round(e*t)/t!==e;)t*=10,n++;return n}function _l(e){var t=e.toString(),n=t.indexOf("e");if(0<n){var o=+t.slice(n+1);return o<0?-o:0}var i=t.indexOf(".");return i<0?0:t.length-1-i}function Il(e,t){var n=Math.log,o=Math.LN10,i=Math.floor(n(e[1]-e[0])/o),r=Math.round(n(Math.abs(t[1]-t[0]))/o),a=Math.min(Math.max(-i+r,0),20);return isFinite(a)?a:20}function Dl(e,t,n){if(!e[t])return 0;var o=R(e,(function(e,t){return e+(isNaN(t)?0:t)}),0);if(0===o)return 0;for(var i=Math.pow(10,n),r=w(e,(function(e){return(isNaN(e)?0:e)/o*i*100})),a=100*i,s=w(r,(function(e){return Math.floor(e)})),l=R(s,(function(e,t){return e+t}),0),u=w(r,(function(e,t){return e-s[t]}));l<a;){for(var c=Number.NEGATIVE_INFINITY,d=null,f=0,h=u.length;f<h;++f)u[f]>c&&(c=u[f],d=f);++s[d],u[d]=0,++l}return s[t]/i}var Ol=9007199254740991;function wl(e){var t=2*Math.PI;return(e%t+t)%t}function Rl(e){return-yl<e&&e<yl}var Sl=/^(?:(\d{4})(?:[-\/](\d{1,2})(?:[-\/](\d{1,2})(?:[T ](\d{1,2})(?::(\d\d)(?::(\d\d)(?:[.,](\d+))?)?)?(Z|[\+\-]\d\d:?\d\d)?)?)?)?)?$/;function kl(e){if(e instanceof Date)return e;if("string"!=typeof e)return null==e?new Date(NaN):new Date(Math.round(e));var t=Sl.exec(e);if(!t)return new Date(NaN);if(t[8]){var n=+t[4]||0;return"Z"!==t[8].toUpperCase()&&(n-=t[8].slice(0,3)),new Date(Date.UTC(+t[1],+(t[2]||1)-1,+t[3]||1,n,+(t[5]||0),+t[6]||0,+t[7]||0))}return new Date(+t[1],+(t[2]||1)-1,+t[3]||1,+t[4]||0,+(t[5]||0),+t[6]||0,+t[7]||0)}function Al(e){return Math.pow(10,Nl(e))}function Nl(e){if(0===e)return 0;var t=Math.floor(Math.log(e)/Math.LN10);return 10<=e/Math.pow(10,t)&&t++,t}function Ml(e,t){var n=Nl(e),o=Math.pow(10,n),i=e/o;return e=(t?i<1.5?1:i<2.5?2:i<4?3:i<7?5:10:i<1?1:i<2?2:i<3?3:i<5?5:10)*o,-20<=n?+e.toFixed(n<0?-n:0):e}function Kl(e){e.sort((function(e,t){return function e(t,n,o){return t.interval[o]<n.interval[o]||t.interval[o]===n.interval[o]&&(t.close[o]-n.close[o]==(o?-1:1)||!o&&e(t,n,1))}(e,t,0)?-1:1}));for(var t=-1/0,n=1,o=0;o<e.length;){for(var i=e[o].interval,r=e[o].close,a=0;a<2;a++)i[a]<=t&&(i[a]=t,r[a]=a?1:1-n),t=i[a],n=r[a];i[0]===i[1]&&r[0]*r[1]!=1?e.splice(o,1):o++}return e}function Pl(e){return 0<=e-parseFloat(e)}var Ll=(Object.freeze||Object)({linearMap:bl,parsePercent:Cl,round:Tl,asc:xl,getPrecision:El,getPrecisionSafe:_l,getPixelPrecision:Il,getPercentWithPrecision:Dl,MAX_SAFE_INTEGER:Ol,remRadian:wl,isRadianAroundZero:Rl,parseDate:kl,quantity:Al,quantityExponent:Nl,nice:Ml,quantile:function(e,t){var n=(e.length-1)*t+1,o=Math.floor(n),i=+e[o-1],r=n-o;return r?i+r*(e[o]-i):i},reformIntervals:Kl,isNumeric:Pl});function Bl(e){return isNaN(e)?"-":(e=(e+"").split("."))[0].replace(/(\d{1,3})(?=(?:\d{3})+(?!\d))/g,"$1,")+(1<e.length?"."+e[1]:"")}function Fl(e,t){return e=(e||"").toLowerCase().replace(/-(.)/g,(function(e,t){return t.toUpperCase()})),t&&e&&(e=e.charAt(0).toUpperCase()+e.slice(1)),e}var zl=q,Vl=/([&<>"'])/g,Hl={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function Wl(e){return null==e?"":(e+"").replace(Vl,(function(e,t){return Hl[t]}))}function $l(e,t){return"{"+e+(null==t?"":t)+"}"}var Ul=["a","b","c","d","e","f","g"];function ql(e,t,n){M(t)||(t=[t]);var o=t.length;if(!o)return"";for(var i=t[0].$vars||[],r=0;r<i.length;r++){var a=Ul[r];e=e.replace($l(a),$l(a,0))}for(var s=0;s<o;s++)for(var l=0;l<i.length;l++){var u=t[s][i[l]];e=e.replace($l(Ul[l],s),n?Wl(u):u)}return e}function jl(e,t,n){return O(t,(function(t,o){e=e.replace("{"+o+"}",n?Wl(t):t)})),e}function Gl(e,t){var n=(e=P(e)?{color:e,extraCssText:t}:e||{}).color,o=(t=e.extraCssText,e.renderMode||"html"),i=e.markerId||"X";return n?"html"===o?"subItem"===e.type?'<span style="display:inline-block;vertical-align:middle;margin-right:8px;margin-left:3px;border-radius:4px;width:4px;height:4px;background-color:'+Wl(n)+";"+(t||"")+'"></span>':'<span style="display:inline-block;margin-right:5px;border-radius:10px;width:10px;height:10px;background-color:'+Wl(n)+";"+(t||"")+'"></span>':{renderMode:o,content:"{marker"+i+"|}  ",style:{color:n}}:""}function Xl(e,t){return"0000".substr(0,t-(e+="").length)+e}function Yl(e,t,n){"week"!==e&&"month"!==e&&"quarter"!==e&&"half-year"!==e&&"year"!==e||(e="MM-dd\nyyyy");var o=kl(t),i=n?"UTC":"",r=o["get"+i+"FullYear"](),a=o["get"+i+"Month"]()+1,s=o["get"+i+"Date"](),l=o["get"+i+"Hours"](),u=o["get"+i+"Minutes"](),c=o["get"+i+"Seconds"](),d=o["get"+i+"Milliseconds"]();return e.replace("MM",Xl(a,2)).replace("M",a).replace("yyyy",r).replace("yy",r%100).replace("dd",Xl(s,2)).replace("d",s).replace("hh",Xl(l,2)).replace("h",l).replace("mm",Xl(u,2)).replace("m",u).replace("ss",Xl(c,2)).replace("s",c).replace("SSS",Xl(d,3))}function Zl(e){return e?e.charAt(0).toUpperCase()+e.substr(1):e}var Jl=lo;function Ql(e,t){if("_blank"===t||"blank"===t){var n=window.open();n.opener=null,n.location=e}else window.open(e,t)}var eu=(Object.freeze||Object)({addCommas:Bl,toCamelCase:Fl,normalizeCssArray:zl,encodeHTML:Wl,formatTpl:ql,formatTplSimple:jl,getTooltipMarker:Gl,formatTime:Yl,capitalFirst:Zl,truncateText:Jl,getTextBoundingRect:function(e){return io(e.text,e.font,e.textAlign,e.textVerticalAlign,e.textPadding,e.textLineHeight,e.rich,e.truncate)},getTextRect:function(e,t,n,o,i,r,a,s){return io(e,t,n,o,i,s,r,a)},windowOpen:Ql}),tu=O,nu=["left","right","top","bottom","width","height"],ou=[["width","left","right"],["height","top","bottom"]];function iu(e,t,n,o,i){var r=0,a=0;null==o&&(o=1/0),null==i&&(i=1/0);var s=0;t.eachChild((function(l,u){var c,d,f=l.position,h=l.getBoundingRect(),g=t.childAt(u+1),m=g&&g.getBoundingRect();if("horizontal"===e){var p=h.width+(m?-m.x+h.x:0);s=o<(c=r+p)||l.newline?(r=0,c=p,a+=s+n,h.height):Math.max(s,h.height)}else{var v=h.height+(m?-m.y+h.y:0);s=i<(d=a+v)||l.newline?(r+=s+n,a=0,d=v,h.width):Math.max(s,h.width)}l.newline||(f[0]=r,f[1]=a,"horizontal"===e?r=c+n:a=d+n)}))}var ru=iu;function au(e,t,n){n=zl(n||0);var o=t.width,i=t.height,r=Cl(e.left,o),a=Cl(e.top,i),s=Cl(e.right,o),l=Cl(e.bottom,i),u=Cl(e.width,o),c=Cl(e.height,i),d=n[2]+n[0],f=n[1]+n[3],h=e.aspect;switch(isNaN(u)&&(u=o-s-f-r),isNaN(c)&&(c=i-l-d-a),null!=h&&(isNaN(u)&&isNaN(c)&&(o/i<h?u=.8*o:c=.8*i),isNaN(u)&&(u=h*c),isNaN(c)&&(c=u/h)),isNaN(r)&&(r=o-s-u-f),isNaN(a)&&(a=i-l-c-d),e.left||e.right){case"center":r=o/2-u/2-n[3];break;case"right":r=o-u-f}switch(e.top||e.bottom){case"middle":case"center":a=i/2-c/2-n[0];break;case"bottom":a=i-c-d}r=r||0,a=a||0,isNaN(u)&&(u=o-f-r-(s||0)),isNaN(c)&&(c=i-d-a-(l||0));var g=new En(r+n[3],a+n[0],u,c);return g.margin=n,g}function su(e,t,n,o,i){var r=!i||!i.hv||i.hv[0],a=!i||!i.hv||i.hv[1],s=i&&i.boundingMode||"all";if(r||a){var l;if("raw"===s)l="group"===e.type?new En(0,0,+t.width||0,+t.height||0):e.getBoundingRect();else if(l=e.getBoundingRect(),e.needLocalTransform()){var u=e.getLocalTransform();(l=l.clone()).applyTransform(u)}t=au(C({width:l.width,height:l.height},t),n,o);var c=e.position,d=r?t.x-l.x:0,f=a?t.y-l.y:0;e.attr("position","raw"===s?[d,f]:[c[0]+d,c[1]+f])}}function lu(e,t,n){L(n)||(n={});var o=n.ignoreSize;M(o)||(o=[o,o]);var i=a(ou[0],0),r=a(ou[1],1);function a(n,i){var r={},a=0,u={},c=0;if(tu(n,(function(t){u[t]=e[t]})),tu(n,(function(e){s(t,e)&&(r[e]=u[e]=t[e]),l(r,e)&&a++,l(u,e)&&c++})),o[i])return l(t,n[1])?u[n[2]]=null:l(t,n[2])&&(u[n[1]]=null),u;if(2!==c&&a){if(2<=a)return r;for(var d=0;d<n.length;d++){var f=n[d];if(!s(r,f)&&s(e,f)){r[f]=e[f];break}}return r}return u}function s(e,t){return e.hasOwnProperty(t)}function l(e,t){return null!=e[t]&&"auto"!==e[t]}function u(e,t,n){tu(e,(function(e){t[e]=n[e]}))}u(ou[0],e,i),u(ou[1],e,r)}function uu(e){return cu({},e)}function cu(e,t){return t&&e&&tu(nu,(function(n){t.hasOwnProperty(n)&&(e[n]=t[n])})),e}N(iu,"vertical"),N(iu,"horizontal");var du,fu,hu,gu=Pi(),mu=hl.extend({type:"component",id:"",name:"",mainType:"",subType:"",componentIndex:0,defaultOption:null,ecModel:null,dependentModels:[],uid:null,layoutMode:null,$constructor:function(e,t,n,o){hl.call(this,e,t,n,o),this.uid=vl("ec_cpt_model")},init:function(e,t,n,o){this.mergeDefaultAndTheme(e,n)},mergeDefaultAndTheme:function(e,t){var n=this.layoutMode,o=n?uu(e):{};v(e,t.getTheme().get(this.mainType)),v(e,this.getDefaultOption()),n&&lu(e,o,n)},mergeOption:function(e,t){v(this.option,e,!0);var n=this.layoutMode;n&&lu(this.option,e,n)},optionUpdated:function(e,t){},getDefaultOption:function(){var e=gu(this);if(!e.defaultOption){for(var t=[],n=this.constructor;n;){var o=n.prototype.defaultOption;o&&t.push(o),n=n.superClass}for(var i={},r=t.length-1;0<=r;r--)i=v(i,t[r],!0);e.defaultOption=i}return e.defaultOption},getReferringComponents:function(e){return this.ecModel.queryComponents({mainType:e,index:this.get(e+"Index",!0),id:this.get(e+"Id",!0)})}});function pu(e,t){return e[t]||(e[t]={predecessor:[],successor:[]}),e[t]}Yi(mu,{registerWhenExtend:!0}),fu={},(du=mu).registerSubTypeDefaulter=function(e,t){e=$i(e),fu[e.main]=t},du.determineSubType=function(e,t){var n=t.type;if(!n){var o=$i(e).main;du.hasSubTypes(e)&&fu[o]&&(n=fu[o](t))}return n},hu=function(e){var t=[];return O(mu.getClassesByMainType(e),(function(e){t=t.concat(e.prototype.dependencies||[])})),t=w(t,(function(e){return $i(e).main})),"dataset"!==e&&E(t,"dataset")<=0&&t.unshift("dataset"),t},mu.topologicalTravel=function(e,t,n,o){if(e.length){var i=function(e){var t={},n=[];return O(e,(function(o){var i=pu(t,o),r=function(e,t){var n=[];return O(e,(function(e){0<=E(t,e)&&n.push(e)})),n}(i.originalDeps=hu(o),e);i.entryCount=r.length,0===i.entryCount&&n.push(o),O(r,(function(e){E(i.predecessor,e)<0&&i.predecessor.push(e);var n=pu(t,e);E(n.successor,e)<0&&n.successor.push(o)}))})),{graph:t,noEntryList:n}}(t),r=i.graph,a=i.noEntryList,s={};for(O(e,(function(e){s[e]=!0}));a.length;){var l=a.pop(),u=r[l],c=!!s[l];c&&(n.call(o,l,u.originalDeps.slice()),delete s[l]),O(u.successor,c?f:d)}O(s,(function(){throw new Error("Circle dependency may exists")}))}function d(e){r[e].entryCount--,0===r[e].entryCount&&a.push(e)}function f(e){s[e]=!0,d(e)}},I(mu,{getBoxLayoutParams:function(){return{left:this.get("left"),top:this.get("top"),right:this.get("right"),bottom:this.get("bottom"),width:this.get("width"),height:this.get("height")}}});var vu="";"undefined"!=typeof navigator&&(vu=navigator.platform||"");var yu={color:["#c23531","#2f4554","#61a0a8","#d48265","#91c7ae","#749f83","#ca8622","#bda29a","#6e7074","#546570","#c4ccd3"],gradientColor:["#f6efa6","#d88273","#bf444c"],textStyle:{fontFamily:vu.match(/^Win/)?"Microsoft YaHei":"sans-serif",fontSize:12,fontStyle:"normal",fontWeight:"normal"},blendMode:null,animation:"auto",animationDuration:1e3,animationDurationUpdate:300,animationEasing:"exponentialOut",animationEasingUpdate:"cubicOut",animationThreshold:2e3,progressiveThreshold:3e3,progressive:400,hoverLayerThreshold:3e3,useUTC:!1},bu=Pi(),Cu={clearColorPalette:function(){bu(this).colorIdx=0,bu(this).colorNameMap={}},getColorFromPalette:function(e,t,n){var o=bu(t=t||this),i=o.colorIdx||0,r=o.colorNameMap=o.colorNameMap||{};if(r.hasOwnProperty(e))return r[e];var a=Oi(this.get("color",!0)),s=this.get("colorLayer",!0),l=null!=n&&s?function(e,t){for(var n=e.length,o=0;o<n;o++)if(e[o].length>t)return e[o];return e[n-1]}(s,n):a;if((l=l||a)&&l.length){var u=l[i];return e&&(r[e]=u),o.colorIdx=(i+1)%l.length,u}}},Tu="original",xu="arrayRows",Eu="objectRows",_u="keyedColumns",Iu="unknown",Du="typedArray",Ou="column",wu="row";function Ru(e){this.fromDataset=e.fromDataset,this.data=e.data||(e.sourceFormat===_u?{}:[]),this.sourceFormat=e.sourceFormat||Iu,this.seriesLayoutBy=e.seriesLayoutBy||Ou,this.dimensionsDefine=e.dimensionsDefine,this.encodeDefine=e.encodeDefine&&Q(e.encodeDefine),this.startIndex=e.startIndex||0,this.dimensionsDetectCount=e.dimensionsDetectCount}Ru.seriesDataToSource=function(e){return new Ru({data:e,sourceFormat:F(e)?Du:Tu,fromDataset:!1})},ji(Ru);var Su=Pi();function ku(e){var t=e.option,n=t.data,o=F(n)?Du:Tu,i=!1,r=t.seriesLayoutBy,a=t.sourceHeader,s=t.dimensions,l=Pu(e);if(l){var u=l.option;n=u.source,o=Su(l).sourceFormat,i=!0,r=r||u.seriesLayoutBy,null==a&&(a=u.sourceHeader),s=s||u.dimensions}var c=function(e,t,n,o,i){if(!e)return{dimensionsDefine:Au(i)};var r,a;if(t===xu)"auto"===o||null==o?Nu((function(e){null!=e&&"-"!==e&&(P(e)?null==a&&(a=1):a=0)}),n,e,10):a=o?1:0,i||1!==a||(i=[],Nu((function(e,t){i[t]=null!=e?e:""}),n,e)),r=i?i.length:n===wu?e.length:e[0]?e[0].length:null;else if(t===Eu)i=i||function(e){for(var t,n=0;n<e.length&&!(t=e[n++]););if(t){var o=[];return O(t,(function(e,t){o.push(t)})),o}}(e);else if(t===_u)i||(i=[],O(e,(function(e,t){i.push(t)})));else if(t===Tu){var s=Si(e[0]);r=M(s)&&s.length||1}return{startIndex:a,dimensionsDefine:Au(i),dimensionsDetectCount:r}}(n,o,r,a,s);Su(e).source=new Ru({data:n,fromDataset:i,seriesLayoutBy:r,sourceFormat:o,dimensionsDefine:c.dimensionsDefine,startIndex:c.startIndex,dimensionsDetectCount:c.dimensionsDetectCount,encodeDefine:t.encode})}function Au(e){if(e){var t=Q();return w(e,(function(e,n){if(null==(e=b({},L(e)?e:{name:e})).name)return e;e.name+="",null==e.displayName&&(e.displayName=e.name);var o=t.get(e.name);return o?e.name+="-"+o.count++:t.set(e.name,{count:1}),e}))}}function Nu(e,t,n,o){if(null==o&&(o=1/0),t===wu)for(var i=0;i<n.length&&i<o;i++)e(n[i]?n[i][0]:null,i);else{var r=n[0]||[];for(i=0;i<r.length&&i<o;i++)e(r[i],i)}}function Mu(e,t,n){var o={},i=Pu(t);if(!i||!e)return o;var r,a,s=[],l=[],u=Su(t.ecModel).datasetMap,c=i.uid+"_"+n.seriesLayoutBy;O(e=e.slice(),(function(t,n){L(t)||(e[n]={name:t}),"ordinal"===t.type&&null==r&&(a=h(e[r=n])),o[t.name]=[]}));var d=u.get(c)||u.set(c,{categoryWayDim:a,valueWayDim:0});function f(e,t,n){for(var o=0;o<n;o++)e.push(t+o)}function h(e){var t=e.dimsDef;return t?t.length:1}return O(e,(function(e,t){var n=e.name,i=h(e);if(null==r){var a=d.valueWayDim;f(o[n],a,i),f(l,a,i),d.valueWayDim+=i}else r===t?(f(o[n],0,i),f(s,0,i)):(f(o[n],a=d.categoryWayDim,i),f(l,a,i),d.categoryWayDim+=i)})),s.length&&(o.itemName=s),l.length&&(o.seriesName=l),o}function Ku(e,t,n){var o={};if(!Pu(e))return o;var i,r=t.sourceFormat,a=t.dimensionsDefine;r!==Eu&&r!==_u||O(a,(function(e,t){"name"===(L(e)?e.name:e)&&(i=t)}));var s=function(){for(var e={},o={},s=[],l=0,u=Math.min(5,n);l<u;l++){var c=Lu(t.data,r,t.seriesLayoutBy,a,t.startIndex,l);s.push(c);var d=3===c;if(d&&null==e.v&&l!==i&&(e.v=l),null!=e.n&&e.n!==e.v&&(d||3!==s[e.n])||(e.n=l),f(e)&&3!==s[e.n])return e;d||(2===c&&null==o.v&&l!==i&&(o.v=l),null!=o.n&&o.n!==o.v||(o.n=l))}function f(e){return null!=e.v&&null!=e.n}return f(e)?e:f(o)?o:null}();if(s){o.value=s.v;var l=null!=i?i:s.n;o.itemName=[l],o.seriesName=[l]}return o}function Pu(e){var t=e.option;if(!t.data)return e.ecModel.getComponent("dataset",t.datasetIndex||0)}function Lu(e,t,n,o,i,r){var a,s,l;if(F(e))return 3;if(o){var u=o[r];L(u)?(s=u.name,l=u.type):P(u)&&(s=u)}if(null!=l)return"ordinal"===l?1:3;if(t===xu)if(n===wu){for(var c=e[r],d=0;d<(c||[]).length&&d<5;d++)if(null!=(a=m(c[i+d])))return a}else for(d=0;d<e.length&&d<5;d++){var f=e[i+d];if(f&&null!=(a=m(f[r])))return a}else if(t===Eu){if(!s)return 3;for(d=0;d<e.length&&d<5;d++)if((h=e[d])&&null!=(a=m(h[s])))return a}else if(t===_u){if(!s)return 3;if(!(c=e[s])||F(c))return 3;for(d=0;d<c.length&&d<5;d++)if(null!=(a=m(c[d])))return a}else if(t===Tu)for(d=0;d<e.length&&d<5;d++){var h,g=Si(h=e[d]);if(!M(g))return 3;if(null!=(a=m(g[r])))return a}function m(e){var t=P(e);return null!=e&&isFinite(e)&&""!==e?t?2:3:t&&"-"!==e?1:void 0}return 3}var Bu="\0_ec_inner",Fu=hl.extend({init:function(e,t,n,o){n=n||{},this.option=null,this._theme=new hl(n),this._optionManager=o},setOption:function(e,t){j(!(Bu in e),"please use chart.getOption()"),this._optionManager.setOption(e,t),this.resetOption(null)},resetOption:function(e){var t=!1,n=this._optionManager;if(!e||"recreate"===e){var o=n.mountOption("recreate"===e);this.option&&"recreate"!==e?(this.restoreData(),this.mergeOption(o)):(function(e){e=e,this.option={},this.option[Bu]=1,this._componentsMap=Q({series:[]}),function(e,t){var n=e.color&&!e.colorLayer;O(t,(function(t,o){"colorLayer"===o&&n||mu.hasClass(o)||("object"==typeof t?e[o]=e[o]?v(e[o],t,!1):p(t):null==e[o]&&(e[o]=t))}))}(e,this._theme.option),v(e,yu,!1),this.mergeOption(e)}).call(this,o),t=!0}if("timeline"!==e&&"media"!==e||this.restoreData(),!e||"recreate"===e||"timeline"===e){var i=n.getTimelineOption(this);i&&(this.mergeOption(i),t=!0)}if(!e||"recreate"===e||"media"===e){var r=n.getMediaOption(this,this._api);r.length&&O(r,(function(e){this.mergeOption(e,t=!0)}),this)}return t},mergeOption:function(e){var t=this.option,n=this._componentsMap,o=[];!function(e){Su(e).datasetMap=Q()}(this),O(e,(function(e,n){null!=e&&(mu.hasClass(n)?n&&o.push(n):t[n]=null==t[n]?p(e):v(t[n],e,!0))})),mu.topologicalTravel(o,mu.getAllClassMainTypes(),(function(o,i){var r=Oi(e[o]),a=ki(n.get(o),r);Ai(a),O(a,(function(e,t){var n=e.option;L(n)&&(e.keyInfo.mainType=o,e.keyInfo.subType=function(e,t,n){return t.type?t.type:n?n.subType:mu.determineSubType(e,t)}(o,n,e.exist))}));var s=function(e,t){M(t)||(t=t?[t]:[]);var n={};return O(t,(function(t){n[t]=(e.get(t)||[]).slice()})),n}(n,i);t[o]=[],n.set(o,[]),O(a,(function(e,i){var r=e.exist,a=e.option;if(j(L(a)||r,"Empty component definition"),a){var l=mu.getClass(o,e.keyInfo.subType,!0);if(r&&r.constructor===l)r.name=e.keyInfo.name,r.mergeOption(a,this),r.optionUpdated(a,!1);else{var u=b({dependentModels:s,componentIndex:i},e.keyInfo);b(r=new l(a,this,this,u),u),r.init(a,this,this,u),r.optionUpdated(null,!0)}}else r.mergeOption({},this),r.optionUpdated({},!1);n.get(o)[i]=r,t[o][i]=r.option}),this),"series"===o&&zu(this,n.get("series"))}),this),this._seriesIndicesMap=Q(this._seriesIndices=this._seriesIndices||[])},getOption:function(){var e=p(this.option);return O(e,(function(t,n){if(mu.hasClass(n)){for(var o=(t=Oi(t)).length-1;0<=o;o--)Mi(t[o])&&t.splice(o,1);e[n]=t}})),delete e[Bu],e},getTheme:function(){return this._theme},getComponent:function(e,t){var n=this._componentsMap.get(e);if(n)return n[t||0]},queryComponents:function(e){var t=e.mainType;if(!t)return[];var n,o=e.index,i=e.id,r=e.name,a=this._componentsMap.get(t);if(!a||!a.length)return[];if(null!=o)M(o)||(o=[o]),n=S(w(o,(function(e){return a[e]})),(function(e){return!!e}));else if(null!=i){var s=M(i);n=S(a,(function(e){return s&&0<=E(i,e.id)||!s&&e.id===i}))}else if(null!=r){var l=M(r);n=S(a,(function(e){return l&&0<=E(r,e.name)||!l&&e.name===r}))}else n=a.slice();return Vu(n,e)},findComponents:function(e){var t,n,o,i,r,a=e.mainType,s=(n=a+"Index",o=a+"Id",i=a+"Name",!(t=e.query)||null==t[n]&&null==t[o]&&null==t[i]?null:{mainType:a,index:t[n],id:t[o],name:t[i]});return r=Vu(s?this.queryComponents(s):this._componentsMap.get(a),e),e.filter?S(r,e.filter):r},eachComponent:function(e,t,n){var o=this._componentsMap;"function"==typeof e?(n=t,t=e,o.each((function(e,o){O(e,(function(e,i){t.call(n,o,e,i)}))}))):P(e)?O(o.get(e),t,n):L(e)&&O(this.findComponents(e),t,n)},getSeriesByName:function(e){return S(this._componentsMap.get("series"),(function(t){return t.name===e}))},getSeriesByIndex:function(e){return this._componentsMap.get("series")[e]},getSeriesByType:function(e){return S(this._componentsMap.get("series"),(function(t){return t.subType===e}))},getSeries:function(){return this._componentsMap.get("series").slice()},getSeriesCount:function(){return this._componentsMap.get("series").length},eachSeries:function(e,t){O(this._seriesIndices,(function(n){var o=this._componentsMap.get("series")[n];e.call(t,o,n)}),this)},eachRawSeries:function(e,t){O(this._componentsMap.get("series"),e,t)},eachSeriesByType:function(e,t,n){O(this._seriesIndices,(function(o){var i=this._componentsMap.get("series")[o];i.subType===e&&t.call(n,i,o)}),this)},eachRawSeriesByType:function(e,t,n){return O(this.getSeriesByType(e),t,n)},isSeriesFiltered:function(e){return null==this._seriesIndicesMap.get(e.componentIndex)},getCurrentSeriesIndices:function(){return(this._seriesIndices||[]).slice()},filterSeries:function(e,t){zu(this,S(this._componentsMap.get("series"),e,t))},restoreData:function(e){var t=this._componentsMap;zu(this,t.get("series"));var n=[];t.each((function(e,t){n.push(t)})),mu.topologicalTravel(n,mu.getAllClassMainTypes(),(function(n,o){O(t.get(n),(function(t){"series"===n&&function(e,t){if(t){var n=t.seiresIndex,o=t.seriesId,i=t.seriesName;return null!=n&&e.componentIndex!==n||null!=o&&e.id!==o||null!=i&&e.name!==i}}(t,e)||t.restoreData()}))}))}});function zu(e,t){e._seriesIndicesMap=Q(e._seriesIndices=w(t,(function(e){return e.componentIndex}))||[])}function Vu(e,t){return t.hasOwnProperty("subType")?S(e,(function(e){return e.subType===t.subType})):e}I(Fu,Cu);var Hu=["getDom","getZr","getWidth","getHeight","getDevicePixelRatio","dispatchAction","isDisposed","on","off","getDataURL","getConnectedDataURL","getModel","getOption","getViewOfComponentModel","getViewOfSeriesModel"];function Wu(e){O(Hu,(function(t){this[t]=A(e[t],e)}),this)}var $u={};function Uu(){this._coordinateSystems=[]}Uu.prototype={constructor:Uu,create:function(e,t){var n=[];O($u,(function(o,i){var r=o.create(e,t);n=n.concat(r||[])})),this._coordinateSystems=n},update:function(e,t){O(this._coordinateSystems,(function(n){n.update&&n.update(e,t)}))},getCoordinateSystems:function(){return this._coordinateSystems.slice()}},Uu.register=function(e,t){$u[e]=t},Uu.get=function(e){return $u[e]};var qu=O,ju=p,Gu=w,Xu=v,Yu=/^(min|max)?(.+)$/;function Zu(e){this._api=e,this._timelineOptions=[],this._mediaList=[],this._currentMediaIndices=[]}function Ju(e,t,n){var o={width:t,height:n,aspectratio:t/n},i=!0;return O(e,(function(e,t){var n=t.match(Yu);if(n&&n[1]&&n[2]){var r=n[1],a=n[2].toLowerCase();!function(e,t,n){return"min"===n?t<=e:"max"===n?e<=t:e===t}(o[a],e,r)&&(i=!1)}})),i}Zu.prototype={constructor:Zu,setOption:function(e,t){e&&O(Oi(e.series),(function(e){e&&e.data&&F(e.data)&&Y(e.data)})),e=ju(e);var n=this._optionBackup,o=(function(e,t,n){var o,i,r=[],a=[],s=e.timeline;return e.baseOption&&(i=e.baseOption),(s||e.options)&&(i=i||{},r=(e.options||[]).slice()),e.media&&(i=i||{},qu(e.media,(function(e){e&&e.option&&(e.query?a.push(e):o=o||e)}))),(i=i||e).timeline||(i.timeline=s),qu([i].concat(r).concat(w(a,(function(e){return e.option}))),(function(e){qu(t,(function(t){t(e,n)}))})),{baseOption:i,timelineOptions:r,mediaDefault:o,mediaList:a}}).call(this,e,t,!n);this._newBaseOption=o.baseOption,n?(function(e,t){qu(t=t||{},(function(t,n){if(null!=t){var o=e[n];if(mu.hasClass(n)){t=Oi(t);var i=ki(o=Oi(o),t);e[n]=Gu(i,(function(e){return e.option&&e.exist?Xu(e.exist,e.option,!0):e.exist||e.option}))}else e[n]=Xu(o,t,!0)}}))}(n.baseOption,o.baseOption),o.timelineOptions.length&&(n.timelineOptions=o.timelineOptions),o.mediaList.length&&(n.mediaList=o.mediaList),o.mediaDefault&&(n.mediaDefault=o.mediaDefault)):this._optionBackup=o},mountOption:function(e){var t=this._optionBackup;return this._timelineOptions=Gu(t.timelineOptions,ju),this._mediaList=Gu(t.mediaList,ju),this._mediaDefault=ju(t.mediaDefault),this._currentMediaIndices=[],ju(e?t.baseOption:this._newBaseOption)},getTimelineOption:function(e){var t,n=this._timelineOptions;if(n.length){var o=e.getComponent("timeline");o&&(t=ju(n[o.getCurrentIndex()],!0))}return t},getMediaOption:function(e){var t=this._api.getWidth(),n=this._api.getHeight(),o=this._mediaList,i=this._mediaDefault,r=[],a=[];if(!o.length&&!i)return a;for(var s=0,l=o.length;s<l;s++)Ju(o[s].query,t,n)&&r.push(s);return!r.length&&i&&(r=[-1]),r.length&&!function(e,t){return e.join(",")===t.join(",")}(r,this._currentMediaIndices)&&(a=Gu(r,(function(e){return ju(-1===e?i.option:o[e].option)}))),this._currentMediaIndices=r,a}};var Qu=O,ec=L,tc=["areaStyle","lineStyle","nodeStyle","linkStyle","chordStyle","label","labelLine"];function nc(e){var t=e&&e.itemStyle;if(t)for(var n=0,o=tc.length;n<o;n++){var i=tc[n],r=t.normal,a=t.emphasis;r&&r[i]&&(e[i]=e[i]||{},e[i].normal?v(e[i].normal,r[i]):e[i].normal=r[i],r[i]=null),a&&a[i]&&(e[i]=e[i]||{},e[i].emphasis?v(e[i].emphasis,a[i]):e[i].emphasis=a[i],a[i]=null)}}function oc(e,t,n){if(e&&e[t]&&(e[t].normal||e[t].emphasis)){var o=e[t].normal,i=e[t].emphasis;o&&(n?(e[t].normal=e[t].emphasis=null,C(e[t],o)):e[t]=o),i&&(e.emphasis=e.emphasis||{},e.emphasis[t]=i)}}function ic(e){oc(e,"itemStyle"),oc(e,"lineStyle"),oc(e,"areaStyle"),oc(e,"label"),oc(e,"labelLine"),oc(e,"upperLabel"),oc(e,"edgeLabel")}function rc(e,t){var n=ec(e)&&e[t],o=ec(n)&&n.textStyle;if(o)for(var i=0,r=Ri.length;i<r;i++)o.hasOwnProperty(t=Ri[i])&&(n[t]=o[t])}function ac(e){e&&(ic(e),rc(e,"label"),e.emphasis&&rc(e.emphasis,"label"))}function sc(e){return M(e)?e:e?[e]:[]}function lc(e){return(M(e)?e[0]:e)||{}}function uc(e){O(cc,(function(t){t[0]in e&&!(t[1]in e)&&(e[t[1]]=e[t[0]])}))}var cc=[["x","left"],["y","top"],["x2","right"],["y2","bottom"]],dc=["grid","geo","parallel","legend","toolbox","title","visualMap","dataZoom","timeline"],fc=function(e,t){(function(e,t){Qu(sc(e.series),(function(e){ec(e)&&function(e){if(ec(e)){nc(e),ic(e),rc(e,"label"),rc(e,"upperLabel"),rc(e,"edgeLabel"),e.emphasis&&(rc(e.emphasis,"label"),rc(e.emphasis,"upperLabel"),rc(e.emphasis,"edgeLabel")),(n=e.markPoint)&&(nc(n),ac(n)),(o=e.markLine)&&(nc(o),ac(o));var t=e.markArea;t&&ac(t);var n,o,i=e.data;if("graph"===e.type){i=i||e.nodes;var r=e.links||e.edges;if(r&&!F(r))for(var a=0;a<r.length;a++)ac(r[a]);O(e.categories,(function(e){ic(e)}))}if(i&&!F(i))for(a=0;a<i.length;a++)ac(i[a]);if((n=e.markPoint)&&n.data){var s=n.data;for(a=0;a<s.length;a++)ac(s[a])}if((o=e.markLine)&&o.data){var l=o.data;for(a=0;a<l.length;a++)M(l[a])?(ac(l[a][0]),ac(l[a][1])):ac(l[a])}"gauge"===e.type?(rc(e,"axisLabel"),rc(e,"title"),rc(e,"detail")):"treemap"===e.type?(oc(e.breadcrumb,"itemStyle"),O(e.levels,(function(e){ic(e)}))):"tree"===e.type&&ic(e.leaves)}}(e)}));var n=["xAxis","yAxis","radiusAxis","angleAxis","singleAxis","parallelAxis","radar"];t&&n.push("valueAxis","categoryAxis","logAxis","timeAxis"),Qu(n,(function(t){Qu(sc(e[t]),(function(e){e&&(rc(e,"axisLabel"),rc(e.axisPointer,"label"))}))})),Qu(sc(e.parallel),(function(e){var t=e&&e.parallelAxisDefault;rc(t,"axisLabel"),rc(t&&t.axisPointer,"label")})),Qu(sc(e.calendar),(function(e){oc(e,"itemStyle"),rc(e,"dayLabel"),rc(e,"monthLabel"),rc(e,"yearLabel")})),Qu(sc(e.radar),(function(e){rc(e,"name")})),Qu(sc(e.geo),(function(e){ec(e)&&(ac(e),Qu(sc(e.regions),(function(e){ac(e)})))})),Qu(sc(e.timeline),(function(e){ac(e),oc(e,"label"),oc(e,"itemStyle"),oc(e,"controlStyle",!0);var t=e.data;M(t)&&O(t,(function(e){L(e)&&(oc(e,"label"),oc(e,"itemStyle"))}))})),Qu(sc(e.toolbox),(function(e){oc(e,"iconStyle"),Qu(e.feature,(function(e){oc(e,"iconStyle")}))})),rc(lc(e.axisPointer),"label"),rc(lc(e.tooltip).axisPointer,"label")})(e,t),e.series=Oi(e.series),O(e.series,(function(e){if(L(e)){var t=e.type;if("line"===t)null!=e.clipOverflow&&(e.clip=e.clipOverflow);else if("pie"===t||"gauge"===t)null!=e.clockWise&&(e.clockwise=e.clockWise);else if("gauge"===t){var n=function(e,t){t=t.split(",");for(var n=e,o=0;o<t.length&&null!=(n=n&&n[t[o]]);o++);return n}(e,"pointer.color");null!=n&&function(e,t,n,o){t=t.split(",");for(var i,r=e,a=0;a<t.length-1;a++)null==r[i=t[a]]&&(r[i]={}),r=r[i];null!=r[t[a]]||(r[t[a]]=n)}(e,"itemStyle.color",n)}uc(e)}})),e.dataRange&&(e.visualMap=e.dataRange),O(dc,(function(t){var n=e[t];n&&(M(n)||(n=[n]),O(n,(function(e){uc(e)})))}))};function hc(e){O(e,(function(t,n){var o=[],i=[NaN,NaN],r=t.data,a=t.isStackedByIndex,s=r.map([t.stackResultDimension,t.stackedOverDimension],(function(s,l,u){var c,d,f=r.get(t.stackedDimension,u);if(isNaN(f))return i;a?d=r.getRawIndex(u):c=r.get(t.stackedByDimension,u);for(var h=NaN,g=n-1;0<=g;g--){var m=e[g];if(a||(d=m.data.rawIndexOf(m.stackedByDimension,c)),0<=d){var p=m.data.getByRawIndex(m.stackResultDimension,d);if(0<=f&&0<p||f<=0&&p<0){f+=p,h=p;break}}}return o[0]=f,o[1]=h,o}));r.hostModel.setData(s),t.data=s}))}function gc(e,t){Ru.isInstance(e)||(e=Ru.seriesDataToSource(e)),this._source=e;var n=this._data=e.data,o=e.sourceFormat;o===Du&&(this._offset=0,this._dimSize=t,this._data=n),b(this,pc[o===xu?o+"_"+e.seriesLayoutBy:o])}var mc=gc.prototype;mc.pure=!1;var pc={arrayRows_column:{pure:mc.persistent=!0,count:function(){return Math.max(0,this._data.length-this._source.startIndex)},getItem:function(e){return this._data[e+this._source.startIndex]},appendData:bc},arrayRows_row:{pure:!0,count:function(){var e=this._data[0];return e?Math.max(0,e.length-this._source.startIndex):0},getItem:function(e){e+=this._source.startIndex;for(var t=[],n=this._data,o=0;o<n.length;o++){var i=n[o];t.push(i?i[e]:null)}return t},appendData:function(){throw new Error('Do not support appendData when set seriesLayoutBy: "row".')}},objectRows:{pure:!0,count:vc,getItem:yc,appendData:bc},keyedColumns:{pure:!0,count:function(){var e=this._data[this._source.dimensionsDefine[0].name];return e?e.length:0},getItem:function(e){for(var t=[],n=this._source.dimensionsDefine,o=0;o<n.length;o++){var i=this._data[n[o].name];t.push(i?i[e]:null)}return t},appendData:function(e){var t=this._data;O(e,(function(e,n){for(var o=t[n]||(t[n]=[]),i=0;i<(e||[]).length;i++)o.push(e[i])}))}},original:{count:vc,getItem:yc,appendData:bc},typedArray:{persistent:!(mc.getSource=function(){return this._source}),pure:!0,count:function(){return this._data?this._data.length/this._dimSize:0},getItem:function(e,t){t=t||[];for(var n=this._dimSize*(e-=this._offset),o=0;o<this._dimSize;o++)t[o]=this._data[n+o];return t},appendData:function(e){this._data=e},clean:function(){this._offset+=this.count(),this._data=null}}};function vc(){return this._data.length}function yc(e){return this._data[e]}function bc(e){for(var t=0;t<e.length;t++)this._data.push(e[t])}var Cc={arrayRows:Tc,objectRows:function(e,t,n,o){return null!=n?e[o]:e},keyedColumns:Tc,original:function(e,t,n,o){var i=Si(e);return null!=n&&i instanceof Array?i[n]:i},typedArray:Tc};function Tc(e,t,n,o){return null!=n?e[n]:e}var xc={arrayRows:Ec,objectRows:function(e,t,n,o){return _c(e[t],this._dimensionInfos[t])},keyedColumns:Ec,original:function(e,t,n,o){var i=e&&(null==e.value?e:e.value);return!this._rawData.pure&&function(e){return _i(e)&&!(e instanceof Array)}(e)&&(this.hasItemOption=!0),_c(i instanceof Array?i[o]:i,this._dimensionInfos[t])},typedArray:function(e,t,n,o){return e[o]}};function Ec(e,t,n,o){return _c(e[o],this._dimensionInfos[t])}function _c(e,t){var n=t&&t.type;if("ordinal"!==n)return"time"===n&&"number"!=typeof e&&null!=e&&"-"!==e&&(e=+kl(e)),null==e||""===e?NaN:+e;var o=t&&t.ordinalMeta;return o?o.parseAndCollect(e):e}function Ic(e,t,n){if(e){var o=e.getRawDataItem(t);if(null!=o){var i,r,a=e.getProvider().getSource().sourceFormat,s=e.getDimensionInfo(n);return s&&(i=s.name,r=s.index),Cc[a](o,t,r,i)}}}function Dc(e,t,n){if(e){var o=e.getProvider().getSource().sourceFormat;if(o===Tu||o===Eu){var i=e.getRawDataItem(t);return o!==Tu||L(i)||(i=null),i?i[n]:void 0}}}var Oc=/\{@(.+?)\}/g,wc={getDataParams:function(e,t){var n=this.getData(t),o=this.getRawValue(e,t),i=n.getRawIndex(e),r=n.getName(e),a=n.getRawDataItem(e),s=n.getItemVisual(e,"color"),l=n.getItemVisual(e,"borderColor"),u=this.ecModel.getComponent("tooltip"),c=Vi(u&&u.get("renderMode")),d=this.mainType,f="series"===d,h=n.userOutput;return{componentType:d,componentSubType:this.subType,componentIndex:this.componentIndex,seriesType:f?this.subType:null,seriesIndex:this.seriesIndex,seriesId:f?this.id:null,seriesName:f?this.name:null,name:r,dataIndex:i,data:a,dataType:t,value:o,color:s,borderColor:l,dimensionNames:h?h.dimensionNames:null,encode:h?h.encode:null,marker:Gl({color:s,renderMode:c}),$vars:["seriesName","name","value"]}},getFormattedLabel:function(e,t,n,o,i){t=t||"normal";var r=this.getData(n),a=r.getItemModel(e),s=this.getDataParams(e,n);null!=o&&s.value instanceof Array&&(s.value=s.value[o]);var l=a.get("normal"===t?[i||"label","formatter"]:[t,i||"label","formatter"]);return"function"==typeof l?(s.status=t,s.dimensionIndex=o,l(s)):"string"==typeof l?ql(l,s).replace(Oc,(function(t,n){var o=n.length;return"["===n.charAt(0)&&"]"===n.charAt(o-1)&&(n=+n.slice(1,o-1)),Ic(r,e,n)})):void 0},getRawValue:function(e,t){return Ic(this.getData(t),e)},formatTooltip:function(){}};function Rc(e){return new Sc(e)}function Sc(e){this._reset=(e=e||{}).reset,this._plan=e.plan,this._count=e.count,this._onDirty=e.onDirty,this._dirty=!0}var kc=Sc.prototype;kc.perform=function(e){var t,n=this._upstream,o=e&&e.skip;if(this._dirty&&n){var i=this.context;i.data=i.outputData=n.context.outputData}this.__pipeline&&(this.__pipeline.currentTask=this),this._plan&&!o&&(t=this._plan(this.context));var r,a=c(this._modBy),s=this._modDataCount||0,l=c(e&&e.modBy),u=e&&e.modDataCount||0;function c(e){return 1<=e||(e=1),e}a===l&&s===u||(t="reset"),!this._dirty&&"reset"!==t||(this._dirty=!1,r=function(e,t){var n,o;e._dueIndex=e._outputDueEnd=e._dueEnd=0,e._settedOutputEnd=null,!t&&e._reset&&((n=e._reset(e.context))&&n.progress&&(o=n.forceFirstProgress,n=n.progress),M(n)&&!n.length&&(n=null)),e._progress=n,e._modBy=e._modDataCount=null;var i=e._downstream;return i&&i.dirty(),o}(this,o)),this._modBy=l,this._modDataCount=u;var d=e&&e.step;if(this._dueEnd=n?n._outputDueEnd:this._count?this._count(this.context):1/0,this._progress){var f=this._dueIndex,h=Math.min(null!=d?this._dueIndex+d:1/0,this._dueEnd);if(!o&&(r||f<h)){var g=this._progress;if(M(g))for(var m=0;m<g.length;m++)Vc(this,g[m],f,h,l,u);else Vc(this,g,f,h,l,u)}this._dueIndex=h,this._outputDueEnd=null!=this._settedOutputEnd?this._settedOutputEnd:h}else this._dueIndex=this._outputDueEnd=null!=this._settedOutputEnd?this._settedOutputEnd:this._dueEnd;return this.unfinished()};var Ac,Nc,Mc,Kc,Pc,Lc,Bc=Lc={reset:function(e,t,n,o){Nc=e,Ac=t,Mc=n,Kc=o,Pc=Math.ceil(Kc/Mc),Lc.next=1<Mc&&0<Kc?zc:Fc}};function Fc(){return Nc<Ac?Nc++:null}function zc(){var e=Nc%Pc*Mc+Math.ceil(Nc/Pc),t=Ac<=Nc?null:e<Kc?e:Nc;return Nc++,t}function Vc(e,t,n,o,i,r){Bc.reset(n,o,i,r),e._callingProgress=t,e._callingProgress({start:n,end:o,count:o-n,next:Bc.next},e.context)}kc.dirty=function(){this._dirty=!0,this._onDirty&&this._onDirty(this.context)},kc.unfinished=function(){return this._progress&&this._dueIndex<this._dueEnd},kc.pipe=function(e){this._downstream===e&&!this._dirty||((this._downstream=e)._upstream=this,e.dirty())},kc.dispose=function(){this._disposed||(this._upstream&&(this._upstream._downstream=null),this._downstream&&(this._downstream._upstream=null),this._dirty=!1,this._disposed=!0)},kc.getUpstream=function(){return this._upstream},kc.getDownstream=function(){return this._downstream},kc.setOutputEnd=function(e){this._outputDueEnd=this._settedOutputEnd=e};var Hc=Pi(),Wc=mu.extend({type:"series.__base__",seriesIndex:0,coordinateSystem:null,defaultOption:null,legendVisualProvider:null,visualColorAccessPath:"itemStyle.color",visualBorderColorAccessPath:"itemStyle.borderColor",layoutMode:null,init:function(e,t,n,o){this.seriesIndex=this.componentIndex,this.dataTask=Rc({count:Uc,reset:qc}),this.dataTask.context={model:this},this.mergeDefaultAndTheme(e,n),ku(this);var i=this.getInitialData(e,n);Gc(i,this),this.dataTask.context.data=i,Hc(this).dataBeforeProcessed=i,$c(this)},mergeDefaultAndTheme:function(e,t){var n=this.layoutMode,o=n?uu(e):{},i=this.subType;mu.hasClass(i)&&(i+="Series"),v(e,t.getTheme().get(this.subType)),v(e,this.getDefaultOption()),wi(e,"label",["show"]),this.fillDataTextStyle(e.data),n&&lu(e,o,n)},mergeOption:function(e,t){e=v(this.option,e,!0),this.fillDataTextStyle(e.data);var n=this.layoutMode;n&&lu(this.option,e,n),ku(this);var o=this.getInitialData(e,t);Gc(o,this),this.dataTask.dirty(),this.dataTask.context.data=o,Hc(this).dataBeforeProcessed=o,$c(this)},fillDataTextStyle:function(e){if(e&&!F(e))for(var t=["show"],n=0;n<e.length;n++)e[n]&&e[n].label&&wi(e[n],"label",t)},getInitialData:function(){},appendData:function(e){this.getRawData().appendData(e.data)},getData:function(e){var t=Yc(this);if(t){var n=t.context.data;return null==e?n:n.getLinkedData(e)}return Hc(this).data},setData:function(e){var t=Yc(this);if(t){var n=t.context;n.data!==e&&t.modifyOutputEnd&&t.setOutputEnd(e.count()),n.outputData=e,t!==this.dataTask&&(n.data=e)}Hc(this).data=e},getSource:function(){return function(e){return Su(e).source}(this)},getRawData:function(){return Hc(this).dataBeforeProcessed},getBaseAxis:function(){var e=this.coordinateSystem;return e&&e.getBaseAxis&&e.getBaseAxis()},formatTooltip:function(e,t,n,o){var i=this,r="html"===(o=o||"html")?"<br/>":"\n",a="richText"===o,s={},l=0,u=this.getData(),c=u.mapDimension("defaultedTooltip",!0),d=c.length,f=this.getRawValue(e),h=M(f),g=u.getItemVisual(e,"color");L(g)&&g.colorStops&&(g=(g.colorStops[0]||{}).color),g=g||"transparent";var m=(1<d||h&&!d?function(n){var r=R(n,(function(e,t,n){var o=u.getDimensionInfo(n);return e|(o&&!1!==o.tooltip&&null!=o.displayName)}),0),d=[];function f(e,n){var c=u.getDimensionInfo(n);if(c&&!1!==c.otherDims.tooltip){var f=c.type,h="sub"+i.seriesIndex+"at"+l,m=Gl({color:g,type:"subItem",renderMode:o,markerId:h}),p=(r?("string"==typeof m?m:m.content)+Wl(c.displayName||"-")+": ":"")+Wl("ordinal"===f?e+"":"time"===f?t?"":Yl("yyyy/MM/dd hh:mm:ss",e):Bl(e));p&&d.push(p),a&&(s[h]=g,++l)}}c.length?O(c,(function(t){f(Ic(u,e,t),t)})):O(n,f);var h=r?a?"\n":"<br/>":"",m=h+d.join(h||", ");return{renderMode:o,content:m,style:s}}(f):function(e){return{renderMode:o,content:Wl(Bl(e)),style:s}}(d?Ic(u,e,c[0]):h?f[0]:f)).content,p=i.seriesIndex+"at"+l,v=Gl({color:g,type:"item",renderMode:o,markerId:p});s[p]=g,++l;var y=u.getName(e),b=this.name;Ni(this)||(b=""),b=b?Wl(b)+(t?": ":r):"";var C="string"==typeof v?v:v.content;return{html:t?C+b+m:b+C+(y?Wl(y)+": "+m:m),markers:s}},isAnimationEnabled:function(){if(i.node)return!1;var e=this.getShallow("animation");return e&&this.getData().count()>this.getShallow("animationThreshold")&&(e=!1),e},restoreData:function(){this.dataTask.dirty()},getColorFromPalette:function(e,t,n){var o=this.ecModel;return Cu.getColorFromPalette.call(this,e,t,n)||o.getColorFromPalette(e,t,n)},coordDimToDataDim:function(e){return this.getRawData().mapDimension(e,!0)},getProgressive:function(){return this.get("progressive")},getProgressiveThreshold:function(){return this.get("progressiveThreshold")},getAxisTooltipData:null,getTooltipPosition:null,pipeTask:null,preventIncremental:null,pipelineContext:null});function $c(e){var t=e.name;Ni(e)||(e.name=function(e){var t=e.getRawData(),n=t.mapDimension("seriesName",!0),o=[];return O(n,(function(e){var n=t.getDimensionInfo(e);n.displayName&&o.push(n.displayName)})),o.join(" ")}(e)||t)}function Uc(e){return e.model.getRawData().count()}function qc(e){var t=e.model;return t.setData(t.getRawData().cloneShallow()),jc}function jc(e,t){t.outputData&&e.end>t.outputData.count()&&t.model.getRawData().cloneShallow(t.outputData)}function Gc(e,t){O(e.CHANGABLE_METHODS,(function(n){e.wrapMethod(n,N(Xc,t))}))}function Xc(e){var t=Yc(e);t&&t.setOutputEnd(this.count())}function Yc(e){var t=(e.ecModel||{}).scheduler,n=t&&t.getPipeline(e.uid);if(n){var o=n.currentTask;if(o){var i=o.agentStubMap;i&&(o=i.get(e.uid))}return o}}I(Wc,wc),I(Wc,Cu);var Zc=function(){this.group=new _n,this.uid=vl("viewComponent")},Jc=Zc.prototype={constructor:Zc,init:function(e,t){},render:function(e,t,n,o){},dispose:function(){},filterForExposedEvent:null};function Qc(){var e=Pi();return function(t){var n=e(t),o=t.pipelineContext,i=n.large,r=n.progressiveRender,a=n.large=o&&o.large,s=n.progressiveRender=o&&o.progressiveRender;return!!(i^a||r^s)&&"reset"}}Jc.updateView=Jc.updateLayout=Jc.updateVisual=function(e,t,n,o){},Ui(Zc),Yi(Zc,{registerWhenExtend:!0});var ed=Pi(),td=Qc();function nd(){this.group=new _n,this.uid=vl("viewChart"),this.renderTask=Rc({plan:ad,reset:sd}),this.renderTask.context={view:this}}var od=nd.prototype={type:"chart",init:function(e,t){},render:function(e,t,n,o){},highlight:function(e,t,n,o){rd(e.getData(),o,"emphasis")},downplay:function(e,t,n,o){rd(e.getData(),o,"normal")},remove:function(e,t){this.group.removeAll()},dispose:function(){},incrementalPrepareRender:null,incrementalRender:null,updateTransform:null,filterForExposedEvent:null};function id(e,t,n){if(e&&(e.trigger(t,n),e.isGroup&&!Ls(e)))for(var o=0,i=e.childCount();o<i;o++)id(e.childAt(o),t,n)}function rd(e,t,n){var o=Ki(e,t),i=t&&null!=t.highlightKey?Bs(t.highlightKey):null;null!=o?O(Oi(o),(function(t){id(e.getItemGraphicEl(t),n,i)})):e.eachItemGraphicEl((function(e){id(e,n,i)}))}function ad(e){return td(e.model)}function sd(e){var t=e.model,n=e.ecModel,o=e.api,i=e.payload,r=t.pipelineContext.progressiveRender,a=e.view,s=i&&ed(i).updateMethod,l=r?"incrementalPrepareRender":s&&a[s]?s:"render";return"render"!==l&&a[l](t,n,o,i),ld[l]}od.updateView=od.updateLayout=od.updateVisual=function(e,t,n,o){this.render(e,t,n,o)},Ui(nd),Yi(nd,{registerWhenExtend:!0}),nd.markUpdateMethod=function(e,t){ed(e).updateMethod=t};var ld={incrementalPrepareRender:{progress:function(e,t){t.view.incrementalRender(e,t.model,t.ecModel,t.api,t.payload)}},render:{forceFirstProgress:!0,progress:function(e,t){t.view.render(t.model,t.ecModel,t.api,t.payload)}}},ud="\0__throttleOriginMethod",cd="\0__throttleRate",dd="\0__throttleType";function fd(e,t,n){var o,i,r,a,s,l=0,u=0,c=null;function d(){u=(new Date).getTime(),c=null,e.apply(r,a||[])}function f(){o=(new Date).getTime(),r=this,a=arguments;var e=s||t,f=s||n;s=null,i=o-(f?l:u)-e,clearTimeout(c),f?c=setTimeout(d,e):0<=i?d():c=setTimeout(d,-i),l=o}return t=t||0,f.clear=function(){c&&(clearTimeout(c),c=null)},f.debounceNextCall=function(e){s=e},f}function hd(e,t,n,o){var i=e[t];if(i){var r=i[ud]||i;if(i[cd]!==n||i[dd]!==o){if(null==n||!o)return e[t]=r;(i=e[t]=fd(r,n,"debounce"===o))[ud]=r,i[dd]=o,i[cd]=n}return i}}function gd(e,t){var n=e[t];n&&n[ud]&&(e[t]=n[ud])}var md={createOnAllSeries:!0,performRawSeries:!0,reset:function(e,t){var n=e.getData(),o=(e.visualColorAccessPath||"itemStyle.color").split("."),i=e.get(o),r=!K(i)||i instanceof Ya?null:i;i&&!r||(i=e.getColorFromPalette(e.name,null,t.getSeriesCount())),n.setVisual("color",i);var a=(e.visualBorderColorAccessPath||"itemStyle.borderColor").split("."),s=e.get(a);if(n.setVisual("borderColor",s),!t.isSeriesFiltered(e))return r&&n.each((function(t){n.setItemVisual(t,"color",r(e.getDataParams(t)))})),{dataEach:n.hasItemOption?function(e,t){var n=e.getItemModel(t),i=n.get(o,!0),r=n.get(a,!0);null!=i&&e.setItemVisual(t,"color",i),null!=r&&e.setItemVisual(t,"borderColor",r)}:null}}},pd={legend:{selector:{all:"全选",inverse:"反选"}},toolbox:{brush:{title:{rect:"矩形选择",polygon:"圈选",lineX:"横向选择",lineY:"纵向选择",keep:"保持选择",clear:"清除选择"}},dataView:{title:"数据视图",lang:["数据视图","关闭","刷新"]},dataZoom:{title:{zoom:"区域缩放",back:"区域缩放还原"}},magicType:{title:{line:"切换为折线图",bar:"切换为柱状图",stack:"切换为堆叠",tiled:"切换为平铺"}},restore:{title:"还原"},saveAsImage:{title:"保存为图片",lang:["右键另存为图片"]}},series:{typeNames:{pie:"饼图",bar:"柱状图",line:"折线图",scatter:"散点图",effectScatter:"涟漪散点图",radar:"雷达图",tree:"树图",treemap:"矩形树图",boxplot:"箱型图",candlestick:"K线图",k:"K线图",heatmap:"热力图",map:"地图",parallel:"平行坐标图",lines:"线图",graph:"关系图",sankey:"桑基图",funnel:"漏斗图",gauge:"仪表盘图",pictorialBar:"象形柱图",themeRiver:"主题河流图",sunburst:"旭日图"}},aria:{general:{withTitle:"这是一个关于“{title}”的图表。",withoutTitle:"这是一个图表，"},series:{single:{prefix:"",withName:"图表类型是{seriesType}，表示{seriesName}。",withoutName:"图表类型是{seriesType}。"},multiple:{prefix:"它由{seriesCount}个图表系列组成。",withName:"第{seriesId}个系列是一个表示{seriesName}的{seriesType}，",withoutName:"第{seriesId}个系列是一个{seriesType}，",separator:{middle:"；",end:"。"}}},data:{allData:"其数据是——",partialData:"其中，前{displayCnt}项是——",withName:"{name}的数据是{value}",withoutName:"{value}",separator:{middle:"，",end:""}}}},vd=Math.PI;function yd(e,t,n,o){this.ecInstance=e,this.api=t,n=this._dataProcessorHandlers=n.slice(),o=this._visualHandlers=o.slice(),this._allHandlers=n.concat(o),this._stageTaskMap=Q()}var bd=yd.prototype;function Cd(e,t,n,o,i){var r;function a(e,t){return e.setDirty&&(!e.dirtyMap||e.dirtyMap.get(t.__pipeline.id))}i=i||{},O(t,(function(t,s){if(!i.visualType||i.visualType===t.visualType){var l=e._stageTaskMap.get(t.uid),u=l.seriesTaskMap,c=l.overallTask;if(c){var d,f=c.agentStubMap;f.each((function(e){a(i,e)&&(e.dirty(),d=!0)})),d&&c.dirty(),Td(c,o);var h=e.getPerformArgs(c,i.block);f.each((function(e){e.perform(h)})),r|=c.perform(h)}else u&&u.each((function(s,l){a(i,s)&&s.dirty();var u=e.getPerformArgs(s,i.block);u.skip=!t.performRawSeries&&n.isSeriesFiltered(s.context.model),Td(s,o),r|=s.perform(u)}))}})),e.unfinished|=r}bd.restoreData=function(e,t){e.restoreData(t),this._stageTaskMap.each((function(e){var t=e.overallTask;t&&t.dirty()}))},bd.getPerformArgs=function(e,t){if(e.__pipeline){var n=this._pipelineMap.get(e.__pipeline.id),o=n.context,i=!t&&n.progressiveEnabled&&(!o||o.progressiveRender)&&e.__idxInPipeline>n.blockIndex?n.step:null,r=o&&o.modDataCount;return{step:i,modBy:null!=r?Math.ceil(r/i):null,modDataCount:r}}},bd.getPipeline=function(e){return this._pipelineMap.get(e)},bd.updateStreamModes=function(e,t){var n=this._pipelineMap.get(e.uid),o=e.getData().count(),i=n.progressiveEnabled&&t.incrementalPrepareRender&&o>=n.threshold,r=e.get("large")&&o>=e.get("largeThreshold"),a="mod"===e.get("progressiveChunkMode")?o:null;e.pipelineContext=n.context={progressiveRender:i,modDataCount:a,large:r}},bd.restorePipelines=function(e){var t=this,n=t._pipelineMap=Q();e.eachSeries((function(e){var o=e.getProgressive(),i=e.uid;n.set(i,{id:i,head:null,tail:null,threshold:e.getProgressiveThreshold(),progressiveEnabled:o&&!(e.preventIncremental&&e.preventIncremental()),blockIndex:-1,step:Math.round(o||700),count:0}),kd(t,e,e.dataTask)}))},bd.prepareStageTasks=function(){var e=this._stageTaskMap,t=this.ecInstance.getModel(),n=this.api;O(this._allHandlers,(function(o){var i=e.get(o.uid)||e.set(o.uid,[]);o.reset&&function(e,t,n,o,i){var r=n.seriesTaskMap||(n.seriesTaskMap=Q()),a=t.seriesType,s=t.getTargetSeries;function l(n){var a=n.uid,s=r.get(a)||r.set(a,Rc({plan:Dd,reset:Od,count:Sd}));s.context={model:n,ecModel:o,api:i,useClearVisual:t.isVisual&&!t.isLayout,plan:t.plan,reset:t.reset,scheduler:e},kd(e,n,s)}t.createOnAllSeries?o.eachRawSeries(l):a?o.eachRawSeriesByType(a,l):s&&s(o,i).each(l);var u=e._pipelineMap;r.each((function(e,t){u.get(t)||(e.dispose(),r.removeKey(t))}))}(this,o,i,t,n),o.overallReset&&function(e,t,n,o,i){var r=n.overallTask=n.overallTask||Rc({reset:xd});r.context={ecModel:o,api:i,overallReset:t.overallReset,scheduler:e};var a=r.agentStubMap=r.agentStubMap||Q(),s=t.seriesType,l=t.getTargetSeries,u=!0,c=t.modifyOutputEnd;function d(t){var n=t.uid,o=a.get(n);o||(o=a.set(n,Rc({reset:Ed,onDirty:Id})),r.dirty()),o.context={model:t,overallProgress:u,modifyOutputEnd:c},o.agent=r,o.__block=u,kd(e,t,o)}s?o.eachRawSeriesByType(s,d):l?l(o,i).each(d):(u=!1,O(o.getSeries(),d));var f=e._pipelineMap;a.each((function(e,t){f.get(t)||(e.dispose(),r.dirty(),a.removeKey(t))}))}(this,o,i,t,n)}),this)},bd.prepareView=function(e,t,n,o){var i=e.renderTask,r=i.context;r.model=t,r.ecModel=n,r.api=o,i.__block=!e.incrementalPrepareRender,kd(this,t,i)},bd.performDataProcessorTasks=function(e,t){Cd(this,this._dataProcessorHandlers,e,t,{block:!0})},bd.performVisualTasks=function(e,t,n){Cd(this,this._visualHandlers,e,t,n)},bd.performSeriesTasks=function(e){var t;e.eachSeries((function(e){t|=e.dataTask.perform()})),this.unfinished|=t},bd.plan=function(){this._pipelineMap.each((function(e){var t=e.tail;do{if(t.__block){e.blockIndex=t.__idxInPipeline;break}t=t.getUpstream()}while(t)}))};var Td=bd.updatePayload=function(e,t){"remain"!==t&&(e.context.payload=t)};function xd(e){e.overallReset(e.ecModel,e.api,e.payload)}function Ed(e,t){return e.overallProgress&&_d}function _d(){this.agent.dirty(),this.getDownstream().dirty()}function Id(){this.agent&&this.agent.dirty()}function Dd(e){return e.plan&&e.plan(e.model,e.ecModel,e.api,e.payload)}function Od(e){e.useClearVisual&&e.data.clearAllVisual();var t=e.resetDefines=Oi(e.reset(e.model,e.ecModel,e.api,e.payload));return 1<t.length?w(t,(function(e,t){return Rd(t)})):wd}var wd=Rd(0);function Rd(e){return function(t,n){var o=n.data,i=n.resetDefines[e];if(i&&i.dataEach)for(var r=t.start;r<t.end;r++)i.dataEach(o,r);else i&&i.progress&&i.progress(t,o)}}function Sd(e){return e.data.count()}function kd(e,t,n){var o=e._pipelineMap.get(t.uid);o.head||(o.head=n),o.tail&&o.tail.pipe(n),(o.tail=n).__idxInPipeline=o.count++,n.__pipeline=o}yd.wrapStageHandler=function(e,t){return K(e)&&(e={overallReset:e,seriesType:function(e){Ad=null;try{e(Nd,Md)}catch(e){}return Ad}(e)}),e.uid=vl("stageHandler"),t&&(e.visualType=t),e};var Ad,Nd={},Md={};function Kd(e,t){for(var n in t.prototype)e[n]=te}function Pd(){return{axisLine:{lineStyle:{color:Fd}},axisTick:{lineStyle:{color:Fd}},axisLabel:{textStyle:{color:Fd}},splitLine:{lineStyle:{type:"dashed",color:"#aaa"}},splitArea:{areaStyle:{color:Fd}}}}Kd(Nd,Fu),Kd(Md,Wu),Nd.eachSeriesByType=Nd.eachRawSeriesByType=function(e){Ad=e},Nd.eachComponent=function(e){"series"===e.mainType&&e.subType&&(Ad=e.subType)};var Ld=["#37A2DA","#32C5E9","#67E0E3","#9FE6B8","#FFDB5C","#ff9f7f","#fb7293","#E062AE","#E690D1","#e7bcf3","#9d96f5","#8378EA","#96BFFF"],Bd={color:Ld,colorLayer:[["#37A2DA","#ffd85c","#fd7b5f"],["#37A2DA","#67E0E3","#FFDB5C","#ff9f7f","#E062AE","#9d96f5"],["#37A2DA","#32C5E9","#9FE6B8","#FFDB5C","#ff9f7f","#fb7293","#e7bcf3","#8378EA","#96BFFF"],Ld]},Fd="#eee",zd=["#dd6b66","#759aa0","#e69d87","#8dc1a9","#ea7e53","#eedd78","#73a373","#73b9bc","#7289ab","#91ca8c","#f49f42"],Vd={color:zd,backgroundColor:"#333",tooltip:{axisPointer:{lineStyle:{color:Fd},crossStyle:{color:Fd},label:{color:"#000"}}},legend:{textStyle:{color:Fd}},textStyle:{color:Fd},title:{textStyle:{color:Fd}},toolbox:{iconStyle:{normal:{borderColor:Fd}}},dataZoom:{textStyle:{color:Fd}},visualMap:{textStyle:{color:Fd}},timeline:{lineStyle:{color:Fd},itemStyle:{normal:{color:zd[1]}},label:{normal:{textStyle:{color:Fd}}},controlStyle:{normal:{color:Fd,borderColor:Fd}}},timeAxis:Pd(),logAxis:Pd(),valueAxis:Pd(),categoryAxis:Pd(),line:{symbol:"circle"},graph:{color:zd},gauge:{title:{textStyle:{color:Fd}}},candlestick:{itemStyle:{normal:{color:"#FD1050",color0:"#0CF49B",borderColor:"#FD1050",borderColor0:"#0CF49B"}}}};Vd.categoryAxis.splitLine.show=!1,mu.extend({type:"dataset",defaultOption:{seriesLayoutBy:Ou,sourceHeader:null,dimensions:null,source:null},optionUpdated:function(){!function(e){var t=e.option.source,n=Iu;if(F(t))n=Du;else if(M(t)){0===t.length&&(n=xu);for(var o=0,i=t.length;o<i;o++){var r=t[o];if(null!=r){if(M(r)){n=xu;break}if(L(r)){n=Eu;break}}}}else if(L(t)){for(var a in t)if(t.hasOwnProperty(a)&&D(t[a])){n=_u;break}}else if(null!=t)throw new Error("Invalid data");Su(e).sourceFormat=n}(this)}}),Zc.extend({type:"dataset"});var Hd=ha.extend({type:"ellipse",shape:{cx:0,cy:0,rx:0,ry:0},buildPath:function(e,t){var n=t.cx,o=t.cy,i=t.rx,r=t.ry,a=.5522848*i,s=.5522848*r;e.moveTo(n-i,o),e.bezierCurveTo(n-i,o-s,n-a,o-r,n,o-r),e.bezierCurveTo(n+a,o-r,n+i,o-s,n+i,o),e.bezierCurveTo(n+i,o+s,n+a,o+r,n,o+r),e.bezierCurveTo(n-a,o+r,n-i,o+s,n-i,o),e.closePath()}}),Wd=/[\s,]+/;function $d(e){for(P(e)&&(e=(new DOMParser).parseFromString(e,"text/xml")),9===e.nodeType&&(e=e.firstChild);"svg"!==e.nodeName.toLowerCase()||1!==e.nodeType;)e=e.nextSibling;return e}function Ud(){this._defs={},this._root=null,this._isDefine=!1,this._isText=!1}Ud.prototype.parse=function(e,t){t=t||{};var n=$d(e);if(!n)throw new Error("Illegal svg");var o=new _n;this._root=o;var i=n.getAttribute("viewBox")||"",r=parseFloat(n.getAttribute("width")||t.width),a=parseFloat(n.getAttribute("height")||t.height);isNaN(r)&&(r=null),isNaN(a)&&(a=null),Zd(n,o,null,!0);for(var s,l,u=n.firstChild;u;)this._parseNode(u,o),u=u.nextSibling;if(i){var c=G(i).split(Wd);4<=c.length&&(s={x:parseFloat(c[0]||0),y:parseFloat(c[1]||0),width:parseFloat(c[2]),height:parseFloat(c[3])})}if(s&&null!=r&&null!=a&&(l=nf(s,r,a),!t.ignoreViewBox)){var d=o;(o=new _n).add(d),d.scale=l.scale.slice(),d.position=l.position.slice()}return t.ignoreRootClip||null==r||null==a||o.setClipPath(new Ua({shape:{x:0,y:0,width:r,height:a}})),{root:o,width:r,height:a,viewBoxRect:s,viewBoxTransform:l}},Ud.prototype._parseNode=function(e,t){var n,o,i=e.nodeName.toLowerCase();if("defs"===i?this._isDefine=!0:"text"===i&&(this._isText=!0),this._isDefine){if(o=jd[i]){var r=o.call(this,e),a=e.getAttribute("id");a&&(this._defs[a]=r)}}else(o=qd[i])&&(n=o.call(this,e,t),t.add(n));for(var s=e.firstChild;s;)1===s.nodeType&&this._parseNode(s,n),3===s.nodeType&&this._isText&&this._parseText(s,n),s=s.nextSibling;"defs"===i?this._isDefine=!1:"text"===i&&(this._isText=!1)},Ud.prototype._parseText=function(e,t){if(1===e.nodeType){var n=e.getAttribute("dx")||0,o=e.getAttribute("dy")||0;this._textX+=parseFloat(n),this._textY+=parseFloat(o)}var i=new Sa({style:{text:e.textContent,transformText:!0},position:[this._textX||0,this._textY||0]});Gd(t,i),Zd(e,i,this._defs);var r=i.style.fontSize;r&&r<9&&(i.style.fontSize=9,i.scale=i.scale||[1,1],i.scale[0]*=r/9,i.scale[1]*=r/9);var a=i.getBoundingRect();return this._textX+=a.width,t.add(i),i};var qd={g:function(e,t){var n=new _n;return Gd(t,n),Zd(e,n,this._defs),n},rect:function(e,t){var n=new Ua;return Gd(t,n),Zd(e,n,this._defs),n.setShape({x:parseFloat(e.getAttribute("x")||0),y:parseFloat(e.getAttribute("y")||0),width:parseFloat(e.getAttribute("width")||0),height:parseFloat(e.getAttribute("height")||0)}),n},circle:function(e,t){var n=new Aa;return Gd(t,n),Zd(e,n,this._defs),n.setShape({cx:parseFloat(e.getAttribute("cx")||0),cy:parseFloat(e.getAttribute("cy")||0),r:parseFloat(e.getAttribute("r")||0)}),n},line:function(e,t){var n=new ja;return Gd(t,n),Zd(e,n,this._defs),n.setShape({x1:parseFloat(e.getAttribute("x1")||0),y1:parseFloat(e.getAttribute("y1")||0),x2:parseFloat(e.getAttribute("x2")||0),y2:parseFloat(e.getAttribute("y2")||0)}),n},ellipse:function(e,t){var n=new Hd;return Gd(t,n),Zd(e,n,this._defs),n.setShape({cx:parseFloat(e.getAttribute("cx")||0),cy:parseFloat(e.getAttribute("cy")||0),rx:parseFloat(e.getAttribute("rx")||0),ry:parseFloat(e.getAttribute("ry")||0)}),n},polygon:function(e,t){var n=e.getAttribute("points");n=n&&Xd(n);var o=new Ba({shape:{points:n||[]}});return Gd(t,o),Zd(e,o,this._defs),o},polyline:function(e,t){var n=new ha;Gd(t,n),Zd(e,n,this._defs);var o=e.getAttribute("points");return o=o&&Xd(o),new Fa({shape:{points:o||[]}})},image:function(e,t){var n=new Wo;return Gd(t,n),Zd(e,n,this._defs),n.setStyle({image:e.getAttribute("xlink:href"),x:e.getAttribute("x"),y:e.getAttribute("y"),width:e.getAttribute("width"),height:e.getAttribute("height")}),n},text:function(e,t){var n=e.getAttribute("x")||0,o=e.getAttribute("y")||0,i=e.getAttribute("dx")||0,r=e.getAttribute("dy")||0;this._textX=parseFloat(n)+parseFloat(i),this._textY=parseFloat(o)+parseFloat(r);var a=new _n;return Gd(t,a),Zd(e,a,this._defs),a},tspan:function(e,t){var n=e.getAttribute("x"),o=e.getAttribute("y");null!=n&&(this._textX=parseFloat(n)),null!=o&&(this._textY=parseFloat(o));var i=e.getAttribute("dx")||0,r=e.getAttribute("dy")||0,a=new _n;return Gd(t,a),Zd(e,a,this._defs),this._textX+=i,this._textY+=r,a},path:function(e,t){var n=Ra(e.getAttribute("d")||"");return Gd(t,n),Zd(e,n,this._defs),n}},jd={lineargradient:function(e){var t=new es(parseInt(e.getAttribute("x1")||0,10),parseInt(e.getAttribute("y1")||0,10),parseInt(e.getAttribute("x2")||10,10),parseInt(e.getAttribute("y2")||0,10));return function(e,t){for(var n=e.firstChild;n;){if(1===n.nodeType){var o=n.getAttribute("offset");o=0<o.indexOf("%")?parseInt(o,10)/100:o?parseFloat(o):0;var i=n.getAttribute("stop-color")||"#000000";t.addColorStop(o,i)}n=n.nextSibling}}(e,t),t},radialgradient:function(e){}};function Gd(e,t){e&&e.__inheritedStyle&&(t.__inheritedStyle||(t.__inheritedStyle={}),C(t.__inheritedStyle,e.__inheritedStyle))}function Xd(e){for(var t=G(e).split(Wd),n=[],o=0;o<t.length;o+=2){var i=parseFloat(t[o]),r=parseFloat(t[o+1]);n.push([i,r])}return n}var Yd={fill:"fill",stroke:"stroke","stroke-width":"lineWidth",opacity:"opacity","fill-opacity":"fillOpacity","stroke-opacity":"strokeOpacity","stroke-dasharray":"lineDash","stroke-dashoffset":"lineDashOffset","stroke-linecap":"lineCap","stroke-linejoin":"lineJoin","stroke-miterlimit":"miterLimit","font-family":"fontFamily","font-size":"fontSize","font-style":"fontStyle","font-weight":"fontWeight","text-align":"textAlign","alignment-baseline":"textBaseline"};function Zd(e,t,n,o){var i=t.__inheritedStyle||{},r="text"===t.type;if(1===e.nodeType&&(function(e,t){var n=e.getAttribute("transform");if(n){n=n.replace(/,/g," ");var o=null,i=[];n.replace(ef,(function(e,t,n){i.push(t,n)}));for(var r=i.length-1;0<r;r-=2){var a=i[r],s=i[r-1];switch(o=o||ot(),s){case"translate":a=G(a).split(Wd),st(o,o,[parseFloat(a[0]),parseFloat(a[1]||0)]);break;case"scale":a=G(a).split(Wd),ut(o,o,[parseFloat(a[0]),parseFloat(a[1]||a[0])]);break;case"rotate":a=G(a).split(Wd),lt(o,o,parseFloat(a[0]));break;case"skew":a=G(a).split(Wd),console.warn("Skew transform is not supported yet");break;case"matrix":a=G(a).split(Wd),o[0]=parseFloat(a[0]),o[1]=parseFloat(a[1]),o[2]=parseFloat(a[2]),o[3]=parseFloat(a[3]),o[4]=parseFloat(a[4]),o[5]=parseFloat(a[5])}}t.setLocalTransform(o)}}(e,t),b(i,function(e){var t=e.getAttribute("style"),n={};if(!t)return n;var o,i={};for(tf.lastIndex=0;null!=(o=tf.exec(t));)i[o[1]]=o[2];for(var r in Yd)Yd.hasOwnProperty(r)&&null!=i[r]&&(n[Yd[r]]=i[r]);return n}(e)),!o))for(var a in Yd)if(Yd.hasOwnProperty(a)){var s=e.getAttribute(a);null!=s&&(i[Yd[a]]=s)}var l=r?"textFill":"fill",u=r?"textStroke":"stroke";t.style=t.style||new Pn;var c=t.style;null!=i.fill&&c.set(l,Qd(i.fill,n)),null!=i.stroke&&c.set(u,Qd(i.stroke,n)),O(["lineWidth","opacity","fillOpacity","strokeOpacity","miterLimit","fontSize"],(function(e){null!=i[e]&&c.set("lineWidth"===e&&r?"textStrokeWidth":e,parseFloat(i[e]))})),i.textBaseline&&"auto"!==i.textBaseline||(i.textBaseline="alphabetic"),"alphabetic"===i.textBaseline&&(i.textBaseline="bottom"),"start"===i.textAlign&&(i.textAlign="left"),"end"===i.textAlign&&(i.textAlign="right"),O(["lineDashOffset","lineCap","lineJoin","fontWeight","fontFamily","fontStyle","textAlign","textBaseline"],(function(e){null!=i[e]&&c.set(e,i[e])})),i.lineDash&&(t.style.lineDash=G(i.lineDash).split(Wd)),c[u]&&"none"!==c[u]&&(t[u]=!0),t.__inheritedStyle=i}var Jd=/url\(\s*#(.*?)\)/;function Qd(e,t){var n=t&&e&&e.match(Jd);return n?t[G(n[1])]:e}var ef=/(translate|scale|rotate|skewX|skewY|matrix)\(([\-\s0-9\.e,]*)\)/g,tf=/([^\s:;]+)\s*:\s*([^:;]+)/g;function nf(e,t,n){var o=Math.min(t/e.width,n/e.height);return{scale:[o,o],position:[-(e.x+e.width/2)*o+t/2,-(e.y+e.height/2)*o+n/2]}}var of=Q(),rf=function(e){return of.get(e)},af={geoJSON:function(e){var t=e.source;e.geoJSON=P(t)?"undefined"!=typeof JSON&&JSON.parse?JSON.parse(t):new Function("return ("+t+");")():t},svg:function(e){e.svgXML=$d(e.source)}},sf=j,lf=O,uf=K,cf=L,df=mu.parseClassType,ff={PROCESSOR:{FILTER:1e3,SERIES_FILTER:800,STATISTIC:5e3},VISUAL:{LAYOUT:1e3,PROGRESSIVE_LAYOUT:1100,GLOBAL:2e3,CHART:3e3,POST_CHART_LAYOUT:3500,COMPONENT:4e3,BRUSH:5e3}},hf="__flagInMainProcess",gf="__optionUpdated",mf=/^[a-zA-Z0-9_]+$/;function pf(e,t){return function(n,o,i){!t&&this._disposed||(n=n&&n.toLowerCase(),Oe.prototype[e].call(this,n,o,i))}}function vf(){Oe.call(this)}function yf(e,t,n){n=n||{},"string"==typeof t&&(t=Hf[t]),this._dom=e;var o=this._zr=bi(e,{renderer:n.renderer||"canvas",devicePixelRatio:n.devicePixelRatio,width:n.width,height:n.height});this._throttledZrFlush=fd(A(o.flush,o),17),(t=p(t))&&fc(t,!0),this._theme=t,this._chartsViews=[],this._chartsMap={},this._componentsViews=[],this._componentsMap={},this._coordSysMgr=new Uu;var i=this._api=function(e){var t=e._coordSysMgr;return b(new Wu(e),{getCoordinateSystems:A(t.getCoordinateSystems,t),getComponentByElement:function(t){for(;t;){var n=t.__ecComponentInfo;if(null!=n)return e._model.getComponent(n.mainType,n.index);t=t.parent}}})}(this);function r(e,t){return e.__prio-t.__prio}Sn(Vf,r),Sn(Bf,r),this._scheduler=new yd(this,i,Bf,Vf),Oe.call(this,this._ecEventProcessor=new Kf),this._messageCenter=new vf,this._initEvents(),this.resize=A(this.resize,this),this._pendingActions=[],o.animation.on("frame",this._onframe,this),function(e,t){e.on("rendered",(function(){t.trigger("rendered"),!e.animation.isFinished()||t[gf]||t._scheduler.unfinished||t._pendingActions.length||t.trigger("finished")}))}(o,this),Y(this)}vf.prototype.on=pf("on",!0),vf.prototype.off=pf("off",!0),vf.prototype.one=pf("one",!0),I(vf,Oe);var bf=yf.prototype;function Cf(e,t,n){if(!this._disposed){var o,i=this._model,r=this._coordSysMgr.getCoordinateSystems();t=Bi(i,t);for(var a=0;a<r.length;a++){var s=r[a];if(s[e]&&null!=(o=s[e](i,t,n)))return o}}}bf._onframe=function(){if(!this._disposed){var e=this._scheduler;if(this[gf]){var t=this[gf].silent;this[hf]=!0,xf(this),Tf.update.call(this),this[hf]=!1,this[gf]=!1,Df.call(this,t),Of.call(this,t)}else if(e.unfinished){var n=1,o=this._model;e.unfinished=!1;do{var i=+new Date;e.performSeriesTasks(o),e.performDataProcessorTasks(o),_f(this,o),e.performVisualTasks(o),kf(this,this._model,0,"remain"),n-=+new Date-i}while(0<n&&e.unfinished);e.unfinished||this._zr.flush()}}},bf.getDom=function(){return this._dom},bf.getZr=function(){return this._zr},bf.setOption=function(e,t,n){if(!this._disposed){var o;if(cf(t)&&(n=t.lazyUpdate,o=t.silent,t=t.notMerge),this[hf]=!0,!this._model||t){var i=new Zu(this._api),r=this._theme,a=this._model=new Fu;a.scheduler=this._scheduler,a.init(null,null,r,i)}this._model.setOption(e,Ff),n?(this[gf]={silent:o},this[hf]=!1):(xf(this),Tf.update.call(this),this._zr.flush(),this[gf]=!1,this[hf]=!1,Df.call(this,o),Of.call(this,o))}},bf.setTheme=function(){console.error("ECharts#setTheme() is DEPRECATED in ECharts 3.0")},bf.getModel=function(){return this._model},bf.getOption=function(){return this._model&&this._model.getOption()},bf.getWidth=function(){return this._zr.getWidth()},bf.getHeight=function(){return this._zr.getHeight()},bf.getDevicePixelRatio=function(){return this._zr.painter.dpr||window.devicePixelRatio||1},bf.getRenderedCanvas=function(e){if(i.canvasSupported)return(e=e||{}).pixelRatio=e.pixelRatio||1,e.backgroundColor=e.backgroundColor||this._model.get("backgroundColor"),this._zr.painter.getRenderedCanvas(e)},bf.getSvgDataURL=function(){if(i.svgSupported){var e=this._zr;return O(e.storage.getDisplayList(),(function(e){e.stopAnimation(!0)})),e.painter.toDataURL()}},bf.getDataURL=function(e){if(!this._disposed){var t=(e=e||{}).excludeComponents,n=this._model,o=[],i=this;lf(t,(function(e){n.eachComponent({mainType:e},(function(e){var t=i._componentsMap[e.__viewId];t.group.ignore||(o.push(t),t.group.ignore=!0)}))}));var r="svg"===this._zr.painter.getType()?this.getSvgDataURL():this.getRenderedCanvas(e).toDataURL("image/"+(e&&e.type||"png"));return lf(o,(function(e){e.group.ignore=!1})),r}},bf.getConnectedDataURL=function(e){if(!this._disposed&&i.canvasSupported){var t="svg"===e.type,n=this.group,o=Math.min,r=Math.max;if(Uf[n]){var a=1/0,s=1/0,l=-1/0,u=-1/0,c=[],d=e&&e.pixelRatio||1;O($f,(function(i,d){if(i.group===n){var f=t?i.getZr().painter.getSvgDom().innerHTML:i.getRenderedCanvas(p(e)),h=i.getDom().getBoundingClientRect();a=o(h.left,a),s=o(h.top,s),l=r(h.right,l),u=r(h.bottom,u),c.push({dom:f,left:h.left,top:h.top})}}));var f=(l*=d)-(a*=d),h=(u*=d)-(s*=d),g=T(),m=bi(g,{renderer:t?"svg":"canvas"});if(m.resize({width:f,height:h}),t){var v="";return lf(c,(function(e){v+='<g transform="translate('+(e.left-a)+","+(e.top-s)+')">'+e.dom+"</g>"})),m.painter.getSvgRoot().innerHTML=v,e.connectedBackgroundColor&&m.painter.setBackgroundColor(e.connectedBackgroundColor),m.refreshImmediately(),m.painter.toDataURL()}return e.connectedBackgroundColor&&m.add(new Ua({shape:{x:0,y:0,width:f,height:h},style:{fill:e.connectedBackgroundColor}})),lf(c,(function(e){var t=new Wo({style:{x:e.left*d-a,y:e.top*d-s,image:e.dom}});m.add(t)})),m.refreshImmediately(),g.toDataURL("image/"+(e&&e.type||"png"))}return this.getDataURL(e)}},bf.convertToPixel=N(Cf,"convertToPixel"),bf.convertFromPixel=N(Cf,"convertFromPixel"),bf.containPixel=function(e,t){var n;if(!this._disposed)return O(e=Bi(this._model,e),(function(e,o){0<=o.indexOf("Models")&&O(e,(function(e){var i=e.coordinateSystem;if(i&&i.containPoint)n|=!!i.containPoint(t);else if("seriesModels"===o){var r=this._chartsMap[e.__viewId];r&&r.containPoint&&(n|=r.containPoint(t,e))}}),this)}),this),!!n},bf.getVisual=function(e,t){var n=(e=Bi(this._model,e,{defaultMainType:"series"})).seriesModel.getData(),o=e.hasOwnProperty("dataIndexInside")?e.dataIndexInside:e.hasOwnProperty("dataIndex")?n.indexOfRawIndex(e.dataIndex):null;return null!=o?n.getItemVisual(o,t):n.getVisual(t)},bf.getViewOfComponentModel=function(e){return this._componentsMap[e.__viewId]},bf.getViewOfSeriesModel=function(e){return this._chartsMap[e.__viewId]};var Tf={prepareAndUpdate:function(e){xf(this),Tf.update.call(this,e)},update:function(e){var t=this._model,n=this._api,o=this._zr,r=this._coordSysMgr,a=this._scheduler;if(t){a.restoreData(t,e),a.performSeriesTasks(t),r.create(t,n),a.performDataProcessorTasks(t,e),_f(this,t),r.update(t,n),Rf(t),a.performVisualTasks(t,e),Sf(this,t,n,e);var s=t.get("backgroundColor")||"transparent";if(i.canvasSupported)o.setBackgroundColor(s);else{var l=Ft(s);s=jt(l,"rgb"),0===l[3]&&(s="transparent")}Af(t,n)}},updateTransform:function(e){var t=this._model,n=this,o=this._api;if(t){var i=[];t.eachComponent((function(r,a){var s=n.getViewOfComponentModel(a);if(s&&s.__alive)if(s.updateTransform){var l=s.updateTransform(a,t,o,e);l&&l.update&&i.push(s)}else i.push(s)}));var r=Q();t.eachSeries((function(i){var a=n._chartsMap[i.__viewId];if(a.updateTransform){var s=a.updateTransform(i,t,o,e);s&&s.update&&r.set(i.uid,1)}else r.set(i.uid,1)})),Rf(t),this._scheduler.performVisualTasks(t,e,{setDirty:!0,dirtyMap:r}),kf(n,t,0,e,r),Af(t,this._api)}},updateView:function(e){var t=this._model;t&&(nd.markUpdateMethod(e,"updateView"),Rf(t),this._scheduler.performVisualTasks(t,e,{setDirty:!0}),Sf(this,this._model,this._api,e),Af(t,this._api))},updateVisual:function(e){Tf.update.call(this,e)},updateLayout:function(e){Tf.update.call(this,e)}};function xf(e){var t=e._model,n=e._scheduler;n.restorePipelines(t),n.prepareStageTasks(),wf(e,"component",t,n),wf(e,"chart",t,n),n.plan()}function Ef(e,t,n,o,i){var r=e._model;if(o){var a={};a[o+"Id"]=n[o+"Id"],a[o+"Index"]=n[o+"Index"],a[o+"Name"]=n[o+"Name"];var s={mainType:o,query:a};i&&(s.subType=i);var l=n.excludeSeriesId;null!=l&&(l=Q(Oi(l))),r&&r.eachComponent(s,(function(t){l&&null!=l.get(t.id)||u(e["series"===o?"_chartsMap":"_componentsMap"][t.__viewId])}),e)}else lf(e._componentsViews.concat(e._chartsViews),u);function u(o){o&&o.__alive&&o[t]&&o[t](o.__model,r,e._api,n)}}function _f(e,t){var n=e._chartsMap,o=e._scheduler;t.eachSeries((function(e){o.updateStreamModes(e,n[e.__viewId])}))}function If(e,t){var n=e.type,o=e.escapeConnect,i=Pf[n],r=i.actionInfo,a=(r.update||"update").split(":"),s=a.pop();a=null!=a[0]&&df(a[0]),this[hf]=!0;var l=[e],u=!1;e.batch&&(u=!0,l=w(e.batch,(function(t){return(t=C(b({},t),e)).batch=null,t})));var c,d=[],f="highlight"===n||"downplay"===n;lf(l,(function(e){(c=(c=i.action(e,this._model,this._api))||b({},e)).type=r.event||c.type,d.push(c),f?Ef(this,s,e,"series"):a&&Ef(this,s,e,a.main,a.sub)}),this),"none"===s||f||a||(this[gf]?(xf(this),Tf.update.call(this,e),this[gf]=!1):Tf[s].call(this,e)),c=u?{type:r.event||n,escapeConnect:o,batch:d}:d[0],this[hf]=!1,t||this._messageCenter.trigger(c.type,c)}function Df(e){for(var t=this._pendingActions;t.length;){var n=t.shift();If.call(this,n,e)}}function Of(e){e||this.trigger("updated")}function wf(e,t,n,o){for(var i="component"===t,r=i?e._componentsViews:e._chartsViews,a=i?e._componentsMap:e._chartsMap,s=e._zr,l=e._api,u=0;u<r.length;u++)r[u].__alive=!1;function c(e){var t="_ec_"+e.id+"_"+e.type,u=a[t];if(!u){var c=df(e.type);(u=new(i?Zc.getClass(c.main,c.sub):nd.getClass(c.sub))).init(n,l),a[t]=u,r.push(u),s.add(u.group)}e.__viewId=u.__id=t,u.__alive=!0,u.__model=e,u.group.__ecComponentInfo={mainType:e.mainType,index:e.componentIndex},i||o.prepareView(u,e,n,l)}for(i?n.eachComponent((function(e,t){"series"!==e&&c(t)})):n.eachSeries(c),u=0;u<r.length;){var d=r[u];d.__alive?u++:(i||d.renderTask.dispose(),s.remove(d.group),d.dispose(n,l),r.splice(u,1),delete a[d.__id],d.__id=d.group.__ecComponentInfo=null)}}function Rf(e){e.clearColorPalette(),e.eachSeries((function(e){e.clearColorPalette()}))}function Sf(e,t,n,o){!function(e,t,n,o,i){lf(e._componentsViews,(function(e){var i=e.__model;e.render(i,t,n,o),Mf(i,e)}))}(e,t,n,o),lf(e._chartsViews,(function(e){e.__alive=!1})),kf(e,t,0,o),lf(e._chartsViews,(function(e){e.__alive||e.remove(t,n)}))}function kf(e,t,n,o,r){var a,s=e._scheduler;t.eachSeries((function(t){var n=e._chartsMap[t.__viewId];n.__alive=!0;var i=n.renderTask;s.updatePayload(i,o),r&&r.get(t.uid)&&i.dirty(),a|=i.perform(s.getPerformArgs(i)),n.group.silent=!!t.get("silent"),Mf(t,n),function(e,t){var n=e.get("blendMode")||null;t.group.traverse((function(e){e.isGroup||e.style.blend!==n&&e.setStyle("blend",n),e.eachPendingDisplayable&&e.eachPendingDisplayable((function(e){e.setStyle("blend",n)}))}))}(t,n)})),s.unfinished|=a,function(e,t){var n=0;e._zr.storage.traverse((function(e){n++})),n>t.get("hoverLayerThreshold")&&!i.node&&t.eachSeries((function(t){if(!t.preventUsingHoverLayer){var n=e._chartsMap[t.__viewId];n.__alive&&n.group.traverse((function(e){e.useHoverLayer=!0}))}}))}(e,t),function(e,t){var n=t.getModel("aria");if(n.get("show"))if(n.get("description"))e.setAttribute("aria-label",n.get("description"));else{var o=0;t.eachSeries((function(e,t){++o}),this);var i,r=n.get("data.maxCount")||10,a=n.get("series.maxCount")||10,s=Math.min(o,a);if(!(o<1)){var l=function(){var e=t.getModel("title").option;return e&&e.length&&(e=e[0]),e&&e.text}();i=l?c(d("general.withTitle"),{title:l}):d("general.withoutTitle");var u=[];i+=c(d(1<o?"series.multiple.prefix":"series.single.prefix"),{seriesCount:o}),t.eachSeries((function(e,t){if(t<s){var n,i=e.get("name"),a="series."+(1<o?"multiple":"single")+".";n=c(n=d(i?a+"withName":a+"withoutName"),{seriesId:e.seriesIndex,seriesName:e.get("name"),seriesType:function(e){return pd.series.typeNames[e]||"自定义图"}(e.subType)});var l=e.getData();(window.data=l).count()>r?n+=c(d("data.partialData"),{displayCnt:r}):n+=d("data.allData");for(var f=[],h=0;h<l.count();h++)if(h<r){var g=l.getName(h),m=Ic(l,h);f.push(c(d(g?"data.withName":"data.withoutName"),{name:g,value:m}))}n+=f.join(d("data.separator.middle"))+d("data.separator.end"),u.push(n)}})),i+=u.join(d("series.multiple.separator.middle"))+d("series.multiple.separator.end"),e.setAttribute("aria-label",i)}}function c(e,t){if("string"!=typeof e)return e;var n=e;return O(t,(function(e,t){n=n.replace(new RegExp("\\{\\s*"+t+"\\s*\\}","g"),e)})),n}function d(e){var t=n.get(e);if(null!=t)return t;for(var o=e.split("."),i=pd.aria,r=0;r<o.length;++r)i=i[o[r]];return i}}(e._zr.dom,t)}function Af(e,t){lf(zf,(function(n){n(e,t)}))}bf.resize=function(e){if(!this._disposed){this._zr.resize(e);var t=this._model;if(this._loadingFX&&this._loadingFX.resize(),t){var n=t.resetOption("media"),o=e&&e.silent;this[hf]=!0,n&&xf(this),Tf.update.call(this),this[hf]=!1,Df.call(this,o),Of.call(this,o)}}},bf.showLoading=function(e,t){if(!this._disposed&&(cf(e)&&(t=e,e=""),e=e||"default",this.hideLoading(),Wf[e])){var n=Wf[e](this._api,t),o=this._zr;this._loadingFX=n,o.add(n)}},bf.hideLoading=function(){this._disposed||(this._loadingFX&&this._zr.remove(this._loadingFX),this._loadingFX=null)},bf.makeActionFromEvent=function(e){var t=b({},e);return t.type=Lf[e.type],t},bf.dispatchAction=function(e,t){this._disposed||(cf(t)||(t={silent:!!t}),Pf[e.type]&&this._model&&(this[hf]?this._pendingActions.push(e):(If.call(this,e,t.silent),t.flush?this._zr.flush(!0):!1!==t.flush&&i.browser.weChat&&this._throttledZrFlush(),Df.call(this,t.silent),Of.call(this,t.silent))))},bf.appendData=function(e){if(!this._disposed){var t=e.seriesIndex;this.getModel().getSeriesByIndex(t).appendData(e),this._scheduler.unfinished=!0}},bf.on=pf("on",!1),bf.off=pf("off",!1),bf.one=pf("one",!1);var Nf=["click","dblclick","mouseover","mouseout","mousemove","mousedown","mouseup","globalout","contextmenu"];function Mf(e,t){var n=e.get("z"),o=e.get("zlevel");t.group.traverse((function(e){"group"!==e.type&&(null!=n&&(e.z=n),null!=o&&(e.zlevel=o))}))}function Kf(){}bf._initEvents=function(){lf(Nf,(function(e){function t(t){var n,o=this.getModel(),i=t.target;if("globalout"===e)n={};else if(i&&null!=i.dataIndex){var r=i.dataModel||o.getSeriesByIndex(i.seriesIndex);n=r&&r.getDataParams(i.dataIndex,i.dataType,i)||{}}else i&&i.eventData&&(n=b({},i.eventData));if(n){var a=n.componentType,s=n.componentIndex;"markLine"!==a&&"markPoint"!==a&&"markArea"!==a||(a="series",s=n.seriesIndex);var l=a&&null!=s&&o.getComponent(a,s),u=l&&this["series"===l.mainType?"_chartsMap":"_componentsMap"][l.__viewId];n.event=t,n.type=e,this._ecEventProcessor.eventInfo={targetEl:i,packedEvent:n,model:l,view:u},this.trigger(e,n)}}t.zrEventfulCallAtLast=!0,this._zr.on(e,t,this)}),this),lf(Lf,(function(e,t){this._messageCenter.on(t,(function(e){this.trigger(t,e)}),this)}),this)},bf.isDisposed=function(){return this._disposed},bf.clear=function(){this._disposed||this.setOption({series:[]},!0)},bf.dispose=function(){if(!this._disposed){this._disposed=!0,zi(this.getDom(),Gf,"");var e=this._api,t=this._model;lf(this._componentsViews,(function(n){n.dispose(t,e)})),lf(this._chartsViews,(function(n){n.dispose(t,e)})),this._zr.dispose(),delete $f[this.id]}},I(yf,Oe),Kf.prototype={constructor:Kf,normalizeQuery:function(e){var t={},n={},o={};if(P(e)){var i=df(e);t.mainType=i.main||null,t.subType=i.sub||null}else{var r=["Index","Name","Id"],a={name:1,dataIndex:1,dataType:1};O(e,(function(e,i){for(var s=!1,l=0;l<r.length;l++){var u=r[l],c=i.lastIndexOf(u);if(0<c&&c===i.length-u.length){var d=i.slice(0,c);"data"!==d&&(t.mainType=d,t[u.toLowerCase()]=e,s=!0)}}a.hasOwnProperty(i)&&(n[i]=e,s=!0),s||(o[i]=e)}))}return{cptQuery:t,dataQuery:n,otherQuery:o}},filter:function(e,t,n){var o=this.eventInfo;if(!o)return!0;var i=o.targetEl,r=o.packedEvent,a=o.model,s=o.view;if(!a||!s)return!0;var l=t.cptQuery,u=t.dataQuery;return c(l,a,"mainType")&&c(l,a,"subType")&&c(l,a,"index","componentIndex")&&c(l,a,"name")&&c(l,a,"id")&&c(u,r,"name")&&c(u,r,"dataIndex")&&c(u,r,"dataType")&&(!s.filterForExposedEvent||s.filterForExposedEvent(e,t.otherQuery,i,r));function c(e,t,n,o){return null==e[n]||t[o||n]===e[n]}},afterTrigger:function(){this.eventInfo=null}};var Pf={},Lf={},Bf=[],Ff=[],zf=[],Vf=[],Hf={},Wf={},$f={},Uf={},qf=new Date-0,jf=new Date-0,Gf="_echarts_instance_";function Xf(e){Uf[e]=!1}var Yf=Xf;function Zf(e){return $f[function(e,t){return e.getAttribute?e.getAttribute(t):e[t]}(e,Gf)]}function Jf(e,t){Hf[e]=t}function Qf(e){Ff.push(e)}function eh(e,t){rh(Bf,e,t,1e3)}function th(e,t,n){"function"==typeof t&&(n=t,t="");var o=cf(e)?e.type:[e,e={event:t}][0];e.event=(e.event||o).toLowerCase(),t=e.event,sf(mf.test(o)&&mf.test(t)),Pf[o]||(Pf[o]={action:n,actionInfo:e}),Lf[t]=o}function nh(e,t){Uu.register(e,t)}function oh(e,t){rh(Vf,e,t,1e3,"layout")}function ih(e,t){rh(Vf,e,t,3e3,"visual")}function rh(e,t,n,o,i){(uf(t)||cf(t))&&(n=t,t=o);var r=yd.wrapStageHandler(n,i);return r.__prio=t,r.__raw=n,e.push(r),r}function ah(e,t){Wf[e]=t}function sh(e){return mu.extend(e)}function lh(e){return Zc.extend(e)}function uh(e){return Wc.extend(e)}function ch(e){return nd.extend(e)}function dh(e){return e}function fh(e,t,n,o,i){this._old=e,this._new=t,this._oldKeyGetter=n||dh,this._newKeyGetter=o||dh,this.context=i}function hh(e,t,n,o,i){for(var r=0;r<e.length;r++){var a="_ec_"+i[o](e[r],r),s=t[a];null==s?(n.push(a),t[a]=r):(s.length||(t[a]=s=[s]),s.push(r))}}ih(2e3,md),Qf(fc),eh(900,(function(e){var t=Q();e.eachSeries((function(e){var n=e.get("stack");if(n){var o=t.get(n)||t.set(n,[]),i=e.getData(),r={stackResultDimension:i.getCalculationInfo("stackResultDimension"),stackedOverDimension:i.getCalculationInfo("stackedOverDimension"),stackedDimension:i.getCalculationInfo("stackedDimension"),stackedByDimension:i.getCalculationInfo("stackedByDimension"),isStackedByIndex:i.getCalculationInfo("isStackedByIndex"),data:i,seriesModel:e};if(!r.stackedDimension||!r.isStackedByIndex&&!r.stackedByDimension)return;o.length&&i.setCalculationInfo("stackedOnSeries",o[o.length-1].seriesModel),o.push(r)}})),t.each(hc)})),ah("default",(function(e,t){C(t=t||{},{text:"loading",textColor:"#000",fontSize:"12px",maskColor:"rgba(255, 255, 255, 0.8)",showSpinner:!0,color:"#c23531",spinnerRadius:10,lineWidth:5,zlevel:0});var n=new _n,o=new Ua({style:{fill:t.maskColor},zlevel:t.zlevel,z:1e4});n.add(o);var i=t.fontSize+" sans-serif",r=new Ua({style:{fill:"none",text:t.text,font:i,textPosition:"right",textDistance:10,textFill:t.textColor},zlevel:t.zlevel,z:10001});if(n.add(r),t.showSpinner){var a=new Ja({shape:{startAngle:-vd/2,endAngle:-vd/2+.1,r:t.spinnerRadius},style:{stroke:t.color,lineCap:"round",lineWidth:t.lineWidth},zlevel:t.zlevel,z:10001});a.animateShape(!0).when(1e3,{endAngle:3*vd/2}).start("circularInOut"),a.animateShape(!0).when(1e3,{startAngle:3*vd/2}).delay(300).start("circularInOut"),n.add(a)}return n.resize=function(){var n=oo(t.text,i),s=t.showSpinner?t.spinnerRadius:0,l=(e.getWidth()-2*s-(t.showSpinner&&n?10:0)-n)/2-(t.showSpinner?0:n/2),u=e.getHeight()/2;t.showSpinner&&a.setShape({cx:l,cy:u}),r.setShape({x:l-s,y:u-s,width:2*s,height:2*s}),o.setShape({x:0,y:0,width:e.getWidth(),height:e.getHeight()})},n.resize(),n})),th({type:"highlight",event:"highlight",update:"highlight"},te),th({type:"downplay",event:"downplay",update:"downplay"},te),Jf("light",Bd),Jf("dark",Vd),fh.prototype={constructor:fh,add:function(e){return this._add=e,this},update:function(e){return this._update=e,this},remove:function(e){return this._remove=e,this},execute:function(){var e=this._old,t=this._new,n={},o=[],i=[];for(hh(e,{},o,"_oldKeyGetter",this),hh(t,n,i,"_newKeyGetter",this),r=0;r<e.length;r++)null!=(s=n[a=o[r]])?((u=s.length)?(1===u&&(n[a]=null),s=s.shift()):n[a]=null,this._update&&this._update(s,r)):this._remove&&this._remove(r);for(var r=0;r<i.length;r++){var a=i[r];if(n.hasOwnProperty(a)){var s;if(null==(s=n[a]))continue;if(s.length)for(var l=0,u=s.length;l<u;l++)this._add&&this._add(s[l]);else this._add&&this._add(s)}}}};var gh=Q(["tooltip","label","itemName","itemId","seriesName"]);function mh(e,t){return e.hasOwnProperty(t)||(e[t]=[]),e[t]}function ph(e){return"category"===e?"ordinal":"time"===e?"time":"float"}function vh(e){null!=e&&b(this,e),this.otherDims={}}var yh=L,bh="undefined",Ch={float:typeof Float64Array==bh?Array:Float64Array,int:typeof Int32Array==bh?Array:Int32Array,ordinal:Array,number:Array,time:Array},Th=typeof Uint32Array==bh?Array:Uint32Array,xh=typeof Int32Array==bh?Array:Int32Array,Eh=typeof Uint16Array==bh?Array:Uint16Array;function _h(e){return 65535<e._rawCount?Th:Eh}var Ih=["hasItemOption","_nameList","_idList","_invertedIndicesMap","_rawData","_chunkSize","_chunkCount","_dimValueGetter","_count","_rawCount","_nameDimIdx","_idDimIdx"],Dh=["_extent","_approximateExtent","_rawExtent"];function Oh(e,t){O(Ih.concat(t.__wrappedMethods||[]),(function(n){t.hasOwnProperty(n)&&(e[n]=t[n])})),e.__wrappedMethods=t.__wrappedMethods,O(Dh,(function(n){e[n]=p(t[n])})),e._calculationInfo=b(t._calculationInfo)}var wh=function(e,t){e=e||["x","y"];for(var n={},o=[],i={},r=0;r<e.length;r++){var a=e[r];P(a)?a=new vh({name:a}):a instanceof vh||(a=new vh(a));var s=a.name;a.type=a.type||"float",a.coordDim||(a.coordDim=s,a.coordDimIndex=0),a.otherDims=a.otherDims||{},o.push(s),(n[s]=a).index=r,a.createInvertedIndices&&(i[s]=[])}this.dimensions=o,this._dimensionInfos=n,this.hostModel=t,this._indices=null,this._count=0,this._rawCount=0,this._storage={},this._nameList=[],this._idList=[],this._optionModels=[],this._visual={},this._layout={},this._itemVisuals=[],this.hasItemVisual={},this._itemLayouts=[],this._graphicEls=[],this._chunkSize=1e5,this._chunkCount=0,this._rawExtent={},this._extent={},this._approximateExtent={},this._dimensionsSummary=function(e){var t={},n=t.encode={},o=Q(),i=[],r=[],a=t.userOutput={dimensionNames:e.dimensions.slice(),encode:{}};O(e.dimensions,(function(t){var s=e.getDimensionInfo(t),l=s.coordDim;if(l){var u=s.coordDimIndex;mh(n,l)[u]=t,s.isExtraCoord||(o.set(l,1),function(e){return!("ordinal"===e||"time"===e)}(s.type)&&(i[0]=t),mh(a.encode,l)[u]=s.index),s.defaultTooltip&&r.push(t)}gh.each((function(e,t){var o=mh(n,t),i=s.otherDims[t];null!=i&&!1!==i&&(o[i]=s.name)}))}));var s=[],l={};o.each((function(e,t){var o=n[t];l[t]=o[0],s=s.concat(o)})),t.dataDimsOnCoord=s,t.encodeFirstDimNotExtra=l;var u=n.label;u&&u.length&&(i=u.slice());var c=n.tooltip;return c&&c.length?r=c.slice():r.length||(r=i.slice()),n.defaultedLabel=i,n.defaultedTooltip=r,t}(this),this._invertedIndicesMap=i,this._calculationInfo={},this.userOutput=this._dimensionsSummary.userOutput},Rh=wh.prototype;function Sh(e,t,n,o,i){var r=Ch[t.type],a=o-1,s=t.name,l=e[s][a];if(l&&l.length<n){for(var u=new r(Math.min(i-a*n,n)),c=0;c<l.length;c++)u[c]=l[c];e[s][a]=u}for(var d=o*n;d<i;d+=n)e[s].push(new r(Math.min(i-d,n)))}function kh(e){var t=e._invertedIndicesMap;O(t,(function(n,o){var i=e._dimensionInfos[o].ordinalMeta;if(i){n=t[o]=new xh(i.categories.length);for(var r=0;r<n.length;r++)n[r]=-1;for(r=0;r<e._count;r++)n[e.get(o,r)]=r}}))}function Ah(e,t,n){var o;if(null!=t){var i=e._chunkSize,r=Math.floor(n/i),a=e.dimensions[t],s=e._storage[a][r];if(s){o=s[n%i];var l=e._dimensionInfos[a].ordinalMeta;l&&l.categories.length&&(o=l.categories[o])}}return o}function Nh(e){return e}function Mh(e){return e<this._count&&0<=e?this._indices[e]:-1}function Kh(e,t){var n=e._idList[t];return null==n&&(n=Ah(e,e._idDimIdx,t)),null==n&&(n="e\0\0"+t),n}function Ph(e){return M(e)||(e=[e]),e}function Lh(e,t){var n=e.dimensions,o=new wh(w(n,e.getDimensionInfo,e),e.hostModel);Oh(o,e);for(var i=o._storage={},r=e._storage,a=0;a<n.length;a++){var s=n[a];r[s]&&(0<=E(t,s)?(i[s]=Bh(r[s]),o._rawExtent[s]=[1/0,-1/0],o._extent[s]=null):i[s]=r[s])}return o}function Bh(e){for(var t,n,o=new Array(e.length),i=0;i<e.length;i++)o[i]=(n=void 0,(n=(t=e[i]).constructor)===Array?t.slice():new n(t));return o}function Fh(e){e.seriesIndex=this.seriesIndex,e.dataIndex=this.dataIndex,e.dataType=this.dataType}function zh(e,t,n){Ru.isInstance(t)||(t=Ru.seriesDataToSource(t)),n=n||{},e=(e||[]).slice();for(var o=(n.dimsDef||[]).slice(),i=Q(),r=Q(),a=[],s=function(e,t,n,o){var i=Math.max(e.dimensionsDetectCount||1,t.length,n.length,o||0);return O(t,(function(e){var t=e.dimsDef;t&&(i=Math.max(i,t.length))})),i}(t,e,o,n.dimCount),l=0;l<s;l++){var u=o[l]=b({},L(o[l])?o[l]:{name:o[l]}),c=u.name,d=a[l]=new vh;null!=c&&null==i.get(c)&&(d.name=d.displayName=c,i.set(c,l)),null!=u.type&&(d.type=u.type),null!=u.displayName&&(d.displayName=u.displayName)}var f=n.encodeDef;!f&&n.encodeDefaulter&&(f=n.encodeDefaulter(t,s)),(f=Q(f)).each((function(e,t){if(1===(e=Oi(e).slice()).length&&!P(e[0])&&e[0]<0)f.set(t,!1);else{var n=f.set(t,[]);O(e,(function(e,o){P(e)&&(e=i.get(e)),null!=e&&e<s&&(n[o]=e,g(a[e],t,o))}))}}));var h=0;function g(e,t,n){null!=gh.get(t)?e.otherDims[t]=n:(e.coordDim=t,e.coordDimIndex=n,r.set(t,!0))}O(e,(function(e,t){var n,o,i;if(P(e))n=e,e={};else{n=e.name;var r=e.ordinalMeta;e.ordinalMeta=null,(e=p(e)).ordinalMeta=r,o=e.dimsDef,i=e.otherDims,e.name=e.coordDim=e.coordDimIndex=e.dimsDef=e.otherDims=null}if(!1!==(s=f.get(n))){var s;if(!(s=Oi(s)).length)for(var l=0;l<(o&&o.length||1);l++){for(;h<a.length&&null!=a[h].coordDim;)h++;h<a.length&&s.push(h++)}O(s,(function(t,r){var s=a[t];if(g(C(s,e),n,r),null==s.name&&o){var l=o[r];L(l)||(l={name:l}),s.name=s.displayName=l.name,s.defaultTooltip=l.defaultTooltip}i&&C(s.otherDims,i)}))}}));var m=n.generateCoord,v=n.generateCoordCount,y=null!=v;v=m?v||1:0;for(var T,x=m||"value",E=0;E<s;E++)null==(d=a[E]=a[E]||new vh).coordDim&&(d.coordDim=Vh(x,r,y),d.coordDimIndex=0,(!m||v<=0)&&(d.isExtraCoord=!0),v--),null==d.name&&(d.name=Vh(d.coordDim,i)),null==d.type&&(1===Lu((T=t).data,T.sourceFormat,T.seriesLayoutBy,T.dimensionsDefine,T.startIndex,E)||d.isExtraCoord&&(null!=d.otherDims.itemName||null!=d.otherDims.seriesName))&&(d.type="ordinal");return a}function Vh(e,t,n){if(n||null!=t.get(e)){for(var o=0;null!=t.get(e+o);)o++;e+=o}return t.set(e,!0),e}Rh.type="list",Rh.hasItemOption=!0,Rh.getDimension=function(e){return"number"!=typeof e&&(isNaN(e)||this._dimensionInfos.hasOwnProperty(e))||(e=this.dimensions[e]),e},Rh.getDimensionInfo=function(e){return this._dimensionInfos[this.getDimension(e)]},Rh.getDimensionsOnCoord=function(){return this._dimensionsSummary.dataDimsOnCoord.slice()},Rh.mapDimension=function(e,t){var n=this._dimensionsSummary;if(null==t)return n.encodeFirstDimNotExtra[e];var o=n.encode[e];return!0===t?(o||[]).slice():o&&o[t]},Rh.initData=function(e,t,n){(Ru.isInstance(e)||D(e))&&(e=new gc(e,this.dimensions.length)),this._rawData=e,this._storage={},this._indices=null,this._nameList=t||[],this._idList=[],this._nameRepeatCount={},n||(this.hasItemOption=!1),this.defaultDimValueGetter=xc[this._rawData.getSource().sourceFormat],this._dimValueGetter=n=n||this.defaultDimValueGetter,this._dimValueGetterArrayRows=xc.arrayRows,this._rawExtent={},this._initDataFromProvider(0,e.count()),e.pure&&(this.hasItemOption=!1)},Rh.getProvider=function(){return this._rawData},Rh.appendData=function(e){var t=this._rawData,n=this.count();t.appendData(e);var o=t.count();t.persistent||(o+=n),this._initDataFromProvider(n,o)},Rh.appendValues=function(e,t){for(var n=this._chunkSize,o=this._storage,i=this.dimensions,r=i.length,a=this._rawExtent,s=this.count(),l=s+Math.max(e.length,t?t.length:0),u=this._chunkCount,c=0;c<r;c++)a[v=i[c]]||(a[v]=[1/0,-1/0]),o[v]||(o[v]=[]),Sh(o,this._dimensionInfos[v],n,u,l),this._chunkCount=o[v].length;for(var d=new Array(r),f=s;f<l;f++){for(var h=f-s,g=Math.floor(f/n),m=f%n,p=0;p<r;p++){var v=i[p],y=this._dimValueGetterArrayRows(e[h]||d,v,h,p);o[v][g][m]=y;var b=a[v];y<b[0]&&(b[0]=y),y>b[1]&&(b[1]=y)}t&&(this._nameList[f]=t[h])}this._rawCount=this._count=l,this._extent={},kh(this)},Rh._initDataFromProvider=function(e,t){if(!(t<=e)){for(var n,o=this._chunkSize,i=this._rawData,r=this._storage,a=this.dimensions,s=a.length,l=this._dimensionInfos,u=this._nameList,c=this._idList,d=this._rawExtent,f=this._nameRepeatCount={},h=this._chunkCount,g=0;g<s;g++){d[T=a[g]]||(d[T]=[1/0,-1/0]);var m=l[T];0===m.otherDims.itemName&&(n=this._nameDimIdx=g),0===m.otherDims.itemId&&(this._idDimIdx=g),r[T]||(r[T]=[]),Sh(r,m,o,h,t),this._chunkCount=r[T].length}for(var p=new Array(s),v=e;v<t;v++){p=i.getItem(v,p);for(var y=Math.floor(v/o),b=v%o,C=0;C<s;C++){var T,x=r[T=a[C]][y],E=this._dimValueGetter(p,T,v,C);x[b]=E;var _=d[T];E<_[0]&&(_[0]=E),E>_[1]&&(_[1]=E)}if(!i.pure){var I=u[v];if(p&&null==I)if(null!=p.name)u[v]=I=p.name;else if(null!=n){var D=a[n],O=r[D][y];if(O){I=O[b];var w=l[D].ordinalMeta;w&&w.categories.length&&(I=w.categories[I])}}var R=null==p?null:p.id;null==R&&null!=I&&(f[I]=f[I]||0,0<f[R=I]&&(R+="__ec__"+f[I]),f[I]++),null!=R&&(c[v]=R)}}!i.persistent&&i.clean&&i.clean(),this._rawCount=this._count=t,this._extent={},kh(this)}},Rh.count=function(){return this._count},Rh.getIndices=function(){var e=this._indices;if(e){var t=e.constructor,n=this._count;if(t===Array){i=new t(n);for(var o=0;o<n;o++)i[o]=e[o]}else i=new t(e.buffer,0,n)}else{var i=new(t=_h(this))(this.count());for(o=0;o<i.length;o++)i[o]=o}return i},Rh.get=function(e,t){if(!(0<=t&&t<this._count))return NaN;var n=this._storage;if(!n[e])return NaN;t=this.getRawIndex(t);var o=Math.floor(t/this._chunkSize);return n[e][o][t%this._chunkSize]},Rh.getByRawIndex=function(e,t){if(!(0<=t&&t<this._rawCount))return NaN;var n=this._storage[e];return n?n[Math.floor(t/this._chunkSize)][t%this._chunkSize]:NaN},Rh._getFast=function(e,t){var n=Math.floor(t/this._chunkSize);return this._storage[e][n][t%this._chunkSize]},Rh.getValues=function(e,t){var n=[];M(e)||(t=e,e=this.dimensions);for(var o=0,i=e.length;o<i;o++)n.push(this.get(e[o],t));return n},Rh.hasValue=function(e){for(var t=this._dimensionsSummary.dataDimsOnCoord,n=0,o=t.length;n<o;n++)if(isNaN(this.get(t[n],e)))return!1;return!0},Rh.getDataExtent=function(e){e=this.getDimension(e);var t=[1/0,-1/0];if(!this._storage[e])return t;var n,o=this.count();if(!this._indices)return this._rawExtent[e].slice();if(n=this._extent[e])return n.slice();for(var i=(n=t)[0],r=n[1],a=0;a<o;a++){var s=this._getFast(e,this.getRawIndex(a));s<i&&(i=s),r<s&&(r=s)}return this._extent[e]=[i,r]},Rh.getApproximateExtent=function(e){return e=this.getDimension(e),this._approximateExtent[e]||this.getDataExtent(e)},Rh.setApproximateExtent=function(e,t){t=this.getDimension(t),this._approximateExtent[t]=e.slice()},Rh.getCalculationInfo=function(e){return this._calculationInfo[e]},Rh.setCalculationInfo=function(e,t){yh(e)?b(this._calculationInfo,e):this._calculationInfo[e]=t},Rh.getSum=function(e){var t=0;if(this._storage[e])for(var n=0,o=this.count();n<o;n++){var i=this.get(e,n);isNaN(i)||(t+=i)}return t},Rh.getMedian=function(e){var t=[];this.each(e,(function(e,n){isNaN(e)||t.push(e)}));var n=[].concat(t).sort((function(e,t){return e-t})),o=this.count();return 0===o?0:o%2==1?n[(o-1)/2]:(n[o/2]+n[o/2-1])/2},Rh.rawIndexOf=function(e,t){var n=(e&&this._invertedIndicesMap[e])[t];return null==n||isNaN(n)?-1:n},Rh.indexOfName=function(e){for(var t=0,n=this.count();t<n;t++)if(this.getName(t)===e)return t;return-1},Rh.indexOfRawIndex=function(e){if(e>=this._rawCount||e<0)return-1;if(!this._indices)return e;var t=this._indices,n=t[e];if(null!=n&&n<this._count&&n===e)return e;for(var o=0,i=this._count-1;o<=i;){var r=(o+i)/2|0;if(t[r]<e)o=1+r;else{if(!(t[r]>e))return r;i=r-1}}return-1},Rh.indicesOfNearest=function(e,t,n){var o=[];if(!this._storage[e])return o;null==n&&(n=1/0);for(var i=1/0,r=-1,a=0,s=0,l=this.count();s<l;s++){var u=t-this.get(e,s),c=Math.abs(u);c<=n&&((c<i||c===i&&0<=u&&r<0)&&(i=c,r=u,a=0),u===r&&(o[a++]=s))}return o.length=a,o},Rh.getRawIndex=Nh,Rh.getRawDataItem=function(e){if(this._rawData.persistent)return this._rawData.getItem(this.getRawIndex(e));for(var t=[],n=0;n<this.dimensions.length;n++)t.push(this.get(this.dimensions[n],e));return t},Rh.getName=function(e){var t=this.getRawIndex(e);return this._nameList[t]||Ah(this,this._nameDimIdx,t)||""},Rh.getId=function(e){return Kh(this,this.getRawIndex(e))},Rh.each=function(e,t,n,o){if(this._count){"function"==typeof e&&(o=n,n=t,t=e,e=[]),n=n||o||this;for(var i=(e=w(Ph(e),this.getDimension,this)).length,r=0;r<this.count();r++)switch(i){case 0:t.call(n,r);break;case 1:t.call(n,this.get(e[0],r),r);break;case 2:t.call(n,this.get(e[0],r),this.get(e[1],r),r);break;default:for(var a=0,s=[];a<i;a++)s[a]=this.get(e[a],r);s[a]=r,t.apply(n,s)}}},Rh.filterSelf=function(e,t,n,o){if(this._count){"function"==typeof e&&(o=n,n=t,t=e,e=[]),n=n||o||this,e=w(Ph(e),this.getDimension,this);for(var i=this.count(),r=new(_h(this))(i),a=[],s=e.length,l=0,u=e[0],c=0;c<i;c++){var d,f=this.getRawIndex(c);if(0===s)d=t.call(n,c);else if(1===s){var h=this._getFast(u,f);d=t.call(n,h,c)}else{for(var g=0;g<s;g++)a[g]=this._getFast(u,f);a[g]=c,d=t.apply(n,a)}d&&(r[l++]=f)}return l<i&&(this._indices=r),this._count=l,this._extent={},this.getRawIndex=this._indices?Mh:Nh,this}},Rh.selectRange=function(e){if(this._count){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);var o=t.length;if(o){var i=this.count(),r=new(_h(this))(i),a=0,s=t[0],l=e[s][0],u=e[s][1],c=!1;if(!this._indices){var d=0;if(1===o){for(var f=this._storage[t[0]],h=0;h<this._chunkCount;h++)for(var g=f[h],m=Math.min(this._count-h*this._chunkSize,this._chunkSize),p=0;p<m;p++)(l<=(T=g[p])&&T<=u||isNaN(T))&&(r[a++]=d),d++;c=!0}else if(2===o){f=this._storage[s];var v=this._storage[t[1]],y=e[t[1]][0],b=e[t[1]][1];for(h=0;h<this._chunkCount;h++){g=f[h];var C=v[h];for(m=Math.min(this._count-h*this._chunkSize,this._chunkSize),p=0;p<m;p++){var T=g[p],x=C[p];(l<=T&&T<=u||isNaN(T))&&(y<=x&&x<=b||isNaN(x))&&(r[a++]=d),d++}}c=!0}}if(!c)if(1===o)for(p=0;p<i;p++){var E=this.getRawIndex(p);(l<=(T=this._getFast(s,E))&&T<=u||isNaN(T))&&(r[a++]=E)}else for(p=0;p<i;p++){var _=!0;for(E=this.getRawIndex(p),h=0;h<o;h++){var I=t[h];((T=this._getFast(n,E))<e[I][0]||T>e[I][1])&&(_=!1)}_&&(r[a++]=this.getRawIndex(p))}return a<i&&(this._indices=r),this._count=a,this._extent={},this.getRawIndex=this._indices?Mh:Nh,this}}},Rh.mapArray=function(e,t,n,o){"function"==typeof e&&(o=n,n=t,t=e,e=[]);var i=[];return this.each(e,(function(){i.push(t&&t.apply(this,arguments))}),n=n||o||this),i},Rh.map=function(e,t,n,o){n=n||o||this;var i=Lh(this,e=w(Ph(e),this.getDimension,this));i._indices=this._indices,i.getRawIndex=i._indices?Mh:Nh;for(var r=i._storage,a=[],s=this._chunkSize,l=e.length,u=this.count(),c=[],d=i._rawExtent,f=0;f<u;f++){for(var h=0;h<l;h++)c[h]=this.get(e[h],f);c[l]=f;var g=t&&t.apply(n,c);if(null!=g){"object"!=typeof g&&(a[0]=g,g=a);for(var m=this.getRawIndex(f),p=Math.floor(m/s),v=m%s,y=0;y<g.length;y++){var b=e[y],C=g[y],T=d[b],x=r[b];x&&(x[p][v]=C),C<T[0]&&(T[0]=C),C>T[1]&&(T[1]=C)}}}return i},Rh.downSample=function(e,t,n,o){for(var i=Lh(this,[e]),r=i._storage,a=[],s=Math.floor(1/t),l=r[e],u=this.count(),c=this._chunkSize,d=i._rawExtent[e],f=new(_h(this))(u),h=0,g=0;g<u;g+=s){u-g<s&&(a.length=s=u-g);for(var m=0;m<s;m++){var p=this.getRawIndex(g+m),v=Math.floor(p/c);a[m]=l[v][p%c]}var y=n(a),b=this.getRawIndex(Math.min(g+o(a,y)||0,u-1)),C=b%c;(l[Math.floor(b/c)][C]=y)<d[0]&&(d[0]=y),y>d[1]&&(d[1]=y),f[h++]=b}return i._count=h,i._indices=f,i.getRawIndex=Mh,i},Rh.getItemModel=function(e){var t=this.hostModel;return new hl(this.getRawDataItem(e),t,t&&t.ecModel)},Rh.diff=function(e){var t=this;return new fh(e?e.getIndices():[],this.getIndices(),(function(t){return Kh(e,t)}),(function(e){return Kh(t,e)}))},Rh.getVisual=function(e){var t=this._visual;return t&&t[e]},Rh.setVisual=function(e,t){if(yh(e))for(var n in e)e.hasOwnProperty(n)&&this.setVisual(n,e[n]);else this._visual=this._visual||{},this._visual[e]=t},Rh.setLayout=function(e,t){if(yh(e))for(var n in e)e.hasOwnProperty(n)&&this.setLayout(n,e[n]);else this._layout[e]=t},Rh.getLayout=function(e){return this._layout[e]},Rh.getItemLayout=function(e){return this._itemLayouts[e]},Rh.setItemLayout=function(e,t,n){this._itemLayouts[e]=n?b(this._itemLayouts[e]||{},t):t},Rh.clearItemLayouts=function(){this._itemLayouts.length=0},Rh.getItemVisual=function(e,t,n){var o=this._itemVisuals[e],i=o&&o[t];return null!=i||n?i:this.getVisual(t)},Rh.setItemVisual=function(e,t,n){var o=this._itemVisuals[e]||{},i=this.hasItemVisual;if(this._itemVisuals[e]=o,yh(t))for(var r in t)t.hasOwnProperty(r)&&(o[r]=t[r],i[r]=!0);else o[t]=n,i[t]=!0},Rh.clearAllVisual=function(){this._visual={},this._itemVisuals=[],this.hasItemVisual={}},Rh.setItemGraphicEl=function(e,t){var n=this.hostModel;t&&(t.dataIndex=e,t.dataType=this.dataType,t.seriesIndex=n&&n.seriesIndex,"group"===t.type&&t.traverse(Fh,t)),this._graphicEls[e]=t},Rh.getItemGraphicEl=function(e){return this._graphicEls[e]},Rh.eachItemGraphicEl=function(e,t){O(this._graphicEls,(function(n,o){n&&e&&e.call(t,n,o)}))},Rh.cloneShallow=function(e){if(!e){var t=w(this.dimensions,this.getDimensionInfo,this);e=new wh(t,this.hostModel)}return e._storage=this._storage,Oh(e,this),e._indices=this._indices?new(0,this._indices.constructor)(this._indices):null,e.getRawIndex=e._indices?Mh:Nh,e},Rh.wrapMethod=function(e,t){var n=this[e];"function"==typeof n&&(this.__wrappedMethods=this.__wrappedMethods||[],this.__wrappedMethods.push(e),this[e]=function(){var e=n.apply(this,arguments);return t.apply(this,[e].concat(U(arguments)))})},Rh.TRANSFERABLE_METHODS=["cloneShallow","downSample","map"],Rh.CHANGABLE_METHODS=["filterSelf","selectRange"];var Hh=function(e,t){return zh((t=t||{}).coordDimensions||[],e,{dimsDef:t.dimensionsDefine||e.dimensionsDefine,encodeDef:t.encodeDefine||e.encodeDefine,dimCount:t.dimensionsCount,encodeDefaulter:t.encodeDefaulter,generateCoord:t.generateCoord,generateCoordCount:t.generateCoordCount})};function Wh(e){this.coordSysName=e,this.coordSysDims=[],this.axisMap=Q(),this.categoryAxisMap=Q(),this.firstCategoryDimIndex=null}var $h={cartesian2d:function(e,t,n,o){var i=e.getReferringComponents("xAxis")[0],r=e.getReferringComponents("yAxis")[0];t.coordSysDims=["x","y"],n.set("x",i),n.set("y",r),Uh(i)&&(o.set("x",i),t.firstCategoryDimIndex=0),Uh(r)&&(o.set("y",r),t.firstCategoryDimIndex=1)},singleAxis:function(e,t,n,o){var i=e.getReferringComponents("singleAxis")[0];t.coordSysDims=["single"],n.set("single",i),Uh(i)&&(o.set("single",i),t.firstCategoryDimIndex=0)},polar:function(e,t,n,o){var i=e.getReferringComponents("polar")[0],r=i.findAxisModel("radiusAxis"),a=i.findAxisModel("angleAxis");t.coordSysDims=["radius","angle"],n.set("radius",r),n.set("angle",a),Uh(r)&&(o.set("radius",r),t.firstCategoryDimIndex=0),Uh(a)&&(o.set("angle",a),null==t.firstCategoryDimIndex&&(t.firstCategoryDimIndex=1))},geo:function(e,t,n,o){t.coordSysDims=["lng","lat"]},parallel:function(e,t,n,o){var i=e.ecModel,r=i.getComponent("parallel",e.get("parallelIndex")),a=t.coordSysDims=r.dimensions.slice();O(r.parallelAxisIndex,(function(e,r){var s=i.getComponent("parallelAxis",e),l=a[r];n.set(l,s),Uh(s)&&null==t.firstCategoryDimIndex&&(o.set(l,s),t.firstCategoryDimIndex=r)}))}};function Uh(e){return"category"===e.get("type")}function qh(e,t,n){var o,i,r,a,s=(n=n||{}).byIndex,l=n.stackedCoordDimension,u=!(!e||!e.get("stack"));if(O(t,(function(e,n){P(e)&&(t[n]=e={name:e}),u&&!e.isExtraCoord&&(s||o||!e.ordinalMeta||(o=e),i||"ordinal"===e.type||"time"===e.type||l&&l!==e.coordDim||(i=e))})),!i||s||o||(s=!0),i){r="__\0ecstackresult",a="__\0ecstackedover",o&&(o.createInvertedIndices=!0);var c=i.coordDim,d=i.type,f=0;O(t,(function(e){e.coordDim===c&&f++})),t.push({name:r,coordDim:c,coordDimIndex:f,type:d,isExtraCoord:!0,isCalculationCoord:!0}),f++,t.push({name:a,coordDim:a,coordDimIndex:f,type:d,isExtraCoord:!0,isCalculationCoord:!0})}return{stackedDimension:i&&i.name,stackedByDimension:o&&o.name,isStackedByIndex:s,stackedOverDimension:a,stackResultDimension:r}}function jh(e,t){return!!t&&t===e.getCalculationInfo("stackedDimension")}function Gh(e,t){return jh(e,t)?e.getCalculationInfo("stackResultDimension"):t}function Xh(e,t,n){n=n||{},Ru.isInstance(e)||(e=Ru.seriesDataToSource(e));var o,i=t.get("coordinateSystem"),r=Uu.get(i),a=function(e){var t=e.get("coordinateSystem"),n=new Wh(t),o=$h[t];if(o)return o(e,n,n.axisMap,n.categoryAxisMap),n}(t);a&&(o=w(a.coordSysDims,(function(e){var t={name:e},n=a.axisMap.get(e);if(n){var o=n.get("type");t.type=ph(o)}return t}))),o=o||r&&(r.getDimensionsInfo?r.getDimensionsInfo():r.dimensions.slice())||["x","y"];var s,l,u=Hh(e,{coordDimensions:o,generateCoord:n.generateCoord,encodeDefaulter:n.useEncodeDefaulter?N(Mu,o,t):null});a&&O(u,(function(e,t){var n=a.categoryAxisMap.get(e.coordDim);n&&(null==s&&(s=t),e.ordinalMeta=n.getOrdinalMeta()),null!=e.otherDims.itemName&&(l=!0)})),l||null==s||(u[s].otherDims.itemName=0);var c=qh(t,u),d=new wh(u,t);d.setCalculationInfo(c);var f=null!=s&&function(e){if(e.sourceFormat===Tu){var t=function(e){for(var t=0;t<e.length&&null==e[t];)t++;return e[t]}(e.data||[]);return null!=t&&!M(Si(t))}}(e)?function(e,t,n,o){return o===s?n:this.defaultDimValueGetter(e,t,n,o)}:null;return d.hasItemOption=!1,d.initData(e,null,f),d}function Yh(e){this._setting=e||{},this._extent=[1/0,-1/0],this._interval=0,this.init&&this.init.apply(this,arguments)}function Zh(e){this.categories=e.categories||[],this._needCollect=e.needCollect,this._deduplication=e.deduplication}Yh.prototype.parse=function(e){return e},Yh.prototype.getSetting=function(e){return this._setting[e]},Yh.prototype.contain=function(e){var t=this._extent;return e>=t[0]&&e<=t[1]},Yh.prototype.normalize=function(e){var t=this._extent;return t[1]===t[0]?.5:(e-t[0])/(t[1]-t[0])},Yh.prototype.scale=function(e){var t=this._extent;return e*(t[1]-t[0])+t[0]},Yh.prototype.unionExtent=function(e){var t=this._extent;e[0]<t[0]&&(t[0]=e[0]),e[1]>t[1]&&(t[1]=e[1])},Yh.prototype.unionExtentFromData=function(e,t){this.unionExtent(e.getApproximateExtent(t))},Yh.prototype.getExtent=function(){return this._extent.slice()},Yh.prototype.setExtent=function(e,t){var n=this._extent;isNaN(e)||(n[0]=e),isNaN(t)||(n[1]=t)},Yh.prototype.isBlank=function(){return this._isBlank},Yh.prototype.setBlank=function(e){this._isBlank=e},Yh.prototype.getLabel=null,Ui(Yh),Yi(Yh,{registerWhenExtend:!0}),Zh.createByAxisModel=function(e){var t=e.option,n=t.data,o=n&&w(n,eg);return new Zh({categories:o,needCollect:!o,deduplication:!1!==t.dedplication})};var Jh=Zh.prototype;function Qh(e){return e._map||(e._map=Q(e.categories))}function eg(e){return L(e)&&null!=e.value?e.value:e+""}Jh.getOrdinal=function(e){return Qh(this).get(e)},Jh.parseAndCollect=function(e){var t,n=this._needCollect;if("string"!=typeof e&&!n)return e;if(n&&!this._deduplication)return this.categories[t=this.categories.length]=e,t;var o=Qh(this);return null==(t=o.get(e))&&(n?(this.categories[t=this.categories.length]=e,o.set(e,t)):t=NaN),t};var tg=Yh.prototype,ng=Yh.extend({type:"ordinal",init:function(e,t){e&&!M(e)||(e=new Zh({categories:e})),this._ordinalMeta=e,this._extent=t||[0,e.categories.length-1]},parse:function(e){return"string"==typeof e?this._ordinalMeta.getOrdinal(e):Math.round(e)},contain:function(e){return e=this.parse(e),tg.contain.call(this,e)&&null!=this._ordinalMeta.categories[e]},normalize:function(e){return tg.normalize.call(this,this.parse(e))},scale:function(e){return Math.round(tg.scale.call(this,e))},getTicks:function(){for(var e=[],t=this._extent,n=t[0];n<=t[1];)e.push(n),n++;return e},getLabel:function(e){if(!this.isBlank())return this._ordinalMeta.categories[e]},count:function(){return this._extent[1]-this._extent[0]+1},unionExtentFromData:function(e,t){this.unionExtent(e.getApproximateExtent(t))},getOrdinalMeta:function(){return this._ordinalMeta},niceTicks:te,niceExtent:te});ng.create=function(){return new ng};var og=Tl;function ig(e){return _l(e)+2}function rg(e,t,n){e[t]=Math.max(Math.min(e[t],n[1]),n[0])}function ag(e,t){isFinite(e[0])||(e[0]=t[0]),isFinite(e[1])||(e[1]=t[1]),rg(e,0,t),rg(e,1,t),e[0]>e[1]&&(e[0]=e[1])}var sg=Tl,lg=Yh.extend({type:"interval",_interval:0,_intervalPrecision:2,setExtent:function(e,t){var n=this._extent;isNaN(e)||(n[0]=parseFloat(e)),isNaN(t)||(n[1]=parseFloat(t))},unionExtent:function(e){var t=this._extent;e[0]<t[0]&&(t[0]=e[0]),e[1]>t[1]&&(t[1]=e[1]),lg.prototype.setExtent.call(this,t[0],t[1])},getInterval:function(){return this._interval},setInterval:function(e){this._interval=e,this._niceExtent=this._extent.slice(),this._intervalPrecision=ig(e)},getTicks:function(e){var t=this._interval,n=this._extent,o=this._niceExtent,i=this._intervalPrecision,r=[];if(!t)return r;n[0]<o[0]&&r.push(e?sg(o[0]-t,i):n[0]);for(var a=o[0];a<=o[1]&&(r.push(a),(a=sg(a+t,i))!==r[r.length-1]);)if(1e4<r.length)return[];var s=r.length?r[r.length-1]:o[1];return n[1]>s&&r.push(e?sg(s+t,i):n[1]),r},getMinorTicks:function(e){for(var t=this.getTicks(!0),n=[],o=this.getExtent(),i=1;i<t.length;i++){for(var r=t[i-1],a=0,s=[],l=(t[i]-r)/e;a<e-1;){var u=Tl(r+(a+1)*l);u>o[0]&&u<o[1]&&s.push(u),a++}n.push(s)}return n},getLabel:function(e,t){if(null==e)return"";var n=t&&t.precision;return null==n?n=_l(e)||0:"auto"===n&&(n=this._intervalPrecision),Bl(e=sg(e,n,!0))},niceTicks:function(e,t,n){e=e||5;var o=this._extent,i=o[1]-o[0];if(isFinite(i)){i<0&&(i=-i,o.reverse());var r=function(e,t,n,o){var i={},r=i.interval=Ml((e[1]-e[0])/t,!0);null!=n&&r<n&&(r=i.interval=n),null!=o&&o<r&&(r=i.interval=o);var a=i.intervalPrecision=ig(r);return ag(i.niceTickExtent=[og(Math.ceil(e[0]/r)*r,a),og(Math.floor(e[1]/r)*r,a)],e),i}(o,e,t,n);this._intervalPrecision=r.intervalPrecision,this._interval=r.interval,this._niceExtent=r.niceTickExtent}},niceExtent:function(e){var t=this._extent;if(t[0]===t[1])if(0!==t[0]){var n=t[0];e.fixMax||(t[1]+=n/2),t[0]-=n/2}else t[1]=1;isFinite(t[1]-t[0])||(t[0]=0,t[1]=1),this.niceTicks(e.splitNumber,e.minInterval,e.maxInterval);var o=this._interval;e.fixMin||(t[0]=sg(Math.floor(t[0]/o)*o)),e.fixMax||(t[1]=sg(Math.ceil(t[1]/o)*o))}});lg.create=function(){return new lg};var ug="__ec_stack_",cg="undefined"!=typeof Float32Array?Float32Array:Array;function dg(e){return e.get("stack")||ug+e.seriesIndex}function fg(e){return e.dim+e.index}function hg(e,t){var n=[];return t.eachSeriesByType(e,(function(e){bg(e)&&!Cg(e)&&n.push(e)})),n}function gg(e){var t=function(e){var t={};O(e,(function(e){var n=e.coordinateSystem.getBaseAxis();if("time"===n.type||"value"===n.type)for(var o=e.getData(),i=n.dim+"_"+n.index,r=o.mapDimension(n.dim),a=0,s=o.count();a<s;++a){var l=o.get(r,a);t[i]?t[i].push(l):t[i]=[l]}}));var n=[];for(var o in t)if(t.hasOwnProperty(o)){var i=t[o];if(i){i.sort((function(e,t){return e-t}));for(var r=null,a=1;a<i.length;++a){var s=i[a]-i[a-1];0<s&&(r=null===r?s:Math.min(r,s))}n[o]=r}}return n}(e),n=[];return O(e,(function(e){var o,i=e.coordinateSystem.getBaseAxis(),r=i.getExtent();if("category"===i.type)o=i.getBandWidth();else if("value"===i.type||"time"===i.type){var a=t[i.dim+"_"+i.index],s=Math.abs(r[1]-r[0]),l=i.scale.getExtent(),u=Math.abs(l[1]-l[0]);o=a?s/u*a:s}else{var c=e.getData();o=Math.abs(r[1]-r[0])/c.count()}var d=Cl(e.get("barWidth"),o),f=Cl(e.get("barMaxWidth"),o),h=Cl(e.get("barMinWidth")||1,o),g=e.get("barGap"),m=e.get("barCategoryGap");n.push({bandWidth:o,barWidth:d,barMaxWidth:f,barMinWidth:h,barGap:g,barCategoryGap:m,axisKey:fg(i),stackId:dg(e)})})),mg(n)}function mg(e){var t={};O(e,(function(e,n){var o=e.axisKey,i=e.bandWidth,r=t[o]||{bandWidth:i,remainedWidth:i,autoWidthCount:0,categoryGap:"20%",gap:"30%",stacks:{}},a=r.stacks;t[o]=r;var s=e.stackId;a[s]||r.autoWidthCount++,a[s]=a[s]||{width:0,maxWidth:0};var l=e.barWidth;l&&!a[s].width&&(a[s].width=l,l=Math.min(r.remainedWidth,l),r.remainedWidth-=l);var u=e.barMaxWidth;u&&(a[s].maxWidth=u);var c=e.barMinWidth;c&&(a[s].minWidth=c);var d=e.barGap;null!=d&&(r.gap=d);var f=e.barCategoryGap;null!=f&&(r.categoryGap=f)}));var n={};return O(t,(function(e,t){n[t]={};var o=e.stacks,i=e.bandWidth,r=Cl(e.categoryGap,i),a=Cl(e.gap,1),s=e.remainedWidth,l=e.autoWidthCount,u=(s-r)/(l+(l-1)*a);u=Math.max(u,0),O(o,(function(e){var t=e.maxWidth,n=e.minWidth;if(e.width)o=e.width,t&&(o=Math.min(o,t)),n&&(o=Math.max(o,n)),e.width=o,s-=o+a*o,l--;else{var o=u;t&&t<o&&(o=Math.min(t,s)),n&&o<n&&(o=n),o!==u&&(e.width=o,s-=o+a*o,l--)}})),u=(s-r)/(l+(l-1)*a),u=Math.max(u,0);var c,d=0;O(o,(function(e,t){e.width||(e.width=u),d+=(c=e).width*(1+a)})),c&&(d-=c.width*a);var f=-d/2;O(o,(function(e,o){n[t][o]=n[t][o]||{bandWidth:i,offset:f,width:e.width},f+=e.width*(1+a)}))})),n}function pg(e,t,n){if(e&&t){var o=e[fg(t)];return null!=o&&null!=n&&(o=o[dg(n)]),o}}function vg(e,t){var n=hg(e,t),o=gg(n),i={};O(n,(function(e){var t=e.getData(),n=e.coordinateSystem,r=n.getBaseAxis(),a=dg(e),s=o[fg(r)][a],l=s.offset,u=s.width,c=n.getOtherAxis(r),d=e.get("barMinHeight")||0;i[a]=i[a]||[],t.setLayout({bandWidth:s.bandWidth,offset:l,size:u});for(var f=t.mapDimension(c.dim),h=t.mapDimension(r.dim),g=jh(t,f),m=c.isHorizontal(),p=Tg(0,c),v=0,y=t.count();v<y;v++){var b,C,T,x,E,_=t.get(f,v),I=t.get(h,v),D=0<=_?"p":"n",O=p;g&&(i[a][I]||(i[a][I]={p:p,n:p}),O=i[a][I][D]),m?(b=O,C=(E=n.dataToPoint([_,I]))[1]+l,T=E[0]-p,x=u,Math.abs(T)<d&&(T=(T<0?-1:1)*d),isNaN(T)||g&&(i[a][I][D]+=T)):(b=(E=n.dataToPoint([I,_]))[0]+l,C=O,T=u,x=E[1]-p,Math.abs(x)<d&&(x=(x<=0?-1:1)*d),isNaN(x)||g&&(i[a][I][D]+=x)),t.setItemLayout(v,{x:b,y:C,width:T,height:x})}}),this)}var yg={seriesType:"bar",plan:Qc(),reset:function(e){if(bg(e)&&Cg(e)){var t=e.getData(),n=e.coordinateSystem,o=n.grid.getRect(),i=n.getBaseAxis(),r=n.getOtherAxis(i),a=t.mapDimension(r.dim),s=t.mapDimension(i.dim),l=r.isHorizontal(),u=l?0:1,c=pg(gg([e]),i,e).width;return.5<c||(c=.5),{progress:function(e,t){for(var i,d=e.count,f=new cg(2*d),h=new cg(2*d),g=new cg(d),m=[],p=[],v=0,y=0;null!=(i=e.next());)p[u]=t.get(a,i),p[1-u]=t.get(s,i),m=n.dataToPoint(p,null,m),h[v]=l?o.x+o.width:m[0],f[v++]=m[0],h[v]=l?m[1]:o.y+o.height,f[v++]=m[1],g[y++]=i;t.setLayout({largePoints:f,largeDataIndices:g,largeBackgroundPoints:h,barWidth:c,valueAxisStart:Tg(0,r),backgroundStart:l?o.x:o.y,valueAxisHorizontal:l})}}}}};function bg(e){return e.coordinateSystem&&"cartesian2d"===e.coordinateSystem.type}function Cg(e){return e.pipelineContext&&e.pipelineContext.large}function Tg(e,t){return t.toGlobalCoord(t.dataToCoord("log"===t.type?1:0))}var xg=lg.prototype,Eg=Math.ceil,_g=Math.floor,Ig=36e5,Dg=864e5,Og=lg.extend({type:"time",getLabel:function(e){var t=this._stepLvl,n=new Date(e);return Yl(t[0],n,this.getSetting("useUTC"))},niceExtent:function(e){var t=this._extent;if(t[0]===t[1]&&(t[0]-=Dg,t[1]+=Dg),t[1]===-1/0&&t[0]===1/0){var n=new Date;t[1]=+new Date(n.getFullYear(),n.getMonth(),n.getDate()),t[0]=t[1]-Dg}this.niceTicks(e.splitNumber,e.minInterval,e.maxInterval);var o=this._interval;e.fixMin||(t[0]=Tl(_g(t[0]/o)*o)),e.fixMax||(t[1]=Tl(Eg(t[1]/o)*o))},niceTicks:function(e,t,n){var o=this._extent,i=o[1]-o[0],r=i/(e=e||10);null!=t&&r<t&&(r=t),null!=n&&n<r&&(r=n);var a=wg.length,s=function(e,t,n,o){for(;n<o;){var i=n+o>>>1;e[i][1]<t?n=1+i:o=i}return n}(wg,r,0,a),l=wg[Math.min(s,a-1)],u=l[1];"year"===l[0]&&(u*=Ml(i/u/e,!0));var c=this.getSetting("useUTC")?0:60*new Date(+o[0]||+o[1]).getTimezoneOffset()*1e3,d=[Math.round(Eg((o[0]-c)/u)*u+c),Math.round(_g((o[1]-c)/u)*u+c)];ag(d,o),this._stepLvl=l,this._interval=u,this._niceExtent=d},parse:function(e){return+kl(e)}});O(["contain","normalize"],(function(e){Og.prototype[e]=function(t){return xg[e].call(this,this.parse(t))}}));var wg=[["hh:mm:ss",1e3],["hh:mm:ss",5e3],["hh:mm:ss",1e4],["hh:mm:ss",15e3],["hh:mm:ss",3e4],["hh:mm\nMM-dd",6e4],["hh:mm\nMM-dd",3e5],["hh:mm\nMM-dd",6e5],["hh:mm\nMM-dd",9e5],["hh:mm\nMM-dd",18e5],["hh:mm\nMM-dd",Ig],["hh:mm\nMM-dd",72e5],["hh:mm\nMM-dd",6*Ig],["hh:mm\nMM-dd",432e5],["MM-dd\nyyyy",Dg],["MM-dd\nyyyy",2*Dg],["MM-dd\nyyyy",3*Dg],["MM-dd\nyyyy",4*Dg],["MM-dd\nyyyy",5*Dg],["MM-dd\nyyyy",6*Dg],["week",7*Dg],["MM-dd\nyyyy",864e6],["week",14*Dg],["week",21*Dg],["month",31*Dg],["week",42*Dg],["month",62*Dg],["week",70*Dg],["quarter",95*Dg],["month",31*Dg*4],["month",13392e6],["half-year",16416e6],["month",31*Dg*8],["month",26784e6],["year",380*Dg]];Og.create=function(e){return new Og({useUTC:e.ecModel.get("useUTC")})};var Rg=Yh.prototype,Sg=lg.prototype,kg=_l,Ag=Tl,Ng=Math.floor,Mg=Math.ceil,Kg=Math.pow,Pg=Math.log,Lg=Yh.extend({type:"log",base:10,$constructor:function(){Yh.apply(this,arguments),this._originalScale=new lg},getTicks:function(e){var t=this._originalScale,n=this._extent,o=t.getExtent();return w(Sg.getTicks.call(this,e),(function(e){var i=Tl(Kg(this.base,e));return i=e===n[0]&&t.__fixMin?Bg(i,o[0]):i,e===n[1]&&t.__fixMax?Bg(i,o[1]):i}),this)},getMinorTicks:Sg.getMinorTicks,getLabel:Sg.getLabel,scale:function(e){return e=Rg.scale.call(this,e),Kg(this.base,e)},setExtent:function(e,t){var n=this.base;e=Pg(e)/Pg(n),t=Pg(t)/Pg(n),Sg.setExtent.call(this,e,t)},getExtent:function(){var e=this.base,t=Rg.getExtent.call(this);t[0]=Kg(e,t[0]),t[1]=Kg(e,t[1]);var n=this._originalScale,o=n.getExtent();return n.__fixMin&&(t[0]=Bg(t[0],o[0])),n.__fixMax&&(t[1]=Bg(t[1],o[1])),t},unionExtent:function(e){this._originalScale.unionExtent(e);var t=this.base;e[0]=Pg(e[0])/Pg(t),e[1]=Pg(e[1])/Pg(t),Rg.unionExtent.call(this,e)},unionExtentFromData:function(e,t){this.unionExtent(e.getApproximateExtent(t))},niceTicks:function(e){e=e||10;var t=this._extent,n=t[1]-t[0];if(!(n==1/0||n<=0)){var o=Al(n);for(e/n*o<=.5&&(o*=10);!isNaN(o)&&Math.abs(o)<1&&0<Math.abs(o);)o*=10;var i=[Tl(Mg(t[0]/o)*o),Tl(Ng(t[1]/o)*o)];this._interval=o,this._niceExtent=i}},niceExtent:function(e){Sg.niceExtent.call(this,e);var t=this._originalScale;t.__fixMin=e.fixMin,t.__fixMax=e.fixMax}});function Bg(e,t){return Ag(e,kg(t))}function Fg(e,t){var n,o,i,r=e.type,a=t.getMin(),s=t.getMax(),l=e.getExtent();"ordinal"===r?n=t.getCategories().length:(M(o=t.get("boundaryGap"))||(o=[o||0,o||0]),"boolean"==typeof o[0]&&(o=[0,0]),o[0]=Cl(o[0],1),o[1]=Cl(o[1],1),i=l[1]-l[0]||Math.abs(l[0])),"dataMin"===a?a=l[0]:"function"==typeof a&&(a=a({min:l[0],max:l[1]})),"dataMax"===s?s=l[1]:"function"==typeof s&&(s=s({min:l[0],max:l[1]}));var u=null!=a,c=null!=s;null==a&&(a="ordinal"===r?n?0:NaN:l[0]-o[0]*i),null==s&&(s="ordinal"===r?n?n-1:NaN:l[1]+o[1]*i),null!=a&&isFinite(a)||(a=NaN),null!=s&&isFinite(s)||(s=NaN),e.setBlank(V(a)||V(s)||"ordinal"===r&&!e.getOrdinalMeta().categories.length),t.getNeedCrossZero()&&(0<a&&0<s&&!u&&(a=0),a<0&&s<0&&!c&&(s=0));var d=t.ecModel;if(d&&"time"===r){var f,h=hg("bar",d);if(O(h,(function(e){f|=e.getBaseAxis()===t.axis})),f){var g=gg(h),m=function(e,t,n,o){var i=n.axis.getExtent(),r=i[1]-i[0],a=pg(o,n.axis);if(void 0===a)return{min:e,max:t};var s=1/0;O(a,(function(e){s=Math.min(e.offset,s)}));var l=-1/0;O(a,(function(e){l=Math.max(e.offset+e.width,l)})),s=Math.abs(s),l=Math.abs(l);var u=s+l,c=t-e,d=c/(1-(s+l)/r)-c;return{min:e-=s/u*d,max:t+=l/u*d}}(a,s,t,g);a=m.min,s=m.max}}return{extent:[a,s],fixMin:u,fixMax:c}}function zg(e,t){var n=Fg(e,t),o=n.extent,i=t.get("splitNumber");"log"===e.type&&(e.base=t.get("logBase"));var r=e.type;e.setExtent(o[0],o[1]),e.niceExtent({splitNumber:i,fixMin:n.fixMin,fixMax:n.fixMax,minInterval:"interval"===r||"time"===r?t.get("minInterval"):null,maxInterval:"interval"===r||"time"===r?t.get("maxInterval"):null});var a=t.get("interval");null!=a&&e.setInterval&&e.setInterval(a)}function Vg(e,t){if(t=t||e.get("type"))switch(t){case"category":return new ng(e.getOrdinalMeta?e.getOrdinalMeta():e.getCategories(),[1/0,-1/0]);case"value":return new lg;default:return(Yh.getClass(t)||lg).create(e)}}function Hg(e){var t,n=e.getLabelModel().get("formatter"),o="category"===e.type?e.scale.getExtent()[0]:null;return"string"==typeof n?(t=n,n=function(n){return n=e.scale.getLabel(n),t.replace("{value}",null!=n?n:"")}):"function"==typeof n?function(t,i){return null!=o&&(i=t-o),n(Wg(e,t),i)}:function(t){return e.scale.getLabel(t)}}function Wg(e,t){return"category"===e.type?e.scale.getLabel(t):t}function $g(e){var t=e.get("interval");return null==t?"auto":t}function Ug(e){return"category"===e.type&&0===$g(e.getLabelModel())}O(["contain","normalize"],(function(e){Lg.prototype[e]=function(t){return t=Pg(t)/Pg(this.base),Rg[e].call(this,t)}})),Lg.create=function(){return new Lg};var qg={getMin:function(e){var t=this.option,n=e||null==t.rangeStart?t.min:t.rangeStart;return this.axis&&null!=n&&"dataMin"!==n&&"function"!=typeof n&&!V(n)&&(n=this.axis.scale.parse(n)),n},getMax:function(e){var t=this.option,n=e||null==t.rangeEnd?t.max:t.rangeEnd;return this.axis&&null!=n&&"dataMax"!==n&&"function"!=typeof n&&!V(n)&&(n=this.axis.scale.parse(n)),n},getNeedCrossZero:function(){var e=this.option;return null==e.rangeStart&&null==e.rangeEnd&&!e.scale},getCoordSysModel:te,setRange:function(e,t){this.option.rangeStart=e,this.option.rangeEnd=t},resetRange:function(){this.option.rangeStart=this.option.rangeEnd=null}},jg=hs({type:"triangle",shape:{cx:0,cy:0,width:0,height:0},buildPath:function(e,t){var n=t.cx,o=t.cy,i=t.width/2,r=t.height/2;e.moveTo(n,o-r),e.lineTo(n+i,o+r),e.lineTo(n-i,o+r),e.closePath()}}),Gg=hs({type:"diamond",shape:{cx:0,cy:0,width:0,height:0},buildPath:function(e,t){var n=t.cx,o=t.cy,i=t.width/2,r=t.height/2;e.moveTo(n,o-r),e.lineTo(n+i,o),e.lineTo(n,o+r),e.lineTo(n-i,o),e.closePath()}}),Xg=hs({type:"pin",shape:{x:0,y:0,width:0,height:0},buildPath:function(e,t){var n=t.x,o=t.y,i=t.width/5*3,r=Math.max(i,t.height),a=i/2,s=a*a/(r-a),l=o-r+a+s,u=Math.asin(s/a),c=Math.cos(u)*a,d=Math.sin(u),f=Math.cos(u),h=.6*a,g=.7*a;e.moveTo(n-c,l+s),e.arc(n,l,a,Math.PI-u,2*Math.PI+u),e.bezierCurveTo(n+c-d*h,l+s+f*h,n,o-g,n,o),e.bezierCurveTo(n,o-g,n-c+d*h,l+s+f*h,n-c,l+s),e.closePath()}}),Yg=hs({type:"arrow",shape:{x:0,y:0,width:0,height:0},buildPath:function(e,t){var n=t.height,o=t.x,i=t.y,r=t.width/3*2;e.moveTo(o,i),e.lineTo(o+r,i+n),e.lineTo(o,i+n/4*3),e.lineTo(o-r,i+n),e.lineTo(o,i),e.closePath()}}),Zg={line:function(e,t,n,o,i){i.x1=e,i.y1=t+o/2,i.x2=e+n,i.y2=t+o/2},rect:function(e,t,n,o,i){i.x=e,i.y=t,i.width=n,i.height=o},roundRect:function(e,t,n,o,i){i.x=e,i.y=t,i.width=n,i.height=o,i.r=Math.min(n,o)/4},square:function(e,t,n,o,i){var r=Math.min(n,o);i.x=e,i.y=t,i.width=r,i.height=r},circle:function(e,t,n,o,i){i.cx=e+n/2,i.cy=t+o/2,i.r=Math.min(n,o)/2},diamond:function(e,t,n,o,i){i.cx=e+n/2,i.cy=t+o/2,i.width=n,i.height=o},pin:function(e,t,n,o,i){i.x=e+n/2,i.y=t+o/2,i.width=n,i.height=o},arrow:function(e,t,n,o,i){i.x=e+n/2,i.y=t+o/2,i.width=n,i.height=o},triangle:function(e,t,n,o,i){i.cx=e+n/2,i.cy=t+o/2,i.width=n,i.height=o}},Jg={};O({line:ja,rect:Ua,roundRect:Ua,square:Ua,circle:Aa,diamond:Gg,pin:Xg,arrow:Yg,triangle:jg},(function(e,t){Jg[t]=new e}));var Qg=hs({type:"symbol",shape:{symbolType:"",x:0,y:0,width:0,height:0},calculateTextPosition:function(e,t,n){var o=so(e,t,n),i=this.shape;return i&&"pin"===i.symbolType&&"inside"===t.textPosition&&(o.y=n.y+.4*n.height),o},buildPath:function(e,t,n){var o=t.symbolType;if("none"!==o){var i=Jg[o];i=i||Jg[o="rect"],Zg[o](t.x,t.y,t.width,t.height,i.shape),i.buildPath(e,i.shape,n)}}});function em(e,t){if("image"!==this.type){var n=this.style,o=this.shape;o&&"line"===o.symbolType?n.stroke=e:this.__isEmptyBrush?(n.stroke=e,n.fill=t||"#fff"):(n.fill&&(n.fill=e),n.stroke&&(n.stroke=e)),this.dirty(!1)}}function tm(e,t,n,o,i,r,a){var s,l=0===e.indexOf("empty");return l&&(e=e.substr(5,1).toLowerCase()+e.substr(6)),(s=0===e.indexOf("image://")?vs(e.slice(8),new En(t,n,o,i),a?"center":"cover"):0===e.indexOf("path://")?ps(e.slice(7),{},new En(t,n,o,i),a?"center":"cover"):new Qg({shape:{symbolType:e,x:t,y:n,width:o,height:i}})).__isEmptyBrush=l,s.setColor=em,s.setColor(r),s}var nm=(Object.freeze||Object)({createList:function(e){return Xh(e.getSource(),e)},getLayoutRect:au,dataStack:{isDimensionStacked:jh,enableDataStack:qh,getStackedDimension:Gh},createScale:function(e,t){var n=t;hl.isInstance(t)||I(n=new hl(t),qg);var o=Vg(n);return o.setExtent(e[0],e[1]),zg(o,n),o},mixinAxisModelCommonMethods:function(e){I(e,qg)},completeDimensions:zh,createDimensions:Hh,createSymbol:tm});function om(e,t){return Math.abs(e-t)<1e-8}function im(e,t,n){var o=0,i=e[0];if(!i)return!1;for(var r=1;r<e.length;r++){var a=e[r];o+=ta(i[0],i[1],a[0],a[1],t,n),i=a}var s=e[0];return om(i[0],s[0])&&om(i[1],s[1])||(o+=ta(i[0],i[1],s[0],s[1],t,n)),0!==o}function rm(e,t,n){if(this.name=e,this.geometries=t,n)n=[n[0],n[1]];else{var o=this.getBoundingRect();n=[o.x+o.width/2,o.y+o.height/2]}this.center=n}function am(e,t,n){for(var o=[],i=t[0],r=t[1],a=0;a<e.length;a+=2){var s=e.charCodeAt(a)-64,l=e.charCodeAt(a+1)-64;s=s>>1^-(1&s),l=l>>1^-(1&l),i=s+=i,r=l+=r,o.push([s/n,l/n])}return o}function sm(e,t){return function(e){if(e.UTF8Encoding){var t=e.UTF8Scale;null==t&&(t=1024);for(var n=e.features,o=0;o<n.length;o++)for(var i=n[o].geometry,r=i.coordinates,a=i.encodeOffsets,s=0;s<r.length;s++){var l=r[s];if("Polygon"===i.type)r[s]=am(l,a[s],t);else if("MultiPolygon"===i.type)for(var u=0;u<l.length;u++)l[u]=am(l[u],a[s][u],t)}e.UTF8Encoding=!1}}(e),w(S(e.features,(function(e){return e.geometry&&e.properties&&0<e.geometry.coordinates.length})),(function(e){var n=e.properties,o=e.geometry,i=o.coordinates,r=[];"Polygon"===o.type&&r.push({type:"polygon",exterior:i[0],interiors:i.slice(1)}),"MultiPolygon"===o.type&&O(i,(function(e){e[0]&&r.push({type:"polygon",exterior:e[0],interiors:e.slice(1)})}));var a=new rm(n[t||"name"],r,n.cp);return a.properties=n,a}))}rm.prototype={constructor:rm,properties:null,getBoundingRect:function(){var e=this._rect;if(e)return e;for(var t=Number.MAX_VALUE,n=[t,t],o=[-t,-t],i=[],r=[],a=this.geometries,s=0;s<a.length;s++)"polygon"===a[s].type&&(Rr(a[s].exterior,i,r),Te(n,n,i),xe(o,o,r));return 0===s&&(n[0]=n[1]=o[0]=o[1]=0),this._rect=new En(n[0],n[1],o[0]-n[0],o[1]-n[1])},contain:function(e){var t=this.getBoundingRect(),n=this.geometries;if(!t.contain(e[0],e[1]))return!1;e:for(var o=0,i=n.length;o<i;o++)if("polygon"===n[o].type){var r=n[o].interiors;if(im(n[o].exterior,e[0],e[1])){for(var a=0;a<(r?r.length:0);a++)if(im(r[a]))continue e;return!0}}return!1},transformTo:function(e,t,n,o){var i=this.getBoundingRect(),r=i.width/i.height;n?o=o||n/r:n=r*o;for(var a=new En(e,t,n,o),s=i.calculateTransform(a),l=this.geometries,u=0;u<l.length;u++)if("polygon"===l[u].type){for(var c=l[u].exterior,d=l[u].interiors,f=0;f<c.length;f++)Ce(c[f],c[f],s);for(var h=0;h<(d?d.length:0);h++)for(f=0;f<d[h].length;f++)Ce(d[h][f],d[h][f],s)}(i=this._rect).copy(a),this.center=[i.x+i.width/2,i.y+i.height/2]},cloneShallow:function(e){null==e&&(e=this.name);var t=new rm(e,this.geometries,this.center);return t._rect=this._rect,t.transformTo=null,t}};var lm=Pi();function um(e,t){var n,o=cm(e,"labels"),i=$g(t);return dm(o,i)||fm(o,i,{labels:K(i)?gm(e,i):hm(e,n="auto"===i?function(e){var t=lm(e).autoInterval;return null!=t?t:lm(e).autoInterval=e.calculateCategoryInterval()}(e):i),labelCategoryInterval:n})}function cm(e,t){return lm(e)[t]||(lm(e)[t]=[])}function dm(e,t){for(var n=0;n<e.length;n++)if(e[n].key===t)return e[n].value}function fm(e,t,n){return e.push({key:t,value:n}),n}function hm(e,t,n){var o=Hg(e),i=e.scale,r=i.getExtent(),a=e.getLabelModel(),s=[],l=Math.max((t||0)+1,1),u=r[0],c=i.count();0!==u&&1<l&&2<c/l&&(u=Math.round(Math.ceil(u/l)*l));var d=Ug(e),f=a.get("showMinLabel")||d,h=a.get("showMaxLabel")||d;f&&u!==r[0]&&m(r[0]);for(var g=u;g<=r[1];g+=l)m(g);function m(e){s.push(n?e:{formattedLabel:o(e),rawLabel:i.getLabel(e),tickValue:e})}return h&&g-l!==r[1]&&m(r[1]),s}function gm(e,t,n){var o=e.scale,i=Hg(e),r=[];return O(o.getTicks(),(function(e){var a=o.getLabel(e);t(e,a)&&r.push(n?e:{formattedLabel:i(e),rawLabel:a,tickValue:e})})),r}var mm=[0,1],pm=function(e,t,n){this.dim=e,this.scale=t,this._extent=n||[0,0],this.inverse=!1,this.onBand=!1};function vm(e,t){var n=(e[1]-e[0])/t/2;e[0]+=n,e[1]-=n}pm.prototype={constructor:pm,contain:function(e){var t=this._extent,n=Math.min(t[0],t[1]),o=Math.max(t[0],t[1]);return n<=e&&e<=o},containData:function(e){return this.scale.contain(e)},getExtent:function(){return this._extent.slice()},getPixelPrecision:function(e){return Il(e||this.scale.getExtent(),this._extent)},setExtent:function(e,t){var n=this._extent;n[0]=e,n[1]=t},dataToCoord:function(e,t){var n=this._extent,o=this.scale;return e=o.normalize(e),this.onBand&&"ordinal"===o.type&&vm(n=n.slice(),o.count()),bl(e,mm,n,t)},coordToData:function(e,t){var n=this._extent,o=this.scale;this.onBand&&"ordinal"===o.type&&vm(n=n.slice(),o.count());var i=bl(e,n,mm,t);return this.scale.scale(i)},pointToData:function(e,t){},getTicksCoords:function(e){var t=(e=e||{}).tickModel||this.getTickModel(),n=w(function(e,t){return"category"===e.type?function(e,t){var n,o,i=cm(e,"ticks"),r=$g(t),a=dm(i,r);if(a)return a;if(t.get("show")&&!e.scale.isBlank()||(n=[]),K(r))n=gm(e,r,!0);else if("auto"===r){var s=um(e,e.getLabelModel());o=s.labelCategoryInterval,n=w(s.labels,(function(e){return e.tickValue}))}else n=hm(e,o=r,!0);return fm(i,r,{ticks:n,tickCategoryInterval:o})}(e,t):{ticks:e.scale.getTicks()}}(this,t).ticks,(function(e){return{coord:this.dataToCoord(e),tickValue:e}}),this);return function(e,t,n,o){var i=t.length;if(e.onBand&&!n&&i){var r,a=e.getExtent();if(1===i)t[0].coord=a[0],r=t[1]={coord:a[0]};else{var s=(t[i-1].coord-t[0].coord)/(t[i-1].tickValue-t[0].tickValue);O(t,(function(e){e.coord-=s/2}));var l=e.scale.getExtent();t.push(r={coord:t[i-1].coord+s*(1+l[1]-t[i-1].tickValue)})}var u=a[0]>a[1];c(t[0].coord,a[0])&&(o?t[0].coord=a[0]:t.shift()),o&&c(a[0],t[0].coord)&&t.unshift({coord:a[0]}),c(a[1],r.coord)&&(o?r.coord=a[1]:t.pop()),o&&c(r.coord,a[1])&&t.push({coord:a[1]})}function c(e,t){return e=Tl(e),t=Tl(t),u?t<e:e<t}}(this,n,t.get("alignWithLabel"),e.clamp),n},getMinorTicksCoords:function(){if("ordinal"===this.scale.type)return[];var e=this.model.getModel("minorTick").get("splitNumber");return 0<e&&e<100||(e=5),w(this.scale.getMinorTicks(e),(function(e){return w(e,(function(e){return{coord:this.dataToCoord(e),tickValue:e}}),this)}),this)},getViewLabels:function(){return function(e){return"category"===e.type?function(e){var t=e.getLabelModel(),n=um(e,t);return!t.get("show")||e.scale.isBlank()?{labels:[],labelCategoryInterval:n.labelCategoryInterval}:n}(e):function(e){var t=e.scale.getTicks(),n=Hg(e);return{labels:w(t,(function(t,o){return{formattedLabel:n(t,o),rawLabel:e.scale.getLabel(t),tickValue:t}}))}}(e)}(this).labels},getLabelModel:function(){return this.model.getModel("axisLabel")},getTickModel:function(){return this.model.getModel("axisTick")},getBandWidth:function(){var e=this._extent,t=this.scale.getExtent(),n=t[1]-t[0]+(this.onBand?1:0);0===n&&(n=1);var o=Math.abs(e[1]-e[0]);return Math.abs(o)/n},isHorizontal:null,getRotate:null,calculateCategoryInterval:function(){return function(e){var t=function(e){var t=e.getLabelModel();return{axisRotate:e.getRotate?e.getRotate():e.isHorizontal&&!e.isHorizontal()?90:0,labelRotate:t.get("rotate")||0,font:t.getFont()}}(e),n=Hg(e),o=(t.axisRotate-t.labelRotate)/180*Math.PI,i=e.scale,r=i.getExtent(),a=i.count();if(r[1]-r[0]<1)return 0;var s=1;40<a&&(s=Math.max(1,Math.floor(a/40)));for(var l=r[0],u=e.dataToCoord(l+1)-e.dataToCoord(l),c=Math.abs(u*Math.cos(o)),d=Math.abs(u*Math.sin(o)),f=0,h=0;l<=r[1];l+=s){var g,m=io(n(l),t.font,"center","top");g=1.3*m.height,f=Math.max(f,1.3*m.width,7),h=Math.max(h,g,7)}var p=f/c,v=h/d;isNaN(p)&&(p=1/0),isNaN(v)&&(v=1/0);var y=Math.max(0,Math.floor(Math.min(p,v))),b=lm(e.model),C=e.getExtent(),T=b.lastAutoInterval,x=b.lastTickCount;return null!=T&&null!=x&&Math.abs(T-y)<=1&&Math.abs(x-a)<=1&&y<T&&b.axisExtend0===C[0]&&b.axisExtend1===C[1]?y=T:(b.lastTickCount=a,b.lastAutoInterval=y,b.axisExtend0=C[0],b.axisExtend1=C[1]),y}(this)}};var ym=sm,bm={};O(["map","each","filter","indexOf","inherits","reduce","filter","bind","curry","isArray","isString","isObject","isFunction","extend","defaults","clone","merge"],(function(e){bm[e]=ne[e]}));var Cm={};function Tm(e,t){var n=e.mapDimension("defaultedLabel",!0),o=n.length;if(1===o)return Ic(e,t,n[0]);if(o){for(var i=[],r=0;r<n.length;r++){var a=Ic(e,t,n[r]);i.push(a)}return i.join(" ")}}function xm(e,t,n){_n.call(this),this.updateData(e,t,n)}O(["extendShape","extendPath","makePath","makeImage","mergePath","resizePath","createIcon","setHoverStyle","setLabelStyle","setTextStyle","setText","getFont","updateProps","initProps","getTransform","clipPointsByRect","clipRectByRect","registerShape","getShapeClass","Group","Image","Text","Circle","Sector","Ring","Polygon","Polyline","Rect","Line","BezierCurve","Arc","IncrementalDisplayable","CompoundPath","LinearGradient","RadialGradient","BoundingRect"],(function(e){Cm[e]=al[e]})),Wc.extend({type:"series.line",dependencies:["grid","polar"],getInitialData:function(e,t){return Xh(this.getSource(),this,{useEncodeDefaulter:!0})},defaultOption:{zlevel:0,z:2,coordinateSystem:"cartesian2d",legendHoverLink:!0,hoverAnimation:!0,clip:!0,label:{position:"top"},lineStyle:{width:2,type:"solid"},step:!1,smooth:!1,smoothMonotone:null,symbol:"emptyCircle",symbolSize:4,symbolRotate:null,showSymbol:!0,showAllSymbol:"auto",connectNulls:!1,sampling:"none",animationEasing:"linear",progressive:0,hoverLayerThreshold:1/0}});var Em=xm.prototype,_m=xm.getSymbolSize=function(e,t){var n=e.getItemVisual(t,"symbolSize");return n instanceof Array?n.slice():[+n,+n]};function Im(e){return[e[0]/2,e[1]/2]}function Dm(e,t){this.parent.drift(e,t)}Em._createSymbol=function(e,t,n,o,i){this.removeAll();var r=tm(e,-1,-1,2,2,t.getItemVisual(n,"color"),i);r.attr({z2:100,culling:!0,scale:Im(o)}),r.drift=Dm,this._symbolType=e,this.add(r)},Em.stopSymbolAnimation=function(e){this.childAt(0).stopAnimation(e)},Em.getSymbolPath=function(){return this.childAt(0)},Em.getScale=function(){return this.childAt(0).scale},Em.highlight=function(){this.childAt(0).trigger("emphasis")},Em.downplay=function(){this.childAt(0).trigger("normal")},Em.setZ=function(e,t){var n=this.childAt(0);n.zlevel=e,n.z=t},Em.setDraggable=function(e){var t=this.childAt(0);t.draggable=e,t.cursor=e?"move":t.cursor},Em.updateData=function(e,t,n){this.silent=!1;var o=e.getItemVisual(t,"symbol")||"circle",i=e.hostModel,r=_m(e,t),a=o!==this._symbolType;if(a){var s=e.getItemVisual(t,"symbolKeepAspect");this._createSymbol(o,e,t,r,s)}else(l=this.childAt(0)).silent=!1,Xs(l,{scale:Im(r)},i,t);if(this._updateCommon(e,t,r,n),a){var l=this.childAt(0),u=n&&n.fadeIn,c={scale:l.scale.slice()};u&&(c.style={opacity:l.style.opacity}),l.scale=[0,0],u&&(l.style.opacity=0),Ys(l,c,i,t)}this._seriesModel=i};var Om=["itemStyle"],wm=["emphasis","itemStyle"],Rm=["label"],Sm=["emphasis","label"];function km(e,t){if(!this.incremental&&!this.useHoverLayer)if("emphasis"===t){var n=this.__symbolOriginalScale,o=n[1]/n[0],i={scale:[Math.max(1.1*n[0],n[0]+3),Math.max(1.1*n[1],n[1]+3*o)]};this.animateTo(i,400,"elasticOut")}else"normal"===t&&this.animateTo({scale:this.__symbolOriginalScale},400,"elasticOut")}function Am(e){this.group=new _n,this._symbolCtor=e||xm}Em._updateCommon=function(e,t,n,o){var i=this.childAt(0),r=e.hostModel,a=e.getItemVisual(t,"color");"image"!==i.type?i.useStyle({strokeNoScale:!0}):i.setStyle({opacity:1,shadowBlur:null,shadowOffsetX:null,shadowOffsetY:null,shadowColor:null});var s=o&&o.itemStyle,l=o&&o.hoverItemStyle,u=o&&o.symbolOffset,c=o&&o.labelModel,d=o&&o.hoverLabelModel,f=o&&o.hoverAnimation,h=o&&o.cursorStyle;if(!o||e.hasItemOption){var g=o&&o.itemModel?o.itemModel:e.getItemModel(t);s=g.getModel(Om).getItemStyle(["color"]),l=g.getModel(wm).getItemStyle(),u=g.getShallow("symbolOffset"),c=g.getModel(Rm),d=g.getModel(Sm),f=g.getShallow("hoverAnimation"),h=g.getShallow("cursor")}else l=b({},l);var m=i.style,p=e.getItemVisual(t,"symbolRotate");i.attr("rotation",(p||0)*Math.PI/180||0),u&&i.attr("position",[Cl(u[0],n[0]),Cl(u[1],n[1])]),h&&i.attr("cursor",h),i.setColor(a,o&&o.symbolInnerColor),i.setStyle(s);var v=e.getItemVisual(t,"opacity");null!=v&&(m.opacity=v);var y=e.getItemVisual(t,"liftZ"),C=i.__z2Origin;null!=y?null==C&&(i.__z2Origin=i.z2,i.z2+=y):null!=C&&(i.z2=C,i.__z2Origin=null);var T=o&&o.useNameLabel;Fs(m,l,c,d,{labelFetcher:r,labelDataIndex:t,defaultText:function(t,n){return T?e.getName(t):Tm(e,t)},isRectText:!0,autoColor:a}),i.__symbolOriginalScale=Im(n),i.hoverStyle=l,i.highDownOnUpdate=f&&r.isAnimationEnabled()?km:null,Ks(i)},Em.fadeOut=function(e,t){var n=this.childAt(0);this.silent=n.silent=!0,t&&t.keepLabel||(n.style.text=null),Xs(n,{style:{opacity:0},scale:[0,0]},this._seriesModel,this.dataIndex,e)},_(xm,_n);var Nm=Am.prototype;function Mm(e,t,n,o){return t&&!isNaN(t[0])&&!isNaN(t[1])&&!(o.isIgnore&&o.isIgnore(n))&&!(o.clipShape&&!o.clipShape.contain(t[0],t[1]))&&"none"!==e.getItemVisual(n,"symbol")}function Km(e){return null==e||L(e)||(e={isIgnore:e}),e||{}}function Pm(e){var t=e.hostModel;return{itemStyle:t.getModel("itemStyle").getItemStyle(["color"]),hoverItemStyle:t.getModel("emphasis.itemStyle").getItemStyle(),symbolRotate:t.get("symbolRotate"),symbolOffset:t.get("symbolOffset"),hoverAnimation:t.get("hoverAnimation"),labelModel:t.getModel("label"),hoverLabelModel:t.getModel("emphasis.label"),cursorStyle:t.get("cursor")}}function Lm(e,t,n){var o,i=e.getBaseAxis(),r=e.getOtherAxis(i),a=function(e,t){var n=0,o=e.scale.getExtent();return"start"===t?n=o[0]:"end"===t?n=o[1]:0<o[0]?n=o[0]:o[1]<0&&(n=o[1]),n}(r,n),s=i.dim,l=r.dim,u=t.mapDimension(l),c=t.mapDimension(s),d="x"===l||"radius"===l?1:0,f=w(e.dimensions,(function(e){return t.mapDimension(e)})),h=t.getCalculationInfo("stackResultDimension");return(o|=jh(t,f[0]))&&(f[0]=h),(o|=jh(t,f[1]))&&(f[1]=h),{dataDimsForPoint:f,valueStart:a,valueAxisDim:l,baseAxisDim:s,stacked:!!o,valueDim:u,baseDim:c,baseDataOffset:d,stackedOverDimension:t.getCalculationInfo("stackedOverDimension")}}function Bm(e,t,n,o){var i=NaN;e.stacked&&(i=n.get(n.getCalculationInfo("stackedOverDimension"),o)),isNaN(i)&&(i=e.valueStart);var r=e.baseDataOffset,a=[];return a[r]=n.get(e.baseDim,o),a[1-r]=i,t.dataToPoint(a)}Nm.updateData=function(e,t){t=Km(t);var n=this.group,o=e.hostModel,i=this._data,r=this._symbolCtor,a=Pm(e);i||n.removeAll(),e.diff(i).add((function(o){var i=e.getItemLayout(o);if(Mm(e,i,o,t)){var s=new r(e,o,a);s.attr("position",i),e.setItemGraphicEl(o,s),n.add(s)}})).update((function(s,l){var u=i.getItemGraphicEl(l),c=e.getItemLayout(s);Mm(e,c,s,t)?(u?(u.updateData(e,s,a),Xs(u,{position:c},o)):(u=new r(e,s)).attr("position",c),n.add(u),e.setItemGraphicEl(s,u)):n.remove(u)})).remove((function(e){var t=i.getItemGraphicEl(e);t&&t.fadeOut((function(){n.remove(t)}))})).execute(),this._data=e},Nm.isPersistent=function(){return!0},Nm.updateLayout=function(){var e=this._data;e&&e.eachItemGraphicEl((function(t,n){var o=e.getItemLayout(n);t.attr("position",o)}))},Nm.incrementalPrepareUpdate=function(e){this._seriesScope=Pm(e),this._data=null,this.group.removeAll()},Nm.incrementalUpdate=function(e,t,n){function o(e){e.isGroup||(e.incremental=e.useHoverLayer=!0)}n=Km(n);for(var i=e.start;i<e.end;i++){var r=t.getItemLayout(i);if(Mm(t,r,i,n)){var a=new this._symbolCtor(t,i,this._seriesScope);a.traverse(o),a.attr("position",r),this.group.add(a),t.setItemGraphicEl(i,a)}}},Nm.remove=function(e){var t=this.group,n=this._data;n&&e?n.eachItemGraphicEl((function(e){e.fadeOut((function(){t.remove(e)}))})):t.removeAll()};var Fm=Te,zm=xe,Vm=ue,Hm=re,Wm=[],$m=[],Um=[];function qm(e){return isNaN(e[0])||isNaN(e[1])}function jm(e,t,n,o,i,r,a,s,l,u){return"none"!==u&&u?(function(e,t,n,o,i,r,a,s,l,u,c){for(var d=0,f=n,h=0;h<o;h++){var g=t[f];if(i<=f||f<0)break;if(qm(g)){if(c){f+=r;continue}break}if(f===n)e[0<r?"moveTo":"lineTo"](g[0],g[1]);else if(0<l){var m=t[d],p="y"===u?1:0,v=(g[p]-m[p])*l;Hm($m,m),$m[p]=m[p]+v,Hm(Um,g),Um[p]=g[p]-v,e.bezierCurveTo($m[0],$m[1],Um[0],Um[1],g[0],g[1])}else e.lineTo(g[0],g[1]);d=f,f+=r}return h}).apply(this,arguments):(function(e,t,n,o,i,r,a,s,l,u,c){for(var d=0,f=n,h=0;h<o;h++){var g=t[f];if(i<=f||f<0)break;if(qm(g)){if(c){f+=r;continue}break}if(f===n)e[0<r?"moveTo":"lineTo"](g[0],g[1]),Hm($m,g);else if(0<l){var m=f+r,p=t[m];if(c)for(;p&&qm(t[m]);)p=t[m+=r];var v=.5,y=t[d];if(!(p=t[m])||qm(p))Hm(Um,g);else{var b,C;if(qm(p)&&!c&&(p=g),ce(Wm,p,y),"x"===u||"y"===u){var T="x"===u?0:1;b=Math.abs(g[T]-y[T]),C=Math.abs(g[T]-p[T])}else b=pe(g,y),C=pe(g,p);Vm(Um,g,Wm,-l*(1-(v=C/(C+b))))}Fm($m,$m,s),zm($m,$m,a),Fm(Um,Um,s),zm(Um,Um,a),e.bezierCurveTo($m[0],$m[1],Um[0],Um[1],g[0],g[1]),Vm($m,g,Wm,l*v)}else e.lineTo(g[0],g[1]);d=f,f+=r}return h}).apply(this,arguments)}function Gm(e,t){var n=[1/0,1/0],o=[-1/0,-1/0];if(t)for(var i=0;i<e.length;i++){var r=e[i];r[0]<n[0]&&(n[0]=r[0]),r[1]<n[1]&&(n[1]=r[1]),r[0]>o[0]&&(o[0]=r[0]),r[1]>o[1]&&(o[1]=r[1])}return{min:t?n:o,max:t?o:n}}var Xm=ha.extend({type:"ec-polyline",shape:{points:[],smooth:0,smoothConstraint:!0,smoothMonotone:null,connectNulls:!1},style:{fill:null,stroke:"#000"},brush:ka(ha.prototype.brush),buildPath:function(e,t){var n=t.points,o=0,i=n.length,r=Gm(n,t.smoothConstraint);if(t.connectNulls){for(;0<i&&qm(n[i-1]);i--);for(;o<i&&qm(n[o]);o++);}for(;o<i;)o+=jm(e,n,o,i,i,1,r.min,r.max,t.smooth,t.smoothMonotone,t.connectNulls)+1}}),Ym=ha.extend({type:"ec-polygon",shape:{points:[],stackedOnPoints:[],smooth:0,stackedOnSmooth:0,smoothConstraint:!0,smoothMonotone:null,connectNulls:!1},brush:ka(ha.prototype.brush),buildPath:function(e,t){var n=t.points,o=t.stackedOnPoints,i=0,r=n.length,a=t.smoothMonotone,s=Gm(n,t.smoothConstraint),l=Gm(o,t.smoothConstraint);if(t.connectNulls){for(;0<r&&qm(n[r-1]);r--);for(;i<r&&qm(n[i]);i++);}for(;i<r;){var u=jm(e,n,i,r,r,1,s.min,s.max,t.smooth,a,t.connectNulls);jm(e,o,i+u-1,u,r,-1,l.min,l.max,t.stackedOnSmooth,a,t.connectNulls),i+=u+1,e.closePath()}}});function Zm(e,t,n){var o=e.getArea(),i=e.getBaseAxis().isHorizontal(),r=o.x,a=o.y,s=o.width,l=o.height,u=n.get("lineStyle.width")||2;r-=u/2,a-=u/2,s+=u,l+=u,r=Math.floor(r),s=Math.round(s);var c=new Ua({shape:{x:r,y:a,width:s,height:l}});return t&&(c.shape[i?"width":"height"]=0,Ys(c,{shape:{width:s,height:l}},n)),c}function Jm(e,t,n){var o=e.getArea(),i=new Ma({shape:{cx:Tl(e.cx,1),cy:Tl(e.cy,1),r0:Tl(o.r0,1),r:Tl(o.r,1),startAngle:o.startAngle,endAngle:o.endAngle,clockwise:o.clockwise}});return t&&(i.shape.endAngle=o.startAngle,Ys(i,{shape:{endAngle:o.endAngle}},n)),i}function Qm(e,t,n){return e?"polar"===e.type?Jm(e,t,n):"cartesian2d"===e.type?Zm(e,t,n):null:null}function ep(e,t){if(e.length===t.length){for(var n=0;n<e.length;n++){var o=e[n],i=t[n];if(o[0]!==i[0]||o[1]!==i[1])return}return!0}}function tp(e,t){var n=[],o=[],i=[],r=[];return Rr(e,n,o),Rr(t,i,r),Math.max(Math.abs(n[0]-i[0]),Math.abs(n[1]-i[1]),Math.abs(o[0]-r[0]),Math.abs(o[1]-r[1]))}function np(e){return"number"==typeof e?e:e?.5:0}function op(e,t,n){for(var o=t.getBaseAxis(),i="x"===o.dim||"radius"===o.dim?0:1,r=[],a=0;a<e.length-1;a++){var s=e[a+1],l=e[a];r.push(l);var u=[];switch(n){case"end":u[i]=s[i],u[1-i]=l[1-i],r.push(u);break;case"middle":var c=[];u[i]=c[i]=(l[i]+s[i])/2,u[1-i]=l[1-i],c[1-i]=s[1-i],r.push(u),r.push(c);break;default:u[i]=l[i],u[1-i]=s[1-i],r.push(u)}}return e[a]&&r.push(e[a]),r}function ip(e,t,n){if("cartesian2d"!==e.type)return Jm(e,t,n);var o=e.getBaseAxis().isHorizontal(),i=Zm(e,t,n);if(!n.get("clip",!0)){var r=i.shape,a=Math.max(r.width,r.height);o?(r.y-=a,r.height+=2*a):(r.x-=a,r.width+=2*a)}return i}function rp(e,t,n){return{seriesType:e,performRawSeries:!0,reset:function(e,o,i){var r=e.getData(),a=e.get("symbol"),s=e.get("symbolSize"),l=e.get("symbolKeepAspect"),u=e.get("symbolRotate"),c=K(a),d=K(s),f=K(u),h=c||d||f,g=!c&&a?a:t;if(r.setVisual({legendSymbol:n||g,symbol:g,symbolSize:d?null:s,symbolKeepAspect:l,symbolRotate:u}),!o.isSeriesFiltered(e))return{dataEach:r.hasItemOption||h?function(t,n){if(h){var o=e.getRawValue(n),i=e.getDataParams(n);c&&t.setItemVisual(n,"symbol",a(o,i)),d&&t.setItemVisual(n,"symbolSize",s(o,i)),f&&t.setItemVisual(n,"symbolRotate",u(o,i))}if(t.hasItemOption){var r=t.getItemModel(n),l=r.getShallow("symbol",!0),g=r.getShallow("symbolSize",!0),m=r.getShallow("symbolRotate",!0),p=r.getShallow("symbolKeepAspect",!0);null!=l&&t.setItemVisual(n,"symbol",l),null!=g&&t.setItemVisual(n,"symbolSize",g),null!=m&&t.setItemVisual(n,"symbolRotate",m),null!=p&&t.setItemVisual(n,"symbolKeepAspect",p)}}:null}}}}function ap(e){return{seriesType:e,plan:Qc(),reset:function(e){var t=e.getData(),n=e.coordinateSystem,o=e.pipelineContext.large;if(n){var i=w(n.dimensions,(function(e){return t.mapDimension(e)})).slice(0,2),r=i.length,a=t.getCalculationInfo("stackResultDimension");return jh(t,i[0])&&(i[0]=a),jh(t,i[1])&&(i[1]=a),r&&{progress:function(e,t){for(var a=o&&new Float32Array((e.end-e.start)*r),s=e.start,l=0,u=[],c=[];s<e.end;s++){var d;if(1===r){var f=t.get(i[0],s);d=!isNaN(f)&&n.dataToPoint(f,null,c)}else{f=u[0]=t.get(i[0],s);var h=u[1]=t.get(i[1],s);d=!isNaN(f)&&!isNaN(h)&&n.dataToPoint(u,null,c)}o?(a[l++]=d?d[0]:NaN,a[l++]=d?d[1]:NaN):t.setItemLayout(s,d&&d.slice()||[NaN,NaN])}o&&t.setLayout("symbolPoints",a)}}}}}}function sp(e,t){return Math.round(e.length/2)}nd.extend({type:"line",init:function(){var e=new _n,t=new Am;this.group.add(t.group),this._symbolDraw=t,this._lineGroup=e},render:function(e,t,n){var o=e.coordinateSystem,i=this.group,r=e.getData(),a=e.getModel("lineStyle"),s=e.getModel("areaStyle"),l=r.mapArray(r.getItemLayout),u="polar"===o.type,c=this._coordSys,d=this._symbolDraw,f=this._polyline,h=this._polygon,g=this._lineGroup,m=e.get("animation"),p=!s.isEmpty(),v=s.get("origin"),y=function(e,t,n){if(!n.valueDim)return[];for(var o=[],i=0,r=t.count();i<r;i++)o.push(Bm(n,e,t,i));return o}(o,r,Lm(o,r,v)),b=e.get("showSymbol"),T=b&&!u&&function(e,t,n){var o=e.get("showAllSymbol"),i="auto"===o;if(!o||i){var r=n.getAxesByScale("ordinal")[0];if(r&&(!i||!function(e,t){var n=e.getExtent(),o=Math.abs(n[1]-n[0])/e.scale.count();isNaN(o)&&(o=0);for(var i=t.count(),r=Math.max(1,Math.round(i/5)),a=0;a<i;a+=r)if(1.5*xm.getSymbolSize(t,a)[e.isHorizontal()?1:0]>o)return!1;return!0}(r,t))){var a=t.mapDimension(r.dim),s={};return O(r.getViewLabels(),(function(e){s[e.tickValue]=1})),function(e){return!s.hasOwnProperty(t.get(a,e))}}}}(e,r,o),x=this._data;x&&x.eachItemGraphicEl((function(e,t){e.__temp&&(i.remove(e),x.setItemGraphicEl(t,null))})),b||d.remove(),i.add(g);var E,_=!u&&e.get("step");o&&o.getArea&&e.get("clip",!0)&&(null!=(E=o.getArea()).width?(E.x-=.1,E.y-=.1,E.width+=.2,E.height+=.2):E.r0&&(E.r0-=.5,E.r1+=.5)),this._clipShapeForSymbol=E,f&&c.type===o.type&&_===this._step?(p&&!h?h=this._newPolygon(l,y,o,m):h&&!p&&(g.remove(h),h=this._polygon=null),g.setClipPath(ip(o,!1,e)),b&&d.updateData(r,{isIgnore:T,clipShape:E}),r.eachItemGraphicEl((function(e){e.stopAnimation(!0)})),ep(this._stackedOnPoints,y)&&ep(this._points,l)||(m?this._updateAnimation(r,y,o,n,_,v):(_&&(l=op(l,o,_),y=op(y,o,_)),f.setShape({points:l}),h&&h.setShape({points:l,stackedOnPoints:y})))):(b&&d.updateData(r,{isIgnore:T,clipShape:E}),_&&(l=op(l,o,_),y=op(y,o,_)),f=this._newPolyline(l,o,m),p&&(h=this._newPolygon(l,y,o,m)),g.setClipPath(ip(o,!0,e)));var I=function(e,t){var n=e.getVisual("visualMeta");if(n&&n.length&&e.count()&&"cartesian2d"===t.type){for(var o,i,r=n.length-1;0<=r;r--){var a=e.getDimensionInfo(e.dimensions[n[r].dimension]);if("x"===(o=a&&a.coordDim)||"y"===o){i=n[r];break}}if(i){var s=t.getAxis(o),l=w(i.stops,(function(e){return{coord:s.toGlobalCoord(s.dataToCoord(e.value)),color:e.color}})),u=l.length,c=i.outerColors.slice();u&&l[0].coord>l[u-1].coord&&(l.reverse(),c.reverse());var d=l[0].coord-10,f=l[u-1].coord+10,h=f-d;if(h<.001)return"transparent";O(l,(function(e){e.offset=(e.coord-d)/h})),l.push({offset:u?l[u-1].offset:.5,color:c[1]||"transparent"}),l.unshift({offset:u?l[0].offset:.5,color:c[0]||"transparent"});var g=new es(0,0,0,0,l,!0);return g[o]=d,g[o+"2"]=f,g}}}(r,o)||r.getVisual("color");f.useStyle(C(a.getLineStyle(),{fill:"none",stroke:I,lineJoin:"bevel"}));var D=e.get("smooth");if(D=np(e.get("smooth")),f.setShape({smooth:D,smoothMonotone:e.get("smoothMonotone"),connectNulls:e.get("connectNulls")}),h){var R=r.getCalculationInfo("stackedOnSeries"),S=0;h.useStyle(C(s.getAreaStyle(),{fill:I,opacity:.7,lineJoin:"bevel"})),R&&(S=np(R.get("smooth"))),h.setShape({smooth:D,stackedOnSmooth:S,smoothMonotone:e.get("smoothMonotone"),connectNulls:e.get("connectNulls")})}this._data=r,this._coordSys=o,this._stackedOnPoints=y,this._points=l,this._step=_,this._valueOrigin=v},dispose:function(){},highlight:function(e,t,n,o){var i=e.getData(),r=Ki(i,o);if(!(r instanceof Array)&&null!=r&&0<=r){var a=i.getItemGraphicEl(r);if(!a){var s=i.getItemLayout(r);if(!s)return;if(this._clipShapeForSymbol&&!this._clipShapeForSymbol.contain(s[0],s[1]))return;(a=new xm(i,r)).position=s,a.setZ(e.get("zlevel"),e.get("z")),a.ignore=isNaN(s[0])||isNaN(s[1]),a.__temp=!0,i.setItemGraphicEl(r,a),a.stopSymbolAnimation(!0),this.group.add(a)}a.highlight()}else nd.prototype.highlight.call(this,e,t,n,o)},downplay:function(e,t,n,o){var i=e.getData(),r=Ki(i,o);if(null!=r&&0<=r){var a=i.getItemGraphicEl(r);a&&(a.__temp?(i.setItemGraphicEl(r,null),this.group.remove(a)):a.downplay())}else nd.prototype.downplay.call(this,e,t,n,o)},_newPolyline:function(e){var t=this._polyline;return t&&this._lineGroup.remove(t),t=new Xm({shape:{points:e},silent:!0,z2:10}),this._lineGroup.add(t),this._polyline=t},_newPolygon:function(e,t){var n=this._polygon;return n&&this._lineGroup.remove(n),n=new Ym({shape:{points:e,stackedOnPoints:t},silent:!0}),this._lineGroup.add(n),this._polygon=n},_updateAnimation:function(e,t,n,o,i,r){var a=this._polyline,s=this._polygon,l=e.hostModel,u=function(e,t,n,o,i,r,a,s){for(var l=function(e,t){var n=[];return t.diff(e).add((function(e){n.push({cmd:"+",idx:e})})).update((function(e,t){n.push({cmd:"=",idx:t,idx1:e})})).remove((function(e){n.push({cmd:"-",idx:e})})).execute(),n}(e,t),u=[],c=[],d=[],f=[],h=[],g=[],m=[],p=Lm(i,t,a),v=Lm(r,e,s),y=0;y<l.length;y++){var b=l[y],C=!0;switch(b.cmd){case"=":var T=e.getItemLayout(b.idx),x=t.getItemLayout(b.idx1);(isNaN(T[0])||isNaN(T[1]))&&(T=x.slice()),u.push(T),c.push(x),d.push(n[b.idx]),f.push(o[b.idx1]),m.push(t.getRawIndex(b.idx1));break;case"+":var E=b.idx;u.push(i.dataToPoint([t.get(p.dataDimsForPoint[0],E),t.get(p.dataDimsForPoint[1],E)])),c.push(t.getItemLayout(E).slice()),d.push(Bm(p,i,t,E)),f.push(o[E]),m.push(t.getRawIndex(E));break;case"-":var _=e.getRawIndex(E=b.idx);_!==E?(u.push(e.getItemLayout(E)),c.push(r.dataToPoint([e.get(v.dataDimsForPoint[0],E),e.get(v.dataDimsForPoint[1],E)])),d.push(n[E]),f.push(Bm(v,r,e,E)),m.push(_)):C=!1}C&&(h.push(b),g.push(g.length))}g.sort((function(e,t){return m[e]-m[t]}));var I=[],D=[],O=[],w=[],R=[];for(y=0;y<g.length;y++)I[y]=u[E=g[y]],D[y]=c[E],O[y]=d[E],w[y]=f[E],R[y]=h[E];return{current:I,next:D,stackedOnCurrent:O,stackedOnNext:w,status:R}}(this._data,e,this._stackedOnPoints,t,this._coordSys,n,this._valueOrigin,r),c=u.current,d=u.stackedOnCurrent,f=u.next,h=u.stackedOnNext;if(i&&(c=op(u.current,n,i),d=op(u.stackedOnCurrent,n,i),f=op(u.next,n,i),h=op(u.stackedOnNext,n,i)),3e3<tp(c,f)||s&&3e3<tp(d,h))return a.setShape({points:f}),void(s&&s.setShape({points:f,stackedOnPoints:h}));a.shape.__points=u.current,a.shape.points=c,Xs(a,{shape:{points:f}},l),s&&(s.setShape({points:c,stackedOnPoints:d}),Xs(s,{shape:{points:f,stackedOnPoints:h}},l));for(var g=[],m=u.status,p=0;p<m.length;p++)if("="===m[p].cmd){var v=e.getItemGraphicEl(m[p].idx1);v&&g.push({el:v,ptIdx:p})}a.animators&&a.animators.length&&a.animators[0].during((function(){for(var e=0;e<g.length;e++)g[e].el.attr("position",a.shape.__points[g[e].ptIdx])}))},remove:function(e){var t=this.group,n=this._data;this._lineGroup.removeAll(),this._symbolDraw.remove(!0),n&&n.eachItemGraphicEl((function(e,o){e.__temp&&(t.remove(e),n.setItemGraphicEl(o,null))})),this._polyline=this._polygon=this._coordSys=this._points=this._stackedOnPoints=this._data=null}});var lp={average:function(e){for(var t=0,n=0,o=0;o<e.length;o++)isNaN(e[o])||(t+=e[o],n++);return 0===n?NaN:t/n},sum:function(e){for(var t=0,n=0;n<e.length;n++)t+=e[n]||0;return t},max:function(e){for(var t=-1/0,n=0;n<e.length;n++)e[n]>t&&(t=e[n]);return isFinite(t)?t:NaN},min:function(e){for(var t=1/0,n=0;n<e.length;n++)e[n]<t&&(t=e[n]);return isFinite(t)?t:NaN},nearest:function(e){return e[0]}};function up(e){return this._axes[e]}function cp(e){this._axes={},this._dimList=[],this.name=e||""}function dp(e){cp.call(this,e)}function fp(e,t,n,o,i){pm.call(this,e,t,n),this.type=o||"value",this.position=i||"bottom"}cp.prototype={constructor:cp,type:"cartesian",getAxis:function(e){return this._axes[e]},getAxes:function(){return w(this._dimList,up,this)},getAxesByScale:function(e){return e=e.toLowerCase(),S(this.getAxes(),(function(t){return t.scale.type===e}))},addAxis:function(e){var t=e.dim;this._axes[t]=e,this._dimList.push(t)},dataToCoord:function(e){return this._dataCoordConvert(e,"dataToCoord")},coordToData:function(e){return this._dataCoordConvert(e,"coordToData")},_dataCoordConvert:function(e,t){for(var n=this._dimList,o=e instanceof Array?[]:{},i=0;i<n.length;i++){var r=n[i];o[r]=this._axes[r][t](e[r])}return o}},dp.prototype={constructor:dp,type:"cartesian2d",dimensions:["x","y"],getBaseAxis:function(){return this.getAxesByScale("ordinal")[0]||this.getAxesByScale("time")[0]||this.getAxis("x")},containPoint:function(e){var t=this.getAxis("x"),n=this.getAxis("y");return t.contain(t.toLocalCoord(e[0]))&&n.contain(n.toLocalCoord(e[1]))},containData:function(e){return this.getAxis("x").containData(e[0])&&this.getAxis("y").containData(e[1])},dataToPoint:function(e,t,n){var o=this.getAxis("x"),i=this.getAxis("y");return(n=n||[])[0]=o.toGlobalCoord(o.dataToCoord(e[0])),n[1]=i.toGlobalCoord(i.dataToCoord(e[1])),n},clampData:function(e,t){var n=this.getAxis("x").scale,o=this.getAxis("y").scale,i=n.getExtent(),r=o.getExtent(),a=n.parse(e[0]),s=o.parse(e[1]);return(t=t||[])[0]=Math.min(Math.max(Math.min(i[0],i[1]),a),Math.max(i[0],i[1])),t[1]=Math.min(Math.max(Math.min(r[0],r[1]),s),Math.max(r[0],r[1])),t},pointToData:function(e,t){var n=this.getAxis("x"),o=this.getAxis("y");return(t=t||[])[0]=n.coordToData(n.toLocalCoord(e[0])),t[1]=o.coordToData(o.toLocalCoord(e[1])),t},getOtherAxis:function(e){return this.getAxis("x"===e.dim?"y":"x")},getArea:function(){var e=this.getAxis("x").getGlobalExtent(),t=this.getAxis("y").getGlobalExtent(),n=Math.min(e[0],e[1]),o=Math.min(t[0],t[1]);return new En(n,o,Math.max(e[0],e[1])-n,Math.max(t[0],t[1])-o)}},_(dp,cp),fp.prototype={constructor:fp,index:0,getAxesOnZeroOf:null,model:null,isHorizontal:function(){var e=this.position;return"top"===e||"bottom"===e},getGlobalExtent:function(e){var t=this.getExtent();return t[0]=this.toGlobalCoord(t[0]),t[1]=this.toGlobalCoord(t[1]),e&&t[0]>t[1]&&t.reverse(),t},getOtherAxis:function(){this.grid.getOtherAxis()},pointToData:function(e,t){return this.coordToData(this.toLocalCoord(e["x"===this.dim?0:1]),t)},toLocalCoord:null,toGlobalCoord:null},_(fp,pm);var hp={show:!0,zlevel:0,z:0,inverse:!1,name:"",nameLocation:"end",nameRotate:null,nameTruncate:{maxWidth:null,ellipsis:"...",placeholder:"."},nameTextStyle:{},nameGap:15,silent:!1,triggerEvent:!1,tooltip:{show:!1},axisPointer:{},axisLine:{show:!0,onZero:!0,onZeroAxisIndex:null,lineStyle:{color:"#333",width:1,type:"solid"},symbol:["none","none"],symbolSize:[10,15]},axisTick:{show:!0,inside:!1,length:5,lineStyle:{width:1}},axisLabel:{show:!0,inside:!1,rotate:0,showMinLabel:null,showMaxLabel:null,margin:8,fontSize:12},splitLine:{show:!0,lineStyle:{color:["#ccc"],width:1,type:"solid"}},splitArea:{show:!1,areaStyle:{color:["rgba(250,250,250,0.3)","rgba(200,200,200,0.3)"]}}},gp={};function mp(e,t,n,o){O(pp,(function(i){t.extend({type:e+"Axis."+i,mergeDefaultAndTheme:function(t,o){var r=this.layoutMode,a=r?uu(t):{};v(t,o.getTheme().get(i+"Axis")),v(t,this.getDefaultOption()),t.type=n(e,t),r&&lu(t,a,r)},optionUpdated:function(){"category"===this.option.type&&(this.__ordinalMeta=Zh.createByAxisModel(this))},getCategories:function(e){var t=this.option;if("category"===t.type)return e?t.data:this.__ordinalMeta.categories},getOrdinalMeta:function(){return this.__ordinalMeta},defaultOption:y([{},gp[i+"Axis"],o],!0)})})),mu.registerSubTypeDefaulter(e+"Axis",N(n,e))}gp.categoryAxis=v({boundaryGap:!0,deduplication:null,splitLine:{show:!1},axisTick:{alignWithLabel:!1,interval:"auto"},axisLabel:{interval:"auto"}},hp),gp.valueAxis=v({boundaryGap:[0,0],splitNumber:5,minorTick:{show:!1,splitNumber:5,length:3,lineStyle:{}},minorSplitLine:{show:!1,lineStyle:{color:"#eee",width:1}}},hp),gp.timeAxis=C({scale:!0,min:"dataMin",max:"dataMax"},gp.valueAxis),gp.logAxis=C({scale:!0,logBase:10},gp.valueAxis);var pp=["value","category","time","log"],vp=mu.extend({type:"cartesian2dAxis",axis:null,init:function(){vp.superApply(this,"init",arguments),this.resetRange()},mergeOption:function(){vp.superApply(this,"mergeOption",arguments),this.resetRange()},restoreData:function(){vp.superApply(this,"restoreData",arguments),this.resetRange()},getCoordSysModel:function(){return this.ecModel.queryComponents({mainType:"grid",index:this.option.gridIndex,id:this.option.gridId})[0]}});function yp(e,t){return t.type||(t.data?"category":"value")}v(vp.prototype,qg);var bp={offset:0};function Cp(e,t){return e.getCoordSysModel()===t}function Tp(e,t,n){this._coordsMap={},this._coordsList=[],this._axesMap={},this._axesList=[],this._initCartesian(e,t,n),this.model=e}mp("x",vp,yp,bp),mp("y",vp,yp,bp),mu.extend({type:"grid",dependencies:["xAxis","yAxis"],layoutMode:"box",coordinateSystem:null,defaultOption:{show:!1,zlevel:0,z:0,left:"10%",top:60,right:"10%",bottom:60,containLabel:!1,backgroundColor:"rgba(0,0,0,0)",borderWidth:1,borderColor:"#ccc"}});var xp=Tp.prototype;function Ep(e,t,n,o){n.getAxesOnZeroOf=function(){return i?[i]:[]};var i,r=e[t],a=n.model,s=a.get("axisLine.onZero"),l=a.get("axisLine.onZeroAxisIndex");if(s){if(null!=l)_p(r[l])&&(i=r[l]);else for(var u in r)if(r.hasOwnProperty(u)&&_p(r[u])&&!o[c(r[u])]){i=r[u];break}i&&(o[c(i)]=!0)}function c(e){return e.dim+"_"+e.index}}function _p(e){return e&&"category"!==e.type&&"time"!==e.type&&function(e){var t=e.scale.getExtent(),n=t[0],o=t[1];return!(0<n&&0<o||n<0&&o<0)}(e)}xp.type="grid",xp.axisPointerEnabled=!0,xp.getRect=function(){return this._rect},xp.update=function(e,t){var n=this._axesMap;this._updateScale(e,this.model),O(n.x,(function(e){zg(e.scale,e.model)})),O(n.y,(function(e){zg(e.scale,e.model)}));var o={};O(n.x,(function(e){Ep(n,"y",e,o)})),O(n.y,(function(e){Ep(n,"x",e,o)})),this.resize(this.model,t)},xp.resize=function(e,t,n){var o=au(e.getBoxLayoutParams(),{width:t.getWidth(),height:t.getHeight()});this._rect=o;var i=this._axesList;function r(){O(i,(function(e){var t=e.isHorizontal(),n=t?[0,o.width]:[0,o.height],i=e.inverse?1:0;e.setExtent(n[i],n[1-i]),function(e,t){var n=e.getExtent(),o=n[0]+n[1];e.toGlobalCoord="x"===e.dim?function(e){return e+t}:function(e){return o-e+t},e.toLocalCoord="x"===e.dim?function(e){return e-t}:function(e){return o-e+t}}(e,t?o.x:o.y)}))}r(),!n&&e.get("containLabel")&&(O(i,(function(e){if(!e.model.get("axisLabel.inside")){var t=function(e){var t=e.scale;if(e.model.get("axisLabel.show")&&!t.isBlank()){var n,o,i="category"===e.type,r=t.getExtent();o=i?t.count():(n=t.getTicks()).length;var a,s,l,u,c,d,f,h,g=e.getLabelModel(),m=Hg(e),p=1;40<o&&(p=Math.ceil(o/40));for(var v=0;v<o;v+=p){var y=m(n?n[v]:r[0]+v),b=(s=g.getTextRect(y),l=(g.get("rotate")||0)*Math.PI/180,d=(u=s.plain()).height,f=(c=u.width)*Math.abs(Math.cos(l))+Math.abs(d*Math.sin(l)),h=c*Math.abs(Math.sin(l))+Math.abs(d*Math.cos(l)),new En(u.x,u.y,f,h));a?a.union(b):a=b}return a}}(e);if(t){var n=e.isHorizontal()?"height":"width",i=e.model.get("axisLabel.margin");o[n]-=t[n]+i,"top"===e.position?o.y+=t.height+i:"left"===e.position&&(o.x+=t.width+i)}}})),r())},xp.getAxis=function(e,t){var n=this._axesMap[e];if(null!=n){if(null==t)for(var o in n)if(n.hasOwnProperty(o))return n[o];return n[t]}},xp.getAxes=function(){return this._axesList.slice()},xp.getCartesian=function(e,t){if(null!=e&&null!=t)return this._coordsMap["x"+e+"y"+t];L(e)&&(t=e.yAxisIndex,e=e.xAxisIndex);for(var n=0,o=this._coordsList;n<o.length;n++)if(o[n].getAxis("x").index===e||o[n].getAxis("y").index===t)return o[n]},xp.getCartesians=function(){return this._coordsList.slice()},xp.convertToPixel=function(e,t,n){var o=this._findConvertTarget(e,t);return o.cartesian?o.cartesian.dataToPoint(n):o.axis?o.axis.toGlobalCoord(o.axis.dataToCoord(n)):null},xp.convertFromPixel=function(e,t,n){var o=this._findConvertTarget(e,t);return o.cartesian?o.cartesian.pointToData(n):o.axis?o.axis.coordToData(o.axis.toLocalCoord(n)):null},xp._findConvertTarget=function(e,t){var n,o,i=t.seriesModel,r=t.xAxisModel||i&&i.getReferringComponents("xAxis")[0],a=t.yAxisModel||i&&i.getReferringComponents("yAxis")[0],s=t.gridModel;return i?E(this._coordsList,n=i.coordinateSystem)<0&&(n=null):r&&a?n=this.getCartesian(r.componentIndex,a.componentIndex):r?o=this.getAxis("x",r.componentIndex):a?o=this.getAxis("y",a.componentIndex):s&&s.coordinateSystem===this&&(n=this._coordsList[0]),{cartesian:n,axis:o}},xp.containPoint=function(e){var t=this._coordsList[0];if(t)return t.containPoint(e)},xp._initCartesian=function(e,t,n){var o={left:!1,right:!1,top:!1,bottom:!1},i={x:{},y:{}},r={x:0,y:0};if(t.eachComponent("xAxis",a("x"),this),t.eachComponent("yAxis",a("y"),this),!r.x||!r.y)return this._axesMap={},void(this._axesList=[]);function a(t){return function(n,a){if(Cp(n,e)){var s=n.get("position");"x"===t?"top"!==s&&"bottom"!==s&&(s=o.bottom?"top":"bottom"):"left"!==s&&"right"!==s&&(s=o.left?"right":"left"),o[s]=!0;var l=new fp(t,Vg(n),[0,0],n.get("type"),s);l.onBand="category"===l.type&&n.get("boundaryGap"),l.inverse=n.get("inverse"),(n.axis=l).model=n,l.grid=this,l.index=a,this._axesList.push(l),i[t][a]=l,r[t]++}}}O((this._axesMap=i).x,(function(t,n){O(i.y,(function(o,i){var r="x"+n+"y"+i,a=new dp(r);a.grid=this,a.model=e,this._coordsMap[r]=a,this._coordsList.push(a),a.addAxis(t),a.addAxis(o)}),this)}),this)},xp._updateScale=function(e,t){function n(e,t){O(e.mapDimension(t.dim,!0),(function(n){t.scale.unionExtentFromData(e,Gh(e,n))}))}O(this._axesList,(function(e){e.scale.setExtent(1/0,-1/0)})),e.eachSeries((function(e){if(Op(e)){var o=Dp(e),i=o[0],r=o[1];if(!Cp(i,t)||!Cp(r,t))return;var a=this.getCartesian(i.componentIndex,r.componentIndex),s=e.getData(),l=a.getAxis("x"),u=a.getAxis("y");"list"===s.type&&(n(s,l),n(s,u))}}),this)},xp.getTooltipAxes=function(e){var t=[],n=[];return O(this.getCartesians(),(function(o){var i=null!=e&&"auto"!==e?o.getAxis(e):o.getBaseAxis(),r=o.getOtherAxis(i);E(t,i)<0&&t.push(i),E(n,r)<0&&n.push(r)})),{baseAxes:t,otherAxes:n}};var Ip=["xAxis","yAxis"];function Dp(e){return w(Ip,(function(t){return e.getReferringComponents(t)[0]}))}function Op(e){return"cartesian2d"===e.get("coordinateSystem")}function wp(e,t){this.opt=t,this.axisModel=e,C(t,{labelOffset:0,nameDirection:1,tickDirection:1,labelDirection:1,silent:!0}),this.group=new _n;var n=new _n({position:t.position.slice(),rotation:t.rotation});n.updateTransform(),this._transform=n.transform,this._dumbGroup=n}Tp.create=function(e,t){var n=[];return e.eachComponent("grid",(function(o,i){var r=new Tp(o,e,t);r.name="grid_"+i,r.resize(o,t,!0),o.coordinateSystem=r,n.push(r)})),e.eachSeries((function(e){if(Op(e)){var t=Dp(e),n=t[0],o=t[1],i=n.getCoordSysModel().coordinateSystem;e.coordinateSystem=i.getCartesian(n.componentIndex,o.componentIndex)}})),n},Tp.dimensions=Tp.prototype.dimensions=dp.prototype.dimensions,Uu.register("cartesian2d",Tp);var Rp=Math.PI;wp.prototype={constructor:wp,hasBuilder:function(e){return!!Sp[e]},add:function(e){Sp[e].call(this)},getGroup:function(){return this.group}};var Sp={axisLine:function(){var e=this.opt,t=this.axisModel;if(t.get("axisLine.show")){var n=this.axisModel.axis.getExtent(),o=this._transform,i=[n[0],0],r=[n[1],0];o&&(Ce(i,i,o),Ce(r,r,o));var a=b({lineCap:"round"},t.getModel("axisLine.lineStyle").getLineStyle());this.group.add(new ja({anid:"line",subPixelOptimize:!0,shape:{x1:i[0],y1:i[1],x2:r[0],y2:r[1]},style:a,strokeContainThreshold:e.strokeContainThreshold||5,silent:!0,z2:1}));var s=t.get("axisLine.symbol"),l=t.get("axisLine.symbolSize"),u=t.get("axisLine.symbolOffset")||0;if("number"==typeof u&&(u=[u,u]),null!=s){"string"==typeof s&&(s=[s,s]),"string"!=typeof l&&"number"!=typeof l||(l=[l,l]);var c=l[0],d=l[1];O([{rotate:e.rotation+Math.PI/2,offset:u[0],r:0},{rotate:e.rotation-Math.PI/2,offset:u[1],r:Math.sqrt((i[0]-r[0])*(i[0]-r[0])+(i[1]-r[1])*(i[1]-r[1]))}],(function(t,n){if("none"!==s[n]&&null!=s[n]){var o=tm(s[n],-c/2,-d/2,c,d,a.stroke,!0),r=t.r+t.offset,l=[i[0]+r*Math.cos(e.rotation),i[1]-r*Math.sin(e.rotation)];o.attr({rotation:t.rotate,position:l,silent:!0,z2:11}),this.group.add(o)}}),this)}}},axisTickLabel:function(){var e=this.axisModel,t=this.opt,n=function(e,t,n){var o=t.axis,i=t.getModel("axisTick");if(i.get("show")&&!o.scale.isBlank()){for(var r=i.getModel("lineStyle"),a=n.tickDirection*i.get("length"),s=Lp(o.getTicksCoords(),e._transform,a,C(r.getLineStyle(),{stroke:t.get("axisLine.lineStyle.color")}),"ticks"),l=0;l<s.length;l++)e.group.add(s[l]);return s}}(this,e,t);!function(e,t,n){if(!Ug(e.axis)){var o=e.get("axisLabel.showMinLabel"),i=e.get("axisLabel.showMaxLabel"),r=(t=t||[])[0],a=t[1],s=t[t.length-1],l=t[t.length-2],u=(n=n||[])[0],c=n[1],d=n[n.length-1],f=n[n.length-2];!1===o?(Mp(r),Mp(u)):Kp(r,a)&&(o?(Mp(a),Mp(c)):(Mp(r),Mp(u))),!1===i?(Mp(s),Mp(d)):Kp(l,s)&&(i?(Mp(l),Mp(f)):(Mp(s),Mp(d)))}}(e,function(e,t,n){var o=t.axis;if(H(n.axisLabelShow,t.get("axisLabel.show"))&&!o.scale.isBlank()){var i=t.getModel("axisLabel"),r=i.get("margin"),a=o.getViewLabels(),s=(H(n.labelRotate,i.get("rotate"))||0)*Rp/180,l=Ap(n.rotation,s,n.labelDirection),u=t.getCategories&&t.getCategories(!0),c=[],d=Np(t),f=t.get("triggerEvent");return O(a,(function(a,s){var h=a.tickValue,g=a.formattedLabel,m=a.rawLabel,p=i;u&&u[h]&&u[h].textStyle&&(p=new hl(u[h].textStyle,i,t.ecModel));var v=p.getTextColor()||t.get("axisLine.lineStyle.color"),y=[o.dataToCoord(h),n.labelOffset+n.labelDirection*r],b=new Sa({anid:"label_"+h,position:y,rotation:l.rotation,silent:d,z2:10});Vs(b.style,p,{text:g,textAlign:p.getShallow("align",!0)||l.textAlign,textVerticalAlign:p.getShallow("verticalAlign",!0)||p.getShallow("baseline",!0)||l.textVerticalAlign,textFill:"function"==typeof v?v("category"===o.type?m:"value"===o.type?h+"":h,s):v}),f&&(b.eventData=kp(t),b.eventData.targetType="axisLabel",b.eventData.value=m),e._dumbGroup.add(b),b.updateTransform(),c.push(b),e.group.add(b),b.decomposeTransform()})),c}}(this,e,t),n),function(e,t,n){var o=t.axis,i=t.getModel("minorTick");if(i.get("show")&&!o.scale.isBlank()){var r=o.getMinorTicksCoords();if(r.length)for(var a=i.getModel("lineStyle"),s=n.tickDirection*i.get("length"),l=C(a.getLineStyle(),C(t.getModel("axisTick").getLineStyle(),{stroke:t.get("axisLine.lineStyle.color")})),u=0;u<r.length;u++)for(var c=Lp(r[u],e._transform,s,l,"minorticks_"+u),d=0;d<c.length;d++)e.group.add(c[d])}}(this,e,t)},axisName:function(){var e=this.opt,t=this.axisModel,n=H(e.axisName,t.get("name"));if(n){var o,i,r=t.get("nameLocation"),a=e.nameDirection,s=t.getModel("nameTextStyle"),l=t.get("nameGap")||0,u=this.axisModel.axis.getExtent(),c=u[0]>u[1]?-1:1,d=["start"===r?u[0]-c*l:"end"===r?u[1]+c*l:(u[0]+u[1])/2,Pp(r)?e.labelOffset+a*l:0],f=t.get("nameRotate");null!=f&&(f=f*Rp/180),Pp(r)?o=Ap(e.rotation,null!=f?f:e.rotation,a):(o=function(e,t,n,o){var i,r=wl(n-e.rotation),a=o[0]>o[1],s="start"===t&&!a||"start"!==t&&a;return{rotation:r,textAlign:Rl(r-Rp/2)?(i=s?"bottom":"top","center"):Rl(r-1.5*Rp)?(i=s?"top":"bottom","center"):(i="middle",r<1.5*Rp&&Rp/2<r?s?"left":"right":s?"right":"left"),textVerticalAlign:i}}(e,r,f||0,u),null!=(i=e.axisNameAvailableWidth)&&(i=Math.abs(i/Math.sin(o.rotation)),isFinite(i)||(i=null)));var h=s.getFont(),g=t.get("nameTruncate",!0)||{},m=g.ellipsis,p=H(e.nameTruncateMaxWidth,g.maxWidth,i),v=null!=m&&null!=p?Jl(n,p,h,m,{minChar:2,placeholder:g.placeholder}):n,y=t.get("tooltip",!0),C=t.mainType,T={componentType:C,name:n,$vars:["name"]};T[C+"Index"]=t.componentIndex;var x=new Sa({anid:"name",__fullText:n,__truncatedText:v,position:d,rotation:o.rotation,silent:Np(t),z2:1,tooltip:y&&y.show?b({content:n,formatter:function(){return n},formatterParams:T},y):null});Vs(x.style,s,{text:v,textFont:h,textFill:s.getTextColor()||t.get("axisLine.lineStyle.color"),textAlign:s.get("align")||o.textAlign,textVerticalAlign:s.get("verticalAlign")||o.textVerticalAlign}),t.get("triggerEvent")&&(x.eventData=kp(t),x.eventData.targetType="axisName",x.eventData.name=n),this._dumbGroup.add(x),x.updateTransform(),this.group.add(x),x.decomposeTransform()}}},kp=wp.makeAxisEventDataBase=function(e){var t={componentType:e.mainType,componentIndex:e.componentIndex};return t[e.mainType+"Index"]=e.componentIndex,t},Ap=wp.innerTextLayout=function(e,t,n){var o,i=wl(t-e);return{rotation:i,textAlign:Rl(i)?(o=0<n?"top":"bottom","center"):Rl(i-Rp)?(o=0<n?"bottom":"top","center"):(o="middle",0<i&&i<Rp?0<n?"right":"left":0<n?"left":"right"),textVerticalAlign:o}},Np=wp.isLabelSilent=function(e){var t=e.get("tooltip");return e.get("silent")||!(e.get("triggerEvent")||t&&t.show)};function Mp(e){e&&(e.ignore=!0)}function Kp(e,t){var n=e&&e.getBoundingRect().clone(),o=t&&t.getBoundingRect().clone();if(n&&o){var i=it([]);return lt(i,i,-e.rotation),n.applyTransform(at([],i,e.getLocalTransform())),o.applyTransform(at([],i,t.getLocalTransform())),n.intersect(o)}}function Pp(e){return"middle"===e||"center"===e}function Lp(e,t,n,o,i){for(var r=[],a=[],s=[],l=0;l<e.length;l++){var u=e[l].coord;a[0]=u,s[a[1]=0]=u,s[1]=n,t&&(Ce(a,a,t),Ce(s,s,t));var c=new ja({anid:i+"_"+e[l].tickValue,subPixelOptimize:!0,shape:{x1:a[0],y1:a[1],x2:s[0],y2:s[1]},style:o,z2:2,silent:!0});r.push(c)}return r}var Bp=O,Fp=N;function zp(e,t){return"all"===e||M(e)&&0<=E(e,t)||e===t}function Vp(e){var t=(e.ecModel.getComponent("axisPointer")||{}).coordSysAxesInfo;return t&&t.axesInfo[Wp(e)]}function Hp(e){return!!e.get("handle.show")}function Wp(e){return e.type+"||"+e.id}var $p=lh({type:"axis",_axisPointer:null,axisPointerClass:null,render:function(e,t,n,o){this.axisPointerClass&&function(e){var t=Vp(e);if(t){var n=t.axisPointerModel,o=t.axis.scale,i=n.option,r=n.get("status"),a=n.get("value");null!=a&&(a=o.parse(a));var s=Hp(n);null==r&&(i.status=s?"show":"hide");var l=o.getExtent().slice();l[0]>l[1]&&l.reverse(),(null==a||a>l[1])&&(a=l[1]),a<l[0]&&(a=l[0]),i.value=a,s&&(i.status=t.axis.scale.isBlank()?"hide":"show")}}(e),$p.superApply(this,"render",arguments),Up(this,e,0,n,0,!0)},updateAxisPointer:function(e,t,n,o,i){Up(this,e,0,n,0,!1)},remove:function(e,t){var n=this._axisPointer;n&&n.remove(t),$p.superApply(this,"remove",arguments)},dispose:function(e,t){qp(this,t),$p.superApply(this,"dispose",arguments)}});function Up(e,t,n,o,i,r){var a=$p.getAxisPointerClass(e.axisPointerClass);if(a){var s=function(e){var t=Vp(e);return t&&t.axisPointerModel}(t);s?(e._axisPointer||(e._axisPointer=new a)).render(t,s,o,r):qp(e,o)}}function qp(e,t,n){var o=e._axisPointer;o&&o.dispose(t,n),e._axisPointer=null}var jp=[];function Gp(e,t,n){n=n||{};var o=e.coordinateSystem,i=t.axis,r={},a=i.getAxesOnZeroOf()[0],s=i.position,l=a?"onZero":s,u=i.dim,c=o.getRect(),d=[c.x,c.x+c.width,c.y,c.y+c.height],f={left:0,right:1,top:0,bottom:1,onZero:2},h=t.get("offset")||0,g="x"===u?[d[2]-h,d[3]+h]:[d[0]-h,d[1]+h];if(a){var m=a.toGlobalCoord(a.dataToCoord(0));g[f.onZero]=Math.max(Math.min(m,g[1]),g[0])}r.position=["y"===u?g[f[l]]:d[0],"x"===u?g[f[l]]:d[3]],r.rotation=Math.PI/2*("x"===u?0:1),r.labelDirection=r.tickDirection=r.nameDirection={top:-1,bottom:1,left:-1,right:1}[s],r.labelOffset=a?g[f[s]]-g[f.onZero]:0,t.get("axisTick.inside")&&(r.tickDirection=-r.tickDirection),H(n.labelInside,t.get("axisLabel.inside"))&&(r.labelDirection=-r.labelDirection);var p=t.get("axisLabel.rotate");return r.labelRotate="top"===l?-p:p,r.z2=1,r}function Xp(e,t,n,o){var i=n.axis;if(!i.scale.isBlank()){var r=n.getModel("splitArea"),a=r.getModel("areaStyle"),s=a.get("color"),l=o.coordinateSystem.getRect(),u=i.getTicksCoords({tickModel:r,clamp:!0});if(u.length){var c=s.length,d=e.__splitAreaColors,f=Q(),h=0;if(d)for(var g=0;g<u.length;g++){var m=d.get(u[g].tickValue);if(null!=m){h=(m+(c-1)*g)%c;break}}var p=i.toGlobalCoord(u[0].coord),v=a.getAreaStyle();for(s=M(s)?s:[s],g=1;g<u.length;g++){var y,b,T,x,E=i.toGlobalCoord(u[g].coord);p=i.isHorizontal()?(b=l.y,x=l.height,(y=p)+(T=E-y)):(y=l.x,T=l.width,(b=p)+(x=E-b));var _=u[g-1].tickValue;null!=_&&f.set(_,h),t.add(new Ua({anid:null!=_?"area_"+_:null,shape:{x:y,y:b,width:T,height:x},style:C({fill:s[h]},v),silent:!0})),h=(h+1)%c}e.__splitAreaColors=f}}}function Yp(e){e.__splitAreaColors=null}$p.registerAxisPointerClass=function(e,t){jp[e]=t},$p.getAxisPointerClass=function(e){return e&&jp[e]};var Zp=["axisLine","axisTickLabel","axisName"],Jp=["splitArea","splitLine","minorSplitLine"],Qp=$p.extend({type:"cartesianAxis",axisPointerClass:"CartesianAxisPointer",render:function(e,t,n,o){this.group.removeAll();var i=this._axisGroup;if(this._axisGroup=new _n,this.group.add(this._axisGroup),e.get("show")){var r=e.getCoordSysModel(),a=Gp(r,e),s=new wp(e,a);O(Zp,s.add,s),this._axisGroup.add(s.getGroup()),O(Jp,(function(t){e.get(t+".show")&&this["_"+t](e,r)}),this),el(i,this._axisGroup,e),Qp.superCall(this,"render",e,t,n,o)}},remove:function(){Yp(this)},_splitLine:function(e,t){var n=e.axis;if(!n.scale.isBlank()){var o=e.getModel("splitLine"),i=o.getModel("lineStyle"),r=i.get("color");r=M(r)?r:[r];for(var a=t.coordinateSystem.getRect(),s=n.isHorizontal(),l=0,u=n.getTicksCoords({tickModel:o}),c=[],d=[],f=i.getLineStyle(),h=0;h<u.length;h++){var g=n.toGlobalCoord(u[h].coord);s?(c[0]=g,c[1]=a.y,d[0]=g,d[1]=a.y+a.height):(c[0]=a.x,c[1]=g,d[0]=a.x+a.width,d[1]=g);var m=l++%r.length;this._axisGroup.add(new ja({anid:null!=u[h].tickValue?"line_"+u[h].tickValue:null,subPixelOptimize:!0,shape:{x1:c[0],y1:c[1],x2:d[0],y2:d[1]},style:C({stroke:r[m]},f),silent:!0}))}}},_minorSplitLine:function(e,t){var n=e.axis,o=e.getModel("minorSplitLine").getModel("lineStyle"),i=t.coordinateSystem.getRect(),r=n.isHorizontal(),a=n.getMinorTicksCoords();if(a.length)for(var s=[],l=[],u=o.getLineStyle(),c=0;c<a.length;c++)for(var d=0;d<a[c].length;d++){var f=n.toGlobalCoord(a[c][d].coord);r?(s[0]=f,s[1]=i.y,l[0]=f,l[1]=i.y+i.height):(s[0]=i.x,s[1]=f,l[0]=i.x+i.width,l[1]=f),this._axisGroup.add(new ja({anid:"minor_line_"+a[c][d].tickValue,subPixelOptimize:!0,shape:{x1:s[0],y1:s[1],x2:l[0],y2:l[1]},style:u,silent:!0}))}},_splitArea:function(e,t){Xp(this,this._axisGroup,e,t)}});Qp.extend({type:"xAxis"}),Qp.extend({type:"yAxis"}),lh({type:"grid",render:function(e,t){this.group.removeAll(),e.get("show")&&this.group.add(new Ua({shape:e.coordinateSystem.getRect(),style:C({fill:e.get("backgroundColor")},e.getItemStyle()),silent:!0,z2:-1}))}}),Qf((function(e){e.xAxis&&e.yAxis&&!e.grid&&(e.grid={})})),ih(rp("line","circle","line")),oh(ap("line")),eh(ff.PROCESSOR.STATISTIC,{seriesType:"line",modifyOutputEnd:!0,reset:function(e,t,n){var o=e.getData(),i=e.get("sampling"),r=e.coordinateSystem;if("cartesian2d"===r.type&&i){var a,s=r.getBaseAxis(),l=r.getOtherAxis(s),u=s.getExtent(),c=Math.abs(u[1]-u[0]),d=Math.round(o.count()/c);1<d&&("string"==typeof i?a=lp[i]:"function"==typeof i&&(a=i),a&&e.setData(o.downSample(o.mapDimension(l.dim),1/d,a,sp)))}}});var ev=Wc.extend({type:"series.__base_bar__",getInitialData:function(e,t){return Xh(this.getSource(),this,{useEncodeDefaulter:!0})},getMarkerPosition:function(e){var t=this.coordinateSystem;if(t){var n=t.dataToPoint(t.clampData(e)),o=this.getData(),i=o.getLayout("offset"),r=o.getLayout("size");return n[t.getBaseAxis().isHorizontal()?0:1]+=i+r/2,n}return[NaN,NaN]},defaultOption:{zlevel:0,z:2,coordinateSystem:"cartesian2d",legendHoverLink:!0,barMinHeight:0,barMinAngle:0,large:!1,largeThreshold:400,progressive:3e3,progressiveChunkMode:"mod",itemStyle:{},emphasis:{}}});function tv(e,t,n,o,i,r){Fs(e,t,n.getModel("label"),n.getModel("emphasis.label"),{labelFetcher:i,labelDataIndex:r,defaultText:Tm(i.getData(),r),isRectText:!0,autoColor:o}),nv(e),nv(t)}function nv(e,t){"outside"===e.textPosition&&(e.textPosition=t)}ev.extend({type:"series.bar",dependencies:["grid","polar"],brushSelector:"rect",getProgressive:function(){return!!this.get("large")&&this.get("progressive")},getProgressiveThreshold:function(){var e=this.get("progressiveThreshold"),t=this.get("largeThreshold");return e<t&&(e=t),e},defaultOption:{clip:!0,roundCap:!1,showBackground:!1,backgroundStyle:{color:"rgba(180, 180, 180, 0.2)",borderColor:null,borderWidth:0,borderType:"solid",borderRadius:0,shadowBlur:0,shadowColor:null,shadowOffsetX:0,shadowOffsetY:0,opacity:1}}});var ov=Zi([["fill","color"],["stroke","borderColor"],["lineWidth","borderWidth"],["stroke","barBorderColor"],["lineWidth","barBorderWidth"],["opacity"],["shadowBlur"],["shadowOffsetX"],["shadowOffsetY"],["shadowColor"]]),iv={getBarItemStyle:function(e){var t=ov(this,e);if(this.getBorderLineDash){var n=this.getBorderLineDash();n&&(t.lineDash=n)}return t}},rv=hs({type:"sausage",shape:{cx:0,cy:0,r0:0,r:0,startAngle:0,endAngle:2*Math.PI,clockwise:!0},buildPath:function(e,t){var n=t.cx,o=t.cy,i=Math.max(t.r0||0,0),r=Math.max(t.r,0),a=.5*(r-i),s=i+a,l=t.startAngle,u=t.endAngle,c=t.clockwise,d=Math.cos(l),f=Math.sin(l),h=Math.cos(u),g=Math.sin(u);(c?u-l<2*Math.PI:l-u<2*Math.PI)&&(e.moveTo(d*i+n,f*i+o),e.arc(d*s+n,f*s+o,a,-Math.PI+l,l,!c)),e.arc(n,o,r,l,u,!c),e.moveTo(h*r+n,g*r+o),e.arc(h*s+n,g*s+o,a,u-2*Math.PI,u-Math.PI,!c),0!==i&&(e.arc(n,o,i,u,l,c),e.moveTo(d*i+n,g*i+o)),e.closePath()}}),av=["itemStyle","barBorderWidth"],sv=[0,0];b(hl.prototype,iv),ch({type:"bar",render:function(e,t,n){this._updateDrawMode(e);var o=e.get("coordinateSystem");return"cartesian2d"!==o&&"polar"!==o||(this._isLargeDraw?this._renderLarge(e,t,n):this._renderNormal(e,t,n)),this.group},incrementalPrepareRender:function(e,t,n){this._clear(),this._updateDrawMode(e)},incrementalRender:function(e,t,n,o){this._incrementalRenderLarge(e,t)},_updateDrawMode:function(e){var t=e.pipelineContext.large;(null==this._isLargeDraw||t^this._isLargeDraw)&&(this._isLargeDraw=t,this._clear())},_renderNormal:function(e,t,n){var o,i=this.group,r=e.getData(),a=this._data,s=e.coordinateSystem,l=s.getBaseAxis();"cartesian2d"===s.type?o=l.isHorizontal():"polar"===s.type&&(o="angle"===l.dim);var u=e.isAnimationEnabled()?e:null,c=e.get("clip",!0),d=function(e,t){var n=e.getArea&&e.getArea();if("cartesian2d"===e.type){var o=e.getBaseAxis();if("category"!==o.type||!o.onBand){var i=t.getLayout("bandWidth");o.isHorizontal()?(n.x-=i,n.width+=2*i):(n.y-=i,n.height+=2*i)}}return n}(s,r);function f(e){var t=gv[s.type](r,e),n=function(e,t,n){return new("polar"===e.type?Ma:Ua)({shape:Cv(t,n,e),silent:!0,z2:0})}(s,o,t);return n.useStyle(m.getBarItemStyle()),"cartesian2d"===s.type&&n.setShape("r",p),v[e]=n}i.removeClipPath();var h=e.get("roundCap",!0),g=e.get("showBackground",!0),m=e.getModel("backgroundStyle"),p=m.get("barBorderRadius")||0,v=[],y=this._backgroundEls||[];r.diff(a).add((function(t){var n=r.getItemModel(t),a=gv[s.type](r,t,n);if(g&&f(t),r.hasValue(t)){if(c&&cv[s.type](d,a))return void i.remove(l);var l=dv[s.type](t,a,o,u,!1,h);r.setItemGraphicEl(t,l),i.add(l),pv(l,r,t,n,a,e,0,"polar"===s.type)}})).update((function(t,n){var l=r.getItemModel(t),b=gv[s.type](r,t,l);if(g){var C;0===y.length?C=f(n):((C=y[n]).useStyle(m.getBarItemStyle()),"cartesian2d"===s.type&&C.setShape("r",p),v[t]=C);var T=gv[s.type](r,t);Xs(C,{shape:Cv(o,T,s)},u,t)}var x=a.getItemGraphicEl(n);if(r.hasValue(t)){if(c&&cv[s.type](d,b))return void i.remove(x);x?Xs(x,{shape:b},u,t):x=dv[s.type](t,b,o,u,!0,h),r.setItemGraphicEl(t,x),i.add(x),pv(x,r,t,l,b,e,0,"polar"===s.type)}else i.remove(x)})).remove((function(e){var t=a.getItemGraphicEl(e);"cartesian2d"===s.type?t&&fv(e,u,t):t&&hv(e,u,t)})).execute();var b=this._backgroundGroup||(this._backgroundGroup=new _n);b.removeAll();for(var C=0;C<v.length;++C)b.add(v[C]);i.add(b),this._backgroundEls=v,this._data=r},_renderLarge:function(e,t,n){this._clear(),yv(e,this.group);var o=e.get("clip",!0)?Qm(e.coordinateSystem,!1,e):null;o?this.group.setClipPath(o):this.group.removeClipPath()},_incrementalRenderLarge:function(e,t){this._removeBackground(),yv(t,this.group,!0)},dispose:te,remove:function(e){this._clear(e)},_clear:function(e){var t=this.group,n=this._data;e&&e.get("animation")&&n&&!this._isLargeDraw?(this._removeBackground(),this._backgroundEls=[],n.eachItemGraphicEl((function(t){"sector"===t.type?hv(t.dataIndex,e,t):fv(t.dataIndex,e,t)}))):t.removeAll(),this._data=null},_removeBackground:function(){this.group.remove(this._backgroundGroup),this._backgroundGroup=null}});var lv=Math.max,uv=Math.min,cv={cartesian2d:function(e,t){var n=t.width<0?-1:1,o=t.height<0?-1:1;n<0&&(t.x+=t.width,t.width=-t.width),o<0&&(t.y+=t.height,t.height=-t.height);var i=lv(t.x,e.x),r=uv(t.x+t.width,e.x+e.width),a=lv(t.y,e.y),s=uv(t.y+t.height,e.y+e.height);t.x=i,t.y=a,t.width=r-i,t.height=s-a;var l=t.width<0||t.height<0;return n<0&&(t.x+=t.width,t.width=-t.width),o<0&&(t.y+=t.height,t.height=-t.height),l},polar:function(e,t){var n=t.r0<=t.r?1:-1;if(n<0){var o=t.r;t.r=t.r0,t.r0=o}o=uv(t.r,e.r);var i=lv(t.r0,e.r0),r=(t.r=o)-(t.r0=i)<0;return n<0&&(o=t.r,t.r=t.r0,t.r0=o),r}},dv={cartesian2d:function(e,t,n,o,i){var r=new Ua({shape:b({},t),z2:1});if(r.name="item",o){var a=n?"height":"width",s={};r.shape[a]=0,s[a]=t[a],al[i?"updateProps":"initProps"](r,{shape:s},o,e)}return r},polar:function(e,t,n,o,i,r){var a=new(!n&&r?rv:Ma)({shape:C({clockwise:t.startAngle<t.endAngle},t),z2:1});if(a.name="item",o){var s=n?"r":"endAngle",l={};a.shape[s]=n?0:t.startAngle,l[s]=t[s],al[i?"updateProps":"initProps"](a,{shape:l},o,e)}return a}};function fv(e,t,n){n.style.text=null,Xs(n,{shape:{width:0}},t,e,(function(){n.parent&&n.parent.remove(n)}))}function hv(e,t,n){n.style.text=null,Xs(n,{shape:{r:n.shape.r0}},t,e,(function(){n.parent&&n.parent.remove(n)}))}var gv={cartesian2d:function(e,t,n){var o=e.getItemLayout(t),i=n?function(e,t){var n=e.get(av)||0,o=isNaN(t.width)?Number.MAX_VALUE:Math.abs(t.width),i=isNaN(t.height)?Number.MAX_VALUE:Math.abs(t.height);return Math.min(n,o,i)}(n,o):0,r=0<o.width?1:-1,a=0<o.height?1:-1;return{x:o.x+r*i/2,y:o.y+a*i/2,width:o.width-r*i,height:o.height-a*i}},polar:function(e,t,n){var o=e.getItemLayout(t);return{cx:o.cx,cy:o.cy,r0:o.r0,r:o.r,startAngle:o.startAngle,endAngle:o.endAngle}}};function mv(e){return null!=e.startAngle&&null!=e.endAngle&&e.startAngle===e.endAngle}function pv(e,t,n,o,i,r,a,s){var l=t.getItemVisual(n,"color"),u=t.getItemVisual(n,"opacity"),c=t.getVisual("borderColor"),d=o.getModel("itemStyle"),f=o.getModel("emphasis.itemStyle").getBarItemStyle();s||e.setShape("r",d.get("barBorderRadius")||0),e.useStyle(C({stroke:mv(i)?"none":c,fill:mv(i)?"none":l,opacity:u},d.getBarItemStyle()));var h=o.getShallow("cursor");h&&e.attr("cursor",h),s||tv(e.style,f,o,l,r,n),mv(i)&&(f.fill=f.stroke="none"),Ks(e,f)}var vv=ha.extend({type:"largeBar",shape:{points:[]},buildPath:function(e,t){for(var n=t.points,o=this.__startPoint,i=this.__baseDimIdx,r=0;r<n.length;r+=2)o[i]=n[r+i],e.moveTo(o[0],o[1]),e.lineTo(n[r],n[r+1])}});function yv(e,t,n){var o=e.getData(),i=[],r=o.getLayout("valueAxisHorizontal")?1:0;i[1-r]=o.getLayout("valueAxisStart");var a=o.getLayout("largeDataIndices"),s=o.getLayout("barWidth"),l=e.getModel("backgroundStyle");if(e.get("showBackground",!0)){var u=o.getLayout("largeBackgroundPoints"),c=[];c[1-r]=o.getLayout("backgroundStart");var d=new vv({shape:{points:u},incremental:!!n,__startPoint:c,__baseDimIdx:r,__largeDataIndices:a,__barWidth:s,silent:!0,z2:0});!function(e,t,n){var o=t.get("borderColor")||t.get("color"),i=t.getItemStyle(["color","borderColor"]);e.useStyle(i),e.style.fill=null,e.style.stroke=o,e.style.lineWidth=n.getLayout("barWidth")}(d,l,o),t.add(d)}var f=new vv({shape:{points:o.getLayout("largePoints")},incremental:!!n,__startPoint:i,__baseDimIdx:r,__largeDataIndices:a,__barWidth:s});t.add(f),function(e,t,n){var o=n.getVisual("borderColor")||n.getVisual("color"),i=t.getModel("itemStyle").getItemStyle(["color","borderColor"]);e.useStyle(i),e.style.fill=null,e.style.stroke=o,e.style.lineWidth=n.getLayout("barWidth")}(f,e,o),f.seriesIndex=e.seriesIndex,e.get("silent")||(f.on("mousedown",bv),f.on("mousemove",bv))}var bv=fd((function(e){var t=function(e,t,n){var o=e.__baseDimIdx,i=1-o,r=e.shape.points,a=e.__largeDataIndices,s=Math.abs(e.__barWidth/2),l=e.__startPoint[i];sv[0]=t,sv[1]=n;for(var u=sv[o],c=sv[1-o],d=u-s,f=u+s,h=0,g=r.length/2;h<g;h++){var m=2*h,p=r[m+o],v=r[m+i];if(d<=p&&p<=f&&(l<=v?l<=c&&c<=v:v<=c&&c<=l))return a[h]}return-1}(this,e.offsetX,e.offsetY);this.dataIndex=0<=t?t:null}),30,!1);function Cv(e,t,n){var o,i="polar"===n.type;return o=i?n.getArea():n.grid.getRect(),i?{cx:o.cx,cy:o.cy,r0:e?o.r0:t.r0,r:e?o.r:t.r,startAngle:e?t.startAngle:0,endAngle:e?t.endAngle:2*Math.PI}:{x:e?t.x:o.x,y:e?o.y:t.y,width:e?t.width:o.width,height:e?o.height:t.height}}function Tv(e,t,n){t=M(t)&&{coordDimensions:t}||b({},t);var o=e.getSource(),i=Hh(o,t),r=new wh(i,e);return r.initData(o,n),r}oh(ff.VISUAL.LAYOUT,N(vg,"bar")),oh(ff.VISUAL.PROGRESSIVE_LAYOUT,yg),ih({seriesType:"bar",reset:function(e){e.getData().setVisual("legendSymbol","roundRect")}});var xv={updateSelectedMap:function(e){this._targetList=M(e)?e.slice():[],this._selectTargetMap=R(e||[],(function(e,t){return e.set(t.name,t),e}),Q())},select:function(e,t){var n=null!=t?this._targetList[t]:this._selectTargetMap.get(e);"single"===this.get("selectedMode")&&this._selectTargetMap.each((function(e){e.selected=!1})),n&&(n.selected=!0)},unSelect:function(e,t){var n=null!=t?this._targetList[t]:this._selectTargetMap.get(e);n&&(n.selected=!1)},toggleSelected:function(e,t){var n=null!=t?this._targetList[t]:this._selectTargetMap.get(e);if(null!=n)return this[n.selected?"unSelect":"select"](e,t),n.selected},isSelected:function(e,t){var n=null!=t?this._targetList[t]:this._selectTargetMap.get(e);return n&&n.selected}};function Ev(e,t){this.getAllNames=function(){var e=t();return e.mapArray(e.getName)},this.containName=function(e){return 0<=t().indexOfName(e)},this.indexOfName=function(t){return e().indexOfName(t)},this.getItemVisual=function(t,n){return e().getItemVisual(t,n)}}var _v=uh({type:"series.pie",init:function(e){_v.superApply(this,"init",arguments),this.legendVisualProvider=new Ev(A(this.getData,this),A(this.getRawData,this)),this.updateSelectedMap(this._createSelectableList()),this._defaultLabelLine(e)},mergeOption:function(e){_v.superCall(this,"mergeOption",e),this.updateSelectedMap(this._createSelectableList())},getInitialData:function(e,t){return Tv(this,{coordDimensions:["value"],encodeDefaulter:N(Ku,this)})},_createSelectableList:function(){for(var e=this.getRawData(),t=e.mapDimension("value"),n=[],o=0,i=e.count();o<i;o++)n.push({name:e.getName(o),value:e.get(t,o),selected:Dc(e,o,"selected")});return n},getDataParams:function(e){var t=this.getData(),n=_v.superCall(this,"getDataParams",e),o=[];return t.each(t.mapDimension("value"),(function(e){o.push(e)})),n.percent=Dl(o,e,t.hostModel.get("percentPrecision")),n.$vars.push("percent"),n},_defaultLabelLine:function(e){wi(e,"labelLine",["show"]);var t=e.labelLine,n=e.emphasis.labelLine;t.show=t.show&&e.label.show,n.show=n.show&&e.emphasis.label.show},defaultOption:{zlevel:0,z:2,legendHoverLink:!0,hoverAnimation:!0,center:["50%","50%"],radius:[0,"75%"],clockwise:!0,startAngle:90,minAngle:0,minShowLabelAngle:0,selectedOffset:10,hoverOffset:10,avoidLabelOverlap:!0,percentPrecision:2,stillShowZeroSum:!0,left:0,top:0,right:0,bottom:0,width:null,height:null,label:{rotate:!1,show:!0,position:"outer",alignTo:"none",margin:"25%",bleedMargin:10,distanceToLabelLine:5},labelLine:{show:!0,length:15,length2:15,smooth:!1,lineStyle:{width:1,type:"solid"}},itemStyle:{borderWidth:1},animationType:"expansion",animationTypeUpdate:"transition",animationEasing:"cubicOut"}});function Iv(e,t,n,o){var i=t.getData(),r=i.getName(this.dataIndex),a=t.get("selectedOffset");o.dispatchAction({type:"pieToggleSelect",from:e,name:r,seriesId:t.id}),i.each((function(e){Dv(i.getItemGraphicEl(e),i.getItemLayout(e),t.isSelected(i.getName(e)),a,n)}))}function Dv(e,t,n,o,i){var r=(t.startAngle+t.endAngle)/2,a=n?o:0,s=[Math.cos(r)*a,Math.sin(r)*a];i?e.animate().when(200,{position:s}).start("bounceOut"):e.attr("position",s)}function Ov(e,t){_n.call(this);var n=new Ma({z2:2}),o=new Fa,i=new Sa;this.add(n),this.add(o),this.add(i),this.updateData(e,t,!0)}I(_v,xv);var wv=Ov.prototype;function Rv(e,t){O(t,(function(t){t.update="updateView",th(t,(function(n,o){var i={};return o.eachComponent({mainType:"series",subType:e,query:n},(function(e){e[t.method]&&e[t.method](n.name,n.dataIndex);var o=e.getData();o.each((function(t){var n=o.getName(t);i[n]=e.isSelected(n)||!1}))})),{name:n.name,selected:i,seriesId:n.seriesId}}))}))}function Sv(e){return{getTargetSeries:function(t){var n={},o=Q();return t.eachSeriesByType(e,(function(e){e.__paletteScope=n,o.set(e.uid,e)})),o},reset:function(e,t){var n=e.getRawData(),o={},i=e.getData();i.each((function(e){var t=i.getRawIndex(e);o[t]=e})),n.each((function(t){var r,a=o[t],s=null!=a&&i.getItemVisual(a,"color",!0),l=null!=a&&i.getItemVisual(a,"borderColor",!0);if(s&&l||(r=n.getItemModel(t)),!s){var u=r.get("itemStyle.color")||e.getColorFromPalette(n.getName(t)||t+"",e.__paletteScope,n.count());null!=a&&i.setItemVisual(a,"color",u)}if(!l){var c=r.get("itemStyle.borderColor");null!=a&&i.setItemVisual(a,"borderColor",c)}}))}}}wv.updateData=function(e,t,n){var o=this.childAt(0),i=this.childAt(1),r=this.childAt(2),a=e.hostModel,s=e.getItemModel(t),l=e.getItemLayout(t),u=b({},l);u.label=null;var c=a.getShallow("animationTypeUpdate");n?(o.setShape(u),"scale"===a.getShallow("animationType")?(o.shape.r=l.r0,Ys(o,{shape:{r:l.r}},a,t)):(o.shape.endAngle=l.startAngle,Xs(o,{shape:{endAngle:l.endAngle}},a,t))):"expansion"===c?o.setShape(u):Xs(o,{shape:u},a,t);var d=e.getItemVisual(t,"color");o.useStyle(C({lineJoin:"bevel",fill:d},s.getModel("itemStyle").getItemStyle())),o.hoverStyle=s.getModel("emphasis.itemStyle").getItemStyle();var f=s.getShallow("cursor");f&&o.attr("cursor",f),Dv(this,e.getItemLayout(t),a.isSelected(e.getName(t)),a.get("selectedOffset"),a.get("animation")),this._updateLabel(e,t,!n&&"transition"===c),this.highDownOnUpdate=a.get("silent")?null:function(e,t){var n=a.isAnimationEnabled()&&s.get("hoverAnimation");"emphasis"===t?(i.ignore=i.hoverIgnore,r.ignore=r.hoverIgnore,n&&(o.stopAnimation(!0),o.animateTo({shape:{r:l.r+a.get("hoverOffset")}},300,"elasticOut"))):(i.ignore=i.normalIgnore,r.ignore=r.normalIgnore,n&&(o.stopAnimation(!0),o.animateTo({shape:{r:l.r}},300,"elasticOut")))},Ks(this)},wv._updateLabel=function(e,t,n){var o=this.childAt(1),i=this.childAt(2),r=e.hostModel,a=e.getItemModel(t),s=e.getItemLayout(t).label,l=e.getItemVisual(t,"color");if(!s||isNaN(s.x)||isNaN(s.y))i.ignore=i.normalIgnore=i.hoverIgnore=o.ignore=o.normalIgnore=o.hoverIgnore=!0;else{var u={points:s.linePoints||[[s.x,s.y],[s.x,s.y],[s.x,s.y]]},c={x:s.x,y:s.y};n?(Xs(o,{shape:u},r,t),Xs(i,{style:c},r,t)):(o.attr({shape:u}),i.attr({style:c})),i.attr({rotation:s.rotation,origin:[s.x,s.y],z2:10});var d=a.getModel("label"),f=a.getModel("emphasis.label"),h=a.getModel("labelLine"),g=a.getModel("emphasis.labelLine");l=e.getItemVisual(t,"color"),Fs(i.style,i.hoverStyle={},d,f,{labelFetcher:e.hostModel,labelDataIndex:t,defaultText:s.text,autoColor:l,useInsideStyle:!!s.inside},{textAlign:s.textAlign,textVerticalAlign:s.verticalAlign,opacity:e.getItemVisual(t,"opacity")}),i.ignore=i.normalIgnore=!d.get("show"),i.hoverIgnore=!f.get("show"),o.ignore=o.normalIgnore=!h.get("show"),o.hoverIgnore=!g.get("show"),o.setStyle({stroke:l,opacity:e.getItemVisual(t,"opacity")}),o.setStyle(h.getModel("lineStyle").getLineStyle()),o.hoverStyle=g.getModel("lineStyle").getLineStyle();var m=h.get("smooth");m&&!0===m&&(m=.4),o.setShape({smooth:m})}},_(Ov,_n),nd.extend({type:"pie",init:function(){var e=new _n;this._sectorGroup=e},render:function(e,t,n,o){if(!o||o.from!==this.uid){var i=e.getData(),r=this._data,a=this.group,s=t.get("animation"),l=!r,u=e.get("animationType"),c=e.get("animationTypeUpdate"),d=N(Iv,this.uid,e,s,n),f=e.get("selectedMode");if(i.diff(r).add((function(e){var t=new Ov(i,e);l&&"scale"!==u&&t.eachChild((function(e){e.stopAnimation(!0)})),f&&t.on("click",d),i.setItemGraphicEl(e,t),a.add(t)})).update((function(e,t){var n=r.getItemGraphicEl(t);l||"transition"===c||n.eachChild((function(e){e.stopAnimation(!0)})),n.updateData(i,e),n.off("click"),f&&n.on("click",d),a.add(n),i.setItemGraphicEl(e,n)})).remove((function(e){var t=r.getItemGraphicEl(e);a.remove(t)})).execute(),s&&0<i.count()&&(l?"scale"!==u:"transition"!==c)){for(var h=i.getItemLayout(0),g=1;isNaN(h.startAngle)&&g<i.count();++g)h=i.getItemLayout(g);var m=Math.max(n.getWidth(),n.getHeight())/2,p=A(a.removeClipPath,a);a.setClipPath(this._createClipPath(h.cx,h.cy,m,h.startAngle,h.clockwise,p,e,l))}else a.removeClipPath();this._data=i}},dispose:function(){},_createClipPath:function(e,t,n,o,i,r,a,s){var l=new Ma({shape:{cx:e,cy:t,r0:0,r:n,startAngle:o,endAngle:o,clockwise:i}});return(s?Ys:Xs)(l,{shape:{endAngle:o+(i?1:-1)*Math.PI*2}},a,r),l},containPoint:function(e,t){var n=t.getData().getItemLayout(0);if(n){var o=e[0]-n.cx,i=e[1]-n.cy,r=Math.sqrt(o*o+i*i);return r<=n.r&&r>=n.r0}}});var kv=Math.PI/180;function Av(e,t,n,o,i,r,a,s,l,u){function c(t,n,o){for(var i=t;i<n&&!(e[i].y+o>l+a);i++)if(e[i].y+=o,t<i&&i+1<n&&e[i+1].y>e[i].y+e[i].height)return void d(i,o/2);d(n-1,o/2)}function d(t,n){for(var o=t;0<=o&&!(e[o].y-n<l)&&(e[o].y-=n,!(0<o&&e[o].y>e[o-1].y+e[o-1].height));o--);}function f(e,t,n,o,i,r){for(var a=t?Number.MAX_VALUE:0,s=0,l=e.length;s<l;s++)if("none"===e[s].labelAlignTo){var u=Math.abs(e[s].y-o),c=e[s].len,d=e[s].len2,f=u<i+c?Math.sqrt((i+c+d)*(i+c+d)-u*u):Math.abs(e[s].x-n);t&&a<=f&&(f=a-10),!t&&f<=a&&(f=a+10),e[s].x=n+f*r,a=f}}e.sort((function(e,t){return e.y-t.y}));for(var h,g=0,m=e.length,p=[],v=[],y=0;y<m;y++)"outer"===e[y].position&&"labelLine"===e[y].labelAlignTo&&(e[y].linePoints[1][0]+=e[y].x-u,e[y].x=u),(h=e[y].y-g)<0&&c(y,m,-h),g=e[y].y+e[y].height;for(a-g<0&&d(m-1,g-a),y=0;y<m;y++)e[y].y>=n?v.push(e[y]):p.push(e[y]);f(p,!1,t,n,o,i),f(v,!0,t,n,o,i)}function Nv(e){return"center"===e.position}var Mv=2*Math.PI,Kv=Math.PI/180;function Pv(e){return{seriesType:e,reset:function(e,t){var n=t.findComponents({mainType:"legend"});if(n&&n.length){var o=e.getData();o.filterSelf((function(e){for(var t=o.getName(e),i=0;i<n.length;i++)if(!n[i].isSelected(t))return!1;return!0}))}}}}Rv("pie",[{type:"pieToggleSelect",event:"pieselectchanged",method:"toggleSelected"},{type:"pieSelect",event:"pieselected",method:"select"},{type:"pieUnSelect",event:"pieunselected",method:"unSelect"}]),ih(Sv("pie")),oh(N((function(e,t,n,o){t.eachSeriesByType(e,(function(e){var t=e.getData(),o=t.mapDimension("value"),i=function(e,t){return au(e.getBoxLayoutParams(),{width:t.getWidth(),height:t.getHeight()})}(e,n),r=e.get("center"),a=e.get("radius");M(a)||(a=[0,a]),M(r)||(r=[r,r]);var s=Cl(i.width,n.getWidth()),l=Cl(i.height,n.getHeight()),u=Math.min(s,l),c=Cl(r[0],s)+i.x,d=Cl(r[1],l)+i.y,f=Cl(a[0],u/2),h=Cl(a[1],u/2),g=-e.get("startAngle")*Kv,m=e.get("minAngle")*Kv,p=0;t.each(o,(function(e){isNaN(e)||p++}));var v=t.getSum(o),y=Math.PI/(v||p)*2,b=e.get("clockwise"),C=e.get("roseType"),T=e.get("stillShowZeroSum"),x=t.getDataExtent(o);x[0]=0;var E=Mv,_=0,I=g,D=b?1:-1;if(t.each(o,(function(e,n){var o;if(isNaN(e))t.setItemLayout(n,{angle:NaN,startAngle:NaN,endAngle:NaN,clockwise:b,cx:c,cy:d,r0:f,r:C?NaN:h,viewRect:i});else{(o="area"!==C?0===v&&T?y:e*y:Mv/p)<m?E-=o=m:_+=e;var r=I+D*o;t.setItemLayout(n,{angle:o,startAngle:I,endAngle:r,clockwise:b,cx:c,cy:d,r0:f,r:C?bl(e,x,[f,h]):h,viewRect:i}),I=r}})),E<Mv&&p)if(E<=.001){var O=Mv/p;t.each(o,(function(e,n){if(!isNaN(e)){var o=t.getItemLayout(n);o.angle=O,o.startAngle=g+D*n*O,o.endAngle=g+D*(n+1)*O}}))}else y=E/_,I=g,t.each(o,(function(e,n){if(!isNaN(e)){var o=t.getItemLayout(n),i=o.angle===m?m:e*y;o.startAngle=I,o.endAngle=I+D*i,I+=D*i}}));!function(e,t,n,o,i,r){var a,s,l=e.getData(),u=[],c=!1,d=(e.get("minShowLabelAngle")||0)*kv;l.each((function(o){var r=l.getItemLayout(o),f=l.getItemModel(o),h=f.getModel("label"),g=h.get("position")||f.get("emphasis.label.position"),m=h.get("distanceToLabelLine"),p=h.get("alignTo"),v=Cl(h.get("margin"),n),y=h.get("bleedMargin"),b=h.getFont(),C=f.getModel("labelLine"),T=C.get("length");T=Cl(T,n);var x=C.get("length2");if(x=Cl(x,n),!(r.angle<d)){var E,_,I,D,O=(r.startAngle+r.endAngle)/2,w=Math.cos(O),R=Math.sin(O);a=r.cx,s=r.cy;var S,k=e.getFormattedLabel(o,"normal")||l.getName(o),A=io(k,b,D,"top"),N="inside"===g||"inner"===g;if("center"===g)E=r.cx,_=r.cy,D="center";else{var M=(N?(r.r+r.r0)/2*w:r.r*w)+a,K=(N?(r.r+r.r0)/2*R:r.r*R)+s;if(E=M+3*w,_=K+3*R,!N){var P=M+w*(T+t-r.r),L=K+R*(T+t-r.r),B=P+(w<0?-1:1)*x;E="edge"===p?w<0?i+v:i+n-v:B+(w<0?-m:m),I=[[M,K],[P,L],[B,_=L]]}D=N?"center":"edge"===p?0<w?"right":"left":0<w?"left":"right"}var F=h.get("rotate");S="number"==typeof F?F*(Math.PI/180):F?w<0?-O+Math.PI:-O:0,c=!!S,r.label={x:E,y:_,position:g,height:A.height,len:T,len2:x,linePoints:I,textAlign:D,verticalAlign:"middle",rotation:S,inside:N,labelDistance:m,labelAlignTo:p,labelMargin:v,bleedMargin:y,textRect:A,text:k,font:b},N||u.push(r.label)}})),!c&&e.get("avoidLabelOverlap")&&function(e,t,n,o,i,r,a,s){for(var l=[],u=[],c=Number.MAX_VALUE,d=-Number.MAX_VALUE,f=0;f<e.length;f++)Nv(e[f])||(e[f].x<t?(c=Math.min(c,e[f].x),l.push(e[f])):(d=Math.max(d,e[f].x),u.push(e[f])));for(Av(u,t,n,o,1,0,r,0,s,d),Av(l,t,n,o,-1,0,r,0,s,c),f=0;f<e.length;f++){var h=e[f];if(!Nv(h)){var g=h.linePoints;if(g){var m,p="edge"===h.labelAlignTo,v=h.textRect.width;(m=p?h.x<t?g[2][0]-h.labelDistance-a-h.labelMargin:a+i-h.labelMargin-g[2][0]-h.labelDistance:h.x<t?h.x-a-h.bleedMargin:a+i-h.x-h.bleedMargin)<h.textRect.width&&(h.text=lo(h.text,m,h.font),"edge"===h.labelAlignTo&&(v=oo(h.text,h.font)));var y=g[1][0]-g[2][0];p?g[2][0]=h.x<t?a+h.labelMargin+v+h.labelDistance:a+i-h.labelMargin-v-h.labelDistance:(g[2][0]=h.x<t?h.x+h.labelDistance:h.x-h.labelDistance,g[1][0]=g[2][0]+y),g[1][1]=g[2][1]=h.y}}}}(u,a,s,t,n,o,i,r)}(e,h,i.width,i.height,i.x,i.y)}))}),"pie")),eh(Pv("pie")),Wc.extend({type:"series.scatter",dependencies:["grid","polar","geo","singleAxis","calendar"],getInitialData:function(e,t){return Xh(this.getSource(),this,{useEncodeDefaulter:!0})},brushSelector:"point",getProgressive:function(){var e=this.option.progressive;return null==e?this.option.large?5e3:this.get("progressive"):e},getProgressiveThreshold:function(){var e=this.option.progressiveThreshold;return null==e?this.option.large?1e4:this.get("progressiveThreshold"):e},defaultOption:{coordinateSystem:"cartesian2d",zlevel:0,z:2,legendHoverLink:!0,hoverAnimation:!0,symbolSize:10,large:!1,largeThreshold:2e3,itemStyle:{opacity:.8},clip:!0}});var Lv=hs({shape:{points:null},symbolProxy:null,softClipShape:null,buildPath:function(e,t){var n=t.points,o=t.size,i=this.symbolProxy,r=i.shape;if(!((e.getContext?e.getContext():e)&&o[0]<4))for(var a=0;a<n.length;){var s=n[a++],l=n[a++];isNaN(s)||isNaN(l)||this.softClipShape&&!this.softClipShape.contain(s,l)||(r.x=s-o[0]/2,r.y=l-o[1]/2,r.width=o[0],r.height=o[1],i.buildPath(e,r,!0))}},afterBrush:function(e){var t=this.shape,n=t.points,o=t.size;if(o[0]<4){this.setTransform(e);for(var i=0;i<n.length;){var r=n[i++],a=n[i++];isNaN(r)||isNaN(a)||this.softClipShape&&!this.softClipShape.contain(r,a)||e.fillRect(r-o[0]/2,a-o[1]/2,o[0],o[1])}this.restoreTransform(e)}},findDataIndex:function(e,t){for(var n=this.shape,o=n.points,i=n.size,r=Math.max(i[0],4),a=Math.max(i[1],4),s=o.length/2-1;0<=s;s--){var l=2*s,u=o[l]-r/2,c=o[1+l]-a/2;if(u<=e&&c<=t&&e<=u+r&&t<=c+a)return s}return-1}});function Bv(){this.group=new _n}var Fv=Bv.prototype;function zv(e,t,n){pm.call(this,e,t,n),this.type="value",this.angle=0,this.name=""}function Vv(e,t,n){this._model=e,this.dimensions=[],this._indicatorAxes=w(e.getIndicatorModels(),(function(e,t){var n="indicator_"+t,o=new zv(n,"log"===e.get("axisType")?new Lg:new lg);return o.name=e.get("name"),(o.model=e).axis=o,this.dimensions.push(n),o}),this),this.resize(e,n)}Fv.isPersistent=function(){return!this._incremental},Fv.updateData=function(e,t){this.group.removeAll();var n=new Lv({rectHover:!0,cursor:"default"});n.setShape({points:e.getLayout("symbolPoints")}),this._setCommon(n,e,!1,t),this.group.add(n),this._incremental=null},Fv.updateLayout=function(e){if(!this._incremental){var t=e.getLayout("symbolPoints");this.group.eachChild((function(e){null!=e.startIndex&&(t=new Float32Array(t.buffer,4*e.startIndex*2,2*(e.endIndex-e.startIndex))),e.setShape("points",t)}))}},Fv.incrementalPrepareUpdate=function(e){this.group.removeAll(),this._clearIncremental(),2e6<e.count()?(this._incremental||(this._incremental=new ns({silent:!0})),this.group.add(this._incremental)):this._incremental=null},Fv.incrementalUpdate=function(e,t,n){var o;this._incremental?(o=new Lv,this._incremental.addDisplayable(o,!0)):((o=new Lv({rectHover:!0,cursor:"default",startIndex:e.start,endIndex:e.end})).incremental=!0,this.group.add(o)),o.setShape({points:t.getLayout("symbolPoints")}),this._setCommon(o,t,!!this._incremental,n)},Fv._setCommon=function(e,t,n,o){var i=t.hostModel;o=o||{};var r=t.getVisual("symbolSize");e.setShape("size",r instanceof Array?r:[r,r]),e.softClipShape=o.clipShape||null,e.symbolProxy=tm(t.getVisual("symbol"),0,0,0,0),e.setColor=e.symbolProxy.setColor;var a=e.shape.size[0]<4;e.useStyle(i.getModel("itemStyle").getItemStyle(a?["color","shadowBlur","shadowColor"]:["color"]));var s=t.getVisual("color");s&&e.setColor(s),n||(e.seriesIndex=i.seriesIndex,e.on("mousemove",(function(t){e.dataIndex=null;var n=e.findDataIndex(t.offsetX,t.offsetY);0<=n&&(e.dataIndex=n+(e.startIndex||0))})))},Fv.remove=function(){this._clearIncremental(),this._incremental=null,this.group.removeAll()},Fv._clearIncremental=function(){var e=this._incremental;e&&e.clearDisplaybles()},ch({type:"scatter",render:function(e,t,n){var o=e.getData();this._updateSymbolDraw(o,e).updateData(o,{clipShape:this._getClipShape(e)}),this._finished=!0},incrementalPrepareRender:function(e,t,n){var o=e.getData();this._updateSymbolDraw(o,e).incrementalPrepareUpdate(o),this._finished=!1},incrementalRender:function(e,t,n){this._symbolDraw.incrementalUpdate(e,t.getData(),{clipShape:this._getClipShape(t)}),this._finished=e.end===t.getData().count()},updateTransform:function(e,t,n){var o=e.getData();if(this.group.dirty(),!this._finished||1e4<o.count()||!this._symbolDraw.isPersistent())return{update:!0};var i=ap().reset(e);i.progress&&i.progress({start:0,end:o.count()},o),this._symbolDraw.updateLayout(o)},_getClipShape:function(e){var t=e.coordinateSystem,n=t&&t.getArea&&t.getArea();return e.get("clip",!0)?n:null},_updateSymbolDraw:function(e,t){var n=this._symbolDraw,o=t.pipelineContext.large;return n&&o===this._isLargeDraw||(n&&n.remove(),n=this._symbolDraw=o?new Bv:new Am,this._isLargeDraw=o,this.group.removeAll()),this.group.add(n.group),n},remove:function(e,t){this._symbolDraw&&this._symbolDraw.remove(!0),this._symbolDraw=null},dispose:function(){}}),ih(rp("scatter","circle")),oh(ap("scatter")),_(zv,pm),Vv.prototype.getIndicatorAxes=function(){return this._indicatorAxes},Vv.prototype.dataToPoint=function(e,t){return this.coordToPoint(this._indicatorAxes[t].dataToCoord(e),t)},Vv.prototype.coordToPoint=function(e,t){var n=this._indicatorAxes[t].angle;return[this.cx+e*Math.cos(n),this.cy-e*Math.sin(n)]},Vv.prototype.pointToData=function(e){var t=e[0]-this.cx,n=e[1]-this.cy,o=Math.sqrt(t*t+n*n);t/=o,n/=o;for(var i,r=Math.atan2(-n,t),a=1/0,s=-1,l=0;l<this._indicatorAxes.length;l++){var u=this._indicatorAxes[l],c=Math.abs(r-u.angle);c<a&&(i=u,s=l,a=c)}return[s,+(i&&i.coordToData(o))]},Vv.prototype.resize=function(e,t){var n=e.get("center"),o=t.getWidth(),i=t.getHeight(),r=Math.min(o,i)/2;this.cx=Cl(n[0],o),this.cy=Cl(n[1],i),this.startAngle=e.get("startAngle")*Math.PI/180;var a=e.get("radius");"string"!=typeof a&&"number"!=typeof a||(a=[0,a]),this.r0=Cl(a[0],r),this.r=Cl(a[1],r),O(this._indicatorAxes,(function(e,t){e.setExtent(this.r0,this.r);var n=this.startAngle+t*Math.PI*2/this._indicatorAxes.length;n=Math.atan2(Math.sin(n),Math.cos(n)),e.angle=n}),this)},Vv.prototype.update=function(e,t){var n=this._indicatorAxes,o=this._model;O(n,(function(e){e.scale.setExtent(1/0,-1/0)})),e.eachSeriesByType("radar",(function(t,i){if("radar"===t.get("coordinateSystem")&&e.getComponent("radar",t.get("radarIndex"))===o){var r=t.getData();O(n,(function(e){e.scale.unionExtentFromData(r,r.mapDimension(e.dim))}))}}),this);var i=o.get("splitNumber");function r(e){var t=Math.pow(10,Math.floor(Math.log(e)/Math.LN10)),n=e/t;return 2===n?n=5:n*=2,n*t}O(n,(function(e,t){var n=Fg(e.scale,e.model).extent;zg(e.scale,e.model);var o=e.model,a=e.scale,s=o.getMin(),l=o.getMax(),u=a.getInterval();if(null!=s&&null!=l)a.setExtent(+s,+l),a.setInterval((l-s)/i);else if(null!=s)for(;a.setExtent(+s,d=s+u*i),a.setInterval(u),u=r(u),d<n[1]&&isFinite(d)&&isFinite(n[1]););else if(null!=l)for(;a.setExtent(f=l-u*i,+l),a.setInterval(u),u=r(u),f>n[0]&&isFinite(f)&&isFinite(n[0]););else{var c=a.getTicks().length-1;i<c&&(u=r(u));var d,f=Tl((d=Math.ceil(n[1]/u)*u)-u*i);a.setExtent(f,d),a.setInterval(u)}}))},Vv.dimensions=[],Vv.create=function(e,t){var n=[];return e.eachComponent("radar",(function(o){var i=new Vv(o,e,t);n.push(i),o.coordinateSystem=i})),e.eachSeriesByType("radar",(function(e){"radar"===e.get("coordinateSystem")&&(e.coordinateSystem=n[e.get("radarIndex")||0])})),n},Uu.register("radar",Vv);var Hv=gp.valueAxis;function Wv(e,t){return C({show:t},e)}sh({type:"radar",optionUpdated:function(){var e=this.get("boundaryGap"),t=this.get("splitNumber"),n=this.get("scale"),o=this.get("axisLine"),i=this.get("axisTick"),r=this.get("axisType"),a=this.get("axisLabel"),s=this.get("name"),l=this.get("name.show"),u=this.get("name.formatter"),c=this.get("nameGap"),d=this.get("triggerEvent"),f=w(this.get("indicator")||[],(function(f){null!=f.max&&0<f.max&&!f.min?f.min=0:null!=f.min&&f.min<0&&!f.max&&(f.max=0);var h=s;if(null!=f.color&&(h=C({color:f.color},s)),f=v(p(f),{boundaryGap:e,splitNumber:t,scale:n,axisLine:o,axisTick:i,axisType:r,axisLabel:a,name:f.text,nameLocation:"end",nameGap:c,nameTextStyle:h,triggerEvent:d},!1),l||(f.name=""),"string"==typeof u){var g=f.name;f.name=u.replace("{value}",null!=g?g:"")}else"function"==typeof u&&(f.name=u(f.name,f));var m=b(new hl(f,null,this.ecModel),qg);return m.mainType="radar",m.componentIndex=this.componentIndex,m}),this);this.getIndicatorModels=function(){return f}},defaultOption:{zlevel:0,z:0,center:["50%","50%"],radius:"75%",startAngle:90,name:{show:!0},boundaryGap:[0,0],splitNumber:5,nameGap:15,scale:!1,shape:"polygon",axisLine:v({lineStyle:{color:"#bbb"}},Hv.axisLine),axisLabel:Wv(Hv.axisLabel,!1),axisTick:Wv(Hv.axisTick,!1),axisType:"interval",splitLine:Wv(Hv.splitLine,!0),splitArea:Wv(Hv.splitArea,!0),indicator:[]}});var $v=["axisLine","axisTickLabel","axisName"];lh({type:"radar",render:function(e,t,n){this.group.removeAll(),this._buildAxes(e),this._buildSplitLineAndArea(e)},_buildAxes:function(e){var t=e.coordinateSystem;O(w(t.getIndicatorAxes(),(function(e){return new wp(e.model,{position:[t.cx,t.cy],rotation:e.angle,labelDirection:-1,tickDirection:-1,nameDirection:1})})),(function(e){O($v,e.add,e),this.group.add(e.getGroup())}),this)},_buildSplitLineAndArea:function(e){var t=e.coordinateSystem,n=t.getIndicatorAxes();if(n.length){var o=e.get("shape"),i=e.getModel("splitLine"),r=e.getModel("splitArea"),a=i.getModel("lineStyle"),s=r.getModel("areaStyle"),l=i.get("show"),u=r.get("show"),c=a.get("color"),d=s.get("color");c=M(c)?c:[c],d=M(d)?d:[d];var f=[],h=[];if("circle"===o)for(var g=n[0].getTicksCoords(),m=t.cx,p=t.cy,v=0;v<g.length;v++)l&&f[D(f,c,v)].push(new Aa({shape:{cx:m,cy:p,r:g[v].coord}})),u&&v<g.length-1&&h[D(h,d,v)].push(new Ka({shape:{cx:m,cy:p,r0:g[v].coord,r:g[v+1].coord}}));else{var y,b=w(n,(function(e,n){var o=e.getTicksCoords();return y=null==y?o.length-1:Math.min(o.length-1,y),w(o,(function(e){return t.coordToPoint(e.coord,n)}))})),T=[];for(v=0;v<=y;v++){for(var x=[],E=0;E<n.length;E++)x.push(b[E][v]);x[0]&&x.push(x[0].slice()),l&&f[D(f,c,v)].push(new Fa({shape:{points:x}})),u&&T&&h[D(h,d,v-1)].push(new Ba({shape:{points:x.concat(T)}})),T=x.slice().reverse()}}var _=a.getLineStyle(),I=s.getAreaStyle();O(h,(function(e,t){this.group.add(bs(e,{style:C({stroke:"none",fill:d[t%d.length]},I),silent:!0}))}),this),O(f,(function(e,t){this.group.add(bs(e,{style:C({fill:"none",stroke:c[t%c.length]},_),silent:!0}))}),this)}function D(e,t,n){var o=n%t.length;return e[o]=e[o]||[],o}}});var Uv=Wc.extend({type:"series.radar",dependencies:["radar"],init:function(e){Uv.superApply(this,"init",arguments),this.legendVisualProvider=new Ev(A(this.getData,this),A(this.getRawData,this))},getInitialData:function(e,t){return Tv(this,{generateCoord:"indicator_",generateCoordCount:1/0})},formatTooltip:function(e,t,n,o){var i=this.getData(),r=this.coordinateSystem.getIndicatorAxes(),a=this.getData().getName(e),s="html"===o?"<br/>":"\n";return Wl(""===a?this.name:a)+s+w(r,(function(t,n){var o=i.get(i.mapDimension(t.dim),e);return Wl(t.name+" : "+o)})).join(s)},getTooltipPosition:function(e){if(null!=e)for(var t=this.getData(),n=this.coordinateSystem,o=t.getValues(w(n.dimensions,(function(e){return t.mapDimension(e)})),e,!0),i=0,r=o.length;i<r;i++)if(!isNaN(o[i])){var a=n.getIndicatorAxes();return n.coordToPoint(a[i].dataToCoord(o[i]),i)}},defaultOption:{zlevel:0,z:2,coordinateSystem:"radar",legendHoverLink:!0,radarIndex:0,lineStyle:{width:2,type:"solid"},label:{position:"top"},symbol:"emptyCircle",symbolSize:4}});function qv(e){return!isNaN(e[0])&&!isNaN(e[1])}function jv(e){return[e.cx,e.cy]}ch({type:"radar",render:function(e,t,n){var o=e.coordinateSystem,i=this.group,r=e.getData(),a=this._data;function s(e,t){var n=e.getItemVisual(t,"symbol")||"circle",o=e.getItemVisual(t,"color");if("none"!==n){var i=function(e){return M(e)||(e=[+e,+e]),e}(e.getItemVisual(t,"symbolSize")),r=tm(n,-1,-1,2,2,o),a=e.getItemVisual(t,"symbolRotate")||0;return r.attr({style:{strokeNoScale:!0},z2:100,scale:[i[0]/2,i[1]/2],rotation:a*Math.PI/180||0}),r}}function l(t,n,o,i,r,a){o.removeAll();for(var l=0;l<n.length-1;l++){var u=s(i,r);u&&(t[u.__dimIdx=l]?(u.attr("position",t[l]),al[a?"initProps":"updateProps"](u,{position:n[l]},e,r)):u.attr("position",n[l]),o.add(u))}}function u(e){return w(e,(function(e){return[o.cx,o.cy]}))}r.diff(a).add((function(t){var n=r.getItemLayout(t);if(n){var o=new Ba,i=new Fa,a={shape:{points:n}};o.shape.points=u(n),i.shape.points=u(n),Ys(o,a,e,t),Ys(i,a,e,t);var s=new _n,c=new _n;s.add(i),s.add(o),s.add(c),l(i.shape.points,n,c,r,t,!0),r.setItemGraphicEl(t,s)}})).update((function(t,n){var o=a.getItemGraphicEl(n),i=o.childAt(0),s=o.childAt(1),u=o.childAt(2),c={shape:{points:r.getItemLayout(t)}};c.shape.points&&(l(i.shape.points,c.shape.points,u,r,t,!1),Xs(i,c,e),Xs(s,c,e),r.setItemGraphicEl(t,o))})).remove((function(e){i.remove(a.getItemGraphicEl(e))})).execute(),r.eachItemGraphicEl((function(e,t){var n=r.getItemModel(t),o=e.childAt(0),a=e.childAt(1),s=e.childAt(2),l=r.getItemVisual(t,"color");i.add(e),o.useStyle(C(n.getModel("lineStyle").getLineStyle(),{fill:"none",stroke:l})),o.hoverStyle=n.getModel("emphasis.lineStyle").getLineStyle();var u=n.getModel("areaStyle"),c=n.getModel("emphasis.areaStyle"),d=u.isEmpty()&&u.parentModel.isEmpty(),f=c.isEmpty()&&c.parentModel.isEmpty();f=f&&d,a.ignore=d,a.useStyle(C(u.getAreaStyle(),{fill:l,opacity:.7})),a.hoverStyle=c.getAreaStyle();var h=n.getModel("itemStyle").getItemStyle(["color"]),g=n.getModel("emphasis.itemStyle").getItemStyle(),m=n.getModel("label"),v=n.getModel("emphasis.label");s.eachChild((function(e){e.setStyle(h),e.hoverStyle=p(g);var n=r.get(r.dimensions[e.__dimIdx],t);null!=n&&!isNaN(n)||(n=""),Fs(e.style,e.hoverStyle,m,v,{labelFetcher:r.hostModel,labelDataIndex:t,labelDimIndex:e.__dimIdx,defaultText:n,autoColor:l,isRectText:!0})})),e.highDownOnUpdate=function(e,t){a.attr("ignore","emphasis"===t?f:d)},Ks(e)})),this._data=r},remove:function(){this.group.removeAll(),this._data=null},dispose:function(){}}),ih(Sv("radar")),ih(rp("radar","circle")),oh((function(e){e.eachSeriesByType("radar",(function(e){var t=e.getData(),n=[],o=e.coordinateSystem;if(o){var i=o.getIndicatorAxes();O(i,(function(e,r){t.each(t.mapDimension(i[r].dim),(function(e,t){n[t]=n[t]||[];var i=o.dataToPoint(e,r);n[t][r]=qv(i)?i:jv(o)}))})),t.each((function(e){var i=k(n[e],(function(e){return qv(e)}))||jv(o);n[e].push(i.slice()),t.setItemLayout(e,n[e])}))}}))})),eh(Pv("radar")),Qf((function(e){var t=e.polar;if(t){M(t)||(t=[t]);var n=[];O(t,(function(t,o){t.indicator?(t.type&&!t.shape&&(t.shape=t.type),e.radar=e.radar||[],M(e.radar)||(e.radar=[e.radar]),e.radar.push(t)):n.push(t)})),e.polar=n}O(e.series,(function(e){e&&"radar"===e.type&&e.polarIndex&&(e.radarIndex=e.polarIndex)}))}));for(var Gv=[126,25],Xv=[[[0,3.5],[7,11.2],[15,11.9],[30,7],[42,.7],[52,.7],[56,7.7],[59,.7],[64,.7],[64,0],[5,0],[0,3.5]],[[13,16.1],[19,14.7],[16,21.7],[11,23.1],[13,16.1]],[[12,32.2],[14,38.5],[15,38.5],[13,32.2],[12,32.2]],[[16,47.6],[12,53.2],[13,53.2],[18,47.6],[16,47.6]],[[6,64.4],[8,70],[9,70],[8,64.4],[6,64.4]],[[23,82.6],[29,79.8],[30,79.8],[25,82.6],[23,82.6]],[[37,70.7],[43,62.3],[44,62.3],[39,70.7],[37,70.7]],[[48,51.1],[51,45.5],[53,45.5],[50,51.1],[48,51.1]],[[51,35],[51,28.7],[53,28.7],[53,35],[51,35]],[[52,22.4],[55,17.5],[56,17.5],[53,22.4],[52,22.4]],[[58,12.6],[62,7],[63,7],[60,12.6],[58,12.6]],[[0,3.5],[0,93.1],[64,93.1],[64,0],[63,0],[63,92.4],[1,92.4],[1,3.5],[0,3.5]]],Yv=0;Yv<Xv.length;Yv++)for(var Zv=0;Zv<Xv[Yv].length;Zv++)Xv[Yv][Zv][0]/=10.5,Xv[Yv][Zv][1]/=-14,Xv[Yv][Zv][0]+=Gv[0],Xv[Yv][Zv][1]+=Gv[1];var Jv={"南海诸岛":[32,80],"广东":[0,-10],"香港":[10,5],"澳门":[-10,10],"天津":[5,5]},Qv={Russia:[100,60],"United States":[-99,38],"United States of America":[-99,38]},ey=[[[123.45165252685547,25.73527164402261],[123.49731445312499,25.73527164402261],[123.49731445312499,25.750734064600884],[123.45165252685547,25.750734064600884],[123.45165252685547,25.73527164402261]]],ty=Pi(),ny={load:function(e,t,n){var o=ty(t).parsed;if(o)return o;var i,r=t.specialAreas||{},a=t.geoJSON;try{i=a?sm(a,n):[]}catch(t){throw new Error("Invalid geoJson format\n"+t.message)}return function(e,t){"china"===e&&t.push(new rm("南海诸岛",w(Xv,(function(e){return{type:"polygon",exterior:e}})),Gv))}(e,i),O(i,(function(t){var n=t.name;!function(e,t){if("china"===e){var n=Jv[t.name];if(n){var o=t.center;o[0]+=n[0]/10.5,o[1]+=-n[1]/14}}}(e,t),function(e,t){if("world"===e){var n=Qv[t.name];if(n){var o=t.center;o[0]=n[0],o[1]=n[1]}}}(e,t),function(e,t){"china"===e&&"台湾"===t.name&&t.geometries.push({type:"polygon",exterior:ey[0]})}(e,t);var o=r[n];o&&t.transformTo(o.left,o.top,o.width,o.height)})),ty(t).parsed={regions:i,boundingRect:function(e){for(var t,n=0;n<e.length;n++){var o=e[n].getBoundingRect();(t=t||o.clone()).union(o)}return t}(i)}}},oy=Pi();function iy(e,t){var n,o,i=e.svgXML;try{j(null!=(o=(n=i&&function(e,t){return(new Ud).parse(e,{ignoreViewBox:!0,ignoreRootClip:!0})}(i)||{}).root))}catch(e){throw new Error("Invalid svg format\n"+e.message)}var r=n.width,a=n.height,s=n.viewBoxRect;if(t||(t=null==r||null==a?o.getBoundingRect():new En(0,0,0,0),null!=r&&(t.width=r),null!=a&&(t.height=a)),s){var l=nf(s,t.width,t.height),u=o;(o=new _n).add(u),u.scale=l.scale,u.position=l.position}return o.setClipPath(new Ua({shape:t.plain()})),{root:o,boundingRect:t}}var ry={geoJSON:ny,svg:{load:function(e,t){var n=oy(t).originRoot;if(n)return{root:n,boundingRect:oy(t).boundingRect};var o=iy(t);return oy(t).originRoot=o.root,oy(t).boundingRect=o.boundingRect,o},makeGraphic:function(e,t,n){var o=oy(t),i=o.rootMap||(o.rootMap=Q()),r=i.get(n);if(r)return r;var a=o.originRoot;return r=o.originRootHostKey?iy(t,o.boundingRect).root:(o.originRootHostKey=n,a),i.set(n,r)},removeGraphic:function(e,t,n){var o=oy(t),i=o.rootMap;i&&i.removeKey(n),n===o.originRootHostKey&&(o.originRootHostKey=null)}}},ay={load:function(e,t,n){var o,i=[],r=Q(),a=Q();return O(ly(e),(function(s){var l=ry[s.type].load(e,s,n);O(l.regions,(function(e){var n=e.name;t&&t.hasOwnProperty(n)&&(e=e.cloneShallow(n=t[n])),i.push(e),r.set(n,e),a.set(n,e.center)}));var u=l.boundingRect;u&&(o?o.union(u):o=u.clone())})),{regions:i,regionsMap:r,nameCoordMap:a,boundingRect:o||new En(0,0,0,0)}},makeGraphic:sy("makeGraphic"),removeGraphic:sy("removeGraphic")};function sy(e){return function(t,n){var o=ly(t),i=[];return O(o,(function(o){var r=ry[o.type][e];r&&i.push(r(t,o,n))})),i}}function ly(e){return rf(e)||[]}I(Wc.extend({type:"series.map",dependencies:["geo"],layoutMode:"box",needsDrawMap:!1,seriesGroup:[],getInitialData:function(e){for(var t=Tv(this,{coordDimensions:["value"],encodeDefaulter:N(Ku,this)}),n=t.mapDimension("value"),o=Q(),i=[],r=[],a=0,s=t.count();a<s;a++){var l=t.getName(a);o.set(l,!0),i.push({name:l,value:t.get(n,a),selected:Dc(t,a,"selected")})}return O(ay.load(this.getMapType(),this.option.nameMap,this.option.nameProperty).regions,(function(e){var t=e.name;o.get(t)||(i.push({name:t}),r.push(t))})),this.updateSelectedMap(i),t.appendValues([],r),t},getHostGeoModel:function(){var e=this.option.geoIndex;return null!=e?this.dependentModels.geo[e]:null},getMapType:function(){return(this.getHostGeoModel()||this).option.map},getRawValue:function(e){var t=this.getData();return t.get(t.mapDimension("value"),e)},getRegionModel:function(e){var t=this.getData();return t.getItemModel(t.indexOfName(e))},formatTooltip:function(e,t,n,o){for(var i=this.getData(),r=Bl(this.getRawValue(e)),a=i.getName(e),s=this.seriesGroup,l=[],u=0;u<s.length;u++){var c=s[u].originalData.indexOfName(a),d=i.mapDimension("value");isNaN(s[u].originalData.get(d,c))||l.push(Wl(s[u].name))}var f="html"===o?"<br/>":"\n";return l.join(", ")+f+Wl(a+" : "+r)},getTooltipPosition:function(e){if(null!=e){var t=this.getData().getName(e),n=this.coordinateSystem,o=n.getRegion(t);return o&&n.dataToPoint(o.center)}},setZoom:function(e){this.option.zoom=e},setCenter:function(e){this.option.center=e},defaultOption:{zlevel:0,z:2,coordinateSystem:"geo",map:"",left:"center",top:"center",aspectScale:.75,showLegendSymbol:!0,dataRangeHoverLink:!0,boundingCoords:null,center:null,zoom:1,scaleLimit:null,label:{show:!1,color:"#000"},itemStyle:{borderWidth:.5,borderColor:"#444",areaColor:"#eee"},emphasis:{label:{show:!0,color:"rgb(100,0,0)"},itemStyle:{areaColor:"rgba(255,215,0,0.8)"}},nameProperty:"name"}}),xv);var uy="\0_ec_interaction_mutex";function cy(e,t){return!!dy(e)[t]}function dy(e){return e[uy]||(e[uy]={})}function fy(e){this._zr=e,this._opt={};var t=A,n=t(hy,this),o=t(gy,this),i=t(my,this),r=t(py,this),a=t(vy,this);Oe.call(this),this.setPointerChecker=function(e){this.pointerChecker=e},this.enable=function(t,s){this.disable(),this._opt=C(p(s)||{},{zoomOnMouseWheel:!0,moveOnMouseMove:!0,moveOnMouseWheel:!1,preventDefaultMouseMove:!0}),null==t&&(t=!0),!0!==t&&"move"!==t&&"pan"!==t||(e.on("mousedown",n),e.on("mousemove",o),e.on("mouseup",i)),!0!==t&&"scale"!==t&&"zoom"!==t||(e.on("mousewheel",r),e.on("pinch",a))},this.disable=function(){e.off("mousedown",n),e.off("mousemove",o),e.off("mouseup",i),e.off("mousewheel",r),e.off("pinch",a)},this.dispose=this.disable,this.isDragging=function(){return this._dragging},this.isPinching=function(){return this._pinching}}function hy(e){if(!(Ue(e)||e.target&&e.target.draggable)){var t=e.offsetX,n=e.offsetY;this.pointerChecker&&this.pointerChecker(e,t,n)&&(this._x=t,this._y=n,this._dragging=!0)}}function gy(e){if(this._dragging&&Cy("moveOnMouseMove",e,this._opt)&&"pinch"!==e.gestureEvent&&!cy(this._zr,"globalPan")){var t=e.offsetX,n=e.offsetY,o=this._x,i=this._y,r=t-o,a=n-i;this._x=t,this._y=n,this._opt.preventDefaultMouseMove&&$e(e.event),by(this,"pan","moveOnMouseMove",e,{dx:r,dy:a,oldX:o,oldY:i,newX:t,newY:n})}}function my(e){Ue(e)||(this._dragging=!1)}function py(e){var t=Cy("zoomOnMouseWheel",e,this._opt),n=Cy("moveOnMouseWheel",e,this._opt),o=e.wheelDelta,i=Math.abs(o),r=e.offsetX,a=e.offsetY;if(0!==o&&(t||n)){if(t){var s=3<i?1.4:1<i?1.2:1.1;yy(this,"zoom","zoomOnMouseWheel",e,{scale:0<o?s:1/s,originX:r,originY:a})}if(n){var l=Math.abs(o);yy(this,"scrollMove","moveOnMouseWheel",e,{scrollDelta:(0<o?1:-1)*(3<l?.4:1<l?.15:.05),originX:r,originY:a})}}}function vy(e){cy(this._zr,"globalPan")||yy(this,"zoom",null,e,{scale:1<e.pinchScale?1.1:1/1.1,originX:e.pinchX,originY:e.pinchY})}function yy(e,t,n,o,i){e.pointerChecker&&e.pointerChecker(o,i.originX,i.originY)&&($e(o.event),by(e,t,n,o,i))}function by(e,t,n,o,i){i.isAvailableBehavior=A(Cy,null,n,o),e.trigger(t,i)}function Cy(e,t,n){var o=n[e];return!e||o&&(!P(o)||t.event[o+"Key"])}function Ty(e,t,n){var o=e.target,i=o.position;i[0]+=t,i[1]+=n,o.dirty()}function xy(e,t,n,o){var i=e.target,r=e.zoomLimit,a=i.position,s=i.scale,l=e.zoom=e.zoom||1;if(l*=t,r){var u=r.min||0;l=Math.max(Math.min(r.max||1/0,l),u)}var c=l/e.zoom;e.zoom=l,a[0]-=(n-a[0])*(c-1),a[1]-=(o-a[1])*(c-1),s[0]*=c,s[1]*=c,i.dirty()}th({type:"takeGlobalCursor",event:"globalCursorTaken",update:"update"},(function(){})),I(fy,Oe);var Ey={axisPointer:1,tooltip:1,brush:1};function _y(e,t,n){var o=t.getComponentByElement(e.topTarget),i=o&&o.coordinateSystem;return o&&o!==n&&!Ey[o.mainType]&&i&&i.model!==n}function Iy(e){var t=e.getItemStyle(),n=e.get("areaColor");return null!=n&&(t.fill=n),t}function Dy(e,t){t.eachChild((function(t){O(t.__regions,(function(n){t.trigger(e.isSelected(n.name)?"emphasis":"normal")}))}))}function Oy(e,t){var n=new _n;this.uid=vl("ec_map_draw"),this._controller=new fy(e.getZr()),this._controllerHost={target:t?n:null},this.group=n,this._updateGroup=t,n.add(this._regionsGroup=new _n),n.add(this._backgroundGroup=new _n)}Oy.prototype={constructor:Oy,draw:function(e,t,n,o,i){var r="geo"===e.mainType,a=e.getData&&e.getData();r&&t.eachComponent({mainType:"series",subType:"map"},(function(t){a||t.getHostGeoModel()!==e||(a=t.getData())}));var s=e.coordinateSystem;this._updateBackground(s);var l,u=this._regionsGroup,c=this.group,d=s.getTransformInfo(),f=!u.childAt(0)||i;if(f)c.transform=d.roamTransform,c.decomposeTransform(),c.dirty();else{var h=new mt;h.transform=d.roamTransform,h.decomposeTransform(),l=h.scale,Xs(c,{scale:h.scale,position:h.position},e)}var g=d.rawScale,m=d.rawPosition;u.removeAll();var p=["itemStyle"],v=["emphasis","itemStyle"],y=["label"],b=["emphasis","label"],C=Q();O(s.regions,(function(t){var n=C.get(t.name)||C.set(t.name,new _n),o=new Qa({segmentIgnoreThreshold:1,shape:{paths:[]}});n.add(o);var i,s=(M=e.getRegionModel(t.name)||e).getModel(p),d=M.getModel(v),h=Iy(s),T=Iy(d),x=M.getModel(y),E=M.getModel(b);if(a){i=a.indexOfName(t.name);var _=a.getItemVisual(i,"color",!0);_&&(h.fill=_)}function I(e){return[e[0]*g[0]+m[0],e[1]*g[1]+m[1]]}O(t.geometries,(function(e){if("polygon"===e.type){for(var t=[],n=0;n<e.exterior.length;++n)t.push(I(e.exterior[n]));for(o.shape.paths.push(new Ba({segmentIgnoreThreshold:1,shape:{points:t}})),n=0;n<(e.interiors?e.interiors.length:0);++n){for(var i=e.interiors[n],r=(t=[],0);r<i.length;++r)t.push(I(i[r]));o.shape.paths.push(new Ba({segmentIgnoreThreshold:1,shape:{points:t}}))}}})),o.setStyle(h),o.style.strokeNoScale=!0,o.culling=!0;var D=x.get("show"),w=E.get("show"),R=a&&isNaN(a.get(a.mapDimension("value"),i)),S=a&&a.getItemLayout(i);if(r||R&&(D||w)||S&&S.showLabel){var k,A=r?t.name:i;(!a||0<=i)&&(k=e);var N=new Sa({position:I(t.center.slice()),scale:[1/c.scale[0],1/c.scale[1]],z2:10,silent:!0});Fs(N.style,N.hoverStyle={},x,E,{labelFetcher:k,labelDataIndex:A,defaultText:t.name,useInsideStyle:!1},{textAlign:"center",textVerticalAlign:"middle"}),f||Xs(N,{scale:[1/l[0],1/l[1]]},e),n.add(N)}if(a)a.setItemGraphicEl(i,n);else{var M=e.getRegionModel(t.name);o.eventData={componentType:"geo",componentIndex:e.componentIndex,geoIndex:e.componentIndex,name:t.name,region:M&&M.option||{}}}(n.__regions||(n.__regions=[])).push(t),n.highDownSilentOnTouch=!!e.get("selectedMode"),Ks(n,T),u.add(n)})),this._updateController(e,t,n),function(e,t,n,o,i){n.off("click"),n.off("mousedown"),t.get("selectedMode")&&(n.on("mousedown",(function(){e._mouseDownFlag=!0})),n.on("click",(function(r){if(e._mouseDownFlag){e._mouseDownFlag=!1;for(var a=r.target;!a.__regions;)a=a.parent;if(a){var s={type:("geo"===t.mainType?"geo":"map")+"ToggleSelect",batch:w(a.__regions,(function(e){return{name:e.name,from:i.uid}}))};s[t.mainType+"Id"]=t.id,o.dispatchAction(s),Dy(t,n)}}})))}(this,e,u,n,o),Dy(e,u)},remove:function(){this._regionsGroup.removeAll(),this._backgroundGroup.removeAll(),this._controller.dispose(),this._mapName&&ay.removeGraphic(this._mapName,this.uid),this._mapName=null,this._controllerHost={}},_updateBackground:function(e){var t=e.map;this._mapName!==t&&O(ay.makeGraphic(t,this.uid),(function(e){this._backgroundGroup.add(e)}),this),this._mapName=t},_updateController:function(e,t,n){var o=e.coordinateSystem,i=this._controller,r=this._controllerHost;r.zoomLimit=e.get("scaleLimit"),r.zoom=o.getZoom(),i.enable(e.get("roam")||!1);var a=e.mainType;function s(){var t={type:"geoRoam",componentType:a};return t[a+"Id"]=e.id,t}i.off("pan").on("pan",(function(e){this._mouseDownFlag=!1,Ty(r,e.dx,e.dy),n.dispatchAction(b(s(),{dx:e.dx,dy:e.dy}))}),this),i.off("zoom").on("zoom",(function(e){if(this._mouseDownFlag=!1,xy(r,e.scale,e.originX,e.originY),n.dispatchAction(b(s(),{zoom:e.scale,originX:e.originX,originY:e.originY})),this._updateGroup){var t=this.group.scale;this._regionsGroup.traverse((function(e){"text"===e.type&&e.attr("scale",[1/t[0],1/t[1]])}))}}),this),i.setPointerChecker((function(t,i,r){return o.getViewRectAfterRoam().contain(i,r)&&!_y(t,n,e)}))}};var wy="__seriesMapHighDown",Ry="__seriesMapCallKey";function Sy(e){var t=this[wy];t&&t.recordVersion===this[Ry]&&ky(t,e)}function ky(e,t){var n=e.circle,o=e.labelModel,i=e.hoverLabelModel,r=e.emphasisText,a=e.normalText;t?(n.style.extendFrom(Vs({},i,{text:i.get("show")?r:null},{isRectText:!0,useInsideStyle:!1},!0)),n.__mapOriginalZ2=n.z2,n.z2+=1):(Vs(n.style,o,{text:o.get("show")?a:null,textPosition:o.getShallow("position")||"bottom"},{isRectText:!0,useInsideStyle:!1}),n.dirty(!1),null!=n.__mapOriginalZ2&&(n.z2=n.__mapOriginalZ2,n.__mapOriginalZ2=null))}function Ay(e,t,n){var o=e.getZoom(),i=e.getCenter(),r=t.zoom,a=e.dataToPoint(i);if(null!=t.dx&&null!=t.dy&&(a[0]-=t.dx,a[1]-=t.dy,i=e.pointToData(a),e.setCenter(i)),null!=r){if(n){var s=n.min||0;r=Math.max(Math.min(o*r,n.max||1/0),s)/o}e.scale[0]*=r,e.scale[1]*=r;var l=e.position,u=(t.originY-l[1])*(r-1);l[0]-=(t.originX-l[0])*(r-1),l[1]-=u,e.updateTransform(),i=e.pointToData(a),e.setCenter(i),e.setZoom(r*o)}return{center:e.getCenter(),zoom:e.getZoom()}}ch({type:"map",render:function(e,t,n,o){if(!o||"mapToggleSelect"!==o.type||o.from!==this.uid){var i=this.group;if(i.removeAll(),!e.getHostGeoModel()){if(o&&"geoRoam"===o.type&&"series"===o.componentType&&o.seriesId===e.id)(r=this._mapDraw)&&i.add(r.group);else if(e.needsDrawMap){var r=this._mapDraw||new Oy(n,!0);i.add(r.group),r.draw(e,t,n,this,o),this._mapDraw=r}else this._mapDraw&&this._mapDraw.remove(),this._mapDraw=null;e.get("showLegendSymbol")&&t.getComponent("legend")&&this._renderSymbols(e,t,n)}}},remove:function(){this._mapDraw&&this._mapDraw.remove(),this._mapDraw=null,this.group.removeAll()},dispose:function(){this._mapDraw&&this._mapDraw.remove(),this._mapDraw=null},_renderSymbols:function(e,t,n){var o=e.originalData,i=this.group;o.each(o.mapDimension("value"),(function(t,n){if(!isNaN(t)){var r=o.getItemLayout(n);if(r&&r.point){var a=r.point,s=r.offset,l=new Aa({style:{fill:e.getData().getVisual("color")},shape:{cx:a[0]+9*s,cy:a[1],r:3},silent:!0,z2:8+(s?0:2)});if(!s){var u=e.mainSeries.getData(),c=o.getName(n),d=u.indexOfName(c),f=o.getItemModel(n),h=f.getModel("label"),g=f.getModel("emphasis.label"),m=u.getItemGraphicEl(d),p=W(e.getFormattedLabel(d,"normal"),c),v=W(e.getFormattedLabel(d,"emphasis"),p),y=m[wy],C=Math.random();if(!y){y=m[wy]={};var T=N(Sy,!0),x=N(Sy,!1);m.on("mouseover",T).on("mouseout",x).on("emphasis",T).on("normal",x)}b(y,{recordVersion:m[Ry]=C,circle:l,labelModel:h,hoverLabelModel:g,emphasisText:v,normalText:p}),ky(y,!1)}i.add(l)}}}))}}),th({type:"geoRoam",event:"geoRoam",update:"updateTransform"},(function(e,t){var n=e.componentType||"series";t.eachComponent({mainType:n,query:e},(function(t){var o=t.coordinateSystem;if("geo"===o.type){var i=Ay(o,e,t.get("scaleLimit"));t.setCenter&&t.setCenter(i.center),t.setZoom&&t.setZoom(i.zoom),"series"===n&&O(t.seriesGroup,(function(e){e.setCenter(i.center),e.setZoom(i.zoom)}))}}))}));var Ny=Ce;function My(){mt.call(this)}function Ky(e){this.name=e,mt.call(this),this._roamTransformable=new My,this._rawTransformable=new My}function Py(e,t,n,o){var i=n.seriesModel,r=i?i.coordinateSystem:null;return r===this?r[e](o):null}function Ly(e,t,n,o){Ky.call(this,e),this.map=t;var i=ay.load(t,n);this._nameCoordMap=i.nameCoordMap,this._regionsMap=i.regionsMap,this._invertLongitute=null==o||o,this.regions=i.regions,this._rect=i.boundingRect}function By(e,t,n,o){var i=n.geoModel,r=n.seriesModel,a=i?i.coordinateSystem:r?r.coordinateSystem||(r.getReferringComponents("geo")[0]||{}).coordinateSystem:null;return a===this?a[e](o):null}function Fy(e,t){var n=e.get("boundingCoords");if(null!=n){var o=n[0],i=n[1];isNaN(o[0])||isNaN(o[1])||isNaN(i[0])||isNaN(i[1])||this.setBoundingRect(o[0],o[1],i[0]-o[0],i[1]-o[1])}var r,a=this.getBoundingRect(),s=e.get("layoutCenter"),l=e.get("layoutSize"),u=t.getWidth(),c=t.getHeight(),d=a.width/a.height*this.aspectScale,f=!1;if(s&&l&&(s=[Cl(s[0],u),Cl(s[1],c)],l=Cl(l,Math.min(u,c)),isNaN(s[0])||isNaN(s[1])||isNaN(l)||(f=!0)),f){var h={};1<d?(h.width=l,h.height=l/d):(h.height=l,h.width=l*d),h.y=s[1]-h.height/2,h.x=s[0]-h.width/2}else(r=e.getBoxLayoutParams()).aspect=d,h=au(r,{width:u,height:c});this.setViewRect(h.x,h.y,h.width,h.height),this.setCenter(e.get("center")),this.setZoom(e.get("zoom"))}function zy(e,t){O(t.get("geoCoord"),(function(t,n){e.addGeoCoord(n,t)}))}I(My,mt),Ky.prototype={constructor:Ky,type:"view",dimensions:["x","y"],setBoundingRect:function(e,t,n,o){return this._rect=new En(e,t,n,o),this._rect},getBoundingRect:function(){return this._rect},setViewRect:function(e,t,n,o){this.transformTo(e,t,n,o),this._viewRect=new En(e,t,n,o)},transformTo:function(e,t,n,o){var i=this.getBoundingRect(),r=this._rawTransformable;r.transform=i.calculateTransform(new En(e,t,n,o)),r.decomposeTransform(),this._updateTransform()},setCenter:function(e){e&&(this._center=e,this._updateCenterAndZoom())},setZoom:function(e){e=e||1;var t=this.zoomLimit;t&&(null!=t.max&&(e=Math.min(t.max,e)),null!=t.min&&(e=Math.max(t.min,e))),this._zoom=e,this._updateCenterAndZoom()},getDefaultCenter:function(){var e=this.getBoundingRect();return[e.x+e.width/2,e.y+e.height/2]},getCenter:function(){return this._center||this.getDefaultCenter()},getZoom:function(){return this._zoom||1},getRoamTransform:function(){return this._roamTransformable.getLocalTransform()},_updateCenterAndZoom:function(){var e=this._rawTransformable.getLocalTransform(),t=this._roamTransformable,n=this.getDefaultCenter(),o=this.getCenter(),i=this.getZoom();o=Ce([],o,e),n=Ce([],n,e),t.origin=o,t.position=[n[0]-o[0],n[1]-o[1]],t.scale=[i,i],this._updateTransform()},_updateTransform:function(){var e=this._rawTransformable;(e.parent=this._roamTransformable).updateTransform(),e.updateTransform(),rt(this.transform||(this.transform=[]),e.transform||ot()),this._rawTransform=e.getLocalTransform(),this.invTransform=this.invTransform||[],ct(this.invTransform,this.transform),this.decomposeTransform()},getTransformInfo:function(){var e=this._roamTransformable.transform,t=this._rawTransformable;return{roamTransform:e?U(e):ot(),rawScale:U(t.scale),rawPosition:U(t.position)}},getViewRect:function(){return this._viewRect},getViewRectAfterRoam:function(){var e=this.getBoundingRect().clone();return e.applyTransform(this.transform),e},dataToPoint:function(e,t,n){var o=t?this._rawTransform:this.transform;return n=n||[],o?Ny(n,e,o):re(n,e)},pointToData:function(e){var t=this.invTransform;return t?Ny([],e,t):[e[0],e[1]]},convertToPixel:N(Py,"dataToPoint"),convertFromPixel:N(Py,"pointToData"),containPoint:function(e){return this.getViewRectAfterRoam().contain(e[0],e[1])}},I(Ky,mt),Ly.prototype={constructor:Ly,type:"geo",dimensions:["lng","lat"],containCoord:function(e){for(var t=this.regions,n=0;n<t.length;n++)if(t[n].contain(e))return!0;return!1},transformTo:function(e,t,n,o){var i=this.getBoundingRect(),r=this._invertLongitute;i=i.clone(),r&&(i.y=-i.y-i.height);var a=this._rawTransformable;if(a.transform=i.calculateTransform(new En(e,t,n,o)),a.decomposeTransform(),r){var s=a.scale;s[1]=-s[1]}a.updateTransform(),this._updateTransform()},getRegion:function(e){return this._regionsMap.get(e)},getRegionByCoord:function(e){for(var t=this.regions,n=0;n<t.length;n++)if(t[n].contain(e))return t[n]},addGeoCoord:function(e,t){this._nameCoordMap.set(e,t)},getGeoCoord:function(e){return this._nameCoordMap.get(e)},getBoundingRect:function(){return this._rect},dataToPoint:function(e,t,n){if("string"==typeof e&&(e=this.getGeoCoord(e)),e)return Ky.prototype.dataToPoint.call(this,e,t,n)},convertToPixel:N(By,"dataToPoint"),convertFromPixel:N(By,"pointToData")},I(Ly,Ky);var Vy={dimensions:Ly.prototype.dimensions,create:function(e,t){var n=[];e.eachComponent("geo",(function(e,o){var i=e.get("map"),r=e.get("aspectScale"),a=!0,s=rf(i);s&&s[0]&&"svg"===s[0].type?(null==r&&(r=1),a=!1):null==r&&(r=.75);var l=new Ly(i+o,i,e.get("nameMap"),a);l.aspectScale=r,l.zoomLimit=e.get("scaleLimit"),n.push(l),zy(l,e),(e.coordinateSystem=l).model=e,l.resize=Fy,l.resize(e,t)})),e.eachSeries((function(e){if("geo"===e.get("coordinateSystem")){var t=e.get("geoIndex")||0;e.coordinateSystem=n[t]}}));var o={};return e.eachSeriesByType("map",(function(e){if(!e.getHostGeoModel()){var t=e.getMapType();o[t]=o[t]||[],o[t].push(e)}})),O(o,(function(e,o){var i=new Ly(o,o,y(w(e,(function(e){return e.get("nameMap")}))));i.zoomLimit=H.apply(null,w(e,(function(e){return e.get("scaleLimit")}))),n.push(i),i.resize=Fy,i.aspectScale=e[0].get("aspectScale"),i.resize(e[0],t),O(e,(function(e){zy(e.coordinateSystem=i,e)}))})),n},getFilledRegions:function(e,t,n){for(var o=(e||[]).slice(),i=Q(),r=0;r<o.length;r++)i.set(o[r].name,o[r]);return O(ay.load(t,n).regions,(function(e){var t=e.name;i.get(t)||o.push({name:t})})),o}};nh("geo",Vy),oh((function(e){var t={};e.eachSeriesByType("map",(function(n){var o=n.getMapType();if(!n.getHostGeoModel()&&!t[o]){var i={};O(n.seriesGroup,(function(t){var n=t.coordinateSystem,o=t.originalData;t.get("showLegendSymbol")&&e.getComponent("legend")&&o.each(o.mapDimension("value"),(function(e,t){var r=o.getName(t),a=n.getRegion(r);if(a&&!isNaN(e)){var s=i[r]||0,l=n.dataToPoint(a.center);i[r]=s+1,o.setItemLayout(t,{point:l,offset:s})}}))}));var r=n.getData();r.each((function(e){var t=r.getName(e),n=r.getItemLayout(e)||{};n.showLabel=!i[t],r.setItemLayout(e,n)})),t[o]=!0}}))})),ih((function(e){e.eachSeriesByType("map",(function(e){var t=e.get("color"),n=e.getModel("itemStyle"),o=n.get("areaColor"),i=n.get("color")||t[e.seriesIndex%t.length];e.getData().setVisual({areaColor:o,color:i})}))})),eh(ff.PROCESSOR.STATISTIC,(function(e){var t={};e.eachSeriesByType("map",(function(e){var n=e.getHostGeoModel(),o=n?"o"+n.id:"i"+e.getMapType();(t[o]=t[o]||[]).push(e)})),O(t,(function(e,t){for(var n=function(e,t){var n={};return O(e,(function(e){e.each(e.mapDimension("value"),(function(t,o){var i="ec-"+e.getName(o);n[i]=n[i]||[],isNaN(t)||n[i].push(t)}))})),e[0].map(e[0].mapDimension("value"),(function(o,i){for(var r="ec-"+e[0].getName(i),a=0,s=1/0,l=-1/0,u=n[r].length,c=0;c<u;c++)s=Math.min(s,n[r][c]),l=Math.max(l,n[r][c]),a+=n[r][c];return 0===u?NaN:"min"===t?s:"max"===t?l:"average"===t?a/u:a}))}(w(e,(function(e){return e.getData()})),e[0].get("mapValueCalculation")),o=0;o<e.length;o++)e[o].originalData=e[o].getData();for(o=0;o<e.length;o++)(e[o].seriesGroup=e)[o].needsDrawMap=0===o&&!e[o].getHostGeoModel(),e[o].setData(n.cloneShallow()),e[o].mainSeries=e[0]}))})),Qf((function(e){var t=[];O(e.series,(function(e){e&&"map"===e.type&&(t.push(e),e.map=e.map||e.mapType,C(e,e.mapLocation))}))})),Rv("map",[{type:"mapToggleSelect",event:"mapselectchanged",method:"toggleSelected"},{type:"mapSelect",event:"mapselected",method:"select"},{type:"mapUnSelect",event:"mapunselected",method:"unSelect"}]);var Hy=O,Wy="\0__link_datas",$y="\0__link_mainData";function Uy(e){var t=e.mainData,n=e.datas;n||(n={main:t},e.datasAttr={main:"data"}),e.datas=e.mainData=null,Yy(t,n,e),Hy(n,(function(n){Hy(t.TRANSFERABLE_METHODS,(function(t){n.wrapMethod(t,N(qy,e))}))})),t.wrapMethod("cloneShallow",N(Gy,e)),Hy(t.CHANGABLE_METHODS,(function(n){t.wrapMethod(n,N(jy,e))})),j(n[t.dataType]===t)}function qy(e,t){if(function(e){return e[$y]===e}(this)){var n=b({},this[Wy]);Yy(n[this.dataType]=t,n,e)}else Zy(t,this.dataType,this[$y],e);return t}function jy(e,t){return e.struct&&e.struct.update(this),t}function Gy(e,t){return Hy(t[Wy],(function(n,o){n!==t&&Zy(n.cloneShallow(),o,t,e)})),t}function Xy(e){var t=this[$y];return null==e||null==t?t:t[Wy][e]}function Yy(e,t,n){e[Wy]={},Hy(t,(function(t,o){Zy(t,o,e,n)}))}function Zy(e,t,n,o){(n[Wy][t]=e)[$y]=n,e.dataType=t,o.struct&&(e[o.structAttr]=o.struct,o.struct[o.datasAttr[t]]=e),e.getLinkedData=Xy}function Jy(e,t){this.name=e||"",this.depth=0,this.height=0,this.parentNode=null,this.dataIndex=-1,this.children=[],this.viewChildren=[],this.hostTree=t}function Qy(e){this._nodes=[],this.hostModel=e}function eb(e,t){var n=e.isExpand?e.children:[],o=e.parentNode.children,i=e.hierNode.i?o[e.hierNode.i-1]:null;if(n.length){!function(e){for(var t=e.children,n=t.length,o=0,i=0;0<=--n;){var r=t[n];r.hierNode.prelim+=o,r.hierNode.modifier+=o,o+=r.hierNode.shift+(i+=r.hierNode.change)}}(e);var r=(n[0].hierNode.prelim+n[n.length-1].hierNode.prelim)/2;i?(e.hierNode.prelim=i.hierNode.prelim+t(e,i),e.hierNode.modifier=e.hierNode.prelim-r):e.hierNode.prelim=r}else i&&(e.hierNode.prelim=i.hierNode.prelim+t(e,i));e.parentNode.hierNode.defaultAncestor=function(e,t,n,o){if(t){for(var i=e,r=e,a=r.parentNode.children[0],s=t,l=i.hierNode.modifier,u=r.hierNode.modifier,c=a.hierNode.modifier,d=s.hierNode.modifier;s=ib(s),r=rb(r),s&&r;){i=ib(i),a=rb(a),i.hierNode.ancestor=e;var f=s.hierNode.prelim+d-r.hierNode.prelim-u+o(s,r);0<f&&(ab((h=s).hierNode.ancestor.parentNode===e.parentNode?h.hierNode.ancestor:n,e,f),u+=f,l+=f),d+=s.hierNode.modifier,u+=r.hierNode.modifier,l+=i.hierNode.modifier,c+=a.hierNode.modifier}s&&!ib(i)&&(i.hierNode.thread=s,i.hierNode.modifier+=d-l),r&&!rb(a)&&(a.hierNode.thread=r,a.hierNode.modifier+=u-c,n=e)}var h;return n}(e,i,e.parentNode.hierNode.defaultAncestor||o[0],t)}function tb(e){e.setLayout({x:e.hierNode.prelim+e.parentNode.hierNode.modifier},!0),e.hierNode.modifier+=e.parentNode.hierNode.modifier}function nb(e){return arguments.length?e:sb}function ob(e,t){var n={};return e-=Math.PI/2,n.x=t*Math.cos(e),n.y=t*Math.sin(e),n}function ib(e){var t=e.children;return t.length&&e.isExpand?t[t.length-1]:e.hierNode.thread}function rb(e){var t=e.children;return t.length&&e.isExpand?t[0]:e.hierNode.thread}function ab(e,t,n){var o=n/(t.hierNode.i-e.hierNode.i);t.hierNode.change-=o,t.hierNode.shift+=n,t.hierNode.modifier+=n,t.hierNode.prelim+=n,e.hierNode.change+=o}function sb(e,t){return e.parentNode===t.parentNode?1:2}Jy.prototype={constructor:Jy,isRemoved:function(){return this.dataIndex<0},eachNode:function(e,t,n){"function"==typeof e&&(n=t,t=e,e=null),P(e=e||{})&&(e={order:e});var o,i=e.order||"preorder",r=this[e.attr||"children"];"preorder"===i&&(o=t.call(n,this));for(var a=0;!o&&a<r.length;a++)r[a].eachNode(e,t,n);"postorder"===i&&t.call(n,this)},updateDepthAndHeight:function(e){var t=0;this.depth=e;for(var n=0;n<this.children.length;n++){var o=this.children[n];o.updateDepthAndHeight(e+1),o.height>t&&(t=o.height)}this.height=t+1},getNodeById:function(e){if(this.getId()===e)return this;for(var t=0,n=this.children,o=n.length;t<o;t++){var i=n[t].getNodeById(e);if(i)return i}},contains:function(e){if(e===this)return!0;for(var t=0,n=this.children,o=n.length;t<o;t++){var i=n[t].contains(e);if(i)return i}},getAncestors:function(e){for(var t=[],n=e?this:this.parentNode;n;)t.push(n),n=n.parentNode;return t.reverse(),t},getValue:function(e){var t=this.hostTree.data;return t.get(t.getDimension(e||"value"),this.dataIndex)},setLayout:function(e,t){0<=this.dataIndex&&this.hostTree.data.setItemLayout(this.dataIndex,e,t)},getLayout:function(){return this.hostTree.data.getItemLayout(this.dataIndex)},getModel:function(e){if(!(this.dataIndex<0))return this.hostTree.data.getItemModel(this.dataIndex).getModel(e)},setVisual:function(e,t){0<=this.dataIndex&&this.hostTree.data.setItemVisual(this.dataIndex,e,t)},getVisual:function(e,t){return this.hostTree.data.getItemVisual(this.dataIndex,e,t)},getRawIndex:function(){return this.hostTree.data.getRawIndex(this.dataIndex)},getId:function(){return this.hostTree.data.getId(this.dataIndex)},isAncestorOf:function(e){for(var t=e.parentNode;t;){if(t===this)return!0;t=t.parentNode}return!1},isDescendantOf:function(e){return e!==this&&e.isAncestorOf(this)}},Qy.prototype={constructor:Qy,type:"tree",eachNode:function(e,t,n){this.root.eachNode(e,t,n)},getNodeByDataIndex:function(e){var t=this.data.getRawIndex(e);return this._nodes[t]},getNodeByName:function(e){return this.root.getNodeByName(e)},update:function(){for(var e=this.data,t=this._nodes,n=0,o=t.length;n<o;n++)t[n].dataIndex=-1;for(n=0,o=e.count();n<o;n++)t[e.getRawIndex(n)].dataIndex=n},clearLayouts:function(){this.data.clearItemLayouts()}},Qy.createTree=function(e,t,n){var o=new Qy(t),i=[],r=1;!function e(t,n){var a=t.value;r=Math.max(r,M(a)?a.length:1),i.push(t);var s=new Jy(t.name,o);n?function(e,t){e.parentNode!==t&&(t.children.push(e),e.parentNode=t)}(s,n):o.root=s,o._nodes.push(s);var l=t.children;if(l)for(var u=0;u<l.length;u++)e(l[u],s)}(e),o.root.updateDepthAndHeight(0);var a=Hh(i,{coordDimensions:["value"],dimensionsCount:r}),s=new wh(a,t);return s.initData(i),n&&n(s),Uy({mainData:s,struct:o,structAttr:"tree"}),o.update(),o},Wc.extend({type:"series.tree",layoutInfo:null,layoutMode:"box",getInitialData:function(e){var t={name:e.name,children:e.data},n=new hl(e.leaves||{},this,this.ecModel),o=Qy.createTree(t,this,(function(e){e.wrapMethod("getItemModel",(function(e,t){var i=o.getNodeByDataIndex(t);return i.children.length&&i.isExpand||(e.parentModel=n),e}))})),i=0;o.eachNode("preorder",(function(e){e.depth>i&&(i=e.depth)}));var r=e.expandAndCollapse&&0<=e.initialTreeDepth?e.initialTreeDepth:i;return o.root.eachNode("preorder",(function(e){var t=e.hostTree.data.getRawDataItem(e.dataIndex);e.isExpand=t&&null!=t.collapsed?!t.collapsed:e.depth<=r})),o.data},getOrient:function(){var e=this.get("orient");return"horizontal"===e?e="LR":"vertical"===e&&(e="TB"),e},setZoom:function(e){this.option.zoom=e},setCenter:function(e){this.option.center=e},formatTooltip:function(e){for(var t=this.getData().tree,n=t.root.children[0],o=t.getNodeByDataIndex(e),i=o.getValue(),r=o.name;o&&o!==n;)r=o.parentNode.name+"."+r,o=o.parentNode;return Wl(r+(isNaN(i)||null==i?"":" : "+i))},defaultOption:{zlevel:0,z:2,coordinateSystem:"view",left:"12%",top:"12%",right:"12%",bottom:"12%",layout:"orthogonal",edgeShape:"curve",edgeForkPosition:"50%",roam:!1,nodeScaleRatio:.4,center:null,zoom:1,orient:"LR",symbol:"emptyCircle",symbolSize:7,expandAndCollapse:!0,initialTreeDepth:2,lineStyle:{color:"#ccc",width:1.5,curveness:.5},itemStyle:{color:"lightsteelblue",borderColor:"#c23531",borderWidth:1.5},label:{show:!0,color:"#555"},leaves:{label:{show:!0}},animationEasing:"linear",animationDuration:700,animationDurationUpdate:1e3}});var lb=hs({shape:{parentPoint:[],childPoints:[],orient:"",forkPosition:""},style:{stroke:"#000",fill:null},buildPath:function(e,t){var n=t.childPoints,o=n.length,i=t.parentPoint,r=n[0],a=n[o-1];if(1===o)return e.moveTo(i[0],i[1]),void e.lineTo(r[0],r[1]);var s=t.orient,l="TB"===s||"BT"===s?0:1,u=1-l,c=Cl(t.forkPosition,1),d=[];d[l]=i[l],d[u]=i[u]+(a[u]-i[u])*c,e.moveTo(i[0],i[1]),e.lineTo(d[0],d[1]),e.moveTo(r[0],r[1]),d[l]=r[l],e.lineTo(d[0],d[1]),d[l]=a[l],e.lineTo(d[0],d[1]),e.lineTo(a[0],a[1]);for(var f=1;f<o-1;f++){var h=n[f];e.moveTo(h[0],h[1]),d[l]=h[l],e.lineTo(d[0],d[1])}}});function ub(e,t){var n=e.getItemLayout(t);return n&&!isNaN(n.x)&&!isNaN(n.y)&&"none"!==e.getItemVisual(t,"symbol")}function cb(e,t,n){return n.itemModel=t,n.itemStyle=t.getModel("itemStyle").getItemStyle(),n.hoverItemStyle=t.getModel("emphasis.itemStyle").getItemStyle(),n.lineStyle=t.getModel("lineStyle").getLineStyle(),n.labelModel=t.getModel("label"),n.hoverLabelModel=t.getModel("emphasis.label"),n.symbolInnerColor=!1===e.isExpand&&0!==e.children.length?n.itemStyle.fill:"#fff",n}function db(e,t,n,o,i,r){var a=!n,s=e.tree.getNodeByDataIndex(t),l=s.getModel(),u=(r=cb(s,l,r),e.tree.root),c=s.parentNode===u?s:s.parentNode||s,d=e.getItemGraphicEl(c.dataIndex),f=c.getLayout(),h=d?{x:d.position[0],y:d.position[1],rawX:d.__radialOldRawX,rawY:d.__radialOldRawY}:f,g=s.getLayout();a?(n=new xm(e,t,r)).attr("position",[h.x,h.y]):n.updateData(e,t,r),n.__radialOldRawX=n.__radialRawX,n.__radialOldRawY=n.__radialRawY,n.__radialRawX=g.rawX,n.__radialRawY=g.rawY,o.add(n),e.setItemGraphicEl(t,n),Xs(n,{position:[g.x,g.y]},i);var m=n.getSymbolPath();if("radial"===r.layout){var p,v,y=u.children[0],b=y.getLayout(),T=y.children.length;if(g.x===b.x&&!0===s.isExpand){var x={};x.x=(y.children[0].getLayout().x+y.children[T-1].getLayout().x)/2,x.y=(y.children[0].getLayout().y+y.children[T-1].getLayout().y)/2,(p=Math.atan2(x.y-b.y,x.x-b.x))<0&&(p=2*Math.PI+p),(v=x.x<b.x)&&(p-=Math.PI)}else(p=Math.atan2(g.y-b.y,g.x-b.x))<0&&(p=2*Math.PI+p),0===s.children.length||0!==s.children.length&&!1===s.isExpand?(v=g.x<b.x)&&(p-=Math.PI):(v=g.x>b.x)||(p-=Math.PI);var E=v?"left":"right",_=r.labelModel.get("rotate"),I=_*(Math.PI/180);m.setStyle({textPosition:r.labelModel.get("position")||E,textRotation:null==_?-p:I,textOrigin:"center",verticalAlign:"middle"})}!function(e,t,n,o,i,r,a,s,l){var u=l.edgeShape,c=o.__edge;if("curve"===u)t.parentNode&&t.parentNode!==n&&Xs(c=c||(o.__edge=new Za({shape:hb(l,i,i),style:C({opacity:0,strokeNoScale:!0},l.lineStyle)})),{shape:hb(l,r,a),style:C({opacity:1},l.lineStyle)},e);else if("polyline"===u&&"orthogonal"===l.layout&&t!==n&&t.children&&0!==t.children.length&&!0===t.isExpand){for(var d=t.children,f=[],h=0;h<d.length;h++){var g=d[h].getLayout();f.push([g.x,g.y])}Xs(c=c||(o.__edge=new lb({shape:{parentPoint:[a.x,a.y],childPoints:[[a.x,a.y]],orient:l.orient,forkPosition:l.edgeForkPosition},style:C({opacity:0,strokeNoScale:!0},l.lineStyle)})),{shape:{parentPoint:[a.x,a.y],childPoints:f},style:C({opacity:1},l.lineStyle)},e)}s.add(c)}(i,s,u,n,h,f,g,o,r)}function fb(e,t,n,o,i,r){for(var a,s,l=e.tree.getNodeByDataIndex(t),u=e.tree.root,c=l.getModel(),d=(r=cb(l,c,r),l.parentNode===u?l:l.parentNode||l);null==(a=d.getLayout());)d=d.parentNode===u?d:d.parentNode||d;Xs(n,{position:[a.x+1,a.y+1]},i,(function(){o.remove(n),e.setItemGraphicEl(t,null)})),n.fadeOut(null,{keepLabel:!0});var f=e.getItemGraphicEl(d.dataIndex).__edge,h=n.__edge||(!1===d.isExpand||1===d.children.length?f:void 0);s=r.edgeShape,h&&("curve"===s?Xs(h,{shape:hb(r,a,a),style:{opacity:0}},i,(function(){o.remove(h)})):"polyline"===s&&"orthogonal"===r.layout&&Xs(h,{shape:{parentPoint:[a.x,a.y],childPoints:[[a.x,a.y]]},style:{opacity:0}},i,(function(){o.remove(h)})))}function hb(e,t,n){var o,i,r,a,s,l,u,c,d=e.orient;if("radial"!==e.layout)return s=t.x,u=t.y,l=n.x,c=n.y,"LR"!==d&&"RL"!==d||(o=s+(l-s)*e.curvature,i=u,r=l+(s-l)*e.curvature,a=c),"TB"!==d&&"BT"!==d||(o=s,i=u+(c-u)*e.curvature,r=l,a=c+(u-c)*e.curvature),{x1:s,y1:u,x2:l,y2:c,cpx1:o,cpy1:i,cpx2:r,cpy2:a};l=n.rawX,c=n.rawY;var f=ob(s=t.rawX,u=t.rawY),h=ob(s,u+(c-u)*e.curvature),g=ob(l,c+(u-c)*e.curvature),m=ob(l,c);return{x1:f.x,y1:f.y,x2:m.x,y2:m.y,cpx1:h.x,cpy1:h.y,cpx2:g.x,cpy2:g.y}}function gb(e,t){for(var n,o=[e];n=o.pop();)if(t(n),n.isExpand){var i=n.children;if(i.length)for(var r=i.length-1;0<=r;r--)o.push(i[r])}}function mb(e,t,n){if(e&&0<=E(t,e.type)){var o=n.getData().tree.root,i=e.targetNode;if("string"==typeof i&&(i=o.getNodeById(i)),i&&o.contains(i))return{node:i};var r=e.targetNodeId;if(null!=r&&(i=o.getNodeById(r)))return{node:i}}}function pb(e){for(var t=[];e;)(e=e.parentNode)&&t.push(e);return t.reverse()}function vb(e,t){return 0<=E(pb(e),t)}function yb(e,t){for(var n=[];e;){var o=e.dataIndex;n.push({name:e.name,dataIndex:o,value:t.getRawValue(o)}),e=e.parentNode}return n.reverse(),n}function bb(e){this.group=new _n,e.add(this.group)}function Cb(e,t,n,o,i,r){var a=[[i?e:e-5,t],[e+n,t],[e+n,t+o],[i?e:e-5,t+o]];return r||a.splice(2,0,[e+n+5,t+o/2]),i||a.push([e,t+o/2]),a}function Tb(e){var t=Sb(e);return t.stroke=t.fill=t.lineWidth=null,t}ch({type:"tree",init:function(e,t){this._mainGroup=new _n,this._controller=new fy(t.getZr()),this._controllerHost={target:this.group},this.group.add(this._mainGroup)},render:function(e,t,n,o){var i=e.getData(),r=e.layoutInfo,a=this._mainGroup,s=e.get("layout");a.attr("position","radial"===s?[r.x+r.width/2,r.y+r.height/2]:[r.x,r.y]),this._updateViewCoordSys(e,r,s),this._updateController(e,t,n);var l=this._data,u={expandAndCollapse:e.get("expandAndCollapse"),layout:s,edgeShape:e.get("edgeShape"),edgeForkPosition:e.get("edgeForkPosition"),orient:e.getOrient(),curvature:e.get("lineStyle.curveness"),symbolRotate:e.get("symbolRotate"),symbolOffset:e.get("symbolOffset"),hoverAnimation:e.get("hoverAnimation"),useNameLabel:!0,fadeIn:!0};i.diff(l).add((function(t){ub(i,t)&&db(i,t,null,a,e,u)})).update((function(t,n){var o=l.getItemGraphicEl(n);ub(i,t)?db(i,t,o,a,e,u):o&&fb(l,n,o,a,e,u)})).remove((function(t){var n=l.getItemGraphicEl(t);n&&fb(l,t,n,a,e,u)})).execute(),this._nodeScaleRatio=e.get("nodeScaleRatio"),this._updateNodeAndLinkScale(e),!0===u.expandAndCollapse&&i.eachItemGraphicEl((function(t,o){t.off("click").on("click",(function(){n.dispatchAction({type:"treeExpandAndCollapse",seriesId:e.id,dataIndex:o})}))})),this._data=i},_updateViewCoordSys:function(e){var t=e.getData(),n=[];t.each((function(e){var o=t.getItemLayout(e);!o||isNaN(o.x)||isNaN(o.y)||n.push([+o.x,+o.y])}));var o=[],i=[];Rr(n,o,i);var r=this._min,a=this._max;i[0]-o[0]==0&&(o[0]=r?r[0]:o[0]-1,i[0]=a?a[0]:i[0]+1),i[1]-o[1]==0&&(o[1]=r?r[1]:o[1]-1,i[1]=a?a[1]:i[1]+1);var s=e.coordinateSystem=new Ky;s.zoomLimit=e.get("scaleLimit"),s.setBoundingRect(o[0],o[1],i[0]-o[0],i[1]-o[1]),s.setCenter(e.get("center")),s.setZoom(e.get("zoom")),this.group.attr({position:s.position,scale:s.scale}),this._viewCoordSys=s,this._min=o,this._max=i},_updateController:function(e,t,n){var o=this._controller,i=this._controllerHost,r=this.group;o.setPointerChecker((function(t,o,i){var a=r.getBoundingRect();return a.applyTransform(r.transform),a.contain(o,i)&&!_y(t,n,e)})),o.enable(e.get("roam")),i.zoomLimit=e.get("scaleLimit"),i.zoom=e.coordinateSystem.getZoom(),o.off("pan").off("zoom").on("pan",(function(t){Ty(i,t.dx,t.dy),n.dispatchAction({seriesId:e.id,type:"treeRoam",dx:t.dx,dy:t.dy})}),this).on("zoom",(function(t){xy(i,t.scale,t.originX,t.originY),n.dispatchAction({seriesId:e.id,type:"treeRoam",zoom:t.scale,originX:t.originX,originY:t.originY}),this._updateNodeAndLinkScale(e)}),this)},_updateNodeAndLinkScale:function(e){var t=e.getData(),n=this._getNodeGlobalScale(e),o=[n,n];t.eachItemGraphicEl((function(e,t){e.attr("scale",o)}))},_getNodeGlobalScale:function(e){var t=e.coordinateSystem;if("view"!==t.type)return 1;var n=this._nodeScaleRatio,o=t.scale,i=o&&o[0]||1;return((t.getZoom()-1)*n+1)/i},dispose:function(){this._controller&&this._controller.dispose(),this._controllerHost={}},remove:function(){this._mainGroup.removeAll(),this._data=null}}),th({type:"treeExpandAndCollapse",event:"treeExpandAndCollapse",update:"update"},(function(e,t){t.eachComponent({mainType:"series",subType:"tree",query:e},(function(t){var n=e.dataIndex,o=t.getData().tree.getNodeByDataIndex(n);o.isExpand=!o.isExpand}))})),th({type:"treeRoam",event:"treeRoam",update:"none"},(function(e,t){t.eachComponent({mainType:"series",subType:"tree",query:e},(function(t){var n=Ay(t.coordinateSystem,e);t.setCenter&&t.setCenter(n.center),t.setZoom&&t.setZoom(n.zoom)}))})),ih(rp("tree","circle")),oh((function(e,t){e.eachSeriesByType("tree",(function(e){!function(e,t){var n=function(e,t){return au(e.getBoxLayoutParams(),{width:t.getWidth(),height:t.getHeight()})}(e,t);e.layoutInfo=n;var o=e.get("layout"),i=0,r=0,a=null;a="radial"===o?(i=2*Math.PI,r=Math.min(n.height,n.width)/2,nb((function(e,t){return(e.parentNode===t.parentNode?1:2)/e.depth}))):(i=n.width,r=n.height,nb());var s=e.getData().tree.root,l=s.children[0];if(l){!function(e){e.hierNode={defaultAncestor:null,ancestor:e,prelim:0,modifier:0,change:0,shift:0,i:0,thread:null};for(var t,n,o=[e];t=o.pop();)if(n=t.children,t.isExpand&&n.length)for(var i=n.length-1;0<=i;i--){var r=n[i];r.hierNode={defaultAncestor:null,ancestor:r,prelim:0,modifier:0,change:0,shift:0,i:i,thread:null},o.push(r)}}(s),function(e,t,n){for(var o,i=[e],r=[];o=i.pop();)if(r.push(o),o.isExpand){var a=o.children;if(a.length)for(var s=0;s<a.length;s++)i.push(a[s])}for(;o=r.pop();)t(o,n)}(l,eb,a),s.hierNode.modifier=-l.hierNode.prelim,gb(l,tb);var u=l,c=l,d=l;gb(l,(function(e){var t=e.getLayout().x;t<u.getLayout().x&&(u=e),t>c.getLayout().x&&(c=e),e.depth>d.depth&&(d=e)}));var f=u===c?1:a(u,c)/2,h=f-u.getLayout().x,g=0,m=0,p=0,v=0;if("radial"===o)g=i/(c.getLayout().x+f+h),m=r/(d.depth-1||1),gb(l,(function(e){var t=ob(p=(e.getLayout().x+h)*g,v=(e.depth-1)*m);e.setLayout({x:t.x,y:t.y,rawX:p,rawY:v},!0)}));else{var y=e.getOrient();"RL"===y||"LR"===y?(m=r/(c.getLayout().x+f+h),g=i/(d.depth-1||1),gb(l,(function(e){v=(e.getLayout().x+h)*m,e.setLayout({x:p="LR"===y?(e.depth-1)*g:i-(e.depth-1)*g,y:v},!0)}))):"TB"!==y&&"BT"!==y||(g=i/(c.getLayout().x+f+h),m=r/(d.depth-1||1),gb(l,(function(e){p=(e.getLayout().x+h)*g,e.setLayout({x:p,y:v="TB"===y?(e.depth-1)*m:r-(e.depth-1)*m},!0)})))}}}(e,t)}))})),Wc.extend({type:"series.treemap",layoutMode:"box",dependencies:["grid","polar"],preventUsingHoverLayer:!0,_viewRoot:null,defaultOption:{progressive:0,left:"center",top:"middle",right:null,bottom:null,width:"80%",height:"80%",sort:!0,clipWindow:"origin",squareRatio:.5*(1+Math.sqrt(5)),leafDepth:null,drillDownIcon:"▶",zoomToNodeRatio:.1024,roam:!0,nodeClick:"zoomToNode",animation:!0,animationDurationUpdate:900,animationEasing:"quinticInOut",breadcrumb:{show:!0,height:22,left:"center",top:"bottom",emptyItemWidth:25,itemStyle:{color:"rgba(0,0,0,0.7)",borderColor:"rgba(255,255,255,0.7)",borderWidth:1,shadowColor:"rgba(150,150,150,1)",shadowBlur:3,shadowOffsetX:0,shadowOffsetY:0,textStyle:{color:"#fff"}},emphasis:{textStyle:{}}},label:{show:!0,distance:0,padding:5,position:"inside",color:"#fff",ellipsis:!0},upperLabel:{show:!1,position:[0,"50%"],height:20,color:"#fff",ellipsis:!0,verticalAlign:"middle"},itemStyle:{color:null,colorAlpha:null,colorSaturation:null,borderWidth:0,gapWidth:0,borderColor:"#fff",borderColorSaturation:null},emphasis:{upperLabel:{show:!0,position:[0,"50%"],color:"#fff",ellipsis:!0,verticalAlign:"middle"}},visualDimension:0,visualMin:null,visualMax:null,color:[],colorAlpha:null,colorSaturation:null,colorMappingBy:"index",visibleMin:10,childrenVisibleMin:null,levels:[]},getInitialData:function(e,t){var n={name:e.name,children:e.data};!function e(t){var n=0;O(t.children,(function(t){e(t);var o=t.value;M(o)&&(o=o[0]),n+=o}));var o=t.value;M(o)&&(o=o[0]),null!=o&&!isNaN(o)||(o=n),o<0&&(o=0),M(t.value)?t.value[0]=o:t.value=o}(n);var o=e.levels||[],i=new hl({itemStyle:this.designatedVisualItemStyle={}},this,t),r=w((o=e.levels=function(e,t){var n,o=t.get("color");if(o)return O(e=e||[],(function(e){var t=new hl(e),o=t.get("color");(t.get("itemStyle.color")||o&&"none"!==o)&&(n=!0)})),n||((e[0]||(e[0]={})).color=o.slice()),e}(o,t))||[],(function(e){return new hl(e,i,t)}),this),a=Qy.createTree(n,this,(function(e){e.wrapMethod("getItemModel",(function(e,t){var n=a.getNodeByDataIndex(t);return e.parentModel=r[n.depth]||i,e}))}));return a.data},optionUpdated:function(){this.resetViewRoot()},formatTooltip:function(e){var t=this.getData(),n=this.getRawValue(e),o=M(n)?Bl(n[0]):Bl(n);return Wl(t.getName(e)+": "+o)},getDataParams:function(e){var t=Wc.prototype.getDataParams.apply(this,arguments),n=this.getData().tree.getNodeByDataIndex(e);return t.treePathInfo=yb(n,this),t},setLayoutInfo:function(e){this.layoutInfo=this.layoutInfo||{},b(this.layoutInfo,e)},mapIdToIndex:function(e){var t=this._idIndexMap;t||(t=this._idIndexMap=Q(),this._idIndexMapCount=0);var n=t.get(e);return null==n&&t.set(e,n=this._idIndexMapCount++),n},getViewRoot:function(){return this._viewRoot},resetViewRoot:function(e){e?this._viewRoot=e:e=this._viewRoot;var t=this.getRawData().tree.root;e&&(e===t||t.contains(e))||(this._viewRoot=t)}}),bb.prototype={constructor:bb,render:function(e,t,n,o){var i=e.getModel("breadcrumb"),r=this.group;if(r.removeAll(),i.get("show")&&n){var a=i.getModel("itemStyle"),s=a.getModel("textStyle"),l={pos:{left:i.get("left"),right:i.get("right"),top:i.get("top"),bottom:i.get("bottom")},box:{width:t.getWidth(),height:t.getHeight()},emptyItemWidth:i.get("emptyItemWidth"),totalWidth:0,renderList:[]};this._prepare(n,l,s),this._renderContent(e,l,a,s,o),su(r,l.pos,l.box)}},_prepare:function(e,t,n){for(var o=e;o;o=o.parentNode){var i=o.getModel().get("name"),r=n.getTextRect(i),a=Math.max(r.width+16,t.emptyItemWidth);t.totalWidth+=a+8,t.renderList.push({node:o,text:i,width:a})}},_renderContent:function(e,t,n,o,i){for(var r,a,s=0,l=t.emptyItemWidth,u=e.get("breadcrumb.height"),c=function(e,t,n){var o=t.width,i=t.height,r=Cl(e.x,o),a=Cl(e.y,i),s=Cl(e.x2,o),l=Cl(e.y2,i);return(isNaN(r)||isNaN(parseFloat(e.x)))&&(r=0),(isNaN(s)||isNaN(parseFloat(e.x2)))&&(s=o),(isNaN(a)||isNaN(parseFloat(e.y)))&&(a=0),(isNaN(l)||isNaN(parseFloat(e.y2)))&&(l=i),n=zl(n||0),{width:Math.max(s-r-n[1]-n[3],0),height:Math.max(l-a-n[0]-n[2],0)}}(t.pos,t.box),d=t.totalWidth,f=t.renderList,h=f.length-1;0<=h;h--){var g=f[h],m=g.node,p=g.width,v=g.text;d>c.width&&(d-=p-l,p=l,v=null);var y=new Ba({shape:{points:Cb(s,0,p,u,h===f.length-1,0===h)},style:C(n.getItemStyle(),{lineJoin:"bevel",text:v,textFill:o.getTextColor(),textFont:o.getFont()}),z:10,onclick:N(i,m)});this.group.add(y),y.eventData={componentType:"series",componentSubType:"treemap",componentIndex:(r=e).componentIndex,seriesIndex:r.componentIndex,seriesName:r.name,seriesType:"treemap",selfType:"breadcrumb",nodeData:{dataIndex:(a=m)&&a.dataIndex,name:a&&a.name},treePathInfo:a&&yb(a,r)},s+=p+8}},remove:function(){this.group.removeAll()}};var xb=A,Eb=_n,_b=Ua,Ib=O,Db=["label"],Ob=["emphasis","label"],wb=["upperLabel"],Rb=["emphasis","upperLabel"],Sb=Zi([["fill","color"],["stroke","strokeColor"],["lineWidth","strokeWidth"],["shadowBlur"],["shadowOffsetX"],["shadowOffsetY"],["shadowColor"]]);function kb(e,t,n,o,i,r,a,s,l,u){if(a){var c=a.getLayout(),d=e.getData();if(d.setItemGraphicEl(a.dataIndex,null),c&&c.isInView){var f=c.width,h=c.height,g=c.borderWidth,m=c.invisible,v=a.getRawIndex(),y=s&&s.getRawIndex(),C=a.viewChildren,T=c.upperHeight,x=C&&C.length,E=a.getModel("itemStyle"),_=a.getModel("emphasis.itemStyle"),I=A("nodeGroup",Eb);if(I){if(l.add(I),I.attr("position",[c.x||0,c.y||0]),I.__tmNodeWidth=f,I.__tmNodeHeight=h,c.isAboveViewRoot)return I;var D=a.getModel(),O=A("background",_b,u,1);if(O&&function(t,n,o){if(n.dataIndex=a.dataIndex,n.seriesIndex=e.seriesIndex,n.setShape({x:0,y:0,width:f,height:h}),m)R(n);else{n.invisible=!1;var i=a.getVisual("borderColor",!0),r=_.get("borderColor"),s=Tb(E);s.fill=i;var l=Sb(_);if(l.fill=r,o){var u=f-2*g;S(s,l,i,u,T,{x:g,y:0,width:u,height:T})}else s.text=l.text=null;n.setStyle(s),Rs(n,l)}t.add(n)}(I,O,x&&c.upperLabelHeight),x)Ls(I)&&Ps(I,!1),O&&(Ps(O,!0),d.setItemGraphicEl(a.dataIndex,O));else{var w=A("content",_b,u,2);w&&function(t,n){n.dataIndex=a.dataIndex,n.seriesIndex=e.seriesIndex;var o=Math.max(f-2*g,0),i=Math.max(h-2*g,0);if(n.culling=!0,n.setShape({x:g,y:g,width:o,height:i}),m)R(n);else{n.invisible=!1;var r=a.getVisual("color",!0),s=Tb(E);s.fill=r;var l=Sb(_);S(s,l,r,o,i),n.setStyle(s),Rs(n,l)}t.add(n)}(I,w),O&&Ls(O)&&Ps(O,!1),Ps(I,!0),d.setItemGraphicEl(a.dataIndex,I)}return I}}}function R(e){e.invisible||r.push(e)}function S(t,n,o,i,r,s){var l=D.get("name"),u=D.getModel(s?wb:Db),d=D.getModel(s?Rb:Ob),f=u.getShallow("show");Fs(t,n,u,d,{defaultText:f?l:null,autoColor:o,isRectText:!0,labelFetcher:e,labelDataIndex:a.dataIndex,labelProp:s?"upperLabel":"label"}),k(t,s,c),k(n,s,c),s&&(t.textRect=p(s)),t.truncate=f&&u.get("ellipsis")?{outerWidth:i,outerHeight:r,minChar:2}:null}function k(t,n,o){var i=t.text;if(!n&&o.isLeafRoot&&null!=i){var r=e.get("drillDownIcon",!0);t.text=r?r+" "+i:i}}function A(e,r,s,l){var u=null!=y&&n[e][y],c=i[e];return u?(n[e][y]=null,function(e,t,n){(e[v]={}).old="nodeGroup"===n?t.position.slice():b({},t.shape)}(c,u,e)):m||((u=new r({z:function(e,t){var n=10*e+t;return(n-1)/n}(s,l)})).__tmDepth=s,function(e,t,n){var r=e[v]={},s=a.parentNode;if(s&&(!o||"drillDown"===o.direction)){var l=0,u=0,c=i.background[s.getRawIndex()];!o&&c&&c.old&&(l=c.old.width,u=c.old.height),r.old="nodeGroup"===n?[0,u]:{x:l,y:u,width:0,height:0}}r.fadein="nodeGroup"!==n}(c,0,u.__tmStorageName=e)),t[e][v]=u}}ch({type:"treemap",init:function(e,t){this._storage={nodeGroup:[],background:[],content:[]},this._state="ready"},render:function(e,t,n,o){if(!(E(t.findComponents({mainType:"series",subType:"treemap",query:o}),e)<0)){this.seriesModel=e,this.api=n,this.ecModel=t;var i=mb(o,["treemapZoomToNode","treemapRootToNode"],e),r=o&&o.type,a=e.layoutInfo,s=!this._oldTree,l=this._storage,u="treemapRootToNode"===r&&i&&l?{rootNodeGroup:l.nodeGroup[i.node.getRawIndex()],direction:o.direction}:null,c=this._giveContainerGroup(a),d=this._doRender(c,e,u);s||r&&"treemapZoomToNode"!==r&&"treemapRootToNode"!==r?d.renderFinally():this._doAnimation(c,d,e,u),this._resetController(n),this._renderBreadcrumb(e,n,i)}},_giveContainerGroup:function(e){var t=this._containerGroup;return t||(t=this._containerGroup=new Eb,this._initEvents(t),this.group.add(t)),t.attr("position",[e.x,e.y]),t},_doRender:function(e,t,n){var o=t.getData().tree,i=this._oldTree,r={nodeGroup:[],background:[],content:[]},a={nodeGroup:[],background:[],content:[]},s=this._storage,l=[],u=N(kb,t,a,s,n,r,l);!function e(t,n,o,i,r){function a(e){return e.getId()}function s(a,s){var l=null!=a?t[a]:null,c=null!=s?n[s]:null,d=u(l,c,o,r);d&&e(l&&l.viewChildren||[],c&&c.viewChildren||[],d,i,r+1)}i?Ib(n=t,(function(e,t){e.isRemoved()||s(t,t)})):new fh(n,t,a,a).add(s).update(s).remove(N(s,null)).execute()}(o.root?[o.root]:[],i&&i.root?[i.root]:[],e,o===i||!i,0);var c,d,f=(d={nodeGroup:[],background:[],content:[]},(c=s)&&Ib(c,(function(e,t){var n=d[t];Ib(e,(function(e){e&&(n.push(e),e.__tmWillDelete=1)}))})),d);return this._oldTree=o,this._storage=a,{lastsForAnimation:r,willDeleteEls:f,renderFinally:function(){Ib(f,(function(e){Ib(e,(function(e){e.parent&&e.parent.remove(e)}))})),Ib(l,(function(e){e.invisible=!0,e.dirty()}))}}},_doAnimation:function(e,t,n,o){if(n.get("animation")){var i=n.get("animationDurationUpdate"),r=n.get("animationEasing"),a=function(){var e,t=[],n={};return{add:function(e,o,i,r,a){return P(r)&&(a=r,r=0),!n[e.id]&&(n[e.id]=1,t.push({el:e,target:o,time:i,delay:r,easing:a}),!0)},done:function(t){return e=t,this},start:function(){for(var o=t.length,i=0,r=t.length;i<r;i++){var a=t[i];a.el.animateTo(a.target,a.time,a.delay,a.easing,s)}return this;function s(){--o||(t.length=0,n={},e&&e())}}}}();Ib(t.willDeleteEls,(function(e,t){Ib(e,(function(e,n){if(!e.invisible){var s,l=e.parent;if(o&&"drillDown"===o.direction)s=l===o.rootNodeGroup?{shape:{x:0,y:0,width:l.__tmNodeWidth,height:l.__tmNodeHeight},style:{opacity:0}}:{style:{opacity:0}};else{var u=0,c=0;l.__tmWillDelete||(u=l.__tmNodeWidth/2,c=l.__tmNodeHeight/2),s="nodeGroup"===t?{position:[u,c],style:{opacity:0}}:{shape:{x:u,y:c,width:0,height:0},style:{opacity:0}}}s&&a.add(e,s,i,r)}}))})),Ib(this._storage,(function(e,n){Ib(e,(function(e,o){var s=t.lastsForAnimation[n][o],l={};s&&("nodeGroup"===n?s.old&&(l.position=e.position.slice(),e.attr("position",s.old)):(s.old&&(l.shape=b({},e.shape),e.setShape(s.old)),s.fadein?(e.setStyle("opacity",0),l.style={opacity:1}):1!==e.style.opacity&&(l.style={opacity:1})),a.add(e,l,i,r))}))}),this),this._state="animating",a.done(xb((function(){this._state="ready",t.renderFinally()}),this)).start()}},_resetController:function(e){var t=this._controller;t||((t=this._controller=new fy(e.getZr())).enable(this.seriesModel.get("roam")),t.on("pan",xb(this._onPan,this)),t.on("zoom",xb(this._onZoom,this)));var n=new En(0,0,e.getWidth(),e.getHeight());t.setPointerChecker((function(e,t,o){return n.contain(t,o)}))},_clearController:function(){var e=this._controller;e&&(e.dispose(),e=null)},_onPan:function(e){if("animating"!==this._state&&(3<Math.abs(e.dx)||3<Math.abs(e.dy))){var t=this.seriesModel.getData().tree.root;if(!t)return;var n=t.getLayout();if(!n)return;this.api.dispatchAction({type:"treemapMove",from:this.uid,seriesId:this.seriesModel.id,rootRect:{x:n.x+e.dx,y:n.y+e.dy,width:n.width,height:n.height}})}},_onZoom:function(e){var t=e.originX,n=e.originY;if("animating"!==this._state){var o=this.seriesModel.getData().tree.root;if(!o)return;var i=o.getLayout();if(!i)return;var r=new En(i.x,i.y,i.width,i.height),a=this.seriesModel.layoutInfo;t-=a.x,n-=a.y;var s=ot();st(s,s,[-t,-n]),ut(s,s,[e.scale,e.scale]),st(s,s,[t,n]),r.applyTransform(s),this.api.dispatchAction({type:"treemapRender",from:this.uid,seriesId:this.seriesModel.id,rootRect:{x:r.x,y:r.y,width:r.width,height:r.height}})}},_initEvents:function(e){e.on("click",(function(e){if("ready"===this._state){var t=this.seriesModel.get("nodeClick",!0);if(t){var n=this.findTarget(e.offsetX,e.offsetY);if(n){var o=n.node;if(o.getLayout().isLeafRoot)this._rootToNode(n);else if("zoomToNode"===t)this._zoomToNode(n);else if("link"===t){var i=o.hostTree.data.getItemModel(o.dataIndex),r=i.get("link",!0),a=i.get("target",!0)||"blank";r&&Ql(r,a)}}}}}),this)},_renderBreadcrumb:function(e,t,n){n=n||(n=null!=e.get("leafDepth",!0)?{node:e.getViewRoot()}:this.findTarget(t.getWidth()/2,t.getHeight()/2))||{node:e.getData().tree.root},(this._breadcrumb||(this._breadcrumb=new bb(this.group))).render(e,t,n.node,xb((function(t){"animating"!==this._state&&(vb(e.getViewRoot(),t)?this._rootToNode({node:t}):this._zoomToNode({node:t}))}),this))},remove:function(){this._clearController(),this._containerGroup&&this._containerGroup.removeAll(),this._storage={nodeGroup:[],background:[],content:[]},this._state="ready",this._breadcrumb&&this._breadcrumb.remove()},dispose:function(){this._clearController()},_zoomToNode:function(e){this.api.dispatchAction({type:"treemapZoomToNode",from:this.uid,seriesId:this.seriesModel.id,targetNode:e.node})},_rootToNode:function(e){this.api.dispatchAction({type:"treemapRootToNode",from:this.uid,seriesId:this.seriesModel.id,targetNode:e.node})},findTarget:function(e,t){var n;return this.seriesModel.getViewRoot().eachNode({attr:"viewChildren",order:"preorder"},(function(o){var i=this._storage.background[o.getRawIndex()];if(i){var r=i.transformCoordToLocal(e,t),a=i.shape;if(!(a.x<=r[0]&&r[0]<=a.x+a.width&&a.y<=r[1]&&r[1]<=a.y+a.height))return!1;n={node:o,offsetX:r[0],offsetY:r[1]}}}),this),n}});for(var Ab=function(){},Nb=["treemapZoomToNode","treemapRender","treemapMove"],Mb=0;Mb<Nb.length;Mb++)th({type:Nb[Mb],update:"updateView"},Ab);th({type:"treemapRootToNode",update:"updateView"},(function(e,t){t.eachComponent({mainType:"series",subType:"treemap",query:e},(function(t,n){var o=mb(e,["treemapZoomToNode","treemapRootToNode"],t);if(o){var i=t.getViewRoot();i&&(e.direction=vb(i,o.node)?"rollUp":"drillDown"),t.resetViewRoot(o.node)}}))}));var Kb=O,Pb=L,Lb=function(e){var t=e.mappingMethod,n=e.type,o=this.option=p(e);this.type=n,this.mappingMethod=t,this._normalizeData=Gb[t];var i=Bb[n];this.applyVisual=i.applyVisual,this.getColorMapper=i.getColorMapper,this._doMap=i._doMap[t],"piecewise"===t?(Fb(o),function(e){var t=e.pieceList;e.hasSpecialVisual=!1,O(t,(function(t,n){t.originIndex=n,null!=t.visual&&(e.hasSpecialVisual=!0)}))}(o)):"category"===t?o.categories?function(e){var t=e.categories,n=e.visual,o=e.categoryMap={};if(Kb(t,(function(e,t){o[e]=t})),!M(n)){var i=[];L(n)?Kb(n,(function(e,t){var n=o[t];i[null!=n?n:-1]=e})):i[-1]=n,n=jb(e,i)}for(var r=t.length-1;0<=r;r--)null==n[r]&&(delete o[t[r]],t.pop())}(o):Fb(o,!0):(j("linear"!==t||o.dataExtent),Fb(o))};Lb.prototype={constructor:Lb,mapValueToVisual:function(e){var t=this._normalizeData(e);return this._doMap(t,e)},getNormalizer:function(){return A(this._normalizeData,this)}};var Bb=Lb.visualHandlers={color:{applyVisual:Hb("color"),getColorMapper:function(){var e=this.option;return A("category"===e.mappingMethod?function(e,t){return t||(e=this._normalizeData(e)),Wb.call(this,e)}:function(t,n,o){var i=!!o;return n||(t=this._normalizeData(t)),o=Wt(t,e.parsedVisual,o),i?o:jt(o,"rgba")},this)},_doMap:{linear:function(e){return jt(Wt(e,this.option.parsedVisual),"rgba")},category:Wb,piecewise:function(e,t){var n=qb.call(this,t);return null==n&&(n=jt(Wt(e,this.option.parsedVisual),"rgba")),n},fixed:$b}},colorHue:zb((function(e,t){return Ut(e,t)})),colorSaturation:zb((function(e,t){return Ut(e,null,t)})),colorLightness:zb((function(e,t){return Ut(e,null,null,t)})),colorAlpha:zb((function(e,t){return qt(e,t)})),opacity:{applyVisual:Hb("opacity"),_doMap:Ub([0,1])},liftZ:{applyVisual:Hb("liftZ"),_doMap:{linear:$b,category:$b,piecewise:$b,fixed:$b}},symbol:{applyVisual:function(e,t,n){var o=this.mapValueToVisual(e);if(P(o))n("symbol",o);else if(Pb(o))for(var i in o)o.hasOwnProperty(i)&&n(i,o[i])},_doMap:{linear:Vb,category:Wb,piecewise:function(e,t){var n=qb.call(this,t);return null==n&&(n=Vb.call(this,e)),n},fixed:$b}},symbolSize:{applyVisual:Hb("symbolSize"),_doMap:Ub([0,1])}};function Fb(e,t){var n=e.visual,o=[];L(n)?Kb(n,(function(e){o.push(e)})):null!=n&&o.push(n),t||1!==o.length||{color:1,symbol:1}.hasOwnProperty(e.type)||(o[1]=o[0]),jb(e,o)}function zb(e){return{applyVisual:function(t,n,o){t=this.mapValueToVisual(t),o("color",e(n("color"),t))},_doMap:Ub([0,1])}}function Vb(e){var t=this.option.visual;return t[Math.round(bl(e,[0,1],[0,t.length-1],!0))]||{}}function Hb(e){return function(t,n,o){o(e,this.mapValueToVisual(t))}}function Wb(e){var t=this.option.visual;return t[this.option.loop&&-1!==e?e%t.length:e]}function $b(){return this.option.visual[0]}function Ub(e){return{linear:function(t){return bl(t,e,this.option.visual,!0)},category:Wb,piecewise:function(t,n){var o=qb.call(this,n);return null==o&&(o=bl(t,e,this.option.visual,!0)),o},fixed:$b}}function qb(e){var t=this.option,n=t.pieceList;if(t.hasSpecialVisual){var o=n[Lb.findPieceIndex(e,n)];if(o&&o.visual)return o.visual[this.type]}}function jb(e,t){return e.visual=t,"color"===e.type&&(e.parsedVisual=w(t,(function(e){return Ft(e)}))),t}var Gb={linear:function(e){return bl(e,this.option.dataExtent,[0,1],!0)},piecewise:function(e){var t=this.option.pieceList,n=Lb.findPieceIndex(e,t,!0);if(null!=n)return bl(n,[0,t.length-1],[0,1],!0)},category:function(e){var t=this.option.categories?this.option.categoryMap[e]:e;return null==t?-1:t},fixed:te};function Xb(e,t,n){return e?t<=n:t<n}Lb.listVisualTypes=function(){var e=[];return O(Bb,(function(t,n){e.push(n)})),e},Lb.addVisualHandler=function(e,t){Bb[e]=t},Lb.isValidType=function(e){return Bb.hasOwnProperty(e)},Lb.eachVisual=function(e,t,n){L(e)?O(e,t,n):t.call(n,e)},Lb.mapVisual=function(e,t,n){var o,i=M(e)?[]:L(e)?{}:(o=!0,null);return Lb.eachVisual(e,(function(e,r){var a=t.call(n,e,r);o?i=a:i[r]=a})),i},Lb.retrieveVisuals=function(e){var t,n={};return e&&Kb(Bb,(function(o,i){e.hasOwnProperty(i)&&(n[i]=e[i],t=!0)})),t?n:null},Lb.prepareVisualTypes=function(e){if(Pb(e)){var t=[];Kb(e,(function(e,n){t.push(n)})),e=t}else{if(!M(e))return[];e=e.slice()}return e.sort((function(e,t){return"color"===t&&"color"!==e&&0===e.indexOf("color")?1:-1})),e},Lb.dependsOn=function(e,t){return"color"===t?!(!e||0!==e.indexOf(t)):e===t},Lb.findPieceIndex=function(e,t,n){for(var o,i=1/0,r=0,a=t.length;r<a;r++){var s=t[r].value;if(null!=s){if(s===e||"string"==typeof s&&s===e+"")return r;n&&d(s,r)}}for(r=0,a=t.length;r<a;r++){var l=t[r],u=l.interval,c=l.close;if(u){if(u[0]===-1/0){if(Xb(c[1],e,u[1]))return r}else if(u[1]===1/0){if(Xb(c[0],u[0],e))return r}else if(Xb(c[0],u[0],e)&&Xb(c[1],e,u[1]))return r;n&&d(u[0],r),n&&d(u[1],r)}}if(n)return e===1/0?t.length-1:e===-1/0?0:o;function d(t,n){var r=Math.abs(t-e);r<i&&(i=r,o=n)}};var Yb=M,Zb={seriesType:"treemap",reset:function(e,t,n,o){var i=e.getData().tree.root;i.isRemoved()||function e(t,n,o,i){var r=t.getModel(),a=t.getLayout();if(a&&!a.invisible&&a.isInView){var s,l,u=t.getModel("itemStyle"),c=function(e,t,n){var o=b({},t),i=n.designatedVisualItemStyle;return O(["color","colorAlpha","colorSaturation"],(function(n){i[n]=t[n];var r=e.get(n);(i[n]=null)!=r&&(o[n]=r)})),o}(u,n,i),d=u.get("borderColor"),f=u.get("borderColorSaturation");null!=f&&(d=null!=(l=s=Jb(c))?Ut(l,null,null,f):null),t.setVisual("borderColor",d);var h=t.viewChildren;if(h&&h.length){var g=function(e,t,n,o,i,r){if(r&&r.length){var a=eC(t,"color")||null!=i.color&&"none"!==i.color&&(eC(t,"colorAlpha")||eC(t,"colorSaturation"));if(a){var s=t.get("visualMin"),l=t.get("visualMax"),u=n.dataExtent.slice();null!=s&&s<u[0]&&(u[0]=s),null!=l&&l>u[1]&&(u[1]=l);var c=t.get("colorMappingBy"),d={type:a.name,dataExtent:u,visual:a.range};"color"!==d.type||"index"!==c&&"id"!==c?d.mappingMethod="linear":(d.mappingMethod="category",d.loop=!0);var f=new Lb(d);return f.__drColorMappingBy=c,f}}}(0,r,a,0,c,h);O(h,(function(t,n){if(t.depth>=o.length||t===o[t.depth]){var a=function(e,t,n,o,i,r){var a=b({},t);if(i){var s=i.type,l="color"===s&&i.__drColorMappingBy,u="index"===l?o:"id"===l?r.mapIdToIndex(n.getId()):n.getValue(e.get("visualDimension"));a[s]=i.mapValueToVisual(u)}return a}(r,c,t,n,g,i);e(t,a,o,i)}}))}else s=Jb(c),t.setVisual("color",s)}}(i,{},e.getViewRoot().getAncestors(),e)}};function Jb(e){var t=Qb(e,"color");if(t){var n=Qb(e,"colorAlpha"),o=Qb(e,"colorSaturation");return o&&(t=Ut(t,null,null,o)),n&&(t=qt(t,n)),t}}function Qb(e,t){var n=e[t];if(null!=n&&"none"!==n)return n}function eC(e,t){var n=e.get(t);return Yb(n)&&n.length?{name:t,range:n}:null}var tC=Math.max,nC=Math.min,oC=H,iC=O,rC=["itemStyle","borderWidth"],aC=["itemStyle","gapWidth"],sC=["upperLabel","show"],lC=["upperLabel","height"],uC={seriesType:"treemap",reset:function(e,t,n,o){var i=n.getWidth(),r=n.getHeight(),a=e.option,s=au(e.getBoxLayoutParams(),{width:n.getWidth(),height:n.getHeight()}),l=a.size||[],u=Cl(oC(s.width,l[0]),i),c=Cl(oC(s.height,l[1]),r),d=o&&o.type,f=mb(o,["treemapZoomToNode","treemapRootToNode"],e),h="treemapRender"===d||"treemapMove"===d?o.rootRect:null,g=e.getViewRoot(),m=pb(g);if("treemapMove"!==d){var p="treemapZoomToNode"===d?function(e,t,n,o,i){var r,a=(t||{}).node,s=[o,i];if(!a||a===n)return s;for(var l=o*i,u=l*e.option.zoomToNodeRatio;r=a.parentNode;){for(var c=0,d=r.children,f=0,h=d.length;f<h;f++)c+=d[f].getValue();var g=a.getValue();if(0===g)return s;u*=c/g;var m=r.getModel(),p=m.get(rC);u+=4*p*p+(3*p+Math.max(p,hC(m)))*Math.pow(u,.5),Ol<u&&(u=Ol),a=r}u<l&&(u=l);var v=Math.pow(u/l,.5);return[o*v,i*v]}(e,f,g,u,c):h?[h.width,h.height]:[u,c],v=a.sort;v&&"asc"!==v&&"desc"!==v&&(v="desc");var y={squareRatio:a.squareRatio,sort:v,leafDepth:a.leafDepth};g.hostTree.clearLayouts();var C={x:0,y:0,width:p[0],height:p[1],area:p[0]*p[1]};g.setLayout(C),function e(t,n,o,i){var r,a;if(!t.isRemoved()){var s=t.getLayout();r=s.width,a=s.height;var l=(g=t.getModel()).get(rC),u=g.get(aC)/2,c=hC(g),d=Math.max(l,c),f=l-u,h=d-u,g=t.getModel();t.setLayout({borderWidth:l,upperHeight:d,upperLabelHeight:c},!0);var m=(r=tC(r-2*f,0))*(a=tC(a-f-h,0)),p=cC(t,g,m,n,o,i);if(p.length){var v={x:f,y:h,width:r,height:a},y=nC(r,a),b=1/0,C=[];C.area=0;for(var T=0,x=p.length;T<x;){var E=p[T];C.push(E),C.area+=E.getLayout().area;var _=dC(C,y,n.squareRatio);b=_<=b?(T++,_):(C.area-=C.pop().getLayout().area,fC(C,y,v,u,!1),y=nC(v.width,v.height),C.length=C.area=0,1/0)}if(C.length&&fC(C,y,v,u,!0),!o){var I=g.get("childrenVisibleMin");null!=I&&m<I&&(o=!0)}for(T=0,x=p.length;T<x;T++)e(p[T],n,o,i+1)}}}(g,y,!1,0),C=g.getLayout(),iC(m,(function(e,t){var n=(m[t+1]||g).getValue();e.setLayout(b({dataExtent:[n,n],borderWidth:0,upperHeight:0},C))}))}var T=e.getData().tree.root;T.setLayout(function(e,t,n){if(t)return{x:t.x,y:t.y};var o={x:0,y:0};if(!n)return o;var i=n.node,r=i.getLayout();if(!r)return o;for(var a=[r.width/2,r.height/2],s=i;s;){var l=s.getLayout();a[0]+=l.x,a[1]+=l.y,s=s.parentNode}return{x:e.width/2-a[0],y:e.height/2-a[1]}}(s,h,f),!0),e.setLayoutInfo(s),function e(t,n,o,i,r){var a=t.getLayout(),s=o[r],l=s&&s===t;if(!(s&&!l||r===o.length&&t!==i)){t.setLayout({isInView:!0,invisible:!l&&!n.intersect(a),isAboveViewRoot:l},!0);var u=new En(n.x-a.x,n.y-a.y,n.width,n.height);iC(t.viewChildren||[],(function(t){e(t,u,o,i,r+1)}))}}(T,new En(-s.x,-s.y,i,r),m,g,0)}};function cC(e,t,n,o,i,r){var a=e.children||[],s=o.sort;"asc"!==s&&"desc"!==s&&(s=null);var l=null!=o.leafDepth&&o.leafDepth<=r;if(i&&!l)return e.viewChildren=[];!function(e,t){t&&e.sort((function(e,n){var o="asc"===t?e.getValue()-n.getValue():n.getValue()-e.getValue();return 0==o?"asc"===t?e.dataIndex-n.dataIndex:n.dataIndex-e.dataIndex:o}))}(a=S(a,(function(e){return!e.isRemoved()})),s);var u=function(e,t,n){for(var o=0,i=0,r=t.length;i<r;i++)o+=t[i].getValue();var a=e.get("visualDimension");if(t&&t.length)if("value"===a&&n)s=[t[t.length-1].getValue(),t[0].getValue()],"asc"===n&&s.reverse();else{var s=[1/0,-1/0];iC(t,(function(e){var t=e.getValue(a);t<s[0]&&(s[0]=t),t>s[1]&&(s[1]=t)}))}else s=[NaN,NaN];return{sum:o,dataExtent:s}}(t,a,s);if(0===u.sum)return e.viewChildren=[];if(u.sum=function(e,t,n,o,i){if(!o)return n;for(var r=e.get("visibleMin"),a=i.length,s=a,l=a-1;0<=l;l--){var u=i["asc"===o?a-l-1:l].getValue();u/n*t<r&&(s=l,n-=u)}return i.splice("asc"===o?0:s,a-s),n}(t,n,u.sum,s,a),0===u.sum)return e.viewChildren=[];for(var c=0,d=a.length;c<d;c++){var f=a[c].getValue()/u.sum*n;a[c].setLayout({area:f})}return l&&(a.length&&e.setLayout({isLeafRoot:!0},!0),a.length=0),e.viewChildren=a,e.setLayout({dataExtent:u.dataExtent},!0),a}function dC(e,t,n){for(var o,i=0,r=1/0,a=0,s=e.length;a<s;a++)(o=e[a].getLayout().area)&&(o<r&&(r=o),i<o&&(i=o));var l=e.area*e.area,u=t*t*n;return l?tC(u*i/l,l/(u*r)):1/0}function fC(e,t,n,o,i){var r=t===n.width?0:1,a=1-r,s=["x","y"],l=["width","height"],u=n[s[r]],c=t?e.area/t:0;(i||c>n[l[a]])&&(c=n[l[a]]);for(var d=0,f=e.length;d<f;d++){var h=e[d],g={},m=c?h.getLayout().area/c:0,p=g[l[a]]=tC(c-2*o,0),v=n[s[r]]+n[l[r]]-u,y=d===f-1||v<m?v:m,b=g[l[r]]=tC(y-2*o,0);g[s[a]]=n[s[a]]+nC(o,p/2),g[s[r]]=u+nC(o,b/2),u+=y,h.setLayout(g,!0)}n[s[a]]+=c,n[l[a]]-=c}function hC(e){return e.get(sC)?e.get(lC):0}function gC(e){return"_EC_"+e}function mC(e){this._directed=e||!1,this.nodes=[],this.edges=[],this._nodesMap={},this._edgesMap={}}ih(Zb),oh(uC);var pC=mC.prototype;function vC(e,t){this.id=null==e?"":e,this.inEdges=[],this.outEdges=[],this.edges=[],this.dataIndex=null==t?-1:t}function yC(e,t,n){this.node1=e,this.node2=t,this.dataIndex=null==n?-1:n}function bC(e,t){return{getValue:function(n){var o=this[e][t];return o.get(o.getDimension(n||"value"),this.dataIndex)},setVisual:function(n,o){0<=this.dataIndex&&this[e][t].setItemVisual(this.dataIndex,n,o)},getVisual:function(n,o){return this[e][t].getItemVisual(this.dataIndex,n,o)},setLayout:function(n,o){0<=this.dataIndex&&this[e][t].setItemLayout(this.dataIndex,n,o)},getLayout:function(){return this[e][t].getItemLayout(this.dataIndex)},getGraphicEl:function(){return this[e][t].getItemGraphicEl(this.dataIndex)},getRawIndex:function(){return this[e][t].getRawIndex(this.dataIndex)}}}function CC(e,t,n,o,i){for(var r=new mC(o),a=0;a<e.length;a++)r.addNode(H(e[a].id,e[a].name,a),a);var s=[],l=[],u=0;for(a=0;a<t.length;a++){var c=t[a],d=c.source,f=c.target;r.addEdge(d,f,u)&&(l.push(c),s.push(H(c.id,d+" > "+f)),u++)}var h,g=n.get("coordinateSystem");if("cartesian2d"===g||"polar"===g)h=Xh(e,n);else{var m=Uu.get(g),p=m&&"view"!==m.type&&m.dimensions||[];E(p,"value")<0&&p.concat(["value"]);var v=Hh(e,{coordDimensions:p});(h=new wh(v,n)).initData(e)}var y=new wh(["value"],n);return y.initData(l,s),i&&i(h,y),Uy({mainData:h,struct:r,structAttr:"graph",datas:{node:h,edge:y},datasAttr:{node:"data",edge:"edgeData"}}),r.update(),r}pC.type="graph",pC.isDirected=function(){return this._directed},pC.addNode=function(e,t){var n=this._nodesMap;if(!n[gC(e=null==e?""+t:""+e)]){var o=new vC(e,t);return(o.hostGraph=this).nodes.push(o),n[gC(e)]=o}},pC.getNodeByIndex=function(e){var t=this.data.getRawIndex(e);return this.nodes[t]},pC.getNodeById=function(e){return this._nodesMap[gC(e)]},pC.addEdge=function(e,t,n){var o=this._nodesMap,i=this._edgesMap;if("number"==typeof e&&(e=this.nodes[e]),"number"==typeof t&&(t=this.nodes[t]),vC.isInstance(e)||(e=o[gC(e)]),vC.isInstance(t)||(t=o[gC(t)]),e&&t){var r=e.id+"-"+t.id,a=new yC(e,t,n);return(a.hostGraph=this)._directed&&(e.outEdges.push(a),t.inEdges.push(a)),e.edges.push(a),e!==t&&t.edges.push(a),this.edges.push(a),i[r]=a}},pC.getEdgeByIndex=function(e){var t=this.edgeData.getRawIndex(e);return this.edges[t]},pC.getEdge=function(e,t){vC.isInstance(e)&&(e=e.id),vC.isInstance(t)&&(t=t.id);var n=this._edgesMap;return this._directed?n[e+"-"+t]:n[e+"-"+t]||n[t+"-"+e]},pC.eachNode=function(e,t){for(var n=this.nodes,o=n.length,i=0;i<o;i++)0<=n[i].dataIndex&&e.call(t,n[i],i)},pC.eachEdge=function(e,t){for(var n=this.edges,o=n.length,i=0;i<o;i++)0<=n[i].dataIndex&&0<=n[i].node1.dataIndex&&0<=n[i].node2.dataIndex&&e.call(t,n[i],i)},pC.breadthFirstTraverse=function(e,t,n,o){if(vC.isInstance(t)||(t=this._nodesMap[gC(t)]),t){for(var i="out"===n?"outEdges":"in"===n?"inEdges":"edges",r=0;r<this.nodes.length;r++)this.nodes[r].__visited=!1;if(!e.call(o,t,null))for(var a=[t];a.length;){var s=a.shift(),l=s[i];for(r=0;r<l.length;r++){var u=l[r],c=u.node1===s?u.node2:u.node1;if(!c.__visited){if(e.call(o,c,s))return;a.push(c),c.__visited=!0}}}}},pC.update=function(){for(var e=this.data,t=this.edgeData,n=this.nodes,o=this.edges,i=0,r=n.length;i<r;i++)n[i].dataIndex=-1;for(i=0,r=e.count();i<r;i++)n[e.getRawIndex(i)].dataIndex=i;for(t.filterSelf((function(e){var n=o[t.getRawIndex(e)];return 0<=n.node1.dataIndex&&0<=n.node2.dataIndex})),i=0,r=o.length;i<r;i++)o[i].dataIndex=-1;for(i=0,r=t.count();i<r;i++)o[t.getRawIndex(i)].dataIndex=i},pC.clone=function(){for(var e=new mC(this._directed),t=this.nodes,n=this.edges,o=0;o<t.length;o++)e.addNode(t[o].id,t[o].dataIndex);for(o=0;o<n.length;o++){var i=n[o];e.addEdge(i.node1.id,i.node2.id,i.dataIndex)}return e},vC.prototype={constructor:vC,degree:function(){return this.edges.length},inDegree:function(){return this.inEdges.length},outDegree:function(){return this.outEdges.length},getModel:function(e){if(!(this.dataIndex<0))return this.hostGraph.data.getItemModel(this.dataIndex).getModel(e)}},yC.prototype.getModel=function(e){if(!(this.dataIndex<0))return this.hostGraph.edgeData.getItemModel(this.dataIndex).getModel(e)},I(vC,bC("hostGraph","data")),I(yC,bC("hostGraph","edgeData")),mC.Node=vC,mC.Edge=yC,ji(vC),ji(yC);var TC="--\x3e",xC=function(e){return e.get("autoCurveness")||null},EC=function(e,t){var n=xC(e),o=20,i=[];if("number"==typeof n)o=n;else if(M(n))return void(e.__curvenessList=n);o<t&&(o=t);var r=o%2?o+2:o+3;i=[];for(var a=0;a<r;a++)i.push((a%2?a+1:a)/10*(a%2?-1:1));e.__curvenessList=i},_C=function(e,t,n){var o=[e.id,e.dataIndex].join("."),i=[t.id,t.dataIndex].join(".");return[n.uid,o,i].join(TC)},IC=function(e){var t=e.split(TC);return[t[0],t[2],t[1]].join(TC)},DC=function(e,t){var n=t.__edgeMap;return n[e]?n[e].length:0};function OC(e,t,n,o){var i=xC(t),r=M(i);if(!i)return null;var a=function(e,t){var n=_C(e.node1,e.node2,t);return t.__edgeMap[n]}(e,t);if(!a)return null;for(var s=-1,l=0;l<a.length;l++)if(a[l]===n){s=l;break}var u=function(e,t){return DC(_C(e.node1,e.node2,t),t)+DC(_C(e.node2,e.node1,t),t)}(e,t);EC(t,u),e.lineStyle=e.lineStyle||{};var c=_C(e.node1,e.node2,t),d=t.__curvenessList,f=r||u%2?0:1;if(a.isForward)return d[f+s];var h=IC(c),g=DC(h,t),m=d[s+g+f];return o?r?i&&0===i[0]?(g+f)%2?m:-m:((g%2?0:1)+f)%2?m:-m:(g+f)%2?m:-m:d[s+g+f]}var wC=uh({type:"series.graph",init:function(e){wC.superApply(this,"init",arguments);var t=this;function n(){return t._categoriesData}this.legendVisualProvider=new Ev(n,n),this.fillDataTextStyle(e.edges||e.links),this._updateCategoriesData()},mergeOption:function(e){wC.superApply(this,"mergeOption",arguments),this.fillDataTextStyle(e.edges||e.links),this._updateCategoriesData()},mergeDefaultAndTheme:function(e){wC.superApply(this,"mergeDefaultAndTheme",arguments),wi(e,["edgeLabel"],["show"])},getInitialData:function(e,t){var n=e.edges||e.links||[],o=e.data||e.nodes||[],i=this;if(o&&n){!function(e){xC(e)&&(e.__curvenessList=[],e.__edgeMap={},EC(e))}(this);var r=CC(o,n,this,!0,(function(e,n){e.wrapMethod("getItemModel",(function(e){var t=i._categoriesModels[e.getShallow("category")];return t&&(t.parentModel=e.parentModel,e.parentModel=t),e}));var o=i.getModel("edgeLabel"),r=new hl({label:o.option},o.parentModel,t),a=i.getModel("emphasis.edgeLabel"),s=new hl({emphasis:{label:a.option}},a.parentModel,t);function l(e){return(e=this.parsePath(e))&&"label"===e[0]?r:e&&"emphasis"===e[0]&&"label"===e[1]?s:this.parentModel}n.wrapMethod("getItemModel",(function(e){return e.customizeGetParent(l),e}))}));return O(r.edges,(function(e){!function(e,t,n,o){if(xC(n)){var i=_C(e,t,n),r=n.__edgeMap,a=r[IC(i)];r[i]&&!a?r[i].isForward=!0:a&&r[i]&&(a.isForward=!0,r[i].isForward=!1),r[i]=r[i]||[],r[i].push(o)}}(e.node1,e.node2,this,e.dataIndex)}),this),r.data}},getGraph:function(){return this.getData().graph},getEdgeData:function(){return this.getGraph().edgeData},getCategoriesData:function(){return this._categoriesData},formatTooltip:function(e,t,n){if("edge"!==n)return wC.superApply(this,"formatTooltip",arguments);var o=this.getData(),i=this.getDataParams(e,n),r=o.graph.getEdgeByIndex(e),a=o.getName(r.node1.dataIndex),s=o.getName(r.node2.dataIndex),l=[];return null!=a&&l.push(a),null!=s&&l.push(s),l=Wl(l.join(" > ")),i.value&&(l+=" : "+Wl(i.value)),l},_updateCategoriesData:function(){var e=w(this.option.categories||[],(function(e){return null!=e.value?e:b({value:0},e)})),t=new wh(["value"],this);t.initData(e),this._categoriesData=t,this._categoriesModels=t.mapArray((function(e){return t.getItemModel(e,!0)}))},setZoom:function(e){this.option.zoom=e},setCenter:function(e){this.option.center=e},isAnimationEnabled:function(){return wC.superCall(this,"isAnimationEnabled")&&!("force"===this.get("layout")&&this.get("force.layoutAnimation"))},defaultOption:{zlevel:0,z:2,coordinateSystem:"view",legendHoverLink:!0,hoverAnimation:!0,layout:null,focusNodeAdjacency:!1,circular:{rotateLabel:!1},force:{initLayout:null,repulsion:[0,50],gravity:.1,friction:.6,edgeLength:30,layoutAnimation:!0},left:"center",top:"center",symbol:"circle",symbolSize:10,edgeSymbol:["none","none"],edgeSymbolSize:10,edgeLabel:{position:"middle",distance:5},draggable:!1,roam:!1,center:null,zoom:1,nodeScaleRatio:.6,label:{show:!1,formatter:"{b}"},itemStyle:{},lineStyle:{color:"#aaa",width:1,opacity:.5},emphasis:{label:{show:!0}}}}),RC=ja.prototype,SC=Za.prototype;function kC(e){return isNaN(+e.cpx1)||isNaN(+e.cpy1)}var AC=hs({type:"ec-line",style:{stroke:"#000",fill:null},shape:{x1:0,y1:0,x2:0,y2:0,percent:1,cpx1:null,cpy1:null},buildPath:function(e,t){this[kC(t)?"_buildPathLine":"_buildPathCurve"](e,t)},_buildPathLine:RC.buildPath,_buildPathCurve:SC.buildPath,pointAt:function(e){return this[kC(this.shape)?"_pointAtLine":"_pointAtCurve"](e)},_pointAtLine:RC.pointAt,_pointAtCurve:SC.pointAt,tangentAt:function(e){var t=this.shape,n=kC(t)?[t.x2-t.x1,t.y2-t.y1]:this._tangentAtCurve(e);return ge(n,n)},_tangentAtCurve:SC.tangentAt}),NC=["fromSymbol","toSymbol"];function MC(e){return"_"+e+"Type"}function KC(e,t,n){var o=t.getItemVisual(n,e);if(o&&"none"!==o){var i=t.getItemVisual(n,"color"),r=t.getItemVisual(n,e+"Size"),a=t.getItemVisual(n,e+"Rotate");M(r)||(r=[r,r]);var s=tm(o,-r[0]/2,-r[1]/2,r[0],r[1],i);return s.__specifiedRotation=null==a||isNaN(a)?void 0:+a*Math.PI/180||0,s.name=e,s}}function PC(e,t){e.x1=t[0][0],e.y1=t[0][1],e.x2=t[1][0],e.y2=t[1][1],e.percent=1;var n=t[2];n?(e.cpx1=n[0],e.cpy1=n[1]):(e.cpx1=NaN,e.cpy1=NaN)}function LC(e,t,n){_n.call(this),this._createLine(e,t,n)}var BC=LC.prototype;function FC(e){this._ctor=e||LC,this.group=new _n}BC.beforeUpdate=function(){var e=this.childOfName("fromSymbol"),t=this.childOfName("toSymbol"),n=this.childOfName("label");if(e||t||!n.ignore){for(var o=1,i=this.parent;i;)i.scale&&(o/=i.scale[0]),i=i.parent;var r=this.childOfName("line");if(this.__dirty||r.__dirty){var a,s=r.shape.percent,l=r.pointAt(0),u=r.pointAt(s),c=ce([],u,l);if(ge(c,c),e){if(e.attr("position",l),null==(a=e.__specifiedRotation)){var d=r.tangentAt(0);e.attr("rotation",Math.PI/2-Math.atan2(d[1],d[0]))}else e.attr("rotation",a);e.attr("scale",[o*s,o*s])}if(t&&(t.attr("position",u),null==(a=t.__specifiedRotation)?(d=r.tangentAt(1),t.attr("rotation",-Math.PI/2-Math.atan2(d[1],d[0]))):t.attr("rotation",a),t.attr("scale",[o*s,o*s])),!n.ignore){var f,h,g,m;n.attr("position",u);var p=n.__labelDistance,v=p[0]*o,y=p[1]*o,b=s/2,C=[(d=r.tangentAt(b))[1],-d[0]],T=r.pointAt(b);0<C[1]&&(C[0]=-C[0],C[1]=-C[1]);var x,E=d[0]<0?-1:1;if("start"!==n.__position&&"end"!==n.__position){var _=-Math.atan2(d[1],d[0]);u[0]<l[0]&&(_=Math.PI+_),n.attr("rotation",_)}switch(n.__position){case"insideStartTop":case"insideMiddleTop":case"insideEndTop":case"middle":x=-y,g="bottom";break;case"insideStartBottom":case"insideMiddleBottom":case"insideEndBottom":x=y,g="top";break;default:x=0,g="middle"}switch(n.__position){case"end":f=[c[0]*v+u[0],c[1]*y+u[1]],h=.8<c[0]?"left":c[0]<-.8?"right":"center",g=.8<c[1]?"top":c[1]<-.8?"bottom":"middle";break;case"start":f=[-c[0]*v+l[0],-c[1]*y+l[1]],h=.8<c[0]?"right":c[0]<-.8?"left":"center",g=.8<c[1]?"bottom":c[1]<-.8?"top":"middle";break;case"insideStartTop":case"insideStart":case"insideStartBottom":f=[v*E+l[0],l[1]+x],h=d[0]<0?"right":"left",m=[-v*E,-x];break;case"insideMiddleTop":case"insideMiddle":case"insideMiddleBottom":case"middle":f=[T[0],T[1]+x],h="center",m=[0,-x];break;case"insideEndTop":case"insideEnd":case"insideEndBottom":f=[-v*E+u[0],u[1]+x],h=0<=d[0]?"right":"left",m=[v*E,-x]}n.attr({style:{textVerticalAlign:n.__verticalAlign||g,textAlign:n.__textAlign||h},position:f,scale:[o,o],origin:m})}}}},BC._createLine=function(e,t,n){var o=e.hostModel,i=function(e){var t=new AC({name:"line",subPixelOptimize:!0});return PC(t.shape,e),t}(e.getItemLayout(t));i.shape.percent=0,Ys(i,{shape:{percent:1}},o,t),this.add(i);var r=new Sa({name:"label",lineLabelOriginalOpacity:1});this.add(r),O(NC,(function(n){var o=KC(n,e,t);this.add(o),this[MC(n)]=e.getItemVisual(t,n)}),this),this._updateCommonStl(e,t,n)},BC.updateData=function(e,t,n){var o=e.hostModel,i=this.childOfName("line"),r=e.getItemLayout(t),a={shape:{}};PC(a.shape,r),Xs(i,a,o,t),O(NC,(function(n){var o=e.getItemVisual(t,n),i=MC(n);if(this[i]!==o){this.remove(this.childOfName(n));var r=KC(n,e,t);this.add(r)}this[i]=o}),this),this._updateCommonStl(e,t,n)},BC._updateCommonStl=function(e,t,n){var o=e.hostModel,i=this.childOfName("line"),r=n&&n.lineStyle,a=n&&n.hoverLineStyle,s=n&&n.labelModel,l=n&&n.hoverLabelModel;if(!n||e.hasItemOption){var u=e.getItemModel(t);r=u.getModel("lineStyle").getLineStyle(),a=u.getModel("emphasis.lineStyle").getLineStyle(),s=u.getModel("label"),l=u.getModel("emphasis.label")}var c=e.getItemVisual(t,"color"),d=$(e.getItemVisual(t,"opacity"),r.opacity,1);i.useStyle(C({strokeNoScale:!0,fill:"none",stroke:c,opacity:d},r)),i.hoverStyle=a,O(NC,(function(e){var t=this.childOfName(e);t&&(t.setColor(c),t.setStyle({opacity:d}))}),this);var f,h,g=s.getShallow("show"),m=l.getShallow("show"),p=this.childOfName("label");if((g||m)&&(f=c||"#000",null==(h=o.getFormattedLabel(t,"normal",e.dataType)))){var v=o.getRawValue(t);h=null==v?e.getName(t):isFinite(v)?Tl(v):v}var y=g?h:null,b=m?W(o.getFormattedLabel(t,"emphasis",e.dataType),h):null,T=p.style;if(null!=y||null!=b){Vs(p.style,s,{text:y},{autoColor:f}),p.__textAlign=T.textAlign,p.__verticalAlign=T.textVerticalAlign,p.__position=s.get("position")||"middle";var x=s.get("distance");M(x)||(x=[x,x]),p.__labelDistance=x}p.hoverStyle=null!=b?{text:b,textFill:l.getTextColor(!0),fontStyle:l.getShallow("fontStyle"),fontWeight:l.getShallow("fontWeight"),fontSize:l.getShallow("fontSize"),fontFamily:l.getShallow("fontFamily")}:{text:null},p.ignore=!g&&!m,Ks(this)},BC.highlight=function(){this.trigger("emphasis")},BC.downplay=function(){this.trigger("normal")},BC.updateLayout=function(e,t){this.setLinePoints(e.getItemLayout(t))},BC.setLinePoints=function(e){var t=this.childOfName("line");PC(t.shape,e),t.dirty()},_(LC,_n);var zC=FC.prototype;function VC(e){var t=e.hostModel;return{lineStyle:t.getModel("lineStyle").getLineStyle(),hoverLineStyle:t.getModel("emphasis.lineStyle").getLineStyle(),labelModel:t.getModel("label"),hoverLabelModel:t.getModel("emphasis.label")}}function HC(e){return isNaN(e[0])||isNaN(e[1])}function WC(e){return!HC(e[0])&&!HC(e[1])}function $C(e){var t=e.coordinateSystem;if("view"!==t.type)return 1;var n=e.option.nodeScaleRatio,o=t.scale,i=o&&o[0]||1;return((t.getZoom()-1)*n+1)/i}function UC(e){var t=e.getVisual("symbolSize");return t instanceof Array&&(t=(t[0]+t[1])/2),+t}zC.isPersistent=function(){return!0},zC.updateData=function(e){var t=this,n=t.group,o=t._lineData;t._lineData=e,o||n.removeAll();var i=VC(e);e.diff(o).add((function(n){!function(e,t,n,o){if(WC(t.getItemLayout(n))){var i=new e._ctor(t,n,o);t.setItemGraphicEl(n,i),e.group.add(i)}}(t,e,n,i)})).update((function(n,r){!function(e,t,n,o,i,r){var a=t.getItemGraphicEl(o);if(!WC(n.getItemLayout(i)))return e.group.remove(a);a?a.updateData(n,i,r):a=new e._ctor(n,i,r),n.setItemGraphicEl(i,a),e.group.add(a)}(t,o,e,r,n,i)})).remove((function(e){n.remove(o.getItemGraphicEl(e))})).execute()},zC.updateLayout=function(){var e=this._lineData;e&&e.eachItemGraphicEl((function(t,n){t.updateLayout(e,n)}),this)},zC.incrementalPrepareUpdate=function(e){this._seriesScope=VC(e),this._lineData=null,this.group.removeAll()},zC.incrementalUpdate=function(e,t){function n(e){e.isGroup||function(e){return e.animators&&0<e.animators.length}(e)||(e.incremental=e.useHoverLayer=!0)}for(var o=e.start;o<e.end;o++)if(WC(t.getItemLayout(o))){var i=new this._ctor(t,o,this._seriesScope);i.traverse(n),this.group.add(i),t.setItemGraphicEl(o,i)}},zC.remove=function(){this._clearIncremental(),this._incremental=null,this.group.removeAll()},zC._clearIncremental=function(){var e=this._incremental;e&&e.clearDisplaybles()};var qC=[],jC=[],GC=[],XC=vr,YC=ye,ZC=Math.abs;function JC(e,t,n){for(var o,i=e[0],r=e[1],a=e[2],s=1/0,l=n*n,u=.1,c=.1;c<=.9;c+=.1)qC[0]=XC(i[0],r[0],a[0],c),qC[1]=XC(i[1],r[1],a[1],c),(h=ZC(YC(qC,t)-l))<s&&(s=h,o=c);for(var d=0;d<32;d++){var f=o+u;jC[0]=XC(i[0],r[0],a[0],o),jC[1]=XC(i[1],r[1],a[1],o),GC[0]=XC(i[0],r[0],a[0],f),GC[1]=XC(i[1],r[1],a[1],f);var h=YC(jC,t)-l;if(ZC(h)<.01)break;var g=YC(GC,t)-l;u/=2,h<0?0<=g?o+=u:o-=u:0<=g?o-=u:o+=u}return o}function QC(e,t){var n=[],o=Cr,i=[[],[],[]],r=[[],[]],a=[];t/=2,e.eachEdge((function(e,s){var l=e.getLayout(),u=e.getVisual("fromSymbol"),c=e.getVisual("toSymbol");l.__original||(l.__original=[ae(l[0]),ae(l[1])],l[2]&&l.__original.push(ae(l[2])));var d=l.__original;if(null!=l[2]){if(re(i[0],d[0]),re(i[1],d[2]),re(i[2],d[1]),u&&"none"!==u){var f=UC(e.node1),h=JC(i,d[0],f*t);o(i[0][0],i[1][0],i[2][0],h,n),i[0][0]=n[3],i[1][0]=n[4],o(i[0][1],i[1][1],i[2][1],h,n),i[0][1]=n[3],i[1][1]=n[4]}c&&"none"!==c&&(f=UC(e.node2),h=JC(i,d[1],f*t),o(i[0][0],i[1][0],i[2][0],h,n),i[1][0]=n[1],i[2][0]=n[2],o(i[0][1],i[1][1],i[2][1],h,n),i[1][1]=n[1],i[2][1]=n[2]),re(l[0],i[0]),re(l[1],i[2]),re(l[2],i[1])}else re(r[0],d[0]),re(r[1],d[1]),ce(a,r[1],r[0]),ge(a,a),u&&"none"!==u&&(f=UC(e.node1),ue(r[0],r[0],a,f*t)),c&&"none"!==c&&(f=UC(e.node2),ue(r[1],r[1],a,-f*t)),re(l[0],r[0]),re(l[1],r[1])}))}var eT="__focusNodeAdjacency",tT="__unfocusNodeAdjacency",nT=["itemStyle","opacity"],oT=["lineStyle","opacity"];function iT(e,t){var n=e.getVisual("opacity");return null!=n?n:e.getModel().get(t)}function rT(e,t,n){var o=e.getGraphicEl(),i=iT(e,t);null!=n&&(null==i&&(i=1),i*=n),o.downplay&&o.downplay(),o.traverse((function(e){if(!e.isGroup){var t=e.lineLabelOriginalOpacity;null!=t&&null==n||(t=i),e.setStyle("opacity",t)}}))}function aT(e,t){var n=iT(e,t),o=e.getGraphicEl();o.traverse((function(e){e.isGroup||e.setStyle("opacity",n)})),o.highlight&&o.highlight()}function sT(e){return e instanceof Array||(e=[e,e]),e}function lT(e){var t=e.coordinateSystem;if(!t||"view"===t.type){var n=e.getGraph();n.eachNode((function(e){var t=e.getModel();e.setLayout([+t.get("x"),+t.get("y")])})),uT(n,e)}}function uT(e,t){e.eachEdge((function(e,n){var o=$(e.getModel().get("lineStyle.curveness"),-OC(e,t,n,!0),0),i=ae(e.node1.getLayout()),r=ae(e.node2.getLayout()),a=[i,r];+o&&a.push([(i[0]+r[0])/2-(i[1]-r[1])*o,(i[1]+r[1])/2-(r[0]-i[0])*o]),e.setLayout(a)}))}ch({type:"graph",init:function(e,t){var n=new Am,o=new FC,i=this.group;this._controller=new fy(t.getZr()),this._controllerHost={target:i},i.add(n.group),i.add(o.group),this._symbolDraw=n,this._lineDraw=o,this._firstRender=!0},render:function(e,t,n){var o=this,i=e.coordinateSystem;this._model=e;var r=this._symbolDraw,a=this._lineDraw,s=this.group;if("view"===i.type){var l={position:i.position,scale:i.scale};this._firstRender?s.attr(l):Xs(s,l,e)}QC(e.getGraph(),$C(e));var u=e.getData();r.updateData(u);var c=e.getEdgeData();a.updateData(c),this._updateNodeAndLinkScale(),this._updateController(e,t,n),clearTimeout(this._layoutTimeout);var d=e.forceLayout,f=e.get("force.layoutAnimation");d&&this._startForceLayoutIteration(d,f),u.eachItemGraphicEl((function(t,i){var r=u.getItemModel(i);t.off("drag").off("dragend");var a=r.get("draggable");a&&t.on("drag",(function(){d&&(d.warmUp(),this._layouting||this._startForceLayoutIteration(d,f),d.setFixed(i),u.setItemLayout(i,t.position))}),this).on("dragend",(function(){d&&d.setUnfixed(i)}),this),t.setDraggable(a&&d),t[eT]&&t.off("mouseover",t[eT]),t[tT]&&t.off("mouseout",t[tT]),r.get("focusNodeAdjacency")&&(t.on("mouseover",t[eT]=function(){o._clearTimer(),n.dispatchAction({type:"focusNodeAdjacency",seriesId:e.id,dataIndex:t.dataIndex})}),t.on("mouseout",t[tT]=function(){o._dispatchUnfocus(n)}))}),this),u.graph.eachEdge((function(t){var i=t.getGraphicEl();i[eT]&&i.off("mouseover",i[eT]),i[tT]&&i.off("mouseout",i[tT]),t.getModel().get("focusNodeAdjacency")&&(i.on("mouseover",i[eT]=function(){o._clearTimer(),n.dispatchAction({type:"focusNodeAdjacency",seriesId:e.id,edgeDataIndex:t.dataIndex})}),i.on("mouseout",i[tT]=function(){o._dispatchUnfocus(n)}))}));var h="circular"===e.get("layout")&&e.get("circular.rotateLabel"),g=u.getLayout("cx"),m=u.getLayout("cy");u.eachItemGraphicEl((function(e,t){var n=u.getItemModel(t).get("label.rotate")||0,o=e.getSymbolPath();if(h){var i=u.getItemLayout(t),r=Math.atan2(i[1]-m,i[0]-g);r<0&&(r=2*Math.PI+r);var a=i[0]<g;a&&(r-=Math.PI);var s=a?"left":"right";zs(o,{textRotation:-r,textPosition:s,textOrigin:"center"},{textPosition:s})}else zs(o,{textRotation:n*=Math.PI/180})})),this._firstRender=!1},dispose:function(){this._controller&&this._controller.dispose(),this._controllerHost={},this._clearTimer()},_dispatchUnfocus:function(e,t){var n=this;this._clearTimer(),this._unfocusDelayTimer=setTimeout((function(){n._unfocusDelayTimer=null,e.dispatchAction({type:"unfocusNodeAdjacency",seriesId:n._model.id})}),500)},_clearTimer:function(){this._unfocusDelayTimer&&(clearTimeout(this._unfocusDelayTimer),this._unfocusDelayTimer=null)},focusNodeAdjacency:function(e,t,n,o){var i=e.getData().graph,r=o.edgeDataIndex,a=i.getNodeByIndex(o.dataIndex),s=i.getEdgeByIndex(r);(a||s)&&(i.eachNode((function(e){rT(e,nT,.1)})),i.eachEdge((function(e){rT(e,oT,.1)})),a&&(aT(a,nT),O(a.edges,(function(e){e.dataIndex<0||(aT(e,oT),aT(e.node1,nT),aT(e.node2,nT))}))),s&&(aT(s,oT),aT(s.node1,nT),aT(s.node2,nT)))},unfocusNodeAdjacency:function(e,t,n,o){var i=e.getData().graph;i.eachNode((function(e){rT(e,nT)})),i.eachEdge((function(e){rT(e,oT)}))},_startForceLayoutIteration:function(e,t){var n=this;!function o(){e.step((function(e){n.updateLayout(n._model),(n._layouting=!e)&&(t?n._layoutTimeout=setTimeout(o,16):o())}))}()},_updateController:function(e,t,n){var o=this._controller,i=this._controllerHost,r=this.group;o.setPointerChecker((function(t,o,i){var a=r.getBoundingRect();return a.applyTransform(r.transform),a.contain(o,i)&&!_y(t,n,e)})),"view"===e.coordinateSystem.type?(o.enable(e.get("roam")),i.zoomLimit=e.get("scaleLimit"),i.zoom=e.coordinateSystem.getZoom(),o.off("pan").off("zoom").on("pan",(function(t){Ty(i,t.dx,t.dy),n.dispatchAction({seriesId:e.id,type:"graphRoam",dx:t.dx,dy:t.dy})})).on("zoom",(function(t){xy(i,t.scale,t.originX,t.originY),n.dispatchAction({seriesId:e.id,type:"graphRoam",zoom:t.scale,originX:t.originX,originY:t.originY}),this._updateNodeAndLinkScale(),QC(e.getGraph(),$C(e)),this._lineDraw.updateLayout()}),this)):o.disable()},_updateNodeAndLinkScale:function(){var e=this._model,t=e.getData(),n=$C(e),o=[n,n];t.eachItemGraphicEl((function(e,t){e.attr("scale",o)}))},updateLayout:function(e){QC(e.getGraph(),$C(e)),this._symbolDraw.updateLayout(),this._lineDraw.updateLayout()},remove:function(e,t){this._symbolDraw&&this._symbolDraw.remove(),this._lineDraw&&this._lineDraw.remove()}}),th({type:"focusNodeAdjacency",event:"focusNodeAdjacency",update:"series:focusNodeAdjacency"},(function(){})),th({type:"unfocusNodeAdjacency",event:"unfocusNodeAdjacency",update:"series:unfocusNodeAdjacency"},(function(){})),th({type:"graphRoam",event:"graphRoam",update:"none"},(function(e,t){t.eachComponent({mainType:"series",query:e},(function(t){var n=Ay(t.coordinateSystem,e);t.setCenter&&t.setCenter(n.center),t.setZoom&&t.setZoom(n.zoom)}))}));var cT=Math.PI,dT=[];function fT(e,t){var n=e.coordinateSystem;if(!n||"view"===n.type){var o=n.getBoundingRect(),i=e.getData(),r=i.graph,a=o.width/2+o.x,s=o.height/2+o.y,l=Math.min(o.width,o.height)/2,u=i.count();i.setLayout({cx:a,cy:s}),u&&(hT[t](e,n,r,i,l,a,s,u),r.eachEdge((function(t,n){var o,i=$(t.getModel().get("lineStyle.curveness"),OC(t,e,n),0),r=ae(t.node1.getLayout()),l=ae(t.node2.getLayout());+i&&(o=[a*(i*=3)+(r[0]+l[0])/2*(1-i),s*i+(r[1]+l[1])/2*(1-i)]),t.setLayout([r,l,o])})))}}var hT={value:function(e,t,n,o,i,r,a,s){var l=0,u=o.getSum("value"),c=2*Math.PI/(u||s);n.eachNode((function(e){var t=e.getValue("value"),n=c*(u?t:1)/2;l+=n,e.setLayout([i*Math.cos(l)+r,i*Math.sin(l)+a]),l+=n}))},symbolSize:function(e,t,n,o,i,r,a,s){var l=0;dT.length=s;var u=$C(e);n.eachNode((function(e){var t=UC(e);isNaN(t)&&(t=2),t<0&&(t=0),t*=u;var n=Math.asin(t/2/i);isNaN(n)&&(n=cT/2),dT[e.dataIndex]=n,l+=2*n}));var c=(2*cT-l)/s/2,d=0;n.eachNode((function(e){var t=c+dT[e.dataIndex];d+=t,e.setLayout([i*Math.cos(d)+r,i*Math.sin(d)+a]),d+=t}))}},gT=ue;eh((function(e){var t=e.findComponents({mainType:"legend"});t&&t.length&&e.eachSeriesByType("graph",(function(e){var n=e.getCategoriesData(),o=e.getGraph().data,i=n.mapArray(n.getName);o.filterSelf((function(e){var n=o.getItemModel(e).getShallow("category");if(null!=n){"number"==typeof n&&(n=i[n]);for(var r=0;r<t.length;r++)if(!t[r].isSelected(n))return!1}return!0}))}),this)})),ih(rp("graph","circle",null)),ih((function(e){var t={};e.eachSeriesByType("graph",(function(e){var n=e.getCategoriesData(),o=e.getData(),i={};n.each((function(o){var r=n.getName(o);i["ec-"+r]=o;var a=n.getItemModel(o),s=a.get("itemStyle.color")||e.getColorFromPalette(r,t);n.setItemVisual(o,"color",s);for(var l=["opacity","symbol","symbolSize","symbolKeepAspect"],u=0;u<l.length;u++){var c=a.getShallow(l[u],!0);null!=c&&n.setItemVisual(o,l[u],c)}})),n.count()&&o.each((function(e){var t=o.getItemModel(e).getShallow("category");if(null!=t){"string"==typeof t&&(t=i["ec-"+t]);for(var r=["color","opacity","symbol","symbolSize","symbolKeepAspect"],a=0;a<r.length;a++)null==o.getItemVisual(e,r[a],!0)&&o.setItemVisual(e,r[a],n.getItemVisual(t,r[a]))}}))}))})),ih((function(e){e.eachSeriesByType("graph",(function(e){var t=e.getGraph(),n=e.getEdgeData(),o=sT(e.get("edgeSymbol")),i=sT(e.get("edgeSymbolSize")),r="lineStyle.color".split("."),a="lineStyle.opacity".split(".");n.setVisual("fromSymbol",o&&o[0]),n.setVisual("toSymbol",o&&o[1]),n.setVisual("fromSymbolSize",i&&i[0]),n.setVisual("toSymbolSize",i&&i[1]),n.setVisual("color",e.get(r)),n.setVisual("opacity",e.get(a)),n.each((function(e){var o=n.getItemModel(e),i=t.getEdgeByIndex(e),s=sT(o.getShallow("symbol",!0)),l=sT(o.getShallow("symbolSize",!0)),u=o.get(r),c=o.get(a);switch(u){case"source":u=i.node1.getVisual("color");break;case"target":u=i.node2.getVisual("color")}s[0]&&i.setVisual("fromSymbol",s[0]),s[1]&&i.setVisual("toSymbol",s[1]),l[0]&&i.setVisual("fromSymbolSize",l[0]),l[1]&&i.setVisual("toSymbolSize",l[1]),i.setVisual("color",u),i.setVisual("opacity",c)}))}))})),oh((function(e,t){e.eachSeriesByType("graph",(function(e){var t=e.get("layout"),n=e.coordinateSystem;if(n&&"view"!==n.type){var o=e.getData(),i=[];O(n.dimensions,(function(e){i=i.concat(o.mapDimension(e,!0))}));for(var r=0;r<o.count();r++){for(var a=[],s=!1,l=0;l<i.length;l++){var u=o.get(i[l],r);isNaN(u)||(s=!0),a.push(u)}o.setItemLayout(r,s?n.dataToPoint(a):[NaN,NaN])}uT(o.graph,e)}else t&&"none"!==t||lT(e)}))})),oh(ff.VISUAL.POST_CHART_LAYOUT,(function(e){e.eachSeriesByType("graph",(function(e){"circular"===e.get("layout")&&fT(e,"symbolSize")}))})),oh((function(e){e.eachSeriesByType("graph",(function(e){if(!(d=e.coordinateSystem)||"view"===d.type)if("force"===e.get("layout")){var t=e.preservedPoints||{},n=e.getGraph(),o=n.data,i=n.edgeData,r=e.getModel("force"),a=r.get("initLayout");e.preservedPoints?o.each((function(e){var n=o.getId(e);o.setItemLayout(e,t[n]||[NaN,NaN])})):a&&"none"!==a?"circular"===a&&fT(e,"value"):lT(e);var s=o.getDataExtent("value"),l=i.getDataExtent("value"),u=r.get("repulsion"),c=r.get("edgeLength");M(u)||(u=[u,u]),M(c)||(c=[c,c]),c=[c[1],c[0]];var d,f=o.mapArray("value",(function(e,t){var n=o.getItemLayout(t),i=bl(e,s,u);return isNaN(i)&&(i=(u[0]+u[1])/2),{w:i,rep:i,fixed:o.getItemModel(t).get("fixed"),p:!n||isNaN(n[0])||isNaN(n[1])?null:n}})),h=i.mapArray("value",(function(t,o){var i=n.getEdgeByIndex(o),r=bl(t,l,c);isNaN(r)&&(r=(c[0]+c[1])/2);var a=i.getModel(),s=$(a.get("lineStyle.curveness"),-OC(i,e,o,!0),0);return{n1:f[i.node1.dataIndex],n2:f[i.node2.dataIndex],d:r,curveness:s,ignoreForceLayout:a.get("ignoreForceLayout")}})),g=(d=e.coordinateSystem).getBoundingRect(),m=function(e,t,n){for(var o=n.rect,i=o.width,r=o.height,a=[o.x+i/2,o.y+r/2],s=null==n.gravity?.1:n.gravity,l=0;l<e.length;l++){var u=e[l];u.p||(u.p=ie(i*(Math.random()-.5)+a[0],r*(Math.random()-.5)+a[1])),u.pp=ae(u.p),u.edges=null}var c=null==n.friction?.6:n.friction,d=c;return{warmUp:function(){d=.8*c},setFixed:function(t){e[t].fixed=!0},setUnfixed:function(t){e[t].fixed=!1},step:function(n){for(var o=[],i=e.length,r=0;r<t.length;r++){var l=t[r];if(!l.ignoreForceLayout){var u=l.n1;ce(o,(g=l.n2).p,u.p);var c=de(o)-l.d,f=g.w/(u.w+g.w);isNaN(f)&&(f=0),ge(o,o),u.fixed||gT(u.p,u.p,o,f*c*d),g.fixed||gT(g.p,g.p,o,-(1-f)*c*d)}}for(r=0;r<i;r++)(v=e[r]).fixed||(ce(o,a,v.p),gT(v.p,v.p,o,s*d));for(r=0;r<i;r++){u=e[r];for(var h=r+1;h<i;h++){var g;ce(o,(g=e[h]).p,u.p),0===(c=de(o))&&(se(o,Math.random()-.5,Math.random()-.5),c=1);var m=(u.rep+g.rep)/c/c;u.fixed||gT(u.pp,u.pp,o,m),g.fixed||gT(g.pp,g.pp,o,-m)}}var p=[];for(r=0;r<i;r++){var v;(v=e[r]).fixed||(ce(p,v.p,v.pp),gT(v.p,v.p,p,d),re(v.pp,v.p))}d*=.992,n&&n(e,t,d<.01)}}}(f,h,{rect:g,gravity:r.get("gravity"),friction:r.get("friction")}),p=m.step;m.step=function(e){for(var i=0,r=f.length;i<r;i++)f[i].fixed&&re(f[i].p,n.getNodeByIndex(i).getLayout());p((function(i,r,a){for(var s=0,l=i.length;s<l;s++)i[s].fixed||n.getNodeByIndex(s).setLayout(i[s].p),t[o.getId(s)]=i[s].p;for(s=0,l=r.length;s<l;s++){var u=r[s],c=n.getEdgeByIndex(s),d=u.n1.p,f=u.n2.p,h=c.getLayout();(h=h?h.slice():[])[0]=h[0]||[],h[1]=h[1]||[],re(h[0],d),re(h[1],f),+u.curveness&&(h[2]=[(d[0]+f[0])/2-(d[1]-f[1])*u.curveness,(d[1]+f[1])/2-(f[0]-d[0])*u.curveness]),c.setLayout(h)}e&&e(a)}))},e.forceLayout=m,e.preservedPoints=t,m.step()}else e.forceLayout=null}))})),nh("graphView",{create:function(e,t){var n=[];return e.eachSeriesByType("graph",(function(e){var o=e.get("coordinateSystem");if(!o||"view"===o){var i=e.getData(),r=[],a=[];Rr(i.mapArray((function(e){var t=i.getItemModel(e);return[+t.get("x"),+t.get("y")]})),r,a),a[0]-r[0]==0&&(a[0]+=1,r[0]-=1),a[1]-r[1]==0&&(a[1]+=1,r[1]-=1);var s=(a[0]-r[0])/(a[1]-r[1]),l=function(e,t,n){var o=e.getBoxLayoutParams();return o.aspect=n,au(o,{width:t.getWidth(),height:t.getHeight()})}(e,t,s);isNaN(s)&&(r=[l.x,l.y],a=[l.x+l.width,l.y+l.height]);var u=a[0]-r[0],c=a[1]-r[1],d=l.width,f=l.height,h=e.coordinateSystem=new Ky;h.zoomLimit=e.get("scaleLimit"),h.setBoundingRect(r[0],r[1],u,c),h.setViewRect(l.x,l.y,d,f),h.setCenter(e.get("center")),h.setZoom(e.get("zoom")),n.push(h)}})),n}}),Wc.extend({type:"series.gauge",getInitialData:function(e,t){return Tv(this,["value"])},defaultOption:{zlevel:0,z:2,center:["50%","50%"],legendHoverLink:!0,radius:"75%",startAngle:225,endAngle:-45,clockwise:!0,min:0,max:100,splitNumber:10,axisLine:{show:!0,lineStyle:{color:[[.2,"#91c7ae"],[.8,"#63869e"],[1,"#c23531"]],width:30}},splitLine:{show:!0,length:30,lineStyle:{color:"#eee",width:2,type:"solid"}},axisTick:{show:!0,splitNumber:5,length:8,lineStyle:{color:"#eee",width:1,type:"solid"}},axisLabel:{show:!0,distance:5,color:"auto"},pointer:{show:!0,length:"80%",width:8},itemStyle:{color:"auto"},title:{show:!0,offsetCenter:[0,"-40%"],color:"#333",fontSize:15},detail:{show:!0,backgroundColor:"rgba(0,0,0,0)",borderWidth:0,borderColor:"#ccc",width:100,height:null,padding:[5,10],offsetCenter:[0,"40%"],color:"auto",fontSize:30}}});var mT=ha.extend({type:"echartsGaugePointer",shape:{angle:0,width:10,r:10,x:0,y:0},buildPath:function(e,t){var n=Math.cos,o=Math.sin,i=t.r,r=t.width,a=t.angle,s=t.x-n(a)*r*(i/3<=r?1:2),l=t.y-o(a)*r*(i/3<=r?1:2);a=t.angle-Math.PI/2,e.moveTo(s,l),e.lineTo(t.x+n(a)*r,t.y+o(a)*r),e.lineTo(t.x+n(t.angle)*i,t.y+o(t.angle)*i),e.lineTo(t.x-n(a)*r,t.y-o(a)*r),e.lineTo(s,l)}});function pT(e,t){return t&&("string"==typeof t?e=t.replace("{value}",null!=e?e:""):"function"==typeof t&&(e=t(e))),e}var vT=2*Math.PI,yT=(nd.extend({type:"gauge",render:function(e,t,n){this.group.removeAll();var o=e.get("axisLine.lineStyle.color"),i=function(e,t){var n=e.get("center"),o=t.getWidth(),i=t.getHeight(),r=Math.min(o,i);return{cx:Cl(n[0],t.getWidth()),cy:Cl(n[1],t.getHeight()),r:Cl(e.get("radius"),r/2)}}(e,n);this._renderMain(e,t,n,o,i)},dispose:function(){},_renderMain:function(e,t,n,o,i){for(var r=this.group,a=e.getModel("axisLine"),s=a.getModel("lineStyle"),l=e.get("clockwise"),u=-e.get("startAngle")/180*Math.PI,c=((m=-e.get("endAngle")/180*Math.PI)-u)%vT,d=u,f=s.get("width"),h=a.get("show"),g=0;h&&g<o.length;g++){var m,p=Math.min(Math.max(o[g][0],0),1),v=new Ma({shape:{startAngle:d,endAngle:m=u+c*p,cx:i.cx,cy:i.cy,clockwise:l,r0:i.r-f,r:i.r},silent:!0});v.setStyle({fill:o[g][1]}),v.setStyle(s.getLineStyle(["color","borderWidth","borderColor"])),r.add(v),d=m}function y(e){if(e<=0)return o[0][1];for(var t=0;t<o.length;t++)if(o[t][0]>=e&&(0===t?0:o[t-1][0])<e)return o[t][1];return o[t-1][1]}if(!l){var b=u;u=m,m=b}this._renderTicks(e,t,n,y,i,u,m,l),this._renderPointer(e,t,n,y,i,u,m,l),this._renderTitle(e,t,n,y,i),this._renderDetail(e,t,n,y,i)},_renderTicks:function(e,t,n,o,i,r,a,s){for(var l=this.group,u=i.cx,c=i.cy,d=i.r,f=+e.get("min"),h=+e.get("max"),g=e.getModel("splitLine"),m=e.getModel("axisTick"),p=e.getModel("axisLabel"),v=e.get("splitNumber"),y=m.get("splitNumber"),b=Cl(g.get("length"),d),C=Cl(m.get("length"),d),T=r,x=(a-r)/v,E=x/y,_=g.getModel("lineStyle").getLineStyle(),I=m.getModel("lineStyle").getLineStyle(),D=0;D<=v;D++){var O=Math.cos(T),w=Math.sin(T);if(g.get("show")){var R=new ja({shape:{x1:O*d+u,y1:w*d+c,x2:O*(d-b)+u,y2:w*(d-b)+c},style:_,silent:!0});"auto"===_.stroke&&R.setStyle({stroke:o(D/v)}),l.add(R)}if(p.get("show")){var S=pT(Tl(D/v*(h-f)+f),p.get("formatter")),k=p.get("distance"),A=o(D/v);l.add(new Sa({style:Vs({},p,{text:S,x:O*(d-b-k)+u,y:w*(d-b-k)+c,textVerticalAlign:w<-.4?"top":.4<w?"bottom":"middle",textAlign:O<-.4?"left":.4<O?"right":"center"},{autoColor:A}),silent:!0}))}if(m.get("show")&&D!==v){for(var N=0;N<=y;N++){O=Math.cos(T),w=Math.sin(T);var M=new ja({shape:{x1:O*d+u,y1:w*d+c,x2:O*(d-C)+u,y2:w*(d-C)+c},silent:!0,style:I});"auto"===I.stroke&&M.setStyle({stroke:o((D+N/y)/v)}),l.add(M),T+=E}T-=E}else T+=x}},_renderPointer:function(e,t,n,o,i,r,a,s){var l=this.group,u=this._data;if(e.get("pointer.show")){var c=[+e.get("min"),+e.get("max")],d=[r,a],f=e.getData(),h=f.mapDimension("value");f.diff(u).add((function(t){var n=new mT({shape:{angle:r}});Ys(n,{shape:{angle:bl(f.get(h,t),c,d,!0)}},e),l.add(n),f.setItemGraphicEl(t,n)})).update((function(t,n){var o=u.getItemGraphicEl(n);Xs(o,{shape:{angle:bl(f.get(h,t),c,d,!0)}},e),l.add(o),f.setItemGraphicEl(t,o)})).remove((function(e){var t=u.getItemGraphicEl(e);l.remove(t)})).execute(),f.eachItemGraphicEl((function(e,t){var n=f.getItemModel(t),r=n.getModel("pointer");e.setShape({x:i.cx,y:i.cy,width:Cl(r.get("width"),i.r),r:Cl(r.get("length"),i.r)}),e.useStyle(n.getModel("itemStyle").getItemStyle()),"auto"===e.style.fill&&e.setStyle("fill",o(bl(f.get(h,t),c,[0,1],!0))),Ks(e,n.getModel("emphasis.itemStyle").getItemStyle())})),this._data=f}else u&&u.eachItemGraphicEl((function(e){l.remove(e)}))},_renderTitle:function(e,t,n,o,i){var r=e.getData(),a=r.mapDimension("value"),s=e.getModel("title");if(s.get("show")){var l=s.get("offsetCenter"),u=i.cx+Cl(l[0],i.r),c=i.cy+Cl(l[1],i.r),d=+e.get("min"),f=+e.get("max"),h=o(bl(e.getData().get(a,0),[d,f],[0,1],!0));this.group.add(new Sa({silent:!0,style:Vs({},s,{x:u,y:c,text:r.getName(0),textAlign:"center",textVerticalAlign:"middle"},{autoColor:h,forceRich:!0})}))}},_renderDetail:function(e,t,n,o,i){var r=e.getModel("detail"),a=+e.get("min"),s=+e.get("max");if(r.get("show")){var l=r.get("offsetCenter"),u=i.cx+Cl(l[0],i.r),c=i.cy+Cl(l[1],i.r),d=Cl(r.get("width"),i.r),f=Cl(r.get("height"),i.r),h=e.getData(),g=h.get(h.mapDimension("value"),0),m=o(bl(g,[a,s],[0,1],!0));this.group.add(new Sa({silent:!0,style:Vs({},r,{x:u,y:c,text:pT(g,r.get("formatter")),textWidth:isNaN(d)?null:d,textHeight:isNaN(f)?null:f,textAlign:"center",textVerticalAlign:"middle"},{autoColor:m,forceRich:!0})}))}}}),uh({type:"series.funnel",init:function(e){yT.superApply(this,"init",arguments),this.legendVisualProvider=new Ev(A(this.getData,this),A(this.getRawData,this)),this._defaultLabelLine(e)},getInitialData:function(e,t){return Tv(this,{coordDimensions:["value"],encodeDefaulter:N(Ku,this)})},_defaultLabelLine:function(e){wi(e,"labelLine",["show"]);var t=e.labelLine,n=e.emphasis.labelLine;t.show=t.show&&e.label.show,n.show=n.show&&e.emphasis.label.show},getDataParams:function(e){var t=this.getData(),n=yT.superCall(this,"getDataParams",e),o=t.mapDimension("value"),i=t.getSum(o);return n.percent=i?+(t.get(o,e)/i*100).toFixed(2):0,n.$vars.push("percent"),n},defaultOption:{zlevel:0,z:2,legendHoverLink:!0,left:80,top:60,right:80,bottom:60,minSize:"0%",maxSize:"100%",sort:"descending",orient:"vertical",gap:0,funnelAlign:"center",label:{show:!0,position:"outer"},labelLine:{show:!0,length:20,lineStyle:{width:1,type:"solid"}},itemStyle:{borderColor:"#fff",borderWidth:1},emphasis:{label:{show:!0}}}}));function bT(e,t){_n.call(this);var n=new Ba,o=new Fa,i=new Sa;this.add(n),this.add(o),this.add(i),this.highDownOnUpdate=function(e,t){"emphasis"===t?(o.ignore=o.hoverIgnore,i.ignore=i.hoverIgnore):(o.ignore=o.normalIgnore,i.ignore=i.normalIgnore)},this.updateData(e,t,!0)}var CT=bT.prototype,TT=["itemStyle","opacity"];function xT(e,t,n,o,i){pm.call(this,e,t,n),this.type=o||"value",this.axisIndex=i}function ET(e,t,n,o,i,r){e=e||0;var a=n[1]-n[0];if(null!=i&&(i=IT(i,[0,a])),null!=r&&(r=Math.max(r,null!=i?i:0)),"all"===o){var s=Math.abs(t[1]-t[0]);i=r=IT(s=IT(s,[0,a]),[i,r]),o=0}t[0]=IT(t[0],n),t[1]=IT(t[1],n);var l=_T(t,o);t[o]+=e;var u=i||0,c=n.slice();l.sign<0?c[0]+=u:c[1]-=u,t[o]=IT(t[o],c);var d=_T(t,o);return null!=i&&(d.sign!==l.sign||d.span<i)&&(t[1-o]=t[o]+l.sign*i),d=_T(t,o),null!=r&&d.span>r&&(t[1-o]=t[o]+d.sign*r),t}function _T(e,t){var n=e[t]-e[1-t];return{span:Math.abs(n),sign:0<n?-1:n<0?1:t?-1:1}}function IT(e,t){return Math.min(null!=t[1]?t[1]:1/0,Math.max(null!=t[0]?t[0]:-1/0,e))}CT.updateData=function(e,t,n){var o=this.childAt(0),i=e.hostModel,r=e.getItemModel(t),a=e.getItemLayout(t),s=e.getItemModel(t).get(TT);s=null==s?1:s,o.useStyle({}),n?(o.setShape({points:a.points}),o.setStyle({opacity:0}),Ys(o,{style:{opacity:s}},i,t)):Xs(o,{style:{opacity:s},shape:{points:a.points}},i,t);var l=r.getModel("itemStyle"),u=e.getItemVisual(t,"color");o.setStyle(C({lineJoin:"round",fill:u},l.getItemStyle(["opacity"]))),o.hoverStyle=l.getModel("emphasis").getItemStyle(),this._updateLabel(e,t),Ks(this)},CT._updateLabel=function(e,t){var n=this.childAt(1),o=this.childAt(2),i=e.hostModel,r=e.getItemModel(t),a=e.getItemLayout(t).label,s=e.getItemVisual(t,"color");Xs(n,{shape:{points:a.linePoints||a.linePoints}},i,t),Xs(o,{style:{x:a.x,y:a.y}},i,t),o.attr({rotation:a.rotation,origin:[a.x,a.y],z2:10});var l=r.getModel("label"),u=r.getModel("emphasis.label"),c=r.getModel("labelLine"),d=r.getModel("emphasis.labelLine");s=e.getItemVisual(t,"color"),Fs(o.style,o.hoverStyle={},l,u,{labelFetcher:e.hostModel,labelDataIndex:t,defaultText:e.getName(t),autoColor:s,useInsideStyle:!!a.inside},{textAlign:a.textAlign,textVerticalAlign:a.verticalAlign}),o.ignore=o.normalIgnore=!l.get("show"),o.hoverIgnore=!u.get("show"),n.ignore=n.normalIgnore=!c.get("show"),n.hoverIgnore=!d.get("show"),n.setStyle({stroke:s}),n.setStyle(c.getModel("lineStyle").getLineStyle()),n.hoverStyle=d.getModel("lineStyle").getLineStyle()},_(bT,_n),nd.extend({type:"funnel",render:function(e,t,n){var o=e.getData(),i=this._data,r=this.group;o.diff(i).add((function(e){var t=new bT(o,e);o.setItemGraphicEl(e,t),r.add(t)})).update((function(e,t){var n=i.getItemGraphicEl(t);n.updateData(o,e),r.add(n),o.setItemGraphicEl(e,n)})).remove((function(e){var t=i.getItemGraphicEl(e);r.remove(t)})).execute(),this._data=o},remove:function(){this.group.removeAll(),this._data=null},dispose:function(){}}),ih(Sv("funnel")),oh((function(e,t,n){e.eachSeriesByType("funnel",(function(e){var n=e.getData(),o=n.mapDimension("value"),i=e.get("sort"),r=function(e,t){return au(e.getBoxLayoutParams(),{width:t.getWidth(),height:t.getHeight()})}(e,t),a=function(e,t){for(var n=e.mapDimension("value"),o=e.mapArray(n,(function(e){return e})),i=[],r="ascending"===t,a=0,s=e.count();a<s;a++)i[a]=a;return"function"==typeof t?i.sort(t):"none"!==t&&i.sort((function(e,t){return r?o[e]-o[t]:o[t]-o[e]})),i}(n,i),s=e.get("orient"),l=r.width,u=r.height,c=r.x,d=r.y,f="horizontal"===s?[Cl(e.get("minSize"),u),Cl(e.get("maxSize"),u)]:[Cl(e.get("minSize"),l),Cl(e.get("maxSize"),l)],h=n.getDataExtent(o),g=e.get("min"),m=e.get("max");function p(e,t){if("horizontal"===s){var i,r=bl(n.get(o,e)||0,[g,m],f,!0);switch(v){case"top":i=d;break;case"center":i=d+(u-r)/2;break;case"bottom":i=d+(u-r)}return[[t,i],[t,i+r]]}var a,h=bl(n.get(o,e)||0,[g,m],f,!0);switch(v){case"left":a=c;break;case"center":a=c+(l-h)/2;break;case"right":a=c+l-h}return[[a,t],[a+h,t]]}null==g&&(g=Math.min(h[0],0)),null==m&&(m=h[1]);var v=e.get("funnelAlign"),y=e.get("gap"),b=(("horizontal"===s?l:u)-y*(n.count()-1))/n.count();"ascending"===i&&(b=-b,y=-y,"horizontal"===s?c+=l:d+=u,a=a.reverse());for(var C=0;C<a.length;C++){var T=a[C],x=a[C+1],E=n.getItemModel(T);if("horizontal"===s){var _=E.get("itemStyle.width");null==_?_=b:(_=Cl(_,l),"ascending"===i&&(_=-_));var I=p(T,c),D=p(x,c+_);c+=_+y,n.setItemLayout(T,{points:I.concat(D.slice().reverse())})}else{var O=E.get("itemStyle.height");null==O?O=b:(O=Cl(O,u),"ascending"===i&&(O=-O)),I=p(T,"horizontal"===s?c:d),D=p(x,"horizontal"===s?c+_:d+O),d+=O+y,n.setItemLayout(T,{points:I.concat(D.slice().reverse())})}}!function(e){e.each((function(t){var n,o,i,r,a=e.getItemModel(t),s=a.getModel("label").get("position"),l=a.get("orient"),u=a.getModel("labelLine"),c=e.getItemLayout(t),d=c.points,f="inner"===s||"inside"===s||"center"===s||"insideLeft"===s||"insideRight"===s;if(f)n="insideLeft"===s?(o=(d[0][0]+d[3][0])/2+5,i=(d[0][1]+d[3][1])/2,"left"):"insideRight"===s?(o=(d[1][0]+d[2][0])/2-5,i=(d[1][1]+d[2][1])/2,"right"):(o=(d[0][0]+d[1][0]+d[2][0]+d[3][0])/4,i=(d[0][1]+d[1][1]+d[2][1]+d[3][1])/4,"center"),r=[[o,i],[o,i]];else{var h,g,m,p,v=u.get("length");n="left"===s?(g=(d[3][1]+d[0][1])/2,o=(m=(h=(d[3][0]+d[0][0])/2)-v)-5,"right"):"right"===s?(g=(d[1][1]+d[2][1])/2,o=(m=(h=(d[1][0]+d[2][0])/2)+v)+5,"left"):"top"===s?(h=(d[3][0]+d[0][0])/2,i=(p=(g=(d[3][1]+d[0][1])/2)-v)-5,"center"):"bottom"===s?(h=(d[1][0]+d[2][0])/2,i=(p=(g=(d[1][1]+d[2][1])/2)+v)+5,"center"):"rightTop"===s?(h="horizontal"===l?d[3][0]:d[1][0],g="horizontal"===l?d[3][1]:d[1][1],"horizontal"===l?(i=(p=g-v)-5,"center"):(o=(m=h+v)+5,"top")):"rightBottom"===s?(h=d[2][0],g=d[2][1],"horizontal"===l?(i=(p=g+v)+5,"center"):(o=(m=h+v)+5,"bottom")):"leftTop"===s?(h=d[0][0],g="horizontal"===l?d[0][1]:d[1][1],"horizontal"===l?(i=(p=g-v)-5,"center"):(o=(m=h-v)-5,"right")):"leftBottom"===s?(h="horizontal"===l?d[1][0]:d[3][0],g="horizontal"===l?d[1][1]:d[2][1],"horizontal"===l?(i=(p=g+v)+5,"center"):(o=(m=h-v)-5,"right")):(h=(d[1][0]+d[2][0])/2,g=(d[1][1]+d[2][1])/2,"horizontal"===l?(i=(p=g+v)+5,"center"):(o=(m=h+v)+5,"left")),"horizontal"===l?o=m=h:i=p=g,r=[[h,g],[m,p]]}c.label={linePoints:r,x:o,y:i,verticalAlign:"middle",textAlign:n,inside:f}}))}(n)}))})),eh(Pv("funnel")),xT.prototype={constructor:xT,model:null,isHorizontal:function(){return"horizontal"!==this.coordinateSystem.getModel().get("layout")}},_(xT,pm);var DT=O,OT=Math.min,wT=Math.max,RT=Math.floor,ST=Math.ceil,kT=Tl,AT=Math.PI;function NT(e,t,n){this._axesMap=Q(),this._axesLayout={},this.dimensions=e.dimensions,this._model=e,this._init(e,t,n)}function MT(e,t){return OT(wT(e,t[0]),t[1])}NT.prototype={type:"parallel",constructor:NT,_init:function(e,t,n){var o=e.parallelAxisIndex;DT(e.dimensions,(function(e,n){var i=o[n],r=t.getComponent("parallelAxis",i),a=this._axesMap.set(e,new xT(e,Vg(r),[0,0],r.get("type"),i));a.onBand="category"===a.type&&r.get("boundaryGap"),a.inverse=r.get("inverse"),(r.axis=a).model=r,a.coordinateSystem=r.coordinateSystem=this}),this)},update:function(e,t){this._updateAxesFromSeries(this._model,e)},containPoint:function(e){var t=this._makeLayoutInfo(),n=t.axisBase,o=t.layoutBase,i=t.pixelDimIndex,r=e[1-i],a=e[i];return n<=r&&r<=n+t.axisLength&&o<=a&&a<=o+t.layoutLength},getModel:function(){return this._model},_updateAxesFromSeries:function(e,t){t.eachSeries((function(n){if(e.contains(n,t)){var o=n.getData();DT(this.dimensions,(function(e){var t=this._axesMap.get(e);t.scale.unionExtentFromData(o,o.mapDimension(e)),zg(t.scale,t.model)}),this)}}),this)},resize:function(e,t){this._rect=au(e.getBoxLayoutParams(),{width:t.getWidth(),height:t.getHeight()}),this._layoutAxes()},getRect:function(){return this._rect},_makeLayoutInfo:function(){var e,t=this._model,n=this._rect,o=["x","y"],i=["width","height"],r=t.get("layout"),a="horizontal"===r?0:1,s=n[i[a]],l=[0,s],u=this.dimensions.length,c=MT(t.get("axisExpandWidth"),l),d=MT(t.get("axisExpandCount")||0,[0,u]),f=t.get("axisExpandable")&&3<u&&d<u&&1<d&&0<c&&0<s,h=t.get("axisExpandWindow");h?(e=MT(h[1]-h[0],l),h[1]=h[0]+e):(e=MT(c*(d-1),l),(h=[c*(t.get("axisExpandCenter")||RT(u/2))-e/2])[1]=h[0]+e);var g=(s-e)/(u-d);g<3&&(g=0);var m=[RT(kT(h[0]/c,1))+1,ST(kT(h[1]/c,1))-1];return{layout:r,pixelDimIndex:a,layoutBase:n[o[a]],layoutLength:s,axisBase:n[o[1-a]],axisLength:n[i[1-a]],axisExpandable:f,axisExpandWidth:c,axisCollapseWidth:g,axisExpandWindow:h,axisCount:u,winInnerIndices:m,axisExpandWindow0Pos:g/c*h[0]}},_layoutAxes:function(){var e=this._rect,t=this._axesMap,n=this.dimensions,o=this._makeLayoutInfo(),i=o.layout;t.each((function(e){var t=[0,o.axisLength],n=e.inverse?1:0;e.setExtent(t[n],t[1-n])})),DT(n,(function(t,n){var r=(o.axisExpandable?function(e,t){var n,o,i=t.axisExpandWidth,r=t.axisCollapseWidth,a=t.winInnerIndices,s=r,l=!1;return e<a[0]?(n=e*r,o=r):e<=a[1]?(n=t.axisExpandWindow0Pos+e*i-t.axisExpandWindow[0],s=i,l=!0):(n=t.layoutLength-(t.axisCount-1-e)*r,o=r),{position:n,axisNameAvailableWidth:s,axisLabelShow:l,nameTruncateMaxWidth:o}}:function(e,t){var n=t.layoutLength/(t.axisCount-1);return{position:n*e,axisNameAvailableWidth:n,axisLabelShow:!0}})(n,o),a={horizontal:{x:r.position,y:o.axisLength},vertical:{x:0,y:r.position}},s=[a[i].x+e.x,a[i].y+e.y],l={horizontal:AT/2,vertical:0}[i],u=ot();lt(u,u,l),st(u,u,s),this._axesLayout[t]={position:s,rotation:l,transform:u,axisNameAvailableWidth:r.axisNameAvailableWidth,axisLabelShow:r.axisLabelShow,nameTruncateMaxWidth:r.nameTruncateMaxWidth,tickDirection:1,labelDirection:1}}),this)},getAxis:function(e){return this._axesMap.get(e)},dataToPoint:function(e,t){return this.axisCoordToPoint(this._axesMap.get(t).dataToCoord(e),t)},eachActiveState:function(e,t,n,o){null==n&&(n=0),null==o&&(o=e.count());var i=this._axesMap,r=this.dimensions,a=[],s=[];O(r,(function(t){a.push(e.mapDimension(t)),s.push(i.get(t).model)}));for(var l=this.hasAxisBrushed(),u=n;u<o;u++){var c;if(l){c="active";for(var d=e.getValues(a,u),f=0,h=r.length;f<h;f++)if("inactive"===s[f].getActiveState(d[f])){c="inactive";break}}else c="normal";t(c,u)}},hasAxisBrushed:function(){for(var e=this.dimensions,t=this._axesMap,n=!1,o=0,i=e.length;o<i;o++)"normal"!==t.get(e[o]).model.getActiveState()&&(n=!0);return n},axisCoordToPoint:function(e,t){return Js([e,0],this._axesLayout[t].transform)},getAxisLayout:function(e){return p(this._axesLayout[e])},getSlidedAxisExpandWindow:function(e){var t=this._makeLayoutInfo(),n=t.pixelDimIndex,o=t.axisExpandWindow.slice(),i=o[1]-o[0],r=[0,t.axisExpandWidth*(t.axisCount-1)];if(!this.containPoint(e))return{behavior:"none",axisExpandWindow:o};var a,s=e[n]-t.layoutBase-t.axisExpandWindow0Pos,l="slide",u=t.axisCollapseWidth,c=this._model.get("axisExpandSlideTriggerArea"),d=null!=c[0];return u?(d&&u&&s<i*c[0]?(l="jump",a=s-i*c[2]):d&&u&&s>i*(1-c[0])?(l="jump",a=s-i*(1-c[2])):0<=(a=s-i*c[1])&&(a=s-i*(1-c[1]))<=0&&(a=0),(a*=t.axisExpandWidth/u)?ET(a,o,r,"all"):l="none"):((o=[wT(0,r[1]*s/(i=o[1]-o[0])-i/2)])[1]=OT(r[1],o[0]+i),o[0]=o[1]-i),{axisExpandWindow:o,behavior:l}}},Uu.register("parallel",{create:function(e,t){var n=[];return e.eachComponent("parallel",(function(o,i){var r=new NT(o,e,t);r.name="parallel_"+i,r.resize(o,t),(o.coordinateSystem=r).model=o,n.push(r)})),e.eachSeries((function(t){if("parallel"===t.get("coordinateSystem")){var n=e.queryComponents({mainType:"parallel",index:t.get("parallelIndex"),id:t.get("parallelId")})[0];t.coordinateSystem=n.coordinateSystem}})),n}});var KT=mu.extend({type:"baseParallelAxis",axis:null,activeIntervals:[],getAreaSelectStyle:function(){return Zi([["fill","color"],["lineWidth","borderWidth"],["stroke","borderColor"],["width","width"],["opacity","opacity"]])(this.getModel("areaSelectStyle"))},setActiveIntervals:function(e){var t=this.activeIntervals=p(e);if(t)for(var n=t.length-1;0<=n;n--)xl(t[n])},getActiveState:function(e){var t=this.activeIntervals;if(!t.length)return"normal";if(null==e||isNaN(e))return"inactive";if(1===t.length){var n=t[0];if(n[0]<=e&&e<=n[1])return"active"}else for(var o=0,i=t.length;o<i;o++)if(t[o][0]<=e&&e<=t[o][1])return"active";return"inactive"}});v(KT.prototype,qg),mp("parallel",KT,(function(e,t){return t.type||(t.data?"category":"value")}),{type:"value",dim:null,areaSelectStyle:{width:20,borderWidth:1,borderColor:"rgba(160,197,232)",color:"rgba(160,197,232)",opacity:.3},realtime:!0,z:10}),mu.extend({type:"parallel",dependencies:["parallelAxis"],coordinateSystem:null,dimensions:null,parallelAxisIndex:null,layoutMode:"box",defaultOption:{zlevel:0,z:0,left:80,top:60,right:80,bottom:60,layout:"horizontal",axisExpandable:!1,axisExpandCenter:null,axisExpandCount:0,axisExpandWidth:50,axisExpandRate:17,axisExpandDebounce:50,axisExpandSlideTriggerArea:[-.15,.05,.4],axisExpandTriggerOn:"click",parallelAxisDefault:null},init:function(){mu.prototype.init.apply(this,arguments),this.mergeOption({})},mergeOption:function(e){e&&v(this.option,e,!0),this._initDimensions()},contains:function(e,t){var n=e.get("parallelIndex");return null!=n&&t.getComponent("parallel",n)===this},setAxisExpand:function(e){O(["axisExpandable","axisExpandCenter","axisExpandCount","axisExpandWidth","axisExpandWindow"],(function(t){e.hasOwnProperty(t)&&(this.option[t]=e[t])}),this)},_initDimensions:function(){var e=this.dimensions=[],t=this.parallelAxisIndex=[];O(S(this.dependentModels.parallelAxis,(function(e){return(e.get("parallelIndex")||0)===this.componentIndex}),this),(function(n){e.push("dim"+n.get("dim")),t.push(n.componentIndex)}))}}),th({type:"axisAreaSelect",event:"axisAreaSelected"},(function(e,t){t.eachComponent({mainType:"parallelAxis",query:e},(function(t){t.axis.model.setActiveIntervals(e.intervals)}))})),th("parallelAxisExpand",(function(e,t){t.eachComponent({mainType:"parallel",query:e},(function(t){t.setAxisExpand(e)}))}));var PT=N,LT=O,BT=w,FT=Math.min,zT=Math.max,VT=Math.pow,HT={w:[0,0],e:[0,1],n:[1,0],s:[1,1]},WT={w:"ew",e:"ew",n:"ns",s:"ns",ne:"nesw",sw:"nesw",nw:"nwse",se:"nwse"},$T={brushStyle:{lineWidth:2,stroke:"rgba(0,0,0,0.3)",fill:"rgba(0,0,0,0.1)"},transformable:!0,brushMode:"single",removeOnClick:!1},UT=0;function qT(e){Oe.call(this),this._zr=e,this.group=new _n,this._track=[],this._covers=[],this._uid="brushController_"+UT++,this._handlers={},LT(yx,(function(e,t){this._handlers[t]=A(e,this)}),this)}function jT(e,t){var n=Cx[t.brushType].createCover(e,t);return n.__brushOption=t,YT(n,t),e.group.add(n),n}function GT(e,t){var n=JT(t);return n.endCreating&&(n.endCreating(e,t),YT(t,t.__brushOption)),t}function XT(e,t){var n=t.__brushOption;JT(t).updateCoverShape(e,t,n.range,n)}function YT(e,t){var n=t.z;null==n&&(n=1e4),e.traverse((function(e){e.z=n,e.z2=n}))}function ZT(e,t){JT(t).updateCommon(e,t),XT(e,t)}function JT(e){return Cx[e.__brushOption.brushType]}function QT(e,t,n){var o,i=e._panels;if(!i)return!0;var r=e._transform;return LT(i,(function(e){e.isTargetByCursor(t,n,r)&&(o=e)})),o}function ex(e,t){var n=e._panels;if(!n)return!0;var o=t.__brushOption.panelId;return null==o||n[o]}function tx(e){var t=e._covers,n=t.length;return LT(t,(function(t){e.group.remove(t)}),e),t.length=0,!!n}function nx(e,t){var n=BT(e._covers,(function(e){var t=e.__brushOption,n=p(t.range);return{brushType:t.brushType,panelId:t.panelId,range:n}}));e.trigger("brush",n,{isEnd:!!t.isEnd,removeOnClick:!!t.removeOnClick})}function ox(e){var t=e.length-1;return t<0&&(t=0),[e[0],e[t]]}function ix(e,t,n,o){var i=new _n;return i.add(new Ua({name:"main",style:lx(n),silent:!0,draggable:!0,cursor:"move",drift:PT(e,t,i,"nswe"),ondragend:PT(nx,t,{isEnd:!0})})),LT(o,(function(n){i.add(new Ua({name:n,style:{opacity:0},draggable:!0,silent:!0,invisible:!0,drift:PT(e,t,i,n),ondragend:PT(nx,t,{isEnd:!0})}))})),i}function rx(e,t,n,o){var i=o.brushStyle.lineWidth||0,r=zT(i,6),a=n[0][0],s=n[1][0],l=a-i/2,u=s-i/2,c=n[0][1],d=n[1][1],f=c-r+i/2,h=d-r+i/2,g=c-a,m=d-s,p=g+i,v=m+i;sx(e,t,"main",a,s,g,m),o.transformable&&(sx(e,t,"w",l,u,r,v),sx(e,t,"e",f,u,r,v),sx(e,t,"n",l,u,p,r),sx(e,t,"s",l,h,p,r),sx(e,t,"nw",l,u,r,r),sx(e,t,"ne",f,u,r,r),sx(e,t,"sw",l,h,r,r),sx(e,t,"se",f,h,r,r))}function ax(e,t){var n=t.__brushOption,o=n.transformable,i=t.childAt(0);i.useStyle(lx(n)),i.attr({silent:!o,cursor:o?"move":"default"}),LT(["w","e","n","s","se","sw","ne","nw"],(function(n){var i=t.childOfName(n),r=function e(t,n){return 1<n.length?("e"!==(o=[e(t,(n=n.split(""))[0]),e(t,n[1])])[0]&&"w"!==o[0]||o.reverse(),o.join("")):{left:"w",right:"e",top:"n",bottom:"s"}[o=Qs({w:"left",e:"right",n:"top",s:"bottom"}[n],Zs(t.group))];var o}(e,n);i&&i.attr({silent:!o,invisible:!o,cursor:o?WT[r]+"-resize":null})}))}function sx(e,t,n,o,i,r,a){var s=t.childOfName(n);s&&s.setShape(function(e){var t=FT(e[0][0],e[1][0]),n=FT(e[0][1],e[1][1]);return{x:t,y:n,width:zT(e[0][0],e[1][0])-t,height:zT(e[0][1],e[1][1])-n}}(hx(e,t,[[o,i],[o+r,i+a]])))}function lx(e){return C({strokeNoScale:!0},e.brushStyle)}function ux(e,t,n,o){var i=[FT(e,n),FT(t,o)],r=[zT(e,n),zT(t,o)];return[[i[0],r[0]],[i[1],r[1]]]}function cx(e,t,n,o,i,r,a,s){var l=o.__brushOption,u=e(l.range),c=fx(n,r,a);LT(i.split(""),(function(e){var t=HT[e];u[t[0]][t[1]]+=c[t[0]]})),l.range=t(ux(u[0][0],u[1][0],u[0][1],u[1][1])),ZT(n,o),nx(n,{isEnd:!1})}function dx(e,t,n,o,i){var r=t.__brushOption.range,a=fx(e,n,o);LT(r,(function(e){e[0]+=a[0],e[1]+=a[1]})),ZT(e,t),nx(e,{isEnd:!1})}function fx(e,t,n){var o=e.group,i=o.transformCoordToLocal(t,n),r=o.transformCoordToLocal(0,0);return[i[0]-r[0],i[1]-r[1]]}function hx(e,t,n){var o=ex(e,t);return o&&!0!==o?o.clipPath(n,e._transform):p(n)}function gx(e){var t=e.event;t.preventDefault&&t.preventDefault()}function mx(e,t,n){return e.childOfName("main").contain(t,n)}function px(e,t,n,o){var i,r=e._creatingCover,a=e._creatingPanel,s=e._brushOption;if(e._track.push(n.slice()),function(e){var t=e._track;if(!t.length)return!1;var n=t[t.length-1],o=t[0],i=n[0]-o[0],r=n[1]-o[1];return 6<VT(i*i+r*r,.5)}(e)||r){if(a&&!r){"single"===s.brushMode&&tx(e);var l=p(s);l.brushType=vx(l.brushType,a),l.panelId=!0===a?null:a.panelId,r=e._creatingCover=jT(e,l),e._covers.push(r)}if(r){var u=Cx[vx(e._brushType,a)];r.__brushOption.range=u.getCreatingRange(hx(e,r,e._track)),o&&(GT(e,r),u.updateCommon(e,r)),XT(e,r),i={isEnd:o}}}else o&&"single"===s.brushMode&&s.removeOnClick&&QT(e,t,n)&&tx(e)&&(i={isEnd:o,removeOnClick:!0});return i}function vx(e,t){return"auto"===e?t.defaultBrushType:e}qT.prototype={constructor:qT,enableBrush:function(e){return this._brushType&&function(e){var t=e._zr;(function(e,t,n){var o=dy(e);o[t]===n&&(o[t]=null)})(t,"globalPan",e._uid),function(e,t){LT(t,(function(t,n){e.off(n,t)}))}(t,e._handlers),e._brushType=e._brushOption=null}(this),e.brushType&&function(e,t){var n=e._zr;e._enableGlobalPan||function(e,t,n){dy(e).globalPan=n}(n,0,e._uid),function(e,t){LT(t,(function(t,n){e.on(n,t)}))}(n,e._handlers),e._brushType=t.brushType,e._brushOption=v(p($T),t,!0)}(this,e),this},setPanels:function(e){if(e&&e.length){var t=this._panels={};O(e,(function(e){t[e.panelId]=p(e)}))}else this._panels=null;return this},mount:function(e){this._enableGlobalPan=(e=e||{}).enableGlobalPan;var t=this.group;return this._zr.add(t),t.attr({position:e.position||[0,0],rotation:e.rotation||0,scale:e.scale||[1,1]}),this._transform=t.getLocalTransform(),this},eachCover:function(e,t){LT(this._covers,e,t)},updateCovers:function(e){e=w(e,(function(e){return v(p($T),e,!0)}));var t=this._covers,n=this._covers=[],o=this,i=this._creatingCover;return new fh(t,e,(function(e,t){return r(e.__brushOption,t)}),r).add(a).update(a).remove((function(e){t[e]!==i&&o.group.remove(t[e])})).execute(),this;function r(e,t){return(null!=e.id?e.id:"\0-brush-index-"+t)+"-"+e.brushType}function a(r,a){var s=e[r];if(null!=a&&t[a]===i)n[r]=t[a];else{var l=n[r]=null!=a?(t[a].__brushOption=s,t[a]):GT(o,jT(o,s));ZT(o,l)}}},unmount:function(){return this.enableBrush(!1),tx(this),this._zr.remove(this.group),this},dispose:function(){this.unmount(),this.off()}},I(qT,Oe);var yx={mousedown:function(e){if(this._dragging)bx(this,e);else if(!e.target||!e.target.draggable){gx(e);var t=this.group.transformCoordToLocal(e.offsetX,e.offsetY);this._creatingCover=null,(this._creatingPanel=QT(this,e,t))&&(this._dragging=!0,this._track=[t.slice()])}},mousemove:function(e){var t=this.group.transformCoordToLocal(e.offsetX,e.offsetY);if(function(e,t,n){if(e._brushType&&!function(e,t,n){var o=e._zr;return t<0||t>o.getWidth()||void 0>o.getHeight()}(e,t)){var o=e._zr,i=e._covers,r=QT(e,t,n);if(!e._dragging)for(var a=0;a<i.length;a++){var s=i[a].__brushOption;if(r&&(!0===r||s.panelId===r.panelId)&&Cx[s.brushType].contain(i[a],n[0],n[1]))return}r&&o.setCursorStyle("crosshair")}}(this,e,t),this._dragging){gx(e);var n=px(this,e,t,!1);n&&nx(this,n)}},mouseup:function(e){bx(this,e)}};function bx(e,t){if(e._dragging){gx(t);var n=e.group.transformCoordToLocal(t.offsetX,t.offsetY),o=px(e,t,n,!0);e._dragging=!1,e._track=[],e._creatingCover=null,o&&nx(e,o)}}var Cx={lineX:Tx(0),lineY:Tx(1),rect:{createCover:function(e,t){return ix(PT(cx,(function(e){return e}),(function(e){return e})),e,t,["w","e","n","s","se","sw","ne","nw"])},getCreatingRange:function(e){var t=ox(e);return ux(t[1][0],t[1][1],t[0][0],t[0][1])},updateCoverShape:function(e,t,n,o){rx(e,t,n,o)},updateCommon:ax,contain:mx},polygon:{createCover:function(e,t){var n=new _n;return n.add(new Fa({name:"main",style:lx(t),silent:!0})),n},getCreatingRange:function(e){return e},endCreating:function(e,t){t.remove(t.childAt(0)),t.add(new Ba({name:"main",draggable:!0,drift:PT(dx,e,t),ondragend:PT(nx,e,{isEnd:!0})}))},updateCoverShape:function(e,t,n,o){t.childAt(0).setShape({points:hx(e,t,n)})},updateCommon:ax,contain:mx}};function Tx(e){return{createCover:function(t,n){return ix(PT(cx,(function(t){var n=[t,[0,100]];return e&&n.reverse(),n}),(function(t){return t[e]})),t,n,[["w","e"],["n","s"]][e])},getCreatingRange:function(t){var n=ox(t);return[FT(n[0][e],n[1][e]),zT(n[0][e],n[1][e])]},updateCoverShape:function(t,n,o,i){var r,a=ex(t,n);if(!0!==a&&a.getLinearBrushOtherExtent)r=a.getLinearBrushOtherExtent(e,t._transform);else{var s=t._zr;r=[0,[s.getWidth(),s.getHeight()][1-e]]}var l=[o,r];e&&l.reverse(),rx(t,n,l,i)},updateCommon:ax,contain:mx}}function xx(e){return e=Ix(e),function(t,n){return tl(t,e)}}function Ex(e,t){return e=Ix(e),function(n){var o=null!=t?t:n,i=o?e.x:e.y;return[i,i+((o?e.width:e.height)||0)]}}function _x(e,t,n){return e=Ix(e),function(o,i,r){return e.contain(i[0],i[1])&&!_y(o,t,n)}}function Ix(e){return En.create(e)}var Dx=["axisLine","axisTickLabel","axisName"],Ox=lh({type:"parallelAxis",init:function(e,t){Ox.superApply(this,"init",arguments),(this._brushController=new qT(t.getZr())).on("brush",A(this._onBrush,this))},render:function(e,t,n,o){if(!function(e,t,n){return n&&"axisAreaSelect"===n.type&&t.findComponents({mainType:"parallelAxis",query:n})[0]===e}(e,t,o)){this.axisModel=e,this.api=n,this.group.removeAll();var i=this._axisGroup;if(this._axisGroup=new _n,this.group.add(this._axisGroup),e.get("show")){var r=function(e,t){return t.getComponent("parallel",e.get("parallelIndex"))}(e,t),a=r.coordinateSystem,s=e.getAreaSelectStyle(),l=s.width,u=b({strokeContainThreshold:l},a.getAxisLayout(e.axis.dim)),c=new wp(e,u);O(Dx,c.add,c),this._axisGroup.add(c.getGroup()),this._refreshBrushController(u,s,e,r,l,n),el(i,this._axisGroup,o&&!1===o.animation?null:e)}}},_refreshBrushController:function(e,t,n,o,i,r){var a=n.axis.getExtent(),s=a[1]-a[0],l=Math.min(30,.1*Math.abs(s)),u=En.create({x:a[0],y:-i/2,width:s,height:i});u.x-=l,u.width+=2*l,this._brushController.mount({enableGlobalPan:!0,rotation:e.rotation,position:e.position}).setPanels([{panelId:"pl",clipPath:xx(u),isTargetByCursor:_x(u,r,o),getLinearBrushOtherExtent:Ex(u,0)}]).enableBrush({brushType:"lineX",brushStyle:t,removeOnClick:!0}).updateCovers(function(e){var t=e.axis;return w(e.activeIntervals,(function(e){return{brushType:"lineX",panelId:"pl",range:[t.dataToCoord(e[0],!0),t.dataToCoord(e[1],!0)]}}))}(n))},_onBrush:function(e,t){var n=this.axisModel,o=n.axis,i=w(e,(function(e){return[o.coordToData(e.range[0],!0),o.coordToData(e.range[1],!0)]}));!n.option.realtime!==t.isEnd&&!t.removeOnClick||this.api.dispatchAction({type:"axisAreaSelect",parallelAxisId:n.id,intervals:i})},dispose:function(){this._brushController.dispose()}});lh({type:"parallel",render:function(e,t,n){this._model=e,this._api=n,this._handlers||(this._handlers={},O(Rx,(function(e,t){n.getZr().on(t,this._handlers[t]=A(e,this))}),this)),hd(this,"_throttledDispatchExpand",e.get("axisExpandRate"),"fixRate")},dispose:function(e,t){O(this._handlers,(function(e,n){t.getZr().off(n,e)})),this._handlers=null},_throttledDispatchExpand:function(e){this._dispatchExpand(e)},_dispatchExpand:function(e){e&&this._api.dispatchAction(b({type:"parallelAxisExpand"},e))}});var Rx={mousedown:function(e){Sx(this,"click")&&(this._mouseDownPoint=[e.offsetX,e.offsetY])},mouseup:function(e){var t=this._mouseDownPoint;if(Sx(this,"click")&&t){var n=[e.offsetX,e.offsetY];if(5<Math.pow(t[0]-n[0],2)+Math.pow(t[1]-n[1],2))return;var o=this._model.coordinateSystem.getSlidedAxisExpandWindow([e.offsetX,e.offsetY]);"none"!==o.behavior&&this._dispatchExpand({axisExpandWindow:o.axisExpandWindow})}this._mouseDownPoint=null},mousemove:function(e){if(!this._mouseDownPoint&&Sx(this,"mousemove")){var t=this._model,n=t.coordinateSystem.getSlidedAxisExpandWindow([e.offsetX,e.offsetY]),o=n.behavior;"jump"===o&&this._throttledDispatchExpand.debounceNextCall(t.get("axisExpandDebounce")),this._throttledDispatchExpand("none"===o?null:{axisExpandWindow:n.axisExpandWindow,animation:"jump"===o&&null})}}};function Sx(e,t){var n=e._model;return n.get("axisExpandable")&&n.get("axisExpandTriggerOn")===t}function kx(e,t,n,o){for(var i,r=[],a=0;a<n.length;a++){var s=n[a],l=e.get(e.mapDimension(s),t);i=l,("category"===o.getAxis(s).type?null==i:null==i||isNaN(i))||r.push(o.dataToPoint(l,s))}return r}function Ax(e,t,n,o,i){var r=kx(e,n,o,i),a=new Fa({shape:{points:r},silent:!0,z2:10});return t.add(a),e.setItemGraphicEl(n,a),a}function Nx(e){var t=e.get("smooth",!0);return!0===t&&(t=.3),{lineStyle:e.getModel("lineStyle").getLineStyle(),smooth:null!=t?t:.3}}function Mx(e,t,n,o){var i=o.lineStyle;t.hasItemOption&&(i=t.getItemModel(n).getModel("lineStyle").getLineStyle()),e.useStyle(i);var r=e.style;r.fill=null,r.stroke=t.getItemVisual(n,"color"),r.opacity=t.getItemVisual(n,"opacity"),o.smooth&&(e.shape.smooth=o.smooth)}Qf((function(e){!function(e){if(!e.parallel){var t=!1;O(e.series,(function(e){e&&"parallel"===e.type&&(t=!0)})),t&&(e.parallel=[{}])}}(e),function(e){O(Oi(e.parallelAxis),(function(t){if(L(t)){var n=t.parallelIndex||0,o=Oi(e.parallel)[n];o&&o.parallelAxisDefault&&v(t,o.parallelAxisDefault,!1)}}))}(e)})),Wc.extend({type:"series.parallel",dependencies:["parallel"],visualColorAccessPath:"lineStyle.color",getInitialData:function(e,t){var n=this.getSource();return function(e,t){if(!e.encodeDefine){var n=t.ecModel.getComponent("parallel",t.get("parallelIndex"));if(n){var o=e.encodeDefine=Q();O(n.dimensions,(function(e){var t=function(e){return+e.replace("dim","")}(e);o.set(e,t)}))}}}(n,this),Xh(n,this)},getRawIndicesByActiveState:function(e){var t=this.coordinateSystem,n=this.getData(),o=[];return t.eachActiveState(n,(function(t,i){e===t&&o.push(n.getRawIndex(i))})),o},defaultOption:{zlevel:0,z:2,coordinateSystem:"parallel",parallelIndex:0,label:{show:!1},inactiveOpacity:.05,activeOpacity:1,lineStyle:{width:1,opacity:.45,type:"solid"},emphasis:{label:{show:!1}},progressive:500,smooth:!1,animationEasing:"linear"}}),nd.extend({type:"parallel",init:function(){this._dataGroup=new _n,this.group.add(this._dataGroup)},render:function(e,t,n,o){var i=this._dataGroup,r=e.getData(),a=this._data,s=e.coordinateSystem,l=s.dimensions,u=Nx(e);if(r.diff(a).add((function(e){Mx(Ax(r,i,e,l,s),r,e,u)})).update((function(t,n){var i=a.getItemGraphicEl(n),c=kx(r,t,l,s);r.setItemGraphicEl(t,i),Xs(i,{shape:{points:c}},o&&!1===o.animation?null:e,t),Mx(i,r,t,u)})).remove((function(e){var t=a.getItemGraphicEl(e);i.remove(t)})).execute(),!this._initialized){this._initialized=!0;var c=function(e,t,n){var o=e.model,i=e.getRect(),r=new Ua({shape:{x:i.x,y:i.y,width:i.width,height:i.height}}),a="horizontal"===o.get("layout")?"width":"height";return r.setShape(a,0),Ys(r,{shape:{width:i.width,height:i.height}},t,n),r}(s,e,(function(){setTimeout((function(){i.removeClipPath()}))}));i.setClipPath(c)}this._data=r},incrementalPrepareRender:function(e,t,n){this._initialized=!0,this._data=null,this._dataGroup.removeAll()},incrementalRender:function(e,t,n){for(var o=t.getData(),i=t.coordinateSystem,r=i.dimensions,a=Nx(t),s=e.start;s<e.end;s++){var l=Ax(o,this._dataGroup,s,r,i);l.incremental=!0,Mx(l,o,s,a)}},dispose:function(){},remove:function(){this._dataGroup&&this._dataGroup.removeAll(),this._data=null}});var Kx=["lineStyle","normal","opacity"];ih({seriesType:"parallel",reset:function(e,t,n){var o=e.getModel("itemStyle"),i=e.getModel("lineStyle"),r=t.get("color"),a=i.get("color")||o.get("color")||r[e.seriesIndex%r.length],s=e.get("inactiveOpacity"),l=e.get("activeOpacity"),u=e.getModel("lineStyle").getLineStyle(),c=e.coordinateSystem,d=e.getData(),f={normal:u.opacity,active:l,inactive:s};return d.setVisual("color",a),{progress:function(e,t){c.eachActiveState(t,(function(e,n){var o=f[e];if("normal"===e&&t.hasItemOption){var i=t.getItemModel(n).get(Kx,!0);null!=i&&(o=i)}t.setItemVisual(n,"opacity",o)}),e.start,e.end)}}}});var Px=Wc.extend({type:"series.sankey",layoutInfo:null,levelModels:null,getInitialData:function(e,t){for(var n=e.edges||e.links,o=e.data||e.nodes,i=e.levels,r=this.levelModels={},a=0;a<i.length;a++)null!=i[a].depth&&0<=i[a].depth&&(r[i[a].depth]=new hl(i[a],this,t));if(o&&n)return CC(o,n,this,!0,(function(e,t){e.wrapMethod("getItemModel",(function(e,t){return e.customizeGetParent((function(e){var n=this.parentModel,o=n.getData().getItemLayout(t).depth;return n.levelModels[o]||this.parentModel})),e})),t.wrapMethod("getItemModel",(function(e,t){return e.customizeGetParent((function(e){var n=this.parentModel,o=n.getGraph().getEdgeByIndex(t).node1.getLayout().depth;return n.levelModels[o]||this.parentModel})),e}))})).data},setNodePosition:function(e,t){var n=this.option.data[e];n.localX=t[0],n.localY=t[1]},getGraph:function(){return this.getData().graph},getEdgeData:function(){return this.getGraph().edgeData},formatTooltip:function(e,t,n){if("edge"===n){var o=this.getDataParams(e,n),i=o.data,r=i.source+" -- "+i.target;return o.value&&(r+=" : "+o.value),Wl(r)}if("node"!==n)return Px.superCall(this,"formatTooltip",e,t);var a=this.getGraph().getNodeByIndex(e).getLayout().value,s=this.getDataParams(e,n).data.name;return a&&(r=s+" : "+a),Wl(r)},optionUpdated:function(){var e=this.option;!0===e.focusNodeAdjacency&&(e.focusNodeAdjacency="allEdges")},getDataParams:function(e,t){var n=Px.superCall(this,"getDataParams",e,t);if(null==n.value&&"node"===t){var o=this.getGraph().getNodeByIndex(e).getLayout().value;n.value=o}return n},defaultOption:{zlevel:0,z:2,coordinateSystem:"view",layout:null,left:"5%",top:"5%",right:"20%",bottom:"5%",orient:"horizontal",nodeWidth:20,nodeGap:8,draggable:!0,focusNodeAdjacency:!1,layoutIterations:32,label:{show:!0,position:"right",color:"#000",fontSize:12},levels:[],nodeAlign:"justify",itemStyle:{borderWidth:1,borderColor:"#333"},lineStyle:{color:"#314656",opacity:.2,curveness:.5},emphasis:{label:{show:!0},lineStyle:{opacity:.5}},animationEasing:"linear",animationDuration:1e3}}),Lx=["itemStyle","opacity"],Bx=["emphasis","itemStyle","opacity"],Fx=["lineStyle","opacity"],zx=["emphasis","lineStyle","opacity"];function Vx(e,t){return e.getVisual("opacity")||e.getModel().get(t)}function Hx(e,t,n){var o=e.getGraphicEl(),i=Vx(e,t);null!=n&&(null==i&&(i=1),i*=n),o.downplay&&o.downplay(),o.traverse((function(e){"group"!==e.type&&e.setStyle("opacity",i)}))}function Wx(e,t){var n=Vx(e,t),o=e.getGraphicEl();o.traverse((function(e){"group"!==e.type&&e.setStyle("opacity",n)})),o.highlight&&o.highlight()}var $x=hs({shape:{x1:0,y1:0,x2:0,y2:0,cpx1:0,cpy1:0,cpx2:0,cpy2:0,extent:0,orient:""},buildPath:function(e,t){var n=t.extent;e.moveTo(t.x1,t.y1),e.bezierCurveTo(t.cpx1,t.cpy1,t.cpx2,t.cpy2,t.x2,t.y2),"vertical"===t.orient?(e.lineTo(t.x2+n,t.y2),e.bezierCurveTo(t.cpx2+n,t.cpy2,t.cpx1+n,t.cpy1,t.x1+n,t.y1)):(e.lineTo(t.x2,t.y2+n),e.bezierCurveTo(t.cpx2,t.cpy2+n,t.cpx1,t.cpy1+n,t.x1,t.y1+n)),e.closePath()},highlight:function(){this.trigger("emphasis")},downplay:function(){this.trigger("normal")}});function Ux(e){var t=e.hostGraph.data.getRawDataItem(e.dataIndex);return null!=t.depth&&0<=t.depth}function qx(e,t,n,o,i){var r="vertical"===i?"x":"y";O(e,(function(e){var a,s,l;e.sort((function(e,t){return e.getLayout()[r]-t.getLayout()[r]}));for(var u=0,c=e.length,d="vertical"===i?"dx":"dy",f=0;f<c;f++)0<(l=u-(s=e[f]).getLayout()[r])&&(a=s.getLayout()[r]+l,s.setLayout("vertical"===i?{x:a}:{y:a},!0)),u=s.getLayout()[r]+s.getLayout()[d]+t;if(0<(l=u-t-("vertical"===i?o:n)))for(a=s.getLayout()[r]-l,s.setLayout("vertical"===i?{x:a}:{y:a},!0),u=a,f=c-2;0<=f;--f)0<(l=(s=e[f]).getLayout()[r]+s.getLayout()[d]+t-u)&&(a=s.getLayout()[r]-l,s.setLayout("vertical"===i?{x:a}:{y:a},!0)),u=s.getLayout()[r]}))}function jx(e,t,n){O(e.slice().reverse(),(function(e){O(e,(function(e){if(e.outEdges.length){var o=eE(e.outEdges,Gx,n)/eE(e.outEdges,Qx,n);if(isNaN(o)){var i=e.outEdges.length;o=i?eE(e.outEdges,Xx,n)/i:0}if("vertical"===n){var r=e.getLayout().x+(o-Jx(e,n))*t;e.setLayout({x:r},!0)}else{var a=e.getLayout().y+(o-Jx(e,n))*t;e.setLayout({y:a},!0)}}}))}))}function Gx(e,t){return Jx(e.node2,t)*e.getValue()}function Xx(e,t){return Jx(e.node2,t)}function Yx(e,t){return Jx(e.node1,t)*e.getValue()}function Zx(e,t){return Jx(e.node1,t)}function Jx(e,t){return"vertical"===t?e.getLayout().x+e.getLayout().dx/2:e.getLayout().y+e.getLayout().dy/2}function Qx(e){return e.getValue()}function eE(e,t,n){for(var o=0,i=e.length,r=-1;++r<i;){var a=+t.call(e,e[r],n);isNaN(a)||(o+=a)}return o}function tE(e,t,n){O(e,(function(e){O(e,(function(e){if(e.inEdges.length){var o=eE(e.inEdges,Yx,n)/eE(e.inEdges,Qx,n);if(isNaN(o)){var i=e.inEdges.length;o=i?eE(e.inEdges,Zx,n)/i:0}if("vertical"===n){var r=e.getLayout().x+(o-Jx(e,n))*t;e.setLayout({x:r},!0)}else{var a=e.getLayout().y+(o-Jx(e,n))*t;e.setLayout({y:a},!0)}}}))}))}ch({type:"sankey",_model:null,_focusAdjacencyDisabled:!1,render:function(e,t,n){var o=this,i=e.getGraph(),r=this.group,a=e.layoutInfo,s=a.width,l=a.height,u=e.getData(),c=e.getData("edge"),d=e.get("orient");this._model=e,r.removeAll(),r.attr("position",[a.x,a.y]),i.eachEdge((function(t){var n=new $x;n.dataIndex=t.dataIndex,n.seriesIndex=e.seriesIndex,n.dataType="edge";var o,i,a,u,f,h,g,m,p=t.getModel("lineStyle"),v=p.get("curveness"),y=t.node1.getLayout(),b=t.node1.getModel(),C=b.get("localX"),T=b.get("localY"),x=t.node2.getLayout(),E=t.node2.getModel(),_=E.get("localX"),I=E.get("localY"),D=t.getLayout();switch(n.shape.extent=Math.max(1,D.dy),m="vertical"===(n.shape.orient=d)?(f=o=(null!=C?C*s:y.x)+D.sy,h=(i=(null!=T?T*l:y.y)+y.dy)*(1-v)+(u=null!=I?I*l:x.y)*v,g=a=(null!=_?_*s:x.x)+D.ty,i*v+u*(1-v)):(f=(o=(null!=C?C*s:y.x)+y.dx)*(1-v)+(a=null!=_?_*s:x.x)*v,h=i=(null!=T?T*l:y.y)+D.sy,g=o*v+a*(1-v),u=(null!=I?I*l:x.y)+D.ty),n.setShape({x1:o,y1:i,x2:a,y2:u,cpx1:f,cpy1:h,cpx2:g,cpy2:m}),n.setStyle(p.getItemStyle()),n.style.fill){case"source":n.style.fill=t.node1.getVisual("color");break;case"target":n.style.fill=t.node2.getVisual("color")}Ks(n,t.getModel("emphasis.lineStyle").getItemStyle()),r.add(n),c.setItemGraphicEl(t.dataIndex,n)})),i.eachNode((function(t){var n=t.getLayout(),o=t.getModel(),i=o.get("localX"),a=o.get("localY"),c=o.getModel("label"),d=o.getModel("emphasis.label"),f=new Ua({shape:{x:null!=i?i*s:n.x,y:null!=a?a*l:n.y,width:n.dx,height:n.dy},style:o.getModel("itemStyle").getItemStyle()}),h=t.getModel("emphasis.itemStyle").getItemStyle();Fs(f.style,h,c,d,{labelFetcher:e,labelDataIndex:t.dataIndex,defaultText:t.id,isRectText:!0}),f.setStyle("fill",t.getVisual("color")),Ks(f,h),r.add(f),u.setItemGraphicEl(t.dataIndex,f),f.dataType="node"})),u.eachItemGraphicEl((function(t,i){var r=u.getItemModel(i);r.get("draggable")&&(t.drift=function(t,r){o._focusAdjacencyDisabled=!0,this.shape.x+=t,this.shape.y+=r,this.dirty(),n.dispatchAction({type:"dragNode",seriesId:e.id,dataIndex:u.getRawIndex(i),localX:this.shape.x/s,localY:this.shape.y/l})},t.ondragend=function(){o._focusAdjacencyDisabled=!1},t.draggable=!0,t.cursor="move"),t.highlight=function(){this.trigger("emphasis")},t.downplay=function(){this.trigger("normal")},t.focusNodeAdjHandler&&t.off("mouseover",t.focusNodeAdjHandler),t.unfocusNodeAdjHandler&&t.off("mouseout",t.unfocusNodeAdjHandler),r.get("focusNodeAdjacency")&&(t.on("mouseover",t.focusNodeAdjHandler=function(){o._focusAdjacencyDisabled||(o._clearTimer(),n.dispatchAction({type:"focusNodeAdjacency",seriesId:e.id,dataIndex:t.dataIndex}))}),t.on("mouseout",t.unfocusNodeAdjHandler=function(){o._focusAdjacencyDisabled||o._dispatchUnfocus(n)}))})),c.eachItemGraphicEl((function(t,i){var r=c.getItemModel(i);t.focusNodeAdjHandler&&t.off("mouseover",t.focusNodeAdjHandler),t.unfocusNodeAdjHandler&&t.off("mouseout",t.unfocusNodeAdjHandler),r.get("focusNodeAdjacency")&&(t.on("mouseover",t.focusNodeAdjHandler=function(){o._focusAdjacencyDisabled||(o._clearTimer(),n.dispatchAction({type:"focusNodeAdjacency",seriesId:e.id,edgeDataIndex:t.dataIndex}))}),t.on("mouseout",t.unfocusNodeAdjHandler=function(){o._focusAdjacencyDisabled||o._dispatchUnfocus(n)}))})),!this._data&&e.get("animation")&&r.setClipPath(function(e,t,n){var o=new Ua({shape:{x:e.x-10,y:e.y-10,width:0,height:e.height+20}});return Ys(o,{shape:{width:e.width+20}},t,(function(){r.removeClipPath()})),o}(r.getBoundingRect(),e)),this._data=e.getData()},dispose:function(){this._clearTimer()},_dispatchUnfocus:function(e){var t=this;this._clearTimer(),this._unfocusDelayTimer=setTimeout((function(){t._unfocusDelayTimer=null,e.dispatchAction({type:"unfocusNodeAdjacency",seriesId:t._model.id})}),500)},_clearTimer:function(){this._unfocusDelayTimer&&(clearTimeout(this._unfocusDelayTimer),this._unfocusDelayTimer=null)},focusNodeAdjacency:function(e,t,n,o){var i=e.getData(),r=i.graph,a=o.dataIndex,s=i.getItemModel(a),l=o.edgeDataIndex;if(null!=a||null!=l){var u=r.getNodeByIndex(a),c=r.getEdgeByIndex(l);if(r.eachNode((function(e){Hx(e,Lx,.1)})),r.eachEdge((function(e){Hx(e,Fx,.1)})),u){Wx(u,Bx);var d=s.get("focusNodeAdjacency");"outEdges"===d?O(u.outEdges,(function(e){e.dataIndex<0||(Wx(e,zx),Wx(e.node2,Bx))})):"inEdges"===d?O(u.inEdges,(function(e){e.dataIndex<0||(Wx(e,zx),Wx(e.node1,Bx))})):"allEdges"===d&&O(u.edges,(function(e){e.dataIndex<0||(Wx(e,zx),e.node1!==u&&Wx(e.node1,Bx),e.node2!==u&&Wx(e.node2,Bx))}))}c&&(Wx(c,zx),Wx(c.node1,Bx),Wx(c.node2,Bx))}},unfocusNodeAdjacency:function(e,t,n,o){var i=e.getGraph();i.eachNode((function(e){Hx(e,Lx)})),i.eachEdge((function(e){Hx(e,Fx)}))}}),th({type:"dragNode",event:"dragnode",update:"update"},(function(e,t){t.eachComponent({mainType:"series",subType:"sankey",query:e},(function(t){t.setNodePosition(e.dataIndex,[e.localX,e.localY])}))})),oh((function(e,t,n){e.eachSeriesByType("sankey",(function(e){var n=e.get("nodeWidth"),o=e.get("nodeGap"),i=function(e,t){return au(e.getBoxLayoutParams(),{width:t.getWidth(),height:t.getHeight()})}(e,t),r=(e.layoutInfo=i).width,a=i.height,s=e.getGraph(),l=s.nodes,u=s.edges;!function(e){O(e,(function(e){var t=eE(e.outEdges,Qx),n=eE(e.inEdges,Qx),o=e.getValue()||0,i=Math.max(t,n,o);e.setLayout({value:i},!0)}))}(l),function(e,t,n,o,i,r,a,s,l){(function(e,t,n,o,i,r,a){for(var s=[],l=[],u=[],c=[],d=0,f=0;f<t.length;f++)s[f]=1;for(f=0;f<e.length;f++)l[f]=e[f].inEdges.length,0===l[f]&&u.push(e[f]);for(var h=-1;u.length;){for(var g=0;g<u.length;g++){var m=u[g],p=m.hostGraph.data.getRawDataItem(m.dataIndex),v=null!=p.depth&&0<=p.depth;v&&p.depth>h&&(h=p.depth),m.setLayout({depth:v?p.depth:d},!0),m.setLayout("vertical"===r?{dy:n}:{dx:n},!0);for(var y=0;y<m.outEdges.length;y++){var b=m.outEdges[y];s[t.indexOf(b)]=0;var C=b.node2;0==--l[e.indexOf(C)]&&c.indexOf(C)<0&&c.push(C)}}++d,u=c,c=[]}for(f=0;f<s.length;f++)if(1===s[f])throw new Error("Sankey is a DAG, the original data has cycle!");var T=d-1<h?h:d-1;a&&"left"!==a&&function(e,t,n,o){if("right"===t){for(var i=[],r=e,a=0;r.length;){for(var s=0;s<r.length;s++){var l=r[s];l.setLayout({skNodeHeight:a},!0);for(var u=0;u<l.inEdges.length;u++){var c=l.inEdges[u];i.indexOf(c.node1)<0&&i.push(c.node1)}}r=i,i=[],++a}O(e,(function(e){Ux(e)||e.setLayout({depth:Math.max(0,o-e.getLayout().skNodeHeight)},!0)}))}else"justify"===t&&function(e,t){O(e,(function(e){Ux(e)||e.outEdges.length||e.setLayout({depth:t},!0)}))}(e,o)}(e,a,0,T),function(e,t,n){O(e,(function(e){var o=e.getLayout().depth*t;e.setLayout("vertical"===n?{y:o}:{x:o},!0)}))}(e,"vertical"===r?(i-n)/T:(o-n)/T,r)})(e,t,n,i,r,s,l),function(e,t,n,o,i,r,a){var s=function(e,t){var n=[],o="vertical"===t?"y":"x",i=Hi(e,(function(e){return e.getLayout()[o]}));return i.keys.sort((function(e,t){return e-t})),O(i.keys,(function(e){n.push(i.buckets.get(e))})),n}(e,a);(function(e,t,n,o,i,r){var a=1/0;O(e,(function(e){var t=e.length,s=0;O(e,(function(e){s+=e.getLayout().value}));var l="vertical"===r?(o-(t-1)*i)/s:(n-(t-1)*i)/s;l<a&&(a=l)})),O(e,(function(e){O(e,(function(e,t){var n=e.getLayout().value*a;"vertical"===r?(e.setLayout({x:t},!0),e.setLayout({dx:n},!0)):(e.setLayout({y:t},!0),e.setLayout({dy:n},!0))}))})),O(t,(function(e){var t=+e.getValue()*a;e.setLayout({dy:t},!0)}))})(s,t,n,o,i,a),qx(s,i,n,o,a);for(var l=1;0<r;r--)jx(s,l*=.99,a),qx(s,i,n,o,a),tE(s,l,a),qx(s,i,n,o,a)}(e,t,r,i,o,a,s),function(e,t){var n="vertical"===t?"x":"y";O(e,(function(e){e.outEdges.sort((function(e,t){return e.node2.getLayout()[n]-t.node2.getLayout()[n]})),e.inEdges.sort((function(e,t){return e.node1.getLayout()[n]-t.node1.getLayout()[n]}))})),O(e,(function(e){var t=0,n=0;O(e.outEdges,(function(e){e.setLayout({sy:t},!0),t+=e.getLayout().dy})),O(e.inEdges,(function(e){e.setLayout({ty:n},!0),n+=e.getLayout().dy}))}))}(e,s)}(l,u,n,o,r,a,0!==S(l,(function(e){return 0===e.getLayout().value})).length?0:e.get("layoutIterations"),e.get("orient"),e.get("nodeAlign"))}))})),ih((function(e,t){e.eachSeriesByType("sankey",(function(e){var t=e.getGraph().nodes;if(t.length){var n=1/0,o=-1/0;O(t,(function(e){var t=e.getLayout().value;t<n&&(n=t),o<t&&(o=t)})),O(t,(function(t){var i=new Lb({type:"color",mappingMethod:"linear",dataExtent:[n,o],visual:e.get("color")}).mapValueToVisual(t.getLayout().value),r=t.getModel().get("itemStyle.color");t.setVisual("color",null!=r?r:i)}))}}))}));var nE={_baseAxisDim:null,getInitialData:function(e,t){var n,o,i=t.getComponent("xAxis",this.get("xAxisIndex")),r=t.getComponent("yAxis",this.get("yAxisIndex")),a=i.get("type"),s=r.get("type");"category"===a?(e.layout="horizontal",n=i.getOrdinalMeta(),o=!0):"category"===s?(e.layout="vertical",n=r.getOrdinalMeta(),o=!0):e.layout=e.layout||"horizontal";var l=["x","y"],u="horizontal"===e.layout?0:1,c=this._baseAxisDim=l[u],d=l[1-u],f=[i,r],h=f[u].get("type"),g=f[1-u].get("type"),m=e.data;if(m&&o){var p=[];O(m,(function(e,t){var n;e.value&&M(e.value)?(n=e.value.slice(),e.value.unshift(t)):M(e)?(n=e.slice(),e.unshift(t)):n=e,p.push(n)})),e.data=p}var v=this.defaultValueDimensions,y=[{name:c,type:ph(h),ordinalMeta:n,otherDims:{tooltip:!1,itemName:0},dimsDef:["base"]},{name:d,type:ph(g),dimsDef:v.slice()}];return Tv(this,{coordDimensions:y,dimensionsCount:v.length+1,encodeDefaulter:N(Mu,y,this)})},getBaseAxis:function(){var e=this._baseAxisDim;return this.ecModel.getComponent(e+"Axis",this.get(e+"AxisIndex")).axis}};I(Wc.extend({type:"series.boxplot",dependencies:["xAxis","yAxis","grid"],defaultValueDimensions:[{name:"min",defaultTooltip:!0},{name:"Q1",defaultTooltip:!0},{name:"median",defaultTooltip:!0},{name:"Q3",defaultTooltip:!0},{name:"max",defaultTooltip:!0}],dimensions:null,defaultOption:{zlevel:0,z:2,coordinateSystem:"cartesian2d",legendHoverLink:!0,hoverAnimation:!0,layout:null,boxWidth:[7,50],itemStyle:{color:"#fff",borderWidth:1},emphasis:{itemStyle:{borderWidth:2,shadowBlur:5,shadowOffsetX:2,shadowOffsetY:2,shadowColor:"rgba(0,0,0,0.4)"}},animationEasing:"elasticOut",animationDuration:800}}),nE,!0);var oE=["itemStyle"],iE=["emphasis","itemStyle"],rE=(nd.extend({type:"boxplot",render:function(e,t,n){var o=e.getData(),i=this.group,r=this._data;this._data||i.removeAll();var a="horizontal"===e.get("layout")?1:0;o.diff(r).add((function(e){if(o.hasValue(e)){var t=aE(o.getItemLayout(e),o,e,a,!0);o.setItemGraphicEl(e,t),i.add(t)}})).update((function(e,t){var n=r.getItemGraphicEl(t);if(o.hasValue(e)){var s=o.getItemLayout(e);n?sE(s,n,o,e):n=aE(s,o,e,a),i.add(n),o.setItemGraphicEl(e,n)}else i.remove(n)})).remove((function(e){var t=r.getItemGraphicEl(e);t&&i.remove(t)})).execute(),this._data=o},remove:function(e){var t=this.group,n=this._data;this._data=null,n&&n.eachItemGraphicEl((function(e){e&&t.remove(e)}))},dispose:te}),ha.extend({type:"boxplotBoxPath",shape:{},buildPath:function(e,t){var n=t.points,o=0;for(e.moveTo(n[o][0],n[o][1]),o++;o<4;o++)e.lineTo(n[o][0],n[o][1]);for(e.closePath();o<n.length;o++)e.moveTo(n[o][0],n[o][1]),o++,e.lineTo(n[o][0],n[o][1])}}));function aE(e,t,n,o,i){var r=e.ends,a=new rE({shape:{points:i?function(e,t,n){return w(e,(function(e){return(e=e.slice())[t]=n.initBaseline,e}))}(r,o,e):r}});return sE(e,a,t,n,i),a}function sE(e,t,n,o,i){(0,al[i?"initProps":"updateProps"])(t,{shape:{points:e.ends}},n.hostModel,o);var r=n.getItemModel(o),a=r.getModel(oE),s=n.getItemVisual(o,"color"),l=a.getItemStyle(["borderColor"]);l.stroke=s,l.strokeNoScale=!0,t.useStyle(l),t.z2=100,Ks(t,r.getModel(iE).getItemStyle())}var lE=["itemStyle","borderColor"],uE=O;ih((function(e,t){var n=e.get("color");e.eachRawSeriesByType("boxplot",(function(t){var o=n[t.seriesIndex%n.length],i=t.getData();i.setVisual({legendSymbol:"roundRect",color:t.get(lE)||o}),e.isSeriesFiltered(t)||i.each((function(e){var t=i.getItemModel(e);i.setItemVisual(e,{color:t.get(lE,!0)})}))}))})),oh((function(e){var t=function(e){var t=[],n=[];return e.eachSeriesByType("boxplot",(function(e){var o=e.getBaseAxis(),i=E(n,o);i<0&&(n[i=n.length]=o,t[i]={axis:o,seriesModels:[]}),t[i].seriesModels.push(e)})),t}(e);uE(t,(function(e){var t=e.seriesModels;t.length&&(function(e){var t,n,o=e.axis,i=e.seriesModels,r=i.length,a=e.boxWidthList=[],s=e.boxOffsetList=[],l=[];if("category"===o.type)n=o.getBandWidth();else{var u=0;uE(i,(function(e){u=Math.max(u,e.getData().count())})),t=o.getExtent(),Math.abs(t[1]-t[0])}uE(i,(function(e){var t=e.get("boxWidth");M(t)||(t=[t,t]),l.push([Cl(t[0],n)||0,Cl(t[1],n)||0])}));var c=.8*n-2,d=c/r*.3,f=(c-d*(r-1))/r,h=f/2-c/2;uE(i,(function(e,t){s.push(h),h+=d+f,a.push(Math.min(Math.max(f,l[t][0]),l[t][1]))}))}(e),uE(t,(function(t,n){!function(e,t,n){var o=e.coordinateSystem,i=e.getData(),r=n/2,a="horizontal"===e.get("layout")?0:1,s=1-a,l=["x","y"],u=i.mapDimension(l[a]),c=i.mapDimension(l[s],!0);if(!(null==u||c.length<5))for(var d=0;d<i.count();d++){var f=i.get(u,d),h=b(f,c[2],d),g=b(f,c[0],d),m=b(f,c[1],d),p=b(f,c[3],d),v=b(f,c[4],d),y=[];C(y,m,0),C(y,p,1),y.push(g,m,v,p),T(y,g),T(y,v),T(y,h),i.setItemLayout(d,{initBaseline:h[s],ends:y})}function b(e,n,r){var l,u=i.get(n,r),c=[];return c[a]=e,c[s]=u,isNaN(e)||isNaN(u)?l=[NaN,NaN]:(l=o.dataToPoint(c))[a]+=t,l}function C(e,t,n){var o=t.slice(),i=t.slice();o[a]+=r,i[a]-=r,n?e.push(o,i):e.push(i,o)}function T(e,t){var n=t.slice(),o=t.slice();n[a]-=r,o[a]+=r,e.push(n,o)}}(t,e.boxOffsetList[n],e.boxWidthList[n])})))}))})),I(Wc.extend({type:"series.candlestick",dependencies:["xAxis","yAxis","grid"],defaultValueDimensions:[{name:"open",defaultTooltip:!0},{name:"close",defaultTooltip:!0},{name:"lowest",defaultTooltip:!0},{name:"highest",defaultTooltip:!0}],dimensions:null,defaultOption:{zlevel:0,z:2,coordinateSystem:"cartesian2d",legendHoverLink:!0,hoverAnimation:!0,layout:null,clip:!0,itemStyle:{color:"#c23531",color0:"#314656",borderWidth:1,borderColor:"#c23531",borderColor0:"#314656"},emphasis:{itemStyle:{borderWidth:2}},barMaxWidth:null,barMinWidth:null,barWidth:null,large:!0,largeThreshold:600,progressive:3e3,progressiveThreshold:1e4,progressiveChunkMode:"mod",animationUpdate:!1,animationEasing:"linear",animationDuration:300},getShadowDim:function(){return"open"},brushSelector:function(e,t,n){var o=t.getItemLayout(e);return o&&n.rect(o.brushRect)}}),nE,!0);var cE=["itemStyle"],dE=["emphasis","itemStyle"],fE=["color","color0","borderColor","borderColor0"],hE=(nd.extend({type:"candlestick",render:function(e,t,n){this.group.removeClipPath(),this._updateDrawMode(e),this._isLargeDraw?this._renderLarge(e):this._renderNormal(e)},incrementalPrepareRender:function(e,t,n){this._clear(),this._updateDrawMode(e)},incrementalRender:function(e,t,n,o){this._isLargeDraw?this._incrementalRenderLarge(e,t):this._incrementalRenderNormal(e,t)},_updateDrawMode:function(e){var t=e.pipelineContext.large;(null==this._isLargeDraw||t^this._isLargeDraw)&&(this._isLargeDraw=t,this._clear())},_renderNormal:function(e){var t=e.getData(),n=this._data,o=this.group,i=t.getLayout("isSimpleBox"),r=e.get("clip",!0),a=e.coordinateSystem,s=a.getArea&&a.getArea();this._data||o.removeAll(),t.diff(n).add((function(n){if(t.hasValue(n)){var a,l=t.getItemLayout(n);if(r&&mE(s,l))return;Ys(a=gE(l,0,!0),{shape:{points:l.ends}},e,n),pE(a,t,n,i),o.add(a),t.setItemGraphicEl(n,a)}})).update((function(a,l){var u=n.getItemGraphicEl(l);if(t.hasValue(a)){var c=t.getItemLayout(a);r&&mE(s,c)?o.remove(u):(u?Xs(u,{shape:{points:c.ends}},e,a):u=gE(c),pE(u,t,a,i),o.add(u),t.setItemGraphicEl(a,u))}else o.remove(u)})).remove((function(e){var t=n.getItemGraphicEl(e);t&&o.remove(t)})).execute(),this._data=t},_renderLarge:function(e){this._clear(),yE(e,this.group);var t=e.get("clip",!0)?Qm(e.coordinateSystem,!1,e):null;t?this.group.setClipPath(t):this.group.removeClipPath()},_incrementalRenderNormal:function(e,t){for(var n,o=t.getData(),i=o.getLayout("isSimpleBox");null!=(n=e.next());){var r;pE(r=gE(o.getItemLayout(n)),o,n,i),r.incremental=!0,this.group.add(r)}},_incrementalRenderLarge:function(e,t){yE(t,this.group,!0)},remove:function(e){this._clear()},_clear:function(){this.group.removeAll(),this._data=null},dispose:te}),ha.extend({type:"normalCandlestickBox",shape:{},buildPath:function(e,t){var n=t.points;this.__simpleBox?(e.moveTo(n[4][0],n[4][1]),e.lineTo(n[6][0],n[6][1])):(e.moveTo(n[0][0],n[0][1]),e.lineTo(n[1][0],n[1][1]),e.lineTo(n[2][0],n[2][1]),e.lineTo(n[3][0],n[3][1]),e.closePath(),e.moveTo(n[4][0],n[4][1]),e.lineTo(n[5][0],n[5][1]),e.moveTo(n[6][0],n[6][1]),e.lineTo(n[7][0],n[7][1]))}}));function gE(e,t,n){var o=e.ends;return new hE({shape:{points:n?function(e,t){return w(e,(function(e){return(e=e.slice())[1]=t.initBaseline,e}))}(o,e):o},z2:100})}function mE(e,t){for(var n=!0,o=0;o<t.ends.length;o++)if(e.contain(t.ends[o][0],t.ends[o][1])){n=!1;break}return n}function pE(e,t,n,o){var i=t.getItemModel(n),r=i.getModel(cE),a=t.getItemVisual(n,"color"),s=t.getItemVisual(n,"borderColor")||a,l=r.getItemStyle(fE);e.useStyle(l),e.style.strokeNoScale=!0,e.style.fill=a,e.style.stroke=s,e.__simpleBox=o,Ks(e,i.getModel(dE).getItemStyle())}var vE=ha.extend({type:"largeCandlestickBox",shape:{},buildPath:function(e,t){for(var n=t.points,o=0;o<n.length;)if(this.__sign===n[o++]){var i=n[o++];e.moveTo(i,n[o++]),e.lineTo(i,n[o++])}else o+=3}});function yE(e,t,n){var o=e.getData(),i=o.getLayout("largePoints"),r=new vE({shape:{points:i},__sign:1});t.add(r);var a=new vE({shape:{points:i},__sign:-1});t.add(a),bE(1,r,e,o),bE(-1,a,e,o),n&&(r.incremental=!0,a.incremental=!0)}function bE(e,t,n,o){var i=0<e?"P":"N",r=o.getVisual("borderColor"+i)||o.getVisual("color"+i),a=n.getModel(cE).getItemStyle(fE);t.useStyle(a),t.style.fill=null,t.style.stroke=r}var CE=["itemStyle","borderColor"],TE=["itemStyle","borderColor0"],xE=["itemStyle","color"],EE=["itemStyle","color0"],_E={seriesType:"candlestick",plan:Qc(),performRawSeries:!0,reset:function(e,t){if(e.getData().setVisual({legendSymbol:"roundRect",colorP:n(1,e),colorN:n(-1,e),borderColorP:o(1,e),borderColorN:o(-1,e)}),!t.isSeriesFiltered(e))return!e.pipelineContext.large&&{progress:function(e,t){for(var i;null!=(i=e.next());){var r=t.getItemModel(i),a=t.getItemLayout(i).sign;t.setItemVisual(i,{color:n(a,r),borderColor:o(a,r)})}}};function n(e,t){return t.get(0<e?xE:EE)}function o(e,t){return t.get(0<e?CE:TE)}}},IE="undefined"!=typeof Float32Array?Float32Array:Array,DE={seriesType:"candlestick",plan:Qc(),reset:function(e){var t=e.coordinateSystem,n=e.getData(),o=function(e,t){var n,o=e.getBaseAxis(),i="category"===o.type?o.getBandWidth():(n=o.getExtent(),Math.abs(n[1]-n[0])/t.count()),r=Cl(W(e.get("barMaxWidth"),i),i),a=Cl(W(e.get("barMinWidth"),1),i),s=e.get("barWidth");return null!=s?Cl(s,i):Math.max(Math.min(i/2,r),a)}(e,n),i=["x","y"],r=n.mapDimension(i[0]),a=n.mapDimension(i[1],!0),s=a[0],l=a[1],u=a[2],c=a[3];if(n.setLayout({candleWidth:o,isSimpleBox:o<=1.3}),!(null==r||a.length<4))return{progress:e.pipelineContext.large?function(e,n){for(var o,i,a=new IE(4*e.count),d=0,f=[],h=[];null!=(i=e.next());){var g=n.get(r,i),m=n.get(s,i),p=n.get(l,i),v=n.get(u,i),y=n.get(c,i);isNaN(g)||isNaN(v)||isNaN(y)?(a[d++]=NaN,d+=3):(a[d++]=OE(n,i,m,p,l),f[0]=g,f[1]=v,o=t.dataToPoint(f,null,h),a[d++]=o?o[0]:NaN,a[d++]=o?o[1]:NaN,f[1]=y,o=t.dataToPoint(f,null,h),a[d++]=o?o[1]:NaN)}n.setLayout("largePoints",a)}:function(e,n){for(var i;null!=(i=e.next());){var a=n.get(r,i),d=n.get(s,i),f=n.get(l,i),h=n.get(u,i),g=n.get(c,i),m=Math.min(d,f),p=Math.max(d,f),v=x(m,a),y=x(p,a),b=x(h,a),C=x(g,a),T=[];E(T,y,0),E(T,v,1),T.push(I(C),I(y),I(b),I(v)),n.setItemLayout(i,{sign:OE(n,i,d,f,l),initBaseline:f<d?y[1]:v[1],ends:T,brushRect:_(h,g,a)})}function x(e,n){var o=[];return o[0]=n,o[1]=e,isNaN(n)||isNaN(e)?[NaN,NaN]:t.dataToPoint(o)}function E(e,t,n){var i=t.slice(),r=t.slice();i[0]=Ts(i[0]+o/2,1,!1),r[0]=Ts(r[0]-o/2,1,!0),n?e.push(i,r):e.push(r,i)}function _(e,t,n){var i=x(e,n),r=x(t,n);return i[0]-=o/2,r[0]-=o/2,{x:i[0],y:i[1],width:o,height:r[1]-i[1]}}function I(e){return e[0]=Ts(e[0],1),e}}}}};function OE(e,t,n,o,i){return o<n?-1:n<o?1:0<t?e.get(i,t-1)<=o?1:-1:1}function wE(e,t){var n=t.rippleEffectColor||t.color;e.eachChild((function(e){e.attr({z:t.z,zlevel:t.zlevel,style:{stroke:"stroke"===t.brushType?n:null,fill:"fill"===t.brushType?n:null}})}))}function RE(e,t){_n.call(this);var n=new xm(e,t),o=new _n;this.add(n),this.add(o),o.beforeUpdate=function(){this.attr(n.getScale())},this.updateData(e,t)}Qf((function(e){e&&M(e.series)&&O(e.series,(function(e){L(e)&&"k"===e.type&&(e.type="candlestick")}))})),ih(_E),oh(DE),Wc.extend({type:"series.effectScatter",dependencies:["grid","polar"],getInitialData:function(e,t){return Xh(this.getSource(),this,{useEncodeDefaulter:!0})},brushSelector:"point",defaultOption:{coordinateSystem:"cartesian2d",zlevel:0,z:2,legendHoverLink:!0,effectType:"ripple",progressive:0,showEffectOn:"render",rippleEffect:{period:4,scale:2.5,brushType:"fill"},symbolSize:10}});var SE=RE.prototype;SE.stopEffectAnimation=function(){this.childAt(1).removeAll()},SE.startEffectAnimation=function(e){for(var t=e.symbolType,n=e.color,o=this.childAt(1),i=0;i<3;i++){var r=tm(t,-1,-1,2,2,n);r.attr({style:{strokeNoScale:!0},z2:99,silent:!0,scale:[.5,.5]});var a=-i/3*e.period+e.effectOffset;r.animate("",!0).when(e.period,{scale:[e.rippleScale/2,e.rippleScale/2]}).delay(a).start(),r.animateStyle(!0).when(e.period,{opacity:0}).delay(a).start(),o.add(r)}wE(o,e)},SE.updateEffectAnimation=function(e){for(var t=this._effectCfg,n=this.childAt(1),o=["symbolType","period","rippleScale"],i=0;i<o.length;i++){var r=o[i];if(t[r]!==e[r])return this.stopEffectAnimation(),void this.startEffectAnimation(e)}wE(n,e)},SE.highlight=function(){this.trigger("emphasis")},SE.downplay=function(){this.trigger("normal")},SE.updateData=function(e,t){var n=e.hostModel;this.childAt(0).updateData(e,t);var o=this.childAt(1),i=e.getItemModel(t),r=e.getItemVisual(t,"symbol"),a=function(e){return M(e)||(e=[+e,+e]),e}(e.getItemVisual(t,"symbolSize")),s=e.getItemVisual(t,"color");o.attr("scale",a),o.traverse((function(e){e.attr({fill:s})}));var l=i.getShallow("symbolOffset");if(l){var u=o.position;u[0]=Cl(l[0],a[0]),u[1]=Cl(l[1],a[1])}var c=e.getItemVisual(t,"symbolRotate");o.rotation=(c||0)*Math.PI/180||0;var d={};if(d.showEffectOn=n.get("showEffectOn"),d.rippleScale=i.get("rippleEffect.scale"),d.brushType=i.get("rippleEffect.brushType"),d.period=1e3*i.get("rippleEffect.period"),d.effectOffset=t/e.count(),d.z=i.getShallow("z")||0,d.zlevel=i.getShallow("zlevel")||0,d.symbolType=r,d.color=s,d.rippleEffectColor=i.get("rippleEffect.color"),this.off("mouseover").off("mouseout").off("emphasis").off("normal"),"render"===d.showEffectOn)this._effectCfg?this.updateEffectAnimation(d):this.startEffectAnimation(d),this._effectCfg=d;else{this._effectCfg=null,this.stopEffectAnimation();var f=this.childAt(0),h=function(){f.highlight(),"render"!==d.showEffectOn&&this.startEffectAnimation(d)},g=function(){f.downplay(),"render"!==d.showEffectOn&&this.stopEffectAnimation()};this.on("mouseover",h,this).on("mouseout",g,this).on("emphasis",h,this).on("normal",g,this)}this._effectCfg=d},SE.fadeOut=function(e){this.off("mouseover").off("mouseout").off("emphasis").off("normal"),e&&e()},_(RE,_n),ch({type:"effectScatter",init:function(){this._symbolDraw=new Am(RE)},render:function(e,t,n){var o=e.getData(),i=this._symbolDraw;i.updateData(o),this.group.add(i.group)},updateTransform:function(e,t,n){var o=e.getData();this.group.dirty();var i=ap().reset(e);i.progress&&i.progress({start:0,end:o.count()},o),this._symbolDraw.updateLayout(o)},_updateGroupTransform:function(e){var t=e.coordinateSystem;t&&t.getRoamTransform&&(this.group.transform=dt(t.getRoamTransform()),this.group.decomposeTransform())},remove:function(e,t){this._symbolDraw&&this._symbolDraw.remove(t)},dispose:function(){}}),ih(rp("effectScatter","circle")),oh(ap("effectScatter"));var kE="undefined"==typeof Uint32Array?Array:Uint32Array,AE="undefined"==typeof Float64Array?Array:Float64Array;function NE(e){var t=e.data;t&&t[0]&&t[0][0]&&t[0][0].coord&&(e.data=w(t,(function(e){var t={coords:[e[0].coord,e[1].coord]};return e[0].name&&(t.fromName=e[0].name),e[1].name&&(t.toName=e[1].name),y([t,e[0],e[1]])})))}var ME=Wc.extend({type:"series.lines",dependencies:["grid","polar"],visualColorAccessPath:"lineStyle.color",init:function(e){e.data=e.data||[],NE(e);var t=this._processFlatCoordsArray(e.data);this._flatCoords=t.flatCoords,this._flatCoordsOffset=t.flatCoordsOffset,t.flatCoords&&(e.data=new Float32Array(t.count)),ME.superApply(this,"init",arguments)},mergeOption:function(e){if(NE(e),e.data){var t=this._processFlatCoordsArray(e.data);this._flatCoords=t.flatCoords,this._flatCoordsOffset=t.flatCoordsOffset,t.flatCoords&&(e.data=new Float32Array(t.count))}ME.superApply(this,"mergeOption",arguments)},appendData:function(e){var t=this._processFlatCoordsArray(e.data);t.flatCoords&&(this._flatCoords?(this._flatCoords=ee(this._flatCoords,t.flatCoords),this._flatCoordsOffset=ee(this._flatCoordsOffset,t.flatCoordsOffset)):(this._flatCoords=t.flatCoords,this._flatCoordsOffset=t.flatCoordsOffset),e.data=new Float32Array(t.count)),this.getRawData().appendData(e.data)},_getCoordsFromItemModel:function(e){var t=this.getData().getItemModel(e);return t.option instanceof Array?t.option:t.getShallow("coords")},getLineCoordsCount:function(e){return this._flatCoordsOffset?this._flatCoordsOffset[2*e+1]:this._getCoordsFromItemModel(e).length},getLineCoords:function(e,t){if(this._flatCoordsOffset){for(var n=this._flatCoordsOffset[2*e],o=this._flatCoordsOffset[2*e+1],i=0;i<o;i++)t[i]=t[i]||[],t[i][0]=this._flatCoords[n+2*i],t[i][1]=this._flatCoords[n+2*i+1];return o}var r=this._getCoordsFromItemModel(e);for(i=0;i<r.length;i++)t[i]=t[i]||[],t[i][0]=r[i][0],t[i][1]=r[i][1];return r.length},_processFlatCoordsArray:function(e){var t=0;if(this._flatCoords&&(t=this._flatCoords.length),"number"!=typeof e[0])return{flatCoordsOffset:null,flatCoords:null,count:e.length};for(var n=e.length,o=new kE(n),i=new AE(n),r=0,a=0,s=0,l=0;l<n;){s++;var u=e[l++];o[a++]=r+t,o[a++]=u;for(var c=0;c<u;c++){var d=e[l++],f=e[l++];i[r++]=d,i[r++]=f}}return{flatCoordsOffset:new Uint32Array(o.buffer,0,a),flatCoords:i,count:s}},getInitialData:function(e,t){var n=new wh(["value"],this);return n.hasItemOption=!1,n.initData(e.data,[],(function(e,t,o,i){if(e instanceof Array)return NaN;n.hasItemOption=!0;var r=e.value;return null!=r?r instanceof Array?r[i]:r:void 0})),n},formatTooltip:function(e){var t=this.getData().getItemModel(e),n=t.get("name");if(n)return n;var o=t.get("fromName"),i=t.get("toName"),r=[];return null!=o&&r.push(o),null!=i&&r.push(i),Wl(r.join(" > "))},preventIncremental:function(){return!!this.get("effect.show")},getProgressive:function(){var e=this.option.progressive;return null==e?this.option.large?1e4:this.get("progressive"):e},getProgressiveThreshold:function(){var e=this.option.progressiveThreshold;return null==e?this.option.large?2e4:this.get("progressiveThreshold"):e},defaultOption:{coordinateSystem:"geo",zlevel:0,z:2,legendHoverLink:!0,hoverAnimation:!0,xAxisIndex:0,yAxisIndex:0,symbol:["none","none"],symbolSize:[10,10],geoIndex:0,effect:{show:!1,period:4,constantSpeed:0,symbol:"circle",symbolSize:3,loop:!0,trailLength:.2},large:!1,largeThreshold:2e3,polyline:!1,clip:!0,label:{show:!1,position:"end"},lineStyle:{opacity:.5}}});function KE(e,t,n){_n.call(this),this.add(this.createLine(e,t,n)),this._updateEffectSymbol(e,t)}var PE=KE.prototype;function LE(e,t,n){_n.call(this),this._createPolyline(e,t,n)}PE.createLine=function(e,t,n){return new LC(e,t,n)},PE._updateEffectSymbol=function(e,t){var n=e.getItemModel(t).getModel("effect"),o=n.get("symbolSize"),i=n.get("symbol");M(o)||(o=[o,o]);var r=n.get("color")||e.getItemVisual(t,"color"),a=this.childAt(1);this._symbolType!==i&&(this.remove(a),(a=tm(i,-.5,-.5,1,1,r)).z2=100,a.culling=!0,this.add(a)),a&&(a.setStyle("shadowColor",r),a.setStyle(n.getItemStyle(["color"])),a.attr("scale",o),a.setColor(r),a.attr("scale",o),this._symbolType=i,this._symbolScale=o,this._updateEffectAnimation(e,n,t))},PE._updateEffectAnimation=function(e,t,n){var o=this.childAt(1);if(o){var i=this,r=e.getItemLayout(n),a=1e3*t.get("period"),s=t.get("loop"),l=t.get("constantSpeed"),u=H(t.get("delay"),(function(t){return t/e.count()*a/3})),c="function"==typeof u;if(o.ignore=!0,this.updateAnimationPoints(o,r),0<l&&(a=this.getLineLength(o)/l*1e3),a!==this._period||s!==this._loop){o.stopAnimation();var d=u;c&&(d=u(n)),0<o.__t&&(d=-a*o.__t),o.__t=0;var f=o.animate("",s).when(a,{__t:1}).delay(d).during((function(){i.updateSymbolPosition(o)}));s||f.done((function(){i.remove(o)})),f.start()}this._period=a,this._loop=s}},PE.getLineLength=function(e){return pe(e.__p1,e.__cp1)+pe(e.__cp1,e.__p2)},PE.updateAnimationPoints=function(e,t){e.__p1=t[0],e.__p2=t[1],e.__cp1=t[2]||[(t[0][0]+t[1][0])/2,(t[0][1]+t[1][1])/2]},PE.updateData=function(e,t,n){this.childAt(0).updateData(e,t,n),this._updateEffectSymbol(e,t)},PE.updateSymbolPosition=function(e){var t=e.__p1,n=e.__p2,o=e.__cp1,i=e.__t,r=e.position,a=[r[0],r[1]],s=vr,l=yr;r[0]=s(t[0],o[0],n[0],i),r[1]=s(t[1],o[1],n[1],i);var u=l(t[0],o[0],n[0],i),c=l(t[1],o[1],n[1],i);if(e.rotation=-Math.atan2(c,u)-Math.PI/2,"line"===this._symbolType||"rect"===this._symbolType||"roundRect"===this._symbolType)if(void 0!==e.__lastT&&e.__lastT<e.__t){var d=1.05*pe(a,r);e.attr("scale",[e.scale[0],d]),1===i&&(r[0]=a[0]+(r[0]-a[0])/2,r[1]=a[1]+(r[1]-a[1])/2)}else 1===e.__lastT?(d=2*pe(t,r),e.attr("scale",[e.scale[0],d])):e.attr("scale",this._symbolScale);e.__lastT=e.__t,e.ignore=!1},PE.updateLayout=function(e,t){this.childAt(0).updateLayout(e,t);var n=e.getItemModel(t).getModel("effect");this._updateEffectAnimation(e,n,t)},_(KE,_n);var BE=LE.prototype;function FE(e,t,n){KE.call(this,e,t,n),this._lastFrame=0,this._lastFramePercent=0}BE._createPolyline=function(e,t,n){var o=e.getItemLayout(t),i=new Fa({shape:{points:o}});this.add(i),this._updateCommonStl(e,t,n)},BE.updateData=function(e,t,n){var o=e.hostModel;Xs(this.childAt(0),{shape:{points:e.getItemLayout(t)}},o,t),this._updateCommonStl(e,t,n)},BE._updateCommonStl=function(e,t,n){var o=this.childAt(0),i=e.getItemModel(t),r=e.getItemVisual(t,"color"),a=n&&n.lineStyle,s=n&&n.hoverLineStyle;n&&!e.hasItemOption||(a=i.getModel("lineStyle").getLineStyle(),s=i.getModel("emphasis.lineStyle").getLineStyle()),o.useStyle(C({strokeNoScale:!0,fill:"none",stroke:r},a)),o.hoverStyle=s,Ks(this)},BE.updateLayout=function(e,t){this.childAt(0).setShape("points",e.getItemLayout(t))},_(LE,_n);var zE=FE.prototype;zE.createLine=function(e,t,n){return new LE(e,t,n)},zE.updateAnimationPoints=function(e,t){this._points=t;for(var n=[0],o=0,i=1;i<t.length;i++)o+=pe(t[i-1],t[i]),n.push(o);if(0!==o){for(i=0;i<n.length;i++)n[i]/=o;this._offsets=n,this._length=o}},zE.getLineLength=function(e){return this._length},zE.updateSymbolPosition=function(e){var t=e.__t,n=this._points,o=this._offsets,i=n.length;if(o){var r=this._lastFrame;if(t<this._lastFramePercent){for(a=Math.min(r+1,i-1);0<=a&&!(o[a]<=t);a--);a=Math.min(a,i-2)}else{for(var a=r;a<i&&!(o[a]>t);a++);a=Math.min(a-1,i-2)}be(e.position,n[a],n[a+1],(t-o[a])/(o[a+1]-o[a])),e.rotation=-Math.atan2(n[a+1][1]-n[a][1],n[a+1][0]-n[a][0])-Math.PI/2,this._lastFrame=a,this._lastFramePercent=t,e.ignore=!1}},_(FE,KE);var VE=hs({shape:{polyline:!1,curveness:0,segs:[]},buildPath:function(e,t){var n=t.segs,o=t.curveness;if(t.polyline)for(var i=0;i<n.length;){var r=n[i++];if(0<r){e.moveTo(n[i++],n[i++]);for(var a=1;a<r;a++)e.lineTo(n[i++],n[i++])}}else for(i=0;i<n.length;){var s=n[i++],l=n[i++],u=n[i++],c=n[i++];e.moveTo(s,l),0<o?e.quadraticCurveTo((s+u)/2-(l-c)*o,(l+c)/2-(u-s)*o,u,c):e.lineTo(u,c)}},findDataIndex:function(e,t){var n=this.shape,o=n.segs,i=n.curveness;if(n.polyline)for(var r=0,a=0;a<o.length;){var s=o[a++];if(0<s)for(var l=o[a++],u=o[a++],c=1;c<s;c++)if(Gr(l,u,d=o[a++],f=o[a++]))return r;r++}else for(r=0,a=0;a<o.length;){l=o[a++],u=o[a++];var d=o[a++],f=o[a++];if(0<i){if(Yr(l,u,(l+d)/2-(u-f)*i,(u+f)/2-(d-l)*i,d,f))return r}else if(Gr(l,u,d,f))return r;r++}return-1}});function HE(){this.group=new _n}var WE=HE.prototype;WE.isPersistent=function(){return!this._incremental},WE.updateData=function(e){this.group.removeAll();var t=new VE({rectHover:!0,cursor:"default"});t.setShape({segs:e.getLayout("linesPoints")}),this._setCommon(t,e),this.group.add(t),this._incremental=null},WE.incrementalPrepareUpdate=function(e){this.group.removeAll(),this._clearIncremental(),5e5<e.count()?(this._incremental||(this._incremental=new ns({silent:!0})),this.group.add(this._incremental)):this._incremental=null},WE.incrementalUpdate=function(e,t){var n=new VE;n.setShape({segs:t.getLayout("linesPoints")}),this._setCommon(n,t,!!this._incremental),this._incremental?this._incremental.addDisplayable(n,!0):(n.rectHover=!0,n.cursor="default",n.__startIndex=e.start,this.group.add(n))},WE.remove=function(){this._clearIncremental(),this._incremental=null,this.group.removeAll()},WE._setCommon=function(e,t,n){var o=t.hostModel;e.setShape({polyline:o.get("polyline"),curveness:o.get("lineStyle.curveness")}),e.useStyle(o.getModel("lineStyle").getLineStyle()),e.style.strokeNoScale=!0;var i=t.getVisual("color");i&&e.setStyle("stroke",i),e.setStyle("fill"),n||(e.seriesIndex=o.seriesIndex,e.on("mousemove",(function(t){e.dataIndex=null;var n=e.findDataIndex(t.offsetX,t.offsetY);0<n&&(e.dataIndex=n+e.__startIndex)})))},WE._clearIncremental=function(){var e=this._incremental;e&&e.clearDisplaybles()};var $E={seriesType:"lines",plan:Qc(),reset:function(e){var t=e.coordinateSystem,n=e.get("polyline"),o=e.pipelineContext.large;return{progress:function(i,r){var a=[];if(o){var s,l=i.end-i.start;if(n){for(var u=0,c=i.start;c<i.end;c++)u+=e.getLineCoordsCount(c);s=new Float32Array(l+2*u)}else s=new Float32Array(4*l);var d=0,f=[];for(c=i.start;c<i.end;c++){var h=e.getLineCoords(c,a);n&&(s[d++]=h);for(var g=0;g<h;g++)f=t.dataToPoint(a[g],!1,f),s[d++]=f[0],s[d++]=f[1]}r.setLayout("linesPoints",s)}else for(c=i.start;c<i.end;c++){var m=r.getItemModel(c),p=(h=e.getLineCoords(c,a),[]);if(n)for(var v=0;v<h;v++)p.push(t.dataToPoint(a[v]));else{p[0]=t.dataToPoint(a[0]),p[1]=t.dataToPoint(a[1]);var y=m.get("lineStyle.curveness");+y&&(p[2]=[(p[0][0]+p[1][0])/2-(p[0][1]-p[1][1])*y,(p[0][1]+p[1][1])/2-(p[1][0]-p[0][0])*y])}r.setItemLayout(c,p)}}}}};function UE(e){return e instanceof Array||(e=[e,e]),e}ch({type:"lines",init:function(){},render:function(e,t,n){var o=e.getData(),i=this._updateLineDraw(o,e),r=e.get("zlevel"),a=e.get("effect.trailLength"),s=n.getZr(),l="svg"===s.painter.getType();l||s.painter.getLayer(r).clear(!0),null==this._lastZlevel||l||s.configLayer(this._lastZlevel,{motionBlur:!1}),this._showEffect(e)&&a&&(l||s.configLayer(r,{motionBlur:!0,lastFrameAlpha:Math.max(Math.min(a/10+.9,1),0)})),i.updateData(o);var u=e.get("clip",!0)&&Qm(e.coordinateSystem,!1,e);u?this.group.setClipPath(u):this.group.removeClipPath(),this._lastZlevel=r,this._finished=!0},incrementalPrepareRender:function(e,t,n){var o=e.getData();this._updateLineDraw(o,e).incrementalPrepareUpdate(o),this._clearLayer(n),this._finished=!1},incrementalRender:function(e,t,n){this._lineDraw.incrementalUpdate(e,t.getData()),this._finished=e.end===t.getData().count()},updateTransform:function(e,t,n){var o=e.getData(),i=e.pipelineContext;if(!this._finished||i.large||i.progressiveRender)return{update:!0};var r=$E.reset(e);r.progress&&r.progress({start:0,end:o.count()},o),this._lineDraw.updateLayout(),this._clearLayer(n)},_updateLineDraw:function(e,t){var n=this._lineDraw,o=this._showEffect(t),i=!!t.get("polyline"),r=t.pipelineContext.large;return n&&o===this._hasEffet&&i===this._isPolyline&&r===this._isLargeDraw||(n&&n.remove(),n=this._lineDraw=r?new HE:new FC(i?o?FE:LE:o?KE:LC),this._hasEffet=o,this._isPolyline=i,this._isLargeDraw=r,this.group.removeAll()),this.group.add(n.group),n},_showEffect:function(e){return!!e.get("effect.show")},_clearLayer:function(e){var t=e.getZr();"svg"===t.painter.getType()||null==this._lastZlevel||t.painter.getLayer(this._lastZlevel).clear(!0)},remove:function(e,t){this._lineDraw&&this._lineDraw.remove(),this._lineDraw=null,this._clearLayer(t)},dispose:function(){}});var qE="lineStyle.opacity".split("."),jE={seriesType:"lines",reset:function(e,t,n){var o=UE(e.get("symbol")),i=UE(e.get("symbolSize")),r=e.getData();return r.setVisual("fromSymbol",o&&o[0]),r.setVisual("toSymbol",o&&o[1]),r.setVisual("fromSymbolSize",i&&i[0]),r.setVisual("toSymbolSize",i&&i[1]),r.setVisual("opacity",e.get(qE)),{dataEach:r.hasItemOption?function(e,t){var n=e.getItemModel(t),o=UE(n.getShallow("symbol",!0)),i=UE(n.getShallow("symbolSize",!0)),r=n.get(qE);o[0]&&e.setItemVisual(t,"fromSymbol",o[0]),o[1]&&e.setItemVisual(t,"toSymbol",o[1]),i[0]&&e.setItemVisual(t,"fromSymbolSize",i[0]),i[1]&&e.setItemVisual(t,"toSymbolSize",i[1]),e.setItemVisual(t,"opacity",r)}:null}}};function GE(){var e=T();this.canvas=e,this.blurSize=30,this.pointSize=20,this.maxOpacity=1,this.minOpacity=0,this._gradientPixels={}}oh($E),ih(jE),Wc.extend({type:"series.heatmap",getInitialData:function(e,t){return Xh(this.getSource(),this,{generateCoord:"value"})},preventIncremental:function(){var e=Uu.get(this.get("coordinateSystem"));if(e&&e.dimensions)return"lng"===e.dimensions[0]&&"lat"===e.dimensions[1]},defaultOption:{coordinateSystem:"cartesian2d",zlevel:0,z:2,geoIndex:0,blurSize:30,pointSize:20,maxOpacity:1,minOpacity:0}}),GE.prototype={update:function(e,t,n,o,i,r){var a=this._getBrush(),s=this._getGradient(e,i,"inRange"),l=this._getGradient(e,i,"outOfRange"),u=this.pointSize+this.blurSize,c=this.canvas,d=c.getContext("2d"),f=e.length;c.width=t,c.height=n;for(var h=0;h<f;++h){var g=e[h],m=g[0],p=g[1],v=o(g[2]);d.globalAlpha=v,d.drawImage(a,m-u,p-u)}if(!c.width||!c.height)return c;for(var y=d.getImageData(0,0,c.width,c.height),b=y.data,C=0,T=b.length,x=this.minOpacity,E=this.maxOpacity-x;C<T;){v=b[C+3]/256;var _=4*Math.floor(255*v);if(0<v){var I=r(v)?s:l;0<v&&(v=v*E+x),b[C++]=I[_],b[C++]=I[1+_],b[C++]=I[2+_],b[C++]=I[3+_]*v*256}else C+=4}return d.putImageData(y,0,0),c},_getBrush:function(){var e=this._brushCanvas||(this._brushCanvas=T()),t=this.pointSize+this.blurSize,n=2*t;e.width=n,e.height=n;var o=e.getContext("2d");return o.clearRect(0,0,n,n),o.shadowOffsetX=n,o.shadowBlur=this.blurSize,o.shadowColor="#000",o.beginPath(),o.arc(-t,t,this.pointSize,0,2*Math.PI,!0),o.closePath(),o.fill(),e},_getGradient:function(e,t,n){for(var o=this._gradientPixels,i=o[n]||(o[n]=new Uint8ClampedArray(1024)),r=[0,0,0,0],a=0,s=0;s<256;s++)t[n](s/255,!0,r),i[a++]=r[0],i[a++]=r[1],i[a++]=r[2],i[a++]=r[3];return i}},ch({type:"heatmap",render:function(e,t,n){var o;t.eachComponent("visualMap",(function(t){t.eachTargetSeries((function(n){n===e&&(o=t)}))})),this.group.removeAll(),this._incrementalDisplayable=null;var i=e.coordinateSystem;"cartesian2d"===i.type||"calendar"===i.type?this._renderOnCartesianAndCalendar(e,n,0,e.getData().count()):function(e){var t=e.dimensions;return"lng"===t[0]&&"lat"===t[1]}(i)&&this._renderOnGeo(i,e,o,n)},incrementalPrepareRender:function(e,t,n){this.group.removeAll()},incrementalRender:function(e,t,n,o){t.coordinateSystem&&this._renderOnCartesianAndCalendar(t,o,e.start,e.end,!0)},_renderOnCartesianAndCalendar:function(e,t,n,o,i){var r,a,s=e.coordinateSystem;if("cartesian2d"===s.type){var l=s.getAxis("x"),u=s.getAxis("y");r=l.getBandWidth(),a=u.getBandWidth()}for(var c=this.group,d=e.getData(),f="emphasis.itemStyle",h="emphasis.label",g=e.getModel("itemStyle").getItemStyle(["color"]),m=e.getModel(f).getItemStyle(),p=e.getModel("label"),v=e.getModel(h),y=s.type,C="cartesian2d"===y?[d.mapDimension("x"),d.mapDimension("y"),d.mapDimension("value")]:[d.mapDimension("time"),d.mapDimension("value")],T=n;T<o;T++){var x;if("cartesian2d"===y){if(isNaN(d.get(C[2],T)))continue;var E=s.dataToPoint([d.get(C[0],T),d.get(C[1],T)]);x=new Ua({shape:{x:Math.floor(Math.round(E[0])-r/2),y:Math.floor(Math.round(E[1])-a/2),width:Math.ceil(r),height:Math.ceil(a)},style:{fill:d.getItemVisual(T,"color"),opacity:d.getItemVisual(T,"opacity")}})}else{if(isNaN(d.get(C[1],T)))continue;x=new Ua({z2:1,shape:s.dataToRect([d.get(C[0],T)]).contentShape,style:{fill:d.getItemVisual(T,"color"),opacity:d.getItemVisual(T,"opacity")}})}var _=d.getItemModel(T);d.hasItemOption&&(g=_.getModel("itemStyle").getItemStyle(["color"]),m=_.getModel(f).getItemStyle(),p=_.getModel("label"),v=_.getModel(h));var I=e.getRawValue(T),D="-";I&&null!=I[2]&&(D=I[2]),Fs(g,m,p,v,{labelFetcher:e,labelDataIndex:T,defaultText:D,isRectText:!0}),x.setStyle(g),Ks(x,d.hasItemOption?m:b({},m)),(x.incremental=i)&&(x.useHoverLayer=!0),c.add(x),d.setItemGraphicEl(T,x)}},_renderOnGeo:function(e,t,n,o){var i=n.targetVisuals.inRange,r=n.targetVisuals.outOfRange,a=t.getData(),s=this._hmLayer||this._hmLayer||new GE;s.blurSize=t.get("blurSize"),s.pointSize=t.get("pointSize"),s.minOpacity=t.get("minOpacity"),s.maxOpacity=t.get("maxOpacity");var l=e.getViewRect().clone(),u=e.getRoamTransform();l.applyTransform(u);var c=Math.max(l.x,0),d=Math.max(l.y,0),f=Math.min(l.width+l.x,o.getWidth()),h=Math.min(l.height+l.y,o.getHeight()),g=f-c,m=h-d,p=[a.mapDimension("lng"),a.mapDimension("lat"),a.mapDimension("value")],v=a.mapArray(p,(function(t,n,o){var i=e.dataToPoint([t,n]);return i[0]-=c,i[1]-=d,i.push(o),i})),y=n.getExtent(),b="visualMap.continuous"===n.type?function(e,t){var n=e[1]-e[0];return t=[(t[0]-e[0])/n,(t[1]-e[0])/n],function(e){return e>=t[0]&&e<=t[1]}}(y,n.option.range):function(e,t,n){var o=e[1]-e[0],i=(t=w(t,(function(t){return{interval:[(t.interval[0]-e[0])/o,(t.interval[1]-e[0])/o]}}))).length,r=0;return function(e){for(var o=r;o<i;o++)if((a=t[o].interval)[0]<=e&&e<=a[1]){r=o;break}if(o===i)for(o=r-1;0<=o;o--){var a;if((a=t[o].interval)[0]<=e&&e<=a[1]){r=o;break}}return 0<=o&&o<i&&n[o]}}(y,n.getPieceList(),n.option.selected);s.update(v,g,m,i.color.getNormalizer(),{inRange:i.color.getColorMapper(),outOfRange:r.color.getColorMapper()},b);var C=new Wo({style:{width:g,height:m,x:c,y:d,image:s.canvas},silent:!0});this.group.add(C)},dispose:function(){}});var XE=ev.extend({type:"series.pictorialBar",dependencies:["grid"],defaultOption:{symbol:"circle",symbolSize:null,symbolRotate:null,symbolPosition:null,symbolOffset:null,symbolMargin:null,symbolRepeat:!1,symbolRepeatDirection:"end",symbolClip:!1,symbolBoundingData:null,symbolPatternSize:400,barGap:"-100%",progressive:0,hoverAnimation:!1},getInitialData:function(e){return e.stack=null,XE.superApply(this,"getInitialData",arguments)}}),YE=["itemStyle","borderWidth"],ZE=[{xy:"x",wh:"width",index:0,posDesc:["left","right"]},{xy:"y",wh:"height",index:1,posDesc:["top","bottom"]}],JE=new Aa;function QE(e,t,n,o){var i=e.getItemLayout(t),r=n.get("symbolRepeat"),a=n.get("symbolClip"),s=n.get("symbolPosition")||"start",l=(n.get("symbolRotate")||0)*Math.PI/180||0,u=n.get("symbolPatternSize")||2,c=n.isAnimationEnabled(),d={dataIndex:t,layout:i,itemModel:n,symbolType:e.getItemVisual(t,"symbol")||"circle",color:e.getItemVisual(t,"color"),symbolClip:a,symbolRepeat:r,symbolRepeatDirection:n.get("symbolRepeatDirection"),symbolPatternSize:u,rotation:l,animationModel:c?n:null,hoverAnimation:c&&n.get("hoverAnimation"),z2:n.getShallow("z",!0)||0};!function(e,t,n,o,i){var r,a=o.valueDim,s=e.get("symbolBoundingData"),l=o.coordSys.getOtherAxis(o.coordSys.getBaseAxis()),u=l.toGlobalCoord(l.dataToCoord(0)),c=1-+(n[a.wh]<=0);if(M(s)){var d=[e_(l,s[0])-u,e_(l,s[1])-u];d[1]<d[0]&&d.reverse(),r=d[c]}else r=null!=s?e_(l,s)-u:t?o.coordSysExtent[a.index][c]-u:n[a.wh];i.boundingLength=r,t&&(i.repeatCutLength=n[a.wh]),i.pxSign=0<r?1:r<0?-1:0}(n,r,i,o,d),function(e,t,n,o,i,r,a,s,l,u){var c=l.valueDim,d=l.categoryDim,f=Math.abs(n[d.wh]),h=e.getItemVisual(t,"symbolSize");(h=M(h)?h.slice():(null==h&&(h="100%"),[h,h]))[d.index]=Cl(h[d.index],f),h[c.index]=Cl(h[c.index],o?f:Math.abs(r)),u.symbolSize=h,(u.symbolScale=[h[0]/s,h[1]/s])[c.index]*=(l.isHorizontal?-1:1)*a}(e,t,i,r,0,d.boundingLength,d.pxSign,u,o,d),function(e,t,n,o,i){var r=e.get(YE)||0;r&&(JE.attr({scale:t.slice(),rotation:n}),JE.updateTransform(),r/=JE.getLineScale(),r*=t[o.valueDim.index]),i.valueLineWidth=r}(n,d.symbolScale,l,o,d);var f=d.symbolSize,h=n.get("symbolOffset");return M(h)&&(h=[Cl(h[0],f[0]),Cl(h[1],f[1])]),function(e,t,n,o,i,r,a,s,l,u,c,d){var f=c.categoryDim,h=c.valueDim,g=d.pxSign,m=Math.max(t[h.index]+s,0),p=m;if(o){var v=Math.abs(l),y=H(e.get("symbolMargin"),"15%")+"",C=!1;y.lastIndexOf("!")===y.length-1&&(C=!0,y=y.slice(0,y.length-1)),y=Cl(y,t[h.index]);var T=Math.max(m+2*y,0),x=C?0:2*y,E=Pl(o),_=E?o:p_((v+x)/T);T=m+2*(y=(v-_*m)/2/(C?_:_-1)),x=C?0:2*y,E||"fixed"===o||(_=u?p_((Math.abs(u)+x)/T):0),p=_*T-x,d.repeatTimes=_,d.symbolMargin=y}var I=g*(p/2),D=d.pathPosition=[];D[f.index]=n[f.wh]/2,D[h.index]="start"===a?I:"end"===a?l-I:l/2,r&&(D[0]+=r[0],D[1]+=r[1]);var O=d.bundlePosition=[];O[f.index]=n[f.xy],O[h.index]=n[h.xy];var w=d.barRectShape=b({},n);w[h.wh]=g*Math.max(Math.abs(n[h.wh]),Math.abs(D[h.index]+I)),w[f.wh]=n[f.wh];var R=d.clipShape={};R[f.xy]=-n[f.xy],R[f.wh]=c.ecSize[f.wh],R[h.xy]=0,R[h.wh]=n[h.wh]}(n,f,i,r,0,h,s,d.valueLineWidth,d.boundingLength,d.repeatCutLength,o,d),d}function e_(e,t){return e.toGlobalCoord(e.dataToCoord(e.scale.parse(t)))}function t_(e){var t=e.symbolPatternSize,n=tm(e.symbolType,-t/2,-t/2,t,t,e.color);return n.attr({culling:!0}),"image"!==n.type&&n.setStyle({strokeNoScale:!0}),n}function n_(e,t,n,o){var i=e.__pictorialBundle,r=n.pathPosition,a=t.valueDim,s=n.repeatTimes||0,l=0,u=n.symbolSize[t.valueDim.index]+n.valueLineWidth+2*n.symbolMargin;for(h_(e,(function(e){e.__pictorialAnimationIndex=l,e.__pictorialRepeatTimes=s,l<s?g_(e,null,f(l),n,o):g_(e,null,{scale:[0,0]},n,o,(function(){i.remove(e)})),u_(e,n),l++}));l<s;l++){var c=t_(n);c.__pictorialAnimationIndex=l,c.__pictorialRepeatTimes=s,i.add(c);var d=f(l);g_(c,{position:d.position,scale:[0,0]},{scale:d.scale,rotation:d.rotation},n,o),c.on("mouseover",h).on("mouseout",g),u_(c,n)}function f(e){var t=r.slice(),o=n.pxSign,i=e;return("start"===n.symbolRepeatDirection?0<o:o<0)&&(i=s-1-e),t[a.index]=u*(i-s/2+.5)+r[a.index],{position:t,scale:n.symbolScale.slice(),rotation:n.rotation}}function h(){h_(e,(function(e){e.trigger("emphasis")}))}function g(){h_(e,(function(e){e.trigger("normal")}))}}function o_(e,t,n,o){var i=e.__pictorialBundle,r=e.__pictorialMainPath;r?g_(r,null,{position:n.pathPosition.slice(),scale:n.symbolScale.slice(),rotation:n.rotation},n,o):(r=e.__pictorialMainPath=t_(n),i.add(r),g_(r,{position:n.pathPosition.slice(),scale:[0,0],rotation:n.rotation},{scale:n.symbolScale.slice()},n,o),r.on("mouseover",(function(){this.trigger("emphasis")})).on("mouseout",(function(){this.trigger("normal")}))),u_(r,n)}function i_(e,t,n){var o=b({},t.barRectShape),i=e.__pictorialBarRect;i?g_(i,null,{shape:o},t,n):(i=e.__pictorialBarRect=new Ua({z2:2,shape:o,silent:!0,style:{stroke:"transparent",fill:"transparent",lineWidth:0}}),e.add(i))}function r_(e,t,n,o){if(n.symbolClip){var i=e.__pictorialClipPath,r=b({},n.clipShape),a=t.valueDim,s=n.animationModel,l=n.dataIndex;if(i)Xs(i,{shape:r},s,l);else{r[a.wh]=0,i=new Ua({shape:r}),e.__pictorialBundle.setClipPath(i),e.__pictorialClipPath=i;var u={};u[a.wh]=n.clipShape[a.wh],al[o?"updateProps":"initProps"](i,{shape:u},s,l)}}}function a_(e,t){var n=e.getItemModel(t);return n.getAnimationDelayParams=s_,n.isAnimationEnabled=l_,n}function s_(e){return{index:e.__pictorialAnimationIndex,count:e.__pictorialRepeatTimes}}function l_(){return this.parentModel.isAnimationEnabled()&&!!this.getShallow("animation")}function u_(e,t){e.off("emphasis").off("normal");var n=t.symbolScale.slice();t.hoverAnimation&&e.on("emphasis",(function(){this.animateTo({scale:[1.1*n[0],1.1*n[1]]},400,"elasticOut")})).on("normal",(function(){this.animateTo({scale:n.slice()},400,"elasticOut")}))}function c_(e,t,n,o){var i=new _n,r=new _n;return i.add(r),(i.__pictorialBundle=r).attr("position",n.bundlePosition.slice()),n.symbolRepeat?n_(i,t,n):o_(i,0,n),i_(i,n,o),r_(i,t,n,o),i.__pictorialShapeStr=f_(e,n),i.__pictorialSymbolMeta=n,i}function d_(e,t,n,o){var i=o.__pictorialBarRect;i&&(i.style.text=null);var r=[];h_(o,(function(e){r.push(e)})),o.__pictorialMainPath&&r.push(o.__pictorialMainPath),o.__pictorialClipPath&&(n=null),O(r,(function(e){Xs(e,{scale:[0,0]},n,t,(function(){o.parent&&o.parent.remove(o)}))})),e.setItemGraphicEl(t,null)}function f_(e,t){return[e.getItemVisual(t.dataIndex,"symbol")||"none",!!t.symbolRepeat,!!t.symbolClip].join(":")}function h_(e,t,n){O(e.__pictorialBundle.children(),(function(o){o!==e.__pictorialBarRect&&t.call(n,o)}))}function g_(e,t,n,o,i,r){t&&e.attr(t),o.symbolClip&&!i?n&&e.attr(n):n&&al[i?"updateProps":"initProps"](e,n,o.animationModel,o.dataIndex,r)}function m_(e,t,n){var o=n.color,i=n.dataIndex,r=n.itemModel,a=r.getModel("itemStyle").getItemStyle(["color"]),s=r.getModel("emphasis.itemStyle").getItemStyle(),l=r.getShallow("cursor");h_(e,(function(e){e.setColor(o),e.setStyle(C({fill:o,opacity:n.opacity},a)),Ks(e,s),l&&(e.cursor=l),e.z2=n.z2}));var u={},c=e.__pictorialBarRect;tv(c.style,u,r,o,t.seriesModel,i),Ks(c,u)}function p_(e){var t=Math.round(e);return Math.abs(e-t)<1e-4?t:Math.ceil(e)}function v_(e,t,n,o,i){pm.call(this,e,t,n),this.type=o||"value",this.position=i||"bottom",this.orient=null}function y_(e,t,n){this.dimension="single",this.dimensions=["single"],this._axis=null,this._init(e,t,n),this.model=e}function b_(e,t){t=t||{};var n=e.axis,o={},i=n.position,r=n.orient,a=e.coordinateSystem.getRect(),s=[a.x,a.x+a.width,a.y,a.y+a.height],l={horizontal:{top:s[2],bottom:s[3]},vertical:{left:s[0],right:s[1]}};o.position=["vertical"===r?l.vertical[i]:s[0],"horizontal"===r?l.horizontal[i]:s[3]],o.rotation=Math.PI/2*{horizontal:0,vertical:1}[r],o.labelDirection=o.tickDirection=o.nameDirection={top:-1,bottom:1,right:1,left:-1}[i],e.get("axisTick.inside")&&(o.tickDirection=-o.tickDirection),H(t.labelInside,e.get("axisLabel.inside"))&&(o.labelDirection=-o.labelDirection);var u=t.rotate;return null==u&&(u=e.get("axisLabel.rotate")),o.labelRotation="top"===i?-u:u,o.z2=1,o}ch({type:"pictorialBar",render:function(e,t,n){var o=this.group,i=e.getData(),r=this._data,a=e.coordinateSystem,s=!!a.getBaseAxis().isHorizontal(),l=a.grid.getRect(),u={ecSize:{width:n.getWidth(),height:n.getHeight()},seriesModel:e,coordSys:a,coordSysExtent:[[l.x,l.x+l.width],[l.y,l.y+l.height]],isHorizontal:s,valueDim:ZE[+s],categoryDim:ZE[1-s]};return i.diff(r).add((function(e){if(i.hasValue(e)){var t=a_(i,e),n=QE(i,e,t,u),r=c_(i,u,n);i.setItemGraphicEl(e,r),o.add(r),m_(r,u,n)}})).update((function(e,t){var n=r.getItemGraphicEl(t);if(i.hasValue(e)){var a=a_(i,e),s=QE(i,e,a,u),l=f_(i,s);n&&l!==n.__pictorialShapeStr&&(o.remove(n),i.setItemGraphicEl(e,null),n=null),n?function(e,t,n){var o=n.animationModel,i=n.dataIndex;Xs(e.__pictorialBundle,{position:n.bundlePosition.slice()},o,i),n.symbolRepeat?n_(e,t,n,!0):o_(e,0,n,!0),i_(e,n,!0),r_(e,t,n,!0)}(n,u,s):n=c_(i,u,s,!0),i.setItemGraphicEl(e,n),n.__pictorialSymbolMeta=s,o.add(n),m_(n,u,s)}else o.remove(n)})).remove((function(e){var t=r.getItemGraphicEl(e);t&&d_(r,e,t.__pictorialSymbolMeta.animationModel,t)})).execute(),this._data=i,this.group},dispose:te,remove:function(e,t){var n=this.group,o=this._data;e.get("animation")?o&&o.eachItemGraphicEl((function(t){d_(o,t.dataIndex,e,t)})):n.removeAll()}}),oh(N(vg,"pictorialBar")),ih(rp("pictorialBar","roundRect")),v_.prototype={constructor:v_,model:null,isHorizontal:function(){var e=this.position;return"top"===e||"bottom"===e},pointToData:function(e,t){return this.coordinateSystem.pointToData(e,t)[0]},toGlobalCoord:null,toLocalCoord:null},_(v_,pm),Uu.register("single",{create:function(e,t){var n=[];return e.eachComponent("singleAxis",(function(o,i){var r=new y_(o,e,t);r.name="single_"+i,r.resize(o,t),o.coordinateSystem=r,n.push(r)})),e.eachSeries((function(t){if("singleAxis"===t.get("coordinateSystem")){var n=e.queryComponents({mainType:"singleAxis",index:t.get("singleAxisIndex"),id:t.get("singleAxisId")})[0];t.coordinateSystem=n&&n.coordinateSystem}})),n},dimensions:(y_.prototype={type:"singleAxis",axisPointerEnabled:!0,constructor:y_,_init:function(e,t,n){var o=new v_(this.dimension,Vg(e),[0,0],e.get("type"),e.get("position"));o.onBand="category"===o.type&&e.get("boundaryGap"),o.inverse=e.get("inverse"),o.orient=e.get("orient"),(e.axis=o).model=e,(o.coordinateSystem=this)._axis=o},update:function(e,t){e.eachSeries((function(e){if(e.coordinateSystem===this){var t=e.getData();O(t.mapDimension(this.dimension,!0),(function(e){this._axis.scale.unionExtentFromData(t,e)}),this),zg(this._axis.scale,this._axis.model)}}),this)},resize:function(e,t){this._rect=au({left:e.get("left"),top:e.get("top"),right:e.get("right"),bottom:e.get("bottom"),width:e.get("width"),height:e.get("height")},{width:t.getWidth(),height:t.getHeight()}),this._adjustAxis()},getRect:function(){return this._rect},_adjustAxis:function(){var e=this._rect,t=this._axis,n=t.isHorizontal(),o=n?[0,e.width]:[0,e.height],i=t.reverse?1:0;t.setExtent(o[i],o[1-i]),this._updateAxisTransform(t,n?e.x:e.y)},_updateAxisTransform:function(e,t){var n=e.getExtent(),o=n[0]+n[1],i=e.isHorizontal();e.toGlobalCoord=i?function(e){return e+t}:function(e){return o-e+t},e.toLocalCoord=i?function(e){return e-t}:function(e){return o-e+t}},getAxis:function(){return this._axis},getBaseAxis:function(){return this._axis},getAxes:function(){return[this._axis]},getTooltipAxes:function(){return{baseAxes:[this.getAxis()]}},containPoint:function(e){var t=this.getRect(),n=this.getAxis();return"horizontal"===n.orient?n.contain(n.toLocalCoord(e[0]))&&e[1]>=t.y&&e[1]<=t.y+t.height:n.contain(n.toLocalCoord(e[1]))&&e[0]>=t.y&&e[0]<=t.y+t.height},pointToData:function(e){var t=this.getAxis();return[t.coordToData(t.toLocalCoord(e["horizontal"===t.orient?0:1]))]},dataToPoint:function(e){var t=this.getAxis(),n=this.getRect(),o=[],i="horizontal"===t.orient?0:1;return e instanceof Array&&(e=e[0]),o[i]=t.toGlobalCoord(t.dataToCoord(+e)),o[1-i]=0==i?n.y+n.height/2:n.x+n.width/2,o}}).dimensions});var C_=["axisLine","axisTickLabel","axisName"],T_=["splitArea","splitLine"],x_=$p.extend({type:"singleAxis",axisPointerClass:"SingleAxisPointer",render:function(e,t,n,o){var i=this.group;i.removeAll();var r=this._axisGroup;this._axisGroup=new _n;var a=b_(e),s=new wp(e,a);O(C_,s.add,s),i.add(this._axisGroup),i.add(s.getGroup()),O(T_,(function(t){e.get(t+".show")&&this["_"+t](e)}),this),el(r,this._axisGroup,e),x_.superCall(this,"render",e,t,n,o)},remove:function(){Yp(this)},_splitLine:function(e){var t=e.axis;if(!t.scale.isBlank()){var n=e.getModel("splitLine"),o=n.getModel("lineStyle"),i=o.get("width"),r=o.get("color");r=r instanceof Array?r:[r];for(var a=e.coordinateSystem.getRect(),s=t.isHorizontal(),l=[],u=0,c=t.getTicksCoords({tickModel:n}),d=[],f=[],h=0;h<c.length;++h){var g=t.toGlobalCoord(c[h].coord);s?(d[0]=g,d[1]=a.y,f[0]=g,f[1]=a.y+a.height):(d[0]=a.x,d[1]=g,f[0]=a.x+a.width,f[1]=g);var m=u++%r.length;l[m]=l[m]||[],l[m].push(new ja({subPixelOptimize:!0,shape:{x1:d[0],y1:d[1],x2:f[0],y2:f[1]},style:{lineWidth:i},silent:!0}))}for(h=0;h<l.length;++h)this.group.add(bs(l[h],{style:{stroke:r[h%r.length],lineDash:o.getLineDash(i),lineWidth:i},silent:!0}))}},_splitArea:function(e){Xp(this,this._axisGroup,e,e)}}),E_=mu.extend({type:"singleAxis",layoutMode:"box",axis:null,coordinateSystem:null,getCoordSysModel:function(){return this}});function __(e,t){var n,o=[],i=e.seriesIndex;if(null==i||!(n=t.getSeriesByIndex(i)))return{point:[]};var r=n.getData(),a=Ki(r,e);if(null==a||a<0||M(a))return{point:[]};var s=r.getItemGraphicEl(a),l=n.coordinateSystem;if(n.getTooltipPosition)o=n.getTooltipPosition(a)||[];else if(l&&l.dataToPoint)o=l.dataToPoint(r.getValues(w(l.dimensions,(function(e){return r.mapDimension(e)})),a,!0))||[];else if(s){var u=s.getBoundingRect().clone();u.applyTransform(s.transform),o=[u.x+u.width/2,u.y+u.height/2]}return{point:o,el:s}}v(E_.prototype,qg),mp("single",E_,(function(e,t){return t.type||(t.data?"category":"value")}),{left:"5%",top:"5%",right:"5%",bottom:"5%",type:"value",position:"bottom",orient:"horizontal",axisLine:{show:!0,lineStyle:{width:1,type:"solid"}},tooltip:{show:!0},axisTick:{show:!0,length:6,lineStyle:{width:1}},axisLabel:{show:!0,interval:"auto"},splitLine:{show:!0,lineStyle:{type:"dashed",opacity:.2}}});var I_=O,D_=N,O_=Pi();function w_(e,t,n,o,i){var r=e.axis;if(!r.scale.isBlank()&&r.containData(t))if(e.involveSeries){var a=function(e,t){var n=t.axis,o=n.dim,i=e,r=[],a=Number.MAX_VALUE,s=-1;return I_(t.seriesModels,(function(t,l){var u,c,d=t.getData().mapDimension(o,!0);if(t.getAxisTooltipData){var f=t.getAxisTooltipData(d,e,n);c=f.dataIndices,u=f.nestestValue}else{if(!(c=t.getData().indicesOfNearest(d[0],e,"category"===n.type?.5:null)).length)return;u=t.getData().get(d[0],c[0])}if(null!=u&&isFinite(u)){var h=e-u,g=Math.abs(h);g<=a&&((g<a||0<=h&&s<0)&&(a=g,s=h,i=u,r.length=0),I_(c,(function(e){r.push({seriesIndex:t.seriesIndex,dataIndexInside:e,dataIndex:t.getData().getRawIndex(e)})})))}})),{payloadBatch:r,snapToValue:i}}(t,e),s=a.payloadBatch,l=a.snapToValue;s[0]&&null==i.seriesIndex&&b(i,s[0]),!o&&e.snap&&r.containData(l)&&null!=l&&(t=l),n.showPointer(e,t,s,i),n.showTooltip(e,a,l)}else n.showPointer(e,t)}function R_(e,t,n,o){e[t.key]={value:n,payloadBatch:o}}function S_(e,t,n,o){var i=n.payloadBatch,r=t.axis,a=r.model,s=t.axisPointerModel;if(t.triggerTooltip&&i.length){var l=t.coordSys.model,u=Wp(l),c=e.map[u];c||(c=e.map[u]={coordSysId:l.id,coordSysIndex:l.componentIndex,coordSysType:l.type,coordSysMainType:l.mainType,dataByAxis:[]},e.list.push(c)),c.dataByAxis.push({axisDim:r.dim,axisIndex:a.componentIndex,axisType:a.type,axisId:a.id,value:o,valueLabelOpt:{precision:s.get("label.precision"),formatter:s.get("label.formatter")},seriesDataIndices:i.slice()})}}function k_(e){var t=e.axis.model,n={},o=n.axisDim=e.axis.dim;return n.axisIndex=n[o+"AxisIndex"]=t.componentIndex,n.axisName=n[o+"AxisName"]=t.name,n.axisId=n[o+"AxisId"]=t.id,n}function A_(e){return!e||null==e[0]||isNaN(e[0])||null==e[1]||isNaN(e[1])}sh({type:"axisPointer",coordSysAxesInfo:null,defaultOption:{show:"auto",triggerOn:null,zlevel:0,z:50,type:"line",snap:!1,triggerTooltip:!0,value:null,status:null,link:[],animation:null,animationDurationUpdate:200,lineStyle:{color:"#aaa",width:1,type:"solid"},shadowStyle:{color:"rgba(150,150,150,0.3)"},label:{show:!0,formatter:null,precision:"auto",margin:3,color:"#fff",padding:[5,7,5,7],backgroundColor:"auto",borderColor:null,borderWidth:0,shadowBlur:3,shadowColor:"#aaa"},handle:{show:!1,icon:"M10.7,11.9v-1.3H9.3v1.3c-4.9,0.3-8.8,4.4-8.8,9.4c0,5,3.9,9.1,8.8,9.4h1.3c4.9-0.3,8.8-4.4,8.8-9.4C19.5,16.3,15.6,12.2,10.7,11.9z M13.3,24.4H6.7v-1.2h6.6z M13.3,22H6.7v-1.2h6.6z M13.3,19.6H6.7v-1.2h6.6z",size:45,margin:50,color:"#333",shadowBlur:3,shadowColor:"#aaa",shadowOffsetX:0,shadowOffsetY:2,throttle:40}}});var N_=Pi(),M_=O;function K_(e,t,n){if(!i.node){var o=t.getZr();N_(o).records||(N_(o).records={}),function(e,t){function n(n,o){e.on(n,(function(n){var i=function(e){var t={showTip:[],hideTip:[]},n=function(o){var i=t[o.type];i?i.push(o):(o.dispatchAction=n,e.dispatchAction(o))};return{dispatchAction:n,pendings:t}}(t);M_(N_(e).records,(function(e){e&&o(e,n,i.dispatchAction)})),function(e,t){var n,o=e.showTip.length,i=e.hideTip.length;o?n=e.showTip[o-1]:i&&(n=e.hideTip[i-1]),n&&(n.dispatchAction=null,t.dispatchAction(n))}(i.pendings,t)}))}N_(e).initialized||(N_(e).initialized=!0,n("click",N(L_,"click")),n("mousemove",N(L_,"mousemove")),n("globalout",P_))}(o,t),(N_(o).records[e]||(N_(o).records[e]={})).handler=n}}function P_(e,t,n){e.handler("leave",null,n)}function L_(e,t,n,o){t.handler(e,n,o)}function B_(e,t){if(!i.node){var n=t.getZr();(N_(n).records||{})[e]&&(N_(n).records[e]=null)}}var F_=lh({type:"axisPointer",render:function(e,t,n){var o=t.getComponent("tooltip"),i=e.get("triggerOn")||o&&o.get("triggerOn")||"mousemove|click";K_("axisPointer",n,(function(e,t,n){"none"!==i&&("leave"===e||0<=i.indexOf(e))&&n({type:"updateAxisPointer",currTrigger:e,x:t&&t.offsetX,y:t&&t.offsetY})}))},remove:function(e,t){B_(t.getZr(),"axisPointer"),F_.superApply(this._model,"remove",arguments)},dispose:function(e,t){B_("axisPointer",t),F_.superApply(this._model,"dispose",arguments)}}),z_=Pi(),V_=p,H_=A;function W_(){}function $_(e,t,n,o){!function e(t,n){if(L(t)&&L(n)){var o=!0;return O(n,(function(n,i){o=o&&e(t[i],n)})),!!o}return t===n}(z_(n).lastProp,o)&&(z_(n).lastProp=o,t?Xs(n,o,e):(n.stopAnimation(),n.attr(o)))}function U_(e,t){e[t.get("label.show")?"show":"hide"]()}function q_(e){return{position:e.position.slice(),rotation:e.rotation||0}}function j_(e,t,n){var o=t.get("z"),i=t.get("zlevel");e&&e.traverse((function(e){"group"!==e.type&&(null!=o&&(e.z=o),null!=i&&(e.zlevel=i),e.silent=n)}))}function G_(e){var t,n=e.get("type"),o=e.getModel(n+"Style");return"line"===n?(t=o.getLineStyle()).fill=null:"shadow"===n&&((t=o.getAreaStyle()).stroke=null),t}function X_(e,t,n,o,i){var r=Y_(n.get("value"),t.axis,t.ecModel,n.get("seriesDataIndices"),{precision:n.get("label.precision"),formatter:n.get("label.formatter")}),a=n.getModel("label"),s=zl(a.get("padding")||0),l=a.getFont(),u=io(r,l),c=i.position,d=u.width+s[1]+s[3],f=u.height+s[0]+s[2],h=i.align;"right"===h&&(c[0]-=d),"center"===h&&(c[0]-=d/2);var g=i.verticalAlign;"bottom"===g&&(c[1]-=f),"middle"===g&&(c[1]-=f/2),function(e,t,n,o){var i=o.getWidth(),r=o.getHeight();e[0]=Math.min(e[0]+t,i)-t,e[1]=Math.min(e[1]+n,r)-n,e[0]=Math.max(e[0],0),e[1]=Math.max(e[1],0)}(c,d,f,o);var m=a.get("backgroundColor");m&&"auto"!==m||(m=t.get("axisLine.lineStyle.color")),e.label={shape:{x:0,y:0,width:d,height:f,r:a.get("borderRadius")},position:c.slice(),style:{text:r,textFont:l,textFill:a.getTextColor(),textPosition:"inside",textPadding:s,fill:m,stroke:a.get("borderColor")||"transparent",lineWidth:a.get("borderWidth")||0,shadowBlur:a.get("shadowBlur"),shadowColor:a.get("shadowColor"),shadowOffsetX:a.get("shadowOffsetX"),shadowOffsetY:a.get("shadowOffsetY")},z2:10}}function Y_(e,t,n,o,i){e=t.scale.parse(e);var r=t.scale.getLabel(e,{precision:i.precision}),a=i.formatter;if(a){var s={value:Wg(t,e),axisDimension:t.dim,axisIndex:t.index,seriesData:[]};O(o,(function(e){var t=n.getSeriesByIndex(e.seriesIndex),o=t&&t.getDataParams(e.dataIndexInside);o&&s.seriesData.push(o)})),P(a)?r=a.replace("{value}",r):K(a)&&(r=a(s))}return r}function Z_(e,t,n){var o=ot();return lt(o,o,n.rotation),st(o,o,n.position),Js([e.dataToCoord(t),(n.labelOffset||0)+(n.labelDirection||1)*(n.labelMargin||0)],o)}function J_(e,t,n,o,i,r){var a=wp.innerTextLayout(n.rotation,0,n.labelDirection);n.labelMargin=i.get("label.margin"),X_(t,o,i,r,{position:Z_(o.axis,e,n),align:a.textAlign,verticalAlign:a.textVerticalAlign})}function Q_(e,t,n){return{x1:e[n=n||0],y1:e[1-n],x2:t[n],y2:t[1-n]}}function eI(e,t,n){return{x:e[n=n||0],y:e[1-n],width:t[n],height:t[1-n]}}function tI(e,t,n,o,i,r){return{cx:e,cy:t,r0:n,r:o,startAngle:i,endAngle:r,clockwise:!0}}Ui((W_.prototype={_group:null,_lastGraphicKey:null,_handle:null,_dragging:!1,_lastValue:null,_lastStatus:null,_payloadInfo:null,animationThreshold:15,render:function(e,t,n,o){var i=t.get("value"),r=t.get("status");if(this._axisModel=e,this._axisPointerModel=t,this._api=n,o||this._lastValue!==i||this._lastStatus!==r){this._lastValue=i,this._lastStatus=r;var a=this._group,s=this._handle;if(!r||"hide"===r)return a&&a.hide(),void(s&&s.hide());a&&a.show(),s&&s.show();var l={};this.makeElOption(l,i,e,t,n);var u=l.graphicKey;u!==this._lastGraphicKey&&this.clear(n),this._lastGraphicKey=u;var c=this._moveAnimation=this.determineAnimation(e,t);if(a){var d=N($_,t,c);this.updatePointerEl(a,l,d,t),this.updateLabelEl(a,l,d,t)}else a=this._group=new _n,this.createPointerEl(a,l,e,t),this.createLabelEl(a,l,e,t),n.getZr().add(a);j_(a,t,!0),this._renderHandle(i)}},remove:function(e){this.clear(e)},dispose:function(e){this.clear(e)},determineAnimation:function(e,t){var n=t.get("animation"),o=e.axis,i="category"===o.type,r=t.get("snap");if(!r&&!i)return!1;if("auto"!==n&&null!=n)return!0===n;var a=this.animationThreshold;if(i&&o.getBandWidth()>a)return!0;if(r){var s=Vp(e).seriesDataCount,l=o.getExtent();return Math.abs(l[0]-l[1])/s>a}return!1},makeElOption:function(e,t,n,o,i){},createPointerEl:function(e,t,n,o){var i=t.pointer;if(i){var r=z_(e).pointerEl=new al[i.type](V_(t.pointer));e.add(r)}},createLabelEl:function(e,t,n,o){if(t.label){var i=z_(e).labelEl=new Ua(V_(t.label));e.add(i),U_(i,o)}},updatePointerEl:function(e,t,n){var o=z_(e).pointerEl;o&&t.pointer&&(o.setStyle(t.pointer.style),n(o,{shape:t.pointer.shape}))},updateLabelEl:function(e,t,n,o){var i=z_(e).labelEl;i&&(i.setStyle(t.label.style),n(i,{shape:t.label.shape,position:t.label.position}),U_(i,o))},_renderHandle:function(e){if(!this._dragging&&this.updateHandleTransform){var t,n=this._axisPointerModel,o=this._api.getZr(),i=this._handle,r=n.getModel("handle"),a=n.get("status");if(!r.get("show")||!a||"hide"===a)return i&&o.remove(i),void(this._handle=null);this._handle||(t=!0,i=this._handle=nl(r.get("icon"),{cursor:"move",draggable:!0,onmousemove:function(e){$e(e.event)},onmousedown:H_(this._onHandleDragMove,this,0,0),drift:H_(this._onHandleDragMove,this),ondragend:H_(this._onHandleDragEnd,this)}),o.add(i)),j_(i,n,!1),i.setStyle(r.getItemStyle(null,["color","borderColor","borderWidth","opacity","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY"]));var s=r.get("size");M(s)||(s=[s,s]),i.attr("scale",[s[0]/2,s[1]/2]),hd(this,"_doDispatchAxisPointer",r.get("throttle")||0,"fixRate"),this._moveHandleToValue(e,t)}},_moveHandleToValue:function(e,t){$_(this._axisPointerModel,!t&&this._moveAnimation,this._handle,q_(this.getHandleTransform(e,this._axisModel,this._axisPointerModel)))},_onHandleDragMove:function(e,t){var n=this._handle;if(n){this._dragging=!0;var o=this.updateHandleTransform(q_(n),[e,t],this._axisModel,this._axisPointerModel);this._payloadInfo=o,n.stopAnimation(),n.attr(q_(o)),z_(n).lastProp=null,this._doDispatchAxisPointer()}},_doDispatchAxisPointer:function(){if(this._handle){var e=this._payloadInfo,t=this._axisModel;this._api.dispatchAction({type:"updateAxisPointer",x:e.cursorPoint[0],y:e.cursorPoint[1],tooltipOption:e.tooltipOption,axesInfo:[{axisDim:t.axis.dim,axisIndex:t.componentIndex}]})}},_onHandleDragEnd:function(e){if(this._dragging=!1,this._handle){var t=this._axisPointerModel.get("value");this._moveHandleToValue(t),this._api.dispatchAction({type:"hideTip"})}},getHandleTransform:null,updateHandleTransform:null,clear:function(e){this._lastValue=null,this._lastStatus=null;var t=e.getZr(),n=this._group,o=this._handle;t&&n&&(this._lastGraphicKey=null,n&&t.remove(n),o&&t.remove(o),this._group=null,this._handle=null,this._payloadInfo=null)},doClear:function(){},buildLabel:function(e,t,n){return{x:e[n=n||0],y:e[1-n],width:t[n],height:t[1-n]}}}).constructor=W_);var nI=W_.extend({makeElOption:function(e,t,n,o,i){var r=n.axis,a=r.grid,s=o.get("type"),l=oI(a,r).getOtherAxis(r).getGlobalExtent(),u=r.toGlobalCoord(r.dataToCoord(t,!0));if(s&&"none"!==s){var c=G_(o),d=iI[s](r,u,l);d.style=c,e.graphicKey=d.type,e.pointer=d}J_(t,e,Gp(a.model,n),n,o,i)},getHandleTransform:function(e,t,n){var o=Gp(t.axis.grid.model,t,{labelInside:!1});return o.labelMargin=n.get("handle.margin"),{position:Z_(t.axis,e,o),rotation:o.rotation+(o.labelDirection<0?Math.PI:0)}},updateHandleTransform:function(e,t,n,o){var i=n.axis,r=i.grid,a=i.getGlobalExtent(!0),s=oI(r,i).getOtherAxis(i).getGlobalExtent(),l="x"===i.dim?0:1,u=e.position;u[l]+=t[l],u[l]=Math.min(a[1],u[l]),u[l]=Math.max(a[0],u[l]);var c=(s[1]+s[0])/2,d=[c,c];return d[l]=u[l],{position:u,rotation:e.rotation,cursorPoint:d,tooltipOption:[{verticalAlign:"middle"},{align:"center"}][l]}}});function oI(e,t){var n={};return n[t.dim+"AxisIndex"]=t.index,e.getCartesian(n)}var iI={line:function(e,t,n){return{type:"Line",subPixelOptimize:!0,shape:Q_([t,n[0]],[t,n[1]],rI(e))}},shadow:function(e,t,n){var o=Math.max(1,e.getBandWidth());return{type:"Rect",shape:eI([t-o/2,n[0]],[o,n[1]-n[0]],rI(e))}}};function rI(e){return"x"===e.dim?0:1}$p.registerAxisPointerClass("CartesianAxisPointer",nI),Qf((function(e){if(e){e.axisPointer&&0!==e.axisPointer.length||(e.axisPointer={});var t=e.axisPointer.link;t&&!M(t)&&(e.axisPointer.link=[t])}})),eh(ff.PROCESSOR.STATISTIC,(function(e,t){e.getComponent("axisPointer").coordSysAxesInfo=function(e,t){var n={axesInfo:{},seriesInvolved:!1,coordSysAxesInfo:{},coordSysMap:{}};return function(e,t,n){var o=t.getComponent("tooltip"),i=t.getComponent("axisPointer"),r=i.get("link",!0)||[],a=[];Bp(n.getCoordinateSystems(),(function(n){if(n.axisPointerEnabled){var s=Wp(n.model),l=e.coordSysAxesInfo[s]={},u=(e.coordSysMap[s]=n).model.getModel("tooltip",o);if(Bp(n.getAxes(),Fp(h,!1,null)),n.getTooltipAxes&&o&&u.get("show")){var c="axis"===u.get("trigger"),d="cross"===u.get("axisPointer.type"),f=n.getTooltipAxes(u.get("axisPointer.axis"));(c||d)&&Bp(f.baseAxes,Fp(h,!d||"cross",c)),d&&Bp(f.otherAxes,Fp(h,"cross",!1))}}function h(o,s,c){var d=c.model.getModel("axisPointer",i),f=d.get("show");if(f&&("auto"!==f||o||Hp(d))){null==s&&(s=d.get("triggerTooltip"));var h=(d=o?function(e,t,n,o,i,r){var a=t.getModel("axisPointer"),s={};Bp(["type","snap","lineStyle","shadowStyle","label","animation","animationDurationUpdate","animationEasingUpdate","z"],(function(e){s[e]=p(a.get(e))})),s.snap="category"!==e.type&&!!r,"cross"===a.get("type")&&(s.type="line");var l=s.label||(s.label={});if(null==l.show&&(l.show=!1),"cross"===i){var u=a.get("label.show");if(l.show=null==u||u,!r){var c=s.lineStyle=a.get("crossStyle");c&&C(l,c.textStyle)}}return e.model.getModel("axisPointer",new hl(s,n,o))}(c,u,i,t,o,s):d).get("snap"),g=Wp(c.model),m=s||h||"category"===c.type,v=e.axesInfo[g]={key:g,axis:c,coordSys:n,axisPointerModel:d,triggerTooltip:s,involveSeries:m,snap:h,useHandle:Hp(d),seriesModels:[]};l[g]=v,e.seriesInvolved|=m;var y=function(e,t){for(var n=t.model,o=t.dim,i=0;i<e.length;i++){var r=e[i]||{};if(zp(r[o+"AxisId"],n.id)||zp(r[o+"AxisIndex"],n.componentIndex)||zp(r[o+"AxisName"],n.name))return i}}(r,c);if(null!=y){var b=a[y]||(a[y]={axesInfo:{}});b.axesInfo[g]=v,b.mapper=r[y].mapper,v.linkGroup=b}}}}))}(n,e,t),n.seriesInvolved&&function(e,t){t.eachSeries((function(t){var n=t.coordinateSystem,o=t.get("tooltip.trigger",!0),i=t.get("tooltip.show",!0);n&&"none"!==o&&!1!==o&&"item"!==o&&!1!==i&&!1!==t.get("axisPointer.show",!0)&&Bp(e.coordSysAxesInfo[Wp(n.model)],(function(e){var o=e.axis;n.getAxis(o.dim)===o&&(e.seriesModels.push(t),null==e.seriesDataCount&&(e.seriesDataCount=0),e.seriesDataCount+=t.getData().count())}))}),this)}(n,e),n}(e,t)})),th({type:"updateAxisPointer",event:"updateAxisPointer",update:":updateAxisPointer"},(function(e,t,n){var o=e.currTrigger,i=[e.x,e.y],r=e,a=e.dispatchAction||A(n.dispatchAction,n),s=t.getComponent("axisPointer").coordSysAxesInfo;if(s){A_(i)&&(i=__({seriesIndex:r.seriesIndex,dataIndex:r.dataIndex},t).point);var l=A_(i),u=r.axesInfo,c=s.axesInfo,d="leave"===o||A_(i),f={},h={},g={list:[],map:{}},m={showPointer:D_(R_,h),showTooltip:D_(S_,g)};I_(s.coordSysMap,(function(e,t){var n=l||e.containPoint(i);I_(s.coordSysAxesInfo[t],(function(e,t){var o=e.axis,r=function(e,t){for(var n=0;n<(e||[]).length;n++){var o=e[n];if(t.axis.dim===o.axisDim&&t.axis.model.componentIndex===o.axisIndex)return o}}(u,e);if(!d&&n&&(!u||r)){var a=r&&r.value;null!=a||l||(a=o.pointToData(i)),null!=a&&w_(e,a,m,!1,f)}}))}));var p={};return I_(c,(function(e,t){var n=e.linkGroup;n&&!h[t]&&I_(n.axesInfo,(function(t,o){var i=h[o];if(t!==e&&i){var r=i.value;n.mapper&&(r=e.axis.scale.parse(n.mapper(r,k_(t),k_(e)))),p[e.key]=r}}))})),I_(p,(function(e,t){w_(c[t],e,m,!0,f)})),function(e,t,n){var o=n.axesInfo=[];I_(t,(function(t,n){var i=t.axisPointerModel.option,r=e[n];r?(t.useHandle||(i.status="show"),i.value=r.value,i.seriesDataIndices=(r.payloadBatch||[]).slice()):t.useHandle||(i.status="hide"),"show"===i.status&&o.push({axisDim:t.axis.dim,axisIndex:t.axis.model.componentIndex,value:i.value})}))}(h,c,f),function(e,t,n,o){if(A_(t)||!e.list.length)return o({type:"hideTip"});var i=((e.list[0].dataByAxis[0]||{}).seriesDataIndices||[])[0]||{};o({type:"showTip",escapeConnect:!0,x:t[0],y:t[1],tooltipOption:n.tooltipOption,position:n.position,dataIndexInside:i.dataIndexInside,dataIndex:i.dataIndex,seriesIndex:i.seriesIndex,dataByCoordSys:e.list})}(g,i,e,a),function(e,t,n){var o=n.getZr(),i="axisPointerLastHighlights",r=O_(o)[i]||{},a=O_(o)[i]={};I_(e,(function(e,t){var n=e.axisPointerModel.option;"show"===n.status&&I_(n.seriesDataIndices,(function(e){a[e.seriesIndex+" | "+e.dataIndex]=e}))}));var s=[],l=[];O(r,(function(e,t){a[t]||l.push(e)})),O(a,(function(e,t){r[t]||s.push(e)})),l.length&&n.dispatchAction({type:"downplay",escapeConnect:!0,batch:l}),s.length&&n.dispatchAction({type:"highlight",escapeConnect:!0,batch:s})}(c,0,n),f}}));var aI=["x","y"],sI=["width","height"],lI=W_.extend({makeElOption:function(e,t,n,o,i){var r=n.axis,a=r.coordinateSystem,s=dI(a,1-cI(r)),l=a.dataToPoint(t)[0],u=o.get("type");if(u&&"none"!==u){var c=G_(o),d=uI[u](r,l,s);d.style=c,e.graphicKey=d.type,e.pointer=d}J_(t,e,b_(n),n,o,i)},getHandleTransform:function(e,t,n){var o=b_(t,{labelInside:!1});return o.labelMargin=n.get("handle.margin"),{position:Z_(t.axis,e,o),rotation:o.rotation+(o.labelDirection<0?Math.PI:0)}},updateHandleTransform:function(e,t,n,o){var i=n.axis,r=i.coordinateSystem,a=cI(i),s=dI(r,a),l=e.position;l[a]+=t[a],l[a]=Math.min(s[1],l[a]),l[a]=Math.max(s[0],l[a]);var u=dI(r,1-a),c=(u[1]+u[0])/2,d=[c,c];return d[a]=l[a],{position:l,rotation:e.rotation,cursorPoint:d,tooltipOption:{verticalAlign:"middle"}}}}),uI={line:function(e,t,n){return{type:"Line",subPixelOptimize:!0,shape:Q_([t,n[0]],[t,n[1]],cI(e))}},shadow:function(e,t,n){var o=e.getBandWidth();return{type:"Rect",shape:eI([t-o/2,n[0]],[o,n[1]-n[0]],cI(e))}}};function cI(e){return e.isHorizontal()?0:1}function dI(e,t){var n=e.getRect();return[n[aI[t]],n[aI[t]]+n[sI[t]]]}$p.registerAxisPointerClass("SingleAxisPointer",lI),lh({type:"single"});var fI=Wc.extend({type:"series.themeRiver",dependencies:["singleAxis"],nameMap:null,init:function(e){fI.superApply(this,"init",arguments),this.legendVisualProvider=new Ev(A(this.getData,this),A(this.getRawData,this))},fixData:function(e){var t=e.length,n={},o=Hi(e,(function(e){return n.hasOwnProperty(e[0])||(n[e[0]]=-1),e[2]})),i=[];o.buckets.each((function(e,t){i.push({name:t,dataList:e})}));for(var r=i.length,a=0;a<r;++a){for(var s=i[a].name,l=0;l<i[a].dataList.length;++l)n[u=i[a].dataList[l][0]]=a;for(var u in n)n.hasOwnProperty(u)&&n[u]!==a&&(n[u]=a,e[t]=[],e[t][0]=u,e[t][1]=0,e[t][2]=s,t++)}return e},getInitialData:function(e,t){for(var n=t.queryComponents({mainType:"singleAxis",index:this.get("singleAxisIndex"),id:this.get("singleAxisId")})[0].get("type"),o=S(e.data,(function(e){return void 0!==e[2]})),i=this.fixData(o||[]),r=[],a=this.nameMap=Q(),s=0,l=0;l<i.length;++l)r.push(i[l][2]),a.get(i[l][2])||(a.set(i[l][2],s),s++);var u=Hh(i,{coordDimensions:["single"],dimensionsDefine:[{name:"time",type:ph(n)},{name:"value",type:"float"},{name:"name",type:"ordinal"}],encodeDefine:{single:0,value:1,itemName:2}}),c=new wh(u,this);return c.initData(i),c},getLayerSeries:function(){for(var e=this.getData(),t=e.count(),n=[],o=0;o<t;++o)n[o]=o;var i=e.mapDimension("single"),r=Hi(n,(function(t){return e.get("name",t)})),a=[];return r.buckets.each((function(t,n){t.sort((function(t,n){return e.get(i,t)-e.get(i,n)})),a.push({name:n,indices:t})})),a},getAxisTooltipData:function(e,t,n){M(e)||(e=e?[e]:[]);for(var o,i=this.getData(),r=this.getLayerSeries(),a=[],s=r.length,l=0;l<s;++l){for(var u=Number.MAX_VALUE,c=-1,d=r[l].indices.length,f=0;f<d;++f){var h=i.get(e[0],r[l].indices[f]),g=Math.abs(h-t);g<=u&&(o=h,u=g,c=r[l].indices[f])}a.push(c)}return{dataIndices:a,nestestValue:o}},formatTooltip:function(e){var t=this.getData(),n=t.getName(e),o=t.get(t.mapDimension("value"),e);return!isNaN(o)&&null!=o||(o="-"),Wl(n+" : "+o)},defaultOption:{zlevel:0,z:2,coordinateSystem:"singleAxis",boundaryGap:["10%","10%"],singleAxisIndex:0,animationEasing:"linear",label:{margin:4,show:!0,position:"left",color:"#000",fontSize:11},emphasis:{label:{show:!0}}}});function hI(e,t,n){if(e.count())for(var o,i=t.coordinateSystem,r=t.getLayerSeries(),a=e.mapDimension("single"),s=e.mapDimension("value"),l=w(r,(function(t){return w(t.indices,(function(t){var n=i.dataToPoint(e.get(a,t));return n[1]=e.get(s,t),n}))})),u=function(e){for(var t=e.length,n=e[0].length,o=[],i=[],r=0,a={},s=0;s<n;++s){for(var l=0,u=0;l<t;++l)u+=e[l][s][1];r<u&&(r=u),o.push(u)}for(var c=0;c<n;++c)i[c]=(r-o[c])/2;for(var d=r=0;d<n;++d){var f=o[d]+i[d];r<f&&(r=f)}return a.y0=i,a.max=r,a}(l),c=u.y0,d=n/u.max,f=r.length,h=r[0].indices.length,g=0;g<h;++g){e.setItemLayout(r[0].indices[g],{layerIndex:0,x:l[0][g][0],y0:o=c[g]*d,y:l[0][g][1]*d});for(var m=1;m<f;++m)e.setItemLayout(r[m].indices[g],{layerIndex:m,x:l[m][g][0],y0:o+=l[m-1][g][1]*d,y:l[m][g][1]*d})}}ch({type:"themeRiver",init:function(){this._layers=[]},render:function(e,t,n){var o=e.getData(),i=this.group,r=e.getLayerSeries(),a=o.getLayout("layoutInfo");function s(e){return e.name}i.attr("position",[0,a.rect.y+a.boundaryGap[0]]);var l=new fh(this._layersSeries||[],r,s,s),u={};function c(t,n,a){var s=this._layers;if("remove"!==t){for(var l,c,d,f=[],h=[],g=r[n].indices,m=0;m<g.length;m++){var p=o.getItemLayout(g[m]),v=p.x,y=p.y0,C=p.y;f.push([v,y]),h.push([v,y+C]),l=o.getItemVisual(g[m],"color")}var T=o.getItemLayout(g[0]),x=o.getItemModel(g[m-1]),E=x.getModel("label"),_=E.get("margin");if("add"===t){var I=u[n]=new _n;c=new Ym({shape:{points:f,stackedOnPoints:h,smooth:.4,stackedOnSmooth:.4,smoothConstraint:!1},z2:0}),d=new Sa({style:{x:T.x-_,y:T.y0+T.y/2}}),I.add(c),I.add(d),i.add(I),c.setClipPath(function(e,t,n){var o=new Ua({shape:{x:e.x-10,y:e.y-10,width:0,height:e.height+20}});return Ys(o,{shape:{width:e.width+20,height:e.height+20}},t,(function(){c.removeClipPath()})),o}(c.getBoundingRect(),e))}else c=(I=s[a]).childAt(0),d=I.childAt(1),i.add(I),u[n]=I,Xs(c,{shape:{points:f,stackedOnPoints:h}},e),Xs(d,{style:{x:T.x-_,y:T.y0+T.y/2}},e);var D=x.getModel("emphasis.itemStyle"),O=x.getModel("itemStyle");Vs(d.style,E,{text:E.get("show")?e.getFormattedLabel(g[m-1],"normal")||o.getName(g[m-1]):null,textVerticalAlign:"middle"}),c.setStyle(b({fill:l},O.getItemStyle(["color"]))),Ks(c,D.getItemStyle())}else i.remove(s[n])}l.add(A(c,this,"add")).update(A(c,this,"update")).remove(A(c,this,"remove")).execute(),this._layersSeries=r,this._layers=u},dispose:function(){}}),oh((function(e,t){e.eachSeriesByType("themeRiver",(function(e){var t=e.getData(),n=e.coordinateSystem,o={},i=n.getRect();o.rect=i;var r=e.get("boundaryGap"),a=n.getAxis();o.boundaryGap=r,"horizontal"===a.orient?(r[0]=Cl(r[0],i.height),r[1]=Cl(r[1],i.height),hI(t,e,i.height-r[0]-r[1])):(r[0]=Cl(r[0],i.width),r[1]=Cl(r[1],i.width),hI(t,e,i.width-r[0]-r[1])),t.setLayout("layoutInfo",o)}))})),ih((function(e){e.eachSeriesByType("themeRiver",(function(e){var t=e.getData(),n=e.getRawData(),o=e.get("color"),i=Q();t.each((function(e){i.set(t.getRawIndex(e),e)})),n.each((function(r){var a=n.getName(r),s=o[(e.nameMap.get(a)-1)%o.length];n.setItemVisual(r,"color",s);var l=i.get(r);null!=l&&t.setItemVisual(l,"color",s)}))}))})),eh(Pv("themeRiver")),Wc.extend({type:"series.sunburst",_viewRoot:null,getInitialData:function(e,t){var n={name:e.name,children:e.data};!function e(t){var n=0;O(t.children,(function(t){e(t);var o=t.value;M(o)&&(o=o[0]),n+=o}));var o=t.value;M(o)&&(o=o[0]),null!=o&&!isNaN(o)||(o=n),o<0&&(o=0),M(t.value)?t.value[0]=o:t.value=o}(n);var o=w(e.levels||[],(function(e){return new hl(e,this,t)}),this),i=Qy.createTree(n,this,(function(e){e.wrapMethod("getItemModel",(function(e,t){var n=i.getNodeByDataIndex(t),r=o[n.depth];return r&&(e.parentModel=r),e}))}));return i.data},optionUpdated:function(){this.resetViewRoot()},getDataParams:function(e){var t=Wc.prototype.getDataParams.apply(this,arguments),n=this.getData().tree.getNodeByDataIndex(e);return t.treePathInfo=yb(n,this),t},defaultOption:{zlevel:0,z:2,center:["50%","50%"],radius:[0,"75%"],clockwise:!0,startAngle:90,minAngle:0,percentPrecision:2,stillShowZeroSum:!0,highlightPolicy:"descendant",nodeClick:"rootToNode",renderLabelForZeroData:!1,label:{rotate:"radial",show:!0,opacity:1,align:"center",position:"inside",distance:5,silent:!0},itemStyle:{borderWidth:1,borderColor:"white",borderType:"solid",shadowBlur:0,shadowColor:"rgba(0, 0, 0, 0.2)",shadowOffsetX:0,shadowOffsetY:0,opacity:1},highlight:{itemStyle:{opacity:1}},downplay:{itemStyle:{opacity:.5},label:{opacity:.6}},animationType:"expansion",animationDuration:1e3,animationDurationUpdate:500,animationEasing:"cubicOut",data:[],levels:[],sort:"desc"},getViewRoot:function(){return this._viewRoot},resetViewRoot:function(e){e?this._viewRoot=e:e=this._viewRoot;var t=this.getRawData().tree.root;e&&(e===t||t.contains(e))||(this._viewRoot=t)}});var gI="none";function mI(e,t,n){_n.call(this);var o=new Ma({z2:2});o.seriesIndex=t.seriesIndex;var i=new Sa({z2:4,silent:e.getModel("label").get("silent")});function r(){i.ignore=i.hoverIgnore}function a(){i.ignore=i.normalIgnore}this.add(o),this.add(i),this.updateData(!0,e,"normal",t,n),this.on("emphasis",r).on("normal",a).on("mouseover",r).on("mouseout",a)}var pI=mI.prototype;pI.updateData=function(e,t,n,o,i){(this.node=t).piece=this,o=o||this._seriesModel,i=i||this._ecModel;var r=this.childAt(0);r.dataIndex=t.dataIndex;var a=t.getModel(),s=t.getLayout(),l=b({},s);l.label=null;var u=function(e,t,n){var o=e.getVisual("color"),i=e.getVisual("visualMeta");i&&0!==i.length||(o=null);var r=e.getModel("itemStyle").get("color");if(r)return r;if(o)return o;if(0===e.depth)return n.option.color[0];var a=n.option.color.length;return n.option.color[function(e){for(var t=e;1<t.depth;)t=t.parentNode;return E(e.getAncestors()[0].children,t)}(e)%a]}(t,0,i);!function(e,t,n){t.getData().setItemVisual(e.dataIndex,"color",n)}(t,o,u);var c,d=a.getModel("itemStyle").getItemStyle();c=C({lineJoin:"bevel",fill:(c="normal"===n?d:v(a.getModel(n+".itemStyle").getItemStyle(),d)).fill||u},c),e?(r.setShape(l),r.shape.r=s.r0,Xs(r,{shape:{r:s.r}},o,t.dataIndex),r.useStyle(c)):"object"==typeof c.fill&&c.fill.type||"object"==typeof r.style.fill&&r.style.fill.type?(Xs(r,{shape:l},o),r.useStyle(c)):Xs(r,{shape:l,style:c},o),this._updateLabel(o,u,n);var f=a.getShallow("cursor");if(f&&r.attr("cursor",f),e){var h=o.getShallow("highlightPolicy");this._initEvents(r,t,o,h)}this._seriesModel=o||this._seriesModel,this._ecModel=i||this._ecModel,Ks(this)},pI.onEmphasis=function(e){var t=this;this.node.hostTree.root.eachNode((function(n){n.piece&&(t.node===n?n.piece.updateData(!1,n,"emphasis"):function(e,t,n){return n!==gI&&("self"===n?e===t:"ancestor"===n?e===t||e.isAncestorOf(t):e===t||e.isDescendantOf(t))}(n,t.node,e)?n.piece.childAt(0).trigger("highlight"):e!==gI&&n.piece.childAt(0).trigger("downplay"))}))},pI.onNormal=function(){this.node.hostTree.root.eachNode((function(e){e.piece&&e.piece.updateData(!1,e,"normal")}))},pI.onHighlight=function(){this.updateData(!1,this.node,"highlight")},pI.onDownplay=function(){this.updateData(!1,this.node,"downplay")},pI._updateLabel=function(e,t,n){var o=this.node.getModel(),i=o.getModel("label"),r="normal"===n||"emphasis"===n?i:o.getModel(n+".label"),a=o.getModel("emphasis.label"),s=r.get("formatter")?n:"normal",l=H(e.getFormattedLabel(this.node.dataIndex,s,null,null,"label"),this.node.name);!1===T("show")&&(l="");var u=this.node.getLayout(),c=r.get("minAngle");null==c&&(c=i.get("minAngle")),null!=(c=c/180*Math.PI)&&Math.abs(u.endAngle-u.startAngle)<c&&(l="");var d=this.childAt(1);Fs(d.style,d.hoverStyle||{},i,a,{defaultText:r.getShallow("show")?l:null,autoColor:t,useInsideStyle:!0});var f,h=(u.startAngle+u.endAngle)/2,g=Math.cos(h),m=Math.sin(h),p=T("position"),v=T("distance")||0,y=T("align");"outside"===p?(f=u.r+v,y=h>Math.PI/2?"right":"left"):y&&"center"!==y?"left"===y?(f=u.r0+v,h>Math.PI/2&&(y="right")):"right"===y&&(f=u.r-v,h>Math.PI/2&&(y="left")):(f=(u.r+u.r0)/2,y="center"),d.attr("style",{text:l,textAlign:y,textVerticalAlign:T("verticalAlign")||"middle",opacity:T("opacity")}),d.attr("position",[f*g+u.cx,f*m+u.cy]);var b=T("rotate"),C=0;function T(e){var t=r.get(e);return null==t?i.get(e):t}"radial"===b?(C=-h)<-Math.PI/2&&(C+=Math.PI):"tangential"===b?(C=Math.PI/2-h)>Math.PI/2?C-=Math.PI:C<-Math.PI/2&&(C+=Math.PI):"number"==typeof b&&(C=b*Math.PI/180),d.attr("rotation",C)},pI._initEvents=function(e,t,n,o){function i(){a.onEmphasis(o)}function r(){a.onNormal()}e.off("mouseover").off("mouseout").off("emphasis").off("normal");var a=this;n.isAnimationEnabled()&&e.on("mouseover",i).on("mouseout",r).on("emphasis",i).on("normal",r).on("downplay",(function(){a.onDownplay()})).on("highlight",(function(){a.onHighlight()}))},_(mI,_n),nd.extend({type:"sunburst",init:function(){},render:function(e,t,n,o){var i=this;this.seriesModel=e,this.api=n,this.ecModel=t;var r=e.getData(),a=r.tree.root,s=e.getViewRoot(),l=this.group,u=e.get("renderLabelForZeroData"),c=[];if(s.eachNode((function(e){c.push(e)})),function(n,o){function i(e){return e.getId()}function s(i,s){!function(n,o){if(u||!n||n.getValue()||(n=null),n!==a&&o!==a)if(o&&o.piece)n?(o.piece.updateData(!1,n,"normal",e,t),r.setItemGraphicEl(n.dataIndex,o.piece)):function(e){e&&e.piece&&(l.remove(e.piece),e.piece=null)}(o);else if(n){var i=new mI(n,e,t);l.add(i),r.setItemGraphicEl(n.dataIndex,i)}}(null==i?null:n[i],null==s?null:o[s])}0===n.length&&0===o.length||new fh(o,n,i,i).add(s).update(s).remove(N(s,null)).execute()}(c,this._oldChildren||[]),function(n,o){if(0<o.depth){i.virtualPiece?i.virtualPiece.updateData(!1,n,"normal",e,t):(i.virtualPiece=new mI(n,e,t),l.add(i.virtualPiece)),o.piece._onclickEvent&&o.piece.off("click",o.piece._onclickEvent);var r=function(e){i._rootToNode(o.parentNode)};o.piece._onclickEvent=r,i.virtualPiece.on("click",r)}else i.virtualPiece&&(l.remove(i.virtualPiece),i.virtualPiece=null)}(a,s),o&&o.highlight&&o.highlight.piece){var d=e.getShallow("highlightPolicy");o.highlight.piece.onEmphasis(d)}else if(o&&o.unhighlight){var f=this.virtualPiece;!f&&a.children.length&&(f=a.children[0].piece),f&&f.onNormal()}this._initEvents(),this._oldChildren=c},dispose:function(){},_initEvents:function(){function e(e){var n=!1;t.seriesModel.getViewRoot().eachNode((function(o){if(!n&&o.piece&&o.piece.childAt(0)===e.target){var i=o.getModel().get("nodeClick");if("rootToNode"===i)t._rootToNode(o);else if("link"===i){var r=o.getModel(),a=r.get("link");a&&Ql(a,r.get("target",!0)||"_blank")}n=!0}}))}var t=this;this.group._onclickEvent&&this.group.off("click",this.group._onclickEvent),this.group.on("click",e),this.group._onclickEvent=e},_rootToNode:function(e){e!==this.seriesModel.getViewRoot()&&this.api.dispatchAction({type:"sunburstRootToNode",from:this.uid,seriesId:this.seriesModel.id,targetNode:e})},containPoint:function(e,t){var n=t.getData().getItemLayout(0);if(n){var o=e[0]-n.cx,i=e[1]-n.cy,r=Math.sqrt(o*o+i*i);return r<=n.r&&r>=n.r0}}});var vI="sunburstRootToNode";th({type:vI,update:"updateView"},(function(e,t){t.eachComponent({mainType:"series",subType:"sunburst",query:e},(function(t,n){var o=mb(e,[vI],t);if(o){var i=t.getViewRoot();i&&(e.direction=vb(i,o.node)?"rollUp":"drillDown"),t.resetViewRoot(o.node)}}))}));var yI="sunburstHighlight";th({type:yI,update:"updateView"},(function(e,t){t.eachComponent({mainType:"series",subType:"sunburst",query:e},(function(t,n){var o=mb(e,[yI],t);o&&(e.highlight=o.node)}))})),th({type:"sunburstUnhighlight",update:"updateView"},(function(e,t){t.eachComponent({mainType:"series",subType:"sunburst",query:e},(function(t,n){e.unhighlight=!0}))}));var bI=Math.PI/180;function CI(e,t){return t=t||[0,0],w(["x","y"],(function(n,o){var i=this.getAxis(n),r=t[o],a=e[o]/2;return"category"===i.type?i.getBandWidth():Math.abs(i.dataToCoord(r-a)-i.dataToCoord(r+a))}),this)}function TI(e,t){return t=t||[0,0],w([0,1],(function(n){var o=t[n],i=e[n]/2,r=[],a=[];return r[n]=o-i,a[n]=o+i,r[1-n]=a[1-n]=t[1-n],Math.abs(this.dataToPoint(r)[n]-this.dataToPoint(a)[n])}),this)}function xI(e,t){var n=this.getAxis(),o=t instanceof Array?t[0]:t,i=(e instanceof Array?e[0]:e)/2;return"category"===n.type?n.getBandWidth():Math.abs(n.dataToCoord(o-i)-n.dataToCoord(o+i))}function EI(e,t){return w(["Radius","Angle"],(function(n,o){var i=this["get"+n+"Axis"](),r=t[o],a=e[o]/2,s="dataTo"+n,l="category"===i.type?i.getBandWidth():Math.abs(i[s](r-a)-i[s](r+a));return"Angle"===n&&(l=l*Math.PI/180),l}),this)}ih(N(Sv,"sunburst")),oh(N((function(e,t,n,o){t.eachSeriesByType(e,(function(e){var t=e.get("center"),o=e.get("radius");M(o)||(o=[0,o]),M(t)||(t=[t,t]);var i=n.getWidth(),r=n.getHeight(),a=Math.min(i,r),s=Cl(t[0],i),l=Cl(t[1],r),u=Cl(o[0],a/2),c=Cl(o[1],a/2),d=-e.get("startAngle")*bI,f=e.get("minAngle")*bI,h=e.getData().tree.root,g=e.getViewRoot(),m=g.depth,p=e.get("sort");null!=p&&function e(t,n){var o=t.children||[];t.children=function(e,t){if("function"==typeof t)return e.sort(t);var n="asc"===t;return e.sort((function(e,t){var o=(e.getValue()-t.getValue())*(n?1:-1);return 0==o?(e.dataIndex-t.dataIndex)*(n?-1:1):o}))}(o,n),o.length&&O(t.children,(function(t){e(t,n)}))}(g,p);var v=0;O(g.children,(function(e){isNaN(e.getValue())||v++}));var y=g.getValue(),b=Math.PI/(y||v)*2,C=0<g.depth,T=(c-u)/(g.height-(C?-1:1)||1),x=e.get("clockwise"),E=e.get("stillShowZeroSum"),_=x?1:-1,I=function(e,t){if(e){var n=t;if(e!==h){var o=e.getValue(),i=0===y&&E?b:o*b;i<f&&(i=f),n=t+_*i;var r=e.depth-m-(C?-1:1),c=u+T*r,d=u+T*(1+r),g=e.getModel();null!=g.get("r0")&&(c=Cl(g.get("r0"),a/2)),null!=g.get("r")&&(d=Cl(g.get("r"),a/2)),e.setLayout({angle:i,startAngle:t,endAngle:n,clockwise:x,cx:s,cy:l,r0:c,r:d})}if(e.children&&e.children.length){var p=0;O(e.children,(function(e){p+=I(e,t+p)}))}return n-t}};if(C){var D=2*Math.PI;h.setLayout({angle:D,startAngle:d,endAngle:d+D,clockwise:x,cx:s,cy:l,r0:u,r:u+T})}I(g,d)}))}),"sunburst")),eh(N(Pv,"sunburst"));var _I=ss,II=["itemStyle"],DI=["emphasis","itemStyle"],OI=["label"],wI=["emphasis","label"],RI={cartesian2d:function(e){var t=e.grid.getRect();return{coordSys:{type:"cartesian2d",x:t.x,y:t.y,width:t.width,height:t.height},api:{coord:function(t){return e.dataToPoint(t)},size:A(CI,e)}}},geo:function(e){var t=e.getBoundingRect();return{coordSys:{type:"geo",x:t.x,y:t.y,width:t.width,height:t.height,zoom:e.getZoom()},api:{coord:function(t){return e.dataToPoint(t)},size:A(TI,e)}}},singleAxis:function(e){var t=e.getRect();return{coordSys:{type:"singleAxis",x:t.x,y:t.y,width:t.width,height:t.height},api:{coord:function(t){return e.dataToPoint(t)},size:A(xI,e)}}},polar:function(e){var t=e.getRadiusAxis(),n=e.getAngleAxis(),o=t.getExtent();return o[0]>o[1]&&o.reverse(),{coordSys:{type:"polar",cx:e.cx,cy:e.cy,r:o[1],r0:o[0]},api:{coord:A((function(o){var i=t.dataToRadius(o[0]),r=n.dataToAngle(o[1]),a=e.coordToPoint([i,r]);return a.push(i,r*Math.PI/180),a})),size:A(EI,e)}}},calendar:function(e){var t=e.getRect(),n=e.getRangeInfo();return{coordSys:{type:"calendar",x:t.x,y:t.y,width:t.width,height:t.height,cellWidth:e.getCellWidth(),cellHeight:e.getCellHeight(),rangeInfo:{start:n.start,end:n.end,weeks:n.weeks,dayCount:n.allDay}},api:{coord:function(t,n){return e.dataToPoint(t,n)}}}}};function SI(e,t,n,o,i){null==n[e]||i||(t[e]=n[e],n[e]=o[e])}function kI(e,t,n,o){var i=e.get("renderItem"),r=e.coordinateSystem,a={};r&&(a=r.prepareCustoms?r.prepareCustoms():RI[r.type](r));var s,l,u,c,d,f=C({getWidth:o.getWidth,getHeight:o.getHeight,getZr:o.getZr,getDevicePixelRatio:o.getDevicePixelRatio,value:function(e,n){return null==n&&(n=s),t.get(t.getDimension(e||0),n)},style:function(n,o){null==o&&(o=s),m(o);var i=l.getModel(II).getItemStyle();null!=d&&(i.fill=d);var r=t.getItemVisual(o,"opacity");null!=r&&(i.opacity=r);var a=n?PI(n,u):u;return Vs(i,a,null,{autoColor:d,isRectText:!0}),i.text=a.getShallow("show")?W(e.getFormattedLabel(o,"normal"),Tm(t,o)):null,n&&LI(i,n),i},styleEmphasis:function(n,o){null==o&&(o=s),m(o);var i=l.getModel(DI).getItemStyle(),r=n?PI(n,c):c;return Vs(i,r,null,{isRectText:!0},!0),i.text=r.getShallow("show")?$(e.getFormattedLabel(o,"emphasis"),e.getFormattedLabel(o,"normal"),Tm(t,o)):null,n&&LI(i,n),i},visual:function(e,n){return null==n&&(n=s),t.getItemVisual(n,e)},barLayout:function(e){if(r.getBaseAxis)return function(e){var t=[],n=e.axis;if("category"===n.type){for(var o=n.getBandWidth(),i=0;i<e.count;i++)t.push(C({bandWidth:o,axisKey:"axis0",stackId:ug+i},e));var r=mg(t),a=[];for(i=0;i<e.count;i++){var s=r.axis0[ug+i];s.offsetCenter=s.offset+s.width/2,a.push(s)}return a}}(C({axis:r.getBaseAxis()},e))},currentSeriesIndices:function(){return n.getCurrentSeriesIndices()},font:function(e){return js(e,n)}},a.api||{}),h={context:{},seriesId:e.id,seriesName:e.name,seriesIndex:e.seriesIndex,coordSys:a.coordSys,dataInsideLength:t.count(),encode:function(e){var t={};return O(e.dimensions,(function(n,o){var i=e.getDimensionInfo(n);if(!i.isExtraCoord){var r=i.coordDim;(t[r]=t[r]||[])[i.coordDimIndex]=o}})),t}(e.getData())},g=!0;return function(e,n){return s=e,g=!0,i&&i(C({dataIndexInside:e,dataIndex:t.getRawIndex(e),actionType:n?n.type:null},h),f)};function m(e){null==e&&(e=s),g&&(l=t.getItemModel(e),u=l.getModel(OI),c=l.getModel(wI),d=t.getItemVisual(e,"color"),g=!1)}}function AI(e,t,n,o,i,r){return(e=NI(e,t,n,o,i,r,!0))&&r.setItemGraphicEl(t,e),e}function NI(e,t,n,o,i,r,a){var s=!n,l=(n=n||{}).type,u=n.shape,c=n.style;if(e&&(s||null!=l&&l!==e.__customGraphicType||"path"===l&&function(e){return e&&(e.hasOwnProperty("pathData")||e.hasOwnProperty("d"))}(u)&&FI(u)!==e.__customPathData||"image"===l&&zI(c,"image")&&c.image!==e.__customImagePath||"text"===l&&zI(u,"text")&&c.text!==e.__customText)&&(i.remove(e),e=null),!s){var d=!e;return function(e,t,n,o,i,r,a){var s={},l=n.style||{};if(n.shape&&(s.shape=p(n.shape)),n.position&&(s.position=n.position.slice()),n.scale&&(s.scale=n.scale.slice()),n.origin&&(s.origin=n.origin.slice()),n.rotation&&(s.rotation=n.rotation),"image"===e.type&&n.style){var u=s.style={};O(["x","y","width","height"],(function(t){SI(t,u,l,e.style,r)}))}if("text"===e.type&&n.style&&(u=s.style={},O(["x","y"],(function(t){SI(t,u,l,e.style,r)})),!l.hasOwnProperty("textFill")&&l.fill&&(l.textFill=l.fill),!l.hasOwnProperty("textStroke")&&l.stroke&&(l.textStroke=l.stroke)),"group"!==e.type&&(e.useStyle(l),r)){e.style.opacity=0;var c=l.opacity;null==c&&(c=1),Ys(e,{style:{opacity:c}},o,t)}r?e.attr(s):Xs(e,s,o,t),n.hasOwnProperty("z2")&&e.attr("z2",n.z2||0),n.hasOwnProperty("silent")&&e.attr("silent",n.silent),n.hasOwnProperty("invisible")&&e.attr("invisible",n.invisible),n.hasOwnProperty("ignore")&&e.attr("ignore",n.ignore),n.hasOwnProperty("info")&&e.attr("info",n.info);var d=n.styleEmphasis;Rs(e,d),a&&Ps(e,!1!==d)}(e=e||function(e){var t,n=e.type;if("path"===n){var o=e.shape,i=null!=o.width&&null!=o.height?{x:o.x||0,y:o.y||0,width:o.width,height:o.height}:null,r=FI(o);(t=ps(r,null,i,o.layout||"center")).__customPathData=r}else if("image"===n)(t=new Wo({})).__customImagePath=e.style.image;else if("text"===n)(t=new Sa({})).__customText=e.style.text;else if("group"===n)t=new _n;else{if("compoundPath"===n)throw new Error('"compoundPath" is not supported yet.');t=new(ms(n))}return t.__customGraphicType=n,t.name=e.name,t}(n),t,n,o,0,d,a),"group"===l&&function(e,t,n,o,i){var r=n.children,a=r?r.length:0,s=n.$mergeChildren,l="byName"===s||n.diffChildrenByName,u=!1===s;if(a||l||u){if(l)return function(e){new fh(e.oldChildren,e.newChildren,MI,MI,e).add(KI).update(KI).remove(BI).execute()}({oldChildren:e.children()||[],newChildren:r||[],dataIndex:t,animatableModel:o,group:e,data:i});u&&e.removeAll();for(var c=0;c<a;c++)r[c]&&NI(e.childAt(c),t,r[c],o,e,i)}}(e,t,n,o,r),i.add(e),e}}function MI(e,t){var n=e&&e.name;return null!=n?n:"e\0\0"+t}function KI(e,t){var n=this.context;NI(null!=t?n.oldChildren[t]:null,n.dataIndex,null!=e?n.newChildren[e]:null,n.animatableModel,n.group,n.data)}function PI(e,t){var n=new hl({},t);return O(_I,(function(t,o){e.hasOwnProperty(t)&&(n.option[o]=e[t])})),n}function LI(e,t){for(var n in t)!t.hasOwnProperty(n)&&_I.hasOwnProperty(n)||(e[n]=t[n])}function BI(e){var t=this.context,n=t.oldChildren[e];n&&t.group.remove(n)}function FI(e){return e&&(e.pathData||e.d)}function zI(e,t){return e&&e.hasOwnProperty(t)}function VI(e){return e.get("stack")||"__ec_stack_"+e.seriesIndex}function HI(e,t){return t.dim+e.model.componentIndex}function WI(e,t){pm.call(this,"radius",e,t),this.type="category"}Wc.extend({type:"series.custom",dependencies:["grid","polar","geo","singleAxis","calendar"],defaultOption:{coordinateSystem:"cartesian2d",zlevel:0,z:2,legendHoverLink:!0,useTransform:!0,clip:!1},getInitialData:function(e,t){return Xh(this.getSource(),this)},getDataParams:function(e,t,n){var o=Wc.prototype.getDataParams.apply(this,arguments);return n&&(o.info=n.info),o}}),nd.extend({type:"custom",_data:null,render:function(e,t,n,o){var i=this._data,r=e.getData(),a=this.group,s=kI(e,r,t,n);r.diff(i).add((function(t){AI(null,t,s(t,o),e,a,r)})).update((function(t,n){AI(i.getItemGraphicEl(n),t,s(t,o),e,a,r)})).remove((function(e){var t=i.getItemGraphicEl(e);t&&a.remove(t)})).execute();var l=e.get("clip",!0)?Qm(e.coordinateSystem,!1,e):null;l?a.setClipPath(l):a.removeClipPath(),this._data=r},incrementalPrepareRender:function(e,t,n){this.group.removeAll(),this._data=null},incrementalRender:function(e,t,n,o,i){var r=t.getData(),a=kI(t,r,n,o);function s(e){e.isGroup||(e.incremental=!0,e.useHoverLayer=!0)}for(var l=e.start;l<e.end;l++)AI(null,l,a(l,i),t,this.group,r).traverse(s)},dispose:te,filterForExposedEvent:function(e,t,n,o){var i=t.element;if(null==i||n.name===i)return!0;for(;(n=n.parent)&&n!==this.group;)if(n.name===i)return!0;return!1}}),WI.prototype={constructor:WI,pointToData:function(e,t){return this.polar.pointToData(e,t)["radius"===this.dim?0:1]},dataToRadius:pm.prototype.dataToCoord,radiusToData:pm.prototype.coordToData},_(WI,pm);var $I=Pi();function UI(e,t){pm.call(this,"angle",e,t=t||[0,360]),this.type="category"}function qI(e){this.name=e||"",this.cx=0,this.cy=0,this._radiusAxis=new WI,this._angleAxis=new UI,this._radiusAxis.polar=this._angleAxis.polar=this}UI.prototype={constructor:UI,pointToData:function(e,t){return this.polar.pointToData(e,t)["radius"===this.dim?0:1]},dataToAngle:pm.prototype.dataToCoord,angleToData:pm.prototype.coordToData,calculateCategoryInterval:function(){var e=this.getLabelModel(),t=this.scale,n=t.getExtent(),o=t.count();if(n[1]-n[0]<1)return 0;var i=n[0],r=this.dataToCoord(i+1)-this.dataToCoord(i),a=Math.abs(r),s=io(i,e.getFont(),"center","top"),l=Math.max(s.height,7)/a;isNaN(l)&&(l=1/0);var u=Math.max(0,Math.floor(l)),c=$I(this.model),d=c.lastAutoInterval,f=c.lastTickCount;return null!=d&&null!=f&&Math.abs(d-u)<=1&&Math.abs(f-o)<=1&&u<d?u=d:(c.lastTickCount=o,c.lastAutoInterval=u),u}},_(UI,pm),qI.prototype={type:"polar",axisPointerEnabled:!0,constructor:qI,dimensions:["radius","angle"],model:null,containPoint:function(e){var t=this.pointToCoord(e);return this._radiusAxis.contain(t[0])&&this._angleAxis.contain(t[1])},containData:function(e){return this._radiusAxis.containData(e[0])&&this._angleAxis.containData(e[1])},getAxis:function(e){return this["_"+e+"Axis"]},getAxes:function(){return[this._radiusAxis,this._angleAxis]},getAxesByScale:function(e){var t=[],n=this._angleAxis,o=this._radiusAxis;return n.scale.type===e&&t.push(n),o.scale.type===e&&t.push(o),t},getAngleAxis:function(){return this._angleAxis},getRadiusAxis:function(){return this._radiusAxis},getOtherAxis:function(e){var t=this._angleAxis;return e===t?this._radiusAxis:t},getBaseAxis:function(){return this.getAxesByScale("ordinal")[0]||this.getAxesByScale("time")[0]||this.getAngleAxis()},getTooltipAxes:function(e){var t=null!=e&&"auto"!==e?this.getAxis(e):this.getBaseAxis();return{baseAxes:[t],otherAxes:[this.getOtherAxis(t)]}},dataToPoint:function(e,t){return this.coordToPoint([this._radiusAxis.dataToRadius(e[0],t),this._angleAxis.dataToAngle(e[1],t)])},pointToData:function(e,t){var n=this.pointToCoord(e);return[this._radiusAxis.radiusToData(n[0],t),this._angleAxis.angleToData(n[1],t)]},pointToCoord:function(e){var t=e[0]-this.cx,n=e[1]-this.cy,o=this.getAngleAxis(),i=o.getExtent(),r=Math.min(i[0],i[1]),a=Math.max(i[0],i[1]);o.inverse?r=a-360:a=r+360;var s=Math.sqrt(t*t+n*n);t/=s,n/=s;for(var l=Math.atan2(-n,t)/Math.PI*180,u=l<r?1:-1;l<r||a<l;)l+=360*u;return[s,l]},coordToPoint:function(e){var t=e[0],n=e[1]/180*Math.PI;return[Math.cos(n)*t+this.cx,-Math.sin(n)*t+this.cy]},getArea:function(){var e=this.getAngleAxis(),t=this.getRadiusAxis().getExtent().slice();t[0]>t[1]&&t.reverse();var n=e.getExtent(),o=Math.PI/180;return{cx:this.cx,cy:this.cy,r0:t[0],r:t[1],startAngle:-n[0]*o,endAngle:-n[1]*o,clockwise:e.inverse,contain:function(e,t){var n=e-this.cx,o=t-this.cy,i=n*n+o*o,r=this.r,a=this.r0;return i<=r*r&&a*a<=i}}}};var jI=mu.extend({type:"polarAxis",axis:null,getCoordSysModel:function(){return this.ecModel.queryComponents({mainType:"polar",index:this.option.polarIndex,id:this.option.polarId})[0]}});function GI(e,t){return t.type||(t.data?"category":"value")}function XI(e,t){var n=this,o=n.getAngleAxis(),i=n.getRadiusAxis();if(o.scale.setExtent(1/0,-1/0),i.scale.setExtent(1/0,-1/0),e.eachSeries((function(e){if(e.coordinateSystem===n){var t=e.getData();O(t.mapDimension("radius",!0),(function(e){i.scale.unionExtentFromData(t,Gh(t,e))})),O(t.mapDimension("angle",!0),(function(e){o.scale.unionExtentFromData(t,Gh(t,e))}))}})),zg(o.scale,o.model),zg(i.scale,i.model),"category"===o.type&&!o.onBand){var r=o.getExtent(),a=360/o.scale.count();o.inverse?r[1]+=a:r[1]-=a,o.setExtent(r[0],r[1])}}function YI(e,t){if(e.type=t.get("type"),e.scale=Vg(t),e.onBand=t.get("boundaryGap")&&"category"===e.type,e.inverse=t.get("inverse"),"angleAxis"===t.mainType){e.inverse^=t.get("clockwise");var n=t.get("startAngle");e.setExtent(n,n+(e.inverse?-360:360))}(t.axis=e).model=t}v(jI.prototype,qg),mp("angle",jI,GI,{startAngle:90,clockwise:!0,splitNumber:12,axisLabel:{rotate:!1}}),mp("radius",jI,GI,{splitNumber:5}),sh({type:"polar",dependencies:["polarAxis","angleAxis"],coordinateSystem:null,findAxisModel:function(e){var t;return this.ecModel.eachComponent(e,(function(e){e.getCoordSysModel()===this&&(t=e)}),this),t},defaultOption:{zlevel:0,z:0,center:["50%","50%"],radius:"80%"}}),Uu.register("polar",{dimensions:qI.prototype.dimensions,create:function(e,t){var n=[];return e.eachComponent("polar",(function(e,o){var i=new qI(o);i.update=XI;var r=i.getRadiusAxis(),a=i.getAngleAxis(),s=e.findAxisModel("radiusAxis"),l=e.findAxisModel("angleAxis");YI(r,s),YI(a,l),function(e,t,n){var o=t.get("center"),i=n.getWidth(),r=n.getHeight();e.cx=Cl(o[0],i),e.cy=Cl(o[1],r);var a=e.getRadiusAxis(),s=Math.min(i,r)/2,l=t.get("radius");null==l?l=[0,"100%"]:M(l)||(l=[0,l]),l=[Cl(l[0],s),Cl(l[1],s)],a.inverse?a.setExtent(l[1],l[0]):a.setExtent(l[0],l[1])}(i,e,t),n.push(i),(e.coordinateSystem=i).model=e})),e.eachSeries((function(t){if("polar"===t.get("coordinateSystem")){var n=e.queryComponents({mainType:"polar",index:t.get("polarIndex"),id:t.get("polarId")})[0];t.coordinateSystem=n.coordinateSystem}})),n}});var ZI=["axisLine","axisLabel","axisTick","minorTick","splitLine","minorSplitLine","splitArea"];function JI(e,t,n){t[1]>t[0]&&(t=t.slice().reverse());var o=e.coordToPoint([t[0],n]),i=e.coordToPoint([t[1],n]);return{x1:o[0],y1:o[1],x2:i[0],y2:i[1]}}function QI(e){return e.getRadiusAxis().inverse?0:1}function eD(e){var t=e[0],n=e[e.length-1];t&&n&&Math.abs(Math.abs(t.coord-n.coord)-360)<1e-4&&e.pop()}$p.extend({type:"angleAxis",axisPointerClass:"PolarAxisPointer",render:function(e,t){if(this.group.removeAll(),e.get("show")){var n=e.axis,o=n.polar,i=o.getRadiusAxis().getExtent(),r=n.getTicksCoords(),a=n.getMinorTicksCoords(),s=w(n.getViewLabels(),(function(e){return(e=p(e)).coord=n.dataToCoord(e.tickValue),e}));eD(s),eD(r),O(ZI,(function(t){!e.get(t+".show")||n.scale.isBlank()&&"axisLine"!==t||this["_"+t](e,o,r,a,i,s)}),this)}},_axisLine:function(e,t,n,o,i){var r,a=e.getModel("axisLine.lineStyle"),s=QI(t),l=s?0:1;(r=0===i[l]?new Aa({shape:{cx:t.cx,cy:t.cy,r:i[s]},style:a.getLineStyle(),z2:1,silent:!0}):new Ka({shape:{cx:t.cx,cy:t.cy,r:i[s],r0:i[l]},style:a.getLineStyle(),z2:1,silent:!0})).style.fill=null,this.group.add(r)},_axisTick:function(e,t,n,o,i){var r=e.getModel("axisTick"),a=(r.get("inside")?-1:1)*r.get("length"),s=i[QI(t)],l=w(n,(function(e){return new ja({shape:JI(t,[s,s+a],e.coord)})}));this.group.add(bs(l,{style:C(r.getModel("lineStyle").getLineStyle(),{stroke:e.get("axisLine.lineStyle.color")})}))},_minorTick:function(e,t,n,o,i){if(o.length){for(var r=e.getModel("axisTick"),a=e.getModel("minorTick"),s=(r.get("inside")?-1:1)*a.get("length"),l=i[QI(t)],u=[],c=0;c<o.length;c++)for(var d=0;d<o[c].length;d++)u.push(new ja({shape:JI(t,[l,l+s],o[c][d].coord)}));this.group.add(bs(u,{style:C(a.getModel("lineStyle").getLineStyle(),C(r.getLineStyle(),{stroke:e.get("axisLine.lineStyle.color")}))}))}},_axisLabel:function(e,t,n,o,i,r){var a=e.getCategories(!0),s=e.getModel("axisLabel"),l=s.get("margin"),u=e.get("triggerEvent");O(r,(function(n,o){var r=s,c=n.tickValue,d=i[QI(t)],f=t.coordToPoint([d+l,n.coord]),h=t.cx,g=t.cy,m=Math.abs(f[0]-h)/d<.3?"center":f[0]>h?"left":"right",p=Math.abs(f[1]-g)/d<.3?"middle":f[1]>g?"top":"bottom";a&&a[c]&&a[c].textStyle&&(r=new hl(a[c].textStyle,s,s.ecModel));var v=new Sa({silent:wp.isLabelSilent(e)});this.group.add(v),Vs(v.style,r,{x:f[0],y:f[1],textFill:r.getTextColor()||e.get("axisLine.lineStyle.color"),text:n.formattedLabel,textAlign:m,textVerticalAlign:p}),u&&(v.eventData=wp.makeAxisEventDataBase(e),v.eventData.targetType="axisLabel",v.eventData.value=n.rawLabel)}),this)},_splitLine:function(e,t,n,o,i){var r=e.getModel("splitLine").getModel("lineStyle"),a=r.get("color"),s=0;a=a instanceof Array?a:[a];for(var l=[],u=0;u<n.length;u++){var c=s++%a.length;l[c]=l[c]||[],l[c].push(new ja({shape:JI(t,i,n[u].coord)}))}for(u=0;u<l.length;u++)this.group.add(bs(l[u],{style:C({stroke:a[u%a.length]},r.getLineStyle()),silent:!0,z:e.get("z")}))},_minorSplitLine:function(e,t,n,o,i){if(o.length){for(var r=e.getModel("minorSplitLine").getModel("lineStyle"),a=[],s=0;s<o.length;s++)for(var l=0;l<o[s].length;l++)a.push(new ja({shape:JI(t,i,o[s][l].coord)}));this.group.add(bs(a,{style:r.getLineStyle(),silent:!0,z:e.get("z")}))}},_splitArea:function(e,t,n,o,i){if(n.length){var r=e.getModel("splitArea").getModel("areaStyle"),a=r.get("color"),s=0;a=a instanceof Array?a:[a];for(var l=[],u=Math.PI/180,c=-n[0].coord*u,d=Math.min(i[0],i[1]),f=Math.max(i[0],i[1]),h=e.get("clockwise"),g=1;g<n.length;g++){var m=s++%a.length;l[m]=l[m]||[],l[m].push(new Ma({shape:{cx:t.cx,cy:t.cy,r0:d,r:f,startAngle:c,endAngle:-n[g].coord*u,clockwise:h},silent:!0})),c=-n[g].coord*u}for(g=0;g<l.length;g++)this.group.add(bs(l[g],{style:C({fill:a[g%a.length]},r.getAreaStyle()),silent:!0}))}}});var tD=["axisLine","axisTickLabel","axisName"],nD=["splitLine","splitArea","minorSplitLine"];$p.extend({type:"radiusAxis",axisPointerClass:"PolarAxisPointer",render:function(e,t){if(this.group.removeAll(),e.get("show")){var n=e.axis,o=n.polar,i=o.getAngleAxis(),r=n.getTicksCoords(),a=n.getMinorTicksCoords(),s=i.getExtent()[0],l=n.getExtent(),u=function(e,t,n){return{position:[e.cx,e.cy],rotation:n/180*Math.PI,labelDirection:-1,tickDirection:-1,nameDirection:1,labelRotate:t.getModel("axisLabel").get("rotate"),z2:1}}(o,e,s),c=new wp(e,u);O(tD,c.add,c),this.group.add(c.getGroup()),O(nD,(function(t){e.get(t+".show")&&!n.scale.isBlank()&&this["_"+t](e,o,s,l,r,a)}),this)}},_splitLine:function(e,t,n,o,i){var r=e.getModel("splitLine").getModel("lineStyle"),a=r.get("color"),s=0;a=a instanceof Array?a:[a];for(var l=[],u=0;u<i.length;u++){var c=s++%a.length;l[c]=l[c]||[],l[c].push(new Aa({shape:{cx:t.cx,cy:t.cy,r:i[u].coord}}))}for(u=0;u<l.length;u++)this.group.add(bs(l[u],{style:C({stroke:a[u%a.length],fill:null},r.getLineStyle()),silent:!0}))},_minorSplitLine:function(e,t,n,o,i,r){if(r.length){for(var a=e.getModel("minorSplitLine").getModel("lineStyle"),s=[],l=0;l<r.length;l++)for(var u=0;u<r[l].length;u++)s.push(new Aa({shape:{cx:t.cx,cy:t.cy,r:r[l][u].coord}}));this.group.add(bs(s,{style:C({fill:null},a.getLineStyle()),silent:!0}))}},_splitArea:function(e,t,n,o,i){if(i.length){var r=e.getModel("splitArea").getModel("areaStyle"),a=r.get("color"),s=0;a=a instanceof Array?a:[a];for(var l=[],u=i[0].coord,c=1;c<i.length;c++){var d=s++%a.length;l[d]=l[d]||[],l[d].push(new Ma({shape:{cx:t.cx,cy:t.cy,r0:u,r:i[c].coord,startAngle:0,endAngle:2*Math.PI},silent:!0})),u=i[c].coord}for(c=0;c<l.length;c++)this.group.add(bs(l[c],{style:C({fill:a[c%a.length]},r.getAreaStyle()),silent:!0}))}}});var oD=W_.extend({makeElOption:function(e,t,n,o,i){var r=n.axis;"angle"===r.dim&&(this.animationThreshold=Math.PI/18);var a,s=r.polar,l=s.getOtherAxis(r).getExtent();a=r["dataTo"+Zl(r.dim)](t);var u=o.get("type");if(u&&"none"!==u){var c=G_(o),d=iD[u](r,s,a,l,c);d.style=c,e.graphicKey=d.type,e.pointer=d}var f=o.get("label.margin");X_(e,n,o,i,function(e,t,n,o,i){var r=t.axis,a=r.dataToCoord(e),s=o.getAngleAxis().getExtent()[0];s=s/180*Math.PI;var l,u,c,d=o.getRadiusAxis().getExtent();if("radius"===r.dim){var f=ot();lt(f,f,s),st(f,f,[o.cx,o.cy]),l=Js([a,-i],f);var h=t.getModel("axisLabel").get("rotate")||0,g=wp.innerTextLayout(s,h*Math.PI/180,-1);u=g.textAlign,c=g.textVerticalAlign}else{var m=d[1];l=o.coordToPoint([m+i,a]);var p=o.cx,v=o.cy;u=Math.abs(l[0]-p)/m<.3?"center":l[0]>p?"left":"right",c=Math.abs(l[1]-v)/m<.3?"middle":l[1]>v?"top":"bottom"}return{position:l,align:u,verticalAlign:c}}(t,n,0,s,f))}}),iD={line:function(e,t,n,o,i){return"angle"===e.dim?{type:"Line",shape:Q_(t.coordToPoint([o[0],n]),t.coordToPoint([o[1],n]))}:{type:"Circle",shape:{cx:t.cx,cy:t.cy,r:n}}},shadow:function(e,t,n,o,i){var r=Math.max(1,e.getBandWidth()),a=Math.PI/180;return"angle"===e.dim?{type:"Sector",shape:tI(t.cx,t.cy,o[0],o[1],(-n-r/2)*a,(r/2-n)*a)}:{type:"Sector",shape:tI(t.cx,t.cy,n-r/2,n+r/2,0,2*Math.PI)}}};function rD(e,t){t.update="updateView",th(t,(function(t,n){var o={};return n.eachComponent({mainType:"geo",query:t},(function(n){n[e](t.name),O(n.coordinateSystem.regions,(function(e){o[e.name]=n.isSelected(e.name)||!1}))})),{selected:o,name:t.name}}))}function aD(e,t,n){this._model=e}function sD(e,t,n,o){var i=n.calendarModel,r=n.seriesModel,a=i?i.coordinateSystem:r?r.coordinateSystem:null;return a===this?a[e](o):null}$p.registerAxisPointerClass("PolarAxisPointer",oD),oh(N((function(e,t,n){var o={},i=function(e){var t={};O(e,(function(e,n){var o=e.getData(),i=e.coordinateSystem,r=i.getBaseAxis(),a=HI(i,r),s=r.getExtent(),l="category"===r.type?r.getBandWidth():Math.abs(s[1]-s[0])/o.count(),u=t[a]||{bandWidth:l,remainedWidth:l,autoWidthCount:0,categoryGap:"20%",gap:"30%",stacks:{}},c=u.stacks;t[a]=u;var d=VI(e);c[d]||u.autoWidthCount++,c[d]=c[d]||{width:0,maxWidth:0};var f=Cl(e.get("barWidth"),l),h=Cl(e.get("barMaxWidth"),l),g=e.get("barGap"),m=e.get("barCategoryGap");f&&!c[d].width&&(f=Math.min(u.remainedWidth,f),c[d].width=f,u.remainedWidth-=f),h&&(c[d].maxWidth=h),null!=g&&(u.gap=g),null!=m&&(u.categoryGap=m)}));var n={};return O(t,(function(e,t){n[t]={};var o=e.stacks,i=Cl(e.categoryGap,e.bandWidth),r=Cl(e.gap,1),a=e.remainedWidth,s=e.autoWidthCount,l=(a-i)/(s+(s-1)*r);l=Math.max(l,0),O(o,(function(e,t){var n=e.maxWidth;n&&n<l&&(n=Math.min(n,a),e.width&&(n=Math.min(n,e.width)),a-=n,e.width=n,s--)})),l=(a-i)/(s+(s-1)*r),l=Math.max(l,0);var u,c=0;O(o,(function(e,t){e.width||(e.width=l),c+=(u=e).width*(1+r)})),u&&(c-=u.width*r);var d=-c/2;O(o,(function(e,o){n[t][o]=n[t][o]||{offset:d,width:e.width},d+=e.width*(1+r)}))})),n}(S(t.getSeriesByType(e),(function(e){return!t.isSeriesFiltered(e)&&e.coordinateSystem&&"polar"===e.coordinateSystem.type})));t.eachSeriesByType(e,(function(e){if("polar"===e.coordinateSystem.type){var t=e.getData(),n=e.coordinateSystem,r=n.getBaseAxis(),a=HI(n,r),s=VI(e),l=i[a][s],u=l.offset,c=l.width,d=n.getOtherAxis(r),f=e.coordinateSystem.cx,h=e.coordinateSystem.cy,g=e.get("barMinHeight")||0,m=e.get("barMinAngle")||0;o[s]=o[s]||[];for(var p=t.mapDimension(d.dim),v=t.mapDimension(r.dim),y=jh(t,p),b="radius"!==r.dim||!e.get("roundCap",!0),C="radius"===d.dim?d.dataToRadius(0):d.dataToAngle(0),T=0,x=t.count();T<x;T++){var E,_,I,D,O=t.get(p,T),w=t.get(v,T),R=0<=O?"p":"n",S=C;if(y&&(o[s][w]||(o[s][w]={p:C,n:C}),S=o[s][w][R]),"radius"===d.dim){var k=d.dataToRadius(O)-C,A=r.dataToAngle(w);Math.abs(k)<g&&(k=(k<0?-1:1)*g),_=(E=S)+k,D=(I=A-u)-c,y&&(o[s][w][R]=_)}else{var N=d.dataToAngle(O,b)-C,M=r.dataToRadius(w);Math.abs(N)<m&&(N=(N<0?-1:1)*m),_=(E=M+u)+c,D=(I=S)+N,y&&(o[s][w][R]=D)}t.setItemLayout(T,{cx:f,cy:h,r0:E,r:_,startAngle:-I*Math.PI/180,endAngle:-D*Math.PI/180})}}}),this)}),"bar")),lh({type:"polar"}),I(mu.extend({type:"geo",coordinateSystem:null,layoutMode:"box",init:function(e){mu.prototype.init.apply(this,arguments),wi(e,"label",["show"])},optionUpdated:function(){var e=this.option,t=this;e.regions=Vy.getFilledRegions(e.regions,e.map,e.nameMap),this._optionModelMap=R(e.regions||[],(function(e,n){return n.name&&e.set(n.name,new hl(n,t)),e}),Q()),this.updateSelectedMap(e.regions)},defaultOption:{zlevel:0,z:0,show:!0,left:"center",top:"center",aspectScale:null,silent:!1,map:"",boundingCoords:null,center:null,zoom:1,scaleLimit:null,label:{show:!1,color:"#000"},itemStyle:{borderWidth:.5,borderColor:"#444",color:"#eee"},emphasis:{label:{show:!0,color:"rgb(100,0,0)"},itemStyle:{color:"rgba(255,215,0,0.8)"}},regions:[]},getRegionModel:function(e){return this._optionModelMap.get(e)||new hl(null,this,this.ecModel)},getFormattedLabel:function(e,t){t=t||"normal";var n=this.getRegionModel(e).get(("normal"===t?"":t+".")+"label.formatter"),o={name:e};return"function"==typeof n?(o.status=t,n(o)):"string"==typeof n?n.replace("{a}",null!=e?e:""):void 0},setZoom:function(e){this.option.zoom=e},setCenter:function(e){this.option.center=e}}),xv),lh({type:"geo",init:function(e,t){var n=new Oy(t,!0);this._mapDraw=n,this.group.add(n.group)},render:function(e,t,n,o){if(!o||"geoToggleSelect"!==o.type||o.from!==this.uid){var i=this._mapDraw;e.get("show")?i.draw(e,t,n,this,o):this._mapDraw.group.removeAll(),this.group.silent=e.get("silent")}},dispose:function(){this._mapDraw&&this._mapDraw.remove()}}),rD("toggleSelected",{type:"geoToggleSelect",event:"geoselectchanged"}),rD("select",{type:"geoSelect",event:"geoselected"}),rD("unSelect",{type:"geoUnSelect",event:"geounselected"}),aD.prototype={constructor:aD,type:"calendar",dimensions:["time","value"],getDimensionsInfo:function(){return[{name:"time",type:"time"},"value"]},getRangeInfo:function(){return this._rangeInfo},getModel:function(){return this._model},getRect:function(){return this._rect},getCellWidth:function(){return this._sw},getCellHeight:function(){return this._sh},getOrient:function(){return this._orient},getFirstDayOfWeek:function(){return this._firstDayOfWeek},getDateInfo:function(e){var t=(e=kl(e)).getFullYear(),n=e.getMonth()+1;n=n<10?"0"+n:n;var o=e.getDate();o=o<10?"0"+o:o;var i=e.getDay();return{y:t,m:n,d:o,day:i=Math.abs((i+7-this.getFirstDayOfWeek())%7),time:e.getTime(),formatedDate:t+"-"+n+"-"+o,date:e}},getNextNDay:function(e,t){return 0===(t=t||0)||(e=new Date(this.getDateInfo(e).time)).setDate(e.getDate()+t),this.getDateInfo(e)},update:function(e,t){this._firstDayOfWeek=+this._model.getModel("dayLabel").get("firstDay"),this._orient=this._model.get("orient"),this._lineWidth=this._model.getModel("itemStyle").getItemStyle().lineWidth||0,this._rangeInfo=this._getRangeInfo(this._initRangeOption());var n=this._rangeInfo.weeks||1,o=["width","height"],i=this._model.get("cellSize").slice(),r=this._model.getBoxLayoutParams(),a="horizontal"===this._orient?[n,7]:[7,n];O([0,1],(function(e){u(i,e)&&(r[o[e]]=i[e]*a[e])}));var s={width:t.getWidth(),height:t.getHeight()},l=this._rect=au(r,s);function u(e,t){return null!=e[t]&&"auto"!==e[t]}O([0,1],(function(e){u(i,e)||(i[e]=l[o[e]]/a[e])})),this._sw=i[0],this._sh=i[1]},dataToPoint:function(e,t){M(e)&&(e=e[0]),null==t&&(t=!0);var n=this.getDateInfo(e),o=this._rangeInfo;if(t&&!(n.time>=o.start.time&&n.time<o.end.time+864e5))return[NaN,NaN];var i=n.day,r=this._getRangeInfo([o.start.time,n.formatedDate]).nthWeek;return"vertical"===this._orient?[this._rect.x+i*this._sw+this._sw/2,this._rect.y+r*this._sh+this._sh/2]:[this._rect.x+r*this._sw+this._sw/2,this._rect.y+i*this._sh+this._sh/2]},pointToData:function(e){var t=this.pointToDate(e);return t&&t.time},dataToRect:function(e,t){var n=this.dataToPoint(e,t);return{contentShape:{x:n[0]-(this._sw-this._lineWidth)/2,y:n[1]-(this._sh-this._lineWidth)/2,width:this._sw-this._lineWidth,height:this._sh-this._lineWidth},center:n,tl:[n[0]-this._sw/2,n[1]-this._sh/2],tr:[n[0]+this._sw/2,n[1]-this._sh/2],br:[n[0]+this._sw/2,n[1]+this._sh/2],bl:[n[0]-this._sw/2,n[1]+this._sh/2]}},pointToDate:function(e){var t=Math.floor((e[0]-this._rect.x)/this._sw)+1,n=Math.floor((e[1]-this._rect.y)/this._sh)+1,o=this._rangeInfo.range;return"vertical"===this._orient?this._getDateByWeeksAndDay(n,t-1,o):this._getDateByWeeksAndDay(t,n-1,o)},convertToPixel:N(sD,"dataToPoint"),convertFromPixel:N(sD,"pointToData"),_initRangeOption:function(){var e=this._model.get("range"),t=e;if(M(t)&&1===t.length&&(t=t[0]),/^\d{4}$/.test(t)&&(e=[t+"-01-01",t+"-12-31"]),/^\d{4}[\/|-]\d{1,2}$/.test(t)){var n=this.getDateInfo(t),o=n.date;o.setMonth(o.getMonth()+1);var i=this.getNextNDay(o,-1);e=[n.formatedDate,i.formatedDate]}/^\d{4}[\/|-]\d{1,2}[\/|-]\d{1,2}$/.test(t)&&(e=[t,t]);var r=this._getRangeInfo(e);return r.start.time>r.end.time&&e.reverse(),e},_getRangeInfo:function(e){var t;(e=[this.getDateInfo(e[0]),this.getDateInfo(e[1])])[0].time>e[1].time&&(t=!0,e.reverse());var n=Math.floor(e[1].time/864e5)-Math.floor(e[0].time/864e5)+1,o=new Date(e[0].time),i=o.getDate(),r=e[1].date.getDate();o.setDate(i+n-1);var a=o.getDate();if(a!==r)for(var s=0<o.getTime()-e[1].time?1:-1;(a=o.getDate())!==r&&0<(o.getTime()-e[1].time)*s;)n-=s,o.setDate(a-s);var l=Math.floor((n+e[0].day+6)/7),u=t?1-l:l-1;return t&&e.reverse(),{range:[e[0].formatedDate,e[1].formatedDate],start:e[0],end:e[1],allDay:n,weeks:l,nthWeek:u,fweek:e[0].day,lweek:e[1].day}},_getDateByWeeksAndDay:function(e,t,n){var o=this._getRangeInfo(n);if(e>o.weeks||0===e&&t<o.fweek||e===o.weeks&&t>o.lweek)return!1;var i=7*(e-1)-o.fweek+t,r=new Date(o.start.time);return r.setDate(o.start.d+i),this.getDateInfo(r)}},aD.dimensions=aD.prototype.dimensions,aD.getDimensionsInfo=aD.prototype.getDimensionsInfo,aD.create=function(e,t){var n=[];return e.eachComponent("calendar",(function(o){var i=new aD(o,e,t);n.push(i),o.coordinateSystem=i})),e.eachSeries((function(e){"calendar"===e.get("coordinateSystem")&&(e.coordinateSystem=n[e.get("calendarIndex")||0])})),n},Uu.register("calendar",aD);var lD=mu.extend({type:"calendar",coordinateSystem:null,defaultOption:{zlevel:0,z:2,left:80,top:60,cellSize:20,orient:"horizontal",splitLine:{show:!0,lineStyle:{color:"#000",width:1,type:"solid"}},itemStyle:{color:"#fff",borderWidth:1,borderColor:"#ccc"},dayLabel:{show:!0,firstDay:0,position:"start",margin:"50%",nameMap:"en",color:"#000"},monthLabel:{show:!0,position:"start",margin:5,align:"center",nameMap:"en",formatter:null,color:"#000"},yearLabel:{show:!0,position:null,margin:30,formatter:null,color:"#ccc",fontFamily:"sans-serif",fontWeight:"bolder",fontSize:20}},init:function(e,t,n,o){var i=uu(e);lD.superApply(this,"init",arguments),uD(e,i)},mergeOption:function(e,t){lD.superApply(this,"mergeOption",arguments),uD(this.option,e)}});function uD(e,t){var n=e.cellSize;M(n)?1===n.length&&(n[1]=n[0]):n=e.cellSize=[n,n];var o=w([0,1],(function(e){return function(e,t){return null!=e[ou[t][0]]||null!=e[ou[t][1]]&&null!=e[ou[t][2]]}(t,e)&&(n[e]="auto"),null!=n[e]&&"auto"!==n[e]}));lu(e,t,{type:"box",ignoreSize:o})}var cD={EN:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],CN:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"]},dD={EN:["S","M","T","W","T","F","S"],CN:["日","一","二","三","四","五","六"]};lh({type:"calendar",_tlpoints:null,_blpoints:null,_firstDayOfMonth:null,_firstDayPoints:null,render:function(e,t,n){var o=this.group;o.removeAll();var i=e.coordinateSystem,r=i.getRangeInfo(),a=i.getOrient();this._renderDayRect(e,r,o),this._renderLines(e,r,a,o),this._renderYearText(e,r,a,o),this._renderMonthText(e,a,o),this._renderWeekText(e,r,a,o)},_renderDayRect:function(e,t,n){for(var o=e.coordinateSystem,i=e.getModel("itemStyle").getItemStyle(),r=o.getCellWidth(),a=o.getCellHeight(),s=t.start.time;s<=t.end.time;s=o.getNextNDay(s,1).time){var l=o.dataToRect([s],!1).tl,u=new Ua({shape:{x:l[0],y:l[1],width:r,height:a},cursor:"default",style:i});n.add(u)}},_renderLines:function(e,t,n,o){var i=this,r=e.coordinateSystem,a=e.getModel("splitLine.lineStyle").getLineStyle(),s=e.get("splitLine.show"),l=a.lineWidth;this._tlpoints=[],this._blpoints=[],this._firstDayOfMonth=[],this._firstDayPoints=[];for(var u=t.start,c=0;u.time<=t.end.time;c++){f(u.formatedDate),0===c&&(u=r.getDateInfo(t.start.y+"-"+t.start.m));var d=u.date;d.setMonth(d.getMonth()+1),u=r.getDateInfo(d)}function f(t){i._firstDayOfMonth.push(r.getDateInfo(t)),i._firstDayPoints.push(r.dataToRect([t],!1).tl);var l=i._getLinePointsOfOneWeek(e,t,n);i._tlpoints.push(l[0]),i._blpoints.push(l[l.length-1]),s&&i._drawSplitline(l,a,o)}f(r.getNextNDay(t.end.time,1).formatedDate),s&&this._drawSplitline(i._getEdgesPoints(i._tlpoints,l,n),a,o),s&&this._drawSplitline(i._getEdgesPoints(i._blpoints,l,n),a,o)},_getEdgesPoints:function(e,t,n){var o=[e[0].slice(),e[e.length-1].slice()],i="horizontal"===n?0:1;return o[0][i]=o[0][i]-t/2,o[1][i]=o[1][i]+t/2,o},_drawSplitline:function(e,t,n){var o=new Fa({z2:20,shape:{points:e},style:t});n.add(o)},_getLinePointsOfOneWeek:function(e,t,n){var o=e.coordinateSystem;t=o.getDateInfo(t);for(var i=[],r=0;r<7;r++){var a=o.getNextNDay(t.time,r),s=o.dataToRect([a.time],!1);i[2*a.day]=s.tl,i[2*a.day+1]=s["horizontal"===n?"bl":"tr"]}return i},_formatterLabel:function(e,t){return"string"==typeof e&&e?jl(e,t):"function"==typeof e?e(t):t.nameMap},_yearTextPositionControl:function(e,t,n,o,i){t=t.slice();var r=["center","bottom"];"bottom"===o?(t[1]+=i,r=["center","top"]):"left"===o?t[0]-=i:"right"===o?(t[0]+=i,r=["center","top"]):t[1]-=i;var a=0;return"left"!==o&&"right"!==o||(a=Math.PI/2),{rotation:a,position:t,style:{textAlign:r[0],textVerticalAlign:r[1]}}},_renderYearText:function(e,t,n,o){var i=e.getModel("yearLabel");if(i.get("show")){var r=i.get("margin"),a=i.get("position");a=a||("horizontal"!==n?"top":"left");var s=[this._tlpoints[this._tlpoints.length-1],this._blpoints[0]],l=(s[0][0]+s[1][0])/2,u=(s[0][1]+s[1][1])/2,c="horizontal"===n?0:1,d={top:[l,s[c][1]],bottom:[l,s[1-c][1]],left:[s[1-c][0],u],right:[s[c][0],u]},f=t.start.y;+t.end.y>+t.start.y&&(f=f+"-"+t.end.y);var h=i.get("formatter"),g=this._formatterLabel(h,{start:t.start.y,end:t.end.y,nameMap:f}),m=new Sa({z2:30});Vs(m.style,i,{text:g}),m.attr(this._yearTextPositionControl(m,d[a],n,a,r)),o.add(m)}},_monthTextPositionControl:function(e,t,n,o,i){var r="left",a="top",s=e[0],l=e[1];return"horizontal"===n?(l+=i,t&&(r="center"),"start"===o&&(a="bottom")):(s+=i,t&&(a="middle"),"start"===o&&(r="right")),{x:s,y:l,textAlign:r,textVerticalAlign:a}},_renderMonthText:function(e,t,n){var o=e.getModel("monthLabel");if(o.get("show")){var i=o.get("nameMap"),r=o.get("margin"),a=o.get("position"),s=o.get("align"),l=[this._tlpoints,this._blpoints];P(i)&&(i=cD[i.toUpperCase()]||[]);var u="start"===a?0:1,c="horizontal"===t?0:1;r="start"===a?-r:r;for(var d="center"===s,f=0;f<l[u].length-1;f++){var h=l[u][f].slice(),g=this._firstDayOfMonth[f];d&&(h[c]=(this._firstDayPoints[f][c]+l[0][f+1][c])/2);var m=o.get("formatter"),p=i[+g.m-1],v={yyyy:g.y,yy:(g.y+"").slice(2),MM:g.m,M:+g.m,nameMap:p},y=this._formatterLabel(m,v),C=new Sa({z2:30});b(Vs(C.style,o,{text:y}),this._monthTextPositionControl(h,d,t,a,r)),n.add(C)}}},_weekTextPositionControl:function(e,t,n,o,i){var r="center",a="middle",s=e[0],l=e[1],u="start"===n;return"horizontal"===t?(s=s+o+(u?1:-1)*i[0]/2,r=u?"right":"left"):(l=l+o+(u?1:-1)*i[1]/2,a=u?"bottom":"top"),{x:s,y:l,textAlign:r,textVerticalAlign:a}},_renderWeekText:function(e,t,n,o){var i=e.getModel("dayLabel");if(i.get("show")){var r=e.coordinateSystem,a=i.get("position"),s=i.get("nameMap"),l=i.get("margin"),u=r.getFirstDayOfWeek();P(s)&&(s=dD[s.toUpperCase()]||[]);var c=r.getNextNDay(t.end.time,7-t.lweek).time,d=[r.getCellWidth(),r.getCellHeight()];l=Cl(l,d["horizontal"===n?0:1]),"start"===a&&(c=r.getNextNDay(t.start.time,-(7+t.fweek)).time,l=-l);for(var f=0;f<7;f++){var h,g=r.getNextNDay(c,f),m=r.dataToRect([g.time],!1).center;h=Math.abs((f+u)%7);var p=new Sa({z2:30});b(Vs(p.style,i,{text:s[h]}),this._weekTextPositionControl(m,n,a,l,d)),o.add(p)}}}});var fD={path:null,compoundPath:null,group:_n,image:Wo,text:Sa};Qf((function(e){var t=e.graphic;M(t)?e.graphic=t[0]&&t[0].elements?[e.graphic[0]]:[{elements:t}]:t&&!t.elements&&(e.graphic=[{elements:[t]}])}));var hD=sh({type:"graphic",defaultOption:{elements:[],parentId:null},_elOptionsToUpdate:null,mergeOption:function(e){var t=this.option.elements;this.option.elements=null,hD.superApply(this,"mergeOption",arguments),this.option.elements=t},optionUpdated:function(e,t){var n=this.option,o=(t?n:e).elements,i=n.elements=t?[]:n.elements,r=[];this._flatten(o,r);var a=ki(i,r);Ai(a);var s=this._elOptionsToUpdate=[];O(a,(function(e,t){var n=e.option;n&&(s.push(n),function(e,t){var n=e.exist;if(t.id=e.keyInfo.id,!t.type&&n&&(t.type=n.type),null==t.parentId){var o=t.parentOption;o?t.parentId=o.id:n&&(t.parentId=n.parentId)}t.parentOption=null}(e,n),function(e,t,n){var o=b({},n),i=e[t],r=n.$action||"merge";"merge"===r?i?(v(i,o,!0),lu(i,o,{ignoreSize:!0}),cu(n,i)):e[t]=o:"replace"===r?e[t]=o:"remove"===r&&i&&(e[t]=null)}(i,t,n),function(e,t){e&&(e.hv=t.hv=[pD(t,["left","right"]),pD(t,["top","bottom"])],"group"===e.type&&(null==e.width&&(e.width=t.width=0),null==e.height&&(e.height=t.height=0)))}(i[t],n))}),this);for(var l=i.length-1;0<=l;l--)null==i[l]?i.splice(l,1):delete i[l].$action},_flatten:function(e,t,n){O(e,(function(e){if(e){n&&(e.parentOption=n),t.push(e);var o=e.children;"group"===e.type&&o&&this._flatten(o,t,e),delete e.children}}),this)},useElOptionsToUpdate:function(){var e=this._elOptionsToUpdate;return this._elOptionsToUpdate=null,e}});function gD(e,t,n,o){var i=n.type,r=new(fD.hasOwnProperty(i)?fD[i]:ms(i))(n);t.add(r),o.set(e,r),r.__ecGraphicId=e}function mD(e,t){var n=e&&e.parent;n&&("group"===e.type&&e.traverse((function(e){mD(e,t)})),t.removeKey(e.__ecGraphicId),n.remove(e))}function pD(e,t){var n;return O(t,(function(t){null!=e[t]&&"auto"!==e[t]&&(n=!0)})),n}lh({type:"graphic",init:function(e,t){this._elMap=Q()},render:function(e,t,n){e!==this._lastGraphicModel&&this._clear(),this._lastGraphicModel=e,this._updateElements(e),this._relocate(e,n)},_updateElements:function(e){var t=e.useElOptionsToUpdate();if(t){var n=this._elMap,o=this.group;O(t,(function(t){var i=t.$action,r=t.id,a=n.get(r),s=t.parentId,l=null!=s?n.get(s):o,u=t.style;"text"===t.type&&u&&(t.hv&&t.hv[1]&&(u.textVerticalAlign=u.textBaseline=null),!u.hasOwnProperty("textFill")&&u.fill&&(u.textFill=u.fill),!u.hasOwnProperty("textStroke")&&u.stroke&&(u.textStroke=u.stroke));var c=function(e){return e=b({},e),O(["id","parentId","$action","hv","bounding"].concat(nu),(function(t){delete e[t]})),e}(t);i&&"merge"!==i?"replace"===i?(mD(a,n),gD(r,l,c,n)):"remove"===i&&mD(a,n):a?a.attr(c):gD(r,l,c,n);var d=n.get(r);d&&(d.__ecGraphicWidthOption=t.width,d.__ecGraphicHeightOption=t.height,function(e,t){var n=e.eventData;e.silent||e.ignore||n||(n=e.eventData={componentType:"graphic",componentIndex:t.componentIndex,name:e.name}),n&&(n.info=e.info)}(d,e))}))}},_relocate:function(e,t){for(var n=e.option.elements,o=this.group,i=this._elMap,r=t.getWidth(),a=t.getHeight(),s=0;s<n.length;s++){var l=n[s];if((c=i.get(l.id))&&c.isGroup){var u=(d=c.parent)===o;c.__ecGraphicWidth=Cl(c.__ecGraphicWidthOption,u?r:d.__ecGraphicWidth)||0,c.__ecGraphicHeight=Cl(c.__ecGraphicHeightOption,u?a:d.__ecGraphicHeight)||0}}for(s=n.length-1;0<=s;s--){var c,d;(c=i.get((l=n[s]).id))&&su(c,l,(d=c.parent)===o?{width:r,height:a}:{width:d.__ecGraphicWidth,height:d.__ecGraphicHeight},null,{hv:l.hv,boundingMode:l.bounding})}},_clear:function(){var e=this._elMap;e.each((function(t){mD(t,e)})),this._elMap=Q()},dispose:function(){this._clear()}});var vD={};function yD(e,t){vD[e]=t}function bD(e){return vD[e]}var CD=sh({type:"toolbox",layoutMode:{type:"box",ignoreSize:!0},optionUpdated:function(){CD.superApply(this,"optionUpdated",arguments),O(this.option.feature,(function(e,t){var n=bD(t);n&&v(e,n.defaultOption)}))},defaultOption:{show:!0,z:6,zlevel:0,orient:"horizontal",left:"right",top:"top",backgroundColor:"transparent",borderColor:"#ccc",borderRadius:0,borderWidth:0,padding:5,itemSize:15,itemGap:8,showTitle:!0,iconStyle:{borderColor:"#666",color:"none"},emphasis:{iconStyle:{borderColor:"#3E98C5"}},tooltip:{show:!1}}});function TD(e,t){var n=zl(t.get("padding")),o=t.getItemStyle(["color","opacity"]);return o.fill=t.get("backgroundColor"),new Ua({shape:{x:e.x-n[3],y:e.y-n[0],width:e.width+n[1]+n[3],height:e.height+n[0]+n[2],r:t.get("borderRadius")},style:o,silent:!0,z2:-1})}lh({type:"toolbox",render:function(e,t,n,o){var i=this.group;if(i.removeAll(),e.get("show")){var r=+e.get("itemSize"),a=e.get("feature")||{},s=this._features||(this._features={}),l=[];O(a,(function(e,t){l.push(t)})),new fh(this._featureNames||[],l).add(u).update(u).remove(N(u,null)).execute(),this._featureNames=l,function(e,t,n){var o=t.getBoxLayoutParams(),i=t.get("padding"),r={width:n.getWidth(),height:n.getHeight()},a=au(o,r,i);ru(t.get("orient"),e,t.get("itemGap"),a.width,a.height),su(e,o,r,i)}(i,e,n),i.add(TD(i.getBoundingRect(),e)),i.eachChild((function(e){var t=e.__title,o=e.hoverStyle;if(o&&t){var a=io(t,vo(o)),s=e.position[0]+i.position[0],l=!1;e.position[1]+i.position[1]+r+a.height>n.getHeight()&&(o.textPosition="top",l=!0);var u=l?-5-a.height:r+8;s+a.width/2>n.getWidth()?(o.textPosition=["100%",u],o.textAlign="right"):s-a.width/2<0&&(o.textPosition=[0,u],o.textAlign="left")}}))}function u(u,c){var d,f=l[u],h=l[c],g=a[f],m=new hl(g,e,e.ecModel);if(o&&null!=o.newTitle&&o.featureName===f&&(g.title=o.newTitle),f&&!h){if(function(e){return 0===e.indexOf("my")}(f))d={model:m,onclick:m.option.onclick,featureName:f};else{var p=bD(f);if(!p)return;d=new p(m,t,n)}s[f]=d}else{if(!(d=s[h]))return;d.model=m,d.ecModel=t,d.api=n}f||!h?m.get("show")&&!d.unusable?(function(o,a,s){var l=o.getModel("iconStyle"),u=o.getModel("emphasis.iconStyle"),c=a.getIcons?a.getIcons():o.get("icon"),d=o.get("title")||{};if("string"==typeof c){var f=c,h=d;d={},(c={})[s]=f,d[s]=h}var g=o.iconPaths={};O(c,(function(s,c){var f=nl(s,{},{x:-r/2,y:-r/2,width:r,height:r});f.setStyle(l.getItemStyle()),f.hoverStyle=u.getItemStyle(),f.setStyle({text:d[c],textAlign:u.get("textAlign"),textBorderRadius:u.get("textBorderRadius"),textPadding:u.get("textPadding"),textFill:null});var h=e.getModel("tooltip");h&&h.get("show")&&f.attr("tooltip",b({content:d[c],formatter:h.get("formatter",!0)||function(){return d[c]},formatterParams:{componentType:"toolbox",name:c,title:d[c],$vars:["name","title"]},position:h.get("position",!0)||"bottom"},h.option)),Ks(f),e.get("showTitle")&&(f.__title=d[c],f.on("mouseover",(function(){var t=u.getItemStyle(),n="vertical"===e.get("orient")?null==e.get("right")?"right":"left":null==e.get("bottom")?"bottom":"top";f.setStyle({textFill:u.get("textFill")||t.fill||t.stroke||"#000",textBackgroundColor:u.get("textBackgroundColor"),textPosition:u.get("textPosition")||n})})).on("mouseout",(function(){f.setStyle({textFill:null,textBackgroundColor:null})}))),f.trigger(o.get("iconStatus."+c)||"normal"),i.add(f),f.on("click",A(a.onclick,a,t,n,c)),g[c]=f}))}(m,d,f),m.setIconStatus=function(e,t){var n=this.option,o=this.iconPaths;n.iconStatus=n.iconStatus||{},n.iconStatus[e]=t,o[e]&&o[e].trigger(t)},d.render&&d.render(m,t,n,o)):d.remove&&d.remove(t,n):d.dispose&&d.dispose(t,n)}},updateView:function(e,t,n,o){O(this._features,(function(e){e.updateView&&e.updateView(e.model,t,n,o)}))},remove:function(e,t){O(this._features,(function(n){n.remove&&n.remove(e,t)})),this.group.removeAll()},dispose:function(e,t){O(this._features,(function(n){n.dispose&&n.dispose(e,t)}))}});var xD=pd.toolbox.saveAsImage;function ED(e){this.model=e}ED.defaultOption={show:!0,icon:"M4.7,22.9L29.3,45.5L54.7,23.4M4.6,43.6L4.6,58L53.8,58L53.8,43.6M29.2,45.1L29.2,0",title:xD.title,type:"png",connectedBackgroundColor:"#fff",name:"",excludeComponents:["toolbox"],pixelRatio:1,lang:xD.lang.slice()},ED.prototype.unusable=!i.canvasSupported,ED.prototype.onclick=function(e,t){var n=this.model,o=n.get("name")||e.get("title.0.text")||"echarts",r="svg"===t.getZr().painter.getType()?"svg":n.get("type",!0)||"png",a=t.getConnectedDataURL({type:r,backgroundColor:n.get("backgroundColor",!0)||e.get("backgroundColor")||"#fff",connectedBackgroundColor:n.get("connectedBackgroundColor"),excludeComponents:n.get("excludeComponents"),pixelRatio:n.get("pixelRatio")});if("function"!=typeof MouseEvent||i.browser.ie||i.browser.edge)if(window.navigator.msSaveOrOpenBlob){for(var s=atob(a.split(",")[1]),l=s.length,u=new Uint8Array(l);l--;)u[l]=s.charCodeAt(l);var c=new Blob([u]);window.navigator.msSaveOrOpenBlob(c,o+"."+r)}else{var d=n.get("lang"),f='<body style="margin:0;"><img src="'+a+'" style="max-width:100%;" title="'+(d&&d[0]||"")+'" /></body>';window.open().document.write(f)}else{var h=document.createElement("a");h.download=o+"."+r,h.target="_blank",h.href=a;var g=new MouseEvent("click",{view:document.defaultView,bubbles:!0,cancelable:!1});h.dispatchEvent(g)}},yD("saveAsImage",ED);var _D=pd.toolbox.magicType,ID="__ec_magicType_stack__";function DD(e){this.model=e}DD.defaultOption={show:!0,type:[],icon:{line:"M4.1,28.9h7.1l9.3-22l7.4,38l9.7-19.7l3,12.8h14.9M4.1,58h51.4",bar:"M6.7,22.9h10V48h-10V22.9zM24.9,13h10v35h-10V13zM43.2,2h10v46h-10V2zM3.1,58h53.7",stack:"M8.2,38.4l-8.4,4.1l30.6,15.3L60,42.5l-8.1-4.1l-21.5,11L8.2,38.4z M51.9,30l-8.1,4.2l-13.4,6.9l-13.9-6.9L8.2,30l-8.4,4.2l8.4,4.2l22.2,11l21.5-11l8.1-4.2L51.9,30z M51.9,21.7l-8.1,4.2L35.7,30l-5.3,2.8L24.9,30l-8.4-4.1l-8.3-4.2l-8.4,4.2L8.2,30l8.3,4.2l13.9,6.9l13.4-6.9l8.1-4.2l8.1-4.1L51.9,21.7zM30.4,2.2L-0.2,17.5l8.4,4.1l8.3,4.2l8.4,4.2l5.5,2.7l5.3-2.7l8.1-4.2l8.1-4.2l8.1-4.1L30.4,2.2z"},title:p(_D.title),option:{},seriesIndex:{}};var OD=DD.prototype;OD.getIcons=function(){var e=this.model,t=e.get("icon"),n={};return O(e.get("type"),(function(e){t[e]&&(n[e]=t[e])})),n};var wD={line:function(e,t,n,o){if("bar"===e)return v({id:t,type:"line",data:n.get("data"),stack:n.get("stack"),markPoint:n.get("markPoint"),markLine:n.get("markLine")},o.get("option.line")||{},!0)},bar:function(e,t,n,o){if("line"===e)return v({id:t,type:"bar",data:n.get("data"),stack:n.get("stack"),markPoint:n.get("markPoint"),markLine:n.get("markLine")},o.get("option.bar")||{},!0)},stack:function(e,t,n,o){var i=n.get("stack")===ID;if("line"===e||"bar"===e)return o.setIconStatus("stack",i?"normal":"emphasis"),v({id:t,stack:i?"":ID},o.get("option.stack")||{},!0)}},RD=[["line","bar"],["stack"]];OD.onclick=function(e,t,n){var o=this.model,i=o.get("seriesIndex."+n);if(wD[n]){var r,a={series:[]};O(RD,(function(e){0<=E(e,n)&&O(e,(function(e){o.setIconStatus(e,"normal")}))})),o.setIconStatus(n,"emphasis"),e.eachComponent({mainType:"series",query:null==i?null:{seriesIndex:i}},(function(t){var i=wD[n](t.subType,t.id,t,o);i&&(C(i,t.option),a.series.push(i));var r=t.coordinateSystem;if(r&&"cartesian2d"===r.type&&("line"===n||"bar"===n)){var s=r.getAxesByScale("ordinal")[0];if(s){var l=s.dim+"Axis",u=e.queryComponents({mainType:l,index:t.get(name+"Index"),id:t.get(name+"Id")})[0].componentIndex;a[l]=a[l]||[];for(var c=0;c<=u;c++)a[l][u]=a[l][u]||{};a[l][u].boundaryGap="bar"===n}}})),"stack"===n&&(r=a.series&&a.series[0]&&a.series[0].stack===ID?v({stack:_D.title.tiled},_D.title):p(_D.title)),t.dispatchAction({type:"changeMagicType",currentType:n,newOption:a,newTitle:r,featureName:"magicType"})}},th({type:"changeMagicType",event:"magicTypeChanged",update:"prepareAndUpdate"},(function(e,t){t.mergeOption(e.newOption)})),yD("magicType",DD);var SD=pd.toolbox.dataView,kD=new Array(60).join("-"),AD="\t";function ND(e){return e.replace(/^\s\s*/,"").replace(/\s\s*$/,"")}var MD=new RegExp("[\t]+","g");function KD(e){this._dom=null,this.model=e}KD.defaultOption={show:!0,readOnly:!1,optionToContent:null,contentToOption:null,icon:"M17.5,17.3H33 M17.5,17.3H33 M45.4,29.5h-28 M11.5,2v56H51V14.8L38.4,2H11.5z M38.4,2.2v12.7H51 M45.4,41.7h-28",title:p(SD.title),lang:p(SD.lang),backgroundColor:"#fff",textColor:"#000",textareaColor:"#fff",textareaBorderColor:"#333",buttonColor:"#c23531",buttonTextColor:"#fff"},KD.prototype.onclick=function(e,t){var n=t.getDom(),o=this.model;this._dom&&n.removeChild(this._dom);var i=document.createElement("div");i.style.cssText="position:absolute;left:5px;top:5px;bottom:5px;right:5px;",i.style.backgroundColor=o.get("backgroundColor")||"#fff";var r=document.createElement("h4"),a=o.get("lang")||[];r.innerHTML=a[0]||o.get("title"),r.style.cssText="margin: 10px 20px;",r.style.color=o.get("textColor");var s=document.createElement("div"),l=document.createElement("textarea");s.style.cssText="display:block;width:100%;overflow:auto;";var u=o.get("optionToContent"),c=o.get("contentToOption"),d=function(e){var t=function(e){var t={},n=[],o=[];return e.eachRawSeries((function(e){var i=e.coordinateSystem;if(!i||"cartesian2d"!==i.type&&"polar"!==i.type)n.push(e);else{var r=i.getBaseAxis();if("category"===r.type){var a=r.dim+"_"+r.index;t[a]||(t[a]={categoryAxis:r,valueAxis:i.getOtherAxis(r),series:[]},o.push({axisDim:r.dim,axisIndex:r.index})),t[a].series.push(e)}else n.push(e)}})),{seriesGroupByCategoryAxis:t,other:n,meta:o}}(e);return{value:S([function(e){var t=[];return O(e,(function(e,n){var o=e.categoryAxis,i=e.valueAxis.dim,r=[" "].concat(w(e.series,(function(e){return e.name}))),a=[o.model.getCategories()];O(e.series,(function(e){var t=e.getRawData();a.push(e.getRawData().mapArray(t.mapDimension(i),(function(e){return e})))}));for(var s=[r.join(AD)],l=0;l<a[0].length;l++){for(var u=[],c=0;c<a.length;c++)u.push(a[c][l]);s.push(u.join(AD))}t.push(s.join("\n"))})),t.join("\n\n"+kD+"\n\n")}(t.seriesGroupByCategoryAxis),function(e){return w(e,(function(e){var t=e.getRawData(),n=[e.name],o=[];return t.each(t.dimensions,(function(){for(var e=arguments.length,i=t.getName(arguments[e-1]),r=0;r<e-1;r++)o[r]=arguments[r];n.push((i?i+AD:"")+o.join(AD))})),n.join("\n")})).join("\n\n"+kD+"\n\n")}(t.other)],(function(e){return e.replace(/[\n\t\s]/g,"")})).join("\n\n"+kD+"\n\n"),meta:t.meta}}(e);if("function"==typeof u){var f=u(t.getOption());"string"==typeof f?s.innerHTML=f:z(f)&&s.appendChild(f)}else s.appendChild(l),l.readOnly=o.get("readOnly"),l.style.cssText="width:100%;height:100%;font-family:monospace;font-size:14px;line-height:1.6rem;",l.style.color=o.get("textColor"),l.style.borderColor=o.get("textareaBorderColor"),l.style.backgroundColor=o.get("textareaColor"),l.value=d.value;var h=d.meta,g=document.createElement("div");g.style.cssText="position:absolute;bottom:0;left:0;right:0;";var m="float:right;margin-right:20px;border:none;cursor:pointer;padding:2px 5px;font-size:12px;border-radius:3px",p=document.createElement("div"),v=document.createElement("div");m+=";background-color:"+o.get("buttonColor"),m+=";color:"+o.get("buttonTextColor");var y=this;function b(){n.removeChild(i),y._dom=null}We(p,"click",b),We(v,"click",(function(){var e;try{e="function"==typeof c?c(s,t.getOption()):function(e,t){var n=e.split(new RegExp("\n*"+kD+"\n*","g")),o={series:[]};return O(n,(function(e,n){if(function(e){if(0<=e.slice(0,e.indexOf("\n")).indexOf(AD))return!0}(e)){var i=function(e){for(var t=e.split(/\n+/g),n=[],o=w(ND(t.shift()).split(MD),(function(e){return{name:e,data:[]}})),i=0;i<t.length;i++){var r=ND(t[i]).split(MD);n.push(r.shift());for(var a=0;a<r.length;a++)o[a]&&(o[a].data[i]=r[a])}return{series:o,categories:n}}(e),r=t[n],a=r.axisDim+"Axis";r&&(o[a]=o[a]||[],o[a][r.axisIndex]={data:i.categories},o.series=o.series.concat(i.series))}else i=function(e){for(var t=e.split(/\n+/g),n=ND(t.shift()),o=[],i=0;i<t.length;i++){var r=ND(t[i]);if(r){var a,s=r.split(MD),l="",u=!1;a=isNaN(s[0])?(u=!0,l=s[0],s=s.slice(1),o[i]={name:l,value:[]},o[i].value):o[i]=[];for(var c=0;c<s.length;c++)a.push(+s[c]);1===a.length&&(u?o[i].value=a[0]:o[i]=a[0])}}return{name:n,data:o}}(e),o.series.push(i)})),o}(l.value,h)}catch(e){throw b(),new Error("Data view format error "+e)}e&&t.dispatchAction({type:"changeDataView",newOption:e}),b()})),p.innerHTML=a[1],v.innerHTML=a[2],v.style.cssText=m,p.style.cssText=m,o.get("readOnly")||g.appendChild(v),g.appendChild(p),i.appendChild(r),i.appendChild(s),i.appendChild(g),s.style.height=n.clientHeight-80+"px",n.appendChild(i),this._dom=i},KD.prototype.remove=function(e,t){this._dom&&t.getDom().removeChild(this._dom)},KD.prototype.dispose=function(e,t){this.remove(e,t)},yD("dataView",KD),th({type:"changeDataView",event:"dataViewChanged",update:"prepareAndUpdate"},(function(e,t){var n=[];O(e.newOption.series,(function(e){var o=t.getSeriesByName(e.name)[0];if(o){var i=o.get("data");n.push({name:e.name,data:function(e,t){return w(e,(function(e,n){var o=t&&t[n];if(!L(o)||M(o))return e;L(e)&&!M(e)||(e={value:e});var i=null!=o.name&&null==e.name;return e=C(e,o),i&&delete e.name,e}))}(e.data,i)})}else n.push(b({type:"scatter"},e))})),t.mergeOption(C({series:n},e.newOption))}));var PD=O,LD=E,BD=N,FD=["dataToPoint","pointToData"],zD=["grid","xAxis","yAxis","geo","graph","polar","radiusAxis","angleAxis","bmap"];function VD(e,t,n){var o=this._targetInfoList=[],i={},r=$D(t,e);PD(UD,(function(e,t){n&&n.include&&!(0<=LD(n.include,t))||e(r,o,i)}))}var HD=VD.prototype;function WD(e){return e[0]>e[1]&&e.reverse(),e}function $D(e,t){return Bi(e,t,{includeMainTypes:zD})}HD.setOutputRanges=function(e,t){this.matchOutputRanges(e,t,(function(e,t,n){if((e.coordRanges||(e.coordRanges=[])).push(t),!e.coordRange){e.coordRange=t;var o=GD[e.brushType](0,n,t);e.__rangeOffset={offset:YD[e.brushType](o.values,e.range,[1,1]),xyMinMax:o.xyMinMax}}}))},HD.matchOutputRanges=function(e,t,n){PD(e,(function(e){var o=this.findTargetInfo(e,t);o&&!0!==o&&O(o.coordSyses,(function(o){var i=GD[e.brushType](1,o,e.range);n(e,i.values,o,t)}))}),this)},HD.setInputRanges=function(e,t){PD(e,(function(e){var n=this.findTargetInfo(e,t);if(e.range=e.range||[],n&&!0!==n){e.panelId=n.panelId;var o=GD[e.brushType](0,n.coordSys,e.coordRange),i=e.__rangeOffset;e.range=i?YD[e.brushType](o.values,i.offset,function(e,t){var n=JD(e),o=JD(t),i=[n[0]/o[0],n[1]/o[1]];return isNaN(i[0])&&(i[0]=1),isNaN(i[1])&&(i[1]=1),i}(o.xyMinMax,i.xyMinMax)):o.values}}),this)},HD.makePanelOpts=function(e,t){return w(this._targetInfoList,(function(n){var o=n.getPanelRect();return{panelId:n.panelId,defaultBrushType:t&&t(n),clipPath:xx(o),isTargetByCursor:_x(o,e,n.coordSysModel),getLinearBrushOtherExtent:Ex(o)}}))},HD.controlSeries=function(e,t,n){var o=this.findTargetInfo(e,n);return!0===o||o&&0<=LD(o.coordSyses,t.coordinateSystem)},HD.findTargetInfo=function(e,t){for(var n=this._targetInfoList,o=$D(t,e),i=0;i<n.length;i++){var r=n[i],a=e.panelId;if(a){if(r.panelId===a)return r}else for(i=0;i<qD.length;i++)if(qD[i](o,r))return r}return!0};var UD={grid:function(e,t){var n=e.xAxisModels,o=e.yAxisModels,i=e.gridModels,r=Q(),a={},s={};(n||o||i)&&(PD(n,(function(e){var t=e.axis.grid.model;r.set(t.id,t),a[t.id]=!0})),PD(o,(function(e){var t=e.axis.grid.model;r.set(t.id,t),s[t.id]=!0})),PD(i,(function(e){r.set(e.id,e),a[e.id]=!0,s[e.id]=!0})),r.each((function(e){var i=[];PD(e.coordinateSystem.getCartesians(),(function(e,t){(0<=LD(n,e.getAxis("x").model)||0<=LD(o,e.getAxis("y").model))&&i.push(e)})),t.push({panelId:"grid--"+e.id,gridModel:e,coordSysModel:e,coordSys:i[0],coordSyses:i,getPanelRect:jD.grid,xAxisDeclared:a[e.id],yAxisDeclared:s[e.id]})})))},geo:function(e,t){PD(e.geoModels,(function(e){var n=e.coordinateSystem;t.push({panelId:"geo--"+e.id,geoModel:e,coordSysModel:e,coordSys:n,coordSyses:[n],getPanelRect:jD.geo})}))}},qD=[function(e,t){var n=e.xAxisModel,o=e.yAxisModel,i=e.gridModel;return!i&&n&&(i=n.axis.grid.model),!i&&o&&(i=o.axis.grid.model),i&&i===t.gridModel},function(e,t){var n=e.geoModel;return n&&n===t.geoModel}],jD={grid:function(){return this.coordSys.grid.getRect().clone()},geo:function(){var e=this.coordSys,t=e.getBoundingRect().clone();return t.applyTransform(Zs(e)),t}},GD={lineX:BD(XD,0),lineY:BD(XD,1),rect:function(e,t,n){var o=t[FD[e]]([n[0][0],n[1][0]]),i=t[FD[e]]([n[0][1],n[1][1]]),r=[WD([o[0],i[0]]),WD([o[1],i[1]])];return{values:r,xyMinMax:r}},polygon:function(e,t,n){var o=[[1/0,-1/0],[1/0,-1/0]];return{values:w(n,(function(n){var i=t[FD[e]](n);return o[0][0]=Math.min(o[0][0],i[0]),o[1][0]=Math.min(o[1][0],i[1]),o[0][1]=Math.max(o[0][1],i[0]),o[1][1]=Math.max(o[1][1],i[1]),i})),xyMinMax:o}}};function XD(e,t,n,o){var i=n.getAxis(["x","y"][e]),r=WD(w([0,1],(function(e){return t?i.coordToData(i.toLocalCoord(o[e])):i.toGlobalCoord(i.dataToCoord(o[e]))}))),a=[];return a[e]=r,a[1-e]=[NaN,NaN],{values:r,xyMinMax:a}}var YD={lineX:BD(ZD,0),lineY:BD(ZD,1),rect:function(e,t,n){return[[e[0][0]-n[0]*t[0][0],e[0][1]-n[0]*t[0][1]],[e[1][0]-n[1]*t[1][0],e[1][1]-n[1]*t[1][1]]]},polygon:function(e,t,n){return w(e,(function(e,o){return[e[0]-n[0]*t[o][0],e[1]-n[1]*t[o][1]]}))}};function ZD(e,t,n,o){return[t[0]-o[e]*n[0],t[1]-o[e]*n[1]]}function JD(e){return e?[e[0][1]-e[0][0],e[1][1]-e[1][0]]:[NaN,NaN]}var QD=O,eO="\0_ec_hist_store";function tO(e){return e[eO]||(e[eO]=[{}])}mu.registerSubTypeDefaulter("dataZoom",(function(){return"slider"}));var nO,oO,iO,rO,aO=["cartesian2d","polar","singleAxis"],sO=(oO=["axisIndex","axis","index","id"],iO=w(nO=(nO=["x","y","z","radius","angle","single"]).slice(),Zl),rO=w(oO=(oO||[]).slice(),Zl),function(e,t){O(nO,(function(n,o){for(var i={name:n,capital:iO[o]},r=0;r<oO.length;r++)i[oO[r]]=n+rO[r];e.call(t,i)}))});function lO(e,t,n,o){this._dimName=e,this._axisIndex=t,this.ecModel=o,this._dataZoomModel=n}var uO=O,cO=xl;function dO(e,t){var n=e.getAxisModel(),o=e._percentWindow,i=e._valueWindow;if(o){var r=Il(i,[0,500]);r=Math.min(r,20);var a=t||0===o[0]&&100===o[1];n.setRange(a?null:+i[0].toFixed(r),a?null:+i[1].toFixed(r))}}lO.prototype={constructor:lO,hostedBy:function(e){return this._dataZoomModel===e},getDataValueWindow:function(){return this._valueWindow.slice()},getDataPercentWindow:function(){return this._percentWindow.slice()},getTargetSeriesModels:function(){var e=[],t=this.ecModel;return t.eachSeries((function(n){if(function(e){return 0<=E(aO,e)}(n.get("coordinateSystem"))){var o=this._dimName,i=t.queryComponents({mainType:o+"Axis",index:n.get(o+"AxisIndex"),id:n.get(o+"AxisId")})[0];this._axisIndex===(i&&i.componentIndex)&&e.push(n)}}),this),e},getAxisModel:function(){return this.ecModel.getComponent(this._dimName+"Axis",this._axisIndex)},getOtherAxisModel:function(){var e,t,n,o=this._dimName,i=this.ecModel,r=this.getAxisModel();return e="x"===o||"y"===o?(t="gridIndex","x"===o?"y":"x"):(t="polarIndex","angle"===o?"radius":"angle"),i.eachComponent(e+"Axis",(function(e){(e.get(t)||0)===(r.get(t)||0)&&(n=e)})),n},getMinMaxSpan:function(){return p(this._minMaxSpan)},calculateDataWindow:function(e){var t,n=this._dataExtent,o=this.getAxisModel().axis.scale,i=this._dataZoomModel.getRangePropMode(),r=[0,100],a=[],s=[];uO(["start","end"],(function(l,u){var c=e[l],d=e[l+"Value"];"percent"===i[u]?(null==c&&(c=r[u]),d=o.parse(bl(c,r,n))):(t=!0,c=bl(d=null==d?n[u]:o.parse(d),n,r)),s[u]=d,a[u]=c})),cO(s),cO(a);var l=this._minMaxSpan;function u(e,t,n,i,r){var a=r?"Span":"ValueSpan";ET(0,e,n,"all",l["min"+a],l["max"+a]);for(var s=0;s<2;s++)t[s]=bl(e[s],n,i,!0),r&&(t[s]=o.parse(t[s]))}return t?u(s,a,n,r,!1):u(a,s,r,n,!0),{valueWindow:s,percentWindow:a}},reset:function(e){if(e===this._dataZoomModel){var t=this.getTargetSeriesModels();this._dataExtent=function(e,t,n){var o=[1/0,-1/0];return uO(n,(function(e){var n=e.getData();n&&uO(n.mapDimension(t,!0),(function(e){var t=n.getApproximateExtent(e);t[0]<o[0]&&(o[0]=t[0]),t[1]>o[1]&&(o[1]=t[1])}))})),o[1]<o[0]&&(o=[NaN,NaN]),function(e,t){var n=e.getAxisModel(),o=n.getMin(!0),i="category"===n.get("type"),r=i&&n.getCategories().length;null!=o&&"dataMin"!==o&&"function"!=typeof o?t[0]=o:i&&(t[0]=0<r?0:NaN);var a=n.getMax(!0);null!=a&&"dataMax"!==a&&"function"!=typeof a?t[1]=a:i&&(t[1]=0<r?r-1:NaN),n.get("scale",!0)||(0<t[0]&&(t[0]=0),t[1]<0&&(t[1]=0))}(e,o),o}(this,this._dimName,t),function(e){var t=e._minMaxSpan={},n=e._dataZoomModel,o=e._dataExtent;uO(["min","max"],(function(i){var r=n.get(i+"Span"),a=n.get(i+"ValueSpan");null!=a&&(a=e.getAxisModel().axis.scale.parse(a)),null!=a?r=bl(o[0]+a,o,[0,100],!0):null!=r&&(a=bl(r,[0,100],o,!0)-o[0]),t[i+"Span"]=r,t[i+"ValueSpan"]=a}))}(this);var n=this.calculateDataWindow(e.settledOption);this._valueWindow=n.valueWindow,this._percentWindow=n.percentWindow,dO(this)}},restore:function(e){e===this._dataZoomModel&&(this._valueWindow=this._percentWindow=null,dO(this,!0))},filterData:function(e,t){if(e===this._dataZoomModel){var n=this._dimName,o=this.getTargetSeriesModels(),i=e.get("filterMode"),r=this._valueWindow;"none"!==i&&uO(o,(function(e){var t=e.getData(),o=t.mapDimension(n,!0);o.length&&("weakFilter"===i?t.filterSelf((function(e){for(var n,i,a,s=0;s<o.length;s++){var l=t.get(o[s],e),u=!isNaN(l),c=l<r[0],d=l>r[1];if(u&&!c&&!d)return!0;u&&(a=!0),c&&(n=!0),d&&(i=!0)}return a&&n&&i})):uO(o,(function(n){if("empty"===i)e.setData(t=t.map(n,(function(e){return function(e){return e>=r[0]&&e<=r[1]}(e)?e:NaN})));else{var o={};o[n]=r,t.selectRange(o)}})),uO(o,(function(e){t.setApproximateExtent(r,e)})))}))}}};var fO=O,hO=sO,gO=sh({type:"dataZoom",dependencies:["xAxis","yAxis","zAxis","radiusAxis","angleAxis","singleAxis","series"],defaultOption:{zlevel:0,z:4,orient:null,xAxisIndex:null,yAxisIndex:null,filterMode:"filter",throttle:null,start:0,end:100,startValue:null,endValue:null,minSpan:null,maxSpan:null,minValueSpan:null,maxValueSpan:null,rangeMode:null},init:function(e,t,n){this._dataIntervalByAxis={},this._dataInfo={},this._axisProxies={},this._autoThrottle=!0,this._rangePropMode=["percent","percent"];var o=mO(e);this.settledOption=o,this.mergeDefaultAndTheme(e,n),this.doInit(o)},mergeOption:function(e){var t=mO(e);v(this.option,e,!0),v(this.settledOption,t,!0),this.doInit(t)},doInit:function(e){var t=this.option;i.canvasSupported||(t.realtime=!1),this._setDefaultThrottle(e),pO(this,e);var n=this.settledOption;fO([["start","startValue"],["end","endValue"]],(function(e,o){"value"===this._rangePropMode[o]&&(t[e[0]]=n[e[0]]=null)}),this),this.textStyleModel=this.getModel("textStyle"),this._resetTarget(),this._giveAxisProxies()},_giveAxisProxies:function(){var e=this._axisProxies;this.eachTargetAxis((function(t,n,o,i){var r=this.dependentModels[t.axis][n],a=r.__dzAxisProxy||(r.__dzAxisProxy=new lO(t.name,n,this,i));e[t.name+"_"+n]=a}),this)},_resetTarget:function(){var e=this.option,t=this._judgeAutoMode();hO((function(t){var n=t.axisIndex;e[n]=Oi(e[n])}),this),"axisIndex"===t?this._autoSetAxisIndex():"orient"===t&&this._autoSetOrient()},_judgeAutoMode:function(){var e=this.option,t=!1;hO((function(n){null!=e[n.axisIndex]&&(t=!0)}),this);var n=e.orient;return null==n&&t?"orient":t?void 0:(null==n&&(e.orient="horizontal"),"axisIndex")},_autoSetAxisIndex:function(){var e=!0,t=this.get("orient",!0),n=this.option,o=this.dependentModels;if(e){var i="vertical"===t?"y":"x";o[i+"Axis"].length?(n[i+"AxisIndex"]=[0],e=!1):fO(o.singleAxis,(function(o){e&&o.get("orient",!0)===t&&(n.singleAxisIndex=[o.componentIndex],e=!1)}))}e&&hO((function(t){if(e){var o=[],i=this.dependentModels[t.axis];if(i.length&&!o.length)for(var r=0,a=i.length;r<a;r++)"category"===i[r].get("type")&&o.push(r);(n[t.axisIndex]=o).length&&(e=!1)}}),this),e&&this.ecModel.eachSeries((function(e){this._isSeriesHasAllAxesTypeOf(e,"value")&&hO((function(t){var o=n[t.axisIndex],i=e.get(t.axisIndex),r=e.get(t.axisId);E(o,i=e.ecModel.queryComponents({mainType:t.axis,index:i,id:r})[0].componentIndex)<0&&o.push(i)}))}),this)},_autoSetOrient:function(){var e;this.eachTargetAxis((function(t){e=e||t.name}),this),this.option.orient="y"===e?"vertical":"horizontal"},_isSeriesHasAllAxesTypeOf:function(e,t){var n=!0;return hO((function(o){var i=e.get(o.axisIndex),r=this.dependentModels[o.axis][i];r&&r.get("type")===t||(n=!1)}),this),n},_setDefaultThrottle:function(e){if(e.hasOwnProperty("throttle")&&(this._autoThrottle=!1),this._autoThrottle){var t=this.ecModel.option;this.option.throttle=t.animation&&0<t.animationDurationUpdate?100:20}},getFirstTargetAxisModel:function(){var e;return hO((function(t){if(null==e){var n=this.get(t.axisIndex);n.length&&(e=this.dependentModels[t.axis][n[0]])}}),this),e},eachTargetAxis:function(e,t){var n=this.ecModel;hO((function(o){fO(this.get(o.axisIndex),(function(i){e.call(t,o,i,this,n)}),this)}),this)},getAxisProxy:function(e,t){return this._axisProxies[e+"_"+t]},getAxisModel:function(e,t){var n=this.getAxisProxy(e,t);return n&&n.getAxisModel()},setRawRange:function(e){var t=this.option,n=this.settledOption;fO([["start","startValue"],["end","endValue"]],(function(o){null==e[o[0]]&&null==e[o[1]]||(t[o[0]]=n[o[0]]=e[o[0]],t[o[1]]=n[o[1]]=e[o[1]])}),this),pO(this,e)},setCalculatedRange:function(e){var t=this.option;fO(["start","startValue","end","endValue"],(function(n){t[n]=e[n]}))},getPercentRange:function(){var e=this.findRepresentativeAxisProxy();if(e)return e.getDataPercentWindow()},getValueRange:function(e,t){if(null!=e||null!=t)return this.getAxisProxy(e,t).getDataValueWindow();var n=this.findRepresentativeAxisProxy();return n?n.getDataValueWindow():void 0},findRepresentativeAxisProxy:function(e){if(e)return e.__dzAxisProxy;var t=this._axisProxies;for(var n in t)if(t.hasOwnProperty(n)&&t[n].hostedBy(this))return t[n];for(var n in t)if(t.hasOwnProperty(n)&&!t[n].hostedBy(this))return t[n]},getRangePropMode:function(){return this._rangePropMode.slice()}});function mO(e){var t={};return fO(["start","end","startValue","endValue","throttle"],(function(n){e.hasOwnProperty(n)&&(t[n]=e[n])})),t}function pO(e,t){var n=e._rangePropMode,o=e.get("rangeMode");fO([["start","startValue"],["end","endValue"]],(function(e,i){var r=null!=t[e[0]],a=null!=t[e[1]];r&&!a?n[i]="percent":!r&&a?n[i]="value":o?n[i]=o[i]:r&&(n[i]="percent")}))}var vO=Zc.extend({type:"dataZoom",render:function(e,t,n,o){this.dataZoomModel=e,this.ecModel=t,this.api=n},getTargetCoordInfo:function(){var e=this.ecModel,t={};return this.dataZoomModel.eachTargetAxis((function(n,o){var i=e.getComponent(n.axis,o);if(i){var r=i.getCoordSysModel();r&&function(e,t,n,o){for(var i,r=0;r<n.length;r++)if(n[r].model===e){i=n[r];break}i||n.push(i={model:e,axisModels:[],coordIndex:o}),i.axisModels.push(t)}(r,i,t[r.mainType]||(t[r.mainType]=[]),r.componentIndex)}}),this),t}});gO.extend({type:"dataZoom.select"}),vO.extend({type:"dataZoom.select"}),eh({getTargetSeries:function(e){var t=Q();return e.eachComponent("dataZoom",(function(e){e.eachTargetAxis((function(e,n,o){O(o.getAxisProxy(e.name,n).getTargetSeriesModels(),(function(e){t.set(e.uid,e)}))}))})),t},modifyOutputEnd:!0,overallReset:function(e,t){e.eachComponent("dataZoom",(function(e){e.eachTargetAxis((function(e,n,o){o.getAxisProxy(e.name,n).reset(o,t)})),e.eachTargetAxis((function(e,n,o){o.getAxisProxy(e.name,n).filterData(o,t)}))})),e.eachComponent("dataZoom",(function(e){var t=e.findRepresentativeAxisProxy(),n=t.getDataPercentWindow(),o=t.getDataValueWindow();e.setCalculatedRange({start:n[0],end:n[1],startValue:o[0],endValue:o[1]})}))}}),th("dataZoom",(function(e,t){var n=function(e,t,n){return function(i){var r,a={nodes:[],records:{}};if(t((function(e){a.records[e.name]={}})),!i)return a;for(o(i,a);r=!1,e(s),r;);function s(e){!function(e,t){return 0<=E(t.nodes,e)}(e,a)&&function(e,o){var i=!1;return t((function(t){O(n(e,t)||[],(function(e){o.records[t.name][e]&&(i=!0)}))})),i}(e,a)&&(o(e,a),r=!0)}return a};function o(e,o){o.nodes.push(e),t((function(t){O(n(e,t)||[],(function(e){o.records[t.name][e]=!0}))}))}}(A(t.eachComponent,t,"dataZoom"),sO,(function(e,t){return e.get(t.axisIndex)})),o=[];t.eachComponent({mainType:"dataZoom",query:e},(function(e,t){o.push.apply(o,n(e).nodes)})),O(o,(function(t,n){t.setRawRange({start:e.start,end:e.end,startValue:e.startValue,endValue:e.endValue})}))}));var yO=O;function bO(e,t,n){(this._brushController=new qT(n.getZr())).on("brush",A(this._onBrush,this)).mount()}bO.defaultOption={show:!0,filterMode:"filter",icon:{zoom:"M0,13.5h26.9 M13.5,26.9V0 M32.1,13.5H58V58H13.5 V32.1",back:"M22,1.4L9.9,13.5l12.3,12.3 M10.3,13.5H54.9v44.6 H10.3v-26"},title:p(pd.toolbox.dataZoom.title),brushStyle:{borderWidth:0,color:"rgba(0,0,0,0.2)"}};var CO=bO.prototype;CO.render=function(e,t,n,o){this.model=e,this.ecModel=t,this.api=n,function(e,t,n,o,i){var r=n._isZoomActive;o&&"takeGlobalCursor"===o.type&&(r="dataZoomSelect"===o.key&&o.dataZoomSelectActive),n._isZoomActive=r,e.setIconStatus("zoom",r?"emphasis":"normal");var a=new VD(xO(e.option),t,{include:["grid"]});n._brushController.setPanels(a.makePanelOpts(i,(function(e){return e.xAxisDeclared&&!e.yAxisDeclared?"lineX":!e.xAxisDeclared&&e.yAxisDeclared?"lineY":"rect"}))).enableBrush(!!r&&{brushType:"auto",brushStyle:e.getModel("brushStyle").getItemStyle()})}(e,t,this,o,n),function(e,t){e.setIconStatus("back",1<function(e){return tO(e).length}(t)?"emphasis":"normal")}(e,t)},CO.onclick=function(e,t,n){TO[n].call(this)},CO.remove=function(e,t){this._brushController.unmount()},CO.dispose=function(e,t){this._brushController.dispose()};var TO={zoom:function(){this.api.dispatchAction({type:"takeGlobalCursor",key:"dataZoomSelect",dataZoomSelectActive:!this._isZoomActive})},back:function(){this._dispatchZoomAction(function(e){var t=tO(e),n=t[t.length-1];1<t.length&&t.pop();var o={};return QD(n,(function(e,n){for(var i=t.length-1;0<=i;i--)if(e=t[i][n]){o[n]=e;break}})),o}(this.ecModel))}};function xO(e){var t={};return O(["xAxisIndex","yAxisIndex"],(function(n){t[n]=e[n],null==t[n]&&(t[n]="all"),!1!==t[n]&&"none"!==t[n]||(t[n]=[])})),t}function EO(e){this.model=e}CO._onBrush=function(e,t){if(t.isEnd&&e.length){var n={},o=this.ecModel;this._brushController.updateCovers([]),new VD(xO(this.model.option),o,{include:["grid"]}).matchOutputRanges(e,o,(function(e,t,n){if("cartesian2d"===n.type){var o=e.brushType;"rect"===o?(i("x",n,t[0]),i("y",n,t[1])):i({lineX:"x",lineY:"y"}[o],n,t)}})),function(e,t){var n=tO(e);QD(t,(function(t,o){for(var i=n.length-1;0<=i&&!n[i][o];i--);if(i<0){var r=e.queryComponents({mainType:"dataZoom",subType:"select",id:o})[0];if(r){var a=r.getPercentRange();n[0][o]={dataZoomId:o,start:a[0],end:a[1]}}}})),n.push(t)}(o,n),this._dispatchZoomAction(n)}function i(e,t,i){var r=t.getAxis(e),a=r.model,s=function(e,t,n){var o;return n.eachComponent({mainType:"dataZoom",subType:"select"},(function(n){n.getAxisModel(e,t.componentIndex)&&(o=n)})),o}(e,a,o),l=s.findRepresentativeAxisProxy(a).getMinMaxSpan();null==l.minValueSpan&&null==l.maxValueSpan||(i=ET(0,i.slice(),r.scale.getExtent(),0,l.minValueSpan,l.maxValueSpan)),s&&(n[s.id]={dataZoomId:s.id,startValue:i[0],endValue:i[1]})}},CO._dispatchZoomAction=function(e){var t=[];yO(e,(function(e,n){t.push(p(e))})),t.length&&this.api.dispatchAction({type:"dataZoom",from:this.uid,batch:t})},yD("dataZoom",bO),Qf((function(e){if(e){var t=e.dataZoom||(e.dataZoom=[]);M(t)||(e.dataZoom=t=[t]);var n=e.toolbox;if(n&&(M(n)&&(n=n[0]),n&&n.feature)){var o=n.feature.dataZoom;i("xAxis",o),i("yAxis",o)}}function i(n,o){if(o){var i=n+"Index",r=o[i];null==r||"all"===r||M(r)||(r=!1===r||"none"===r?[]:[r]),function(a,s){var l=e[a];M(l)||(l=l?[l]:[]),yO(l,(function(e,a){if(null==r||"all"===r||-1!==E(r,a)){var s={type:"select",$fromToolbox:!0,filterMode:o.filterMode||"filter",id:"\0_ec_\0toolbox-dataZoom_"+n+a};s[i]=a,t.push(s)}}))}(n)}}})),EO.defaultOption={show:!0,icon:"M3.8,33.4 M47,18.9h9.8V8.7 M56.3,20.1 C52.1,9,40.5,0.6,26.8,2.1C12.6,3.7,1.6,16.2,2.1,30.6 M13,41.1H3.1v10.2 M3.7,39.9c4.2,11.1,15.8,19.5,29.5,18 c14.2-1.6,25.2-14.1,24.7-28.5",title:pd.toolbox.restore.title},EO.prototype.onclick=function(e,t,n){!function(e){e[eO]=null}(e),t.dispatchAction({type:"restore",from:this.uid})},yD("restore",EO),th({type:"restore",event:"restore",update:"prepareAndUpdate"},(function(e,t){t.resetOption("recreate")})),sh({type:"tooltip",dependencies:["axisPointer"],defaultOption:{zlevel:0,z:60,show:!0,showContent:!0,trigger:"item",triggerOn:"mousemove|click",alwaysShowContent:!1,displayMode:"single",renderMode:"auto",confine:!1,showDelay:0,hideDelay:100,transitionDuration:.4,enterable:!1,backgroundColor:"rgba(50,50,50,0.7)",borderColor:"#333",borderRadius:4,borderWidth:0,padding:5,extraCssText:"",axisPointer:{type:"line",axis:"auto",animation:"auto",animationDurationUpdate:200,animationEasingUpdate:"exponentialOut",crossStyle:{color:"#999",width:1,type:"dashed",textStyle:{}}},textStyle:{color:"#fff",fontSize:14}}});var _O=O,IO=Fl,DO=["","-webkit-","-moz-","-o-"];function OO(e,t,n,o,i){var r=t&&t.painter;if(n){var a=r&&r.getViewportRoot();a&&function(e,t,n,o,i){Me(Ne,t,o,i,!0)&&Me(e,n,Ne[0],Ne[1])}(e,a,document.body,o,i)}else{e[0]=o,e[1]=i;var s=r&&r.getViewportRootOffset();s&&(e[0]+=s.offsetLeft,e[1]+=s.offsetTop)}e[2]=e[0]/t.getWidth(),e[3]=e[1]/t.getHeight()}function wO(e,t,n){if(i.wxa)return null;var o=document.createElement("div");o.domBelongToZr=!0,this.el=o;var r=this._zr=t.getZr(),a=this._appendToBody=n&&n.appendToBody;this._styleCoord=[0,0,0,0],OO(this._styleCoord,r,a,t.getWidth()/2,t.getHeight()/2),a?document.body.appendChild(o):e.appendChild(o),this._container=e,this._show=!1;var s=this;o.onmouseenter=function(){s._enterable&&(clearTimeout(s._hideTimeout),s._show=!0),s._inContent=!0},o.onmousemove=function(e){if(e=e||window.event,!s._enterable){var t=r.handler;He(r.painter.getViewportRoot(),e,!0),t.dispatch("mousemove",e)}},o.onmouseleave=function(){s._enterable&&s._show&&s.hideLater(s._hideDelay),s._inContent=!1}}function RO(e,t,n,o){e[0]=n,e[1]=o,e[2]=e[0]/t.getWidth(),e[3]=e[1]/t.getHeight()}function SO(e){var t=this._zr=e.getZr();this._styleCoord=[0,0,0,0],RO(this._styleCoord,t,e.getWidth()/2,e.getHeight()/2),this._show=!1}wO.prototype={constructor:wO,_enterable:!0,update:function(e){var t=this._container,n=t.currentStyle||document.defaultView.getComputedStyle(t),o=t.style;"absolute"!==o.position&&"absolute"!==n.position&&(o.position="relative"),e.get("alwaysShowContent")&&this._moveTooltipIfResized()},_moveTooltipIfResized:function(){var e=this._styleCoord[3],t=this._styleCoord[2]*this._zr.getWidth(),n=e*this._zr.getHeight();this.moveTo(t,n)},show:function(e){clearTimeout(this._hideTimeout);var t=this.el,n=this._styleCoord;t.style.cssText="position:absolute;display:block;border-style:solid;white-space:nowrap;z-index:9999999;"+function(e){var t=[],n=e.get("transitionDuration"),o=e.get("backgroundColor"),r=e.getModel("textStyle"),a=e.get("padding");return n&&t.push(function(e){var t="cubic-bezier(0.23, 1, 0.32, 1)",n="left "+e+"s "+t+",top "+e+"s "+t;return w(DO,(function(e){return e+"transition:"+n})).join(";")}(n)),o&&(i.canvasSupported?t.push("background-Color:"+o):(t.push("background-Color:#"+Ht(o)),t.push("filter:alpha(opacity=70)"))),_O(["width","color","radius"],(function(n){var o="border-"+n,i=IO(o),r=e.get(i);null!=r&&t.push(o+":"+r+("color"===n?"":"px"))})),t.push(function(e){var t=[],n=e.get("fontSize"),o=e.getTextColor();o&&t.push("color:"+o),t.push("font:"+e.getFont());var i=e.get("lineHeight");null==i&&(i=Math.round(3*n/2)),n&&t.push("line-height:"+i+"px");var r=e.get("textShadowColor"),a=e.get("textShadowBlur")||0,s=e.get("textShadowOffsetX")||0,l=e.get("textShadowOffsetY")||0;return a&&t.push("text-shadow:"+s+"px "+l+"px "+a+"px "+r),_O(["decoration","align"],(function(n){var o=e.get(n);o&&t.push("text-"+n+":"+o)})),t.join(";")}(r)),null!=a&&t.push("padding:"+zl(a).join("px ")+"px"),t.join(";")+";"}(e)+";left:"+n[0]+"px;top:"+n[1]+"px;"+(e.get("extraCssText")||""),t.style.display=t.innerHTML?"block":"none",t.style.pointerEvents=this._enterable?"auto":"none",this._show=!0},setContent:function(e){this.el.innerHTML=null==e?"":e},setEnterable:function(e){this._enterable=e},getSize:function(){var e=this.el;return[e.clientWidth,e.clientHeight]},moveTo:function(e,t){var n=this._styleCoord;OO(n,this._zr,this._appendToBody,e,t);var o=this.el.style;o.left=n[0]+"px",o.top=n[1]+"px"},hide:function(){this.el.style.display="none",this._show=!1},hideLater:function(e){!this._show||this._inContent&&this._enterable||(e?(this._hideDelay=e,this._show=!1,this._hideTimeout=setTimeout(A(this.hide,this),e)):this.hide())},isShow:function(){return this._show},dispose:function(){this.el.parentNode.removeChild(this.el)},getOuterSize:function(){var e=this.el.clientWidth,t=this.el.clientHeight;if(document.defaultView&&document.defaultView.getComputedStyle){var n=document.defaultView.getComputedStyle(this.el);n&&(e+=parseInt(n.borderLeftWidth,10)+parseInt(n.borderRightWidth,10),t+=parseInt(n.borderTopWidth,10)+parseInt(n.borderBottomWidth,10))}return{width:e,height:t}}},SO.prototype={constructor:SO,_enterable:!0,update:function(e){e.get("alwaysShowContent")&&this._moveTooltipIfResized()},_moveTooltipIfResized:function(){var e=this._styleCoord[3],t=this._styleCoord[2]*this._zr.getWidth(),n=e*this._zr.getHeight();this.moveTo(t,n)},show:function(e){this._hideTimeout&&clearTimeout(this._hideTimeout),this.el.attr("show",!0),this._show=!0},setContent:function(e,t,n){this.el&&this._zr.remove(this.el);for(var o={},i=e,r="{marker",a=i.indexOf(r);0<=a;){var s=i.indexOf("|}"),l=i.substr(a+r.length,s-a-r.length);o["marker"+l]=-1<l.indexOf("sub")?{textWidth:4,textHeight:4,textBorderRadius:2,textBackgroundColor:t[l],textOffset:[3,0]}:{textWidth:10,textHeight:10,textBorderRadius:5,textBackgroundColor:t[l]},a=(i=i.substr(s+1)).indexOf("{marker")}var u=n.getModel("textStyle"),c=u.get("fontSize"),d=n.get("textLineHeight");null==d&&(d=Math.round(3*c/2)),this.el=new Sa({style:Vs({},u,{rich:o,text:e,textBackgroundColor:n.get("backgroundColor"),textBorderRadius:n.get("borderRadius"),textFill:n.get("textStyle.color"),textPadding:n.get("padding"),textLineHeight:d}),z:n.get("z")}),this._zr.add(this.el);var f=this;this.el.on("mouseover",(function(){f._enterable&&(clearTimeout(f._hideTimeout),f._show=!0),f._inContent=!0})),this.el.on("mouseout",(function(){f._enterable&&f._show&&f.hideLater(f._hideDelay),f._inContent=!1}))},setEnterable:function(e){this._enterable=e},getSize:function(){var e=this.el.getBoundingRect();return[e.width,e.height]},moveTo:function(e,t){if(this.el){var n=this._styleCoord;RO(n,this._zr,e,t),this.el.attr("position",[n[0],n[1]])}},hide:function(){this.el&&this.el.hide(),this._show=!1},hideLater:function(e){!this._show||this._inContent&&this._enterable||(e?(this._hideDelay=e,this._show=!1,this._hideTimeout=setTimeout(A(this.hide,this),e)):this.hide())},isShow:function(){return this._show},dispose:function(){clearTimeout(this._hideTimeout),this.el&&this._zr.remove(this.el)},getOuterSize:function(){var e=this.getSize();return{width:e[0],height:e[1]}}};var kO=A,AO=O,NO=Cl,MO=new Ua({shape:{x:-1,y:-1,width:2,height:2}});function KO(e){for(var t=e.pop();e.length;){var n=e.pop();n&&(hl.isInstance(n)&&(n=n.get("tooltip",!0)),"string"==typeof n&&(n={formatter:n}),t=new hl(n,t,t.ecModel))}return t}function PO(e,t){return e.dispatchAction||A(t.dispatchAction,t)}function LO(e){return"center"===e||"middle"===e}lh({type:"tooltip",init:function(e,t){if(!i.node){var n,o=e.getComponent("tooltip"),r=o.get("renderMode");this._renderMode=Vi(r),"html"===this._renderMode?(n=new wO(t.getDom(),t,{appendToBody:o.get("appendToBody",!0)}),this._newLine="<br/>"):(n=new SO(t),this._newLine="\n"),this._tooltipContent=n}},render:function(e,t,n){if(!i.node){this.group.removeAll(),this._tooltipModel=e,this._ecModel=t,this._api=n,this._lastDataByCoordSys=null,this._alwaysShowContent=e.get("alwaysShowContent");var o=this._tooltipContent;o.update(e),o.setEnterable(e.get("enterable")),this._initGlobalListener(),this._keepShow()}},_initGlobalListener:function(){var e=this._tooltipModel.get("triggerOn");K_("itemTooltip",this._api,kO((function(t,n,o){"none"!==e&&(0<=e.indexOf(t)?this._tryShow(n,o):"leave"===t&&this._hide(o))}),this))},_keepShow:function(){var e=this._tooltipModel,t=this._ecModel,n=this._api;if(null!=this._lastX&&null!=this._lastY&&"none"!==e.get("triggerOn")){var o=this;clearTimeout(this._refreshUpdateTimeout),this._refreshUpdateTimeout=setTimeout((function(){n.isDisposed()||o.manuallyShowTip(e,t,n,{x:o._lastX,y:o._lastY})}))}},manuallyShowTip:function(e,t,n,o){if(o.from!==this.uid&&!i.node){var r=PO(o,n);this._ticket="";var a=o.dataByCoordSys;if(o.tooltip&&null!=o.x&&null!=o.y){var s=MO;s.position=[o.x,o.y],s.update(),s.tooltip=o.tooltip,this._tryShow({offsetX:o.x,offsetY:o.y,target:s},r)}else if(a)this._tryShow({offsetX:o.x,offsetY:o.y,position:o.position,dataByCoordSys:o.dataByCoordSys,tooltipOption:o.tooltipOption},r);else if(null!=o.seriesIndex){if(this._manuallyAxisShowTip(e,t,n,o))return;var l=__(o,t),u=l.point[0],c=l.point[1];null!=u&&null!=c&&this._tryShow({offsetX:u,offsetY:c,position:o.position,target:l.el},r)}else null!=o.x&&null!=o.y&&(n.dispatchAction({type:"updateAxisPointer",x:o.x,y:o.y}),this._tryShow({offsetX:o.x,offsetY:o.y,position:o.position,target:n.getZr().findHover(o.x,o.y).target},r))}},manuallyHideTip:function(e,t,n,o){!this._alwaysShowContent&&this._tooltipModel&&this._tooltipContent.hideLater(this._tooltipModel.get("hideDelay")),this._lastX=this._lastY=null,o.from!==this.uid&&this._hide(PO(o,n))},_manuallyAxisShowTip:function(e,t,n,o){var i=o.seriesIndex,r=o.dataIndex,a=t.getComponent("axisPointer").coordSysAxesInfo;if(null!=i&&null!=r&&null!=a){var s=t.getSeriesByIndex(i);if(s&&"axis"===(e=KO([s.getData().getItemModel(r),s,(s.coordinateSystem||{}).model,e])).get("trigger"))return n.dispatchAction({type:"updateAxisPointer",seriesIndex:i,dataIndex:r,position:o.position}),!0}},_tryShow:function(e,t){var n=e.target;if(this._tooltipModel){this._lastX=e.offsetX,this._lastY=e.offsetY;var o=e.dataByCoordSys;o&&o.length?this._showAxisTooltip(o,e):n&&null!=n.dataIndex?(this._lastDataByCoordSys=null,this._showSeriesItemTooltip(e,n,t)):n&&n.tooltip?(this._lastDataByCoordSys=null,this._showComponentItemTooltip(e,n,t)):(this._lastDataByCoordSys=null,this._hide(t))}},_showOrMove:function(e,t){var n=e.get("showDelay");t=A(t,this),clearTimeout(this._showTimout),0<n?this._showTimout=setTimeout(t,n):t()},_showAxisTooltip:function(e,t){var n=this._ecModel,o=[t.offsetX,t.offsetY],i=[],r=[],a=KO([t.tooltipOption,this._tooltipModel]),s=this._renderMode,l=this._newLine,u={};AO(e,(function(e){AO(e.dataByAxis,(function(e){var t=n.getComponent(e.axisDim+"Axis",e.axisIndex),o=e.value,a=[];if(t&&null!=o){var c=Y_(o,t.axis,n,e.seriesDataIndices,e.valueLabelOpt);O(e.seriesDataIndices,(function(i){var l=n.getSeriesByIndex(i.seriesIndex),d=i.dataIndexInside,f=l&&l.getDataParams(d);if(f.axisDim=e.axisDim,f.axisIndex=e.axisIndex,f.axisType=e.axisType,f.axisId=e.axisId,f.axisValue=Wg(t.axis,o),f.axisValueLabel=c,f){r.push(f);var h,g=l.formatTooltip(d,!0,null,s);L(g)?(h=g.html,v(u,g.markers)):h=g,a.push(h)}}));var d=c;i.push("html"!==s?a.join(l):(d?Wl(d)+l:"")+a.join(l))}}))}),this),i.reverse(),i=i.join(this._newLine+this._newLine);var c=t.position;this._showOrMove(a,(function(){this._updateContentNotChangedOnAxis(e)?this._updatePosition(a,c,o[0],o[1],this._tooltipContent,r):this._showTooltipContent(a,i,r,Math.random(),o[0],o[1],c,void 0,u)}))},_showSeriesItemTooltip:function(e,t,n){var o=t.seriesIndex,i=this._ecModel.getSeriesByIndex(o),r=t.dataModel||i,a=t.dataIndex,s=t.dataType,l=r.getData(s),u=KO([l.getItemModel(a),r,i&&(i.coordinateSystem||{}).model,this._tooltipModel]),c=u.get("trigger");if(null==c||"item"===c){var d,f,h=r.getDataParams(a,s),g=r.formatTooltip(a,!1,s,this._renderMode);f=L(g)?(d=g.html,g.markers):(d=g,null);var m="item_"+r.name+"_"+a;this._showOrMove(u,(function(){this._showTooltipContent(u,d,h,m,e.offsetX,e.offsetY,e.position,e.target,f)})),n({type:"showTip",dataIndexInside:a,dataIndex:l.getRawIndex(a),seriesIndex:o,from:this.uid})}},_showComponentItemTooltip:function(e,t,n){var o=t.tooltip;"string"==typeof o&&(o={content:o,formatter:o});var i=new hl(o,this._tooltipModel,this._ecModel),r=i.get("content"),a=Math.random();this._showOrMove(i,(function(){this._showTooltipContent(i,r,i.get("formatterParams")||{},a,e.offsetX,e.offsetY,e.position,t)})),n({type:"showTip",from:this.uid})},_showTooltipContent:function(e,t,n,o,i,r,a,s,l){if(this._ticket="",e.get("showContent")&&e.get("show")){var u=this._tooltipContent,c=e.get("formatter");a=a||e.get("position");var d=t;if(c&&"string"==typeof c)d=ql(c,n,!0);else if("function"==typeof c){var f=kO((function(t,o){t===this._ticket&&(u.setContent(o,l,e),this._updatePosition(e,a,i,r,u,n,s))}),this);this._ticket=o,d=c(n,o,f)}u.setContent(d,l,e),u.show(e),this._updatePosition(e,a,i,r,u,n,s)}},_updatePosition:function(e,t,n,o,i,r,a){var s=this._api.getWidth(),l=this._api.getHeight();t=t||e.get("position");var u=i.getSize(),c=e.get("align"),d=e.get("verticalAlign"),f=a&&a.getBoundingRect().clone();if(a&&f.applyTransform(a.transform),"function"==typeof t&&(t=t([n,o],r,i.el,f,{viewSize:[s,l],contentSize:u.slice()})),M(t))n=NO(t[0],s),o=NO(t[1],l);else if(L(t)){t.width=u[0],t.height=u[1];var h=au(t,{width:s,height:l});n=h.x,o=h.y,d=c=null}else if("string"==typeof t&&a)n=(g=function(e,t,n){var o=n[0],i=n[1],r=0,a=0,s=t.width,l=t.height;switch(e){case"inside":r=t.x+s/2-o/2,a=t.y+l/2-i/2;break;case"top":r=t.x+s/2-o/2,a=t.y-i-5;break;case"bottom":r=t.x+s/2-o/2,a=t.y+l+5;break;case"left":r=t.x-o-5,a=t.y+l/2-i/2;break;case"right":r=t.x+s+5,a=t.y+l/2-i/2}return[r,a]}(t,f,u))[0],o=g[1];else{var g;n=(g=function(e,t,n,o,i,r,a){var s=n.getOuterSize(),l=s.width,u=s.height;return null!=r&&(o<e+l+r?e-=l+r:e+=r),null!=a&&(i<t+u+a?t-=u+a:t+=a),[e,t]}(n,o,i,s,l,c?null:20,d?null:20))[0],o=g[1]}c&&(n-=LO(c)?u[0]/2:"right"===c?u[0]:0),d&&(o-=LO(d)?u[1]/2:"bottom"===d?u[1]:0),e.get("confine")&&(n=(g=function(e,t,n,o,i){var r=n.getOuterSize(),a=r.width,s=r.height;return e=Math.min(e+a,o)-a,t=Math.min(t+s,i)-s,[e=Math.max(e,0),t=Math.max(t,0)]}(n,o,i,s,l))[0],o=g[1]),i.moveTo(n,o)},_updateContentNotChangedOnAxis:function(e){var t=this._lastDataByCoordSys,n=!!t&&t.length===e.length;return n&&AO(t,(function(t,o){var i=t.dataByAxis||{},r=(e[o]||{}).dataByAxis||[];(n&=i.length===r.length)&&AO(i,(function(e,t){var o=r[t]||{},i=e.seriesDataIndices||[],a=o.seriesDataIndices||[];(n&=e.value===o.value&&e.axisType===o.axisType&&e.axisId===o.axisId&&i.length===a.length)&&AO(i,(function(e,t){var o=a[t];n&=e.seriesIndex===o.seriesIndex&&e.dataIndex===o.dataIndex}))}))})),this._lastDataByCoordSys=e,!!n},_hide:function(e){this._lastDataByCoordSys=null,e({type:"hideTip",from:this.uid})},dispose:function(e,t){i.node||(this._tooltipContent.dispose(),B_("itemTooltip",t))}}),th({type:"showTip",event:"showTip",update:"tooltip:manuallyShowTip"},(function(){})),th({type:"hideTip",event:"hideTip",update:"tooltip:manuallyHideTip"},(function(){}));var BO=["rect","polygon","keep","clear"],FO=O;function zO(e){if(e)for(var t in e)if(e.hasOwnProperty(t))return!0}function VO(e,t,n){var o={};return FO(t,(function(t){var i=o[t]=function(){function e(){}return e.prototype.__hidden=e.prototype,new e}();FO(e[t],(function(e,o){if(Lb.isValidType(o)){var r={type:o,visual:e};n&&n(r,t),i[o]=new Lb(r),"opacity"===o&&((r=p(r)).type="colorAlpha",i.__hidden.__alphaForOpacity=new Lb(r))}}))})),o}function HO(e,t,n){var o;O(n,(function(e){t.hasOwnProperty(e)&&zO(t[e])&&(o=!0)})),o&&O(n,(function(n){t.hasOwnProperty(n)&&zO(t[n])?e[n]=p(t[n]):delete e[n]}))}var WO={lineX:$O(0),lineY:$O(1),rect:{point:function(e,t,n){return e&&n.boundingRect.contain(e[0],e[1])},rect:function(e,t,n){return e&&n.boundingRect.intersect(e)}},polygon:{point:function(e,t,n){return e&&n.boundingRect.contain(e[0],e[1])&&im(n.range,e[0],e[1])},rect:function(e,t,n){var o=n.range;if(!e||o.length<=1)return!1;var i=e.x,r=e.y,a=e.width,s=e.height,l=o[0];return!!(im(o,i,r)||im(o,i+a,r)||im(o,i,r+s)||im(o,i+a,r+s)||En.create(e).contain(l[0],l[1])||ol(i,r,i+a,r,o)||ol(i,r,i,r+s,o)||ol(i+a,r,i+a,r+s,o)||ol(i,r+s,i+a,r+s,o))||void 0}}};function $O(e){var t=["x","y"],n=["width","height"];return{point:function(t,n,o){if(t)return UO(t[e],o.range)},rect:function(o,i,r){if(o){var a=r.range,s=[o[t[e]],o[t[e]]+o[n[e]]];return s[1]<s[0]&&s.reverse(),UO(s[0],a)||UO(s[1],a)||UO(a[0],s)||UO(a[1],s)}}}}function UO(e,t){return t[0]<=e&&e<=t[1]}var qO=["inBrush","outOfBrush"],jO="__ecBrushSelect",GO="__ecInBrushSelectEvent",XO=ff.VISUAL.BRUSH;function YO(e){e.eachComponent({mainType:"brush"},(function(t){(t.brushTargetManager=new VD(t.option,e)).setInputRanges(t.areas,e)}))}function ZO(e,t){if(!e.isDisposed()){var n=e.getZr();n[GO]=!0,e.dispatchAction({type:"brushSelect",batch:t}),n[GO]=!1}}function JO(e,t,n,o){for(var i=0,r=t.length;i<r;i++){var a=t[i];if(e[a.brushType](o,n,a.selectors,a))return!0}}function QO(e){var t=e.brushSelector;if(P(t)){var n=[];return O(WO,(function(e,o){n[o]=function(n,o,i,r){var a=o.getItemLayout(n);return e[t](a,i,r)}})),n}if(K(t)){var o={};return O(WO,(function(e,n){o[n]=t})),o}return t}oh(XO,(function(e,t,n){e.eachComponent({mainType:"brush"},(function(e){n&&"takeGlobalCursor"===n.type&&e.setBrushOption("brush"===n.key?n.brushOption:{brushType:!1})})),YO(e)})),ih(XO,(function(e,t,n){var o,i,r=[];e.eachComponent({mainType:"brush"},(function(t,n){var a={brushId:t.id,brushIndex:n,brushName:t.name,areas:p(t.areas),selected:[]};r.push(a);var s=t.option,l=s.brushLink,u=[],c=[],d=[],f=0;n||(o=s.throttleType,i=s.throttleDelay);var h=w(t.areas,(function(e){return function(e){var t=e.selectors={};return O(WO[e.brushType],(function(n,o){t[o]=function(o){return n(o,t,e)}})),e}(C({boundingRect:ew[e.brushType](e)},e))})),g=VO(t.option,qO,(function(e){e.mappingMethod="fixed"}));function m(e){return"all"===l||u[e]}function v(e){return!!e.length}M(l)&&O(l,(function(e){u[e]=1})),e.eachSeries((function(n,o){var i=d[o]=[];"parallel"===n.subType?function(e,t){var n=e.coordinateSystem;f|=n.hasAxisBrushed(),m(t)&&n.eachActiveState(e.getData(),(function(e,t){"active"===e&&(c[t]=1)}))}(n,o):function(n,o,i){var r=QO(n);if(r&&!function(e,t){var n=e.option.seriesIndex;return null!=n&&"all"!==n&&(M(n)?E(n,t)<0:t!==n)}(t,o)&&(O(h,(function(o){r[o.brushType]&&t.brushTargetManager.controlSeries(o,n,e)&&i.push(o),f|=v(i)})),m(o)&&v(i))){var a=n.getData();a.each((function(e){JO(r,i,a,e)&&(c[e]=1)}))}}(n,o,i)})),e.eachSeries((function(e,t){var n={seriesId:e.id,seriesIndex:t,seriesName:e.name,dataIndex:[]};a.selected.push(n);var o=QO(e),i=d[t],r=e.getData(),s=m(t)?function(e){return c[e]?(n.dataIndex.push(r.getRawIndex(e)),"inBrush"):"outOfBrush"}:function(e){return JO(o,i,r,e)?(n.dataIndex.push(r.getRawIndex(e)),"inBrush"):"outOfBrush"};(m(t)?f:v(i))&&function(e,t,n,o,i,r){var a,s={};function l(e){return n.getItemVisual(a,e)}function u(e,t){n.setItemVisual(a,e,t)}O(e,(function(e){var n=Lb.prepareVisualTypes(t[e]);s[e]=n})),n.each((function(e,i){var r=n.getRawDataItem(a=e);if(!r||!1!==r.visualMap)for(var c=o.call(void 0,e),d=t[c],f=s[c],h=0,g=f.length;h<g;h++){var m=f[h];d[m]&&d[m].applyVisual(e,l,u)}}))}(qO,g,r,s)}))})),function(e,t,n,o,i){if(i){var r=e.getZr();r[GO]||(r[jO]||(r[jO]=ZO),hd(r,jO,n,t)(e,o))}}(t,o,i,r,n)}));var ew={lineX:te,lineY:te,rect:function(e){return tw(e.range)},polygon:function(e){for(var t,n=e.range,o=0,i=n.length;o<i;o++){var r=n[o];r[0]<(t=t||[[1/0,-1/0],[1/0,-1/0]])[0][0]&&(t[0][0]=r[0]),r[0]>t[0][1]&&(t[0][1]=r[0]),r[1]<t[1][0]&&(t[1][0]=r[1]),r[1]>t[1][1]&&(t[1][1]=r[1])}return t&&tw(t)}};function tw(e){return new En(e[0][0],e[1][0],e[0][1]-e[0][0],e[1][1]-e[1][0])}var nw=["#ddd"];function ow(e,t){return v({brushType:e.brushType,brushMode:e.brushMode,transformable:e.transformable,brushStyle:new hl(e.brushStyle).getItemStyle(),removeOnClick:e.removeOnClick,z:e.z},t,!0)}function iw(e,t,n,o){o&&o.$from===e.id||this._brushController.setPanels(e.brushTargetManager.makePanelOpts(n)).enableBrush(e.brushOption).updateCovers(e.areas.slice())}function rw(e,t,n){this.model=e,this.ecModel=t,this.api=n}sh({type:"brush",dependencies:["geo","grid","xAxis","yAxis","parallel","series"],defaultOption:{toolbox:null,brushLink:null,seriesIndex:"all",geoIndex:null,xAxisIndex:null,yAxisIndex:null,brushType:"rect",brushMode:"single",transformable:!0,brushStyle:{borderWidth:1,color:"rgba(120,140,180,0.3)",borderColor:"rgba(120,140,180,0.8)"},throttleType:"fixRate",throttleDelay:0,removeOnClick:!0,z:1e4},areas:[],brushType:null,brushOption:{},coordInfoList:[],optionUpdated:function(e,t){var n=this.option;t||HO(n,e,["inBrush","outOfBrush"]);var o=n.inBrush=n.inBrush||{};n.outOfBrush=n.outOfBrush||{color:nw},o.hasOwnProperty("liftZ")||(o.liftZ=5)},setAreas:function(e){e&&(this.areas=w(e,(function(e){return ow(this.option,e)}),this))},setBrushOption:function(e){this.brushOption=ow(this.option,e),this.brushType=this.brushOption.brushType}}),lh({type:"brush",init:function(e,t){this.ecModel=e,this.api=t,(this._brushController=new qT(t.getZr())).on("brush",A(this._onBrush,this)).mount()},render:function(e){return this.model=e,iw.apply(this,arguments)},updateTransform:function(e,t){return YO(t),iw.apply(this,arguments)},updateView:iw,dispose:function(){this._brushController.dispose()},_onBrush:function(e,t){var n=this.model.id;this.model.brushTargetManager.setOutputRanges(e,this.ecModel),t.isEnd&&!t.removeOnClick||this.api.dispatchAction({type:"brush",brushId:n,areas:p(e),$from:n}),t.isEnd&&this.api.dispatchAction({type:"brushEnd",brushId:n,areas:p(e),$from:n})}}),th({type:"brush",event:"brush"},(function(e,t){t.eachComponent({mainType:"brush",query:e},(function(t){t.setAreas(e.areas)}))})),th({type:"brushSelect",event:"brushSelected",update:"none"},(function(){})),th({type:"brushEnd",event:"brushEnd",update:"none"},(function(){})),rw.defaultOption={show:!0,type:["rect","polygon","lineX","lineY","keep","clear"],icon:{rect:"M7.3,34.7 M0.4,10V-0.2h9.8 M89.6,10V-0.2h-9.8 M0.4,60v10.2h9.8 M89.6,60v10.2h-9.8 M12.3,22.4V10.5h13.1 M33.6,10.5h7.8 M49.1,10.5h7.8 M77.5,22.4V10.5h-13 M12.3,31.1v8.2 M77.7,31.1v8.2 M12.3,47.6v11.9h13.1 M33.6,59.5h7.6 M49.1,59.5 h7.7 M77.5,47.6v11.9h-13",polygon:"M55.2,34.9c1.7,0,3.1,1.4,3.1,3.1s-1.4,3.1-3.1,3.1 s-3.1-1.4-3.1-3.1S53.5,34.9,55.2,34.9z M50.4,51c1.7,0,3.1,1.4,3.1,3.1c0,1.7-1.4,3.1-3.1,3.1c-1.7,0-3.1-1.4-3.1-3.1 C47.3,52.4,48.7,51,50.4,51z M55.6,37.1l1.5-7.8 M60.1,13.5l1.6-8.7l-7.8,4 M59,19l-1,5.3 M24,16.1l6.4,4.9l6.4-3.3 M48.5,11.6 l-5.9,3.1 M19.1,12.8L9.7,5.1l1.1,7.7 M13.4,29.8l1,7.3l6.6,1.6 M11.6,18.4l1,6.1 M32.8,41.9 M26.6,40.4 M27.3,40.2l6.1,1.6 M49.9,52.1l-5.6-7.6l-4.9-1.2",lineX:"M15.2,30 M19.7,15.6V1.9H29 M34.8,1.9H40.4 M55.3,15.6V1.9H45.9 M19.7,44.4V58.1H29 M34.8,58.1H40.4 M55.3,44.4 V58.1H45.9 M12.5,20.3l-9.4,9.6l9.6,9.8 M3.1,29.9h16.5 M62.5,20.3l9.4,9.6L62.3,39.7 M71.9,29.9H55.4",lineY:"M38.8,7.7 M52.7,12h13.2v9 M65.9,26.6V32 M52.7,46.3h13.2v-9 M24.9,12H11.8v9 M11.8,26.6V32 M24.9,46.3H11.8v-9 M48.2,5.1l-9.3-9l-9.4,9.2 M38.9-3.9V12 M48.2,53.3l-9.3,9l-9.4-9.2 M38.9,62.3V46.4",keep:"M4,10.5V1h10.3 M20.7,1h6.1 M33,1h6.1 M55.4,10.5V1H45.2 M4,17.3v6.6 M55.6,17.3v6.6 M4,30.5V40h10.3 M20.7,40 h6.1 M33,40h6.1 M55.4,30.5V40H45.2 M21,18.9h62.9v48.6H21V18.9z",clear:"M22,14.7l30.9,31 M52.9,14.7L22,45.7 M4.7,16.8V4.2h13.1 M26,4.2h7.8 M41.6,4.2h7.8 M70.3,16.8V4.2H57.2 M4.7,25.9v8.6 M70.3,25.9v8.6 M4.7,43.2v12.6h13.1 M26,55.8h7.8 M41.6,55.8h7.8 M70.3,43.2v12.6H57.2"},title:p(pd.toolbox.brush.title)};var aw=rw.prototype;function sw(e){var t=e.itemStyle||(e.itemStyle={}),n=t.emphasis||(t.emphasis={}),o=e.label||e.label||{},i=o.normal||(o.normal={}),r={normal:1,emphasis:1};O(o,(function(e,t){r[t]||lw(i,t)||(i[t]=e)})),n.label&&!lw(o,"emphasis")&&(o.emphasis=n.label,delete n.label)}function lw(e,t){return e.hasOwnProperty(t)}aw.render=aw.updateView=function(e,t,n){var o,i,r;t.eachComponent({mainType:"brush"},(function(e){o=e.brushType,i=e.brushOption.brushMode||"single",r|=e.areas.length})),this._brushType=o,this._brushMode=i,O(e.get("type",!0),(function(t){e.setIconStatus(t,("keep"===t?"multiple"===i:"clear"===t?r:t===o)?"emphasis":"normal")}))},aw.getIcons=function(){var e=this.model,t=e.get("icon",!0),n={};return O(e.get("type",!0),(function(e){t[e]&&(n[e]=t[e])})),n},aw.onclick=function(e,t,n){var o=this._brushType,i=this._brushMode;"clear"===n?(t.dispatchAction({type:"axisAreaSelect",intervals:[]}),t.dispatchAction({type:"brush",command:"clear",areas:[]})):t.dispatchAction({type:"takeGlobalCursor",key:"brush",brushOption:{brushType:"keep"===n?o:o!==n&&n,brushMode:"keep"===n?"multiple"===i?"single":"multiple":i}})},yD("brush",rw),Qf((function(e,t){var n=e&&e.brush;if(M(n)||(n=n?[n]:[]),n.length){var o=[];O(n,(function(e){var t=e.hasOwnProperty("toolbox")?e.toolbox:[];t instanceof Array&&(o=o.concat(t))}));var i=e&&e.toolbox;M(i)&&(i=i[0]),i||(e.toolbox=[i={feature:{}}]);var r=i.feature||(i.feature={}),a=r.brush||(r.brush={}),s=a.type||(a.type=[]);s.push.apply(s,o),function(e){var t={};O(e,(function(e){t[e]=1})),e.length=0,O(t,(function(t,n){e.push(n)}))}(s),t&&!s.length&&s.push.apply(s,BO)}})),sh({type:"title",layoutMode:{type:"box",ignoreSize:!0},defaultOption:{zlevel:0,z:6,show:!0,text:"",target:"blank",subtext:"",subtarget:"blank",left:0,top:0,backgroundColor:"rgba(0,0,0,0)",borderColor:"#ccc",borderWidth:0,padding:5,itemGap:10,textStyle:{fontSize:18,fontWeight:"bolder",color:"#333"},subtextStyle:{color:"#aaa"}}}),lh({type:"title",render:function(e,t,n){if(this.group.removeAll(),e.get("show")){var o=this.group,i=e.getModel("textStyle"),r=e.getModel("subtextStyle"),a=e.get("textAlign"),s=W(e.get("textBaseline"),e.get("textVerticalAlign")),l=new Sa({style:Vs({},i,{text:e.get("text"),textFill:i.getTextColor()},{disableBox:!0}),z2:10}),u=l.getBoundingRect(),c=e.get("subtext"),d=new Sa({style:Vs({},r,{text:c,textFill:r.getTextColor(),y:u.height+e.get("itemGap"),textVerticalAlign:"top"},{disableBox:!0}),z2:10}),f=e.get("link"),h=e.get("sublink"),g=e.get("triggerEvent",!0);l.silent=!f&&!g,d.silent=!h&&!g,f&&l.on("click",(function(){Ql(f,"_"+e.get("target"))})),h&&d.on("click",(function(){Ql(h,"_"+e.get("subtarget"))})),l.eventData=d.eventData=g?{componentType:"title",componentIndex:e.componentIndex}:null,o.add(l),c&&o.add(d);var m=o.getBoundingRect(),p=e.getBoxLayoutParams();p.width=m.width,p.height=m.height;var v=au(p,{width:n.getWidth(),height:n.getHeight()},e.get("padding"));a||("middle"===(a=e.get("left")||e.get("right"))&&(a="center"),"right"===a?v.x+=v.width:"center"===a&&(v.x+=v.width/2)),s||("center"===(s=e.get("top")||e.get("bottom"))&&(s="middle"),"bottom"===s?v.y+=v.height:"middle"===s&&(v.y+=v.height/2),s=s||"top"),o.attr("position",[v.x,v.y]);var y={textAlign:a,textVerticalAlign:s};l.setStyle(y),d.setStyle(y),m=o.getBoundingRect();var b=v.margin,C=e.getItemStyle(["color","opacity"]);C.fill=e.get("backgroundColor");var T=new Ua({shape:{x:m.x-b[3],y:m.y-b[0],width:m.width+b[1]+b[3],height:m.height+b[0]+b[2],r:e.get("borderRadius")},style:C,subPixelOptimize:!0,silent:!0});o.add(T)}}}),mu.registerSubTypeDefaulter("timeline",(function(){return"slider"})),th({type:"timelineChange",event:"timelineChanged",update:"prepareAndUpdate"},(function(e,t){var n=t.getComponent("timeline");return n&&null!=e.currentIndex&&(n.setCurrentIndex(e.currentIndex),!n.get("loop",!0)&&n.isIndexMax()&&n.setPlayState(!1)),t.resetOption("timeline"),C({currentIndex:n.option.currentIndex},e)})),th({type:"timelinePlayChange",event:"timelinePlayChanged",update:"update"},(function(e,t){var n=t.getComponent("timeline");n&&null!=e.playState&&n.setPlayState(e.playState)}));var uw=mu.extend({type:"timeline",layoutMode:"box",defaultOption:{zlevel:0,z:4,show:!0,axisType:"time",realtime:!0,left:"20%",top:null,right:"20%",bottom:0,width:null,height:40,padding:5,controlPosition:"left",autoPlay:!1,rewind:!1,loop:!0,playInterval:2e3,currentIndex:0,itemStyle:{},label:{color:"#000"},data:[]},init:function(e,t,n){this.mergeDefaultAndTheme(e,n),this._initData()},mergeOption:function(e){uw.superApply(this,"mergeOption",arguments),this._initData()},setCurrentIndex:function(e){null==e&&(e=this.option.currentIndex);var t=this._data.count();this.option.loop?e=(e%t+t)%t:(t<=e&&(e=t-1),e<0&&(e=0)),this.option.currentIndex=e},getCurrentIndex:function(){return this.option.currentIndex},isIndexMax:function(){return this.getCurrentIndex()>=this._data.count()-1},setPlayState:function(e){this.option.autoPlay=!!e},getPlayState:function(){return!!this.option.autoPlay},_initData:function(){var e=this.option,t=e.data||[],n=e.axisType,o=this._names=[];if("category"===n){var i=[];O(t,(function(e,t){var n,r=Si(e);L(e)?(n=p(e)).value=t:n=t,i.push(n),P(r)||null!=r&&!isNaN(r)||(r=""),o.push(r+"")})),t=i}(this._data=new wh([{name:"value",type:{category:"ordinal",time:"time"}[n]||"number"}],this)).initData(t,o)},getData:function(){return this._data},getCategories:function(){if("category"===this.get("axisType"))return this._names.slice()}});function cw(e,t,n,o){pm.call(this,e,t,n),this.type=o||"value",this.model=null}I(uw.extend({type:"timeline.slider",defaultOption:{backgroundColor:"rgba(0,0,0,0)",borderColor:"#ccc",borderWidth:0,orient:"horizontal",inverse:!1,tooltip:{trigger:"item"},symbol:"emptyCircle",symbolSize:10,lineStyle:{show:!0,width:2,color:"#304654"},label:{position:"auto",show:!0,interval:"auto",rotate:0,color:"#304654"},itemStyle:{color:"#304654",borderWidth:1},checkpointStyle:{symbol:"circle",symbolSize:13,color:"#c23531",borderWidth:5,borderColor:"rgba(194,53,49, 0.5)",animation:!0,animationDuration:300,animationEasing:"quinticInOut"},controlStyle:{show:!0,showPlayBtn:!0,showPrevBtn:!0,showNextBtn:!0,itemSize:22,itemGap:12,position:"left",playIcon:"path://M31.6,53C17.5,53,6,41.5,6,27.4S17.5,1.8,31.6,1.8C45.7,1.8,57.2,13.3,57.2,27.4S45.7,53,31.6,53z M31.6,3.3 C18.4,3.3,7.5,14.1,7.5,27.4c0,13.3,10.8,24.1,24.1,24.1C44.9,51.5,55.7,40.7,55.7,27.4C55.7,14.1,44.9,3.3,31.6,3.3z M24.9,21.3 c0-2.2,1.6-3.1,3.5-2l10.5,6.1c1.899,1.1,1.899,2.9,0,4l-10.5,6.1c-1.9,1.1-3.5,0.2-3.5-2V21.3z",stopIcon:"path://M30.9,53.2C16.8,53.2,5.3,41.7,5.3,27.6S16.8,2,30.9,2C45,2,56.4,13.5,56.4,27.6S45,53.2,30.9,53.2z M30.9,3.5C17.6,3.5,6.8,14.4,6.8,27.6c0,13.3,10.8,24.1,24.101,24.1C44.2,51.7,55,40.9,55,27.6C54.9,14.4,44.1,3.5,30.9,3.5z M36.9,35.8c0,0.601-0.4,1-0.9,1h-1.3c-0.5,0-0.9-0.399-0.9-1V19.5c0-0.6,0.4-1,0.9-1H36c0.5,0,0.9,0.4,0.9,1V35.8z M27.8,35.8 c0,0.601-0.4,1-0.9,1h-1.3c-0.5,0-0.9-0.399-0.9-1V19.5c0-0.6,0.4-1,0.9-1H27c0.5,0,0.9,0.4,0.9,1L27.8,35.8L27.8,35.8z",nextIcon:"path://M18.6,50.8l22.5-22.5c0.2-0.2,0.3-0.4,0.3-0.7c0-0.3-0.1-0.5-0.3-0.7L18.7,4.4c-0.1-0.1-0.2-0.3-0.2-0.5 c0-0.4,0.3-0.8,0.8-0.8c0.2,0,0.5,0.1,0.6,0.3l23.5,23.5l0,0c0.2,0.2,0.3,0.4,0.3,0.7c0,0.3-0.1,0.5-0.3,0.7l-0.1,0.1L19.7,52 c-0.1,0.1-0.3,0.2-0.5,0.2c-0.4,0-0.8-0.3-0.8-0.8C18.4,51.2,18.5,51,18.6,50.8z",prevIcon:"path://M43,52.8L20.4,30.3c-0.2-0.2-0.3-0.4-0.3-0.7c0-0.3,0.1-0.5,0.3-0.7L42.9,6.4c0.1-0.1,0.2-0.3,0.2-0.5 c0-0.4-0.3-0.8-0.8-0.8c-0.2,0-0.5,0.1-0.6,0.3L18.3,28.8l0,0c-0.2,0.2-0.3,0.4-0.3,0.7c0,0.3,0.1,0.5,0.3,0.7l0.1,0.1L41.9,54 c0.1,0.1,0.3,0.2,0.5,0.2c0.4,0,0.8-0.3,0.8-0.8C43.2,53.2,43.1,53,43,52.8z",color:"#304654",borderColor:"#304654",borderWidth:1},emphasis:{label:{show:!0,color:"#c23531"},itemStyle:{color:"#c23531"},controlStyle:{color:"#c23531",borderColor:"#c23531",borderWidth:2}},data:[]}}),wc);var dw=Zc.extend({type:"timeline"});cw.prototype={constructor:cw,getLabelModel:function(){return this.model.getModel("label")},isHorizontal:function(){return"horizontal"===this.model.get("orient")}},_(cw,pm);var fw=A,hw=O,gw=Math.PI;function mw(e,t,n,o,i,r){var a=t.get("color");i?(i.setColor(a),n.add(i),r&&r.onUpdate(i)):((i=tm(e.get("symbol"),-1,-1,2,2,a)).setStyle("strokeNoScale",!0),n.add(i),r&&r.onCreate(i));var s=t.getItemStyle(["color","symbol","symbolSize"]);i.setStyle(s),o=v({rectHover:!0,z2:100},o,!0);var l=e.get("symbolSize");(l=l instanceof Array?l.slice():[+l,+l])[0]/=2,l[1]/=2,o.scale=l;var u=e.get("symbolOffset");if(u){var c=o.position=o.position||[0,0];c[0]+=Cl(u[0],l[0]),c[1]+=Cl(u[1],l[1])}var d=e.get("symbolRotate");return o.rotation=(d||0)*Math.PI/180||0,i.attr(o),i.updateTransform(),i}function pw(e,t,n,o,i){if(!e.dragging){var r=o.getModel("checkpointStyle"),a=n.dataToCoord(o.getData().get(["value"],t));i||!r.get("animation",!0)?e.attr({position:[a,0]}):(e.stopAnimation(!0),e.animateTo({position:[a,0]},r.get("animationDuration",!0),r.get("animationEasing",!0)))}}dw.extend({type:"timeline.slider",init:function(e,t){this.api=t},render:function(e,t,n,o){if(this.model=e,this.api=n,this.ecModel=t,this.group.removeAll(),e.get("show",!0)){var i=this._layout(e,n),r=this._createGroup("mainGroup"),a=this._createGroup("labelGroup"),s=this._axis=this._createAxis(i,e);e.formatTooltip=function(e){return Wl(s.scale.getLabel(e))},hw(["AxisLine","AxisTick","Control","CurrentPointer"],(function(t){this["_render"+t](i,r,s,e)}),this),this._renderAxisLabel(i,a,s,e),this._position(i,e)}this._doPlayStop()},remove:function(){this._clearTimer(),this.group.removeAll()},dispose:function(){this._clearTimer()},_layout:function(e,t){var n=e.get("label.position"),o=e.get("orient"),i=function(e,t){return au(e.getBoxLayoutParams(),{width:t.getWidth(),height:t.getHeight()},e.get("padding"))}(e,t);null==n||"auto"===n?n="horizontal"===o?i.y+i.height/2<t.getHeight()/2?"-":"+":i.x+i.width/2<t.getWidth()/2?"+":"-":isNaN(n)&&(n={horizontal:{top:"-",bottom:"+"},vertical:{left:"-",right:"+"}}[o][n]);var r,a,s,l,u={horizontal:"center",vertical:0<=n||"+"===n?"left":"right"},c={horizontal:0<=n||"+"===n?"top":"bottom",vertical:"middle"},d={horizontal:0,vertical:gw/2},f="vertical"===o?i.height:i.width,h=e.getModel("controlStyle"),g=h.get("show",!0),m=g?h.get("itemSize"):0,p=g?h.get("itemGap"):0,v=m+p,y=e.get("label.rotate")||0;y=y*gw/180;var b=h.get("position",!0),C=g&&h.get("showPlayBtn",!0),T=g&&h.get("showPrevBtn",!0),x=0,E=f;return"left"===b||"bottom"===b?(C&&(r=[0,0],x+=v),T&&(a=[x,0],x+=v)):(C&&(r=[E-m,0],E-=v),T&&(a=[0,0],x+=v)),g&&h.get("showNextBtn",!0)&&(s=[E-m,0],E-=v),l=[x,E],e.get("inverse")&&l.reverse(),{viewRect:i,mainLength:f,orient:o,rotation:d[o],labelRotation:y,labelPosOpt:n,labelAlign:e.get("label.align")||u[o],labelBaseline:e.get("label.verticalAlign")||e.get("label.baseline")||c[o],playPosition:r,prevBtnPosition:a,nextBtnPosition:s,axisExtent:l,controlSize:m,controlGap:p}},_position:function(e,t){var n=this._mainGroup,o=this._labelGroup,i=e.viewRect;if("vertical"===e.orient){var r=ot(),a=i.x,s=i.y+i.height;st(r,r,[-a,-s]),lt(r,r,-gw/2),st(r,r,[a,s]),(i=i.clone()).applyTransform(r)}var l=p(i),u=p(n.getBoundingRect()),c=p(o.getBoundingRect()),d=n.position,f=o.position;f[0]=d[0]=l[0][0];var h,g=e.labelPosOpt;function m(e){var t=e.position;e.origin=[l[0][0]-t[0],l[1][0]-t[1]]}function p(e){return[[e.x,e.x+e.width],[e.y,e.y+e.height]]}function v(e,t,n,o,i){e[o]+=n[o][i]-t[o][i]}isNaN(g)?(v(d,u,l,1,h="+"===g?0:1),v(f,c,l,1,1-h)):(v(d,u,l,1,h=0<=g?0:1),f[1]=d[1]+g),n.attr("position",d),o.attr("position",f),n.rotation=o.rotation=e.rotation,m(n),m(o)},_createAxis:function(e,t){var n=t.getData(),o=t.get("axisType"),i=Vg(t,o);i.getTicks=function(){return n.mapArray(["value"],(function(e){return e}))};var r=n.getDataExtent("value");i.setExtent(r[0],r[1]),i.niceTicks();var a=new cw("value",i,e.axisExtent,o);return a.model=t,a},_createGroup:function(e){var t=this["_"+e]=new _n;return this.group.add(t),t},_renderAxisLine:function(e,t,n,o){var i=n.getExtent();o.get("lineStyle.show")&&t.add(new ja({shape:{x1:i[0],y1:0,x2:i[1],y2:0},style:b({lineCap:"round"},o.getModel("lineStyle").getLineStyle()),silent:!0,z2:1}))},_renderAxisTick:function(e,t,n,o){var i=o.getData(),r=n.scale.getTicks();hw(r,(function(e){var r=n.dataToCoord(e),a=i.getItemModel(e),s=a.getModel("itemStyle"),l=a.getModel("emphasis.itemStyle"),u={position:[r,0],onclick:fw(this._changeTimeline,this,e)},c=mw(a,s,t,u);Ks(c,l.getItemStyle()),a.get("tooltip")?(c.dataIndex=e,c.dataModel=o):c.dataIndex=c.dataModel=null}),this)},_renderAxisLabel:function(e,t,n,o){if(n.getLabelModel().get("show")){var i=o.getData(),r=n.getViewLabels();hw(r,(function(o){var r=o.tickValue,a=i.getItemModel(r),s=a.getModel("label"),l=a.getModel("emphasis.label"),u=n.dataToCoord(o.tickValue),c=new Sa({position:[u,0],rotation:e.labelRotation-e.rotation,onclick:fw(this._changeTimeline,this,r),silent:!1});Vs(c.style,s,{text:o.formattedLabel,textAlign:e.labelAlign,textVerticalAlign:e.labelBaseline}),t.add(c),Ks(c,Vs({},l))}),this)}},_renderControl:function(e,t,n,o){var i=e.controlSize,r=e.rotation,a=o.getModel("controlStyle").getItemStyle(),s=o.getModel("emphasis.controlStyle").getItemStyle(),l=[0,-i/2,i,i],u=o.getPlayState(),c=o.get("inverse",!0);function d(e,n,u,c){if(e){var d=function(e,t,n,o){var i=o.style,r=nl(e.get(t),o||{},new En(n[0],n[1],n[2],n[3]));return i&&r.setStyle(i),r}(o,n,l,{position:e,origin:[i/2,0],rotation:c?-r:0,rectHover:!0,style:a,onclick:u});t.add(d),Ks(d,s)}}d(e.nextBtnPosition,"controlStyle.nextIcon",fw(this._changeTimeline,this,c?"-":"+")),d(e.prevBtnPosition,"controlStyle.prevIcon",fw(this._changeTimeline,this,c?"+":"-")),d(e.playPosition,"controlStyle."+(u?"stopIcon":"playIcon"),fw(this._handlePlayClick,this,!u),!0)},_renderCurrentPointer:function(e,t,n,o){var i=o.getData(),r=o.getCurrentIndex(),a=i.getItemModel(r).getModel("checkpointStyle"),s=this;this._currentPointer=mw(a,a,this._mainGroup,{},this._currentPointer,{onCreate:function(e){e.draggable=!0,e.drift=fw(s._handlePointerDrag,s),e.ondragend=fw(s._handlePointerDragend,s),pw(e,r,n,o,!0)},onUpdate:function(e){pw(e,r,n,o)}})},_handlePlayClick:function(e){this._clearTimer(),this.api.dispatchAction({type:"timelinePlayChange",playState:e,from:this.uid})},_handlePointerDrag:function(e,t,n){this._clearTimer(),this._pointerChangeTimeline([n.offsetX,n.offsetY])},_handlePointerDragend:function(e){this._pointerChangeTimeline([e.offsetX,e.offsetY],!0)},_pointerChangeTimeline:function(e,t){var n=this._toAxisCoord(e)[0],o=xl(this._axis.getExtent().slice());n>o[1]&&(n=o[1]),n<o[0]&&(n=o[0]),this._currentPointer.position[0]=n,this._currentPointer.dirty();var i=this._findNearestTick(n),r=this.model;(t||i!==r.getCurrentIndex()&&r.get("realtime"))&&this._changeTimeline(i)},_doPlayStop:function(){this._clearTimer(),this.model.getPlayState()&&(this._timer=setTimeout(fw((function(){var e=this.model;this._changeTimeline(e.getCurrentIndex()+(e.get("rewind",!0)?-1:1))}),this),this.model.get("playInterval")))},_toAxisCoord:function(e){return Js(e,this._mainGroup.getLocalTransform(),!0)},_findNearestTick:function(e){var t,n=this.model.getData(),o=1/0,i=this._axis;return n.each(["value"],(function(n,r){var a=i.dataToCoord(n),s=Math.abs(a-e);s<o&&(o=s,t=r)})),t},_clearTimer:function(){this._timer&&(clearTimeout(this._timer),this._timer=null)},_changeTimeline:function(e){var t=this.model.getCurrentIndex();"+"===e?e=t+1:"-"===e&&(e=t-1),this.api.dispatchAction({type:"timelineChange",currentIndex:e,from:this.uid})}}),Qf((function(e){var t=e&&e.timeline;M(t)||(t=t?[t]:[]),O(t,(function(e){e&&function(e){var t=e.type,n={number:"value",time:"time"};if(n[t]&&(e.axisType=n[t],delete e.type),sw(e),lw(e,"controlPosition")){var o=e.controlStyle||(e.controlStyle={});lw(o,"position")||(o.position=e.controlPosition),"none"!==o.position||lw(o,"show")||(o.show=!1,delete o.position),delete e.controlPosition}O(e.data||[],(function(e){L(e)&&!M(e)&&(!lw(e,"value")&&lw(e,"name")&&(e.value=e.name),sw(e))}))}(e)}))}));var vw=Bl,yw=Wl;function bw(e){wi(e,"label",["show"])}var Cw=sh({type:"marker",dependencies:["series","grid","polar","geo"],init:function(e,t,n){this.mergeDefaultAndTheme(e,n),this._mergeOption(e,n,!1,!0)},isAnimationEnabled:function(){if(i.node)return!1;var e=this.__hostSeries;return this.getShallow("animation")&&e&&e.isAnimationEnabled()},mergeOption:function(e,t){this._mergeOption(e,t,!1,!1)},_mergeOption:function(e,t,n,o){var i=this.constructor,r=this.mainType+"Model";n||t.eachSeries((function(e){var n=e.get(this.mainType,!0),a=e[r];n&&n.data?(a?a._mergeOption(n,t,!0):(o&&bw(n),O(n.data,(function(e){e instanceof Array?(bw(e[0]),bw(e[1])):bw(e)})),b(a=new i(n,this,t),{mainType:this.mainType,seriesIndex:e.seriesIndex,name:e.name,createdBySelf:!0}),a.__hostSeries=e),e[r]=a):e[r]=null}),this)},formatTooltip:function(e,t,n,o){var i=this.getData(),r=this.getRawValue(e),a=M(r)?w(r,vw).join(", "):vw(r),s=i.getName(e),l=yw(this.name);return null==r&&!s||(l+="html"===o?"<br/>":"\n"),s&&(l+=yw(s),null!=r&&(l+=" : ")),null!=r&&(l+=yw(a)),l},getData:function(){return this._data},setData:function(e){this._data=e}});I(Cw,wc),Cw.extend({type:"markPoint",defaultOption:{zlevel:0,z:5,symbol:"pin",symbolSize:50,tooltip:{trigger:"item"},label:{show:!0,position:"inside"},itemStyle:{borderWidth:2},emphasis:{label:{show:!0}}}});var Tw=E;function xw(e,t,n,o,i,r){var a=[],s=jh(t,o)?t.getCalculationInfo("stackResultDimension"):o,l=Rw(t,s,e),u=t.indicesOfNearest(s,l)[0];a[i]=t.get(n,u),a[r]=t.get(s,u);var c=t.get(o,u),d=El(t.get(o,u));return 0<=(d=Math.min(d,20))&&(a[r]=+a[r].toFixed(d)),[a,c]}var Ew=N,_w={min:Ew(xw,"min"),max:Ew(xw,"max"),average:Ew(xw,"average")};function Iw(e,t){var n=e.getData(),o=e.coordinateSystem;if(t&&!function(e){return!isNaN(parseFloat(e.x))&&!isNaN(parseFloat(e.y))}(t)&&!M(t.coord)&&o){var i=o.dimensions,r=Dw(t,n,o,e);if((t=p(t)).type&&_w[t.type]&&r.baseAxis&&r.valueAxis){var a=Tw(i,r.baseAxis.dim),s=Tw(i,r.valueAxis.dim),l=_w[t.type](n,r.baseDataDim,r.valueDataDim,a,s);t.coord=l[0],t.value=l[1]}else{for(var u=[null!=t.xAxis?t.xAxis:t.radiusAxis,null!=t.yAxis?t.yAxis:t.angleAxis],c=0;c<2;c++)_w[u[c]]&&(u[c]=Rw(n,n.mapDimension(i[c]),u[c]));t.coord=u}}return t}function Dw(e,t,n,o){var i={};return null!=e.valueIndex||null!=e.valueDim?(i.valueDataDim=null!=e.valueIndex?t.getDimension(e.valueIndex):e.valueDim,i.valueAxis=n.getAxis(function(e,t){var n=e.getData(),o=n.dimensions;t=n.getDimension(t);for(var i=0;i<o.length;i++){var r=n.getDimensionInfo(o[i]);if(r.name===t)return r.coordDim}}(o,i.valueDataDim)),i.baseAxis=n.getOtherAxis(i.valueAxis),i.baseDataDim=t.mapDimension(i.baseAxis.dim)):(i.baseAxis=o.getBaseAxis(),i.valueAxis=n.getOtherAxis(i.baseAxis),i.baseDataDim=t.mapDimension(i.baseAxis.dim),i.valueDataDim=t.mapDimension(i.valueAxis.dim)),i}function Ow(e,t){return!(e&&e.containData&&t.coord&&!function(e){return!(isNaN(parseFloat(e.x))&&isNaN(parseFloat(e.y)))}(t))||e.containData(t.coord)}function ww(e,t,n,o){return o<2?e.coord&&e.coord[o]:e.value}function Rw(e,t,n){if("average"!==n)return"median"===n?e.getMedian(t):e.getDataExtent(t,!0)["max"===n?1:0];var o=0,i=0;return e.each(t,(function(e,t){isNaN(e)||(o+=e,i++)})),o/i}var Sw=lh({type:"marker",init:function(){this.markerGroupMap=Q()},render:function(e,t,n){var o=this.markerGroupMap;o.each((function(e){e.__keep=!1}));var i=this.type+"Model";t.eachSeries((function(e){var o=e[i];o&&this.renderSeries(e,o,t,n)}),this),o.each((function(e){e.__keep||this.group.remove(e.group)}),this)},renderSeries:function(){}});function kw(e,t,n){var o=t.coordinateSystem;e.each((function(i){var r,a=e.getItemModel(i),s=Cl(a.get("x"),n.getWidth()),l=Cl(a.get("y"),n.getHeight());if(isNaN(s)||isNaN(l)){if(t.getMarkerPosition)r=t.getMarkerPosition(e.getValues(e.dimensions,i));else if(o){var u=e.get(o.dimensions[0],i),c=e.get(o.dimensions[1],i);r=o.dataToPoint([u,c])}}else r=[s,l];isNaN(s)||(r[0]=s),isNaN(l)||(r[1]=l),e.setItemLayout(i,r)}))}function Aw(e,t,n,o){var i=e.getData(),r=o.type;if(!M(o)&&("min"===r||"max"===r||"average"===r||"median"===r||null!=o.xAxis||null!=o.yAxis)){var a,s;if(null!=o.yAxis||null!=o.xAxis)a=t.getAxis(null!=o.yAxis?"y":"x"),s=H(o.yAxis,o.xAxis);else{var l=Dw(o,i,t,e);a=l.valueAxis,s=Rw(i,Gh(i,l.valueDataDim),r)}var u="x"===a.dim?0:1,c=1-u,d=p(o),f={};d.type=null,d.coord=[],f.coord=[],d.coord[c]=-1/0,f.coord[c]=1/0;var h=n.get("precision");0<=h&&"number"==typeof s&&(s=+s.toFixed(Math.min(h,20))),d.coord[u]=f.coord[u]=s,o=[d,f,{type:r,valueIndex:o.valueIndex,value:s}]}return(o=[Iw(e,o[0]),Iw(e,o[1]),b({},o[2])])[2].type=o[2].type||"",v(o[2],o[0]),v(o[2],o[1]),o}function Nw(e){return!isNaN(e)&&!isFinite(e)}function Mw(e,t,n,o){var i=1-e,r=o.dimensions[e];return Nw(t[i])&&Nw(n[i])&&t[e]===n[e]&&o.getAxis(r).containData(t[e])}function Kw(e,t){if("cartesian2d"===e.type){var n=t[0].coord,o=t[1].coord;if(n&&o&&(Mw(1,n,o,e)||Mw(0,n,o,e)))return!0}return Ow(e,t[0])&&Ow(e,t[1])}function Pw(e,t,n,o,i){var r,a=o.coordinateSystem,s=e.getItemModel(t),l=Cl(s.get("x"),i.getWidth()),u=Cl(s.get("y"),i.getHeight());if(isNaN(l)||isNaN(u)){if(o.getMarkerPosition)r=o.getMarkerPosition(e.getValues(e.dimensions,t));else{var c=a.dimensions,d=e.get(c[0],t),f=e.get(c[1],t);r=a.dataToPoint([d,f])}if("cartesian2d"===a.type){var h=a.getAxis("x"),g=a.getAxis("y");Nw(e.get((c=a.dimensions)[0],t))?r[0]=h.toGlobalCoord(h.getExtent()[n?0:1]):Nw(e.get(c[1],t))&&(r[1]=g.toGlobalCoord(g.getExtent()[n?0:1]))}isNaN(l)||(r[0]=l),isNaN(u)||(r[1]=u)}else r=[l,u];e.setItemLayout(t,r)}function Lw(e,t,n,o){var i=Iw(e,o[0]),r=Iw(e,o[1]),a=H,s=i.coord,l=r.coord;s[0]=a(s[0],-1/0),s[1]=a(s[1],-1/0),l[0]=a(l[0],1/0),l[1]=a(l[1],1/0);var u=y([{},i,r]);return u.coord=[i.coord,r.coord],u.x0=i.x,u.y0=i.y,u.x1=r.x,u.y1=r.y,u}function Bw(e){return!isNaN(e)&&!isFinite(e)}function Fw(e,t,n){var o=1-e;return Bw(t[o])&&Bw(n[o])}function zw(e,t){var n=t.coord[0],o=t.coord[1];return!("cartesian2d"!==e.type||!n||!o||!Fw(1,n,o)&&!Fw(0,n,o))||Ow(e,{coord:n,x:t.x0,y:t.y0})||Ow(e,{coord:o,x:t.x1,y:t.y1})}function Vw(e,t,n,o,i){var r,a=o.coordinateSystem,s=e.getItemModel(t),l=Cl(s.get(n[0]),i.getWidth()),u=Cl(s.get(n[1]),i.getHeight());if(isNaN(l)||isNaN(u)){if(o.getMarkerPosition)r=o.getMarkerPosition(e.getValues(n,t));else{var c=[h=e.get(n[0],t),g=e.get(n[1],t)];a.clampData&&a.clampData(c,c),r=a.dataToPoint(c,!0)}if("cartesian2d"===a.type){var d=a.getAxis("x"),f=a.getAxis("y"),h=e.get(n[0],t),g=e.get(n[1],t);Bw(h)?r[0]=d.toGlobalCoord(d.getExtent()["x0"===n[0]?0:1]):Bw(g)&&(r[1]=f.toGlobalCoord(f.getExtent()["y0"===n[1]?0:1]))}isNaN(l)||(r[0]=l),isNaN(u)||(r[1]=u)}else r=[l,u];return r}Sw.extend({type:"markPoint",updateTransform:function(e,t,n){t.eachSeries((function(e){var t=e.markPointModel;t&&(kw(t.getData(),e,n),this.markerGroupMap.get(e.id).updateLayout(t))}),this)},renderSeries:function(e,t,n,o){var i=e.coordinateSystem,r=e.id,a=e.getData(),s=this.markerGroupMap,l=s.get(r)||s.set(r,new Am),u=function(e,t,n){var o;o=e?w(e&&e.dimensions,(function(e){return C({name:e},t.getData().getDimensionInfo(t.getData().mapDimension(e))||{})})):[{name:"value",type:"float"}];var i=new wh(o,n),r=w(n.get("data"),N(Iw,t));return e&&(r=S(r,N(Ow,e))),i.initData(r,null,e?ww:function(e){return e.value}),i}(i,e,t);t.setData(u),kw(t.getData(),e,o),u.each((function(e){var n=u.getItemModel(e),o=n.getShallow("symbol"),i=n.getShallow("symbolSize"),r=n.getShallow("symbolRotate"),s=K(o),l=K(i),c=K(r);if(s||l||c){var d=t.getRawValue(e),f=t.getDataParams(e);s&&(o=o(d,f)),l&&(i=i(d,f)),c&&(r=r(d,f))}u.setItemVisual(e,{symbol:o,symbolSize:i,symbolRotate:r,color:n.get("itemStyle.color")||a.getVisual("color")})})),l.updateData(u),this.group.add(l.group),u.eachItemGraphicEl((function(e){e.traverse((function(e){e.dataModel=t}))})),l.__keep=!0,l.group.silent=t.get("silent")||e.get("silent")}}),Qf((function(e){e.markPoint=e.markPoint||{}})),Cw.extend({type:"markLine",defaultOption:{zlevel:0,z:5,symbol:["circle","arrow"],symbolSize:[8,16],precision:2,tooltip:{trigger:"item"},label:{show:!0,position:"end",distance:5},lineStyle:{type:"dashed"},emphasis:{label:{show:!0},lineStyle:{width:3}},animationEasing:"linear"}}),Sw.extend({type:"markLine",updateTransform:function(e,t,n){t.eachSeries((function(e){var t=e.markLineModel;if(t){var o=t.getData(),i=t.__from,r=t.__to;i.each((function(t){Pw(i,t,!0,e,n),Pw(r,t,!1,e,n)})),o.each((function(e){o.setItemLayout(e,[i.getItemLayout(e),r.getItemLayout(e)])})),this.markerGroupMap.get(e.id).updateLayout()}}),this)},renderSeries:function(e,t,n,o){var i=e.coordinateSystem,r=e.id,a=e.getData(),s=this.markerGroupMap,l=s.get(r)||s.set(r,new FC);this.group.add(l.group);var u=function(e,t,n){var o;o=e?w(e&&e.dimensions,(function(e){return C({name:e},t.getData().getDimensionInfo(t.getData().mapDimension(e))||{})})):[{name:"value",type:"float"}];var i=new wh(o,n),r=new wh(o,n),a=new wh([],n),s=w(n.get("data"),N(Aw,t,e,n));e&&(s=S(s,N(Kw,e)));var l=e?ww:function(e){return e.value};return i.initData(w(s,(function(e){return e[0]})),null,l),r.initData(w(s,(function(e){return e[1]})),null,l),a.initData(w(s,(function(e){return e[2]}))),a.hasItemOption=!0,{from:i,to:r,line:a}}(i,e,t),c=u.from,d=u.to,f=u.line;t.__from=c,t.__to=d,t.setData(f);var h=t.get("symbol"),g=t.get("symbolSize");function m(t,n,i){var r=t.getItemModel(n);Pw(t,n,i,e,o),t.setItemVisual(n,{symbolRotate:r.get("symbolRotate"),symbolSize:r.get("symbolSize")||g[i?0:1],symbol:r.get("symbol",!0)||h[i?0:1],color:r.get("itemStyle.color")||a.getVisual("color")})}M(h)||(h=[h,h]),"number"==typeof g&&(g=[g,g]),u.from.each((function(e){m(c,e,!0),m(d,e,!1)})),f.each((function(e){var t=f.getItemModel(e).get("lineStyle.color");f.setItemVisual(e,{color:t||c.getItemVisual(e,"color")}),f.setItemLayout(e,[c.getItemLayout(e),d.getItemLayout(e)]),f.setItemVisual(e,{fromSymbolRotate:c.getItemVisual(e,"symbolRotate"),fromSymbolSize:c.getItemVisual(e,"symbolSize"),fromSymbol:c.getItemVisual(e,"symbol"),toSymbolRotate:d.getItemVisual(e,"symbolRotate"),toSymbolSize:d.getItemVisual(e,"symbolSize"),toSymbol:d.getItemVisual(e,"symbol")})})),l.updateData(f),u.line.eachItemGraphicEl((function(e,n){e.traverse((function(e){e.dataModel=t}))})),l.__keep=!0,l.group.silent=t.get("silent")||e.get("silent")}}),Qf((function(e){e.markLine=e.markLine||{}})),Cw.extend({type:"markArea",defaultOption:{zlevel:0,z:1,tooltip:{trigger:"item"},animation:!1,label:{show:!0,position:"top"},itemStyle:{borderWidth:0},emphasis:{label:{show:!0,position:"top"}}}});var Hw=[["x0","y0"],["x1","y0"],["x1","y1"],["x0","y1"]];Sw.extend({type:"markArea",updateTransform:function(e,t,n){t.eachSeries((function(e){var t=e.markAreaModel;if(t){var o=t.getData();o.each((function(t){var i=w(Hw,(function(i){return Vw(o,t,i,e,n)}));o.setItemLayout(t,i),o.getItemGraphicEl(t).setShape("points",i)}))}}),this)},renderSeries:function(e,t,n,o){var i=e.coordinateSystem,r=e.id,a=e.getData(),s=this.markerGroupMap,l=s.get(r)||s.set(r,{group:new _n});this.group.add(l.group),l.__keep=!0;var u=function(e,t,n){var o,i;i=e?(o=w(e&&e.dimensions,(function(e){var n=t.getData();return C({name:e},n.getDimensionInfo(n.mapDimension(e))||{})})),new wh(w(["x0","y0","x1","y1"],(function(e,t){return{name:e,type:o[t%2].type}})),n)):new wh(o=[{name:"value",type:"float"}],n);var r=w(n.get("data"),N(Lw,t,e,n));return e&&(r=S(r,N(zw,e))),i.initData(r,null,e?function(e,t,n,o){return e.coord[Math.floor(o/2)][o%2]}:function(e){return e.value}),i.hasItemOption=!0,i}(i,e,t);t.setData(u),u.each((function(t){var n=w(Hw,(function(n){return Vw(u,t,n,e,o)})),r=!0;O(Hw,(function(e){if(r){var n=u.get(e[0],t),o=u.get(e[1],t);(Bw(n)||i.getAxis("x").containData(n))&&(Bw(o)||i.getAxis("y").containData(o))&&(r=!1)}})),u.setItemLayout(t,{points:n,allClipped:r}),u.setItemVisual(t,{color:a.getVisual("color")})})),u.diff(l.__data).add((function(e){var t=u.getItemLayout(e);if(!t.allClipped){var n=new Ba({shape:{points:t.points}});u.setItemGraphicEl(e,n),l.group.add(n)}})).update((function(e,n){var o=l.__data.getItemGraphicEl(n),i=u.getItemLayout(e);i.allClipped?o&&l.group.remove(o):(o?Xs(o,{shape:{points:i.points}},t,e):o=new Ba({shape:{points:i.points}}),u.setItemGraphicEl(e,o),l.group.add(o))})).remove((function(e){var t=l.__data.getItemGraphicEl(e);l.group.remove(t)})).execute(),u.eachItemGraphicEl((function(e,n){var o=u.getItemModel(n),i=o.getModel("label"),r=o.getModel("emphasis.label"),a=u.getItemVisual(n,"color");e.useStyle(C(o.getModel("itemStyle").getItemStyle(),{fill:qt(a,.4),stroke:a})),e.hoverStyle=o.getModel("emphasis.itemStyle").getItemStyle(),Fs(e.style,e.hoverStyle,i,r,{labelFetcher:t,labelDataIndex:n,defaultText:u.getName(n)||"",isRectText:!0,autoColor:a}),Ks(e,{}),e.dataModel=t})),l.__data=u,l.group.silent=t.get("silent")||e.get("silent")}}),Qf((function(e){e.markArea=e.markArea||{}}));var Ww=pd.legend.selector,$w={all:{type:"all",title:p(Ww.all)},inverse:{type:"inverse",title:p(Ww.inverse)}},Uw=sh({type:"legend.plain",dependencies:["series"],layoutMode:{type:"box",ignoreSize:!0},init:function(e,t,n){this.mergeDefaultAndTheme(e,n),e.selected=e.selected||{},this._updateSelector(e)},mergeOption:function(e){Uw.superCall(this,"mergeOption",e),this._updateSelector(e)},_updateSelector:function(e){var t=e.selector;!0===t&&(t=e.selector=["all","inverse"]),M(t)&&O(t,(function(e,n){P(e)&&(e={type:e}),t[n]=v(e,$w[e.type])}))},optionUpdated:function(){this._updateData(this.ecModel);var e=this._data;if(e[0]&&"single"===this.get("selectedMode")){for(var t=!1,n=0;n<e.length;n++){var o=e[n].get("name");if(this.isSelected(o)){this.select(o),t=!0;break}}t||this.select(e[0].get("name"))}},_updateData:function(e){var t=[],n=[];e.eachRawSeries((function(o){var i;if(n.push(o.name),o.legendVisualProvider){var r=o.legendVisualProvider.getAllNames();e.isSeriesFiltered(o)||(n=n.concat(r)),r.length?t=t.concat(r):i=!0}else i=!0;i&&Ni(o)&&t.push(o.name)})),this._availableNames=n;var o=w(this.get("data")||t,(function(e){return"string"!=typeof e&&"number"!=typeof e||(e={name:e}),new hl(e,this,this.ecModel)}),this);this._data=o},getData:function(){return this._data},select:function(e){var t=this.option.selected;"single"===this.get("selectedMode")&&O(this._data,(function(e){t[e.get("name")]=!1})),t[e]=!0},unSelect:function(e){"single"!==this.get("selectedMode")&&(this.option.selected[e]=!1)},toggleSelected:function(e){var t=this.option.selected;t.hasOwnProperty(e)||(t[e]=!0),this[t[e]?"unSelect":"select"](e)},allSelect:function(){var e=this.option.selected;O(this._data,(function(t){e[t.get("name",!0)]=!0}))},inverseSelect:function(){var e=this.option.selected;O(this._data,(function(t){var n=t.get("name",!0);e.hasOwnProperty(n)||(e[n]=!0),e[n]=!e[n]}))},isSelected:function(e){var t=this.option.selected;return!(t.hasOwnProperty(e)&&!t[e])&&0<=E(this._availableNames,e)},getOrient:function(){return"vertical"===this.get("orient")?{index:1,name:"vertical"}:{index:0,name:"horizontal"}},defaultOption:{zlevel:0,z:4,show:!0,orient:"horizontal",left:"center",top:0,align:"auto",backgroundColor:"rgba(0,0,0,0)",borderColor:"#ccc",borderRadius:0,borderWidth:0,padding:5,itemGap:10,itemWidth:25,itemHeight:14,inactiveColor:"#ccc",inactiveBorderColor:"#ccc",itemStyle:{borderWidth:0},textStyle:{color:"#333"},selectedMode:!0,selector:!1,selectorLabel:{show:!0,borderRadius:10,padding:[3,5,3,5],fontSize:12,fontFamily:" sans-serif",color:"#666",borderWidth:1,borderColor:"#666"},emphasis:{selectorLabel:{show:!0,color:"#eee",backgroundColor:"#666"}},selectorPosition:"auto",selectorItemGap:7,selectorButtonGap:10,tooltip:{show:!1}}});function qw(e,t,n){var o,i={},r="toggleSelected"===e;return n.eachComponent("legend",(function(n){r&&null!=o?n[o?"select":"unSelect"](t.name):"allSelect"===e||"inverseSelect"===e?n[e]():(n[e](t.name),o=n.isSelected(t.name)),O(n.getData(),(function(e){var t=e.get("name");if("\n"!==t&&""!==t){var o=n.isSelected(t);i[t]=i.hasOwnProperty(t)?i[t]&&o:o}}))})),"allSelect"===e||"inverseSelect"===e?{selected:i}:{name:t.name,selected:i}}th("legendToggleSelect","legendselectchanged",N(qw,"toggleSelected")),th("legendAllSelect","legendselectall",N(qw,"allSelect")),th("legendInverseSelect","legendinverseselect",N(qw,"inverseSelect")),th("legendSelect","legendselected",N(qw,"select")),th("legendUnSelect","legendunselected",N(qw,"unSelect"));var jw=N,Gw=O,Xw=_n,Yw=lh({type:"legend.plain",newlineDisabled:!1,init:function(){this.group.add(this._contentGroup=new Xw),this.group.add(this._selectorGroup=new Xw),this._isFirstRender=!0},getContentGroup:function(){return this._contentGroup},getSelectorGroup:function(){return this._selectorGroup},render:function(e,t,n){var o=this._isFirstRender;if(this._isFirstRender=!1,this.resetInner(),e.get("show",!0)){var i=e.get("align"),r=e.get("orient");i&&"auto"!==i||(i="right"===e.get("left")&&"vertical"===r?"right":"left");var a=e.get("selector",!0),s=e.get("selectorPosition",!0);!a||s&&"auto"!==s||(s="horizontal"===r?"end":"start"),this.renderInner(i,e,t,n,a,r,s);var l=e.getBoxLayoutParams(),u={width:n.getWidth(),height:n.getHeight()},c=e.get("padding"),d=au(l,u,c),f=this.layoutInner(e,i,d,o,a,s),h=au(C({width:f.width,height:f.height},l),u,c);this.group.attr("position",[h.x-f.x,h.y-f.y]),this.group.add(this._backgroundEl=TD(f,e))}},resetInner:function(){this.getContentGroup().removeAll(),this._backgroundEl&&this.group.remove(this._backgroundEl),this.getSelectorGroup().removeAll()},renderInner:function(e,t,n,o,i,r,a){var s=this.getContentGroup(),l=Q(),u=t.get("selectedMode"),c=[];n.eachRawSeries((function(e){e.get("legendHoverLink")||c.push(e.id)})),Gw(t.getData(),(function(i,r){var a=i.get("name");if(this.newlineDisabled||""!==a&&"\n"!==a){var d=n.getSeriesByName(a)[0];if(!l.get(a))if(d){var f=d.getData(),h=f.getVisual("color"),g=f.getVisual("borderColor");"function"==typeof h&&(h=h(d.getDataParams(0))),"function"==typeof g&&(g=g(d.getDataParams(0)));var m=f.getVisual("legendSymbol")||"roundRect",p=f.getVisual("symbol");this._createItem(a,r,i,t,m,p,e,h,g,u).on("click",jw(Jw,a,null,o,c)).on("mouseover",jw(Qw,d.name,null,o,c)).on("mouseout",jw(eR,d.name,null,o,c)),l.set(a,!0)}else n.eachRawSeries((function(n){if(!l.get(a)&&n.legendVisualProvider){var s=n.legendVisualProvider;if(!s.containName(a))return;var d=s.indexOfName(a),f=s.getItemVisual(d,"color"),h=s.getItemVisual(d,"borderColor");this._createItem(a,r,i,t,"roundRect",null,e,f,h,u).on("click",jw(Jw,null,a,o,c)).on("mouseover",jw(Qw,null,a,o,c)).on("mouseout",jw(eR,null,a,o,c)),l.set(a,!0)}}),this)}else s.add(new Xw({newline:!0}))}),this),i&&this._createSelector(i,t,o,r,a)},_createSelector:function(e,t,n,o,i){var r=this.getSelectorGroup();Gw(e,(function(e){!function(e){var o=e.type,i=new Sa({style:{x:0,y:0,align:"center",verticalAlign:"middle"},onclick:function(){n.dispatchAction({type:"all"===o?"legendAllSelect":"legendInverseSelect"})}});r.add(i);var a=t.getModel("selectorLabel"),s=t.getModel("emphasis.selectorLabel");Fs(i.style,i.hoverStyle={},a,s,{defaultText:e.title,isRectText:!1}),Ks(i)}(e)}))},_createItem:function(e,t,n,o,i,r,a,s,l,u){var c=o.get("itemWidth"),d=o.get("itemHeight"),f=o.get("inactiveColor"),h=o.get("inactiveBorderColor"),g=o.get("symbolKeepAspect"),m=o.getModel("itemStyle"),p=o.isSelected(e),v=new Xw,y=n.getModel("textStyle"),C=n.get("icon"),T=n.getModel("tooltip"),x=T.parentModel,E=tm(i=C||i,0,0,c,d,p?s:f,null==g||g);if(v.add(Zw(E,i,m,l,h,p)),!C&&r&&(r!==i||"none"===r)){var _=.8*d;"none"===r&&(r="circle");var I=tm(r,(c-_)/2,(d-_)/2,_,_,p?s:f,null==g||g);v.add(Zw(I,r,m,l,h,p))}var D="left"===a?c+5:-5,O=a,w=o.get("formatter"),R=e;"string"==typeof w&&w?R=w.replace("{name}",null!=e?e:""):"function"==typeof w&&(R=w(e)),v.add(new Sa({style:Vs({},y,{text:R,x:D,y:d/2,textFill:p?y.getTextColor():f,textAlign:O,textVerticalAlign:"middle"})}));var S=new Ua({shape:v.getBoundingRect(),invisible:!0,tooltip:T.get("show")?b({content:e,formatter:x.get("formatter",!0)||function(){return e},formatterParams:{componentType:"legend",legendIndex:o.componentIndex,name:e,$vars:["name"]}},T.option):null});return v.add(S),v.eachChild((function(e){e.silent=!0})),S.silent=!u,this.getContentGroup().add(v),Ks(v),v.__legendDataIndex=t,v},layoutInner:function(e,t,n,o,i,r){var a=this.getContentGroup(),s=this.getSelectorGroup();ru(e.get("orient"),a,e.get("itemGap"),n.width,n.height);var l=a.getBoundingRect(),u=[-l.x,-l.y];if(i){ru("horizontal",s,e.get("selectorItemGap",!0));var c=s.getBoundingRect(),d=[-c.x,-c.y],f=e.get("selectorButtonGap",!0),h=e.getOrient().index,g=0===h?"width":"height",m=0===h?"height":"width",p=0===h?"y":"x";"end"===r?d[h]+=l[g]+f:u[h]+=c[g]+f,d[1-h]+=l[m]/2-c[m]/2,s.attr("position",d),a.attr("position",u);var v={x:0,y:0};return v[g]=l[g]+f+c[g],v[m]=Math.max(l[m],c[m]),v[p]=Math.min(0,c[p]+d[1-h]),v}return a.attr("position",u),this.group.getBoundingRect()},remove:function(){this.getContentGroup().removeAll(),this._isFirstRender=!0}});function Zw(e,t,n,o,i,r){var a;return"line"!==t&&t.indexOf("empty")<0?(a=n.getItemStyle(),e.style.stroke=o,r||(a.stroke=i)):a=n.getItemStyle(["borderWidth","borderColor"]),e.setStyle(a)}function Jw(e,t,n,o){eR(e,t,n,o),n.dispatchAction({type:"legendToggleSelect",name:null!=e?e:t}),Qw(e,t,n,o)}function Qw(e,t,n,o){var i=n.getZr().storage.getDisplayList()[0];i&&i.useHoverLayer||n.dispatchAction({type:"highlight",seriesName:e,name:t,excludeSeriesId:o})}function eR(e,t,n,o){var i=n.getZr().storage.getDisplayList()[0];i&&i.useHoverLayer||n.dispatchAction({type:"downplay",seriesName:e,name:t,excludeSeriesId:o})}eh(ff.PROCESSOR.SERIES_FILTER,(function(e){var t=e.findComponents({mainType:"legend"});t&&t.length&&e.filterSeries((function(e){for(var n=0;n<t.length;n++)if(!t[n].isSelected(e.name))return!1;return!0}))})),mu.registerSubTypeDefaulter("legend",(function(){return"plain"}));var tR=Uw.extend({type:"legend.scroll",setScrollDataIndex:function(e){this.option.scrollDataIndex=e},defaultOption:{scrollDataIndex:0,pageButtonItemGap:5,pageButtonGap:null,pageButtonPosition:"end",pageFormatter:"{current}/{total}",pageIcons:{horizontal:["M0,0L12,-10L12,10z","M0,0L-12,-10L-12,10z"],vertical:["M0,0L20,0L10,-20z","M0,0L20,0L10,20z"]},pageIconColor:"#2f4554",pageIconInactiveColor:"#aaa",pageIconSize:15,pageTextStyle:{color:"#333"},animationDurationUpdate:800},init:function(e,t,n,o){var i=uu(e);tR.superCall(this,"init",e,t,n,o),nR(this,e,i)},mergeOption:function(e,t){tR.superCall(this,"mergeOption",e,t),nR(this,this.option,e)}});function nR(e,t,n){var o=[1,1];o[e.getOrient().index]=0,lu(t,n,{type:"box",ignoreSize:o})}var oR=_n,iR=["width","height"],rR=["x","y"],aR=Yw.extend({type:"legend.scroll",newlineDisabled:!0,init:function(){aR.superCall(this,"init"),this._currentIndex=0,this.group.add(this._containerGroup=new oR),this._containerGroup.add(this.getContentGroup()),this.group.add(this._controllerGroup=new oR)},resetInner:function(){aR.superCall(this,"resetInner"),this._controllerGroup.removeAll(),this._containerGroup.removeClipPath(),this._containerGroup.__rectSize=null},renderInner:function(e,t,n,o,i,r,a){var s=this;aR.superCall(this,"renderInner",e,t,n,o,i,r,a);var l=this._controllerGroup,u=t.get("pageIconSize",!0);M(u)||(u=[u,u]),d("pagePrev",0);var c=t.getModel("pageTextStyle");function d(e,n){var i=e+"DataIndex",r=nl(t.get("pageIcons",!0)[t.getOrient().name][n],{onclick:A(s._pageGo,s,i,t,o)},{x:-u[0]/2,y:-u[1]/2,width:u[0],height:u[1]});r.name=e,l.add(r)}l.add(new Sa({name:"pageText",style:{textFill:c.getTextColor(),font:c.getFont(),textVerticalAlign:"middle",textAlign:"center"},silent:!0})),d("pageNext",1)},layoutInner:function(e,t,n,o,i,r){var a=this.getSelectorGroup(),s=e.getOrient().index,l=iR[s],u=rR[s],c=iR[1-s],d=rR[1-s];i&&ru("horizontal",a,e.get("selectorItemGap",!0));var f=e.get("selectorButtonGap",!0),h=a.getBoundingRect(),g=[-h.x,-h.y],m=p(n);i&&(m[l]=n[l]-h[l]-f);var v=this._layoutContentAndController(e,o,m,s,l,c,d);if(i){if("end"===r)g[s]+=v[l]+f;else{var y=h[l]+f;g[s]-=y,v[u]-=y}v[l]+=h[l]+f,g[1-s]+=v[d]+v[c]/2-h[c]/2,v[c]=Math.max(v[c],h[c]),v[d]=Math.min(v[d],h[d]+g[1-s]),a.attr("position",g)}return v},_layoutContentAndController:function(e,t,n,o,i,r,a){var s=this.getContentGroup(),l=this._containerGroup,u=this._controllerGroup;ru(e.get("orient"),s,e.get("itemGap"),o?n.width:null,o?null:n.height),ru("horizontal",u,e.get("pageButtonItemGap",!0));var c=s.getBoundingRect(),d=u.getBoundingRect(),f=this._showController=c[i]>n[i],h=[-c.x,-c.y];t||(h[o]=s.position[o]);var g=[0,0],m=[-d.x,-d.y],p=W(e.get("pageButtonGap",!0),e.get("itemGap",!0));f&&("end"===e.get("pageButtonPosition",!0)?m[o]+=n[i]-d[i]:g[o]+=d[i]+p),m[1-o]+=c[r]/2-d[r]/2,s.attr("position",h),l.attr("position",g),u.attr("position",m);var v={x:0,y:0};if(v[i]=f?n[i]:c[i],v[r]=Math.max(c[r],d[r]),v[a]=Math.min(0,d[a]+m[1-o]),l.__rectSize=n[i],f){var y={x:0,y:0};y[i]=Math.max(n[i]-d[i]-p,0),y[r]=v[r],l.setClipPath(new Ua({shape:y})),l.__rectSize=y[i]}else u.eachChild((function(e){e.attr({invisible:!0,silent:!0})}));var b=this._getPageInfo(e);return null!=b.pageIndex&&Xs(s,{position:b.contentPosition},f&&e),this._updatePageInfoView(e,b),v},_pageGo:function(e,t,n){var o=this._getPageInfo(t)[e];null!=o&&n.dispatchAction({type:"legendScroll",scrollDataIndex:o,legendId:t.id})},_updatePageInfoView:function(e,t){var n=this._controllerGroup;O(["pagePrev","pageNext"],(function(o){var i=null!=t[o+"DataIndex"],r=n.childOfName(o);r&&(r.setStyle("fill",e.get(i?"pageIconColor":"pageIconInactiveColor",!0)),r.cursor=i?"pointer":"default")}));var o=n.childOfName("pageText"),i=e.get("pageFormatter"),r=t.pageIndex,a=null!=r?r+1:0,s=t.pageCount;o&&i&&o.setStyle("text",P(i)?i.replace("{current}",a).replace("{total}",s):i({current:a,total:s}))},_getPageInfo:function(e){var t=e.get("scrollDataIndex",!0),n=this.getContentGroup(),o=this._containerGroup.__rectSize,i=e.getOrient().index,r=iR[i],a=rR[i],s=this._findTargetItemIndex(t),l=n.children(),u=l[s],c=l.length,d=c?1:0,f={contentPosition:n.position.slice(),pageCount:d,pageIndex:d-1,pagePrevDataIndex:null,pageNextDataIndex:null};if(!u)return f;var h=y(u);f.contentPosition[i]=-h.s;for(var g=s+1,m=h,p=h,v=null;g<=c;++g)(!(v=y(l[g]))&&p.e>m.s+o||v&&!b(v,m.s))&&(m=p.i>m.i?p:v)&&(null==f.pageNextDataIndex&&(f.pageNextDataIndex=m.i),++f.pageCount),p=v;for(g=s-1,m=h,p=h,v=null;-1<=g;--g)(v=y(l[g]))&&b(p,v.s)||!(m.i<p.i)||(p=m,null==f.pagePrevDataIndex&&(f.pagePrevDataIndex=m.i),++f.pageCount,++f.pageIndex),m=v;return f;function y(e){if(e){var t=e.getBoundingRect(),n=t[a]+e.position[i];return{s:n,e:n+t[r],i:e.__legendDataIndex}}}function b(e,t){return e.e>=t&&e.s<=t+o}},_findTargetItemIndex:function(e){return this._showController?(this.getContentGroup().eachChild((function(o,i){var r=o.__legendDataIndex;null==n&&null!=r&&(n=i),r===e&&(t=i)})),null!=t?t:n):0;var t,n}});th("legendScroll","legendscroll",(function(e,t){var n=e.scrollDataIndex;null!=n&&t.eachComponent({mainType:"legend",subType:"scroll",query:e},(function(e){e.setScrollDataIndex(n)}))})),gO.extend({type:"dataZoom.slider",layoutMode:"box",defaultOption:{show:!0,right:"ph",top:"ph",width:"ph",height:"ph",left:null,bottom:null,backgroundColor:"rgba(47,69,84,0)",dataBackground:{lineStyle:{color:"#2f4554",width:.5,opacity:.3},areaStyle:{color:"rgba(47,69,84,0.3)",opacity:.3}},borderColor:"#ddd",fillerColor:"rgba(167,183,204,0.4)",handleIcon:"M8.2,13.6V3.9H6.3v9.7H3.1v14.9h3.3v9.7h1.8v-9.7h3.3V13.6H8.2z M9.7,24.4H4.8v-1.4h4.9V24.4z M9.7,19.1H4.8v-1.4h4.9V19.1z",handleSize:"100%",handleStyle:{color:"#a7b7cc"},labelPrecision:null,labelFormatter:null,showDetail:!0,showDataShadow:"auto",realtime:!0,zoomLock:!1,textStyle:{color:"#333"}}});var sR=Ua,lR=bl,uR=xl,cR=A,dR=O,fR="horizontal",hR="vertical",gR=["line","bar","candlestick","scatter"],mR=vO.extend({type:"dataZoom.slider",init:function(e,t){this._displayables={},this.api=t},render:function(e,t,n,o){mR.superApply(this,"render",arguments),hd(this,"_dispatchZoomAction",this.dataZoomModel.get("throttle"),"fixRate"),this._orient=e.get("orient"),!1!==this.dataZoomModel.get("show")?(o&&"dataZoom"===o.type&&o.from===this.uid||this._buildView(),this._updateView()):this.group.removeAll()},remove:function(){mR.superApply(this,"remove",arguments),gd(this,"_dispatchZoomAction")},dispose:function(){mR.superApply(this,"dispose",arguments),gd(this,"_dispatchZoomAction")},_buildView:function(){var e=this.group;e.removeAll(),this._resetLocation(),this._resetInterval();var t=this._displayables.barGroup=new _n;this._renderBackground(),this._renderHandle(),this._renderDataShadow(),e.add(t),this._positionGroup()},_resetLocation:function(){var e=this.dataZoomModel,t=this.api,n=this._findCoordRect(),o={width:t.getWidth(),height:t.getHeight()},i=this._orient===fR?{right:o.width-n.x-n.width,top:o.height-30-7,width:n.width,height:30}:{right:7,top:n.y,width:30,height:n.height},r=uu(e.option);O(["right","top","width","height"],(function(e){"ph"===r[e]&&(r[e]=i[e])}));var a=au(r,o,e.padding);this._location={x:a.x,y:a.y},this._size=[a.width,a.height],this._orient===hR&&this._size.reverse()},_positionGroup:function(){var e=this.group,t=this._location,n=this._orient,o=this.dataZoomModel.getFirstTargetAxisModel(),i=o&&o.get("inverse"),r=this._displayables.barGroup,a=(this._dataShadowInfo||{}).otherAxisInverse;r.attr(n!==fR||i?n===fR&&i?{scale:a?[-1,1]:[-1,-1]}:n!==hR||i?{scale:a?[-1,-1]:[-1,1],rotation:Math.PI/2}:{scale:a?[1,-1]:[1,1],rotation:Math.PI/2}:{scale:a?[1,1]:[1,-1]});var s=e.getBoundingRect([r]);e.attr("position",[t.x-s.x,t.y-s.y])},_getViewExtent:function(){return[0,this._size[0]]},_renderBackground:function(){var e=this._size,t=this._displayables.barGroup;t.add(new sR({silent:!0,shape:{x:0,y:0,width:e[0],height:e[1]},style:{fill:this.dataZoomModel.get("backgroundColor")},z2:-40})),t.add(new sR({shape:{x:0,y:0,width:e[0],height:e[1]},style:{fill:"transparent"},z2:0,onclick:A(this._onClickPanelClick,this)}))},_renderDataShadow:function(){var e=this._dataShadowInfo=this._prepareDataShadowInfo();if(e){var t=this._size,n=e.series,o=n.getRawData(),i=n.getShadowDim?n.getShadowDim():e.otherDim;if(null!=i){var r=o.getDataExtent(i),a=.3*(r[1]-r[0]);r=[r[0]-a,r[1]+a];var s,l=[0,t[1]],u=[[t[0],0],[0,0]],c=[],d=t[0]/(o.count()-1),f=0,h=Math.round(o.count()/t[0]);o.each([i],(function(e,t){if(0<h&&t%h)f+=d;else{var n=null==e||isNaN(e)||""===e,o=n?0:lR(e,r,l,!0);n&&!s&&t?(u.push([u[u.length-1][0],0]),c.push([c[c.length-1][0],0])):!n&&s&&(u.push([f,0]),c.push([f,0])),u.push([f,o]),c.push([f,o]),f+=d,s=n}}));var g=this.dataZoomModel;this._displayables.barGroup.add(new Ba({shape:{points:u},style:C({fill:g.get("dataBackgroundColor")},g.getModel("dataBackground.areaStyle").getAreaStyle()),silent:!0,z2:-20})),this._displayables.barGroup.add(new Fa({shape:{points:c},style:g.getModel("dataBackground.lineStyle").getLineStyle(),silent:!0,z2:-19}))}}},_prepareDataShadowInfo:function(){var e=this.dataZoomModel,t=e.get("showDataShadow");if(!1!==t){var n,o=this.ecModel;return e.eachTargetAxis((function(i,r){O(e.getAxisProxy(i.name,r).getTargetSeriesModels(),(function(e){if(!(n||!0!==t&&E(gR,e.get("type"))<0)){var a,s=o.getComponent(i.axis,r).axis,l=function(e){return{x:"y",y:"x",radius:"angle",angle:"radius"}[e]}(i.name),u=e.coordinateSystem;null!=l&&u.getOtherAxis&&(a=u.getOtherAxis(s).inverse),l=e.getData().mapDimension(l),n={thisAxis:s,series:e,thisDim:i.name,otherDim:l,otherAxisInverse:a}}}),this)}),this),n}},_renderHandle:function(){var e=this._displayables,t=e.handles=[],n=e.handleLabels=[],o=this._displayables.barGroup,i=this._size,r=this.dataZoomModel;o.add(e.filler=new sR({draggable:!0,cursor:pR(this._orient),drift:cR(this._onDragMove,this,"all"),ondragstart:cR(this._showDataInfo,this,!0),ondragend:cR(this._onDragEnd,this),onmouseover:cR(this._showDataInfo,this,!0),onmouseout:cR(this._showDataInfo,this,!1),style:{fill:r.get("fillerColor"),textPosition:"inside"}})),o.add(new sR({silent:!0,subPixelOptimize:!0,shape:{x:0,y:0,width:i[0],height:i[1]},style:{stroke:r.get("dataBackgroundColor")||r.get("borderColor"),lineWidth:1,fill:"rgba(0,0,0,0)"}})),dR([0,1],(function(e){var i=nl(r.get("handleIcon"),{cursor:pR(this._orient),draggable:!0,drift:cR(this._onDragMove,this,e),ondragend:cR(this._onDragEnd,this),onmouseover:cR(this._showDataInfo,this,!0),onmouseout:cR(this._showDataInfo,this,!1)},{x:-1,y:0,width:2,height:2}),a=i.getBoundingRect();this._handleHeight=Cl(r.get("handleSize"),this._size[1]),this._handleWidth=a.width/a.height*this._handleHeight,i.setStyle(r.getModel("handleStyle").getItemStyle());var s=r.get("handleColor");null!=s&&(i.style.fill=s),o.add(t[e]=i);var l=r.textStyleModel;this.group.add(n[e]=new Sa({silent:!0,invisible:!0,style:{x:0,y:0,text:"",textVerticalAlign:"middle",textAlign:"center",textFill:l.getTextColor(),textFont:l.getFont()},z2:10}))}),this)},_resetInterval:function(){var e=this._range=this.dataZoomModel.getPercentRange(),t=this._getViewExtent();this._handleEnds=[lR(e[0],[0,100],t,!0),lR(e[1],[0,100],t,!0)]},_updateInterval:function(e,t){var n=this.dataZoomModel,o=this._handleEnds,i=this._getViewExtent(),r=n.findRepresentativeAxisProxy().getMinMaxSpan(),a=[0,100];ET(t,o,i,n.get("zoomLock")?"all":e,null!=r.minSpan?lR(r.minSpan,a,i,!0):null,null!=r.maxSpan?lR(r.maxSpan,a,i,!0):null);var s=this._range,l=this._range=uR([lR(o[0],i,a,!0),lR(o[1],i,a,!0)]);return!s||s[0]!==l[0]||s[1]!==l[1]},_updateView:function(e){var t=this._displayables,n=this._handleEnds,o=uR(n.slice()),i=this._size;dR([0,1],(function(e){var o=this._handleHeight;t.handles[e].attr({scale:[o/2,o/2],position:[n[e],i[1]/2-o/2]})}),this),t.filler.setShape({x:o[0],y:0,width:o[1]-o[0],height:i[1]}),this._updateDataInfo(e)},_updateDataInfo:function(e){var t=this.dataZoomModel,n=this._displayables,o=n.handleLabels,i=this._orient,r=["",""];if(t.get("showDetail")){var a=t.findRepresentativeAxisProxy();if(a){var s=a.getAxisModel().axis,l=this._range,u=e?a.calculateDataWindow({start:l[0],end:l[1]}).valueWindow:a.getDataValueWindow();r=[this._formatLabel(u[0],s),this._formatLabel(u[1],s)]}}var c=uR(this._handleEnds.slice());function d(e){var t=Zs(n.handles[e].parent,this.group),a=Qs(0===e?"right":"left",t),s=this._handleWidth/2+5,l=Js([c[e]+(0===e?-s:s),this._size[1]/2],t);o[e].setStyle({x:l[0],y:l[1],textVerticalAlign:i===fR?"middle":a,textAlign:i===fR?a:"center",text:r[e]})}d.call(this,0),d.call(this,1)},_formatLabel:function(e,t){var n=this.dataZoomModel,o=n.get("labelFormatter"),i=n.get("labelPrecision");null!=i&&"auto"!==i||(i=t.getPixelPrecision());var r=null==e||isNaN(e)?"":"category"===t.type||"time"===t.type?t.scale.getLabel(Math.round(e)):e.toFixed(Math.min(i,20));return K(o)?o(e,r):P(o)?o.replace("{value}",r):r},_showDataInfo:function(e){var t=this._displayables.handleLabels;t[0].attr("invisible",!(e=this._dragging||e)),t[1].attr("invisible",!e)},_onDragMove:function(e,t,n,o){this._dragging=!0,$e(o.event);var i=Js([t,n],this._displayables.barGroup.getLocalTransform(),!0),r=this._updateInterval(e,i[0]),a=this.dataZoomModel.get("realtime");this._updateView(!a),r&&a&&this._dispatchZoomAction()},_onDragEnd:function(){this._dragging=!1,this._showDataInfo(!1),this.dataZoomModel.get("realtime")||this._dispatchZoomAction()},_onClickPanelClick:function(e){var t=this._size,n=this._displayables.barGroup.transformCoordToLocal(e.offsetX,e.offsetY);if(!(n[0]<0||n[0]>t[0]||n[1]<0||n[1]>t[1])){var o=this._handleEnds,i=this._updateInterval("all",n[0]-(o[0]+o[1])/2);this._updateView(),i&&this._dispatchZoomAction()}},_dispatchZoomAction:function(){var e=this._range;this.api.dispatchAction({type:"dataZoom",from:this.uid,dataZoomId:this.dataZoomModel.id,start:e[0],end:e[1]})},_findCoordRect:function(){var e;if(dR(this.getTargetCoordInfo(),(function(t){if(!e&&t.length){var n=t[0].model.coordinateSystem;e=n.getRect&&n.getRect()}})),!e){var t=this.api.getWidth(),n=this.api.getHeight();e={x:.2*t,y:.2*n,width:.6*t,height:.6*n}}return e}});function pR(e){return"vertical"===e?"ns-resize":"ew-resize"}gO.extend({type:"dataZoom.inside",defaultOption:{disabled:!1,zoomLock:!1,zoomOnMouseWheel:!0,moveOnMouseMove:!0,moveOnMouseWheel:!1,preventDefaultMouseMove:!0}});var vR="\0_ec_dataZoom_roams";function yR(e,t){var n=CR(e),o=t.dataZoomId,i=t.coordId;O(n,(function(e,n){var r=e.dataZoomInfos;r[o]&&E(t.allCoordIds,i)<0&&(delete r[o],e.count--)})),TR(n);var r=n[i];r||((r=n[i]={coordId:i,dataZoomInfos:{},count:0}).controller=function(e,t){var n=new fy(e.getZr());return O(["pan","zoom","scrollMove"],(function(e){n.on(e,(function(n){var o=[];O(t.dataZoomInfos,(function(i){if(n.isAvailableBehavior(i.dataZoomModel.option)){var r=(i.getRange||{})[e],a=r&&r(t.controller,n);!i.dataZoomModel.get("disabled",!0)&&a&&o.push({dataZoomId:i.dataZoomId,start:a[0],end:a[1]})}})),o.length&&t.dispatchAction(o)}))})),n}(e,r),r.dispatchAction=N(xR,e)),r.dataZoomInfos[o]||r.count++,r.dataZoomInfos[o]=t;var a=function(e){var t,n={type_true:2,type_move:1,type_false:0,type_undefined:-1},o=!0;return O(e,(function(e){var i=e.dataZoomModel,r=!i.get("disabled",!0)&&(!i.get("zoomLock",!0)||"move");n["type_"+t]<n["type_"+r]&&(t=r),o&=i.get("preventDefaultMouseMove",!0)})),{controlType:t,opt:{zoomOnMouseWheel:!0,moveOnMouseMove:!0,moveOnMouseWheel:!0,preventDefaultMouseMove:!!o}}}(r.dataZoomInfos);r.controller.enable(a.controlType,a.opt),r.controller.setPointerChecker(t.containsPoint),hd(r,"dispatchAction",t.dataZoomModel.get("throttle",!0),"fixRate")}function bR(e){return e.type+"\0_"+e.id}function CR(e){var t=e.getZr();return t[vR]||(t[vR]={})}function TR(e){O(e,(function(t,n){t.count||(t.controller.dispose(),delete e[n])}))}function xR(e,t){e.dispatchAction({type:"dataZoom",batch:t})}var ER=A,_R=vO.extend({type:"dataZoom.inside",init:function(e,t){},render:function(e,t,n,o){_R.superApply(this,"render",arguments),this._range=e.getPercentRange(),O(this.getTargetCoordInfo(),(function(t,o){var i=w(t,(function(e){return bR(e.model)}));O(t,(function(t){var r=t.model,a={};O(["pan","zoom","scrollMove"],(function(e){a[e]=ER(IR[e],this,t,o)}),this),yR(n,{coordId:bR(r),allCoordIds:i,containsPoint:function(e,t,n){return r.coordinateSystem.containPoint([t,n])},dataZoomId:e.id,dataZoomModel:e,getRange:a})}),this)}),this)},dispose:function(){!function(e,t){var n=CR(e);O(n,(function(e){e.controller.dispose();var n=e.dataZoomInfos;n[t]&&(delete n[t],e.count--)})),TR(n)}(this.api,this.dataZoomModel.id),_R.superApply(this,"dispose",arguments),this._range=null}}),IR={zoom:function(e,t,n,o){var i=this._range,r=i.slice(),a=e.axisModels[0];if(a){var s=wR[t](null,[o.originX,o.originY],a,n,e),l=(0<s.signal?s.pixelStart+s.pixelLength-s.pixel:s.pixel-s.pixelStart)/s.pixelLength*(r[1]-r[0])+r[0],u=Math.max(1/o.scale,0);r[0]=(r[0]-l)*u+l,r[1]=(r[1]-l)*u+l;var c=this.dataZoomModel.findRepresentativeAxisProxy().getMinMaxSpan();return ET(0,r,[0,100],0,c.minSpan,c.maxSpan),this._range=r,i[0]!==r[0]||i[1]!==r[1]?r:void 0}},pan:DR((function(e,t,n,o,i,r){var a=wR[o]([r.oldX,r.oldY],[r.newX,r.newY],t,i,n);return a.signal*(e[1]-e[0])*a.pixel/a.pixelLength})),scrollMove:DR((function(e,t,n,o,i,r){return wR[o]([0,0],[r.scrollDelta,r.scrollDelta],t,i,n).signal*(e[1]-e[0])*r.scrollDelta}))};function DR(e){return function(t,n,o,i){var r=this._range,a=r.slice(),s=t.axisModels[0];if(s)return ET(e(a,s,t,n,o,i),a,[0,100],"all"),this._range=a,r[0]!==a[0]||r[1]!==a[1]?a:void 0}}function OR(e){var t=e&&e.visualMap;M(t)||(t=t?[t]:[]),RR(t,(function(e){if(e){SR(e,"splitList")&&!SR(e,"pieces")&&(e.pieces=e.splitList,delete e.splitList);var t=e.pieces;t&&M(t)&&RR(t,(function(e){L(e)&&(SR(e,"start")&&!SR(e,"min")&&(e.min=e.start),SR(e,"end")&&!SR(e,"max")&&(e.max=e.end))}))}}))}var wR={grid:function(e,t,n,o,i){var r=n.axis,a={},s=i.model.coordinateSystem.getRect();return e=e||[0,0],"x"===r.dim?(a.pixel=t[0]-e[0],a.pixelLength=s.width,a.pixelStart=s.x,a.signal=r.inverse?1:-1):(a.pixel=t[1]-e[1],a.pixelLength=s.height,a.pixelStart=s.y,a.signal=r.inverse?-1:1),a},polar:function(e,t,n,o,i){var r=n.axis,a={},s=i.model.coordinateSystem,l=s.getRadiusAxis().getExtent(),u=s.getAngleAxis().getExtent();return e=e?s.pointToCoord(e):[0,0],t=s.pointToCoord(t),"radiusAxis"===n.mainType?(a.pixel=t[0]-e[0],a.pixelLength=l[1]-l[0],a.pixelStart=l[0],a.signal=r.inverse?1:-1):(a.pixel=t[1]-e[1],a.pixelLength=u[1]-u[0],a.pixelStart=u[0],a.signal=r.inverse?-1:1),a},singleAxis:function(e,t,n,o,i){var r=n.axis,a=i.model.coordinateSystem.getRect(),s={};return e=e||[0,0],"horizontal"===r.orient?(s.pixel=t[0]-e[0],s.pixelLength=a.width,s.pixelStart=a.x,s.signal=r.inverse?1:-1):(s.pixel=t[1]-e[1],s.pixelLength=a.height,s.pixelStart=a.y,s.signal=r.inverse?-1:1),s}},RR=O;function SR(e,t){return e&&e.hasOwnProperty&&e.hasOwnProperty(t)}mu.registerSubTypeDefaulter("visualMap",(function(e){return e.categories||(e.pieces?0<e.pieces.length:0<e.splitNumber)&&!e.calculable?"piecewise":"continuous"}));var kR=ff.VISUAL.COMPONENT;function AR(e,t,n,o){for(var i=t.targetVisuals[o],r=Lb.prepareVisualTypes(i),a={color:e.getData().getVisual("color")},s=0,l=r.length;s<l;s++){var u=r[s],c=i["opacity"===u?"__alphaForOpacity":u];c&&c.applyVisual(n,d,f)}return a.color;function d(e){return a[e]}function f(e,t){a[e]=t}}ih(kR,{createOnAllSeries:!0,reset:function(e,t){var n=[];return t.eachComponent("visualMap",(function(t){var o=e.pipelineContext;!t.isTargetSeries(e)||o&&o.large||n.push(function(e,t,n,o){var i={};return O(e,(function(e){var n=Lb.prepareVisualTypes(t[e]);i[e]=n})),{progress:function(e,r){function a(e){return r.getItemVisual(l,e)}function s(e,t){r.setItemVisual(l,e,t)}var l;for(null!=o&&(o=r.getDimension(o));null!=(l=e.next());){var u=r.getRawDataItem(l);if(!u||!1!==u.visualMap)for(var c=null!=o?r.get(o,l,!0):l,d=n(c),f=t[d],h=i[d],g=0,m=h.length;g<m;g++){var p=h[g];f[p]&&f[p].applyVisual(c,a,s)}}}}}(t.stateList,t.targetVisuals,A(t.getValueState,t),t.getDataDimension(e.getData())))})),n}}),ih(kR,{createOnAllSeries:!0,reset:function(e,t){var n=e.getData(),o=[];t.eachComponent("visualMap",(function(t){if(t.isTargetSeries(e)){var i=t.getVisualMeta(A(AR,null,e,t))||{stops:[],outerColors:[]},r=t.getDataDimension(n),a=n.getDimensionInfo(r);null!=a&&(i.dimension=a.index,o.push(i))}})),e.getData().setVisual("visualMeta",o)}});var NR=function(e,t,n){var o=p((MR[e]||{})[t]);return n&&M(o)?o[o.length-1]:o},MR={color:{active:["#006edd","#e0ffff"],inactive:["rgba(0,0,0,0)"]},colorHue:{active:[0,360],inactive:[0,0]},colorSaturation:{active:[.3,1],inactive:[0,0]},colorLightness:{active:[.9,.5],inactive:[0,0]},colorAlpha:{active:[.3,1],inactive:[0,0]},opacity:{active:[.3,1],inactive:[0,0]},symbol:{active:["circle","roundRect","diamond"],inactive:["none"]},symbolSize:{active:[10,50],inactive:[0,0]}},KR=Lb.mapVisual,PR=Lb.eachVisual,LR=M,BR=O,FR=xl,zR=bl,VR=sh({type:"visualMap",dependencies:["series"],stateList:["inRange","outOfRange"],replacableOptionKeys:["inRange","outOfRange","target","controller","color"],dataBound:[-1/0,1/0],layoutMode:{type:"box",ignoreSize:!0},defaultOption:{show:!0,zlevel:0,z:4,seriesIndex:"all",min:0,max:200,dimension:null,inRange:null,outOfRange:null,left:0,right:null,top:null,bottom:0,itemWidth:null,itemHeight:null,inverse:!1,orient:"vertical",backgroundColor:"rgba(0,0,0,0)",borderColor:"#ccc",contentColor:"#5793f3",inactiveColor:"#aaa",borderWidth:0,padding:5,textGap:10,precision:0,color:null,formatter:null,text:null,textStyle:{color:"#333"}},init:function(e,t,n){this.targetVisuals={},this.controllerVisuals={},this.mergeDefaultAndTheme(e,n)},optionUpdated:function(e,t){var n=this.option;i.canvasSupported||(n.realtime=!1),t||HO(n,e,this.replacableOptionKeys),this.textStyleModel=this.getModel("textStyle"),this.resetItemSize(),this.completeVisualOption()},resetVisual:function(e){var t=this.stateList;e=A(e,this),this.controllerVisuals=VO(this.option.controller,t,e),this.targetVisuals=VO(this.option.target,t,e)},getTargetSeriesIndices:function(){var e=this.option.seriesIndex,t=[];return null==e||"all"===e?this.ecModel.eachSeries((function(e,n){t.push(n)})):t=Oi(e),t},eachTargetSeries:function(e,t){O(this.getTargetSeriesIndices(),(function(n){e.call(t,this.ecModel.getSeriesByIndex(n))}),this)},isTargetSeries:function(e){var t=!1;return this.eachTargetSeries((function(n){n===e&&(t=!0)})),t},formatValueText:function(e,t,n){var o,i,r=this.option,a=r.precision,s=this.dataBound,l=r.formatter;return n=n||["<",">"],M(e)&&(e=e.slice(),o=!0),i=t?e:o?[u(e[0]),u(e[1])]:u(e),P(l)?l.replace("{value}",o?i[0]:i).replace("{value2}",o?i[1]:i):K(l)?o?l(e[0],e[1]):l(e):o?e[0]===s[0]?n[0]+" "+i[1]:e[1]===s[1]?n[1]+" "+i[0]:i[0]+" - "+i[1]:i;function u(e){return e===s[0]?"min":e===s[1]?"max":(+e).toFixed(Math.min(a,20))}},resetExtent:function(){var e=this.option,t=FR([e.min,e.max]);this._dataExtent=t},getDataDimension:function(e){var t=this.option.dimension;if(null!=t||e.dimensions.length){if(null!=t)return e.getDimension(t);for(var n=e.dimensions,o=n.length-1;0<=o;o--){var i=n[o];if(!e.getDimensionInfo(i).isCalculationCoord)return i}}},getExtent:function(){return this._dataExtent.slice()},completeVisualOption:function(){var e=this.ecModel,t=this.option,n={inRange:t.inRange,outOfRange:t.outOfRange},o=t.target||(t.target={}),i=t.controller||(t.controller={});v(o,n),v(i,n);var r=this.isCategory();function a(n){LR(t.color)&&!n.inRange&&(n.inRange={color:t.color.slice().reverse()}),n.inRange=n.inRange||{color:e.get("gradientColor")},BR(this.stateList,(function(e){var t=n[e];if(P(t)){var o=NR(t,"active",r);o?(n[e]={},n[e][t]=o):delete n[e]}}),this)}a.call(this,o),a.call(this,i),(function(e,t,n){var o=e[t],i=e[n];o&&!i&&(i=e[n]={},BR(o,(function(e,t){if(Lb.isValidType(t)){var n=NR(t,"inactive",r);null!=n&&(i[t]=n,"color"!==t||i.hasOwnProperty("opacity")||i.hasOwnProperty("colorAlpha")||(i.opacity=[0,0]))}})))}).call(this,o,"inRange","outOfRange"),(function(e){var t=(e.inRange||{}).symbol||(e.outOfRange||{}).symbol,n=(e.inRange||{}).symbolSize||(e.outOfRange||{}).symbolSize,o=this.get("inactiveColor");BR(this.stateList,(function(i){var a=this.itemSize,s=e[i];null==(s=s||(e[i]={color:r?o:[o]})).symbol&&(s.symbol=t&&p(t)||(r?"roundRect":["roundRect"])),null==s.symbolSize&&(s.symbolSize=n&&p(n)||(r?a[0]:[a[0],a[0]])),s.symbol=KR(s.symbol,(function(e){return"none"===e||"square"===e?"roundRect":e}));var l=s.symbolSize;if(null!=l){var u=-1/0;PR(l,(function(e){u<e&&(u=e)})),s.symbolSize=KR(l,(function(e){return zR(e,[0,u],[0,a[0]],!0)}))}}),this)}).call(this,i)},resetItemSize:function(){this.itemSize=[parseFloat(this.get("itemWidth")),parseFloat(this.get("itemHeight"))]},isCategory:function(){return!!this.option.categories},setSelected:te,getValueState:te,getVisualMeta:te}),HR=[20,140],WR=VR.extend({type:"visualMap.continuous",defaultOption:{align:"auto",calculable:!1,range:null,realtime:!0,itemHeight:null,itemWidth:null,hoverLink:!0,hoverLinkDataSize:null,hoverLinkOnHandle:null},optionUpdated:function(e,t){WR.superApply(this,"optionUpdated",arguments),this.resetExtent(),this.resetVisual((function(e){e.mappingMethod="linear",e.dataExtent=this.getExtent()})),this._resetRange()},resetItemSize:function(){WR.superApply(this,"resetItemSize",arguments);var e=this.itemSize;"horizontal"===this._orient&&e.reverse(),null!=e[0]&&!isNaN(e[0])||(e[0]=HR[0]),null!=e[1]&&!isNaN(e[1])||(e[1]=HR[1])},_resetRange:function(){var e=this.getExtent(),t=this.option.range;!t||t.auto?(e.auto=1,this.option.range=e):M(t)&&(t[0]>t[1]&&t.reverse(),t[0]=Math.max(t[0],e[0]),t[1]=Math.min(t[1],e[1]))},completeVisualOption:function(){VR.prototype.completeVisualOption.apply(this,arguments),O(this.stateList,(function(e){var t=this.option.controller[e].symbolSize;t&&t[0]!==t[1]&&(t[0]=0)}),this)},setSelected:function(e){this.option.range=e.slice(),this._resetRange()},getSelected:function(){var e=this.getExtent(),t=xl((this.get("range")||[]).slice());return t[0]>e[1]&&(t[0]=e[1]),t[1]>e[1]&&(t[1]=e[1]),t[0]<e[0]&&(t[0]=e[0]),t[1]<e[0]&&(t[1]=e[0]),t},getValueState:function(e){var t=this.option.range,n=this.getExtent();return(t[0]<=n[0]||t[0]<=e)&&(t[1]>=n[1]||e<=t[1])?"inRange":"outOfRange"},findTargetDataIndices:function(e){var t=[];return this.eachTargetSeries((function(n){var o=[],i=n.getData();i.each(this.getDataDimension(i),(function(t,n){e[0]<=t&&t<=e[1]&&o.push(n)}),this),t.push({seriesId:n.id,dataIndex:o})}),this),t},getVisualMeta:function(e){var t=$R(0,0,this.getExtent()),n=$R(0,0,this.option.range.slice()),o=[];function i(t,n){o.push({value:t,color:e(t,n)})}for(var r=0,a=0,s=n.length,l=t.length;a<l&&(!n.length||t[a]<=n[0]);a++)t[a]<n[r]&&i(t[a],"outOfRange");for(var u=1;r<s;r++,u=0)u&&o.length&&i(n[r],"outOfRange"),i(n[r],"inRange");for(u=1;a<l;a++)(!n.length||n[n.length-1]<t[a])&&(u&&(o.length&&i(o[o.length-1].value,"outOfRange"),u=0),i(t[a],"outOfRange"));var c=o.length;return{stops:o,outerColors:[c?o[0].color:"transparent",c?o[c-1].color:"transparent"]}}});function $R(e,t,n){if(n[0]===n[1])return n.slice();for(var o=(n[1]-n[0])/200,i=n[0],r=[],a=0;a<=200&&i<n[1];a++)r.push(i),i+=o;return r.push(n[1]),r}var UR=lh({type:"visualMap",autoPositionValues:{left:1,right:1,top:1,bottom:1},init:function(e,t){this.ecModel=e,this.api=t},render:function(e,t,n,o){!1!==(this.visualMapModel=e).get("show")?this.doRender.apply(this,arguments):this.group.removeAll()},renderBackground:function(e){var t=this.visualMapModel,n=zl(t.get("padding")||0),o=e.getBoundingRect();e.add(new Ua({z2:-1,silent:!0,shape:{x:o.x-n[3],y:o.y-n[0],width:o.width+n[3]+n[1],height:o.height+n[0]+n[2]},style:{fill:t.get("backgroundColor"),stroke:t.get("borderColor"),lineWidth:t.get("borderWidth")}}))},getControllerVisual:function(e,t,n){var o=(n=n||{}).forceState,i=this.visualMapModel,r={};if("symbol"===t&&(r.symbol=i.get("itemSymbol")),"color"===t){var a=i.get("contentColor");r.color=a}function s(e){return r[e]}function l(e,t){r[e]=t}var u=i.controllerVisuals[o||i.getValueState(e)];return O(Lb.prepareVisualTypes(u),(function(o){var i=u[o];n.convertOpacityToAlpha&&"opacity"===o&&(o="colorAlpha",i=u.__alphaForOpacity),Lb.dependsOn(o,t)&&i&&i.applyVisual(e,s,l)})),r[t]},positionGroup:function(e){var t=this.api;su(e,this.visualMapModel.getBoxLayoutParams(),{width:t.getWidth(),height:t.getHeight()})},doRender:te});function qR(e,t,n){var o=e.option,i=o.align;if(null!=i&&"auto"!==i)return i;for(var r={width:t.getWidth(),height:t.getHeight()},a="horizontal"===o.orient?1:0,s=[["left","right","width"],["top","bottom","height"]],l=s[a],u=[0,null,10],c={},d=0;d<3;d++)c[s[1-a][d]]=u[d],c[l[d]]=2===d?n[0]:o[l[d]];var f=[["x","width",3],["y","height",0]][a],h=au(c,r,o.padding);return l[(h.margin[f[2]]||0)+h[f[0]]+.5*h[f[1]]<.5*r[f[1]]?0:1]}function jR(e,t){return O(e||[],(function(e){null!=e.dataIndex&&(e.dataIndexInside=e.dataIndex,e.dataIndex=null),e.highlightKey="visualMap"+(t?t.componentIndex:"")})),e}var GR=bl,XR=O,YR=Math.min,ZR=Math.max,JR=UR.extend({type:"visualMap.continuous",init:function(){JR.superApply(this,"init",arguments),this._shapes={},this._dataInterval=[],this._handleEnds=[],this._hoverLinkDataIndices=[]},doRender:function(e,t,n,o){o&&"selectDataRange"===o.type&&o.from===this.uid||this._buildView()},_buildView:function(){this.group.removeAll();var e=this.visualMapModel,t=this.group;this._orient=e.get("orient"),this._useHandle=e.get("calculable"),this._resetInterval(),this._renderBar(t);var n=e.get("text");this._renderEndsText(t,n,0),this._renderEndsText(t,n,1),this._updateView(!0),this.renderBackground(t),this._updateView(),this._enableHoverLinkToSeries(),this._enableHoverLinkFromSeries(),this.positionGroup(t)},_renderEndsText:function(e,t,n){if(t){var o=t[1-n];o=null!=o?o+"":"";var i=this.visualMapModel,r=i.get("textGap"),a=i.itemSize,s=this._shapes.barGroup,l=this._applyTransform([a[0]/2,0===n?-r:a[1]+r],s),u=this._applyTransform(0===n?"bottom":"top",s),c=this._orient,d=this.visualMapModel.textStyleModel;this.group.add(new Sa({style:{x:l[0],y:l[1],textVerticalAlign:"horizontal"===c?"middle":u,textAlign:"horizontal"===c?u:"center",text:o,textFont:d.getFont(),textFill:d.getTextColor()}}))}},_renderBar:function(e){var t=this.visualMapModel,n=this._shapes,o=t.itemSize,i=this._orient,r=this._useHandle,a=qR(t,this.api,o),s=n.barGroup=this._createBarGroup(a);s.add(n.outOfRange=QR()),s.add(n.inRange=QR(null,r?tS(this._orient):null,A(this._dragHandle,this,"all",!1),A(this._dragHandle,this,"all",!0)));var l=t.textStyleModel.getTextRect("国"),u=ZR(l.width,l.height);r&&(n.handleThumbs=[],n.handleLabels=[],n.handleLabelPoints=[],this._createHandle(s,0,o,u,i,a),this._createHandle(s,1,o,u,i,a)),this._createIndicator(s,o,u,i),e.add(s)},_createHandle:function(e,t,n,o,i){var r=A(this._dragHandle,this,t,!1),a=A(this._dragHandle,this,t,!0),s=QR(function(e,t){return 0===e?[[0,0],[t,0],[t,-t]]:[[0,0],[t,0],[t,t]]}(t,o),tS(this._orient),r,a);s.position[0]=n[0],e.add(s);var l=this.visualMapModel.textStyleModel,u=new Sa({draggable:!0,drift:r,onmousemove:function(e){$e(e.event)},ondragend:a,style:{x:0,y:0,text:"",textFont:l.getFont(),textFill:l.getTextColor()}});this.group.add(u);var c=["horizontal"===i?o/2:1.5*o,"horizontal"===i?0===t?-1.5*o:1.5*o:0===t?-o/2:o/2],d=this._shapes;d.handleThumbs[t]=s,d.handleLabelPoints[t]=c,d.handleLabels[t]=u},_createIndicator:function(e,t,n,o){var i=QR([[0,0]],"move");i.position[0]=t[0],i.attr({invisible:!0,silent:!0}),e.add(i);var r=this.visualMapModel.textStyleModel,a=new Sa({silent:!0,invisible:!0,style:{x:0,y:0,text:"",textFont:r.getFont(),textFill:r.getTextColor()}});this.group.add(a);var s=["horizontal"===o?n/2:9,0],l=this._shapes;l.indicator=i,l.indicatorLabel=a,l.indicatorLabelPoint=s},_dragHandle:function(e,t,n,o){if(this._useHandle){if(this._dragging=!t,!t){var i=this._applyTransform([n,o],this._shapes.barGroup,!0);this._updateInterval(e,i[1]),this._updateView()}t===!this.visualMapModel.get("realtime")&&this.api.dispatchAction({type:"selectDataRange",from:this.uid,visualMapId:this.visualMapModel.id,selected:this._dataInterval.slice()}),t?this._hovering||this._clearHoverLinkToSeries():eS(this.visualMapModel)&&this._doHoverLinkToSeries(this._handleEnds[e],!1)}},_resetInterval:function(){var e=this.visualMapModel,t=this._dataInterval=e.getSelected(),n=e.getExtent(),o=[0,e.itemSize[1]];this._handleEnds=[GR(t[0],n,o,!0),GR(t[1],n,o,!0)]},_updateInterval:function(e,t){var n=this.visualMapModel,o=this._handleEnds,i=[0,n.itemSize[1]];ET(t=t||0,o,i,e,0);var r=n.getExtent();this._dataInterval=[GR(o[0],i,r,!0),GR(o[1],i,r,!0)]},_updateView:function(e){var t=this.visualMapModel,n=t.getExtent(),o=this._shapes,i=[0,t.itemSize[1]],r=e?i:this._handleEnds,a=this._createBarVisual(this._dataInterval,n,r,"inRange"),s=this._createBarVisual(n,n,i,"outOfRange");o.inRange.setStyle({fill:a.barColor,opacity:a.opacity}).setShape("points",a.barPoints),o.outOfRange.setStyle({fill:s.barColor,opacity:s.opacity}).setShape("points",s.barPoints),this._updateHandle(r,a)},_createBarVisual:function(e,t,n,o){var i={forceState:o,convertOpacityToAlpha:!0},r=this._makeColorGradient(e,i),a=[this.getControllerVisual(e[0],"symbolSize",i),this.getControllerVisual(e[1],"symbolSize",i)],s=this._createBarPoints(n,a);return{barColor:new es(0,0,0,1,r),barPoints:s,handlesColor:[r[0].color,r[r.length-1].color]}},_makeColorGradient:function(e,t){var n=[],o=(e[1]-e[0])/100;n.push({color:this.getControllerVisual(e[0],"color",t),offset:0});for(var i=1;i<100;i++){var r=e[0]+o*i;if(r>e[1])break;n.push({color:this.getControllerVisual(r,"color",t),offset:i/100})}return n.push({color:this.getControllerVisual(e[1],"color",t),offset:1}),n},_createBarPoints:function(e,t){var n=this.visualMapModel.itemSize;return[[n[0]-t[0],e[0]],[n[0],e[0]],[n[0],e[1]],[n[0]-t[1],e[1]]]},_createBarGroup:function(e){var t=this._orient,n=this.visualMapModel.get("inverse");return new _n("horizontal"!==t||n?"horizontal"===t&&n?{scale:"bottom"===e?[-1,1]:[1,1],rotation:-Math.PI/2}:"vertical"!==t||n?{scale:"left"===e?[1,1]:[-1,1]}:{scale:"left"===e?[1,-1]:[-1,-1]}:{scale:"bottom"===e?[1,1]:[-1,1],rotation:Math.PI/2})},_updateHandle:function(e,t){if(this._useHandle){var n=this._shapes,o=this.visualMapModel,i=n.handleThumbs,r=n.handleLabels;XR([0,1],(function(a){var s=i[a];s.setStyle("fill",t.handlesColor[a]),s.position[1]=e[a];var l=Js(n.handleLabelPoints[a],Zs(s,this.group));r[a].setStyle({x:l[0],y:l[1],text:o.formatValueText(this._dataInterval[a]),textVerticalAlign:"middle",textAlign:this._applyTransform("horizontal"===this._orient?0===a?"bottom":"top":"left",n.barGroup)})}),this)}},_showIndicator:function(e,t,n,o){var i=this.visualMapModel,r=i.getExtent(),a=i.itemSize,s=GR(e,r,[0,a[1]],!0),l=this._shapes,u=l.indicator;if(u){u.position[1]=s,u.attr("invisible",!1),u.setShape("points",function(e,t,n,o){return e?[[0,-YR(t,ZR(n,0))],[6,0],[0,YR(t,ZR(o-n,0))]]:[[0,0],[5,-5],[5,5]]}(!!n,o,s,a[1]));var c=this.getControllerVisual(e,"color",{convertOpacityToAlpha:!0});u.setStyle("fill",c);var d=Js(l.indicatorLabelPoint,Zs(u,this.group)),f=l.indicatorLabel;f.attr("invisible",!1);var h=this._applyTransform("left",l.barGroup),g=this._orient;f.setStyle({text:(n||"")+i.formatValueText(t),textVerticalAlign:"horizontal"===g?h:"middle",textAlign:"horizontal"===g?"center":h,x:d[0],y:d[1]})}},_enableHoverLinkToSeries:function(){var e=this;this._shapes.barGroup.on("mousemove",(function(t){if(e._hovering=!0,!e._dragging){var n=e.visualMapModel.itemSize,o=e._applyTransform([t.offsetX,t.offsetY],e._shapes.barGroup,!0,!0);o[1]=YR(ZR(0,o[1]),n[1]),e._doHoverLinkToSeries(o[1],0<=o[0]&&o[0]<=n[0])}})).on("mouseout",(function(){e._hovering=!1,e._dragging||e._clearHoverLinkToSeries()}))},_enableHoverLinkFromSeries:function(){var e=this.api.getZr();this.visualMapModel.option.hoverLink?(e.on("mouseover",this._hoverLinkFromSeriesMouseOver,this),e.on("mouseout",this._hideIndicator,this)):this._clearHoverLinkFromSeries()},_doHoverLinkToSeries:function(e,t){var n=this.visualMapModel;if(n.option.hoverLink){var o=[0,n.itemSize[1]],i=n.getExtent();e=YR(ZR(o[0],e),o[1]);var r=function(e,t,n){var o=6,i=e.get("hoverLinkDataSize");return i&&(o=GR(i,t,n,!0)/2),o}(n,i,o),a=[e-r,e+r],s=GR(e,o,i,!0),l=[GR(a[0],o,i,!0),GR(a[1],o,i,!0)];a[0]<o[0]&&(l[0]=-1/0),o[1]<a[1]&&(l[1]=1/0),t&&(l[0]===-1/0?this._showIndicator(s,l[1],"< ",r):l[1]===1/0?this._showIndicator(s,l[0],"> ",r):this._showIndicator(s,s,"≈ ",r));var u=this._hoverLinkDataIndices,c=[];(t||eS(n))&&(c=this._hoverLinkDataIndices=n.findTargetDataIndices(l));var d=function(e,t){var n={},o={};return i(e||[],n),i(t||[],o,n),[r(n),r(o)];function i(e,t,n){for(var o=0,i=e.length;o<i;o++)for(var r=e[o].seriesId,a=Oi(e[o].dataIndex),s=n&&n[r],l=0,u=a.length;l<u;l++){var c=a[l];s&&s[c]?s[c]=null:(t[r]||(t[r]={}))[c]=1}}function r(e,t){var n=[];for(var o in e)if(e.hasOwnProperty(o)&&null!=e[o])if(t)n.push(+o);else{var i=r(e[o],!0);i.length&&n.push({seriesId:o,dataIndex:i})}return n}}(u,c);this._dispatchHighDown("downplay",jR(d[0],n)),this._dispatchHighDown("highlight",jR(d[1],n))}},_hoverLinkFromSeriesMouseOver:function(e){var t=e.target,n=this.visualMapModel;if(t&&null!=t.dataIndex){var o=this.ecModel.getSeriesByIndex(t.seriesIndex);if(n.isTargetSeries(o)){var i=o.getData(t.dataType),r=i.get(n.getDataDimension(i),t.dataIndex,!0);isNaN(r)||this._showIndicator(r,r)}}},_hideIndicator:function(){var e=this._shapes;e.indicator&&e.indicator.attr("invisible",!0),e.indicatorLabel&&e.indicatorLabel.attr("invisible",!0)},_clearHoverLinkToSeries:function(){this._hideIndicator();var e=this._hoverLinkDataIndices;this._dispatchHighDown("downplay",jR(e,this.visualMapModel)),e.length=0},_clearHoverLinkFromSeries:function(){this._hideIndicator();var e=this.api.getZr();e.off("mouseover",this._hoverLinkFromSeriesMouseOver),e.off("mouseout",this._hideIndicator)},_applyTransform:function(e,t,n,o){var i=Zs(t,o?null:this.group);return al[M(e)?"applyTransform":"transformDirection"](e,i,n)},_dispatchHighDown:function(e,t){t&&t.length&&this.api.dispatchAction({type:e,batch:t})},dispose:function(){this._clearHoverLinkFromSeries(),this._clearHoverLinkToSeries()},remove:function(){this._clearHoverLinkFromSeries(),this._clearHoverLinkToSeries()}});function QR(e,t,n,o){return new Ba({shape:{points:e},draggable:!!n,cursor:t,drift:n,onmousemove:function(e){$e(e.event)},ondragend:o})}function eS(e){var t=e.get("hoverLinkOnHandle");return!!(null==t?e.get("realtime"):t)}function tS(e){return"vertical"===e?"ns-resize":"ew-resize"}th({type:"selectDataRange",event:"dataRangeSelected",update:"update"},(function(e,t){t.eachComponent({mainType:"visualMap",query:e},(function(t){t.setSelected(e.selected)}))})),Qf(OR);var nS=VR.extend({type:"visualMap.piecewise",defaultOption:{selected:null,minOpen:!1,maxOpen:!1,align:"auto",itemWidth:20,itemHeight:14,itemSymbol:"roundRect",pieceList:null,categories:null,splitNumber:5,selectedMode:"multiple",itemGap:10,hoverLink:!0,showLabel:null},optionUpdated:function(e,t){nS.superApply(this,"optionUpdated",arguments),this._pieceList=[],this.resetExtent();var n=this._mode=this._determineMode();oS[this._mode].call(this),this._resetSelected(e,t);var o=this.option.categories;this.resetVisual((function(e,t){"categories"===n?(e.mappingMethod="category",e.categories=p(o)):(e.dataExtent=this.getExtent(),e.mappingMethod="piecewise",e.pieceList=w(this._pieceList,(function(e){return e=p(e),"inRange"!==t&&(e.visual=null),e})))}))},completeVisualOption:function(){var e=this.option,t={},n=Lb.listVisualTypes(),o=this.isCategory();function i(e,t,n){return e&&e[t]&&(L(e[t])?e[t].hasOwnProperty(n):e[t]===n)}O(e.pieces,(function(e){O(n,(function(n){e.hasOwnProperty(n)&&(t[n]=1)}))})),O(t,(function(t,n){var r=0;O(this.stateList,(function(t){r|=i(e,t,n)||i(e.target,t,n)}),this),r||O(this.stateList,(function(t){(e[t]||(e[t]={}))[n]=NR(n,"inRange"===t?"active":"inactive",o)}))}),this),VR.prototype.completeVisualOption.apply(this,arguments)},_resetSelected:function(e,t){var n=this.option,o=this._pieceList,i=(t?n:e).selected||{};if(n.selected=i,O(o,(function(e,t){var n=this.getSelectedMapKey(e);i.hasOwnProperty(n)||(i[n]=!0)}),this),"single"===n.selectedMode){var r=!1;O(o,(function(e,t){var n=this.getSelectedMapKey(e);i[n]&&(r?i[n]=!1:r=!0)}),this)}},getSelectedMapKey:function(e){return"categories"===this._mode?e.value+"":e.index+""},getPieceList:function(){return this._pieceList},_determineMode:function(){var e=this.option;return e.pieces&&0<e.pieces.length?"pieces":this.option.categories?"categories":"splitNumber"},setSelected:function(e){this.option.selected=p(e)},getValueState:function(e){var t=Lb.findPieceIndex(e,this._pieceList);return null!=t&&this.option.selected[this.getSelectedMapKey(this._pieceList[t])]?"inRange":"outOfRange"},findTargetDataIndices:function(e){var t=[];return this.eachTargetSeries((function(n){var o=[],i=n.getData();i.each(this.getDataDimension(i),(function(t,n){Lb.findPieceIndex(t,this._pieceList)===e&&o.push(n)}),this),t.push({seriesId:n.id,dataIndex:o})}),this),t},getRepresentValue:function(e){var t;if(this.isCategory())t=e.value;else if(null!=e.value)t=e.value;else{var n=e.interval||[];t=n[0]===-1/0&&n[1]===1/0?0:(n[0]+n[1])/2}return t},getVisualMeta:function(e){if(!this.isCategory()){var t=[],n=[],o=this,i=this._pieceList.slice();if(i.length){var r=i[0].interval[0];r!==-1/0&&i.unshift({interval:[-1/0,r]}),(r=i[i.length-1].interval[1])!==1/0&&i.push({interval:[r,1/0]})}else i.push({interval:[-1/0,1/0]});var a=-1/0;return O(i,(function(e){var t=e.interval;t&&(t[0]>a&&s([a,t[0]],"outOfRange"),s(t.slice()),a=t[1])}),this),{stops:t,outerColors:n}}function s(i,r){var a=o.getRepresentValue({interval:i});r=r||o.getValueState(a);var s=e(a,r);i[0]===-1/0?n[0]=s:i[1]===1/0?n[1]=s:t.push({value:i[0],color:s},{value:i[1],color:s})}}}),oS={splitNumber:function(){var e=this.option,t=this._pieceList,n=Math.min(e.precision,20),o=this.getExtent(),i=e.splitNumber;i=Math.max(parseInt(i,10),1),e.splitNumber=i;for(var r=(o[1]-o[0])/i;+r.toFixed(n)!==r&&n<5;)n++;e.precision=n,r=+r.toFixed(n),e.minOpen&&t.push({interval:[-1/0,o[0]],close:[0,0]});for(var a=0,s=o[0];a<i;s+=r,a++)t.push({interval:[s,a===i-1?o[1]:s+r],close:[1,1]});e.maxOpen&&t.push({interval:[o[1],1/0],close:[0,0]}),Kl(t),O(t,(function(e,t){e.index=t,e.text=this.formatValueText(e.interval)}),this)},categories:function(){var e=this.option;O(e.categories,(function(e){this._pieceList.push({text:this.formatValueText(e,!0),value:e})}),this),iS(e,this._pieceList)},pieces:function(){var e=this.option,t=this._pieceList;O(e.pieces,(function(e,n){L(e)||(e={value:e});var o={text:"",index:n};if(null!=e.label&&(o.text=e.label),e.hasOwnProperty("value")){var i=o.value=e.value;o.interval=[i,i],o.close=[1,1]}else{for(var r=o.interval=[],a=o.close=[0,0],s=[1,0,1],l=[-1/0,1/0],u=[],c=0;c<2;c++){for(var d=[["gte","gt","min"],["lte","lt","max"]][c],f=0;f<3&&null==r[c];f++)r[c]=e[d[f]],a[c]=s[f],u[c]=2===f;null==r[c]&&(r[c]=l[c])}u[0]&&r[1]===1/0&&(a[0]=0),u[1]&&r[0]===-1/0&&(a[1]=0),r[0]===r[1]&&a[0]&&a[1]&&(o.value=r[0])}o.visual=Lb.retrieveVisuals(e),t.push(o)}),this),iS(e,t),Kl(t),O(t,(function(e){var t=e.close;e.text=e.text||this.formatValueText(null!=e.value?e.value:e.interval,!1,[["<","≤"][t[1]],[">","≥"][t[0]]])}),this)}};function iS(e,t){var n=e.inverse;("vertical"===e.orient?!n:n)&&t.reverse()}UR.extend({type:"visualMap.piecewise",doRender:function(){var e=this.group;e.removeAll();var t=this.visualMapModel,n=t.get("textGap"),o=t.textStyleModel,i=o.getFont(),r=o.getTextColor(),a=this._getItemAlign(),s=t.itemSize,l=this._getViewData(),u=l.endsText,c=H(t.get("showLabel",!0),!u);u&&this._renderEndsText(e,u[0],s,c,a),O(l.viewPieceList,(function(o){var l=o.piece,u=new _n;u.onclick=A(this._onItemClick,this,l),this._enableHoverLink(u,o.indexInModelPieceList);var d=t.getRepresentValue(l);if(this._createItemSymbol(u,d,[0,0,s[0],s[1]]),c){var f=this.visualMapModel.getValueState(d);u.add(new Sa({style:{x:"right"===a?-n:s[0]+n,y:s[1]/2,text:l.text,textVerticalAlign:"middle",textAlign:a,textFont:i,textFill:r,opacity:"outOfRange"===f?.5:1}}))}e.add(u)}),this),u&&this._renderEndsText(e,u[1],s,c,a),ru(t.get("orient"),e,t.get("itemGap")),this.renderBackground(e),this.positionGroup(e)},_enableHoverLink:function(e,t){function n(e){var n=this.visualMapModel;n.option.hoverLink&&this.api.dispatchAction({type:e,batch:jR(n.findTargetDataIndices(t),n)})}e.on("mouseover",A(n,this,"highlight")).on("mouseout",A(n,this,"downplay"))},_getItemAlign:function(){var e=this.visualMapModel,t=e.option;if("vertical"===t.orient)return qR(e,this.api,e.itemSize);var n=t.align;return n&&"auto"!==n||(n="left"),n},_renderEndsText:function(e,t,n,o,i){if(t){var r=new _n,a=this.visualMapModel.textStyleModel;r.add(new Sa({style:{x:o?"right"===i?n[0]:0:n[0]/2,y:n[1]/2,textVerticalAlign:"middle",textAlign:o?i:"center",text:t,textFont:a.getFont(),textFill:a.getTextColor()}})),e.add(r)}},_getViewData:function(){var e=this.visualMapModel,t=w(e.getPieceList(),(function(e,t){return{piece:e,indexInModelPieceList:t}})),n=e.get("text"),o=e.get("orient"),i=e.get("inverse");return("horizontal"===o?i:!i)?t.reverse():n=n&&n.slice().reverse(),{viewPieceList:t,endsText:n}},_createItemSymbol:function(e,t,n){e.add(tm(this.getControllerVisual(t,"symbol"),n[0],n[1],n[2],n[3],this.getControllerVisual(t,"color")))},_onItemClick:function(e){var t=this.visualMapModel,n=t.option,o=p(n.selected),i=t.getSelectedMapKey(e);"single"===n.selectedMode?(o[i]=!0,O(o,(function(e,t){o[t]=t===i}))):o[i]=!o[i],this.api.dispatchAction({type:"selectDataRange",from:this.uid,visualMapId:this.visualMapModel.id,selected:o})}}),Qf(OR);var rS,aS="urn:schemas-microsoft-com:vml",sS="undefined"==typeof window?null:window,lS=!1,uS=sS&&sS.document;function cS(e){return rS(e)}if(uS&&!i.canvasSupported)try{uS.namespaces.zrvml||uS.namespaces.add("zrvml",aS),rS=function(e){return uS.createElement("<zrvml:"+e+' class="zrvml">')}}catch(e){rS=function(e){return uS.createElement("<"+e+' xmlns="'+aS+'" class="zrvml">')}}var dS=jr.CMD,fS=Math.round,hS=Math.sqrt,gS=Math.abs,mS=Math.cos,pS=Math.sin,vS=Math.max;if(!i.canvasSupported){var yS=",",bS="progid:DXImageTransform.Microsoft",CS=21600,TS=CS/2,xS=function(e){e.style.cssText="position:absolute;left:0;top:0;width:1px;height:1px;",e.coordsize=CS+","+CS,e.coordorigin="0,0"},ES=function(e,t,n){return"rgb("+[e,t,n].join(",")+")"},_S=function(e,t){t&&e&&t.parentNode!==e&&e.appendChild(t)},IS=function(e,t){t&&e&&t.parentNode===e&&e.removeChild(t)},DS=function(e,t,n){return 1e5*(parseFloat(e)||0)+1e3*(parseFloat(t)||0)+n},OS=Lo,wS=function(e,t,n){var o=Ft(t);n=+n,isNaN(n)&&(n=1),o&&(e.color=ES(o[0],o[1],o[2]),e.opacity=n*o[3])},RS=function(e,t,n,o){var i="fill"===t,r=e.getElementsByTagName(t)[0];null!=n[t]&&"none"!==n[t]&&(i||!i&&n.lineWidth)?(e[i?"filled":"stroked"]="true",n[t]instanceof Ya&&IS(e,r),r=r||cS(t),i?function(e,t,n){var o,i=t.fill;if(null!=i)if(i instanceof Ya){var r,a=0,s=[0,0],l=0,u=1,c=n.getBoundingRect(),d=c.width,f=c.height;if("linear"===i.type){r="gradient";var h=n.transform,g=[i.x*d,i.y*f],m=[i.x2*d,i.y2*f];h&&(Ce(g,g,h),Ce(m,m,h)),(a=180*Math.atan2(m[0]-g[0],m[1]-g[1])/Math.PI)<0&&(a+=360),a<1e-6&&(a=0)}else{r="gradientradial";var p=n.scale,v=d,y=f;s=[((g=[i.x*d,i.y*f])[0]-c.x)/v,(g[1]-c.y)/y],(h=n.transform)&&Ce(g,g,h);var b=vS(v/=p[0]*CS,y/=p[1]*CS);u=2*i.r/b-(l=0/b)}var C=i.colorStops.slice();C.sort((function(e,t){return e.offset-t.offset}));for(var T=C.length,x=[],E=[],_=0;_<T;_++){var I=C[_],D=(o=Ft(I.color),[ES(o[0],o[1],o[2]),o[3]]);E.push(I.offset*u+l+" "+D[0]),0!==_&&_!==T-1||x.push(D)}if(2<=T){var O=x[0][0],w=x[1][0],R=x[0][1]*t.opacity,S=x[1][1]*t.opacity;e.type=r,e.method="none",e.focus="100%",e.angle=a,e.color=O,e.color2=w,e.colors=E.join(","),e.opacity=S,e.opacity2=R}"radial"===r&&(e.focusposition=s.join(","))}else wS(e,i,t.opacity)}(r,n,o):function(e,t){t.lineDash&&(e.dashstyle=t.lineDash.join(" ")),null==t.stroke||t.stroke instanceof Ya||wS(e,t.stroke,t.opacity)}(r,n),_S(e,r)):(e[i?"filled":"stroked"]="false",IS(e,r))},SS=[[],[],[]];ha.prototype.brushVML=function(e){var t=this.style,n=this._vmlEl;n||(n=cS("shape"),xS(n),this._vmlEl=n),RS(n,"fill",t,this),RS(n,"stroke",t,this);var o=this.transform,i=null!=o,r=n.getElementsByTagName("stroke")[0];if(r){var a=t.lineWidth;i&&!t.strokeNoScale&&(a*=hS(gS(o[0]*o[3]-o[1]*o[2]))),r.weight=a+"px"}var s=this.path||(this.path=new jr);this.__dirtyPath&&(s.beginPath(),s.subPixelOptimize=!1,this.buildPath(s,this.shape),s.toStatic(),this.__dirtyPath=!1),n.path=function(e,t){var n,o,i,r,a,s,l=dS.M,u=dS.C,c=dS.L,d=dS.A,f=dS.Q,h=[],g=e.data,m=e.len();for(r=0;r<m;){switch(o="",n=0,i=g[r++]){case l:o=" m ",n=1,a=g[r++],s=g[r++],SS[0][0]=a,SS[0][1]=s;break;case c:o=" l ",n=1,a=g[r++],s=g[r++],SS[0][0]=a,SS[0][1]=s;break;case f:case u:o=" c ",n=3;var p,v,y=g[r++],b=g[r++],C=g[r++],T=g[r++];i===f?(C=((p=C)+2*y)/3,T=((v=T)+2*b)/3,y=(a+2*y)/3,b=(s+2*b)/3):(p=g[r++],v=g[r++]),SS[0][0]=y,SS[0][1]=b,SS[1][0]=C,SS[1][1]=T,a=SS[2][0]=p,s=SS[2][1]=v;break;case d:var x=0,E=0,_=1,I=1,D=0;t&&(x=t[4],E=t[5],_=hS(t[0]*t[0]+t[1]*t[1]),I=hS(t[2]*t[2]+t[3]*t[3]),D=Math.atan2(-t[1]/I,t[0]/_));var O=g[r++],w=g[r++],R=g[r++],S=g[r++],k=g[r++]+D,A=g[r++]+k+D;r++;var N=g[r++],M=O+mS(k)*R,K=w+pS(k)*S,P=(y=O+mS(A)*R,b=w+pS(A)*S,N?" wa ":" at ");Math.abs(M-y)<1e-4&&(.01<Math.abs(A-k)?N&&(M+=.0125):Math.abs(K-w)<1e-4?N&&M<O||!N&&O<M?b-=.0125:b+=.0125:N&&K<w||!N&&w<K?y+=.0125:y-=.0125),h.push(P,fS(((O-R)*_+x)*CS-TS),yS,fS(((w-S)*I+E)*CS-TS),yS,fS(((O+R)*_+x)*CS-TS),yS,fS(((w+S)*I+E)*CS-TS),yS,fS((M*_+x)*CS-TS),yS,fS((K*I+E)*CS-TS),yS,fS((y*_+x)*CS-TS),yS,fS((b*I+E)*CS-TS)),a=y,s=b;break;case dS.R:var L=SS[0],B=SS[1];L[0]=g[r++],L[1]=g[r++],B[0]=L[0]+g[r++],B[1]=L[1]+g[r++],t&&(Ce(L,L,t),Ce(B,B,t)),L[0]=fS(L[0]*CS-TS),B[0]=fS(B[0]*CS-TS),L[1]=fS(L[1]*CS-TS),B[1]=fS(B[1]*CS-TS),h.push(" m ",L[0],yS,L[1]," l ",B[0],yS,L[1]," l ",B[0],yS,B[1]," l ",L[0],yS,B[1]);break;case dS.Z:h.push(" x ")}if(0<n){h.push(o);for(var F=0;F<n;F++){var z=SS[F];t&&Ce(z,z,t),h.push(fS(z[0]*CS-TS),yS,fS(z[1]*CS-TS),F<n-1?yS:"")}}}return h.join("")}(s,this.transform),n.style.zIndex=DS(this.zlevel,this.z,this.z2),_S(e,n),null!=t.text?this.drawRectText(e,this.getBoundingRect()):this.removeRectText(e)},ha.prototype.onRemove=function(e){IS(e,this._vmlEl),this.removeRectText(e)},ha.prototype.onAdd=function(e){_S(e,this._vmlEl),this.appendRectText(e)},Wo.prototype.brushVML=function(e){var t,n,o=this.style,i=o.image;if(function(e){return"object"==typeof e&&e.tagName&&"IMG"===e.tagName.toUpperCase()}(i)){var r=i.src;if(r===this._imageSrc)t=this._imageWidth,n=this._imageHeight;else{var a=i.runtimeStyle,s=a.width,l=a.height;a.width="auto",a.height="auto",t=i.width,n=i.height,a.width=s,a.height=l,this._imageSrc=r,this._imageWidth=t,this._imageHeight=n}i=r}else i===this._imageSrc&&(t=this._imageWidth,n=this._imageHeight);if(i){var u=o.x||0,c=o.y||0,d=o.width,f=o.height,h=o.sWidth,g=o.sHeight,m=o.sx||0,p=o.sy||0,v=h&&g,y=this._vmlEl;y||(y=uS.createElement("div"),xS(y),this._vmlEl=y);var b,C=y.style,T=!1,x=1,E=1;if(this.transform&&(x=hS((b=this.transform)[0]*b[0]+b[1]*b[1]),E=hS(b[2]*b[2]+b[3]*b[3]),T=b[1]||b[2]),T){var _=[u,c],I=[u+d,c],D=[u,c+f],O=[u+d,c+f];Ce(_,_,b),Ce(I,I,b),Ce(D,D,b),Ce(O,O,b);var w=vS(_[0],I[0],D[0],O[0]),R=vS(_[1],I[1],D[1],O[1]),S=[];S.push("M11=",b[0]/x,yS,"M12=",b[2]/E,yS,"M21=",b[1]/x,yS,"M22=",b[3]/E,yS,"Dx=",fS(u*x+b[4]),yS,"Dy=",fS(c*E+b[5])),C.padding="0 "+fS(w)+"px "+fS(R)+"px 0",C.filter=bS+".Matrix("+S.join("")+", SizingMethod=clip)"}else b&&(u=u*x+b[4],c=c*E+b[5]),C.filter="",C.left=fS(u)+"px",C.top=fS(c)+"px";var k=this._imageEl,A=this._cropEl;k||(k=uS.createElement("div"),this._imageEl=k);var N=k.style;if(v){if(t&&n)N.width=fS(x*t*d/h)+"px",N.height=fS(E*n*f/g)+"px";else{var M=new Image,K=this;M.onload=function(){M.onload=null,n=M.height,N.width=fS(x*(t=M.width)*d/h)+"px",N.height=fS(E*n*f/g)+"px",K._imageWidth=t,K._imageHeight=n,K._imageSrc=i},M.src=i}A||((A=uS.createElement("div")).style.overflow="hidden",this._cropEl=A);var P=A.style;P.width=fS((d+m*d/h)*x),P.height=fS((f+p*f/g)*E),P.filter=bS+".Matrix(Dx="+-m*d/h*x+",Dy="+-p*f/g*E+")",A.parentNode||y.appendChild(A),k.parentNode!==A&&A.appendChild(k)}else N.width=fS(x*d)+"px",N.height=fS(E*f)+"px",y.appendChild(k),A&&A.parentNode&&(y.removeChild(A),this._cropEl=null);var L="",B=o.opacity;B<1&&(L+=".Alpha(opacity="+fS(100*B)+") "),N.filter=L+=bS+".AlphaImageLoader(src="+i+", SizingMethod=scale)",y.style.zIndex=DS(this.zlevel,this.z,this.z2),_S(e,y),null!=o.text&&this.drawRectText(e,this.getBoundingRect())}},Wo.prototype.onRemove=function(e){IS(e,this._vmlEl),this._vmlEl=null,this._cropEl=null,this._imageEl=null,this.removeRectText(e)},Wo.prototype.onAdd=function(e){_S(e,this._vmlEl),this.appendRectText(e)};var kS,AS="normal",NS={},MS=0,KS=document.createElement("div");no.measureText=function(e,t){var n=uS;kS||((kS=n.createElement("div")).style.cssText="position:absolute;top:-20000px;left:0;padding:0;margin:0;border:none;white-space:pre;",uS.body.appendChild(kS));try{kS.style.font=t}catch(e){}return kS.innerHTML="",kS.appendChild(n.createTextNode(e)),{width:kS.offsetWidth}};for(var PS=new En,LS=function(e,t,n,o){var i=this.style;this.__dirty&&Io(i);var r=i.text;if(null!=r&&(r+=""),r){if(i.rich){var a=mo(r,i);r=[];for(var s=0;s<a.lines.length;s++){for(var l=a.lines[s].tokens,u=[],c=0;c<l.length;c++)u.push(l[c].text);r.push(u.join(""))}r=r.join("\n")}var d,f,h=i.textAlign,g=i.textVerticalAlign,m=function(e){var t=NS[e];if(!t){100<MS&&(MS=0,NS={});var n,o=KS.style;try{o.font=e,n=o.fontFamily.split(",")[0]}catch(e){}t={style:o.fontStyle||AS,variant:o.fontVariant||AS,weight:o.fontWeight||AS,size:0|parseFloat(o.fontSize||12),family:n||"Microsoft YaHei"},NS[e]=t,MS++}return t}(i.font),p=m.style+" "+m.variant+" "+m.weight+" "+m.size+'px "'+m.family+'"';n=n||io(r,p,h,g,i.textPadding,i.textLineHeight);var v=this.transform;if(v&&!o&&(PS.copy(t),PS.applyTransform(v),t=PS),o)d=t.x,f=t.y;else{var y=i.textPosition;if(y instanceof Array)d=t.x+OS(y[0],t.width),f=t.y+OS(y[1],t.height),h=h||"left";else{var b=this.calculateTextPosition?this.calculateTextPosition({},i,t):so({},i,t);d=b.x,f=b.y,h=h||b.textAlign,g=g||b.textVerticalAlign}}d=ro(d,n.width,h),f=ao(f,n.height,g),f+=n.height/2;var C,T,x,E=cS,_=this._textVmlEl;_?T=(C=(x=_.firstChild).nextSibling).nextSibling:(_=E("line"),C=E("path"),T=E("textpath"),x=E("skew"),T.style["v-text-align"]="left",xS(_),C.textpathok=!0,T.on=!0,_.from="0 0",_.to="1000 0.05",_S(_,x),_S(_,C),_S(_,T),this._textVmlEl=_);var I=[d,f],D=_.style;v&&o?(Ce(I,I,v),x.on=!0,x.matrix=v[0].toFixed(3)+yS+v[2].toFixed(3)+yS+v[1].toFixed(3)+yS+v[3].toFixed(3)+",0,0",x.offset=(fS(I[0])||0)+","+(fS(I[1])||0),x.origin="0 0",D.left="0px",D.top="0px"):(x.on=!1,D.left=fS(d)+"px",D.top=fS(f)+"px"),T.string=function(e){return String(e).replace(/&/g,"&amp;").replace(/"/g,"&quot;")}(r);try{T.style.font=p}catch(e){}RS(_,"fill",{fill:i.textFill,opacity:i.opacity},this),RS(_,"stroke",{stroke:i.textStroke,opacity:i.opacity,lineDash:i.lineDash||null},this),_.style.zIndex=DS(this.zlevel,this.z,this.z2),_S(e,_)}},BS=function(e){IS(e,this._textVmlEl),this._textVmlEl=null},FS=function(e){_S(e,this._textVmlEl)},zS=[zo,Ho,Wo,ha,Sa],VS=0;VS<zS.length;VS++){var HS=zS[VS].prototype;HS.drawRectText=LS,HS.removeRectText=BS,HS.appendRectText=FS}Sa.prototype.brushVML=function(e){var t=this.style;null!=t.text?this.drawRectText(e,{x:t.x||0,y:t.y||0,width:0,height:0},this.getBoundingRect(),!0):this.removeRectText(e)},Sa.prototype.onRemove=function(e){this.removeRectText(e)},Sa.prototype.onAdd=function(e){this.appendRectText(e)}}function WS(e){return parseInt(e,10)}function $S(e,t){!function(){if(!lS&&uS){lS=!0;var e=uS.styleSheets;e.length<31?uS.createStyleSheet().addRule(".zrvml","behavior:url(#default#VML)"):e[0].addRule(".zrvml","behavior:url(#default#VML)")}}(),this.root=e,this.storage=t;var n=document.createElement("div"),o=document.createElement("div");n.style.cssText="display:inline-block;overflow:hidden;position:relative;width:300px;height:150px;",o.style.cssText="position:absolute;left:0;top:0;",e.appendChild(n),this._vmlRoot=o,this._vmlViewport=n,this.resize();var i=t.delFromStorage,r=t.addToStorage;t.delFromStorage=function(e){i.call(t,e),e&&e.onRemove&&e.onRemove(o)},t.addToStorage=function(e){e.onAdd&&e.onAdd(o),r.call(t,e)},this._firstPaint=!0}function US(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}$S.prototype={constructor:$S,getType:function(){return"vml"},getViewportRoot:function(){return this._vmlViewport},getViewportRootOffset:function(){var e=this.getViewportRoot();if(e)return{offsetLeft:e.offsetLeft||0,offsetTop:e.offsetTop||0}},refresh:function(){var e=this.storage.getDisplayList(!0,!0);this._paintList(e)},_paintList:function(e){for(var t=this._vmlRoot,n=0;n<e.length;n++){var o=e[n];o.invisible||o.ignore?(o.__alreadyNotVisible||o.onRemove(t),o.__alreadyNotVisible=!0):(o.__alreadyNotVisible&&o.onAdd(t),o.__alreadyNotVisible=!1,o.__dirty&&(o.beforeBrush&&o.beforeBrush(),(o.brushVML||o.brush).call(o,t),o.afterBrush&&o.afterBrush())),o.__dirty=!1}this._firstPaint&&(this._vmlViewport.appendChild(t),this._firstPaint=!1)},resize:function(e,t){if(e=null==e?this._getWidth():e,t=null==t?this._getHeight():t,this._width!==e||this._height!==t){this._width=e,this._height=t;var n=this._vmlViewport.style;n.width=e+"px",n.height=t+"px"}},dispose:function(){this.root.innerHTML="",this._vmlRoot=this._vmlViewport=this.storage=null},getWidth:function(){return this._width},getHeight:function(){return this._height},clear:function(){this._vmlViewport&&this.root.removeChild(this._vmlViewport)},_getWidth:function(){var e=this.root,t=e.currentStyle;return(e.clientWidth||WS(t.width))-WS(t.paddingLeft)-WS(t.paddingRight)|0},_getHeight:function(){var e=this.root,t=e.currentStyle;return(e.clientHeight||WS(t.height))-WS(t.paddingTop)-WS(t.paddingBottom)|0}},O(["getLayer","insertLayer","eachLayer","eachBuiltinLayer","eachOtherLayer","getLayers","modLayer","delLayer","clearLayer","toDataURL","pathToImage"],(function(e){$S.prototype[e]=function(){}})),Ci("vml",$S);var qS=jr.CMD,jS=Array.prototype.join,GS="none",XS=Math.round,YS=Math.sin,ZS=Math.cos,JS=Math.PI,QS=2*Math.PI,ek=180/JS,tk=1e-4;function nk(e){return XS(1e4*e)/1e4}function ok(e){return e<tk&&-tk<e}function ik(e,t){t&&rk(e,"transform","matrix("+jS.call(t,",")+")")}function rk(e,t,n){n&&("linear"===n.type||"radial"===n.type)||e.setAttribute(t,n)}function ak(e,t,n,o){if(function(e,t){var n=t?e.textFill:e.fill;return null!=n&&n!==GS}(t,n)){var i=n?t.textFill:t.fill;rk(e,"fill",i="transparent"===i?GS:i),rk(e,"fill-opacity",null!=t.fillOpacity?t.fillOpacity*t.opacity:t.opacity)}else rk(e,"fill",GS);if(function(e,t){var n=t?e.textStroke:e.stroke;return null!=n&&n!==GS}(t,n)){var r=n?t.textStroke:t.stroke;rk(e,"stroke",r="transparent"===r?GS:r),rk(e,"stroke-width",(n?t.textStrokeWidth:t.lineWidth)/(!n&&t.strokeNoScale?o.getLineScale():1)),rk(e,"paint-order",n?"stroke":"fill"),rk(e,"stroke-opacity",null!=t.strokeOpacity?t.strokeOpacity:t.opacity),t.lineDash?(rk(e,"stroke-dasharray",t.lineDash.join(",")),rk(e,"stroke-dashoffset",XS(t.lineDashOffset||0))):rk(e,"stroke-dasharray",""),t.lineCap&&rk(e,"stroke-linecap",t.lineCap),t.lineJoin&&rk(e,"stroke-linejoin",t.lineJoin),t.miterLimit&&rk(e,"stroke-miterlimit",t.miterLimit)}else rk(e,"stroke",GS)}var sk={brush:function(e){var t=e.style,n=e.__svgEl;n||(n=US("path"),e.__svgEl=n),e.path||e.createPathProxy();var o=e.path;if(e.__dirtyPath){o.beginPath(),o.subPixelOptimize=!1,e.buildPath(o,e.shape),e.__dirtyPath=!1;var i=function(e){for(var t=[],n=e.data,o=e.len(),i=0;i<o;){var r="",a=0;switch(n[i++]){case qS.M:r="M",a=2;break;case qS.L:r="L",a=2;break;case qS.Q:r="Q",a=4;break;case qS.C:r="C",a=6;break;case qS.A:var s=n[i++],l=n[i++],u=n[i++],c=n[i++],d=n[i++],f=n[i++],h=n[i++],g=n[i++],m=Math.abs(f),p=ok(m-QS)||(g?QS<=f:QS<=-f),v=0<f?f%QS:f%QS+QS,y=!1;y=!!p||!ok(m)&&JS<=v==!!g;var b=nk(s+u*ZS(d)),C=nk(l+c*YS(d));p&&(f=g?QS-1e-4:1e-4-QS,y=!0,9===i&&t.push("M",b,C));var T=nk(s+u*ZS(d+f)),x=nk(l+c*YS(d+f));t.push("A",nk(u),nk(c),XS(h*ek),+y,+g,T,x);break;case qS.Z:r="Z";break;case qS.R:T=nk(n[i++]),x=nk(n[i++]);var E=nk(n[i++]),_=nk(n[i++]);t.push("M",T,x,"L",T+E,x,"L",T+E,x+_,"L",T,x+_,"L",T,x)}r&&t.push(r);for(var I=0;I<a;I++)t.push(nk(n[i++]))}return t.join(" ")}(o);i.indexOf("NaN")<0&&rk(n,"d",i)}ak(n,t,!1,e),ik(n,e.transform),null!=t.text?gk(e,e.getBoundingRect()):pk(e)}},lk={brush:function(e){var t=e.style,n=t.image;if(n instanceof HTMLImageElement&&(n=n.src),n){var o=t.x||0,i=t.y||0,r=t.width,a=t.height,s=e.__svgEl;s||(s=US("image"),e.__svgEl=s),n!==e.__imageSrc&&(function(e,t,n){e.setAttributeNS("http://www.w3.org/1999/xlink","href",n)}(s,0,n),e.__imageSrc=n),rk(s,"width",r),rk(s,"height",a),rk(s,"x",o),rk(s,"y",i),ik(s,e.transform),null!=t.text?gk(e,e.getBoundingRect()):pk(e)}}},uk={},ck=new En,dk={},fk=[],hk={left:"start",right:"end",center:"middle",middle:"middle"},gk=function(e,t){var n=e.style,o=e.transform,i=e instanceof Sa||n.transformText;e.__dirty&&Io(n);var r=n.text;if(null!=r&&(r+=""),Fo(r,n)){null==r&&(r=""),!i&&o&&(ck.copy(t),ck.applyTransform(o),t=ck);var a=e.__textSvgEl;a||(a=US("text"),e.__textSvgEl=a);var s=a.style,l=n.font||to,u=a.__computedFont;l!==a.__styleFont&&(s.font=a.__styleFont=l,u=a.__computedFont=s.font);var c=n.textPadding,d=e.__textCotentBlock;d&&!e.__dirtyText||(d=e.__textCotentBlock=go(r,u,c,n.textLineHeight,n.truncate));var f=d.outerHeight,h=d.lineHeight;No(dk,e,n,t);var g=dk.baseX,m=dk.baseY,p=dk.textAlign||"left",v=dk.textVerticalAlign;!function(e,t,n,o,i,r,a){it(fk),t&&n&&rt(fk,n);var s=o.textRotation;if(i&&s){var l=o.textOrigin;"center"===l?(r=i.width/2+i.x,a=i.height/2+i.y):l&&(r=l[0]+i.x,a=l[1]+i.y),fk[4]-=r,fk[5]-=a,lt(fk,fk,s),fk[4]+=r,fk[5]+=a}ik(e,fk)}(a,i,o,n,t,g,m);var y=g,b=ao(m,f,v);c&&(y=function(e,t,n){return"right"===t?e-n[1]:"center"===t?e+n[3]/2-n[1]/2:e+n[3]}(g,p,c),b+=c[0]),b+=h/2,ak(a,n,!0,e);var C=d.canCacheByTextString,T=e.__tspanList||(e.__tspanList=[]),x=T.length;if(C&&e.__canCacheByTextString&&e.__text===r){if(e.__dirtyText&&x)for(var E=0;E<x;++E)mk(T[E],p,y,b+E*h)}else{e.__text=r,e.__canCacheByTextString=C;var _=d.lines,I=_.length;for(E=0;E<I;E++){var D=T[E],O=_[E];D?D.__zrText!==O&&(D.innerHTML="",D.appendChild(document.createTextNode(O))):(D=T[E]=US("tspan"),a.appendChild(D),D.appendChild(document.createTextNode(O))),mk(D,p,y,b+E*h)}if(I<x){for(;E<x;E++)a.removeChild(T[E]);T.length=I}}}};function mk(e,t,n,o){rk(e,"dominant-baseline","middle"),rk(e,"text-anchor",hk[t]),rk(e,"x",n),rk(e,"y",o)}function pk(e){e&&e.__textSvgEl&&(e.__textSvgEl.parentNode&&e.__textSvgEl.parentNode.removeChild(e.__textSvgEl),e.__textSvgEl=null,e.__tspanList=[],e.__text=null)}function vk(){}function yk(e,t){for(var n=0,o=t.length,i=0,r=0;n<o;n++){var a=t[n];if(a.removed){for(s=[],l=r;l<r+a.count;l++)s.push(l);a.indices=s,r+=a.count}else{for(var s=[],l=i;l<i+a.count;l++)s.push(l);a.indices=s,i+=a.count,a.added||(r+=a.count)}}return t}uk.drawRectText=gk,uk.brush=function(e){null!=e.style.text?gk(e,!1):pk(e)},vk.prototype={diff:function(e,t,n){this.equals=n=n||function(e,t){return e===t};var o=this;e=e.slice();var i=(t=t.slice()).length,r=e.length,a=1,s=i+r,l=[{newPos:-1,components:[]}],u=this.extractCommon(l[0],t,e,0);if(l[0].newPos+1>=i&&r<=u+1){for(var c=[],d=0;d<t.length;d++)c.push(d);return[{indices:c,count:t.length}]}function f(){for(var n=-1*a;n<=a;n+=2){var s,u=l[n-1],c=l[n+1],d=(c?c.newPos:0)-n;u&&(l[n-1]=void 0);var f=u&&u.newPos+1<i,h=c&&0<=d&&d<r;if(f||h){if(!f||h&&u.newPos<c.newPos?(s={newPos:(g=c).newPos,components:g.components.slice(0)},o.pushComponent(s.components,void 0,!0)):((s=u).newPos++,o.pushComponent(s.components,!0,void 0)),d=o.extractCommon(s,t,e,n),s.newPos+1>=i&&r<=d+1)return yk(0,s.components);l[n]=s}else l[n]=void 0}var g;a++}for(;a<=s;){var h=f();if(h)return h}},pushComponent:function(e,t,n){var o=e[e.length-1];o&&o.added===t&&o.removed===n?e[e.length-1]={count:o.count+1,added:t,removed:n}:e.push({count:1,added:t,removed:n})},extractCommon:function(e,t,n,o){for(var i=t.length,r=n.length,a=e.newPos,s=a-o,l=0;a+1<i&&s+1<r&&this.equals(t[a+1],n[s+1]);)a++,s++,l++;return l&&e.components.push({count:l}),e.newPos=a,s},tokenize:function(e){return e.slice()},join:function(e){return e.slice()}};var bk=new vk;function Ck(e,t,n,o,i){this._zrId=e,this._svgRoot=t,this._tagNames="string"==typeof n?[n]:n,this._markLabel=o,this._domName=i||"_dom",this.nextId=0}function Tk(e,t){Ck.call(this,e,t,["linearGradient","radialGradient"],"__gradient_in_use__")}function xk(e,t){Ck.call(this,e,t,"clipPath","__clippath_in_use__")}function Ek(e,t){Ck.call(this,e,t,["filter"],"__filter_in_use__","_shadowDom")}function _k(e){return e&&(e.shadowBlur||e.shadowOffsetX||e.shadowOffsetY||e.textShadowBlur||e.textShadowOffsetX||e.textShadowOffsetY)}function Ik(e){return parseInt(e,10)}function Dk(e,t){return t&&e&&t.parentNode!==e}function Ok(e,t,n){if(Dk(e,t)&&n){var o=n.nextSibling;o?e.insertBefore(t,o):e.appendChild(t)}}function wk(e,t){if(Dk(e,t)){var n=e.firstChild;n?e.insertBefore(t,n):e.appendChild(t)}}function Rk(e,t){t&&e&&t.parentNode===e&&e.removeChild(t)}function Sk(e){return e.__textSvgEl}function kk(e){return e.__svgEl}function Ak(e,t,n,o){this.root=e,this.storage=t,this._opts=n=b({},n||{});var i=US("svg");i.setAttribute("xmlns","http://www.w3.org/2000/svg"),i.setAttribute("version","1.1"),i.setAttribute("baseProfile","full"),i.style.cssText="user-select:none;position:absolute;left:0;top:0;";var r=US("g");i.appendChild(r);var a=US("g");i.appendChild(a),this.gradientManager=new Tk(o,a),this.clipPathManager=new xk(o,a),this.shadowManager=new Ek(o,a);var s=document.createElement("div");s.style.cssText="overflow:hidden;position:relative",this._svgDom=i,this._svgRoot=a,this._backgroundRoot=r,this._viewport=s,e.appendChild(s),s.appendChild(i),this.resize(n.width,n.height),this._visibleList=[]}Ck.prototype.createElement=US,Ck.prototype.getDefs=function(e){var t=this._svgRoot,n=this._svgRoot.getElementsByTagName("defs");return 0===n.length?e?((n=t.insertBefore(this.createElement("defs"),t.firstChild)).contains||(n.contains=function(e){var t=n.children;if(!t)return!1;for(var o=t.length-1;0<=o;--o)if(t[o]===e)return!0;return!1}),n):null:n[0]},Ck.prototype.update=function(e,t){if(e){var n=this.getDefs(!1);if(e[this._domName]&&n.contains(e[this._domName]))"function"==typeof t&&t(e);else{var o=this.add(e);o&&(e[this._domName]=o)}}},Ck.prototype.addDom=function(e){this.getDefs(!0).appendChild(e)},Ck.prototype.removeDom=function(e){var t=this.getDefs(!1);t&&e[this._domName]&&(t.removeChild(e[this._domName]),e[this._domName]=null)},Ck.prototype.getDoms=function(){var e=this.getDefs(!1);if(!e)return[];var t=[];return O(this._tagNames,(function(n){var o=e.getElementsByTagName(n);t=t.concat([].slice.call(o))})),t},Ck.prototype.markAllUnused=function(){var e=this.getDoms(),t=this;O(e,(function(e){e[t._markLabel]="0"}))},Ck.prototype.markUsed=function(e){e&&(e[this._markLabel]="1")},Ck.prototype.removeUnused=function(){var e=this.getDefs(!1);if(e){var t=this.getDoms(),n=this;O(t,(function(t){"1"!==t[n._markLabel]&&e.removeChild(t)}))}},Ck.prototype.getSvgProxy=function(e){return e instanceof ha?sk:e instanceof Wo?lk:e instanceof Sa?uk:sk},Ck.prototype.getTextSvgElement=function(e){return e.__textSvgEl},Ck.prototype.getSvgElement=function(e){return e.__svgEl},_(Tk,Ck),Tk.prototype.addWithoutUpdate=function(e,t){if(t&&t.style){var n=this;O(["fill","stroke"],(function(o){if(t.style[o]&&("linear"===t.style[o].type||"radial"===t.style[o].type)){var i,r=t.style[o],a=n.getDefs(!0);r._dom?(i=r._dom,a.contains(r._dom)||n.addDom(i)):i=n.add(r),n.markUsed(t);var s=i.getAttribute("id");e.setAttribute(o,"url(#"+s+")")}}))}},Tk.prototype.add=function(e){var t;if("linear"===e.type)t=this.createElement("linearGradient");else{if("radial"!==e.type)return null;t=this.createElement("radialGradient")}return e.id=e.id||this.nextId++,t.setAttribute("id","zr"+this._zrId+"-gradient-"+e.id),this.updateDom(e,t),this.addDom(t),t},Tk.prototype.update=function(e){var t=this;Ck.prototype.update.call(this,e,(function(){var n=e.type,o=e._dom.tagName;"linear"===n&&"linearGradient"===o||"radial"===n&&"radialGradient"===o?t.updateDom(e,e._dom):(t.removeDom(e),t.add(e))}))},Tk.prototype.updateDom=function(e,t){if("linear"===e.type)t.setAttribute("x1",e.x),t.setAttribute("y1",e.y),t.setAttribute("x2",e.x2),t.setAttribute("y2",e.y2);else{if("radial"!==e.type)return;t.setAttribute("cx",e.x),t.setAttribute("cy",e.y),t.setAttribute("r",e.r)}t.setAttribute("gradientUnits",e.global?"userSpaceOnUse":"objectBoundingBox"),t.innerHTML="";for(var n=e.colorStops,o=0,i=n.length;o<i;++o){var r=this.createElement("stop");r.setAttribute("offset",100*n[o].offset+"%");var a=n[o].color;if(-1<a.indexOf("rgba")){var s=Ft(a)[3],l=Ht(a);r.setAttribute("stop-color","#"+l),r.setAttribute("stop-opacity",s)}else r.setAttribute("stop-color",n[o].color);t.appendChild(r)}e._dom=t},Tk.prototype.markUsed=function(e){if(e.style){var t=e.style.fill;t&&t._dom&&Ck.prototype.markUsed.call(this,t._dom),(t=e.style.stroke)&&t._dom&&Ck.prototype.markUsed.call(this,t._dom)}},_(xk,Ck),xk.prototype.update=function(e){var t=this.getSvgElement(e);t&&this.updateDom(t,e.__clipPaths,!1);var n=this.getTextSvgElement(e);n&&this.updateDom(n,e.__clipPaths,!0),this.markUsed(e)},xk.prototype.updateDom=function(e,t,n){if(t&&0<t.length){var o,i,r=this.getDefs(!0),a=t[0],s=n?"_textDom":"_dom";a[s]?(i=a[s].getAttribute("id"),r.contains(o=a[s])||r.appendChild(o)):(i="zr"+this._zrId+"-clip-"+this.nextId,++this.nextId,(o=this.createElement("clipPath")).setAttribute("id",i),r.appendChild(o),a[s]=o);var l=this.getSvgProxy(a);if(a.transform&&a.parent.invTransform&&!n){var u=Array.prototype.slice.call(a.transform);at(a.transform,a.parent.invTransform,a.transform),l.brush(a),a.transform=u}else l.brush(a);var c=this.getSvgElement(a);o.innerHTML="",o.appendChild(c.cloneNode()),e.setAttribute("clip-path","url(#"+i+")"),1<t.length&&this.updateDom(o,t.slice(1),n)}else e&&e.setAttribute("clip-path","none")},xk.prototype.markUsed=function(e){var t=this;e.__clipPaths&&O(e.__clipPaths,(function(e){e._dom&&Ck.prototype.markUsed.call(t,e._dom),e._textDom&&Ck.prototype.markUsed.call(t,e._textDom)}))},_(Ek,Ck),Ek.prototype.addWithoutUpdate=function(e,t){if(t&&_k(t.style)){var n;t._shadowDom?(n=t._shadowDom,this.getDefs(!0).contains(t._shadowDom)||this.addDom(n)):n=this.add(t),this.markUsed(t);var o=n.getAttribute("id");e.style.filter="url(#"+o+")"}},Ek.prototype.add=function(e){var t=this.createElement("filter");return e._shadowDomId=e._shadowDomId||this.nextId++,t.setAttribute("id","zr"+this._zrId+"-shadow-"+e._shadowDomId),this.updateDom(e,t),this.addDom(t),t},Ek.prototype.update=function(e,t){if(_k(t.style)){var n=this;Ck.prototype.update.call(this,t,(function(){n.updateDom(t,t._shadowDom)}))}else this.remove(e,t)},Ek.prototype.remove=function(e,t){null!=t._shadowDomId&&(this.removeDom(e),e.style.filter="")},Ek.prototype.updateDom=function(e,t){var n=t.getElementsByTagName("feDropShadow");n=0===n.length?this.createElement("feDropShadow"):n[0];var o,i,r,a,s=e.style,l=e.scale&&e.scale[0]||1,u=e.scale&&e.scale[1]||1;if(s.shadowBlur||s.shadowOffsetX||s.shadowOffsetY)o=s.shadowOffsetX||0,i=s.shadowOffsetY||0,r=s.shadowBlur,a=s.shadowColor;else{if(!s.textShadowBlur)return void this.removeDom(t,s);o=s.textShadowOffsetX||0,i=s.textShadowOffsetY||0,r=s.textShadowBlur,a=s.textShadowColor}n.setAttribute("dx",o/l),n.setAttribute("dy",i/u),n.setAttribute("flood-color",a),n.setAttribute("stdDeviation",r/2/l+" "+r/2/u),t.setAttribute("x","-100%"),t.setAttribute("y","-100%"),t.setAttribute("width",Math.ceil(r/2*200)+"%"),t.setAttribute("height",Math.ceil(r/2*200)+"%"),t.appendChild(n),e._shadowDom=t},Ek.prototype.markUsed=function(e){e._shadowDom&&Ck.prototype.markUsed.call(this,e._shadowDom)},Ak.prototype={constructor:Ak,getType:function(){return"svg"},getViewportRoot:function(){return this._viewport},getSvgDom:function(){return this._svgDom},getSvgRoot:function(){return this._svgRoot},getViewportRootOffset:function(){var e=this.getViewportRoot();if(e)return{offsetLeft:e.offsetLeft||0,offsetTop:e.offsetTop||0}},refresh:function(){var e=this.storage.getDisplayList(!0);this._paintList(e)},setBackgroundColor:function(e){this._backgroundRoot&&this._backgroundNode&&this._backgroundRoot.removeChild(this._backgroundNode);var t=US("rect");t.setAttribute("width",this.getWidth()),t.setAttribute("height",this.getHeight()),t.setAttribute("x",0),t.setAttribute("y",0),t.setAttribute("id",0),t.style.fill=e,this._backgroundRoot.appendChild(t),this._backgroundNode=t},_paintList:function(e){this.gradientManager.markAllUnused(),this.clipPathManager.markAllUnused(),this.shadowManager.markAllUnused();var t,n,o=this._svgRoot,i=this._visibleList,r=e.length,a=[];for(t=0;t<r;t++){var s=e[t],l=(n=s)instanceof ha?sk:n instanceof Wo?lk:n instanceof Sa?uk:sk,u=kk(s)||Sk(s);s.invisible||(s.__dirty&&(l&&l.brush(s),this.clipPathManager.update(s),s.style&&(this.gradientManager.update(s.style.fill),this.gradientManager.update(s.style.stroke),this.shadowManager.update(u,s)),s.__dirty=!1),a.push(s))}var c,d=function(e,t,n){return bk.diff(e,t,void 0)}(i,a);for(t=0;t<d.length;t++)if((g=d[t]).removed)for(var f=0;f<g.count;f++){u=kk(s=i[g.indices[f]]);var h=Sk(s);Rk(o,u),Rk(o,h)}for(t=0;t<d.length;t++){var g;if((g=d[t]).added)for(f=0;f<g.count;f++)u=kk(s=a[g.indices[f]]),h=Sk(s),c?Ok(o,u,c):wk(o,u),u?Ok(o,h,u):c?Ok(o,h,c):wk(o,h),Ok(o,h,u),c=h||u||c,this.gradientManager.addWithoutUpdate(u||h,s),this.shadowManager.addWithoutUpdate(u||h,s),this.clipPathManager.markUsed(s);else if(!g.removed)for(f=0;f<g.count;f++)u=kk(s=a[g.indices[f]]),h=Sk(s),u=kk(s),h=Sk(s),this.gradientManager.markUsed(s),this.gradientManager.addWithoutUpdate(u||h,s),this.shadowManager.markUsed(s),this.shadowManager.addWithoutUpdate(u||h,s),this.clipPathManager.markUsed(s),h&&Ok(o,h,u),c=u||h||c}this.gradientManager.removeUnused(),this.clipPathManager.removeUnused(),this.shadowManager.removeUnused(),this._visibleList=a},_getDefs:function(e){var t,n=this._svgDom;return 0!==(t=n.getElementsByTagName("defs")).length?t[0]:e?((t=n.insertBefore(US("defs"),n.firstChild)).contains||(t.contains=function(e){var n=t.children;if(!n)return!1;for(var o=n.length-1;0<=o;--o)if(n[o]===e)return!0;return!1}),t):null},resize:function(e,t){var n=this._viewport;n.style.display="none";var o=this._opts;if(null!=e&&(o.width=e),null!=t&&(o.height=t),e=this._getSize(0),t=this._getSize(1),n.style.display="",this._width!==e||this._height!==t){this._width=e,this._height=t;var i=n.style;i.width=e+"px",i.height=t+"px";var r=this._svgDom;r.setAttribute("width",e),r.setAttribute("height",t)}this._backgroundNode&&(this._backgroundNode.setAttribute("width",e),this._backgroundNode.setAttribute("height",t))},getWidth:function(){return this._width},getHeight:function(){return this._height},_getSize:function(e){var t=this._opts,n=["width","height"][e],o=["clientWidth","clientHeight"][e],i=["paddingLeft","paddingTop"][e],r=["paddingRight","paddingBottom"][e];if(null!=t[n]&&"auto"!==t[n])return parseFloat(t[n]);var a=this.root,s=document.defaultView.getComputedStyle(a);return(a[o]||Ik(s[n])||Ik(a.style[n]))-(Ik(s[i])||0)-(Ik(s[r])||0)|0},dispose:function(){this.root.innerHTML="",this._svgRoot=this._backgroundRoot=this._svgDom=this._backgroundNode=this._viewport=this.storage=null},clear:function(){this._viewport&&this.root.removeChild(this._viewport)},toDataURL:function(){return this.refresh(),"data:image/svg+xml;charset=UTF-8,"+encodeURIComponent(this._svgDom.outerHTML.replace(/></g,">\n\r<"))}},O(["getLayer","insertLayer","eachLayer","eachBuiltinLayer","eachOtherLayer","getLayers","modLayer","delLayer","clearLayer","pathToImage"],(function(e){Ak.prototype[e]=function(){}})),Ci("svg",Ak),e.version="4.9.0",e.dependencies={zrender:"4.3.2"},e.PRIORITY=ff,e.init=function(e,t,n){var o=Zf(e);if(o)return o;var i=new yf(e,t,n);return i.id="ec_"+qf++,$f[i.id]=i,zi(e,Gf,i.id),function(e){var t="__connectUpdateStatus";function n(e,n){for(var o=0;o<e.length;o++)e[o][t]=n}lf(Lf,(function(o,i){e._messageCenter.on(i,(function(o){if(Uf[e.group]&&0!==e[t]){if(o&&o.escapeConnect)return;var i=e.makeActionFromEvent(o),r=[];lf($f,(function(t){t!==e&&t.group===e.group&&r.push(t)})),n(r,0),lf(r,(function(e){1!==e[t]&&e.dispatchAction(i)})),n(r,2)}}))}))}(i),i},e.connect=function(e){if(M(e)){var t=e;e=null,lf(t,(function(t){null!=t.group&&(e=t.group)})),e=e||"g_"+jf++,lf(t,(function(t){t.group=e}))}return Uf[e]=!0,e},e.disConnect=Xf,e.disconnect=Yf,e.dispose=function(e){"string"==typeof e?e=$f[e]:e instanceof yf||(e=Zf(e)),e instanceof yf&&!e.isDisposed()&&e.dispose()},e.getInstanceByDom=Zf,e.getInstanceById=function(e){return $f[e]},e.registerTheme=Jf,e.registerPreprocessor=Qf,e.registerProcessor=eh,e.registerPostUpdate=function(e){zf.push(e)},e.registerAction=th,e.registerCoordinateSystem=nh,e.getCoordinateSystemDimensions=function(e){var t=Uu.get(e);if(t)return t.getDimensionsInfo?t.getDimensionsInfo():t.dimensions.slice()},e.registerLayout=oh,e.registerVisual=ih,e.registerLoading=ah,e.extendComponentModel=sh,e.extendComponentView=lh,e.extendSeriesModel=uh,e.extendChartView=ch,e.setCanvasCreator=function(e){m("createCanvas",e)},e.registerMap=function(e,t,n){!function(e,t,n){var o;O(o=M(t)?t:t.svg?[{type:"svg",source:t.svg,specialAreas:t.specialAreas}]:(t.geoJson&&!t.features&&(n=t.specialAreas,t=t.geoJson),[{type:"geoJSON",source:t,specialAreas:n}]),(function(e){var t=e.type;"geoJson"===t&&(t=e.type="geoJSON"),(0,af[t])(e)})),of.set(e,o)}(e,t,n)},e.getMap=function(e){var t=rf(e);return t&&t[0]&&{geoJson:t[0].geoJSON,specialAreas:t[0].specialAreas}},e.dataTool={},e.zrender=xi,e.number=Ll,e.format=eu,e.throttle=fd,e.helper=nm,e.matrix=ft,e.vector=Ee,e.color=Gt,e.parseGeoJSON=sm,e.parseGeoJson=ym,e.util=bm,e.graphic=Cm,e.List=wh,e.Model=hl,e.Axis=pm,e.env=i})),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("echarts")):"function"==typeof define&&define.amd?define(["exports","echarts"],t):t(e.bmap={},e.echarts)}(this,(function(e,t){"use strict";function n(e,t){this._bmap=e,this.dimensions=["lng","lat"],this._mapOffset=[0,0],this._api=t,this._projection=new BMap.MercatorProjection}function o(e,n){return n=n||[0,0],t.util.map([0,1],(function(t){var o=n[t],i=e[t]/2,r=[],a=[];return r[t]=o-i,a[t]=o+i,r[1-t]=a[1-t]=n[1-t],Math.abs(this.dataToPoint(r)[t]-this.dataToPoint(a)[t])}),this)}var i;function r(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}n.prototype.dimensions=["lng","lat"],n.prototype.setZoom=function(e){this._zoom=e},n.prototype.setCenter=function(e){this._center=this._projection.lngLatToPoint(new BMap.Point(e[0],e[1]))},n.prototype.setMapOffset=function(e){this._mapOffset=e},n.prototype.getBMap=function(){return this._bmap},n.prototype.dataToPoint=function(e){var t=new BMap.Point(e[0],e[1]),n=this._bmap.pointToOverlayPixel(t),o=this._mapOffset;return[n.x-o[0],n.y-o[1]]},n.prototype.pointToData=function(e){var t=this._mapOffset;return[(e=this._bmap.overlayPixelToPoint({x:e[0]+t[0],y:e[1]+t[1]})).lng,e.lat]},n.prototype.getViewRect=function(){var e=this._api;return new t.graphic.BoundingRect(0,0,e.getWidth(),e.getHeight())},n.prototype.getRoamTransform=function(){return t.matrix.create()},n.prototype.prepareCustoms=function(e){var n=this.getViewRect();return{coordSys:{type:"bmap",x:n.x,y:n.y,width:n.width,height:n.height},api:{coord:t.util.bind(this.dataToPoint,this),size:t.util.bind(o,this)}}},n.dimensions=n.prototype.dimensions,n.create=function(e,t){var o,r=t.getDom();e.eachComponent("bmap",(function(e){var a=t.getZr().painter,s=a.getViewportRoot();if("undefined"==typeof BMap)throw new Error("BMap api is not loaded");if(i=i||function(){function e(e){this._root=e}return(e.prototype=new BMap.Overlay).initialize=function(e){return e.getPanes().labelPane.appendChild(this._root),this._root},e.prototype.draw=function(){},e}(),o)throw new Error("Only one bmap component can exist");if(!e.__bmap){var l=r.querySelector(".ec-extension-bmap");l&&(s.style.left="0px",s.style.top="0px",r.removeChild(l)),(l=document.createElement("div")).style.cssText="width:100%;height:100%",l.classList.add("ec-extension-bmap"),r.appendChild(l);var u=e.get("mapOptions")||{};delete u.mapType;var c=e.__bmap=new BMap.Map(l,u),d=new i(s);c.addOverlay(d),a.getViewportRootOffset=function(){return{offsetLeft:0,offsetTop:0}}}c=e.__bmap;var f=e.get("center"),h=e.get("zoom");if(f&&h){var g=c.getCenter(),m=c.getZoom();if(e.centerOrZoomChanged([g.lng,g.lat],m)){var p=new BMap.Point(f[0],f[1]);c.centerAndZoom(p,h)}}(o=new n(c,t)).setMapOffset(e.__mapOffset||[0,0]),o.setZoom(h),o.setCenter(f),e.coordinateSystem=o})),e.eachSeries((function(e){"bmap"===e.get("coordinateSystem")&&(e.coordinateSystem=o)}))},t.extendComponentModel({type:"bmap",getBMap:function(){return this.__bmap},setCenterAndZoom:function(e,t){this.option.center=e,this.option.zoom=t},centerOrZoomChanged:function(e,t){var n=this.option;return!(function(e,t){return e&&t&&e[0]===t[0]&&e[1]===t[1]}(e,n.center)&&t===n.zoom)},defaultOption:{center:[104.114129,37.550339],zoom:5,mapStyle:{},mapStyleV2:{},mapOptions:{},roam:!1}}),t.extendComponentView({type:"bmap",render:function(e,n,o){function i(t,n){if(!a){var i=l.parentNode.parentNode.parentNode,r=[-parseInt(i.style.left,10)||0,-parseInt(i.style.top,10)||0];l.style.left=r[0]+"px",l.style.top=r[1]+"px",u.setMapOffset(r),e.__mapOffset=r,o.dispatchAction({type:"bmapRoam"})}}var a=!0,s=e.getBMap(),l=o.getZr().painter.getViewportRoot(),u=e.coordinateSystem;function c(){a||o.dispatchAction({type:"bmapRoam"})}s.removeEventListener("moving",this._oldMoveHandler),s.removeEventListener("moveend",this._oldMoveHandler),s.removeEventListener("zoomend",this._oldZoomEndHandler),s.addEventListener("moving",i),s.addEventListener("moveend",i),s.addEventListener("zoomend",c),this._oldMoveHandler=i,this._oldZoomEndHandler=c;var d=e.get("roam");d&&"scale"!==d?s.enableDragging():s.disableDragging(),d&&"move"!==d?(s.enableScrollWheelZoom(),s.enableDoubleClickZoom(),s.enablePinchToZoom()):(s.disableScrollWheelZoom(),s.disableDoubleClickZoom(),s.disablePinchToZoom());var f=e.__mapStyle,h=e.get("mapStyle")||{},g=JSON.stringify(h);JSON.stringify(f)!==g&&(r(p)||s.setMapStyle(t.util.clone(h)),e.__mapStyle=JSON.parse(g));var m=e.__mapStyle2,p=e.get("mapStyleV2")||{},v=JSON.stringify(p);JSON.stringify(m)!==v&&(r(p)||s.setMapStyleV2(t.util.clone(p)),e.__mapStyle2=JSON.parse(v)),a=!1}}),t.registerCoordinateSystem("bmap",n),t.registerAction({type:"bmapRoam",event:"bmapRoam",update:"updateLayout"},(function(e,t){t.eachComponent("bmap",(function(e){var t=e.getBMap(),n=t.getCenter();e.setCenterAndZoom([n.lng,n.lat],t.getZoom())}))})),e.version="1.0.0"})),function(e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).Chart=e()}((function(){return function e(t,n,o){function i(a,s){if(!n[a]){if(!t[a]){var l="function"==typeof require&&require;if(!s&&l)return l(a,!0);if(r)return r(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var c=n[a]={exports:{}};t[a][0].call(c.exports,(function(e){return i(t[a][1][e]||e)}),c,c.exports,e,t,n,o)}return n[a].exports}for(var r="function"==typeof require&&require,a=0;a<o.length;a++)i(o[a]);return i}({1:[function(e,t,n){},{}],2:[function(e,t,n){function o(e){if(e){var t=[0,0,0],n=1,o=e.match(/^#([a-fA-F0-9]{3})$/i);if(o)for(o=o[1],i=0;i<t.length;i++)t[i]=parseInt(o[i]+o[i],16);else if(o=e.match(/^#([a-fA-F0-9]{6})$/i))for(o=o[1],i=0;i<t.length;i++)t[i]=parseInt(o.slice(2*i,2*i+2),16);else if(o=e.match(/^rgba?\(\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/i)){for(i=0;i<t.length;i++)t[i]=parseInt(o[i+1]);n=parseFloat(o[4])}else if(o=e.match(/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,\s*([+-]?[\d\.]+)\%\s*,\s*([+-]?[\d\.]+)\%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/i)){for(i=0;i<t.length;i++)t[i]=Math.round(2.55*parseFloat(o[i+1]));n=parseFloat(o[4])}else if(o=e.match(/(\w+)/)){if("transparent"==o[1])return[0,0,0,0];if(!(t=d[o[1]]))return}for(var i=0;i<t.length;i++)t[i]=u(t[i],0,255);return n=n||0==n?u(n,0,1):1,t[3]=n,t}}function i(e){if(e){var t=e.match(/^hsla?\(\s*([+-]?\d+)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)/);if(t){var n=parseFloat(t[4]);return[u(parseInt(t[1]),0,360),u(parseFloat(t[2]),0,100),u(parseFloat(t[3]),0,100),u(isNaN(n)?1:n,0,1)]}}}function r(e){if(e){var t=e.match(/^hwb\(\s*([+-]?\d+)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)/);if(t){var n=parseFloat(t[4]);return[u(parseInt(t[1]),0,360),u(parseFloat(t[2]),0,100),u(parseFloat(t[3]),0,100),u(isNaN(n)?1:n,0,1)]}}}function a(e,t){return void 0===t&&(t=void 0!==e[3]?e[3]:1),"rgba("+e[0]+", "+e[1]+", "+e[2]+", "+t+")"}function s(e,t){return"rgba("+Math.round(e[0]/255*100)+"%, "+Math.round(e[1]/255*100)+"%, "+Math.round(e[2]/255*100)+"%, "+(t||e[3]||1)+")"}function l(e,t){return void 0===t&&(t=void 0!==e[3]?e[3]:1),"hsla("+e[0]+", "+e[1]+"%, "+e[2]+"%, "+t+")"}function u(e,t,n){return Math.min(Math.max(t,e),n)}function c(e){var t=e.toString(16).toUpperCase();return t.length<2?"0"+t:t}var d=e(6);t.exports={getRgba:o,getHsla:i,getRgb:function(e){var t=o(e);return t&&t.slice(0,3)},getHsl:function(e){var t=i(e);return t&&t.slice(0,3)},getHwb:r,getAlpha:function(e){var t=o(e);return t||(t=i(e))||(t=r(e))?t[3]:void 0},hexString:function(e){return"#"+c(e[0])+c(e[1])+c(e[2])},rgbString:function(e,t){return t<1||e[3]&&e[3]<1?a(e,t):"rgb("+e[0]+", "+e[1]+", "+e[2]+")"},rgbaString:a,percentString:function(e,t){return t<1||e[3]&&e[3]<1?s(e,t):"rgb("+Math.round(e[0]/255*100)+"%, "+Math.round(e[1]/255*100)+"%, "+Math.round(e[2]/255*100)+"%)"},percentaString:s,hslString:function(e,t){return t<1||e[3]&&e[3]<1?l(e,t):"hsl("+e[0]+", "+e[1]+"%, "+e[2]+"%)"},hslaString:l,hwbString:function(e,t){return void 0===t&&(t=void 0!==e[3]?e[3]:1),"hwb("+e[0]+", "+e[1]+"%, "+e[2]+"%"+(void 0!==t&&1!==t?", "+t:"")+")"},keyword:function(e){return f[e.slice(0,3)]}};var f={};for(var h in d)f[d[h]]=h},{6:6}],3:[function(e,t,n){var o=e(5),i=e(2),r=function(e){return e instanceof r?e:this instanceof r?(this.valid=!1,this.values={rgb:[0,0,0],hsl:[0,0,0],hsv:[0,0,0],hwb:[0,0,0],cmyk:[0,0,0,0],alpha:1},void("string"==typeof e?(t=i.getRgba(e))?this.setValues("rgb",t):(t=i.getHsla(e))?this.setValues("hsl",t):(t=i.getHwb(e))&&this.setValues("hwb",t):"object"==typeof e&&(void 0!==(t=e).r||void 0!==t.red?this.setValues("rgb",t):void 0!==t.l||void 0!==t.lightness?this.setValues("hsl",t):void 0!==t.v||void 0!==t.value?this.setValues("hsv",t):void 0!==t.w||void 0!==t.whiteness?this.setValues("hwb",t):void 0===t.c&&void 0===t.cyan||this.setValues("cmyk",t)))):new r(e);var t};r.prototype={isValid:function(){return this.valid},rgb:function(){return this.setSpace("rgb",arguments)},hsl:function(){return this.setSpace("hsl",arguments)},hsv:function(){return this.setSpace("hsv",arguments)},hwb:function(){return this.setSpace("hwb",arguments)},cmyk:function(){return this.setSpace("cmyk",arguments)},rgbArray:function(){return this.values.rgb},hslArray:function(){return this.values.hsl},hsvArray:function(){return this.values.hsv},hwbArray:function(){var e=this.values;return 1!==e.alpha?e.hwb.concat([e.alpha]):e.hwb},cmykArray:function(){return this.values.cmyk},rgbaArray:function(){var e=this.values;return e.rgb.concat([e.alpha])},hslaArray:function(){var e=this.values;return e.hsl.concat([e.alpha])},alpha:function(e){return void 0===e?this.values.alpha:(this.setValues("alpha",e),this)},red:function(e){return this.setChannel("rgb",0,e)},green:function(e){return this.setChannel("rgb",1,e)},blue:function(e){return this.setChannel("rgb",2,e)},hue:function(e){return e&&(e=(e%=360)<0?360+e:e),this.setChannel("hsl",0,e)},saturation:function(e){return this.setChannel("hsl",1,e)},lightness:function(e){return this.setChannel("hsl",2,e)},saturationv:function(e){return this.setChannel("hsv",1,e)},whiteness:function(e){return this.setChannel("hwb",1,e)},blackness:function(e){return this.setChannel("hwb",2,e)},value:function(e){return this.setChannel("hsv",2,e)},cyan:function(e){return this.setChannel("cmyk",0,e)},magenta:function(e){return this.setChannel("cmyk",1,e)},yellow:function(e){return this.setChannel("cmyk",2,e)},black:function(e){return this.setChannel("cmyk",3,e)},hexString:function(){return i.hexString(this.values.rgb)},rgbString:function(){return i.rgbString(this.values.rgb,this.values.alpha)},rgbaString:function(){return i.rgbaString(this.values.rgb,this.values.alpha)},percentString:function(){return i.percentString(this.values.rgb,this.values.alpha)},hslString:function(){return i.hslString(this.values.hsl,this.values.alpha)},hslaString:function(){return i.hslaString(this.values.hsl,this.values.alpha)},hwbString:function(){return i.hwbString(this.values.hwb,this.values.alpha)},keyword:function(){return i.keyword(this.values.rgb,this.values.alpha)},rgbNumber:function(){var e=this.values.rgb;return e[0]<<16|e[1]<<8|e[2]},luminosity:function(){for(var e=this.values.rgb,t=[],n=0;n<e.length;n++){var o=e[n]/255;t[n]=o<=.03928?o/12.92:Math.pow((o+.055)/1.055,2.4)}return.2126*t[0]+.7152*t[1]+.0722*t[2]},contrast:function(e){var t=this.luminosity(),n=e.luminosity();return t>n?(t+.05)/(n+.05):(n+.05)/(t+.05)},level:function(e){var t=this.contrast(e);return t>=7.1?"AAA":t>=4.5?"AA":""},dark:function(){var e=this.values.rgb;return(299*e[0]+587*e[1]+114*e[2])/1e3<128},light:function(){return!this.dark()},negate:function(){for(var e=[],t=0;t<3;t++)e[t]=255-this.values.rgb[t];return this.setValues("rgb",e),this},lighten:function(e){var t=this.values.hsl;return t[2]+=t[2]*e,this.setValues("hsl",t),this},darken:function(e){var t=this.values.hsl;return t[2]-=t[2]*e,this.setValues("hsl",t),this},saturate:function(e){var t=this.values.hsl;return t[1]+=t[1]*e,this.setValues("hsl",t),this},desaturate:function(e){var t=this.values.hsl;return t[1]-=t[1]*e,this.setValues("hsl",t),this},whiten:function(e){var t=this.values.hwb;return t[1]+=t[1]*e,this.setValues("hwb",t),this},blacken:function(e){var t=this.values.hwb;return t[2]+=t[2]*e,this.setValues("hwb",t),this},greyscale:function(){var e=this.values.rgb,t=.3*e[0]+.59*e[1]+.11*e[2];return this.setValues("rgb",[t,t,t]),this},clearer:function(e){var t=this.values.alpha;return this.setValues("alpha",t-t*e),this},opaquer:function(e){var t=this.values.alpha;return this.setValues("alpha",t+t*e),this},rotate:function(e){var t=this.values.hsl,n=(t[0]+e)%360;return t[0]=n<0?360+n:n,this.setValues("hsl",t),this},mix:function(e,t){var n=this,o=e,i=void 0===t?.5:t,r=2*i-1,a=n.alpha()-o.alpha(),s=((r*a==-1?r:(r+a)/(1+r*a))+1)/2,l=1-s;return this.rgb(s*n.red()+l*o.red(),s*n.green()+l*o.green(),s*n.blue()+l*o.blue()).alpha(n.alpha()*i+o.alpha()*(1-i))},toJSON:function(){return this.rgb()},clone:function(){var e,t,n=new r,o=this.values,i=n.values;for(var a in o)o.hasOwnProperty(a)&&("[object Array]"===(t={}.toString.call(e=o[a]))?i[a]=e.slice(0):"[object Number]"===t?i[a]=e:console.error("unexpected color value:",e));return n}},r.prototype.spaces={rgb:["red","green","blue"],hsl:["hue","saturation","lightness"],hsv:["hue","saturation","value"],hwb:["hue","whiteness","blackness"],cmyk:["cyan","magenta","yellow","black"]},r.prototype.maxes={rgb:[255,255,255],hsl:[360,100,100],hsv:[360,100,100],hwb:[360,100,100],cmyk:[100,100,100,100]},r.prototype.getValues=function(e){for(var t=this.values,n={},o=0;o<e.length;o++)n[e.charAt(o)]=t[e][o];return 1!==t.alpha&&(n.a=t.alpha),n},r.prototype.setValues=function(e,t){var n,i,r=this.values,a=this.spaces,s=this.maxes,l=1;if(this.valid=!0,"alpha"===e)l=t;else if(t.length)r[e]=t.slice(0,e.length),l=t[e.length];else if(void 0!==t[e.charAt(0)]){for(n=0;n<e.length;n++)r[e][n]=t[e.charAt(n)];l=t.a}else if(void 0!==t[a[e][0]]){var u=a[e];for(n=0;n<e.length;n++)r[e][n]=t[u[n]];l=t.alpha}if(r.alpha=Math.max(0,Math.min(1,void 0===l?r.alpha:l)),"alpha"===e)return!1;for(n=0;n<e.length;n++)i=Math.max(0,Math.min(s[e][n],r[e][n])),r[e][n]=Math.round(i);for(var c in a)c!==e&&(r[c]=o[e][c](r[e]));return!0},r.prototype.setSpace=function(e,t){var n=t[0];return void 0===n?this.getValues(e):("number"==typeof n&&(n=Array.prototype.slice.call(t)),this.setValues(e,n),this)},r.prototype.setChannel=function(e,t,n){var o=this.values[e];return void 0===n?o[t]:(n===o[t]||(o[t]=n,this.setValues(e,o)),this)},"undefined"!=typeof window&&(window.Color=r),t.exports=r},{2:2,5:5}],4:[function(e,t,n){function o(e){var t,n,o=e[0]/255,i=e[1]/255,r=e[2]/255,a=Math.min(o,i,r),s=Math.max(o,i,r),l=s-a;return s==a?t=0:o==s?t=(i-r)/l:i==s?t=2+(r-o)/l:r==s&&(t=4+(o-i)/l),(t=Math.min(60*t,360))<0&&(t+=360),n=(a+s)/2,[t,100*(s==a?0:n<=.5?l/(s+a):l/(2-s-a)),100*n]}function i(e){var t,n,o=e[0],i=e[1],r=e[2],a=Math.min(o,i,r),s=Math.max(o,i,r),l=s-a;return n=0==s?0:l/s*1e3/10,s==a?t=0:o==s?t=(i-r)/l:i==s?t=2+(r-o)/l:r==s&&(t=4+(o-i)/l),(t=Math.min(60*t,360))<0&&(t+=360),[t,n,s/255*1e3/10]}function a(e){var t=e[0],n=e[1],i=e[2];return[o(e)[0],1/255*Math.min(t,Math.min(n,i))*100,100*(i=1-1/255*Math.max(t,Math.max(n,i)))]}function s(e){var t,n=e[0]/255,o=e[1]/255,i=e[2]/255;return[100*((1-n-(t=Math.min(1-n,1-o,1-i)))/(1-t)||0),100*((1-o-t)/(1-t)||0),100*((1-i-t)/(1-t)||0),100*t]}function l(e){return I[JSON.stringify(e)]}function u(e){var t=e[0]/255,n=e[1]/255,o=e[2]/255;return[100*(.4124*(t=t>.04045?Math.pow((t+.055)/1.055,2.4):t/12.92)+.3576*(n=n>.04045?Math.pow((n+.055)/1.055,2.4):n/12.92)+.1805*(o=o>.04045?Math.pow((o+.055)/1.055,2.4):o/12.92)),100*(.2126*t+.7152*n+.0722*o),100*(.0193*t+.1192*n+.9505*o)]}function c(e){var t=u(e),n=t[0],o=t[1],i=t[2];return o/=100,i/=108.883,n=(n/=95.047)>.008856?Math.pow(n,1/3):7.787*n+16/116,[116*(o=o>.008856?Math.pow(o,1/3):7.787*o+16/116)-16,500*(n-o),200*(o-(i=i>.008856?Math.pow(i,1/3):7.787*i+16/116))]}function d(e){var t,n,o,i,r,a=e[0]/360,s=e[1]/100,l=e[2]/100;if(0==s)return[r=255*l,r,r];t=2*l-(n=l<.5?l*(1+s):l+s-l*s),i=[0,0,0];for(var u=0;u<3;u++)(o=a+1/3*-(u-1))<0&&o++,o>1&&o--,i[u]=255*(r=6*o<1?t+6*(n-t)*o:2*o<1?n:3*o<2?t+(n-t)*(2/3-o)*6:t);return i}function f(e){var t=e[0]/60,n=e[1]/100,o=e[2]/100,i=Math.floor(t)%6,r=t-Math.floor(t),a=255*o*(1-n),s=255*o*(1-n*r),l=255*o*(1-n*(1-r));switch(o*=255,i){case 0:return[o,l,a];case 1:return[s,o,a];case 2:return[a,o,l];case 3:return[a,s,o];case 4:return[l,a,o];case 5:return[o,a,s]}}function h(e){var t,n,o,i,a=e[0]/360,s=e[1]/100,l=e[2]/100,u=s+l;switch(u>1&&(s/=u,l/=u),o=6*a-(t=Math.floor(6*a)),0!=(1&t)&&(o=1-o),i=s+o*((n=1-l)-s),t){default:case 6:case 0:r=n,g=i,b=s;break;case 1:r=i,g=n,b=s;break;case 2:r=s,g=n,b=i;break;case 3:r=s,g=i,b=n;break;case 4:r=i,g=s,b=n;break;case 5:r=n,g=s,b=i}return[255*r,255*g,255*b]}function m(e){var t=e[1]/100,n=e[2]/100,o=e[3]/100;return[255*(1-Math.min(1,e[0]/100*(1-o)+o)),255*(1-Math.min(1,t*(1-o)+o)),255*(1-Math.min(1,n*(1-o)+o))]}function p(e){var t,n,o,i=e[0]/100,r=e[1]/100,a=e[2]/100;return n=-.9689*i+1.8758*r+.0415*a,o=.0557*i+-.204*r+1.057*a,t=(t=3.2406*i+-1.5372*r+-.4986*a)>.0031308?1.055*Math.pow(t,1/2.4)-.055:t*=12.92,n=n>.0031308?1.055*Math.pow(n,1/2.4)-.055:n*=12.92,o=o>.0031308?1.055*Math.pow(o,1/2.4)-.055:o*=12.92,[255*(t=Math.min(Math.max(0,t),1)),255*(n=Math.min(Math.max(0,n),1)),255*(o=Math.min(Math.max(0,o),1))]}function v(e){var t=e[0],n=e[1],o=e[2];return n/=100,o/=108.883,t=(t/=95.047)>.008856?Math.pow(t,1/3):7.787*t+16/116,[116*(n=n>.008856?Math.pow(n,1/3):7.787*n+16/116)-16,500*(t-n),200*(n-(o=o>.008856?Math.pow(o,1/3):7.787*o+16/116))]}function y(e){var t,n,o,i,r=e[0],a=e[1],s=e[2];return r<=8?i=(n=100*r/903.3)/100*7.787+16/116:(n=100*Math.pow((r+16)/116,3),i=Math.pow(n/100,1/3)),[t=t/95.047<=.008856?t=95.047*(a/500+i-16/116)/7.787:95.047*Math.pow(a/500+i,3),n,o=o/108.883<=.008859?o=108.883*(i-s/200-16/116)/7.787:108.883*Math.pow(i-s/200,3)]}function C(e){var t,n=e[0],o=e[1],i=e[2];return(t=360*Math.atan2(i,o)/2/Math.PI)<0&&(t+=360),[n,Math.sqrt(o*o+i*i),t]}function T(e){return p(y(e))}function x(e){var t,n=e[1];return t=e[2]/360*2*Math.PI,[e[0],n*Math.cos(t),n*Math.sin(t)]}function E(e){return _[e]}t.exports={rgb2hsl:o,rgb2hsv:i,rgb2hwb:a,rgb2cmyk:s,rgb2keyword:l,rgb2xyz:u,rgb2lab:c,rgb2lch:function(e){return C(c(e))},hsl2rgb:d,hsl2hsv:function(e){var t=e[1]/100,n=e[2]/100;return 0===n?[0,0,0]:[e[0],2*(t*=(n*=2)<=1?n:2-n)/(n+t)*100,(n+t)/2*100]},hsl2hwb:function(e){return a(d(e))},hsl2cmyk:function(e){return s(d(e))},hsl2keyword:function(e){return l(d(e))},hsv2rgb:f,hsv2hsl:function(e){var t,n,o=e[1]/100,i=e[2]/100;return t=o*i,[e[0],100*(t=(t/=(n=(2-o)*i)<=1?n:2-n)||0),100*(n/=2)]},hsv2hwb:function(e){return a(f(e))},hsv2cmyk:function(e){return s(f(e))},hsv2keyword:function(e){return l(f(e))},hwb2rgb:h,hwb2hsl:function(e){return o(h(e))},hwb2hsv:function(e){return i(h(e))},hwb2cmyk:function(e){return s(h(e))},hwb2keyword:function(e){return l(h(e))},cmyk2rgb:m,cmyk2hsl:function(e){return o(m(e))},cmyk2hsv:function(e){return i(m(e))},cmyk2hwb:function(e){return a(m(e))},cmyk2keyword:function(e){return l(m(e))},keyword2rgb:E,keyword2hsl:function(e){return o(E(e))},keyword2hsv:function(e){return i(E(e))},keyword2hwb:function(e){return a(E(e))},keyword2cmyk:function(e){return s(E(e))},keyword2lab:function(e){return c(E(e))},keyword2xyz:function(e){return u(E(e))},xyz2rgb:p,xyz2lab:v,xyz2lch:function(e){return C(v(e))},lab2xyz:y,lab2rgb:T,lab2lch:C,lch2lab:x,lch2xyz:function(e){return y(x(e))},lch2rgb:function(e){return T(x(e))}};var _={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},I={};for(var D in _)I[JSON.stringify(_[D])]=D},{}],5:[function(e,t,n){var o=e(4),i=function(){return new u};for(var r in o){i[r+"Raw"]=function(e){return function(t){return"number"==typeof t&&(t=Array.prototype.slice.call(arguments)),o[e](t)}}(r);var a=/(\w+)2(\w+)/.exec(r),s=a[1],l=a[2];(i[s]=i[s]||{})[l]=i[r]=function(e){return function(t){"number"==typeof t&&(t=Array.prototype.slice.call(arguments));var n=o[e](t);if("string"==typeof n||void 0===n)return n;for(var i=0;i<n.length;i++)n[i]=Math.round(n[i]);return n}}(r)}var u=function(){this.convs={}};u.prototype.routeSpace=function(e,t){var n=t[0];return void 0===n?this.getValues(e):("number"==typeof n&&(n=Array.prototype.slice.call(t)),this.setValues(e,n))},u.prototype.setValues=function(e,t){return this.space=e,this.convs={},this.convs[e]=t,this},u.prototype.getValues=function(e){var t=this.convs[e];if(!t){var n=this.space;t=i[n][e](this.convs[n]),this.convs[e]=t}return t},["rgb","hsl","hsv","cmyk","keyword"].forEach((function(e){u.prototype[e]=function(t){return this.routeSpace(e,arguments)}})),t.exports=i},{4:4}],6:[function(e,t,n){"use strict";t.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},{}],7:[function(e,t,n){var o=e(29)();o.helpers=e(45),e(27)(o),o.defaults=e(25),o.Element=e(26),o.elements=e(40),o.Interaction=e(28),o.platform=e(48),e(31)(o),e(22)(o),e(23)(o),e(24)(o),e(30)(o),e(33)(o),e(32)(o),e(35)(o),e(54)(o),e(52)(o),e(53)(o),e(55)(o),e(56)(o),e(57)(o),e(15)(o),e(16)(o),e(17)(o),e(18)(o),e(19)(o),e(20)(o),e(21)(o),e(8)(o),e(9)(o),e(10)(o),e(11)(o),e(12)(o),e(13)(o),e(14)(o);var i=[];i.push(e(49)(o),e(50)(o),e(51)(o)),o.plugins.register(i),o.platform.initialize(),t.exports=o,"undefined"!=typeof window&&(window.Chart=o),o.canvasHelpers=o.helpers.canvas},{10:10,11:11,12:12,13:13,14:14,15:15,16:16,17:17,18:18,19:19,20:20,21:21,22:22,23:23,24:24,25:25,26:26,27:27,28:28,29:29,30:30,31:31,32:32,33:33,35:35,40:40,45:45,48:48,49:49,50:50,51:51,52:52,53:53,54:54,55:55,56:56,57:57,8:8,9:9}],8:[function(e,t,n){"use strict";t.exports=function(e){e.Bar=function(t,n){return n.type="bar",new e(t,n)}}},{}],9:[function(e,t,n){"use strict";t.exports=function(e){e.Bubble=function(t,n){return n.type="bubble",new e(t,n)}}},{}],10:[function(e,t,n){"use strict";t.exports=function(e){e.Doughnut=function(t,n){return n.type="doughnut",new e(t,n)}}},{}],11:[function(e,t,n){"use strict";t.exports=function(e){e.Line=function(t,n){return n.type="line",new e(t,n)}}},{}],12:[function(e,t,n){"use strict";t.exports=function(e){e.PolarArea=function(t,n){return n.type="polarArea",new e(t,n)}}},{}],13:[function(e,t,n){"use strict";t.exports=function(e){e.Radar=function(t,n){return n.type="radar",new e(t,n)}}},{}],14:[function(e,t,n){"use strict";t.exports=function(e){e.Scatter=function(t,n){return n.type="scatter",new e(t,n)}}},{}],15:[function(e,t,n){"use strict";var o=e(25),i=e(40),r=e(45);o._set("bar",{hover:{mode:"label"},scales:{xAxes:[{type:"category",categoryPercentage:.8,barPercentage:.9,offset:!0,gridLines:{offsetGridLines:!0}}],yAxes:[{type:"linear"}]}}),o._set("horizontalBar",{hover:{mode:"index",axis:"y"},scales:{xAxes:[{type:"linear",position:"bottom"}],yAxes:[{position:"left",type:"category",categoryPercentage:.8,barPercentage:.9,offset:!0,gridLines:{offsetGridLines:!0}}]},elements:{rectangle:{borderSkipped:"left"}},tooltips:{callbacks:{title:function(e,t){var n="";return e.length>0&&(e[0].yLabel?n=e[0].yLabel:t.labels.length>0&&e[0].index<t.labels.length&&(n=t.labels[e[0].index])),n},label:function(e,t){return(t.datasets[e.datasetIndex].label||"")+": "+e.xLabel}},mode:"index",axis:"y"}}),t.exports=function(e){e.controllers.bar=e.DatasetController.extend({dataElementType:i.Rectangle,initialize:function(){var t,n=this;e.DatasetController.prototype.initialize.apply(n,arguments),(t=n.getMeta()).stack=n.getDataset().stack,t.bar=!0},update:function(e){var t,n,o=this,i=o.getMeta().data;for(o._ruler=o.getRuler(),t=0,n=i.length;t<n;++t)o.updateElement(i[t],t,e)},updateElement:function(e,t,n){var o=this,i=o.chart,a=o.getMeta(),s=o.getDataset(),l=e.custom||{},u=i.options.elements.rectangle;e._xScale=o.getScaleForId(a.xAxisID),e._yScale=o.getScaleForId(a.yAxisID),e._datasetIndex=o.index,e._index=t,e._model={datasetLabel:s.label,label:i.data.labels[t],borderSkipped:l.borderSkipped?l.borderSkipped:u.borderSkipped,backgroundColor:l.backgroundColor?l.backgroundColor:r.valueAtIndexOrDefault(s.backgroundColor,t,u.backgroundColor),borderColor:l.borderColor?l.borderColor:r.valueAtIndexOrDefault(s.borderColor,t,u.borderColor),borderWidth:l.borderWidth?l.borderWidth:r.valueAtIndexOrDefault(s.borderWidth,t,u.borderWidth)},o.updateElementGeometry(e,t,n),e.pivot()},updateElementGeometry:function(e,t,n){var o=this,i=e._model,r=o.getValueScale(),a=r.getBasePixel(),s=r.isHorizontal(),l=o._ruler||o.getRuler(),u=o.calculateBarValuePixels(o.index,t),c=o.calculateBarIndexPixels(o.index,t,l);i.horizontal=s,i.base=n?a:u.base,i.x=s?n?a:u.head:c.center,i.y=s?c.center:n?a:u.head,i.height=s?c.size:void 0,i.width=s?void 0:c.size},getValueScaleId:function(){return this.getMeta().yAxisID},getIndexScaleId:function(){return this.getMeta().xAxisID},getValueScale:function(){return this.getScaleForId(this.getValueScaleId())},getIndexScale:function(){return this.getScaleForId(this.getIndexScaleId())},getStackCount:function(e){var t,n,o=this.chart,i=this.getIndexScale().options.stacked,r=void 0===e?o.data.datasets.length:e+1,a=[];for(t=0;t<r;++t)(n=o.getDatasetMeta(t)).bar&&o.isDatasetVisible(t)&&(!1===i||!0===i&&-1===a.indexOf(n.stack)||void 0===i&&(void 0===n.stack||-1===a.indexOf(n.stack)))&&a.push(n.stack);return a.length},getStackIndex:function(e){return this.getStackCount(e)-1},getRuler:function(){var e,t,n=this,o=n.getIndexScale(),i=n.getStackCount(),r=n.index,a=[],s=o.isHorizontal(),l=s?o.left:o.top,u=l+(s?o.width:o.height);for(e=0,t=n.getMeta().data.length;e<t;++e)a.push(o.getPixelForValue(null,e,r));return{pixels:a,start:l,end:u,stackCount:i,scale:o}},calculateBarValuePixels:function(e,t){var n,o,i,r,a,s,l=this,u=l.chart,c=l.getMeta(),d=l.getValueScale(),f=u.data.datasets,h=d.getRightValue(f[e].data[t]),g=d.options.stacked,m=c.stack,p=0;if(g||void 0===g&&void 0!==m)for(n=0;n<e;++n)(o=u.getDatasetMeta(n)).bar&&o.stack===m&&o.controller.getValueScaleId()===d.id&&u.isDatasetVisible(n)&&(i=d.getRightValue(f[n].data[t]),(h<0&&i<0||h>=0&&i>0)&&(p+=i));return r=d.getPixelForValue(p),{size:s=((a=d.getPixelForValue(p+h))-r)/2,base:r,head:a,center:a+s/2}},calculateBarIndexPixels:function(e,t,n){var o,i,a,s,l,u=n.scale.options,c=this.getStackIndex(e),d=n.pixels,f=d[t],h=d.length,g=n.start,m=n.end;return 1===h?(o=f>g?f-g:m-f,i=f<m?m-f:f-g):(t>0&&(o=(f-d[t-1])/2,t===h-1&&(i=o)),t<h-1&&(i=(d[t+1]-f)/2,0===t&&(o=i))),l=(s=((a=o*u.categoryPercentage)+i*u.categoryPercentage)/n.stackCount)*u.barPercentage,f-=a,f+=s*c,{size:l=Math.min(r.valueOrDefault(u.barThickness,l),r.valueOrDefault(u.maxBarThickness,1/0)),base:f+=(s-l)/2,head:f+l,center:f+l/2}},draw:function(){var e=this,t=e.chart,n=e.getValueScale(),o=e.getMeta().data,i=e.getDataset(),a=o.length,s=0;for(r.canvas.clipArea(t.ctx,t.chartArea);s<a;++s)isNaN(n.getRightValue(i.data[s]))||o[s].draw();r.canvas.unclipArea(t.ctx)},setHoverStyle:function(e){var t=this.chart.data.datasets[e._datasetIndex],n=e._index,o=e.custom||{},i=e._model;i.backgroundColor=o.hoverBackgroundColor?o.hoverBackgroundColor:r.valueAtIndexOrDefault(t.hoverBackgroundColor,n,r.getHoverColor(i.backgroundColor)),i.borderColor=o.hoverBorderColor?o.hoverBorderColor:r.valueAtIndexOrDefault(t.hoverBorderColor,n,r.getHoverColor(i.borderColor)),i.borderWidth=o.hoverBorderWidth?o.hoverBorderWidth:r.valueAtIndexOrDefault(t.hoverBorderWidth,n,i.borderWidth)},removeHoverStyle:function(e){var t=this.chart.data.datasets[e._datasetIndex],n=e._index,o=e.custom||{},i=e._model,a=this.chart.options.elements.rectangle;i.backgroundColor=o.backgroundColor?o.backgroundColor:r.valueAtIndexOrDefault(t.backgroundColor,n,a.backgroundColor),i.borderColor=o.borderColor?o.borderColor:r.valueAtIndexOrDefault(t.borderColor,n,a.borderColor),i.borderWidth=o.borderWidth?o.borderWidth:r.valueAtIndexOrDefault(t.borderWidth,n,a.borderWidth)}}),e.controllers.horizontalBar=e.controllers.bar.extend({getValueScaleId:function(){return this.getMeta().xAxisID},getIndexScaleId:function(){return this.getMeta().yAxisID}})}},{25:25,40:40,45:45}],16:[function(e,t,n){"use strict";var o=e(25),i=e(40),r=e(45);o._set("bubble",{hover:{mode:"single"},scales:{xAxes:[{type:"linear",position:"bottom",id:"x-axis-0"}],yAxes:[{type:"linear",position:"left",id:"y-axis-0"}]},tooltips:{callbacks:{title:function(){return""},label:function(e,t){return(t.datasets[e.datasetIndex].label||"")+": ("+e.xLabel+", "+e.yLabel+", "+t.datasets[e.datasetIndex].data[e.index].r+")"}}}}),t.exports=function(e){e.controllers.bubble=e.DatasetController.extend({dataElementType:i.Point,update:function(e){var t=this,n=t.getMeta().data;r.each(n,(function(n,o){t.updateElement(n,o,e)}))},updateElement:function(e,t,n){var o=this,i=o.getMeta(),r=e.custom||{},a=o.getScaleForId(i.xAxisID),s=o.getScaleForId(i.yAxisID),l=o._resolveElementOptions(e,t),u=o.getDataset().data[t],c=o.index,d=n?a.getPixelForDecimal(.5):a.getPixelForValue("object"==typeof u?u:NaN,t,c),f=n?s.getBasePixel():s.getPixelForValue(u,t,c);e._xScale=a,e._yScale=s,e._options=l,e._datasetIndex=c,e._index=t,e._model={backgroundColor:l.backgroundColor,borderColor:l.borderColor,borderWidth:l.borderWidth,hitRadius:l.hitRadius,pointStyle:l.pointStyle,radius:n?0:l.radius,skip:r.skip||isNaN(d)||isNaN(f),x:d,y:f},e.pivot()},setHoverStyle:function(e){var t=e._model,n=e._options;t.backgroundColor=r.valueOrDefault(n.hoverBackgroundColor,r.getHoverColor(n.backgroundColor)),t.borderColor=r.valueOrDefault(n.hoverBorderColor,r.getHoverColor(n.borderColor)),t.borderWidth=r.valueOrDefault(n.hoverBorderWidth,n.borderWidth),t.radius=n.radius+n.hoverRadius},removeHoverStyle:function(e){var t=e._model,n=e._options;t.backgroundColor=n.backgroundColor,t.borderColor=n.borderColor,t.borderWidth=n.borderWidth,t.radius=n.radius},_resolveElementOptions:function(e,t){var n,o,i,a=this,s=a.chart,l=s.data.datasets[a.index],u=e.custom||{},c=s.options.elements.point,d=r.options.resolve,f=l.data[t],h={},g={chart:s,dataIndex:t,dataset:l,datasetIndex:a.index},m=["backgroundColor","borderColor","borderWidth","hoverBackgroundColor","hoverBorderColor","hoverBorderWidth","hoverRadius","hitRadius","pointStyle"];for(n=0,o=m.length;n<o;++n)h[i=m[n]]=d([u[i],l[i],c[i]],g,t);return h.radius=d([u.radius,f?f.r:void 0,l.radius,c.radius],g,t),h}})}},{25:25,40:40,45:45}],17:[function(e,t,n){"use strict";var o=e(25),i=e(40),r=e(45);o._set("doughnut",{animation:{animateRotate:!0,animateScale:!1},hover:{mode:"single"},legendCallback:function(e){var t=[];t.push('<ul class="'+e.id+'-legend">');var n=e.data,o=n.datasets,i=n.labels;if(o.length)for(var r=0;r<o[0].data.length;++r)t.push('<li><span style="background-color:'+o[0].backgroundColor[r]+'"></span>'),i[r]&&t.push(i[r]),t.push("</li>");return t.push("</ul>"),t.join("")},legend:{labels:{generateLabels:function(e){var t=e.data;return t.labels.length&&t.datasets.length?t.labels.map((function(n,o){var i=e.getDatasetMeta(0),a=t.datasets[0],s=i.data[o],l=s&&s.custom||{},u=r.valueAtIndexOrDefault,c=e.options.elements.arc;return{text:n,fillStyle:l.backgroundColor?l.backgroundColor:u(a.backgroundColor,o,c.backgroundColor),strokeStyle:l.borderColor?l.borderColor:u(a.borderColor,o,c.borderColor),lineWidth:l.borderWidth?l.borderWidth:u(a.borderWidth,o,c.borderWidth),hidden:isNaN(a.data[o])||i.data[o].hidden,index:o}})):[]}},onClick:function(e,t){var n,o,i,r=t.index,a=this.chart;for(n=0,o=(a.data.datasets||[]).length;n<o;++n)(i=a.getDatasetMeta(n)).data[r]&&(i.data[r].hidden=!i.data[r].hidden);a.update()}},cutoutPercentage:50,rotation:-.5*Math.PI,circumference:2*Math.PI,tooltips:{callbacks:{title:function(){return""},label:function(e,t){var n=t.labels[e.index],o=": "+t.datasets[e.datasetIndex].data[e.index];return r.isArray(n)?(n=n.slice())[0]+=o:n+=o,n}}}}),o._set("pie",r.clone(o.doughnut)),o._set("pie",{cutoutPercentage:0}),t.exports=function(e){e.controllers.doughnut=e.controllers.pie=e.DatasetController.extend({dataElementType:i.Arc,linkScales:r.noop,getRingIndex:function(e){for(var t=0,n=0;n<e;++n)this.chart.isDatasetVisible(n)&&++t;return t},update:function(e){var t=this,n=t.chart,o=n.chartArea,i=n.options,a=i.elements.arc,s=o.right-o.left-a.borderWidth,l=o.bottom-o.top-a.borderWidth,u=Math.min(s,l),c={x:0,y:0},d=t.getMeta(),f=i.cutoutPercentage,h=i.circumference;if(h<2*Math.PI){var g=i.rotation%(2*Math.PI),m=(g+=2*Math.PI*(g>=Math.PI?-1:g<-Math.PI?1:0))+h,p={x:Math.cos(g),y:Math.sin(g)},v={x:Math.cos(m),y:Math.sin(m)},y=g<=0&&m>=0||g<=2*Math.PI&&2*Math.PI<=m,b=g<=.5*Math.PI&&.5*Math.PI<=m||g<=2.5*Math.PI&&2.5*Math.PI<=m,C=g<=-Math.PI&&-Math.PI<=m||g<=Math.PI&&Math.PI<=m,T=g<=.5*-Math.PI&&.5*-Math.PI<=m||g<=1.5*Math.PI&&1.5*Math.PI<=m,x=f/100,E={x:C?-1:Math.min(p.x*(p.x<0?1:x),v.x*(v.x<0?1:x)),y:T?-1:Math.min(p.y*(p.y<0?1:x),v.y*(v.y<0?1:x))},_={x:y?1:Math.max(p.x*(p.x>0?1:x),v.x*(v.x>0?1:x)),y:b?1:Math.max(p.y*(p.y>0?1:x),v.y*(v.y>0?1:x))},I={width:.5*(_.x-E.x),height:.5*(_.y-E.y)};u=Math.min(s/I.width,l/I.height),c={x:-.5*(_.x+E.x),y:-.5*(_.y+E.y)}}n.borderWidth=t.getMaxBorderWidth(d.data),n.outerRadius=Math.max((u-n.borderWidth)/2,0),n.innerRadius=Math.max(f?n.outerRadius/100*f:0,0),n.radiusLength=(n.outerRadius-n.innerRadius)/n.getVisibleDatasetCount(),n.offsetX=c.x*n.outerRadius,n.offsetY=c.y*n.outerRadius,d.total=t.calculateTotal(),t.outerRadius=n.outerRadius-n.radiusLength*t.getRingIndex(t.index),t.innerRadius=Math.max(t.outerRadius-n.radiusLength,0),r.each(d.data,(function(n,o){t.updateElement(n,o,e)}))},updateElement:function(e,t,n){var o=this,i=o.chart,a=i.chartArea,s=i.options,l=s.animation,u=(a.left+a.right)/2,c=(a.top+a.bottom)/2,d=s.rotation,f=s.rotation,h=o.getDataset(),g=n&&l.animateRotate||e.hidden?0:o.calculateCircumference(h.data[t])*(s.circumference/(2*Math.PI));r.extend(e,{_datasetIndex:o.index,_index:t,_model:{x:u+i.offsetX,y:c+i.offsetY,startAngle:d,endAngle:f,circumference:g,outerRadius:n&&l.animateScale?0:o.outerRadius,innerRadius:n&&l.animateScale?0:o.innerRadius,label:(0,r.valueAtIndexOrDefault)(h.label,t,i.data.labels[t])}});var m=e._model;this.removeHoverStyle(e),n&&l.animateRotate||(m.startAngle=0===t?s.rotation:o.getMeta().data[t-1]._model.endAngle,m.endAngle=m.startAngle+m.circumference),e.pivot()},removeHoverStyle:function(t){e.DatasetController.prototype.removeHoverStyle.call(this,t,this.chart.options.elements.arc)},calculateTotal:function(){var e,t=this.getDataset(),n=this.getMeta(),o=0;return r.each(n.data,(function(n,i){e=t.data[i],isNaN(e)||n.hidden||(o+=Math.abs(e))})),o},calculateCircumference:function(e){var t=this.getMeta().total;return t>0&&!isNaN(e)?2*Math.PI*(e/t):0},getMaxBorderWidth:function(e){for(var t,n,o=0,i=this.index,r=e.length,a=0;a<r;a++)o=(n=e[a]._chart?e[a]._chart.config.data.datasets[i].hoverBorderWidth:0)>(o=(t=e[a]._model?e[a]._model.borderWidth:0)>o?t:o)?n:o;return o}})}},{25:25,40:40,45:45}],18:[function(e,t,n){"use strict";var o=e(25),i=e(40),r=e(45);o._set("line",{showLines:!0,spanGaps:!1,hover:{mode:"label"},scales:{xAxes:[{type:"category",id:"x-axis-0"}],yAxes:[{type:"linear",id:"y-axis-0"}]}}),t.exports=function(e){function t(e,t){return r.valueOrDefault(e.showLine,t.showLines)}e.controllers.line=e.DatasetController.extend({datasetElementType:i.Line,dataElementType:i.Point,update:function(e){var n,o,i,a=this,s=a.getMeta(),l=s.dataset,u=s.data||[],c=a.chart.options,d=c.elements.line,f=a.getScaleForId(s.yAxisID),h=a.getDataset(),g=t(h,c);for(g&&(i=l.custom||{},void 0!==h.tension&&void 0===h.lineTension&&(h.lineTension=h.tension),l._scale=f,l._datasetIndex=a.index,l._children=u,l._model={spanGaps:h.spanGaps?h.spanGaps:c.spanGaps,tension:i.tension?i.tension:r.valueOrDefault(h.lineTension,d.tension),backgroundColor:i.backgroundColor?i.backgroundColor:h.backgroundColor||d.backgroundColor,borderWidth:i.borderWidth?i.borderWidth:h.borderWidth||d.borderWidth,borderColor:i.borderColor?i.borderColor:h.borderColor||d.borderColor,borderCapStyle:i.borderCapStyle?i.borderCapStyle:h.borderCapStyle||d.borderCapStyle,borderDash:i.borderDash?i.borderDash:h.borderDash||d.borderDash,borderDashOffset:i.borderDashOffset?i.borderDashOffset:h.borderDashOffset||d.borderDashOffset,borderJoinStyle:i.borderJoinStyle?i.borderJoinStyle:h.borderJoinStyle||d.borderJoinStyle,fill:i.fill?i.fill:void 0!==h.fill?h.fill:d.fill,steppedLine:i.steppedLine?i.steppedLine:r.valueOrDefault(h.steppedLine,d.stepped),cubicInterpolationMode:i.cubicInterpolationMode?i.cubicInterpolationMode:r.valueOrDefault(h.cubicInterpolationMode,d.cubicInterpolationMode)},l.pivot()),n=0,o=u.length;n<o;++n)a.updateElement(u[n],n,e);for(g&&0!==l._model.tension&&a.updateBezierControlPoints(),n=0,o=u.length;n<o;++n)u[n].pivot()},getPointBackgroundColor:function(e,t){var n=this.chart.options.elements.point.backgroundColor,o=this.getDataset(),i=e.custom||{};return i.backgroundColor?n=i.backgroundColor:o.pointBackgroundColor?n=r.valueAtIndexOrDefault(o.pointBackgroundColor,t,n):o.backgroundColor&&(n=o.backgroundColor),n},getPointBorderColor:function(e,t){var n=this.chart.options.elements.point.borderColor,o=this.getDataset(),i=e.custom||{};return i.borderColor?n=i.borderColor:o.pointBorderColor?n=r.valueAtIndexOrDefault(o.pointBorderColor,t,n):o.borderColor&&(n=o.borderColor),n},getPointBorderWidth:function(e,t){var n=this.chart.options.elements.point.borderWidth,o=this.getDataset(),i=e.custom||{};return isNaN(i.borderWidth)?!isNaN(o.pointBorderWidth)||r.isArray(o.pointBorderWidth)?n=r.valueAtIndexOrDefault(o.pointBorderWidth,t,n):isNaN(o.borderWidth)||(n=o.borderWidth):n=i.borderWidth,n},updateElement:function(e,t,n){var o,i,a=this,s=a.getMeta(),l=e.custom||{},u=a.getDataset(),c=a.index,d=u.data[t],f=a.getScaleForId(s.yAxisID),h=a.getScaleForId(s.xAxisID),g=a.chart.options.elements.point;void 0!==u.radius&&void 0===u.pointRadius&&(u.pointRadius=u.radius),void 0!==u.hitRadius&&void 0===u.pointHitRadius&&(u.pointHitRadius=u.hitRadius),o=h.getPixelForValue("object"==typeof d?d:NaN,t,c),i=n?f.getBasePixel():a.calculatePointY(d,t,c),e._xScale=h,e._yScale=f,e._datasetIndex=c,e._index=t,e._model={x:o,y:i,skip:l.skip||isNaN(o)||isNaN(i),radius:l.radius||r.valueAtIndexOrDefault(u.pointRadius,t,g.radius),pointStyle:l.pointStyle||r.valueAtIndexOrDefault(u.pointStyle,t,g.pointStyle),backgroundColor:a.getPointBackgroundColor(e,t),borderColor:a.getPointBorderColor(e,t),borderWidth:a.getPointBorderWidth(e,t),tension:s.dataset._model?s.dataset._model.tension:0,steppedLine:!!s.dataset._model&&s.dataset._model.steppedLine,hitRadius:l.hitRadius||r.valueAtIndexOrDefault(u.pointHitRadius,t,g.hitRadius)}},calculatePointY:function(e,t,n){var o,i,r,a=this,s=a.chart,l=a.getMeta(),u=a.getScaleForId(l.yAxisID),c=0,d=0;if(u.options.stacked){for(o=0;o<n;o++)if(i=s.data.datasets[o],"line"===(r=s.getDatasetMeta(o)).type&&r.yAxisID===u.id&&s.isDatasetVisible(o)){var f=Number(u.getRightValue(i.data[t]));f<0?d+=f||0:c+=f||0}var h=Number(u.getRightValue(e));return u.getPixelForValue(h<0?d+h:c+h)}return u.getPixelForValue(e)},updateBezierControlPoints:function(){function e(e,t,n){return Math.max(Math.min(e,n),t)}var t,n,o,i,a=this,s=a.getMeta(),l=a.chart.chartArea,u=s.data||[];if(s.dataset._model.spanGaps&&(u=u.filter((function(e){return!e._model.skip}))),"monotone"===s.dataset._model.cubicInterpolationMode)r.splineCurveMonotone(u);else for(t=0,n=u.length;t<n;++t)o=u[t]._model,i=r.splineCurve(r.previousItem(u,t)._model,o,r.nextItem(u,t)._model,s.dataset._model.tension),o.controlPointPreviousX=i.previous.x,o.controlPointPreviousY=i.previous.y,o.controlPointNextX=i.next.x,o.controlPointNextY=i.next.y;if(a.chart.options.elements.line.capBezierPoints)for(t=0,n=u.length;t<n;++t)(o=u[t]._model).controlPointPreviousX=e(o.controlPointPreviousX,l.left,l.right),o.controlPointPreviousY=e(o.controlPointPreviousY,l.top,l.bottom),o.controlPointNextX=e(o.controlPointNextX,l.left,l.right),o.controlPointNextY=e(o.controlPointNextY,l.top,l.bottom)},draw:function(){var e=this,n=e.chart,o=e.getMeta(),i=o.data||[],a=n.chartArea,s=i.length,l=0;for(r.canvas.clipArea(n.ctx,a),t(e.getDataset(),n.options)&&o.dataset.draw(),r.canvas.unclipArea(n.ctx);l<s;++l)i[l].draw(a)},setHoverStyle:function(e){var t=this.chart.data.datasets[e._datasetIndex],n=e._index,o=e.custom||{},i=e._model;i.radius=o.hoverRadius||r.valueAtIndexOrDefault(t.pointHoverRadius,n,this.chart.options.elements.point.hoverRadius),i.backgroundColor=o.hoverBackgroundColor||r.valueAtIndexOrDefault(t.pointHoverBackgroundColor,n,r.getHoverColor(i.backgroundColor)),i.borderColor=o.hoverBorderColor||r.valueAtIndexOrDefault(t.pointHoverBorderColor,n,r.getHoverColor(i.borderColor)),i.borderWidth=o.hoverBorderWidth||r.valueAtIndexOrDefault(t.pointHoverBorderWidth,n,i.borderWidth)},removeHoverStyle:function(e){var t=this,n=t.chart.data.datasets[e._datasetIndex],o=e._index,i=e.custom||{},a=e._model;void 0!==n.radius&&void 0===n.pointRadius&&(n.pointRadius=n.radius),a.radius=i.radius||r.valueAtIndexOrDefault(n.pointRadius,o,t.chart.options.elements.point.radius),a.backgroundColor=t.getPointBackgroundColor(e,o),a.borderColor=t.getPointBorderColor(e,o),a.borderWidth=t.getPointBorderWidth(e,o)}})}},{25:25,40:40,45:45}],19:[function(e,t,n){"use strict";var o=e(25),i=e(40),r=e(45);o._set("polarArea",{scale:{type:"radialLinear",angleLines:{display:!1},gridLines:{circular:!0},pointLabels:{display:!1},ticks:{beginAtZero:!0}},animation:{animateRotate:!0,animateScale:!0},startAngle:-.5*Math.PI,legendCallback:function(e){var t=[];t.push('<ul class="'+e.id+'-legend">');var n=e.data,o=n.datasets,i=n.labels;if(o.length)for(var r=0;r<o[0].data.length;++r)t.push('<li><span style="background-color:'+o[0].backgroundColor[r]+'"></span>'),i[r]&&t.push(i[r]),t.push("</li>");return t.push("</ul>"),t.join("")},legend:{labels:{generateLabels:function(e){var t=e.data;return t.labels.length&&t.datasets.length?t.labels.map((function(n,o){var i=e.getDatasetMeta(0),a=t.datasets[0],s=i.data[o].custom||{},l=r.valueAtIndexOrDefault,u=e.options.elements.arc;return{text:n,fillStyle:s.backgroundColor?s.backgroundColor:l(a.backgroundColor,o,u.backgroundColor),strokeStyle:s.borderColor?s.borderColor:l(a.borderColor,o,u.borderColor),lineWidth:s.borderWidth?s.borderWidth:l(a.borderWidth,o,u.borderWidth),hidden:isNaN(a.data[o])||i.data[o].hidden,index:o}})):[]}},onClick:function(e,t){var n,o,i,r=t.index,a=this.chart;for(n=0,o=(a.data.datasets||[]).length;n<o;++n)(i=a.getDatasetMeta(n)).data[r].hidden=!i.data[r].hidden;a.update()}},tooltips:{callbacks:{title:function(){return""},label:function(e,t){return t.labels[e.index]+": "+e.yLabel}}}}),t.exports=function(e){e.controllers.polarArea=e.DatasetController.extend({dataElementType:i.Arc,linkScales:r.noop,update:function(e){var t=this,n=t.chart,o=n.chartArea,i=t.getMeta(),a=n.options,s=a.elements.arc,l=Math.min(o.right-o.left,o.bottom-o.top);n.outerRadius=Math.max((l-s.borderWidth/2)/2,0),n.innerRadius=Math.max(a.cutoutPercentage?n.outerRadius/100*a.cutoutPercentage:1,0),n.radiusLength=(n.outerRadius-n.innerRadius)/n.getVisibleDatasetCount(),t.outerRadius=n.outerRadius-n.radiusLength*t.index,t.innerRadius=t.outerRadius-n.radiusLength,i.count=t.countVisibleElements(),r.each(i.data,(function(n,o){t.updateElement(n,o,e)}))},updateElement:function(e,t,n){for(var o=this,i=o.chart,a=o.getDataset(),s=i.options,l=s.animation,u=i.scale,c=i.data.labels,d=o.calculateCircumference(a.data[t]),f=u.xCenter,h=u.yCenter,g=0,m=o.getMeta(),p=0;p<t;++p)isNaN(a.data[p])||m.data[p].hidden||++g;var v=s.startAngle,y=e.hidden?0:u.getDistanceFromCenterForValue(a.data[t]),b=v+d*g,C=b+(e.hidden?0:d),T=l.animateScale?0:u.getDistanceFromCenterForValue(a.data[t]);r.extend(e,{_datasetIndex:o.index,_index:t,_scale:u,_model:{x:f,y:h,innerRadius:0,outerRadius:n?T:y,startAngle:n&&l.animateRotate?v:b,endAngle:n&&l.animateRotate?v:C,label:r.valueAtIndexOrDefault(c,t,c[t])}}),o.removeHoverStyle(e),e.pivot()},removeHoverStyle:function(t){e.DatasetController.prototype.removeHoverStyle.call(this,t,this.chart.options.elements.arc)},countVisibleElements:function(){var e=this.getDataset(),t=this.getMeta(),n=0;return r.each(t.data,(function(t,o){isNaN(e.data[o])||t.hidden||n++})),n},calculateCircumference:function(e){var t=this.getMeta().count;return t>0&&!isNaN(e)?2*Math.PI/t:0}})}},{25:25,40:40,45:45}],20:[function(e,t,n){"use strict";var o=e(25),i=e(40),r=e(45);o._set("radar",{scale:{type:"radialLinear"},elements:{line:{tension:0}}}),t.exports=function(e){e.controllers.radar=e.DatasetController.extend({datasetElementType:i.Line,dataElementType:i.Point,linkScales:r.noop,update:function(e){var t=this,n=t.getMeta(),o=n.data,i=n.dataset.custom||{},a=t.getDataset(),s=t.chart.options.elements.line,l=t.chart.scale;void 0!==a.tension&&void 0===a.lineTension&&(a.lineTension=a.tension),r.extend(n.dataset,{_datasetIndex:t.index,_scale:l,_children:o,_loop:!0,_model:{tension:i.tension?i.tension:r.valueOrDefault(a.lineTension,s.tension),backgroundColor:i.backgroundColor?i.backgroundColor:a.backgroundColor||s.backgroundColor,borderWidth:i.borderWidth?i.borderWidth:a.borderWidth||s.borderWidth,borderColor:i.borderColor?i.borderColor:a.borderColor||s.borderColor,fill:i.fill?i.fill:void 0!==a.fill?a.fill:s.fill,borderCapStyle:i.borderCapStyle?i.borderCapStyle:a.borderCapStyle||s.borderCapStyle,borderDash:i.borderDash?i.borderDash:a.borderDash||s.borderDash,borderDashOffset:i.borderDashOffset?i.borderDashOffset:a.borderDashOffset||s.borderDashOffset,borderJoinStyle:i.borderJoinStyle?i.borderJoinStyle:a.borderJoinStyle||s.borderJoinStyle}}),n.dataset.pivot(),r.each(o,(function(n,o){t.updateElement(n,o,e)}),t),t.updateBezierControlPoints()},updateElement:function(e,t,n){var o=this,i=e.custom||{},a=o.getDataset(),s=o.chart.scale,l=o.chart.options.elements.point,u=s.getPointPositionForValue(t,a.data[t]);void 0!==a.radius&&void 0===a.pointRadius&&(a.pointRadius=a.radius),void 0!==a.hitRadius&&void 0===a.pointHitRadius&&(a.pointHitRadius=a.hitRadius),r.extend(e,{_datasetIndex:o.index,_index:t,_scale:s,_model:{x:n?s.xCenter:u.x,y:n?s.yCenter:u.y,tension:i.tension?i.tension:r.valueOrDefault(a.lineTension,o.chart.options.elements.line.tension),radius:i.radius?i.radius:r.valueAtIndexOrDefault(a.pointRadius,t,l.radius),backgroundColor:i.backgroundColor?i.backgroundColor:r.valueAtIndexOrDefault(a.pointBackgroundColor,t,l.backgroundColor),borderColor:i.borderColor?i.borderColor:r.valueAtIndexOrDefault(a.pointBorderColor,t,l.borderColor),borderWidth:i.borderWidth?i.borderWidth:r.valueAtIndexOrDefault(a.pointBorderWidth,t,l.borderWidth),pointStyle:i.pointStyle?i.pointStyle:r.valueAtIndexOrDefault(a.pointStyle,t,l.pointStyle),hitRadius:i.hitRadius?i.hitRadius:r.valueAtIndexOrDefault(a.pointHitRadius,t,l.hitRadius)}}),e._model.skip=i.skip?i.skip:isNaN(e._model.x)||isNaN(e._model.y)},updateBezierControlPoints:function(){var e=this.chart.chartArea,t=this.getMeta();r.each(t.data,(function(n,o){var i=n._model,a=r.splineCurve(r.previousItem(t.data,o,!0)._model,i,r.nextItem(t.data,o,!0)._model,i.tension);i.controlPointPreviousX=Math.max(Math.min(a.previous.x,e.right),e.left),i.controlPointPreviousY=Math.max(Math.min(a.previous.y,e.bottom),e.top),i.controlPointNextX=Math.max(Math.min(a.next.x,e.right),e.left),i.controlPointNextY=Math.max(Math.min(a.next.y,e.bottom),e.top),n.pivot()}))},setHoverStyle:function(e){var t=this.chart.data.datasets[e._datasetIndex],n=e.custom||{},o=e._index,i=e._model;i.radius=n.hoverRadius?n.hoverRadius:r.valueAtIndexOrDefault(t.pointHoverRadius,o,this.chart.options.elements.point.hoverRadius),i.backgroundColor=n.hoverBackgroundColor?n.hoverBackgroundColor:r.valueAtIndexOrDefault(t.pointHoverBackgroundColor,o,r.getHoverColor(i.backgroundColor)),i.borderColor=n.hoverBorderColor?n.hoverBorderColor:r.valueAtIndexOrDefault(t.pointHoverBorderColor,o,r.getHoverColor(i.borderColor)),i.borderWidth=n.hoverBorderWidth?n.hoverBorderWidth:r.valueAtIndexOrDefault(t.pointHoverBorderWidth,o,i.borderWidth)},removeHoverStyle:function(e){var t=this.chart.data.datasets[e._datasetIndex],n=e.custom||{},o=e._index,i=e._model,a=this.chart.options.elements.point;i.radius=n.radius?n.radius:r.valueAtIndexOrDefault(t.pointRadius,o,a.radius),i.backgroundColor=n.backgroundColor?n.backgroundColor:r.valueAtIndexOrDefault(t.pointBackgroundColor,o,a.backgroundColor),i.borderColor=n.borderColor?n.borderColor:r.valueAtIndexOrDefault(t.pointBorderColor,o,a.borderColor),i.borderWidth=n.borderWidth?n.borderWidth:r.valueAtIndexOrDefault(t.pointBorderWidth,o,a.borderWidth)}})}},{25:25,40:40,45:45}],21:[function(e,t,n){"use strict";e(25)._set("scatter",{hover:{mode:"single"},scales:{xAxes:[{id:"x-axis-1",type:"linear",position:"bottom"}],yAxes:[{id:"y-axis-1",type:"linear",position:"left"}]},showLines:!1,tooltips:{callbacks:{title:function(){return""},label:function(e){return"("+e.xLabel+", "+e.yLabel+")"}}}}),t.exports=function(e){e.controllers.scatter=e.controllers.line}},{25:25}],22:[function(e,t,n){"use strict";var o=e(25),i=e(26),r=e(45);o._set("global",{animation:{duration:1e3,easing:"easeOutQuart",onProgress:r.noop,onComplete:r.noop}}),t.exports=function(e){e.Animation=i.extend({chart:null,currentStep:0,numSteps:60,easing:"",render:null,onAnimationProgress:null,onAnimationComplete:null}),e.animationService={frameDuration:17,animations:[],dropFrames:0,request:null,addAnimation:function(e,t,n,o){var i,r,a=this.animations;for(t.chart=e,o||(e.animating=!0),i=0,r=a.length;i<r;++i)if(a[i].chart===e)return void(a[i]=t);a.push(t),1===a.length&&this.requestAnimationFrame()},cancelAnimation:function(e){var t=r.findIndex(this.animations,(function(t){return t.chart===e}));-1!==t&&(this.animations.splice(t,1),e.animating=!1)},requestAnimationFrame:function(){var e=this;null===e.request&&(e.request=r.requestAnimFrame.call(window,(function(){e.request=null,e.startDigest()})))},startDigest:function(){var e=this,t=Date.now(),n=0;e.dropFrames>1&&(n=Math.floor(e.dropFrames),e.dropFrames=e.dropFrames%1),e.advance(1+n);var o=Date.now();e.dropFrames+=(o-t)/e.frameDuration,e.animations.length>0&&e.requestAnimationFrame()},advance:function(e){for(var t,n,o=this.animations,i=0;i<o.length;)n=(t=o[i]).chart,t.currentStep=(t.currentStep||0)+e,t.currentStep=Math.min(t.currentStep,t.numSteps),r.callback(t.render,[n,t],n),r.callback(t.onAnimationProgress,[t],n),t.currentStep>=t.numSteps?(r.callback(t.onAnimationComplete,[t],n),n.animating=!1,o.splice(i,1)):++i}},Object.defineProperty(e.Animation.prototype,"animationObject",{get:function(){return this}}),Object.defineProperty(e.Animation.prototype,"chartInstance",{get:function(){return this.chart},set:function(e){this.chart=e}})}},{25:25,26:26,45:45}],23:[function(e,t,n){"use strict";var o=e(25),i=e(45),r=e(28),a=e(48);t.exports=function(e){function t(e){var t=(e=e||{}).data=e.data||{};return t.datasets=t.datasets||[],t.labels=t.labels||[],e.options=i.configMerge(o.global,o[e.type],e.options||{}),e}function n(e){var t=e.options;t.scale?e.scale.options=t.scale:t.scales&&t.scales.xAxes.concat(t.scales.yAxes).forEach((function(t){e.scales[t.id].options=t})),e.tooltip._options=t.tooltips}function s(e){return"top"===e||"bottom"===e}var l=e.plugins;e.types={},e.instances={},e.controllers={},i.extend(e.prototype,{construct:function(n,o){var r=this;o=t(o);var s=a.acquireContext(n,o),l=s&&s.canvas,u=l&&l.height,c=l&&l.width;r.id=i.uid(),r.ctx=s,r.canvas=l,r.config=o,r.width=c,r.height=u,r.aspectRatio=u?c/u:null,r.options=o.options,r._bufferedRender=!1,r.chart=r,r.controller=r,e.instances[r.id]=r,Object.defineProperty(r,"data",{get:function(){return r.config.data},set:function(e){r.config.data=e}}),s&&l?(r.initialize(),r.update()):console.error("Failed to create chart: can't acquire context from the given item")},initialize:function(){var e=this;return l.notify(e,"beforeInit"),i.retinaScale(e,e.options.devicePixelRatio),e.bindEvents(),e.options.responsive&&e.resize(!0),e.ensureScalesHaveIDs(),e.buildScales(),e.initToolTip(),l.notify(e,"afterInit"),e},clear:function(){return i.canvas.clear(this),this},stop:function(){return e.animationService.cancelAnimation(this),this},resize:function(e){var t=this,n=t.options,o=t.canvas,r=n.maintainAspectRatio&&t.aspectRatio||null,a=Math.max(0,Math.floor(i.getMaximumWidth(o))),s=Math.max(0,Math.floor(r?a/r:i.getMaximumHeight(o)));if((t.width!==a||t.height!==s)&&(o.width=t.width=a,o.height=t.height=s,o.style.width=a+"px",o.style.height=s+"px",i.retinaScale(t,n.devicePixelRatio),!e)){var u={width:a,height:s};l.notify(t,"resize",[u]),t.options.onResize&&t.options.onResize(t,u),t.stop(),t.update(t.options.responsiveAnimationDuration)}},ensureScalesHaveIDs:function(){var e=this.options,t=e.scales||{},n=e.scale;i.each(t.xAxes,(function(e,t){e.id=e.id||"x-axis-"+t})),i.each(t.yAxes,(function(e,t){e.id=e.id||"y-axis-"+t})),n&&(n.id=n.id||"scale")},buildScales:function(){var t=this,n=t.options,o=t.scales={},r=[];n.scales&&(r=r.concat((n.scales.xAxes||[]).map((function(e){return{options:e,dtype:"category",dposition:"bottom"}})),(n.scales.yAxes||[]).map((function(e){return{options:e,dtype:"linear",dposition:"left"}})))),n.scale&&r.push({options:n.scale,dtype:"radialLinear",isDefault:!0,dposition:"chartArea"}),i.each(r,(function(n){var r=n.options,a=i.valueOrDefault(r.type,n.dtype),l=e.scaleService.getScaleConstructor(a);if(l){s(r.position)!==s(n.dposition)&&(r.position=n.dposition);var u=new l({id:r.id,options:r,ctx:t.ctx,chart:t});o[u.id]=u,u.mergeTicksOptions(),n.isDefault&&(t.scale=u)}})),e.scaleService.addScalesToLayout(this)},buildOrUpdateControllers:function(){var t=this,n=[],o=[];return i.each(t.data.datasets,(function(i,r){var a=t.getDatasetMeta(r),s=i.type||t.config.type;if(a.type&&a.type!==s&&(t.destroyDatasetMeta(r),a=t.getDatasetMeta(r)),a.type=s,n.push(a.type),a.controller)a.controller.updateIndex(r);else{var l=e.controllers[a.type];if(void 0===l)throw new Error('"'+a.type+'" is not a chart type.');a.controller=new l(t,r),o.push(a.controller)}}),t),o},resetElements:function(){var e=this;i.each(e.data.datasets,(function(t,n){e.getDatasetMeta(n).controller.reset()}),e)},reset:function(){this.resetElements(),this.tooltip.initialize()},update:function(e){var t=this;if(e&&"object"==typeof e||(e={duration:e,lazy:arguments[1]}),n(t),!1!==l.notify(t,"beforeUpdate")){t.tooltip._data=t.data;var o=t.buildOrUpdateControllers();i.each(t.data.datasets,(function(e,n){t.getDatasetMeta(n).controller.buildOrUpdateElements()}),t),t.updateLayout(),i.each(o,(function(e){e.reset()})),t.updateDatasets(),t.tooltip.initialize(),t.lastActive=[],l.notify(t,"afterUpdate"),t._bufferedRender?t._bufferedRequest={duration:e.duration,easing:e.easing,lazy:e.lazy}:t.render(e)}},updateLayout:function(){var t=this;!1!==l.notify(t,"beforeLayout")&&(e.layoutService.update(this,this.width,this.height),l.notify(t,"afterScaleUpdate"),l.notify(t,"afterLayout"))},updateDatasets:function(){var e=this;if(!1!==l.notify(e,"beforeDatasetsUpdate")){for(var t=0,n=e.data.datasets.length;t<n;++t)e.updateDataset(t);l.notify(e,"afterDatasetsUpdate")}},updateDataset:function(e){var t=this,n=t.getDatasetMeta(e),o={meta:n,index:e};!1!==l.notify(t,"beforeDatasetUpdate",[o])&&(n.controller.update(),l.notify(t,"afterDatasetUpdate",[o]))},render:function(t){var n=this;t&&"object"==typeof t||(t={duration:t,lazy:arguments[1]});var o=t.duration,r=t.lazy;if(!1!==l.notify(n,"beforeRender")){var a=n.options.animation,s=function(e){l.notify(n,"afterRender"),i.callback(a&&a.onComplete,[e],n)};if(a&&(void 0!==o&&0!==o||void 0===o&&0!==a.duration)){var u=new e.Animation({numSteps:(o||a.duration)/16.66,easing:t.easing||a.easing,render:function(e,t){var n=t.currentStep,o=n/t.numSteps;e.draw((0,i.easing.effects[t.easing])(o),o,n)},onAnimationProgress:a.onProgress,onAnimationComplete:s});e.animationService.addAnimation(n,u,o,r)}else n.draw(),s(new e.Animation({numSteps:0,chart:n}));return n}},draw:function(e){var t=this;t.clear(),i.isNullOrUndef(e)&&(e=1),t.transition(e),!1!==l.notify(t,"beforeDraw",[e])&&(i.each(t.boxes,(function(e){e.draw(t.chartArea)}),t),t.scale&&t.scale.draw(),t.drawDatasets(e),t._drawTooltip(e),l.notify(t,"afterDraw",[e]))},transition:function(e){for(var t=this,n=0,o=(t.data.datasets||[]).length;n<o;++n)t.isDatasetVisible(n)&&t.getDatasetMeta(n).controller.transition(e);t.tooltip.transition(e)},drawDatasets:function(e){var t=this;if(!1!==l.notify(t,"beforeDatasetsDraw",[e])){for(var n=(t.data.datasets||[]).length-1;n>=0;--n)t.isDatasetVisible(n)&&t.drawDataset(n,e);l.notify(t,"afterDatasetsDraw",[e])}},drawDataset:function(e,t){var n=this,o=n.getDatasetMeta(e),i={meta:o,index:e,easingValue:t};!1!==l.notify(n,"beforeDatasetDraw",[i])&&(o.controller.draw(t),l.notify(n,"afterDatasetDraw",[i]))},_drawTooltip:function(e){var t=this,n=t.tooltip,o={tooltip:n,easingValue:e};!1!==l.notify(t,"beforeTooltipDraw",[o])&&(n.draw(),l.notify(t,"afterTooltipDraw",[o]))},getElementAtEvent:function(e){return r.modes.single(this,e)},getElementsAtEvent:function(e){return r.modes.label(this,e,{intersect:!0})},getElementsAtXAxis:function(e){return r.modes["x-axis"](this,e,{intersect:!0})},getElementsAtEventForMode:function(e,t,n){var o=r.modes[t];return"function"==typeof o?o(this,e,n):[]},getDatasetAtEvent:function(e){return r.modes.dataset(this,e,{intersect:!0})},getDatasetMeta:function(e){var t=this,n=t.data.datasets[e];n._meta||(n._meta={});var o=n._meta[t.id];return o||(o=n._meta[t.id]={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null}),o},getVisibleDatasetCount:function(){for(var e=0,t=0,n=this.data.datasets.length;t<n;++t)this.isDatasetVisible(t)&&e++;return e},isDatasetVisible:function(e){var t=this.getDatasetMeta(e);return"boolean"==typeof t.hidden?!t.hidden:!this.data.datasets[e].hidden},generateLegend:function(){return this.options.legendCallback(this)},destroyDatasetMeta:function(e){var t=this.id,n=this.data.datasets[e],o=n._meta&&n._meta[t];o&&(o.controller.destroy(),delete n._meta[t])},destroy:function(){var t,n,o=this,r=o.canvas;for(o.stop(),t=0,n=o.data.datasets.length;t<n;++t)o.destroyDatasetMeta(t);r&&(o.unbindEvents(),i.canvas.clear(o),a.releaseContext(o.ctx),o.canvas=null,o.ctx=null),l.notify(o,"destroy"),delete e.instances[o.id]},toBase64Image:function(){return this.canvas.toDataURL.apply(this.canvas,arguments)},initToolTip:function(){var t=this;t.tooltip=new e.Tooltip({_chart:t,_chartInstance:t,_data:t.data,_options:t.options.tooltips},t)},bindEvents:function(){var e=this,t=e._listeners={},n=function(){e.eventHandler.apply(e,arguments)};i.each(e.options.events,(function(o){a.addEventListener(e,o,n),t[o]=n})),e.options.responsive&&(n=function(){e.resize()},a.addEventListener(e,"resize",n),t.resize=n)},unbindEvents:function(){var e=this,t=e._listeners;t&&(delete e._listeners,i.each(t,(function(t,n){a.removeEventListener(e,n,t)})))},updateHoverStyle:function(e,t,n){var o,i,r,a=n?"setHoverStyle":"removeHoverStyle";for(i=0,r=e.length;i<r;++i)(o=e[i])&&this.getDatasetMeta(o._datasetIndex).controller[a](o)},eventHandler:function(e){var t=this,n=t.tooltip;if(!1!==l.notify(t,"beforeEvent",[e])){t._bufferedRender=!0,t._bufferedRequest=null;var o=t.handleEvent(e);o|=n&&n.handleEvent(e),l.notify(t,"afterEvent",[e]);var i=t._bufferedRequest;return i?t.render(i):o&&!t.animating&&(t.stop(),t.render(t.options.hover.animationDuration,!0)),t._bufferedRender=!1,t._bufferedRequest=null,t}},handleEvent:function(e){var t,n=this,o=n.options||{},r=o.hover;return n.lastActive=n.lastActive||[],n.active="mouseout"===e.type?[]:n.getElementsAtEventForMode(e,r.mode,r),i.callback(o.onHover||o.hover.onHover,[e.native,n.active],n),"mouseup"!==e.type&&"click"!==e.type||o.onClick&&o.onClick.call(n,e.native,n.active),n.lastActive.length&&n.updateHoverStyle(n.lastActive,r.mode,!1),n.active.length&&r.mode&&n.updateHoverStyle(n.active,r.mode,!0),t=!i.arrayEquals(n.active,n.lastActive),n.lastActive=n.active,t}}),e.Controller=e}},{25:25,28:28,45:45,48:48}],24:[function(e,t,n){"use strict";var o=e(45);t.exports=function(e){function t(e,t){e._chartjs?e._chartjs.listeners.push(t):(Object.defineProperty(e,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[t]}}),i.forEach((function(t){var n="onData"+t.charAt(0).toUpperCase()+t.slice(1),i=e[t];Object.defineProperty(e,t,{configurable:!0,enumerable:!1,value:function(){var t=Array.prototype.slice.call(arguments),r=i.apply(this,t);return o.each(e._chartjs.listeners,(function(e){"function"==typeof e[n]&&e[n].apply(e,t)})),r}})})))}function n(e,t){var n=e._chartjs;if(n){var o=n.listeners,r=o.indexOf(t);-1!==r&&o.splice(r,1),o.length>0||(i.forEach((function(t){delete e[t]})),delete e._chartjs)}}var i=["push","pop","shift","splice","unshift"];e.DatasetController=function(e,t){this.initialize(e,t)},o.extend(e.DatasetController.prototype,{datasetElementType:null,dataElementType:null,initialize:function(e,t){var n=this;n.chart=e,n.index=t,n.linkScales(),n.addElements()},updateIndex:function(e){this.index=e},linkScales:function(){var e=this,t=e.getMeta(),n=e.getDataset();null===t.xAxisID&&(t.xAxisID=n.xAxisID||e.chart.options.scales.xAxes[0].id),null===t.yAxisID&&(t.yAxisID=n.yAxisID||e.chart.options.scales.yAxes[0].id)},getDataset:function(){return this.chart.data.datasets[this.index]},getMeta:function(){return this.chart.getDatasetMeta(this.index)},getScaleForId:function(e){return this.chart.scales[e]},reset:function(){this.update(!0)},destroy:function(){this._data&&n(this._data,this)},createMetaDataset:function(){var e=this,t=e.datasetElementType;return t&&new t({_chart:e.chart,_datasetIndex:e.index})},createMetaData:function(e){var t=this,n=t.dataElementType;return n&&new n({_chart:t.chart,_datasetIndex:t.index,_index:e})},addElements:function(){var e,t,n=this,o=n.getMeta(),i=n.getDataset().data||[],r=o.data;for(e=0,t=i.length;e<t;++e)r[e]=r[e]||n.createMetaData(e);o.dataset=o.dataset||n.createMetaDataset()},addElementAndReset:function(e){var t=this.createMetaData(e);this.getMeta().data.splice(e,0,t),this.updateElement(t,e,!0)},buildOrUpdateElements:function(){var e=this,o=e.getDataset(),i=o.data||(o.data=[]);e._data!==i&&(e._data&&n(e._data,e),t(i,e),e._data=i),e.resyncElements()},update:o.noop,transition:function(e){for(var t=this.getMeta(),n=t.data||[],o=n.length,i=0;i<o;++i)n[i].transition(e);t.dataset&&t.dataset.transition(e)},draw:function(){var e=this.getMeta(),t=e.data||[],n=t.length,o=0;for(e.dataset&&e.dataset.draw();o<n;++o)t[o].draw()},removeHoverStyle:function(e,t){var n=this.chart.data.datasets[e._datasetIndex],i=e._index,r=e.custom||{},a=o.valueAtIndexOrDefault,s=e._model;s.backgroundColor=r.backgroundColor?r.backgroundColor:a(n.backgroundColor,i,t.backgroundColor),s.borderColor=r.borderColor?r.borderColor:a(n.borderColor,i,t.borderColor),s.borderWidth=r.borderWidth?r.borderWidth:a(n.borderWidth,i,t.borderWidth)},setHoverStyle:function(e){var t=this.chart.data.datasets[e._datasetIndex],n=e._index,i=e.custom||{},r=o.valueAtIndexOrDefault,a=o.getHoverColor,s=e._model;s.backgroundColor=i.hoverBackgroundColor?i.hoverBackgroundColor:r(t.hoverBackgroundColor,n,a(s.backgroundColor)),s.borderColor=i.hoverBorderColor?i.hoverBorderColor:r(t.hoverBorderColor,n,a(s.borderColor)),s.borderWidth=i.hoverBorderWidth?i.hoverBorderWidth:r(t.hoverBorderWidth,n,s.borderWidth)},resyncElements:function(){var e=this,t=e.getMeta(),n=e.getDataset().data,o=t.data.length,i=n.length;i<o?t.data.splice(i,o-i):i>o&&e.insertElements(o,i-o)},insertElements:function(e,t){for(var n=0;n<t;++n)this.addElementAndReset(e+n)},onDataPush:function(){this.insertElements(this.getDataset().data.length-1,arguments.length)},onDataPop:function(){this.getMeta().data.pop()},onDataShift:function(){this.getMeta().data.shift()},onDataSplice:function(e,t){this.getMeta().data.splice(e,t),this.insertElements(e,arguments.length-2)},onDataUnshift:function(){this.insertElements(0,arguments.length)}}),e.DatasetController.extend=o.inherits}},{45:45}],25:[function(e,t,n){"use strict";var o=e(45);t.exports={_set:function(e,t){return o.merge(this[e]||(this[e]={}),t)}}},{45:45}],26:[function(e,t,n){"use strict";function o(e,t,n,o){var r,a,s,l,u,c,d,f,h,g=Object.keys(n);for(r=0,a=g.length;r<a;++r)if(c=n[s=g[r]],t.hasOwnProperty(s)||(t[s]=c),(l=t[s])!==c&&"_"!==s[0]){if(e.hasOwnProperty(s)||(e[s]=l),(d=typeof c)==typeof(u=e[s]))if("string"===d){if((f=i(u)).valid&&(h=i(c)).valid){t[s]=h.mix(f,o).rgbString();continue}}else if("number"===d&&isFinite(u)&&isFinite(c)){t[s]=u+(c-u)*o;continue}t[s]=c}}var i=e(3),r=e(45),a=function(e){r.extend(this,e),this.initialize.apply(this,arguments)};r.extend(a.prototype,{initialize:function(){this.hidden=!1},pivot:function(){var e=this;return e._view||(e._view=r.clone(e._model)),e._start={},e},transition:function(e){var t=this,n=t._model,i=t._start,r=t._view;return n&&1!==e?(r||(r=t._view={}),i||(i=t._start={}),o(i,r,n,e),t):(t._view=n,t._start=null,t)},tooltipPosition:function(){return{x:this._model.x,y:this._model.y}},hasValue:function(){return r.isNumber(this._model.x)&&r.isNumber(this._model.y)}}),a.extend=r.inherits,t.exports=a},{3:3,45:45}],27:[function(e,t,n){"use strict";var o=e(3),i=e(25),r=e(45);t.exports=function(e){function t(e,t,n){var o;return"string"==typeof e?(o=parseInt(e,10),-1!==e.indexOf("%")&&(o=o/100*t.parentNode[n])):o=e,o}function n(e){return null!=e&&"none"!==e}function a(e,o,i){var r=document.defaultView,a=e.parentNode,s=r.getComputedStyle(e)[o],l=r.getComputedStyle(a)[o],u=n(s),c=n(l),d=Number.POSITIVE_INFINITY;return u||c?Math.min(u?t(s,e,i):d,c?t(l,a,i):d):"none"}r.configMerge=function(){return r.merge(r.clone(arguments[0]),[].slice.call(arguments,1),{merger:function(t,n,o,i){var a=n[t]||{},s=o[t];"scales"===t?n[t]=r.scaleMerge(a,s):"scale"===t?n[t]=r.merge(a,[e.scaleService.getScaleDefaults(s.type),s]):r._merger(t,n,o,i)}})},r.scaleMerge=function(){return r.merge(r.clone(arguments[0]),[].slice.call(arguments,1),{merger:function(t,n,o,i){if("xAxes"===t||"yAxes"===t){var a,s,l,u=o[t].length;for(n[t]||(n[t]=[]),a=0;a<u;++a)s=r.valueOrDefault((l=o[t][a]).type,"xAxes"===t?"category":"linear"),a>=n[t].length&&n[t].push({}),r.merge(n[t][a],!n[t][a].type||l.type&&l.type!==n[t][a].type?[e.scaleService.getScaleDefaults(s),l]:l)}else r._merger(t,n,o,i)}})},r.where=function(e,t){if(r.isArray(e)&&Array.prototype.filter)return e.filter(t);var n=[];return r.each(e,(function(e){t(e)&&n.push(e)})),n},r.findIndex=Array.prototype.findIndex?function(e,t,n){return e.findIndex(t,n)}:function(e,t,n){n=void 0===n?e:n;for(var o=0,i=e.length;o<i;++o)if(t.call(n,e[o],o,e))return o;return-1},r.findNextWhere=function(e,t,n){r.isNullOrUndef(n)&&(n=-1);for(var o=n+1;o<e.length;o++){var i=e[o];if(t(i))return i}},r.findPreviousWhere=function(e,t,n){r.isNullOrUndef(n)&&(n=e.length);for(var o=n-1;o>=0;o--){var i=e[o];if(t(i))return i}},r.isNumber=function(e){return!isNaN(parseFloat(e))&&isFinite(e)},r.almostEquals=function(e,t,n){return Math.abs(e-t)<n},r.almostWhole=function(e,t){var n=Math.round(e);return n-t<e&&n+t>e},r.max=function(e){return e.reduce((function(e,t){return isNaN(t)?e:Math.max(e,t)}),Number.NEGATIVE_INFINITY)},r.min=function(e){return e.reduce((function(e,t){return isNaN(t)?e:Math.min(e,t)}),Number.POSITIVE_INFINITY)},r.sign=Math.sign?function(e){return Math.sign(e)}:function(e){return 0==(e=+e)||isNaN(e)?e:e>0?1:-1},r.log10=Math.log10?function(e){return Math.log10(e)}:function(e){return Math.log(e)/Math.LN10},r.toRadians=function(e){return e*(Math.PI/180)},r.toDegrees=function(e){return e*(180/Math.PI)},r.getAngleFromPoint=function(e,t){var n=t.x-e.x,o=t.y-e.y,i=Math.sqrt(n*n+o*o),r=Math.atan2(o,n);return r<-.5*Math.PI&&(r+=2*Math.PI),{angle:r,distance:i}},r.distanceBetweenPoints=function(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))},r.aliasPixel=function(e){return e%2==0?0:.5},r.splineCurve=function(e,t,n,o){var i=e.skip?t:e,r=t,a=n.skip?t:n,s=Math.sqrt(Math.pow(r.x-i.x,2)+Math.pow(r.y-i.y,2)),l=Math.sqrt(Math.pow(a.x-r.x,2)+Math.pow(a.y-r.y,2)),u=s/(s+l),c=l/(s+l),d=o*(u=isNaN(u)?0:u),f=o*(c=isNaN(c)?0:c);return{previous:{x:r.x-d*(a.x-i.x),y:r.y-d*(a.y-i.y)},next:{x:r.x+f*(a.x-i.x),y:r.y+f*(a.y-i.y)}}},r.EPSILON=Number.EPSILON||1e-14,r.splineCurveMonotone=function(e){var t,n,o,i,a,s,l,u,c,d=(e||[]).map((function(e){return{model:e._model,deltaK:0,mK:0}})),f=d.length;for(t=0;t<f;++t)if(!(o=d[t]).model.skip){if(n=t>0?d[t-1]:null,(i=t<f-1?d[t+1]:null)&&!i.model.skip){var h=i.model.x-o.model.x;o.deltaK=0!==h?(i.model.y-o.model.y)/h:0}o.mK=!n||n.model.skip?o.deltaK:!i||i.model.skip?n.deltaK:this.sign(n.deltaK)!==this.sign(o.deltaK)?0:(n.deltaK+o.deltaK)/2}for(t=0;t<f-1;++t)i=d[t+1],(o=d[t]).model.skip||i.model.skip||(r.almostEquals(o.deltaK,0,this.EPSILON)?o.mK=i.mK=0:(a=o.mK/o.deltaK,s=i.mK/o.deltaK,(u=Math.pow(a,2)+Math.pow(s,2))<=9||(l=3/Math.sqrt(u),o.mK=a*l*o.deltaK,i.mK=s*l*o.deltaK)));for(t=0;t<f;++t)(o=d[t]).model.skip||(i=t<f-1?d[t+1]:null,(n=t>0?d[t-1]:null)&&!n.model.skip&&(o.model.controlPointPreviousX=o.model.x-(c=(o.model.x-n.model.x)/3),o.model.controlPointPreviousY=o.model.y-c*o.mK),i&&!i.model.skip&&(o.model.controlPointNextX=o.model.x+(c=(i.model.x-o.model.x)/3),o.model.controlPointNextY=o.model.y+c*o.mK))},r.nextItem=function(e,t,n){return n?t>=e.length-1?e[0]:e[t+1]:t>=e.length-1?e[e.length-1]:e[t+1]},r.previousItem=function(e,t,n){return n?t<=0?e[e.length-1]:e[t-1]:t<=0?e[0]:e[t-1]},r.niceNum=function(e,t){var n=Math.floor(r.log10(e)),o=e/Math.pow(10,n);return(t?o<1.5?1:o<3?2:o<7?5:10:o<=1?1:o<=2?2:o<=5?5:10)*Math.pow(10,n)},r.requestAnimFrame="undefined"==typeof window?function(e){e()}:window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){return window.setTimeout(e,1e3/60)},r.getRelativePosition=function(e,t){var n,o,i=e.originalEvent||e,a=e.currentTarget||e.srcElement,s=a.getBoundingClientRect(),l=i.touches;l&&l.length>0?(n=l[0].clientX,o=l[0].clientY):(n=i.clientX,o=i.clientY);var u=parseFloat(r.getStyle(a,"padding-left")),c=parseFloat(r.getStyle(a,"padding-top")),d=parseFloat(r.getStyle(a,"padding-right")),f=parseFloat(r.getStyle(a,"padding-bottom")),h=s.bottom-s.top-c-f;return{x:n=Math.round((n-s.left-u)/(s.right-s.left-u-d)*a.width/t.currentDevicePixelRatio),y:o=Math.round((o-s.top-c)/h*a.height/t.currentDevicePixelRatio)}},r.getConstraintWidth=function(e){return a(e,"max-width","clientWidth")},r.getConstraintHeight=function(e){return a(e,"max-height","clientHeight")},r.getMaximumWidth=function(e){var t=e.parentNode;if(!t)return e.clientWidth;var n=parseInt(r.getStyle(t,"padding-left"),10),o=parseInt(r.getStyle(t,"padding-right"),10),i=t.clientWidth-n-o,a=r.getConstraintWidth(e);return isNaN(a)?i:Math.min(i,a)},r.getMaximumHeight=function(e){var t=e.parentNode;if(!t)return e.clientHeight;var n=parseInt(r.getStyle(t,"padding-top"),10),o=parseInt(r.getStyle(t,"padding-bottom"),10),i=t.clientHeight-n-o,a=r.getConstraintHeight(e);return isNaN(a)?i:Math.min(i,a)},r.getStyle=function(e,t){return e.currentStyle?e.currentStyle[t]:document.defaultView.getComputedStyle(e,null).getPropertyValue(t)},r.retinaScale=function(e,t){var n=e.currentDevicePixelRatio=t||window.devicePixelRatio||1;if(1!==n){var o=e.canvas,i=e.height,r=e.width;o.height=i*n,o.width=r*n,e.ctx.scale(n,n),o.style.height=i+"px",o.style.width=r+"px"}},r.fontString=function(e,t,n){return t+" "+e+"px "+n},r.longestText=function(e,t,n,o){var i=(o=o||{}).data=o.data||{},a=o.garbageCollect=o.garbageCollect||[];o.font!==t&&(i=o.data={},a=o.garbageCollect=[],o.font=t),e.font=t;var s=0;r.each(n,(function(t){null!=t&&!0!==r.isArray(t)?s=r.measureText(e,i,a,s,t):r.isArray(t)&&r.each(t,(function(t){null==t||r.isArray(t)||(s=r.measureText(e,i,a,s,t))}))}));var l=a.length/2;if(l>n.length){for(var u=0;u<l;u++)delete i[a[u]];a.splice(0,l)}return s},r.measureText=function(e,t,n,o,i){var r=t[i];return r||(r=t[i]=e.measureText(i).width,n.push(i)),r>o&&(o=r),o},r.numberOfLabelLines=function(e){var t=1;return r.each(e,(function(e){r.isArray(e)&&e.length>t&&(t=e.length)})),t},r.color=o?function(e){return e instanceof CanvasGradient&&(e=i.global.defaultColor),o(e)}:function(e){return console.error("Color.js not found!"),e},r.getHoverColor=function(e){return e instanceof CanvasPattern?e:r.color(e).saturate(.5).darken(.1).rgbString()}}},{25:25,3:3,45:45}],28:[function(e,t,n){"use strict";function o(e,t){return e.native?{x:e.x,y:e.y}:u.getRelativePosition(e,t)}function i(e,t){var n,o,i,r,a;for(o=0,r=e.data.datasets.length;o<r;++o)if(e.isDatasetVisible(o))for(i=0,a=(n=e.getDatasetMeta(o)).data.length;i<a;++i){var s=n.data[i];s._view.skip||t(s)}}function r(e,t){var n=[];return i(e,(function(e){e.inRange(t.x,t.y)&&n.push(e)})),n}function a(e,t,n,o){var r=Number.POSITIVE_INFINITY,a=[];return i(e,(function(e){if(!n||e.inRange(t.x,t.y)){var i=e.getCenterPoint(),s=o(t,i);s<r?(a=[e],r=s):s===r&&a.push(e)}})),a}function s(e){var t=-1!==e.indexOf("x"),n=-1!==e.indexOf("y");return function(e,o){var i=t?Math.abs(e.x-o.x):0,r=n?Math.abs(e.y-o.y):0;return Math.sqrt(Math.pow(i,2)+Math.pow(r,2))}}function l(e,t,n){var i=o(t,e);n.axis=n.axis||"x";var l=s(n.axis),u=n.intersect?r(e,i):a(e,i,!1,l),c=[];return u.length?(e.data.datasets.forEach((function(t,n){if(e.isDatasetVisible(n)){var o=e.getDatasetMeta(n).data[u[0]._index];o&&!o._view.skip&&c.push(o)}})),c):[]}var u=e(45);t.exports={modes:{single:function(e,t){var n=o(t,e),r=[];return i(e,(function(e){if(e.inRange(n.x,n.y))return r.push(e),r})),r.slice(0,1)},label:l,index:l,dataset:function(e,t,n){var i=o(t,e);n.axis=n.axis||"xy";var l=s(n.axis),u=n.intersect?r(e,i):a(e,i,!1,l);return u.length>0&&(u=e.getDatasetMeta(u[0]._datasetIndex).data),u},"x-axis":function(e,t){return l(e,t,{intersect:!1})},point:function(e,t){return r(e,o(t,e))},nearest:function(e,t,n){var i=o(t,e);n.axis=n.axis||"xy";var r=s(n.axis),l=a(e,i,n.intersect,r);return l.length>1&&l.sort((function(e,t){var n=e.getArea()-t.getArea();return 0===n&&(n=e._datasetIndex-t._datasetIndex),n})),l.slice(0,1)},x:function(e,t,n){var r=o(t,e),a=[],s=!1;return i(e,(function(e){e.inXRange(r.x)&&a.push(e),e.inRange(r.x,r.y)&&(s=!0)})),n.intersect&&!s&&(a=[]),a},y:function(e,t,n){var r=o(t,e),a=[],s=!1;return i(e,(function(e){e.inYRange(r.y)&&a.push(e),e.inRange(r.x,r.y)&&(s=!0)})),n.intersect&&!s&&(a=[]),a}}}},{45:45}],29:[function(e,t,n){"use strict";e(25)._set("global",{responsive:!0,responsiveAnimationDuration:0,maintainAspectRatio:!0,events:["mousemove","mouseout","click","touchstart","touchmove"],hover:{onHover:null,mode:"nearest",intersect:!0,animationDuration:400},onClick:null,defaultColor:"rgba(0,0,0,0.1)",defaultFontColor:"#666",defaultFontFamily:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",defaultFontSize:12,defaultFontStyle:"normal",showLines:!0,elements:{},layout:{padding:{top:0,right:0,bottom:0,left:0}}}),t.exports=function(){var e=function(e,t){return this.construct(e,t),this};return e.Chart=e,e}},{25:25}],30:[function(e,t,n){"use strict";var o=e(45);t.exports=function(e){function t(e,t){return o.where(e,(function(e){return e.position===t}))}function n(e,t){e.forEach((function(e,t){return e._tmpIndex_=t,e})),e.sort((function(e,n){var o=t?n:e,i=t?e:n;return o.weight===i.weight?o._tmpIndex_-i._tmpIndex_:o.weight-i.weight})),e.forEach((function(e){delete e._tmpIndex_}))}e.layoutService={defaults:{},addBox:function(e,t){e.boxes||(e.boxes=[]),t.fullWidth=t.fullWidth||!1,t.position=t.position||"top",t.weight=t.weight||0,e.boxes.push(t)},removeBox:function(e,t){var n=e.boxes?e.boxes.indexOf(t):-1;-1!==n&&e.boxes.splice(n,1)},configure:function(e,t,n){for(var o,i=["fullWidth","position","weight"],r=i.length,a=0;a<r;++a)n.hasOwnProperty(o=i[a])&&(t[o]=n[o])},update:function(e,i,r){function a(e){var t=o.findNextWhere(I,(function(t){return t.box===e}));if(t)if(e.isHorizontal()){var n={left:Math.max(S,D),right:Math.max(k,O),top:0,bottom:0};e.update(e.fullWidth?y:E,b/2,n)}else e.update(t.minSize.width,_)}function s(e){e.isHorizontal()?(e.left=e.fullWidth?u:S,e.right=e.fullWidth?i-c:S+E,e.top=F,e.bottom=F+e.height,F=e.bottom):(e.left=B,e.right=B+e.width,e.top=A,e.bottom=A+_,B=e.right)}if(e){var l=o.options.toPadding((e.options.layout||{}).padding),u=l.left,c=l.right,d=l.top,f=l.bottom,h=t(e.boxes,"left"),g=t(e.boxes,"right"),m=t(e.boxes,"top"),p=t(e.boxes,"bottom"),v=t(e.boxes,"chartArea");n(h,!0),n(g,!1),n(m,!0),n(p,!1);var y=i-u-c,b=r-d-f,C=b/2,T=(i-y/2)/(h.length+g.length),x=(r-C)/(m.length+p.length),E=y,_=b,I=[];o.each(h.concat(g,m,p),(function(e){var t,n=e.isHorizontal();n?(t=e.update(e.fullWidth?y:E,x),_-=t.height):(t=e.update(T,C),E-=t.width),I.push({horizontal:n,minSize:t,box:e})}));var D=0,O=0,w=0,R=0;o.each(m.concat(p),(function(e){if(e.getPadding){var t=e.getPadding();D=Math.max(D,t.left),O=Math.max(O,t.right)}})),o.each(h.concat(g),(function(e){if(e.getPadding){var t=e.getPadding();w=Math.max(w,t.top),R=Math.max(R,t.bottom)}}));var S=u,k=c,A=d,N=f;o.each(h.concat(g),a),o.each(h,(function(e){S+=e.width})),o.each(g,(function(e){k+=e.width})),o.each(m.concat(p),a),o.each(m,(function(e){A+=e.height})),o.each(p,(function(e){N+=e.height})),o.each(h.concat(g),(function(e){var t=o.findNextWhere(I,(function(t){return t.box===e}));t&&e.update(t.minSize.width,_,{left:0,right:0,top:A,bottom:N})})),S=u,k=c,A=d,N=f,o.each(h,(function(e){S+=e.width})),o.each(g,(function(e){k+=e.width})),o.each(m,(function(e){A+=e.height})),o.each(p,(function(e){N+=e.height}));var M=Math.max(D-S,0);S+=M,k+=Math.max(O-k,0);var K=Math.max(w-A,0);A+=K,N+=Math.max(R-N,0);var P=r-A-N,L=i-S-k;L===E&&P===_||(o.each(h,(function(e){e.height=P})),o.each(g,(function(e){e.height=P})),o.each(m,(function(e){e.fullWidth||(e.width=L)})),o.each(p,(function(e){e.fullWidth||(e.width=L)})),_=P,E=L);var B=u+M,F=d+K;o.each(h.concat(m),s),B+=E,F+=_,o.each(g,s),o.each(p,s),e.chartArea={left:S,top:A,right:S+E,bottom:A+_},o.each(v,(function(t){t.left=e.chartArea.left,t.top=e.chartArea.top,t.right=e.chartArea.right,t.bottom=e.chartArea.bottom,t.update(E,_)}))}}}}},{45:45}],31:[function(e,t,n){"use strict";var o=e(25),i=e(26),r=e(45);o._set("global",{plugins:{}}),t.exports=function(e){e.plugins={_plugins:[],_cacheId:0,register:function(e){var t=this._plugins;[].concat(e).forEach((function(e){-1===t.indexOf(e)&&t.push(e)})),this._cacheId++},unregister:function(e){var t=this._plugins;[].concat(e).forEach((function(e){var n=t.indexOf(e);-1!==n&&t.splice(n,1)})),this._cacheId++},clear:function(){this._plugins=[],this._cacheId++},count:function(){return this._plugins.length},getAll:function(){return this._plugins},notify:function(e,t,n){var o,i,r,a,s,l=this.descriptors(e),u=l.length;for(o=0;o<u;++o)if("function"==typeof(s=(r=(i=l[o]).plugin)[t])&&((a=[e].concat(n||[])).push(i.options),!1===s.apply(r,a)))return!1;return!0},descriptors:function(e){var t=e._plugins||(e._plugins={});if(t.id===this._cacheId)return t.descriptors;var n=[],i=[],a=e&&e.config||{},s=a.options&&a.options.plugins||{};return this._plugins.concat(a.plugins||[]).forEach((function(e){if(-1===n.indexOf(e)){var t=e.id,a=s[t];!1!==a&&(!0===a&&(a=r.clone(o.global.plugins[t])),n.push(e),i.push({plugin:e,options:a||{}}))}})),t.descriptors=i,t.id=this._cacheId,i}},e.pluginService=e.plugins,e.PluginBase=i.extend({})}},{25:25,26:26,45:45}],32:[function(e,t,n){"use strict";function o(e){var t,n,o=[];for(t=0,n=e.length;t<n;++t)o.push(e[t].label);return o}function i(e,t,n){var o=e.getPixelForTick(t);return n&&(o-=0===t?(e.getPixelForTick(1)-o)/2:(o-e.getPixelForTick(t-1))/2),o}var r=e(25),a=e(26),s=e(45),l=e(34);r._set("scale",{display:!0,position:"left",offset:!1,gridLines:{display:!0,color:"rgba(0, 0, 0, 0.1)",lineWidth:1,drawBorder:!0,drawOnChartArea:!0,drawTicks:!0,tickMarkLength:10,zeroLineWidth:1,zeroLineColor:"rgba(0,0,0,0.25)",zeroLineBorderDash:[],zeroLineBorderDashOffset:0,offsetGridLines:!1,borderDash:[],borderDashOffset:0},scaleLabel:{display:!1,labelString:"",lineHeight:1.2,padding:{top:4,bottom:4}},ticks:{beginAtZero:!1,minRotation:0,maxRotation:50,mirror:!1,padding:0,reverse:!1,display:!0,autoSkip:!0,autoSkipPadding:0,labelOffset:0,callback:l.formatters.values,minor:{},major:{}}}),t.exports=function(e){function t(e,t,n){return s.isArray(t)?s.longestText(e,n,t):e.measureText(t).width}function n(e){var t=s.valueOrDefault,n=r.global,o=t(e.fontSize,n.defaultFontSize),i=t(e.fontStyle,n.defaultFontStyle),a=t(e.fontFamily,n.defaultFontFamily);return{size:o,style:i,family:a,font:s.fontString(o,i,a)}}function l(e){return s.options.toLineHeight(s.valueOrDefault(e.lineHeight,1.2),s.valueOrDefault(e.fontSize,r.global.defaultFontSize))}e.Scale=a.extend({getPadding:function(){var e=this;return{left:e.paddingLeft||0,top:e.paddingTop||0,right:e.paddingRight||0,bottom:e.paddingBottom||0}},getTicks:function(){return this._ticks},mergeTicksOptions:function(){var e=this.options.ticks;for(var t in!1===e.minor&&(e.minor={display:!1}),!1===e.major&&(e.major={display:!1}),e)"major"!==t&&"minor"!==t&&(void 0===e.minor[t]&&(e.minor[t]=e[t]),void 0===e.major[t]&&(e.major[t]=e[t]))},beforeUpdate:function(){s.callback(this.options.beforeUpdate,[this])},update:function(e,t,n){var o,i,r,a,l,u,c=this;for(c.beforeUpdate(),c.maxWidth=e,c.maxHeight=t,c.margins=s.extend({left:0,right:0,top:0,bottom:0},n),c.longestTextCache=c.longestTextCache||{},c.beforeSetDimensions(),c.setDimensions(),c.afterSetDimensions(),c.beforeDataLimits(),c.determineDataLimits(),c.afterDataLimits(),c.beforeBuildTicks(),l=c.buildTicks()||[],c.afterBuildTicks(),c.beforeTickToLabelConversion(),r=c.convertTicksToLabels(l)||c.ticks,c.afterTickToLabelConversion(),c.ticks=r,o=0,i=r.length;o<i;++o)a=r[o],(u=l[o])?u.label=a:l.push(u={label:a,major:!1});return c._ticks=l,c.beforeCalculateTickRotation(),c.calculateTickRotation(),c.afterCalculateTickRotation(),c.beforeFit(),c.fit(),c.afterFit(),c.afterUpdate(),c.minSize},afterUpdate:function(){s.callback(this.options.afterUpdate,[this])},beforeSetDimensions:function(){s.callback(this.options.beforeSetDimensions,[this])},setDimensions:function(){var e=this;e.isHorizontal()?(e.width=e.maxWidth,e.left=0,e.right=e.width):(e.height=e.maxHeight,e.top=0,e.bottom=e.height),e.paddingLeft=0,e.paddingTop=0,e.paddingRight=0,e.paddingBottom=0},afterSetDimensions:function(){s.callback(this.options.afterSetDimensions,[this])},beforeDataLimits:function(){s.callback(this.options.beforeDataLimits,[this])},determineDataLimits:s.noop,afterDataLimits:function(){s.callback(this.options.afterDataLimits,[this])},beforeBuildTicks:function(){s.callback(this.options.beforeBuildTicks,[this])},buildTicks:s.noop,afterBuildTicks:function(){s.callback(this.options.afterBuildTicks,[this])},beforeTickToLabelConversion:function(){s.callback(this.options.beforeTickToLabelConversion,[this])},convertTicksToLabels:function(){var e=this,t=e.options.ticks;e.ticks=e.ticks.map(t.userCallback||t.callback,this)},afterTickToLabelConversion:function(){s.callback(this.options.afterTickToLabelConversion,[this])},beforeCalculateTickRotation:function(){s.callback(this.options.beforeCalculateTickRotation,[this])},calculateTickRotation:function(){var e=this,t=e.ctx,i=e.options.ticks,r=o(e._ticks),a=n(i);t.font=a.font;var l=i.minRotation||0;if(r.length&&e.options.display&&e.isHorizontal())for(var u,c=s.longestText(t,a.font,r,e.longestTextCache),d=c,f=e.getPixelForTick(1)-e.getPixelForTick(0)-6;d>f&&l<i.maxRotation;){var h=s.toRadians(l);if(u=Math.cos(h),Math.sin(h)*c>e.maxHeight){l--;break}l++,d=u*c}e.labelRotation=l},afterCalculateTickRotation:function(){s.callback(this.options.afterCalculateTickRotation,[this])},beforeFit:function(){s.callback(this.options.beforeFit,[this])},fit:function(){var e=this,i=e.minSize={width:0,height:0},r=o(e._ticks),a=e.options,u=a.ticks,c=a.scaleLabel,d=a.gridLines,f=a.display,h=e.isHorizontal(),g=n(u),m=a.gridLines.tickMarkLength;if(i.width=h?e.isFullWidth()?e.maxWidth-e.margins.left-e.margins.right:e.maxWidth:f&&d.drawTicks?m:0,i.height=h?f&&d.drawTicks?m:0:e.maxHeight,c.display&&f){var p=l(c)+s.options.toPadding(c.padding).height;h?i.height+=p:i.width+=p}if(u.display&&f){var v=s.longestText(e.ctx,g.font,r,e.longestTextCache),y=s.numberOfLabelLines(r),b=.5*g.size,C=e.options.ticks.padding;if(h){e.longestLabelWidth=v;var T=s.toRadians(e.labelRotation),x=Math.cos(T),E=Math.sin(T)*v+g.size*y+b*(y-1)+b;i.height=Math.min(e.maxHeight,i.height+E+C),e.ctx.font=g.font;var _=t(e.ctx,r[0],g.font),I=t(e.ctx,r[r.length-1],g.font);0!==e.labelRotation?(e.paddingLeft="bottom"===a.position?x*_+3:x*b+3,e.paddingRight="bottom"===a.position?x*b+3:x*I+3):(e.paddingLeft=_/2+3,e.paddingRight=I/2+3)}else u.mirror?v=0:v+=C+b,i.width=Math.min(e.maxWidth,i.width+v),e.paddingTop=g.size/2,e.paddingBottom=g.size/2}e.handleMargins(),e.width=i.width,e.height=i.height},handleMargins:function(){var e=this;e.margins&&(e.paddingLeft=Math.max(e.paddingLeft-e.margins.left,0),e.paddingTop=Math.max(e.paddingTop-e.margins.top,0),e.paddingRight=Math.max(e.paddingRight-e.margins.right,0),e.paddingBottom=Math.max(e.paddingBottom-e.margins.bottom,0))},afterFit:function(){s.callback(this.options.afterFit,[this])},isHorizontal:function(){return"top"===this.options.position||"bottom"===this.options.position},isFullWidth:function(){return this.options.fullWidth},getRightValue:function(e){if(s.isNullOrUndef(e))return NaN;if("number"==typeof e&&!isFinite(e))return NaN;if(e)if(this.isHorizontal()){if(void 0!==e.x)return this.getRightValue(e.x)}else if(void 0!==e.y)return this.getRightValue(e.y);return e},getLabelForIndex:s.noop,getPixelForValue:s.noop,getValueForPixel:s.noop,getPixelForTick:function(e){var t=this,n=t.options.offset;if(t.isHorizontal()){var o=(t.width-(t.paddingLeft+t.paddingRight))/Math.max(t._ticks.length-(n?0:1),1),i=o*e+t.paddingLeft;return n&&(i+=o/2),t.left+Math.round(i)+(t.isFullWidth()?t.margins.left:0)}return t.top+e*((t.height-(t.paddingTop+t.paddingBottom))/(t._ticks.length-1))},getPixelForDecimal:function(e){var t=this;return t.isHorizontal()?t.left+Math.round((t.width-(t.paddingLeft+t.paddingRight))*e+t.paddingLeft)+(t.isFullWidth()?t.margins.left:0):t.top+e*t.height},getBasePixel:function(){return this.getPixelForValue(this.getBaseValue())},getBaseValue:function(){var e=this,t=e.min,n=e.max;return e.beginAtZero?0:t<0&&n<0?n:t>0&&n>0?t:0},_autoSkip:function(e){var t,n,o,i,r=this,a=r.isHorizontal(),l=r.options.ticks.minor,u=e.length,c=s.toRadians(r.labelRotation),d=Math.cos(c),f=r.longestLabelWidth*d,h=[];for(l.maxTicksLimit&&(i=l.maxTicksLimit),a&&(t=!1,(f+l.autoSkipPadding)*u>r.width-(r.paddingLeft+r.paddingRight)&&(t=1+Math.floor((f+l.autoSkipPadding)*u/(r.width-(r.paddingLeft+r.paddingRight)))),i&&u>i&&(t=Math.max(t,Math.floor(u/i)))),n=0;n<u;n++)o=e[n],(t>1&&n%t>0||n%t==0&&n+t>=u)&&n!==u-1&&delete o.label,h.push(o);return h},draw:function(e){var t=this,o=t.options;if(o.display){var a=t.ctx,u=r.global,c=o.ticks.minor,d=o.ticks.major||c,f=o.gridLines,h=o.scaleLabel,g=0!==t.labelRotation,m=t.isHorizontal(),p=c.autoSkip?t._autoSkip(t.getTicks()):t.getTicks(),v=s.valueOrDefault(c.fontColor,u.defaultFontColor),y=n(c),b=s.valueOrDefault(d.fontColor,u.defaultFontColor),C=n(d),T=f.drawTicks?f.tickMarkLength:0,x=s.valueOrDefault(h.fontColor,u.defaultFontColor),E=n(h),_=s.options.toPadding(h.padding),I=s.toRadians(t.labelRotation),D=[],O="right"===o.position?t.left:t.right-T,w="right"===o.position?t.left+T:t.right,R="bottom"===o.position?t.top:t.bottom-T,S="bottom"===o.position?t.top+T:t.bottom;if(s.each(p,(function(n,r){if(!s.isNullOrUndef(n.label)){var a,l,d,h,v=n.label;r===t.zeroLineIndex&&o.offset===f.offsetGridLines?(a=f.zeroLineWidth,l=f.zeroLineColor,d=f.zeroLineBorderDash,h=f.zeroLineBorderDashOffset):(a=s.valueAtIndexOrDefault(f.lineWidth,r),l=s.valueAtIndexOrDefault(f.color,r),d=s.valueOrDefault(f.borderDash,u.borderDash),h=s.valueOrDefault(f.borderDashOffset,u.borderDashOffset));var y,b,C,x,E,_,k,A,N,M,K="middle",P="middle",L=c.padding;if(m){var B=T+L;"bottom"===o.position?(P=g?"middle":"top",K=g?"right":"center",M=t.top+B):(P=g?"middle":"bottom",K=g?"left":"center",M=t.bottom-B);var F=i(t,r,f.offsetGridLines&&p.length>1);F<t.left&&(l="rgba(0,0,0,0)"),F+=s.aliasPixel(a),N=t.getPixelForTick(r)+c.labelOffset,y=C=E=k=F,b=R,x=S,_=e.top,A=e.bottom}else{var z,V="left"===o.position;c.mirror?(K=V?"left":"right",z=L):(K=V?"right":"left",z=T+L),N=V?t.right-z:t.left+z;var H=i(t,r,f.offsetGridLines&&p.length>1);H<t.top&&(l="rgba(0,0,0,0)"),H+=s.aliasPixel(a),M=t.getPixelForTick(r)+c.labelOffset,y=O,C=w,E=e.left,k=e.right,b=x=_=A=H}D.push({tx1:y,ty1:b,tx2:C,ty2:x,x1:E,y1:_,x2:k,y2:A,labelX:N,labelY:M,glWidth:a,glColor:l,glBorderDash:d,glBorderDashOffset:h,rotation:-1*I,label:v,major:n.major,textBaseline:P,textAlign:K})}})),s.each(D,(function(e){if(f.display&&(a.save(),a.lineWidth=e.glWidth,a.strokeStyle=e.glColor,a.setLineDash&&(a.setLineDash(e.glBorderDash),a.lineDashOffset=e.glBorderDashOffset),a.beginPath(),f.drawTicks&&(a.moveTo(e.tx1,e.ty1),a.lineTo(e.tx2,e.ty2)),f.drawOnChartArea&&(a.moveTo(e.x1,e.y1),a.lineTo(e.x2,e.y2)),a.stroke(),a.restore()),c.display){a.save(),a.translate(e.labelX,e.labelY),a.rotate(e.rotation),a.font=e.major?C.font:y.font,a.fillStyle=e.major?b:v,a.textBaseline=e.textBaseline,a.textAlign=e.textAlign;var t=e.label;if(s.isArray(t))for(var n=0,o=0;n<t.length;++n)a.fillText(""+t[n],0,o),o+=1.5*y.size;else a.fillText(t,0,0);a.restore()}})),h.display){var k,A,N=0,M=l(h)/2;if(m)k=t.left+(t.right-t.left)/2,A="bottom"===o.position?t.bottom-M-_.bottom:t.top+M+_.top;else{var K="left"===o.position;k=K?t.left+M+_.top:t.right-M-_.top,A=t.top+(t.bottom-t.top)/2,N=K?-.5*Math.PI:.5*Math.PI}a.save(),a.translate(k,A),a.rotate(N),a.textAlign="center",a.textBaseline="middle",a.fillStyle=x,a.font=E.font,a.fillText(h.labelString,0,0),a.restore()}if(f.drawBorder){a.lineWidth=s.valueAtIndexOrDefault(f.lineWidth,0),a.strokeStyle=s.valueAtIndexOrDefault(f.color,0);var P=t.left,L=t.right,B=t.top,F=t.bottom,z=s.aliasPixel(a.lineWidth);m?(B=F="top"===o.position?t.bottom:t.top,B+=z,F+=z):(P=L="left"===o.position?t.right:t.left,P+=z,L+=z),a.beginPath(),a.moveTo(P,B),a.lineTo(L,F),a.stroke()}}}})}},{25:25,26:26,34:34,45:45}],33:[function(e,t,n){"use strict";var o=e(25),i=e(45);t.exports=function(e){e.scaleService={constructors:{},defaults:{},registerScaleType:function(e,t,n){this.constructors[e]=t,this.defaults[e]=i.clone(n)},getScaleConstructor:function(e){return this.constructors.hasOwnProperty(e)?this.constructors[e]:void 0},getScaleDefaults:function(e){return this.defaults.hasOwnProperty(e)?i.merge({},[o.scale,this.defaults[e]]):{}},updateScaleDefaults:function(e,t){var n=this;n.defaults.hasOwnProperty(e)&&(n.defaults[e]=i.extend(n.defaults[e],t))},addScalesToLayout:function(t){i.each(t.scales,(function(n){n.fullWidth=n.options.fullWidth,n.position=n.options.position,n.weight=n.options.weight,e.layoutService.addBox(t,n)}))}}}},{25:25,45:45}],34:[function(e,t,n){"use strict";var o=e(45);t.exports={generators:{linear:function(e,t){var n,i=[];if(e.stepSize&&e.stepSize>0)n=e.stepSize;else{var r=o.niceNum(t.max-t.min,!1);n=o.niceNum(r/(e.maxTicks-1),!0)}var a=Math.floor(t.min/n)*n,s=Math.ceil(t.max/n)*n;e.min&&e.max&&e.stepSize&&o.almostWhole((e.max-e.min)/e.stepSize,n/1e3)&&(a=e.min,s=e.max);var l=(s-a)/n;l=o.almostEquals(l,Math.round(l),n/1e3)?Math.round(l):Math.ceil(l),i.push(void 0!==e.min?e.min:a);for(var u=1;u<l;++u)i.push(a+u*n);return i.push(void 0!==e.max?e.max:s),i},logarithmic:function(e,t){var n,i,r=[],a=o.valueOrDefault,s=a(e.min,Math.pow(10,Math.floor(o.log10(t.min)))),l=Math.floor(o.log10(t.max)),u=Math.ceil(t.max/Math.pow(10,l));0===s?(n=Math.floor(o.log10(t.minNotZero)),i=Math.floor(t.minNotZero/Math.pow(10,n)),r.push(s),s=i*Math.pow(10,n)):(n=Math.floor(o.log10(s)),i=Math.floor(s/Math.pow(10,n)));do{r.push(s),10==++i&&(i=1,++n),s=i*Math.pow(10,n)}while(n<l||n===l&&i<u);var c=a(e.max,s);return r.push(c),r}},formatters:{values:function(e){return o.isArray(e)?e:""+e},linear:function(e,t,n){var i=n.length>3?n[2]-n[1]:n[1]-n[0];Math.abs(i)>1&&e!==Math.floor(e)&&(i=e-Math.floor(e));var r=o.log10(Math.abs(i)),a="";if(0!==e){var s=-1*Math.floor(r);s=Math.max(Math.min(s,20),0),a=e.toFixed(s)}else a="0";return a},logarithmic:function(e,t,n){var i=e/Math.pow(10,Math.floor(o.log10(e)));return 0===e?"0":1===i||2===i||5===i||0===t||t===n.length-1?e.toExponential():""}}}},{45:45}],35:[function(e,t,n){"use strict";var o=e(25),i=e(26),r=e(45);o._set("global",{tooltips:{enabled:!0,custom:null,mode:"nearest",position:"average",intersect:!0,backgroundColor:"rgba(0,0,0,0.8)",titleFontStyle:"bold",titleSpacing:2,titleMarginBottom:6,titleFontColor:"#fff",titleAlign:"left",bodySpacing:2,bodyFontColor:"#fff",bodyAlign:"left",footerFontStyle:"bold",footerSpacing:2,footerMarginTop:6,footerFontColor:"#fff",footerAlign:"left",yPadding:6,xPadding:6,caretPadding:2,caretSize:5,cornerRadius:6,multiKeyBackground:"#fff",displayColors:!0,borderColor:"rgba(0,0,0,0)",borderWidth:0,callbacks:{beforeTitle:r.noop,title:function(e,t){var n="",o=t.labels,i=o?o.length:0;if(e.length>0){var r=e[0];r.xLabel?n=r.xLabel:i>0&&r.index<i&&(n=o[r.index])}return n},afterTitle:r.noop,beforeBody:r.noop,beforeLabel:r.noop,label:function(e,t){var n=t.datasets[e.datasetIndex].label||"";return n&&(n+=": "),n+e.yLabel},labelColor:function(e,t){var n=t.getDatasetMeta(e.datasetIndex).data[e.index]._view;return{borderColor:n.borderColor,backgroundColor:n.backgroundColor}},labelTextColor:function(){return this._options.bodyFontColor},afterLabel:r.noop,afterBody:r.noop,beforeFooter:r.noop,footer:r.noop,afterFooter:r.noop}}}),t.exports=function(e){function t(e,t){var n=r.color(e);return n.alpha(t*n.alpha()).rgbaString()}function n(e,t){return t&&(r.isArray(t)?Array.prototype.push.apply(e,t):e.push(t)),e}function a(e){var t=e._xScale,n=e._yScale||e._scale,o=e._index,i=e._datasetIndex;return{xLabel:t?t.getLabelForIndex(o,i):"",yLabel:n?n.getLabelForIndex(o,i):"",index:o,datasetIndex:i,x:e._model.x,y:e._model.y}}function s(e){var t=o.global,n=r.valueOrDefault;return{xPadding:e.xPadding,yPadding:e.yPadding,xAlign:e.xAlign,yAlign:e.yAlign,bodyFontColor:e.bodyFontColor,_bodyFontFamily:n(e.bodyFontFamily,t.defaultFontFamily),_bodyFontStyle:n(e.bodyFontStyle,t.defaultFontStyle),_bodyAlign:e.bodyAlign,bodyFontSize:n(e.bodyFontSize,t.defaultFontSize),bodySpacing:e.bodySpacing,titleFontColor:e.titleFontColor,_titleFontFamily:n(e.titleFontFamily,t.defaultFontFamily),_titleFontStyle:n(e.titleFontStyle,t.defaultFontStyle),titleFontSize:n(e.titleFontSize,t.defaultFontSize),_titleAlign:e.titleAlign,titleSpacing:e.titleSpacing,titleMarginBottom:e.titleMarginBottom,footerFontColor:e.footerFontColor,_footerFontFamily:n(e.footerFontFamily,t.defaultFontFamily),_footerFontStyle:n(e.footerFontStyle,t.defaultFontStyle),footerFontSize:n(e.footerFontSize,t.defaultFontSize),_footerAlign:e.footerAlign,footerSpacing:e.footerSpacing,footerMarginTop:e.footerMarginTop,caretSize:e.caretSize,cornerRadius:e.cornerRadius,backgroundColor:e.backgroundColor,opacity:0,legendColorBackground:e.multiKeyBackground,displayColors:e.displayColors,borderColor:e.borderColor,borderWidth:e.borderWidth}}e.Tooltip=i.extend({initialize:function(){this._model=s(this._options),this._lastActive=[]},getTitle:function(){var e=this,t=e._options.callbacks,o=t.beforeTitle.apply(e,arguments),i=t.title.apply(e,arguments),r=t.afterTitle.apply(e,arguments),a=[];return a=n(a,o),a=n(a,i),n(a,r)},getBeforeBody:function(){var e=this._options.callbacks.beforeBody.apply(this,arguments);return r.isArray(e)?e:void 0!==e?[e]:[]},getBody:function(e,t){var o=this,i=o._options.callbacks,a=[];return r.each(e,(function(e){var r={before:[],lines:[],after:[]};n(r.before,i.beforeLabel.call(o,e,t)),n(r.lines,i.label.call(o,e,t)),n(r.after,i.afterLabel.call(o,e,t)),a.push(r)})),a},getAfterBody:function(){var e=this._options.callbacks.afterBody.apply(this,arguments);return r.isArray(e)?e:void 0!==e?[e]:[]},getFooter:function(){var e=this,t=e._options.callbacks,o=t.beforeFooter.apply(e,arguments),i=t.footer.apply(e,arguments),r=t.afterFooter.apply(e,arguments),a=[];return a=n(a,o),a=n(a,i),n(a,r)},update:function(t){var n,o,i=this,l=i._options,u=i._model,c=i._model=s(l),d=i._active,f=i._data,h={xAlign:u.xAlign,yAlign:u.yAlign},g={x:u.x,y:u.y},m={width:u.width,height:u.height},p={x:u.caretX,y:u.caretY};if(d.length){c.opacity=1;var v=[],y=[];p=e.Tooltip.positioners[l.position].call(i,d,i._eventPosition);var b=[];for(n=0,o=d.length;n<o;++n)b.push(a(d[n]));l.filter&&(b=b.filter((function(e){return l.filter(e,f)}))),l.itemSort&&(b=b.sort((function(e,t){return l.itemSort(e,t,f)}))),r.each(b,(function(e){v.push(l.callbacks.labelColor.call(i,e,i._chart)),y.push(l.callbacks.labelTextColor.call(i,e,i._chart))})),c.title=i.getTitle(b,f),c.beforeBody=i.getBeforeBody(b,f),c.body=i.getBody(b,f),c.afterBody=i.getAfterBody(b,f),c.footer=i.getFooter(b,f),c.x=Math.round(p.x),c.y=Math.round(p.y),c.caretPadding=l.caretPadding,c.labelColors=v,c.labelTextColors=y,c.dataPoints=b,g=function(e,t,n){var o=e.x,i=e.y,r=e.caretPadding,a=n.xAlign,s=n.yAlign,l=e.caretSize+r,u=e.cornerRadius+r;return"right"===a?o-=t.width:"center"===a&&(o-=t.width/2),"top"===s?i+=l:i-="bottom"===s?t.height+l:t.height/2,"center"===s?"left"===a?o+=l:"right"===a&&(o-=l):"left"===a?o-=u:"right"===a&&(o+=u),{x:o,y:i}}(c,m=function(e,t){var n=e._chart.ctx,o=2*t.yPadding,i=0,a=t.body,s=a.reduce((function(e,t){return e+t.before.length+t.lines.length+t.after.length}),0),l=t.title.length,u=t.footer.length,c=t.titleFontSize,d=t.bodyFontSize,f=t.footerFontSize;o+=l*c,o+=l?(l-1)*t.titleSpacing:0,o+=l?t.titleMarginBottom:0,o+=(s+=t.beforeBody.length+t.afterBody.length)*d,o+=s?(s-1)*t.bodySpacing:0,o+=u?t.footerMarginTop:0,o+=u*f,o+=u?(u-1)*t.footerSpacing:0;var h=0,g=function(e){i=Math.max(i,n.measureText(e).width+h)};return n.font=r.fontString(c,t._titleFontStyle,t._titleFontFamily),r.each(t.title,g),n.font=r.fontString(d,t._bodyFontStyle,t._bodyFontFamily),r.each(t.beforeBody.concat(t.afterBody),g),h=t.displayColors?d+2:0,r.each(a,(function(e){r.each(e.before,g),r.each(e.lines,g),r.each(e.after,g)})),h=0,n.font=r.fontString(f,t._footerFontStyle,t._footerFontFamily),r.each(t.footer,g),{width:i+=2*t.xPadding,height:o}}(this,c),h=function(e,t){var n=e._model,o=e._chart,i=e._chart.chartArea,r="center",a="center";n.y<t.height?a="top":n.y>o.height-t.height&&(a="bottom");var s,l,u,c,d,f=(i.left+i.right)/2,h=(i.top+i.bottom)/2;"center"===a?(s=function(e){return e<=f},l=function(e){return e>f}):(s=function(e){return e<=t.width/2},l=function(e){return e>=o.width-t.width/2}),u=function(e){return e+t.width>o.width},c=function(e){return e-t.width<0},d=function(e){return e<=h?"top":"bottom"},s(n.x)?(r="left",u(n.x)&&(r="center",a=d(n.y))):l(n.x)&&(r="right",c(n.x)&&(r="center",a=d(n.y)));var g=e._options;return{xAlign:g.xAlign?g.xAlign:r,yAlign:g.yAlign?g.yAlign:a}}(this,m))}else c.opacity=0;return c.xAlign=h.xAlign,c.yAlign=h.yAlign,c.x=g.x,c.y=g.y,c.width=m.width,c.height=m.height,c.caretX=p.x,c.caretY=p.y,i._model=c,t&&l.custom&&l.custom.call(i,c),i},drawCaret:function(e,t){var n=this._chart.ctx,o=this.getCaretPosition(e,t,this._view);n.lineTo(o.x1,o.y1),n.lineTo(o.x2,o.y2),n.lineTo(o.x3,o.y3)},getCaretPosition:function(e,t,n){var o,i,r,a,s,l,u=n.caretSize,c=n.cornerRadius,d=n.xAlign,f=n.yAlign,h=e.x,g=e.y,m=t.width,p=t.height;if("center"===f)s=g+p/2,"left"===d?(i=(o=h)-u,r=o,a=s+u,l=s-u):(i=(o=h+m)+u,r=o,a=s-u,l=s+u);else if("left"===d?(o=(i=h+c+u)-u,r=i+u):"right"===d?(o=(i=h+m-c-u)-u,r=i+u):(o=(i=h+m/2)-u,r=i+u),"top"===f)s=(a=g)-u,l=a;else{s=(a=g+p)+u,l=a;var v=r;r=o,o=v}return{x1:o,x2:i,x3:r,y1:a,y2:s,y3:l}},drawTitle:function(e,n,o,i){var a=n.title;if(a.length){o.textAlign=n._titleAlign,o.textBaseline="top";var s,l,u=n.titleFontSize,c=n.titleSpacing;for(o.fillStyle=t(n.titleFontColor,i),o.font=r.fontString(u,n._titleFontStyle,n._titleFontFamily),s=0,l=a.length;s<l;++s)o.fillText(a[s],e.x,e.y),e.y+=u+c,s+1===a.length&&(e.y+=n.titleMarginBottom-c)}},drawBody:function(e,n,o,i){var a=n.bodyFontSize,s=n.bodySpacing,l=n.body;o.textAlign=n._bodyAlign,o.textBaseline="top",o.font=r.fontString(a,n._bodyFontStyle,n._bodyFontFamily);var u=0,c=function(t){o.fillText(t,e.x+u,e.y),e.y+=a+s};o.fillStyle=t(n.bodyFontColor,i),r.each(n.beforeBody,c);var d=n.displayColors;u=d?a+2:0,r.each(l,(function(s,l){var u=t(n.labelTextColors[l],i);o.fillStyle=u,r.each(s.before,c),r.each(s.lines,(function(r){d&&(o.fillStyle=t(n.legendColorBackground,i),o.fillRect(e.x,e.y,a,a),o.lineWidth=1,o.strokeStyle=t(n.labelColors[l].borderColor,i),o.strokeRect(e.x,e.y,a,a),o.fillStyle=t(n.labelColors[l].backgroundColor,i),o.fillRect(e.x+1,e.y+1,a-2,a-2),o.fillStyle=u),c(r)})),r.each(s.after,c)})),u=0,r.each(n.afterBody,c),e.y-=s},drawFooter:function(e,n,o,i){var a=n.footer;a.length&&(e.y+=n.footerMarginTop,o.textAlign=n._footerAlign,o.textBaseline="top",o.fillStyle=t(n.footerFontColor,i),o.font=r.fontString(n.footerFontSize,n._footerFontStyle,n._footerFontFamily),r.each(a,(function(t){o.fillText(t,e.x,e.y),e.y+=n.footerFontSize+n.footerSpacing})))},drawBackground:function(e,n,o,i,r){o.fillStyle=t(n.backgroundColor,r),o.strokeStyle=t(n.borderColor,r),o.lineWidth=n.borderWidth;var a=n.xAlign,s=n.yAlign,l=e.x,u=e.y,c=i.width,d=i.height,f=n.cornerRadius;o.beginPath(),o.moveTo(l+f,u),"top"===s&&this.drawCaret(e,i),o.lineTo(l+c-f,u),o.quadraticCurveTo(l+c,u,l+c,u+f),"center"===s&&"right"===a&&this.drawCaret(e,i),o.lineTo(l+c,u+d-f),o.quadraticCurveTo(l+c,u+d,l+c-f,u+d),"bottom"===s&&this.drawCaret(e,i),o.lineTo(l+f,u+d),o.quadraticCurveTo(l,u+d,l,u+d-f),"center"===s&&"left"===a&&this.drawCaret(e,i),o.lineTo(l,u+f),o.quadraticCurveTo(l,u,l+f,u),o.closePath(),o.fill(),n.borderWidth>0&&o.stroke()},draw:function(){var e=this._chart.ctx,t=this._view;if(0!==t.opacity){var n={width:t.width,height:t.height},o={x:t.x,y:t.y},i=Math.abs(t.opacity<.001)?0:t.opacity;this._options.enabled&&(t.title.length||t.beforeBody.length||t.body.length||t.afterBody.length||t.footer.length)&&(this.drawBackground(o,t,e,n,i),o.x+=t.xPadding,o.y+=t.yPadding,this.drawTitle(o,t,e,i),this.drawBody(o,t,e,i),this.drawFooter(o,t,e,i))}},handleEvent:function(e){var t=this,n=t._options,o=!1;if(t._lastActive=t._lastActive||[],t._active="mouseout"===e.type?[]:t._chart.getElementsAtEventForMode(e,n.mode,n),!(o=!r.arrayEquals(t._active,t._lastActive)))return!1;if(t._lastActive=t._active,n.enabled||n.custom){t._eventPosition={x:e.x,y:e.y};var i=t._model;t.update(!0),t.pivot(),o|=i.x!==t._model.x||i.y!==t._model.y}return o}}),e.Tooltip.positioners={average:function(e){if(!e.length)return!1;var t,n,o=0,i=0,r=0;for(t=0,n=e.length;t<n;++t){var a=e[t];if(a&&a.hasValue()){var s=a.tooltipPosition();o+=s.x,i+=s.y,++r}}return{x:Math.round(o/r),y:Math.round(i/r)}},nearest:function(e,t){var n,o,i,a=t.x,s=t.y,l=Number.POSITIVE_INFINITY;for(n=0,o=e.length;n<o;++n){var u=e[n];if(u&&u.hasValue()){var c=u.getCenterPoint(),d=r.distanceBetweenPoints(t,c);d<l&&(l=d,i=u)}}if(i){var f=i.tooltipPosition();a=f.x,s=f.y}return{x:a,y:s}}}}},{25:25,26:26,45:45}],36:[function(e,t,n){"use strict";var o=e(25),i=e(26),r=e(45);o._set("global",{elements:{arc:{backgroundColor:o.global.defaultColor,borderColor:"#fff",borderWidth:2}}}),t.exports=i.extend({inLabelRange:function(e){var t=this._view;return!!t&&Math.pow(e-t.x,2)<Math.pow(t.radius+t.hoverRadius,2)},inRange:function(e,t){var n=this._view;if(n){for(var o=r.getAngleFromPoint(n,{x:e,y:t}),i=o.angle,a=o.distance,s=n.startAngle,l=n.endAngle;l<s;)l+=2*Math.PI;for(;i>l;)i-=2*Math.PI;for(;i<s;)i+=2*Math.PI;return i>=s&&i<=l&&a>=n.innerRadius&&a<=n.outerRadius}return!1},getCenterPoint:function(){var e=this._view,t=(e.startAngle+e.endAngle)/2,n=(e.innerRadius+e.outerRadius)/2;return{x:e.x+Math.cos(t)*n,y:e.y+Math.sin(t)*n}},getArea:function(){var e=this._view;return Math.PI*((e.endAngle-e.startAngle)/(2*Math.PI))*(Math.pow(e.outerRadius,2)-Math.pow(e.innerRadius,2))},tooltipPosition:function(){var e=this._view,t=e.startAngle+(e.endAngle-e.startAngle)/2,n=(e.outerRadius-e.innerRadius)/2+e.innerRadius;return{x:e.x+Math.cos(t)*n,y:e.y+Math.sin(t)*n}},draw:function(){var e=this._chart.ctx,t=this._view,n=t.startAngle,o=t.endAngle;e.beginPath(),e.arc(t.x,t.y,t.outerRadius,n,o),e.arc(t.x,t.y,t.innerRadius,o,n,!0),e.closePath(),e.strokeStyle=t.borderColor,e.lineWidth=t.borderWidth,e.fillStyle=t.backgroundColor,e.fill(),e.lineJoin="bevel",t.borderWidth&&e.stroke()}})},{25:25,26:26,45:45}],37:[function(e,t,n){"use strict";var o=e(25),i=e(26),r=e(45),a=o.global;o._set("global",{elements:{line:{tension:.4,backgroundColor:a.defaultColor,borderWidth:3,borderColor:a.defaultColor,borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",capBezierPoints:!0,fill:!0}}}),t.exports=i.extend({draw:function(){var e,t,n,o,i=this,s=i._view,l=i._chart.ctx,u=s.spanGaps,c=i._children.slice(),d=a.elements.line,f=-1;for(i._loop&&c.length&&c.push(c[0]),l.save(),l.lineCap=s.borderCapStyle||d.borderCapStyle,l.setLineDash&&l.setLineDash(s.borderDash||d.borderDash),l.lineDashOffset=s.borderDashOffset||d.borderDashOffset,l.lineJoin=s.borderJoinStyle||d.borderJoinStyle,l.lineWidth=s.borderWidth||d.borderWidth,l.strokeStyle=s.borderColor||a.defaultColor,l.beginPath(),f=-1,e=0;e<c.length;++e)t=c[e],n=r.previousItem(c,e),o=t._view,0===e?o.skip||(l.moveTo(o.x,o.y),f=e):(n=-1===f?n:c[f],o.skip||(f!==e-1&&!u||-1===f?l.moveTo(o.x,o.y):r.canvas.lineTo(l,n._view,t._view),f=e));l.stroke(),l.restore()}})},{25:25,26:26,45:45}],38:[function(e,t,n){"use strict";function o(e){var t=this._view;return!!t&&Math.pow(e-t.x,2)<Math.pow(t.radius+t.hitRadius,2)}var i=e(25),r=e(26),a=e(45),s=i.global.defaultColor;i._set("global",{elements:{point:{radius:3,pointStyle:"circle",backgroundColor:s,borderColor:s,borderWidth:1,hitRadius:1,hoverRadius:4,hoverBorderWidth:1}}}),t.exports=r.extend({inRange:function(e,t){var n=this._view;return!!n&&Math.pow(e-n.x,2)+Math.pow(t-n.y,2)<Math.pow(n.hitRadius+n.radius,2)},inLabelRange:o,inXRange:o,inYRange:function(e){var t=this._view;return!!t&&Math.pow(e-t.y,2)<Math.pow(t.radius+t.hitRadius,2)},getCenterPoint:function(){var e=this._view;return{x:e.x,y:e.y}},getArea:function(){return Math.PI*Math.pow(this._view.radius,2)},tooltipPosition:function(){var e=this._view;return{x:e.x,y:e.y,padding:e.radius+e.borderWidth}},draw:function(e){var t=this._view,n=this._model,o=this._chart.ctx,r=t.pointStyle,l=t.radius,u=t.x,c=t.y,d=a.color,f=0;t.skip||(o.strokeStyle=t.borderColor||s,o.lineWidth=a.valueOrDefault(t.borderWidth,i.global.elements.point.borderWidth),o.fillStyle=t.backgroundColor||s,void 0!==e&&(n.x<e.left||1.01*e.right<n.x||n.y<e.top||1.01*e.bottom<n.y)&&(n.x<e.left?f=(u-n.x)/(e.left-n.x):1.01*e.right<n.x?f=(n.x-u)/(n.x-e.right):n.y<e.top?f=(c-n.y)/(e.top-n.y):1.01*e.bottom<n.y&&(f=(n.y-c)/(n.y-e.bottom)),f=Math.round(100*f)/100,o.strokeStyle=d(o.strokeStyle).alpha(f).rgbString(),o.fillStyle=d(o.fillStyle).alpha(f).rgbString()),a.canvas.drawPoint(o,r,l,u,c))}})},{25:25,26:26,45:45}],39:[function(e,t,n){"use strict";function o(e){return void 0!==e._view.width}function i(e){var t,n,i,r,a=e._view;if(o(e)){var s=a.width/2;t=a.x-s,n=a.x+s,i=Math.min(a.y,a.base),r=Math.max(a.y,a.base)}else{var l=a.height/2;t=Math.min(a.x,a.base),n=Math.max(a.x,a.base),i=a.y-l,r=a.y+l}return{left:t,top:i,right:n,bottom:r}}var r=e(25),a=e(26);r._set("global",{elements:{rectangle:{backgroundColor:r.global.defaultColor,borderColor:r.global.defaultColor,borderSkipped:"bottom",borderWidth:0}}}),t.exports=a.extend({draw:function(){function e(e){return v[(y+e)%4]}var t,n,o,i,r,a,s,l=this._chart.ctx,u=this._view,c=u.borderWidth;if(u.horizontal?(o=u.y-u.height/2,i=u.y+u.height/2,r=(n=u.x)>(t=u.base)?1:-1,a=1,s=u.borderSkipped||"left"):(t=u.x-u.width/2,n=u.x+u.width/2,r=1,a=(i=u.base)>(o=u.y)?1:-1,s=u.borderSkipped||"bottom"),c){var d=Math.min(Math.abs(t-n),Math.abs(o-i)),f=(c=c>d?d:c)/2,h=t+("left"!==s?f*r:0),g=n+("right"!==s?-f*r:0),m=o+("top"!==s?f*a:0),p=i+("bottom"!==s?-f*a:0);h!==g&&(o=m,i=p),m!==p&&(t=h,n=g)}l.beginPath(),l.fillStyle=u.backgroundColor,l.strokeStyle=u.borderColor,l.lineWidth=c;var v=[[t,i],[t,o],[n,o],[n,i]],y=["bottom","left","top","right"].indexOf(s,0);-1===y&&(y=0);var b=e(0);l.moveTo(b[0],b[1]);for(var C=1;C<4;C++)b=e(C),l.lineTo(b[0],b[1]);l.fill(),c&&l.stroke()},height:function(){var e=this._view;return e.base-e.y},inRange:function(e,t){var n=!1;if(this._view){var o=i(this);n=e>=o.left&&e<=o.right&&t>=o.top&&t<=o.bottom}return n},inLabelRange:function(e,t){var n=this;if(!n._view)return!1;var r=i(n);return o(n)?e>=r.left&&e<=r.right:t>=r.top&&t<=r.bottom},inXRange:function(e){var t=i(this);return e>=t.left&&e<=t.right},inYRange:function(e){var t=i(this);return e>=t.top&&e<=t.bottom},getCenterPoint:function(){var e,t,n=this._view;return o(this)?(e=n.x,t=(n.y+n.base)/2):(e=(n.x+n.base)/2,t=n.y),{x:e,y:t}},getArea:function(){var e=this._view;return e.width*Math.abs(e.y-e.base)},tooltipPosition:function(){var e=this._view;return{x:e.x,y:e.y}}})},{25:25,26:26}],40:[function(e,t,n){"use strict";t.exports={},t.exports.Arc=e(36),t.exports.Line=e(37),t.exports.Point=e(38),t.exports.Rectangle=e(39)},{36:36,37:37,38:38,39:39}],41:[function(e,t,n){"use strict";var o=e(42);n=t.exports={clear:function(e){e.ctx.clearRect(0,0,e.width,e.height)},roundedRect:function(e,t,n,o,i,r){if(r){var a=Math.min(r,o/2),s=Math.min(r,i/2);e.moveTo(t+a,n),e.lineTo(t+o-a,n),e.quadraticCurveTo(t+o,n,t+o,n+s),e.lineTo(t+o,n+i-s),e.quadraticCurveTo(t+o,n+i,t+o-a,n+i),e.lineTo(t+a,n+i),e.quadraticCurveTo(t,n+i,t,n+i-s),e.lineTo(t,n+s),e.quadraticCurveTo(t,n,t+a,n)}else e.rect(t,n,o,i)},drawPoint:function(e,t,n,o,i){var r,a,s,l,u,c;if(!t||"object"!=typeof t||"[object HTMLImageElement]"!==(r=t.toString())&&"[object HTMLCanvasElement]"!==r){if(!(isNaN(n)||n<=0)){switch(t){default:e.beginPath(),e.arc(o,i,n,0,2*Math.PI),e.closePath(),e.fill();break;case"triangle":e.beginPath(),u=(a=3*n/Math.sqrt(3))*Math.sqrt(3)/2,e.moveTo(o-a/2,i+u/3),e.lineTo(o+a/2,i+u/3),e.lineTo(o,i-2*u/3),e.closePath(),e.fill();break;case"rect":c=1/Math.SQRT2*n,e.beginPath(),e.fillRect(o-c,i-c,2*c,2*c),e.strokeRect(o-c,i-c,2*c,2*c);break;case"rectRounded":var d=n/Math.SQRT2,f=o-d,h=i-d,g=Math.SQRT2*n;e.beginPath(),this.roundedRect(e,f,h,g,g,n/2),e.closePath(),e.fill();break;case"rectRot":c=1/Math.SQRT2*n,e.beginPath(),e.moveTo(o-c,i),e.lineTo(o,i+c),e.lineTo(o+c,i),e.lineTo(o,i-c),e.closePath(),e.fill();break;case"cross":e.beginPath(),e.moveTo(o,i+n),e.lineTo(o,i-n),e.moveTo(o-n,i),e.lineTo(o+n,i),e.closePath();break;case"crossRot":e.beginPath(),s=Math.cos(Math.PI/4)*n,l=Math.sin(Math.PI/4)*n,e.moveTo(o-s,i-l),e.lineTo(o+s,i+l),e.moveTo(o-s,i+l),e.lineTo(o+s,i-l),e.closePath();break;case"star":e.beginPath(),e.moveTo(o,i+n),e.lineTo(o,i-n),e.moveTo(o-n,i),e.lineTo(o+n,i),s=Math.cos(Math.PI/4)*n,l=Math.sin(Math.PI/4)*n,e.moveTo(o-s,i-l),e.lineTo(o+s,i+l),e.moveTo(o-s,i+l),e.lineTo(o+s,i-l),e.closePath();break;case"line":e.beginPath(),e.moveTo(o-n,i),e.lineTo(o+n,i),e.closePath();break;case"dash":e.beginPath(),e.moveTo(o,i),e.lineTo(o+n,i),e.closePath()}e.stroke()}}else e.drawImage(t,o-t.width/2,i-t.height/2,t.width,t.height)},clipArea:function(e,t){e.save(),e.beginPath(),e.rect(t.left,t.top,t.right-t.left,t.bottom-t.top),e.clip()},unclipArea:function(e){e.restore()},lineTo:function(e,t,n,o){if(n.steppedLine)return"after"===n.steppedLine&&!o||"after"!==n.steppedLine&&o?e.lineTo(t.x,n.y):e.lineTo(n.x,t.y),void e.lineTo(n.x,n.y);n.tension?e.bezierCurveTo(o?t.controlPointPreviousX:t.controlPointNextX,o?t.controlPointPreviousY:t.controlPointNextY,o?n.controlPointNextX:n.controlPointPreviousX,o?n.controlPointNextY:n.controlPointPreviousY,n.x,n.y):e.lineTo(n.x,n.y)}},o.clear=n.clear,o.drawRoundedRectangle=function(e){e.beginPath(),n.roundedRect.apply(n,arguments),e.closePath()}},{42:42}],42:[function(e,t,n){"use strict";var o={noop:function(){},uid:function(){var e=0;return function(){return e++}}(),isNullOrUndef:function(e){return null==e},isArray:Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},isObject:function(e){return null!==e&&"[object Object]"===Object.prototype.toString.call(e)},valueOrDefault:function(e,t){return void 0===e?t:e},valueAtIndexOrDefault:function(e,t,n){return o.valueOrDefault(o.isArray(e)?e[t]:e,n)},callback:function(e,t,n){if(e&&"function"==typeof e.call)return e.apply(n,t)},each:function(e,t,n,i){var r,a,s;if(o.isArray(e))if(a=e.length,i)for(r=a-1;r>=0;r--)t.call(n,e[r],r);else for(r=0;r<a;r++)t.call(n,e[r],r);else if(o.isObject(e))for(a=(s=Object.keys(e)).length,r=0;r<a;r++)t.call(n,e[s[r]],s[r])},arrayEquals:function(e,t){var n,i,r,a;if(!e||!t||e.length!==t.length)return!1;for(n=0,i=e.length;n<i;++n)if(a=t[n],(r=e[n])instanceof Array&&a instanceof Array){if(!o.arrayEquals(r,a))return!1}else if(r!==a)return!1;return!0},clone:function(e){if(o.isArray(e))return e.map(o.clone);if(o.isObject(e)){for(var t={},n=Object.keys(e),i=n.length,r=0;r<i;++r)t[n[r]]=o.clone(e[n[r]]);return t}return e},_merger:function(e,t,n,i){var r=t[e],a=n[e];o.isObject(r)&&o.isObject(a)?o.merge(r,a,i):t[e]=o.clone(a)},_mergerIf:function(e,t,n){var i=t[e],r=n[e];o.isObject(i)&&o.isObject(r)?o.mergeIf(i,r):t.hasOwnProperty(e)||(t[e]=o.clone(r))},merge:function(e,t,n){var i,r,a,s,l,u=o.isArray(t)?t:[t],c=u.length;if(!o.isObject(e))return e;for(i=(n=n||{}).merger||o._merger,r=0;r<c;++r)if(o.isObject(t=u[r]))for(l=0,s=(a=Object.keys(t)).length;l<s;++l)i(a[l],e,t,n);return e},mergeIf:function(e,t){return o.merge(e,t,{merger:o._mergerIf})},extend:function(e){for(var t=1,n=arguments.length;t<n;++t)o.each(arguments[t],(function(t,n){e[n]=t}));return e},inherits:function(e){var t=this,n=e&&e.hasOwnProperty("constructor")?e.constructor:function(){return t.apply(this,arguments)},i=function(){this.constructor=n};return i.prototype=t.prototype,n.prototype=new i,n.extend=o.inherits,e&&o.extend(n.prototype,e),n.__super__=t.prototype,n}};t.exports=o,o.callCallback=o.callback,o.indexOf=function(e,t,n){return Array.prototype.indexOf.call(e,t,n)},o.getValueOrDefault=o.valueOrDefault,o.getValueAtIndexOrDefault=o.valueAtIndexOrDefault},{}],43:[function(e,t,n){"use strict";var o=e(42),i={linear:function(e){return e},easeInQuad:function(e){return e*e},easeOutQuad:function(e){return-e*(e-2)},easeInOutQuad:function(e){return(e/=.5)<1?.5*e*e:-.5*(--e*(e-2)-1)},easeInCubic:function(e){return e*e*e},easeOutCubic:function(e){return(e-=1)*e*e+1},easeInOutCubic:function(e){return(e/=.5)<1?.5*e*e*e:.5*((e-=2)*e*e+2)},easeInQuart:function(e){return e*e*e*e},easeOutQuart:function(e){return-((e-=1)*e*e*e-1)},easeInOutQuart:function(e){return(e/=.5)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2)},easeInQuint:function(e){return e*e*e*e*e},easeOutQuint:function(e){return(e-=1)*e*e*e*e+1},easeInOutQuint:function(e){return(e/=.5)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2)},easeInSine:function(e){return 1-Math.cos(e*(Math.PI/2))},easeOutSine:function(e){return Math.sin(e*(Math.PI/2))},easeInOutSine:function(e){return-.5*(Math.cos(Math.PI*e)-1)},easeInExpo:function(e){return 0===e?0:Math.pow(2,10*(e-1))},easeOutExpo:function(e){return 1===e?1:1-Math.pow(2,-10*e)},easeInOutExpo:function(e){return 0===e?0:1===e?1:(e/=.5)<1?.5*Math.pow(2,10*(e-1)):.5*(2-Math.pow(2,-10*--e))},easeInCirc:function(e){return e>=1?e:-(Math.sqrt(1-e*e)-1)},easeOutCirc:function(e){return Math.sqrt(1-(e-=1)*e)},easeInOutCirc:function(e){return(e/=.5)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)},easeInElastic:function(e){var t=1.70158,n=0,o=1;return 0===e?0:1===e?1:(n||(n=.3),o<1?(o=1,t=n/4):t=n/(2*Math.PI)*Math.asin(1/o),-o*Math.pow(2,10*(e-=1))*Math.sin((e-t)*(2*Math.PI)/n))},easeOutElastic:function(e){var t=1.70158,n=0,o=1;return 0===e?0:1===e?1:(n||(n=.3),o<1?(o=1,t=n/4):t=n/(2*Math.PI)*Math.asin(1/o),o*Math.pow(2,-10*e)*Math.sin((e-t)*(2*Math.PI)/n)+1)},easeInOutElastic:function(e){var t=1.70158,n=0,o=1;return 0===e?0:2==(e/=.5)?1:(n||(n=.45),o<1?(o=1,t=n/4):t=n/(2*Math.PI)*Math.asin(1/o),e<1?o*Math.pow(2,10*(e-=1))*Math.sin((e-t)*(2*Math.PI)/n)*-.5:o*Math.pow(2,-10*(e-=1))*Math.sin((e-t)*(2*Math.PI)/n)*.5+1)},easeInBack:function(e){var t=1.70158;return e*e*((t+1)*e-t)},easeOutBack:function(e){var t=1.70158;return(e-=1)*e*((t+1)*e+t)+1},easeInOutBack:function(e){var t=1.70158;return(e/=.5)<1?e*e*((1+(t*=1.525))*e-t)*.5:.5*((e-=2)*e*((1+(t*=1.525))*e+t)+2)},easeInBounce:function(e){return 1-i.easeOutBounce(1-e)},easeOutBounce:function(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},easeInOutBounce:function(e){return e<.5?.5*i.easeInBounce(2*e):.5*i.easeOutBounce(2*e-1)+.5}};t.exports={effects:i},o.easingEffects=i},{42:42}],44:[function(e,t,n){"use strict";var o=e(42);t.exports={toLineHeight:function(e,t){var n=(""+e).match(/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/);if(!n||"normal"===n[1])return 1.2*t;switch(e=+n[2],n[3]){case"px":return e;case"%":e/=100}return t*e},toPadding:function(e){var t,n,i,r;return o.isObject(e)?(t=+e.top||0,n=+e.right||0,i=+e.bottom||0,r=+e.left||0):t=n=i=r=+e||0,{top:t,right:n,bottom:i,left:r,height:t+i,width:r+n}},resolve:function(e,t,n){var i,r,a;for(i=0,r=e.length;i<r;++i)if(void 0!==(a=e[i])&&(void 0!==t&&"function"==typeof a&&(a=a(t)),void 0!==n&&o.isArray(a)&&(a=a[n]),void 0!==a))return a}}},{42:42}],45:[function(e,t,n){"use strict";t.exports=e(42),t.exports.easing=e(43),t.exports.canvas=e(41),t.exports.options=e(44)},{41:41,42:42,43:43,44:44}],46:[function(e,t,n){t.exports={acquireContext:function(e){return e&&e.canvas&&(e=e.canvas),e&&e.getContext("2d")||null}}},{}],47:[function(e,t,n){"use strict";function o(e,t){var n=s.getStyle(e,t),o=n&&n.match(/^(\d+)(\.\d+)?px$/);return o?Number(o[1]):void 0}function i(e,t,n){e.addEventListener(t,n,g)}function r(e,t,n){e.removeEventListener(t,n,g)}function a(e,t,n,o,i){return{type:e,chart:t,native:i||null,x:void 0!==n?n:null,y:void 0!==o?o:null}}var s=e(45),l="$chartjs",u="chartjs-",c=u+"render-monitor",d=u+"render-animation",f=["animationstart","webkitAnimationStart"],h={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},g=!!function(){var e=!1;try{var t=Object.defineProperty({},"passive",{get:function(){e=!0}});window.addEventListener("e",null,t)}catch(e){}return e}()&&{passive:!0};t.exports={_enabled:"undefined"!=typeof window&&"undefined"!=typeof document,initialize:function(){var e="from{opacity:0.99}to{opacity:1}";!function(e,t){var n=e._style||document.createElement("style");e._style||(e._style=n,t="/* Chart.js */\n"+t,n.setAttribute("type","text/css"),document.getElementsByTagName("head")[0].appendChild(n)),n.appendChild(document.createTextNode(t))}(this,"@-webkit-keyframes "+d+"{"+e+"}@keyframes "+d+"{"+e+"}."+c+"{-webkit-animation:"+d+" 0.001s;animation:"+d+" 0.001s;}")},acquireContext:function(e,t){"string"==typeof e?e=document.getElementById(e):e.length&&(e=e[0]),e&&e.canvas&&(e=e.canvas);var n=e&&e.getContext&&e.getContext("2d");return n&&n.canvas===e?(function(e,t){var n=e.style,i=e.getAttribute("height"),r=e.getAttribute("width");if(e[l]={initial:{height:i,width:r,style:{display:n.display,height:n.height,width:n.width}}},n.display=n.display||"block",null===r||""===r){var a=o(e,"width");void 0!==a&&(e.width=a)}if(null===i||""===i)if(""===e.style.height)e.height=e.width/(t.options.aspectRatio||2);else{var s=o(e,"height");void 0!==a&&(e.height=s)}}(e,t),n):null},releaseContext:function(e){var t=e.canvas;if(t[l]){var n=t[l].initial;["height","width"].forEach((function(e){var o=n[e];s.isNullOrUndef(o)?t.removeAttribute(e):t.setAttribute(e,o)})),s.each(n.style||{},(function(e,n){t.style[n]=e})),t.width=t.width,delete t[l]}},addEventListener:function(e,t,n){var o=e.canvas;if("resize"!==t){var r=n[l]||(n[l]={});i(o,t,(r.proxies||(r.proxies={}))[e.id+"_"+t]=function(t){n(function(e,t){var n=h[e.type]||e.type,o=s.getRelativePosition(e,t);return a(n,t,o.x,o.y,e)}(t,e))})}else!function(e,t,n){var o=e[l]||(e[l]={}),r=o.resizer=function(e){var t=document.createElement("div"),n=u+"size-monitor",o="position:absolute;left:0;top:0;right:0;bottom:0;overflow:hidden;pointer-events:none;visibility:hidden;z-index:-1;";t.style.cssText=o,t.className=n,t.innerHTML='<div class="'+n+'-expand" style="'+o+'"><div style="position:absolute;width:1000000px;height:1000000px;left:0;top:0"></div></div><div class="'+n+'-shrink" style="'+o+'"><div style="position:absolute;width:200%;height:200%;left:0; top:0"></div></div>';var r=t.childNodes[0],a=t.childNodes[1];t._reset=function(){r.scrollLeft=1e6,r.scrollTop=1e6,a.scrollLeft=1e6,a.scrollTop=1e6};var s=function(){t._reset(),e()};return i(r,"scroll",s.bind(r,"expand")),i(a,"scroll",s.bind(a,"shrink")),t}(function(e,t){var n=!1,o=[];return function(){o=Array.prototype.slice.call(arguments),t=t||this,n||(n=!0,s.requestAnimFrame.call(window,(function(){n=!1,e.apply(t,o)})))}}((function(){if(o.resizer)return t(a("resize",n))})));!function(e,t){var n=e[l]||(e[l]={}),o=n.renderProxy=function(e){e.animationName===d&&t()};s.each(f,(function(t){i(e,t,o)})),n.reflow=!!e.offsetParent,e.classList.add(c)}(e,(function(){if(o.resizer){var t=e.parentNode;t&&t!==r.parentNode&&t.insertBefore(r,t.firstChild),r._reset()}}))}(o,n,e)},removeEventListener:function(e,t,n){var o=e.canvas;if("resize"!==t){var i=((n[l]||{}).proxies||{})[e.id+"_"+t];i&&r(o,t,i)}else!function(e){var t=e[l]||{},n=t.resizer;delete t.resizer,function(e){var t=e[l]||{},n=t.renderProxy;n&&(s.each(f,(function(t){r(e,t,n)})),delete t.renderProxy),e.classList.remove(c)}(e),n&&n.parentNode&&n.parentNode.removeChild(n)}(o)}},s.addEvent=i,s.removeEvent=r},{45:45}],48:[function(e,t,n){"use strict";var o=e(45),i=e(46),r=e(47);t.exports=o.extend({initialize:function(){},acquireContext:function(){},releaseContext:function(){},addEventListener:function(){},removeEventListener:function(){}},r._enabled?r:i)},{45:45,46:46,47:47}],49:[function(e,t,n){"use strict";var o=e(25),i=e(40),r=e(45);o._set("global",{plugins:{filler:{propagate:!0}}}),t.exports=function(){function e(e,t,n){var o,i=e._model||{},r=i.fill;if(void 0===r&&(r=!!i.backgroundColor),!1===r||null===r)return!1;if(!0===r)return"origin";if(o=parseFloat(r,10),isFinite(o)&&Math.floor(o)===o)return"-"!==r[0]&&"+"!==r[0]||(o=t+o),!(o===t||o<0||o>=n)&&o;switch(r){case"bottom":return"start";case"top":return"end";case"zero":return"origin";case"origin":case"start":case"end":return r;default:return!1}}function t(e){var t,n=e.el._model||{},o=e.el._scale||{},i=e.fill,r=null;if(isFinite(i))return null;if("start"===i?r=void 0===n.scaleBottom?o.bottom:n.scaleBottom:"end"===i?r=void 0===n.scaleTop?o.top:n.scaleTop:void 0!==n.scaleZero?r=n.scaleZero:o.getBasePosition?r=o.getBasePosition():o.getBasePixel&&(r=o.getBasePixel()),null!=r){if(void 0!==r.x&&void 0!==r.y)return r;if("number"==typeof r&&isFinite(r))return{x:(t=o.isHorizontal())?r:null,y:t?null:r}}return null}function n(e,t,n){var o,i=e[t].fill,r=[t];if(!n)return i;for(;!1!==i&&-1===r.indexOf(i);){if(!isFinite(i))return i;if(!(o=e[i]))return!1;if(o.visible)return i;r.push(i),i=o.fill}return!1}function a(e){var t=e.fill,n="dataset";return!1===t?null:(isFinite(t)||(n="boundary"),c[n](e))}function s(e){return e&&!e.skip}function l(e,t,n,o,i){var a;if(o&&i){for(e.moveTo(t[0].x,t[0].y),a=1;a<o;++a)r.canvas.lineTo(e,t[a-1],t[a]);for(e.lineTo(n[i-1].x,n[i-1].y),a=i-1;a>0;--a)r.canvas.lineTo(e,n[a],n[a-1],!0)}}function u(e,t,n,o,i,r){var a,u,c,d,f,h,g,m=t.length,p=o.spanGaps,v=[],y=[],b=0,C=0;for(e.beginPath(),a=0,u=m+!!r;a<u;++a)f=n(d=t[c=a%m]._view,c,o),h=s(d),g=s(f),h&&g?(b=v.push(d),C=y.push(f)):b&&C&&(p?(h&&v.push(d),g&&y.push(f)):(l(e,v,y,b,C),b=C=0,v=[],y=[]));l(e,v,y,b,C),e.closePath(),e.fillStyle=i,e.fill()}var c={dataset:function(e){var t=e.fill,n=e.chart,o=n.getDatasetMeta(t),i=o&&n.isDatasetVisible(t)&&o.dataset._children||[],r=i.length||0;return r?function(e,t){return t<r&&i[t]._view||null}:null},boundary:function(e){var t=e.boundary,n=t?t.x:null,o=t?t.y:null;return function(e){return{x:null===n?e.x:n,y:null===o?e.y:o}}}};return{id:"filler",afterDatasetsUpdate:function(o,r){var s,l,u,c,d=(o.data.datasets||[]).length,f=r.propagate,h=[];for(l=0;l<d;++l)c=null,(u=(s=o.getDatasetMeta(l)).dataset)&&u._model&&u instanceof i.Line&&(c={visible:o.isDatasetVisible(l),fill:e(u,l,d),chart:o,el:u}),s.$filler=c,h.push(c);for(l=0;l<d;++l)(c=h[l])&&(c.fill=n(h,l,f),c.boundary=t(c),c.mapper=a(c))},beforeDatasetDraw:function(e,t){var n=t.meta.$filler;if(n){var i=e.ctx,a=n.el,s=a._view,l=a._children||[],c=n.mapper,d=s.backgroundColor||o.global.defaultColor;c&&d&&l.length&&(r.canvas.clipArea(i,e.chartArea),u(i,l,c,s,d,a._loop),r.canvas.unclipArea(i))}}}}},{25:25,40:40,45:45}],50:[function(e,t,n){"use strict";var o=e(25),i=e(26),r=e(45);o._set("global",{legend:{display:!0,position:"top",fullWidth:!0,reverse:!1,weight:1e3,onClick:function(e,t){var n=t.datasetIndex,o=this.chart,i=o.getDatasetMeta(n);i.hidden=null===i.hidden?!o.data.datasets[n].hidden:null,o.update()},onHover:null,labels:{boxWidth:40,padding:10,generateLabels:function(e){var t=e.data;return r.isArray(t.datasets)?t.datasets.map((function(t,n){return{text:t.label,fillStyle:r.isArray(t.backgroundColor)?t.backgroundColor[0]:t.backgroundColor,hidden:!e.isDatasetVisible(n),lineCap:t.borderCapStyle,lineDash:t.borderDash,lineDashOffset:t.borderDashOffset,lineJoin:t.borderJoinStyle,lineWidth:t.borderWidth,strokeStyle:t.borderColor,pointStyle:t.pointStyle,datasetIndex:n}}),this):[]}}},legendCallback:function(e){var t=[];t.push('<ul class="'+e.id+'-legend">');for(var n=0;n<e.data.datasets.length;n++)t.push('<li><span style="background-color:'+e.data.datasets[n].backgroundColor+'"></span>'),e.data.datasets[n].label&&t.push(e.data.datasets[n].label),t.push("</li>");return t.push("</ul>"),t.join("")}}),t.exports=function(e){function t(e,t){return e.usePointStyle?t*Math.SQRT2:e.boxWidth}function n(t,n){var o=new e.Legend({ctx:t.ctx,options:n,chart:t});a.configure(t,o,n),a.addBox(t,o),t.legend=o}var a=e.layoutService,s=r.noop;return e.Legend=i.extend({initialize:function(e){r.extend(this,e),this.legendHitBoxes=[],this.doughnutMode=!1},beforeUpdate:s,update:function(e,t,n){var o=this;return o.beforeUpdate(),o.maxWidth=e,o.maxHeight=t,o.margins=n,o.beforeSetDimensions(),o.setDimensions(),o.afterSetDimensions(),o.beforeBuildLabels(),o.buildLabels(),o.afterBuildLabels(),o.beforeFit(),o.fit(),o.afterFit(),o.afterUpdate(),o.minSize},afterUpdate:s,beforeSetDimensions:s,setDimensions:function(){var e=this;e.isHorizontal()?(e.width=e.maxWidth,e.left=0,e.right=e.width):(e.height=e.maxHeight,e.top=0,e.bottom=e.height),e.paddingLeft=0,e.paddingTop=0,e.paddingRight=0,e.paddingBottom=0,e.minSize={width:0,height:0}},afterSetDimensions:s,beforeBuildLabels:s,buildLabels:function(){var e=this,t=e.options.labels||{},n=r.callback(t.generateLabels,[e.chart],e)||[];t.filter&&(n=n.filter((function(n){return t.filter(n,e.chart.data)}))),e.options.reverse&&n.reverse(),e.legendItems=n},afterBuildLabels:s,beforeFit:s,fit:function(){var e=this,n=e.options,i=n.labels,a=n.display,s=e.ctx,l=o.global,u=r.valueOrDefault,c=u(i.fontSize,l.defaultFontSize),d=u(i.fontStyle,l.defaultFontStyle),f=u(i.fontFamily,l.defaultFontFamily),h=r.fontString(c,d,f),g=e.legendHitBoxes=[],m=e.minSize,p=e.isHorizontal();if(p?(m.width=e.maxWidth,m.height=a?10:0):(m.width=a?10:0,m.height=e.maxHeight),a)if(s.font=h,p){var v=e.lineWidths=[0],y=e.legendItems.length?c+i.padding:0;s.textAlign="left",s.textBaseline="top",r.each(e.legendItems,(function(n,o){var r=t(i,c)+c/2+s.measureText(n.text).width;v[v.length-1]+r+i.padding>=e.width&&(y+=c+i.padding,v[v.length]=e.left),g[o]={left:0,top:0,width:r,height:c},v[v.length-1]+=r+i.padding})),m.height+=y}else{var b=i.padding,C=e.columnWidths=[],T=i.padding,x=0,E=0,_=c+b;r.each(e.legendItems,(function(e,n){var o=t(i,c)+c/2+s.measureText(e.text).width;E+_>m.height&&(T+=x+i.padding,C.push(x),x=0,E=0),x=Math.max(x,o),E+=_,g[n]={left:0,top:0,width:o,height:c}})),T+=x,C.push(x),m.width+=T}e.width=m.width,e.height=m.height},afterFit:s,isHorizontal:function(){return"top"===this.options.position||"bottom"===this.options.position},draw:function(){var e=this,n=e.options,i=n.labels,a=o.global,s=a.elements.line,l=e.width,u=e.lineWidths;if(n.display){var c,d=e.ctx,f=r.valueOrDefault,h=f(i.fontColor,a.defaultFontColor),g=f(i.fontSize,a.defaultFontSize),m=f(i.fontStyle,a.defaultFontStyle),p=f(i.fontFamily,a.defaultFontFamily),v=r.fontString(g,m,p);d.textAlign="left",d.textBaseline="middle",d.lineWidth=.5,d.strokeStyle=h,d.fillStyle=h,d.font=v;var y=t(i,g),b=e.legendHitBoxes,C=function(e,t,o){if(!(isNaN(y)||y<=0)){d.save(),d.fillStyle=f(o.fillStyle,a.defaultColor),d.lineCap=f(o.lineCap,s.borderCapStyle),d.lineDashOffset=f(o.lineDashOffset,s.borderDashOffset),d.lineJoin=f(o.lineJoin,s.borderJoinStyle),d.lineWidth=f(o.lineWidth,s.borderWidth),d.strokeStyle=f(o.strokeStyle,a.defaultColor);var i=0===f(o.lineWidth,s.borderWidth);if(d.setLineDash&&d.setLineDash(f(o.lineDash,s.borderDash)),n.labels&&n.labels.usePointStyle){var l=g*Math.SQRT2/2,u=l/Math.SQRT2;r.canvas.drawPoint(d,o.pointStyle,l,e+u,t+u)}else i||d.strokeRect(e,t,y,g),d.fillRect(e,t,y,g);d.restore()}},T=e.isHorizontal();c=T?{x:e.left+(l-u[0])/2,y:e.top+i.padding,line:0}:{x:e.left+i.padding,y:e.top+i.padding,line:0};var x=g+i.padding;r.each(e.legendItems,(function(t,n){var o=d.measureText(t.text).width,r=y+g/2+o,a=c.x,s=c.y;T?a+r>=l&&(s=c.y+=x,c.line++,a=c.x=e.left+(l-u[c.line])/2):s+x>e.bottom&&(a=c.x=a+e.columnWidths[c.line]+i.padding,s=c.y=e.top+i.padding,c.line++),C(a,s,t),b[n].left=a,b[n].top=s,function(e,t,n,o){var i=g/2,r=y+i+e,a=t+i;d.fillText(n.text,r,a),n.hidden&&(d.beginPath(),d.lineWidth=2,d.moveTo(r,a),d.lineTo(r+o,a),d.stroke())}(a,s,t,o),T?c.x+=r+i.padding:c.y+=x}))}},handleEvent:function(e){var t=this,n=t.options,o="mouseup"===e.type?"click":e.type,i=!1;if("mousemove"===o){if(!n.onHover)return}else{if("click"!==o)return;if(!n.onClick)return}var r=e.x,a=e.y;if(r>=t.left&&r<=t.right&&a>=t.top&&a<=t.bottom)for(var s=t.legendHitBoxes,l=0;l<s.length;++l){var u=s[l];if(r>=u.left&&r<=u.left+u.width&&a>=u.top&&a<=u.top+u.height){if("click"===o){n.onClick.call(t,e.native,t.legendItems[l]),i=!0;break}if("mousemove"===o){n.onHover.call(t,e.native,t.legendItems[l]),i=!0;break}}}return i}}),{id:"legend",beforeInit:function(e){var t=e.options.legend;t&&n(e,t)},beforeUpdate:function(e){var t=e.options.legend,i=e.legend;t?(r.mergeIf(t,o.global.legend),i?(a.configure(e,i,t),i.options=t):n(e,t)):i&&(a.removeBox(e,i),delete e.legend)},afterEvent:function(e,t){var n=e.legend;n&&n.handleEvent(t)}}}},{25:25,26:26,45:45}],51:[function(e,t,n){"use strict";var o=e(25),i=e(26),r=e(45);o._set("global",{title:{display:!1,fontStyle:"bold",fullWidth:!0,lineHeight:1.2,padding:10,position:"top",text:"",weight:2e3}}),t.exports=function(e){function t(t,o){var i=new e.Title({ctx:t.ctx,options:o,chart:t});n.configure(t,i,o),n.addBox(t,i),t.titleBlock=i}var n=e.layoutService,a=r.noop;return e.Title=i.extend({initialize:function(e){r.extend(this,e),this.legendHitBoxes=[]},beforeUpdate:a,update:function(e,t,n){var o=this;return o.beforeUpdate(),o.maxWidth=e,o.maxHeight=t,o.margins=n,o.beforeSetDimensions(),o.setDimensions(),o.afterSetDimensions(),o.beforeBuildLabels(),o.buildLabels(),o.afterBuildLabels(),o.beforeFit(),o.fit(),o.afterFit(),o.afterUpdate(),o.minSize},afterUpdate:a,beforeSetDimensions:a,setDimensions:function(){var e=this;e.isHorizontal()?(e.width=e.maxWidth,e.left=0,e.right=e.width):(e.height=e.maxHeight,e.top=0,e.bottom=e.height),e.paddingLeft=0,e.paddingTop=0,e.paddingRight=0,e.paddingBottom=0,e.minSize={width:0,height:0}},afterSetDimensions:a,beforeBuildLabels:a,buildLabels:a,afterBuildLabels:a,beforeFit:a,fit:function(){var e=this,t=e.options,n=t.display,i=(0,r.valueOrDefault)(t.fontSize,o.global.defaultFontSize),a=e.minSize,s=r.isArray(t.text)?t.text.length:1,l=r.options.toLineHeight(t.lineHeight,i),u=n?s*l+2*t.padding:0;e.isHorizontal()?(a.width=e.maxWidth,a.height=u):(a.width=u,a.height=e.maxHeight),e.width=a.width,e.height=a.height},afterFit:a,isHorizontal:function(){var e=this.options.position;return"top"===e||"bottom"===e},draw:function(){var e=this,t=e.ctx,n=r.valueOrDefault,i=e.options,a=o.global;if(i.display){var s,l,u,c=n(i.fontSize,a.defaultFontSize),d=n(i.fontStyle,a.defaultFontStyle),f=n(i.fontFamily,a.defaultFontFamily),h=r.fontString(c,d,f),g=r.options.toLineHeight(i.lineHeight,c),m=g/2+i.padding,p=0,v=e.top,y=e.left,b=e.bottom,C=e.right;t.fillStyle=n(i.fontColor,a.defaultFontColor),t.font=h,e.isHorizontal()?(l=y+(C-y)/2,u=v+m,s=C-y):(l="left"===i.position?y+m:C-m,u=v+(b-v)/2,s=b-v,p=Math.PI*("left"===i.position?-.5:.5)),t.save(),t.translate(l,u),t.rotate(p),t.textAlign="center",t.textBaseline="middle";var T=i.text;if(r.isArray(T))for(var x=0,E=0;E<T.length;++E)t.fillText(T[E],0,x,s),x+=g;else t.fillText(T,0,0,s);t.restore()}}}),{id:"title",beforeInit:function(e){var n=e.options.title;n&&t(e,n)},beforeUpdate:function(i){var a=i.options.title,s=i.titleBlock;a?(r.mergeIf(a,o.global.title),s?(n.configure(i,s,a),s.options=a):t(i,a)):s&&(e.layoutService.removeBox(i,s),delete i.titleBlock)}}}},{25:25,26:26,45:45}],52:[function(e,t,n){"use strict";t.exports=function(e){var t=e.Scale.extend({getLabels:function(){var e=this.chart.data;return this.options.labels||(this.isHorizontal()?e.xLabels:e.yLabels)||e.labels},determineDataLimits:function(){var e,t=this,n=t.getLabels();t.minIndex=0,t.maxIndex=n.length-1,void 0!==t.options.ticks.min&&(e=n.indexOf(t.options.ticks.min),t.minIndex=-1!==e?e:t.minIndex),void 0!==t.options.ticks.max&&(e=n.indexOf(t.options.ticks.max),t.maxIndex=-1!==e?e:t.maxIndex),t.min=n[t.minIndex],t.max=n[t.maxIndex]},buildTicks:function(){var e=this,t=e.getLabels();e.ticks=0===e.minIndex&&e.maxIndex===t.length-1?t:t.slice(e.minIndex,e.maxIndex+1)},getLabelForIndex:function(e,t){var n=this,o=n.chart.data,i=n.isHorizontal();return o.yLabels&&!i?n.getRightValue(o.datasets[t].data[e]):n.ticks[e-n.minIndex]},getPixelForValue:function(e,t){var n,o=this,i=o.options.offset,r=Math.max(o.maxIndex+1-o.minIndex-(i?0:1),1);if(null!=e&&(n=o.isHorizontal()?e.x:e.y),void 0!==n||void 0!==e&&isNaN(t)){var a=o.getLabels().indexOf(e=n||e);t=-1!==a?a:t}if(o.isHorizontal()){var s=o.width/r,l=s*(t-o.minIndex);return i&&(l+=s/2),o.left+Math.round(l)}var u=o.height/r,c=u*(t-o.minIndex);return i&&(c+=u/2),o.top+Math.round(c)},getPixelForTick:function(e){return this.getPixelForValue(this.ticks[e],e+this.minIndex,null)},getValueForPixel:function(e){var t=this,n=t.options.offset,o=Math.max(t._ticks.length-(n?0:1),1),i=t.isHorizontal(),r=(i?t.width:t.height)/o;return e-=i?t.left:t.top,n&&(e-=r/2),(e<=0?0:Math.round(e/r))+t.minIndex},getBasePixel:function(){return this.bottom}});e.scaleService.registerScaleType("category",t,{position:"bottom"})}},{}],53:[function(e,t,n){"use strict";var o=e(25),i=e(45),r=e(34);t.exports=function(e){var t={position:"left",ticks:{callback:r.formatters.linear}},n=e.LinearScaleBase.extend({determineDataLimits:function(){function e(e){return a?e.xAxisID===t.id:e.yAxisID===t.id}var t=this,n=t.options,o=t.chart,r=o.data.datasets,a=t.isHorizontal();t.min=null,t.max=null;var s=n.stacked;if(void 0===s&&i.each(r,(function(t,n){if(!s){var i=o.getDatasetMeta(n);o.isDatasetVisible(n)&&e(i)&&void 0!==i.stack&&(s=!0)}})),n.stacked||s){var l={};i.each(r,(function(r,a){var s=o.getDatasetMeta(a),u=[s.type,void 0===n.stacked&&void 0===s.stack?a:"",s.stack].join(".");void 0===l[u]&&(l[u]={positiveValues:[],negativeValues:[]});var c=l[u].positiveValues,d=l[u].negativeValues;o.isDatasetVisible(a)&&e(s)&&i.each(r.data,(function(e,o){var i=+t.getRightValue(e);isNaN(i)||s.data[o].hidden||(c[o]=c[o]||0,d[o]=d[o]||0,n.relativePoints?c[o]=100:i<0?d[o]+=i:c[o]+=i)}))})),i.each(l,(function(e){var n=e.positiveValues.concat(e.negativeValues),o=i.min(n),r=i.max(n);t.min=null===t.min?o:Math.min(t.min,o),t.max=null===t.max?r:Math.max(t.max,r)}))}else i.each(r,(function(n,r){var a=o.getDatasetMeta(r);o.isDatasetVisible(r)&&e(a)&&i.each(n.data,(function(e,n){var o=+t.getRightValue(e);isNaN(o)||a.data[n].hidden||((null===t.min||o<t.min)&&(t.min=o),(null===t.max||o>t.max)&&(t.max=o))}))}));t.min=isFinite(t.min)&&!isNaN(t.min)?t.min:0,t.max=isFinite(t.max)&&!isNaN(t.max)?t.max:1,this.handleTickRangeOptions()},getTickLimit:function(){var e,t=this,n=t.options.ticks;if(t.isHorizontal())e=Math.min(n.maxTicksLimit?n.maxTicksLimit:11,Math.ceil(t.width/50));else{var r=i.valueOrDefault(n.fontSize,o.global.defaultFontSize);e=Math.min(n.maxTicksLimit?n.maxTicksLimit:11,Math.ceil(t.height/(2*r)))}return e},handleDirectionalChanges:function(){this.isHorizontal()||this.ticks.reverse()},getLabelForIndex:function(e,t){return+this.getRightValue(this.chart.data.datasets[t].data[e])},getPixelForValue:function(e){var t,n=this,o=n.start,i=+n.getRightValue(e),r=n.end-o;return n.isHorizontal()?(t=n.left+n.width/r*(i-o),Math.round(t)):(t=n.bottom-n.height/r*(i-o),Math.round(t))},getValueForPixel:function(e){var t=this,n=t.isHorizontal();return t.start+(n?e-t.left:t.bottom-e)/(n?t.width:t.height)*(t.end-t.start)},getPixelForTick:function(e){return this.getPixelForValue(this.ticksAsNumbers[e])}});e.scaleService.registerScaleType("linear",n,t)}},{25:25,34:34,45:45}],54:[function(e,t,n){"use strict";var o=e(45),i=e(34);t.exports=function(e){var t=o.noop;e.LinearScaleBase=e.Scale.extend({getRightValue:function(t){return"string"==typeof t?+t:e.Scale.prototype.getRightValue.call(this,t)},handleTickRangeOptions:function(){var e=this,t=e.options.ticks;if(t.beginAtZero){var n=o.sign(e.min),i=o.sign(e.max);n<0&&i<0?e.max=0:n>0&&i>0&&(e.min=0)}var r=void 0!==t.min||void 0!==t.suggestedMin,a=void 0!==t.max||void 0!==t.suggestedMax;void 0!==t.min?e.min=t.min:void 0!==t.suggestedMin&&(e.min=null===e.min?t.suggestedMin:Math.min(e.min,t.suggestedMin)),void 0!==t.max?e.max=t.max:void 0!==t.suggestedMax&&(e.max=null===e.max?t.suggestedMax:Math.max(e.max,t.suggestedMax)),r!==a&&e.min>=e.max&&(r?e.max=e.min+1:e.min=e.max-1),e.min===e.max&&(e.max++,t.beginAtZero||e.min--)},getTickLimit:t,handleDirectionalChanges:t,buildTicks:function(){var e=this,t=e.options.ticks,n=e.getTickLimit(),r={maxTicks:n=Math.max(2,n),min:t.min,max:t.max,stepSize:o.valueOrDefault(t.fixedStepSize,t.stepSize)},a=e.ticks=i.generators.linear(r,e);e.handleDirectionalChanges(),e.max=o.max(a),e.min=o.min(a),t.reverse?(a.reverse(),e.start=e.max,e.end=e.min):(e.start=e.min,e.end=e.max)},convertTicksToLabels:function(){var t=this;t.ticksAsNumbers=t.ticks.slice(),t.zeroLineIndex=t.ticks.indexOf(0),e.Scale.prototype.convertTicksToLabels.call(t)}})}},{34:34,45:45}],55:[function(e,t,n){"use strict";var o=e(45),i=e(34);t.exports=function(e){var t={position:"left",ticks:{callback:i.formatters.logarithmic}},n=e.Scale.extend({determineDataLimits:function(){function e(e){return l?e.xAxisID===t.id:e.yAxisID===t.id}var t=this,n=t.options,i=n.ticks,r=t.chart,a=r.data.datasets,s=o.valueOrDefault,l=t.isHorizontal();t.min=null,t.max=null,t.minNotZero=null;var u=n.stacked;if(void 0===u&&o.each(a,(function(t,n){if(!u){var o=r.getDatasetMeta(n);r.isDatasetVisible(n)&&e(o)&&void 0!==o.stack&&(u=!0)}})),n.stacked||u){var c={};o.each(a,(function(i,a){var s=r.getDatasetMeta(a),l=[s.type,void 0===n.stacked&&void 0===s.stack?a:"",s.stack].join(".");r.isDatasetVisible(a)&&e(s)&&(void 0===c[l]&&(c[l]=[]),o.each(i.data,(function(e,o){var i=c[l],r=+t.getRightValue(e);isNaN(r)||s.data[o].hidden||(i[o]=i[o]||0,n.relativePoints?i[o]=100:i[o]+=r)})))})),o.each(c,(function(e){var n=o.min(e),i=o.max(e);t.min=null===t.min?n:Math.min(t.min,n),t.max=null===t.max?i:Math.max(t.max,i)}))}else o.each(a,(function(n,i){var a=r.getDatasetMeta(i);r.isDatasetVisible(i)&&e(a)&&o.each(n.data,(function(e,n){var o=+t.getRightValue(e);isNaN(o)||a.data[n].hidden||((null===t.min||o<t.min)&&(t.min=o),(null===t.max||o>t.max)&&(t.max=o),0!==o&&(null===t.minNotZero||o<t.minNotZero)&&(t.minNotZero=o))}))}));t.min=s(i.min,t.min),t.max=s(i.max,t.max),t.min===t.max&&(0!==t.min&&null!==t.min?(t.min=Math.pow(10,Math.floor(o.log10(t.min))-1),t.max=Math.pow(10,Math.floor(o.log10(t.max))+1)):(t.min=1,t.max=10))},buildTicks:function(){var e=this,t=e.options.ticks,n=e.ticks=i.generators.logarithmic({min:t.min,max:t.max},e);e.isHorizontal()||n.reverse(),e.max=o.max(n),e.min=o.min(n),t.reverse?(n.reverse(),e.start=e.max,e.end=e.min):(e.start=e.min,e.end=e.max)},convertTicksToLabels:function(){this.tickValues=this.ticks.slice(),e.Scale.prototype.convertTicksToLabels.call(this)},getLabelForIndex:function(e,t){return+this.getRightValue(this.chart.data.datasets[t].data[e])},getPixelForTick:function(e){return this.getPixelForValue(this.tickValues[e])},getPixelForValue:function(e){var t,n,i,r=this,a=r.start,s=+r.getRightValue(e),l=r.options.ticks;return r.isHorizontal()?(i=o.log10(r.end)-o.log10(a),n=0===s?r.left:r.left+(t=r.width)/i*(o.log10(s)-o.log10(a))):(t=r.height,0!==a||l.reverse?0===r.end&&l.reverse?(i=o.log10(r.start)-o.log10(r.minNotZero),n=s===r.end?r.top:s===r.minNotZero?r.top+.02*t:r.top+.02*t+.98*t/i*(o.log10(s)-o.log10(r.minNotZero))):0===s?n=l.reverse?r.top:r.bottom:(i=o.log10(r.end)-o.log10(a),n=r.bottom-(t=r.height)/i*(o.log10(s)-o.log10(a))):(i=o.log10(r.end)-o.log10(r.minNotZero),n=s===a?r.bottom:s===r.minNotZero?r.bottom-.02*t:r.bottom-.02*t-.98*t/i*(o.log10(s)-o.log10(r.minNotZero)))),n},getValueForPixel:function(e){var t,n,i=this,r=o.log10(i.end)-o.log10(i.start);return i.isHorizontal()?(n=i.width,t=i.start*Math.pow(10,(e-i.left)*r/n)):(n=i.height,t=Math.pow(10,(i.bottom-e)*r/n)/i.start),t}});e.scaleService.registerScaleType("logarithmic",n,t)}},{34:34,45:45}],56:[function(e,t,n){"use strict";var o=e(25),i=e(45),r=e(34);t.exports=function(e){function t(e){var t=e.options;return t.angleLines.display||t.pointLabels.display?e.chart.data.labels.length:0}function n(e){var t=e.options.pointLabels,n=i.valueOrDefault(t.fontSize,g.defaultFontSize),o=i.valueOrDefault(t.fontStyle,g.defaultFontStyle),r=i.valueOrDefault(t.fontFamily,g.defaultFontFamily);return{size:n,style:o,family:r,font:i.fontString(n,o,r)}}function a(e,t,n){return i.isArray(n)?{w:i.longestText(e,e.font,n),h:n.length*t+1.5*(n.length-1)*t}:{w:e.measureText(n).width,h:t}}function s(e,t,n,o,i){return e===o||e===i?{start:t-n/2,end:t+n/2}:e<o||e>i?{start:t-n-5,end:t}:{start:t,end:t+n+5}}function l(e){return 0===e||180===e?"center":e<180?"left":"right"}function u(e,t,n,o){if(i.isArray(t))for(var r=n.y,a=1.5*o,s=0;s<t.length;++s)e.fillText(t[s],n.x,r),r+=a;else e.fillText(t,n.x,n.y)}function c(e,t,n){90===e||270===e?n.y-=t.h/2:(e>270||e<90)&&(n.y-=t.h)}function d(e){var o=e.ctx,r=i.valueOrDefault,a=e.options,s=a.angleLines,d=a.pointLabels;o.lineWidth=s.lineWidth,o.strokeStyle=s.color;var f=e.getDistanceFromCenterForValue(a.ticks.reverse?e.min:e.max),h=n(e);o.textBaseline="top";for(var m=t(e)-1;m>=0;m--){if(s.display){var p=e.getPointPosition(m,f);o.beginPath(),o.moveTo(e.xCenter,e.yCenter),o.lineTo(p.x,p.y),o.stroke(),o.closePath()}if(d.display){var v=e.getPointPosition(m,f+5),y=r(d.fontColor,g.defaultFontColor);o.font=h.font,o.fillStyle=y;var b=e.getIndexAngle(m),C=i.toDegrees(b);o.textAlign=l(C),c(C,e._pointLabelSizes[m],v),u(o,e.pointLabels[m]||"",v,h.size)}}}function f(e,n,o,r){var a=e.ctx;if(a.strokeStyle=i.valueAtIndexOrDefault(n.color,r-1),a.lineWidth=i.valueAtIndexOrDefault(n.lineWidth,r-1),e.options.gridLines.circular)a.beginPath(),a.arc(e.xCenter,e.yCenter,o,0,2*Math.PI),a.closePath(),a.stroke();else{var s=t(e);if(0===s)return;a.beginPath();var l=e.getPointPosition(0,o);a.moveTo(l.x,l.y);for(var u=1;u<s;u++)l=e.getPointPosition(u,o),a.lineTo(l.x,l.y);a.closePath(),a.stroke()}}function h(e){return i.isNumber(e)?e:0}var g=o.global,m={display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,color:"rgba(0, 0, 0, 0.1)",lineWidth:1},gridLines:{circular:!1},ticks:{showLabelBackdrop:!0,backdropColor:"rgba(255,255,255,0.75)",backdropPaddingY:2,backdropPaddingX:2,callback:r.formatters.linear},pointLabels:{display:!0,fontSize:10,callback:function(e){return e}}},p=e.LinearScaleBase.extend({setDimensions:function(){var e=this,t=e.options,n=t.ticks;e.width=e.maxWidth,e.height=e.maxHeight,e.xCenter=Math.round(e.width/2),e.yCenter=Math.round(e.height/2);var o=i.min([e.height,e.width]),r=i.valueOrDefault(n.fontSize,g.defaultFontSize);e.drawingArea=t.display?o/2-(r/2+n.backdropPaddingY):o/2},determineDataLimits:function(){var e=this,t=e.chart,n=Number.POSITIVE_INFINITY,o=Number.NEGATIVE_INFINITY;i.each(t.data.datasets,(function(r,a){if(t.isDatasetVisible(a)){var s=t.getDatasetMeta(a);i.each(r.data,(function(t,i){var r=+e.getRightValue(t);isNaN(r)||s.data[i].hidden||(n=Math.min(r,n),o=Math.max(r,o))}))}})),e.min=n===Number.POSITIVE_INFINITY?0:n,e.max=o===Number.NEGATIVE_INFINITY?0:o,e.handleTickRangeOptions()},getTickLimit:function(){var e=this.options.ticks,t=i.valueOrDefault(e.fontSize,g.defaultFontSize);return Math.min(e.maxTicksLimit?e.maxTicksLimit:11,Math.ceil(this.drawingArea/(1.5*t)))},convertTicksToLabels:function(){var t=this;e.LinearScaleBase.prototype.convertTicksToLabels.call(t),t.pointLabels=t.chart.data.labels.map(t.options.pointLabels.callback,t)},getLabelForIndex:function(e,t){return+this.getRightValue(this.chart.data.datasets[t].data[e])},fit:function(){this.options.pointLabels.display?function(e){var o,r,l,u=n(e),c=Math.min(e.height/2,e.width/2),d={r:e.width,l:0,t:e.height,b:0},f={};e.ctx.font=u.font,e._pointLabelSizes=[];var h=t(e);for(o=0;o<h;o++){l=e.getPointPosition(o,c),r=a(e.ctx,u.size,e.pointLabels[o]||""),e._pointLabelSizes[o]=r;var g=e.getIndexAngle(o),m=i.toDegrees(g)%360,p=s(m,l.x,r.w,0,180),v=s(m,l.y,r.h,90,270);p.start<d.l&&(d.l=p.start,f.l=g),p.end>d.r&&(d.r=p.end,f.r=g),v.start<d.t&&(d.t=v.start,f.t=g),v.end>d.b&&(d.b=v.end,f.b=g)}e.setReductions(c,d,f)}(this):function(e){var t=Math.min(e.height/2,e.width/2);e.drawingArea=Math.round(t),e.setCenterPoint(0,0,0,0)}(this)},setReductions:function(e,t,n){var o=this,i=t.l/Math.sin(n.l),r=Math.max(t.r-o.width,0)/Math.sin(n.r),a=-t.t/Math.cos(n.t),s=-Math.max(t.b-o.height,0)/Math.cos(n.b);i=h(i),r=h(r),a=h(a),s=h(s),o.drawingArea=Math.min(Math.round(e-(i+r)/2),Math.round(e-(a+s)/2)),o.setCenterPoint(i,r,a,s)},setCenterPoint:function(e,t,n,o){var i=this,r=n+i.drawingArea,a=i.height-o-i.drawingArea;i.xCenter=Math.round((e+i.drawingArea+(i.width-t-i.drawingArea))/2+i.left),i.yCenter=Math.round((r+a)/2+i.top)},getIndexAngle:function(e){return e*(2*Math.PI/t(this))+(this.chart.options&&this.chart.options.startAngle?this.chart.options.startAngle:0)*Math.PI*2/360},getDistanceFromCenterForValue:function(e){var t=this;if(null===e)return 0;var n=t.drawingArea/(t.max-t.min);return t.options.ticks.reverse?(t.max-e)*n:(e-t.min)*n},getPointPosition:function(e,t){var n=this,o=n.getIndexAngle(e)-Math.PI/2;return{x:Math.round(Math.cos(o)*t)+n.xCenter,y:Math.round(Math.sin(o)*t)+n.yCenter}},getPointPositionForValue:function(e,t){return this.getPointPosition(e,this.getDistanceFromCenterForValue(t))},getBasePosition:function(){var e=this,t=e.min,n=e.max;return e.getPointPositionForValue(0,e.beginAtZero?0:t<0&&n<0?n:t>0&&n>0?t:0)},draw:function(){var e=this,t=e.options,n=t.gridLines,o=t.ticks,r=i.valueOrDefault;if(t.display){var a=e.ctx,s=this.getIndexAngle(0),l=r(o.fontSize,g.defaultFontSize),u=r(o.fontStyle,g.defaultFontStyle),c=r(o.fontFamily,g.defaultFontFamily),h=i.fontString(l,u,c);i.each(e.ticks,(function(t,i){if(i>0||o.reverse){var u=e.getDistanceFromCenterForValue(e.ticksAsNumbers[i]);if(n.display&&0!==i&&f(e,n,u,i),o.display){var c=r(o.fontColor,g.defaultFontColor);if(a.font=h,a.save(),a.translate(e.xCenter,e.yCenter),a.rotate(s),o.showLabelBackdrop){var d=a.measureText(t).width;a.fillStyle=o.backdropColor,a.fillRect(-d/2-o.backdropPaddingX,-u-l/2-o.backdropPaddingY,d+2*o.backdropPaddingX,l+2*o.backdropPaddingY)}a.textAlign="center",a.textBaseline="middle",a.fillStyle=c,a.fillText(t,0,-u),a.restore()}}})),(t.angleLines.display||t.pointLabels.display)&&d(e)}}});e.scaleService.registerScaleType("radialLinear",p,m)}},{25:25,34:34,45:45}],57:[function(e,t,n){"use strict";function o(e,t){return e-t}function i(e){var t,n,o,i={},r=[];for(t=0,n=e.length;t<n;++t)i[o=e[t]]||(i[o]=!0,r.push(o));return r}function r(e,t,n,o){var i=function(e,t,n){for(var o,i,r,a=0,s=e.length-1;a>=0&&a<=s;){if(r=e[o=a+s>>1],!(i=e[o-1]||null))return{lo:null,hi:r};if(r[t]<n)a=o+1;else{if(!(i[t]>n))return{lo:i,hi:r};s=o-1}}return{lo:r,hi:null}}(e,t,n),r=i.lo?i.hi?i.lo:e[e.length-2]:e[0],a=i.lo?i.hi?i.hi:e[e.length-1]:e[1],s=a[t]-r[t];return r[o]+(a[o]-r[o])*(s?(n-r[t])/s:0)}function a(e,t){var n=t.parser,o=t.parser||t.format;return"function"==typeof n?n(e):"string"==typeof e&&"string"==typeof o?c(e,o):(e instanceof c||(e=c(e)),e.isValid()?e:"function"==typeof o?o(e):e)}function s(e,t){if(f.isNullOrUndef(e))return null;var n=t.options.time,o=a(t.getRightValue(e),n);return o.isValid()?(n.round&&o.startOf(n.round),o.valueOf()):null}function l(e){for(var t=p.indexOf(e)+1,n=p.length;t<n;++t)if(m[p[t]].common)return p[t]}function u(e,t,n,o,i){var a,s=0,l=0;return i.offset&&t.length&&(i.time.min||(a=t[0],s=(r(e,"time",t.length>1?t[1]:o,"pos")-r(e,"time",a,"pos"))/2),i.time.max||(a=t.length>1?t[t.length-2]:n,l=(r(e,"time",t[t.length-1],"pos")-r(e,"time",a,"pos"))/2)),{left:s,right:l}}var c=e(1);c="function"==typeof c?c:window.moment;var d=e(25),f=e(45),h=Number.MIN_SAFE_INTEGER||-9007199254740991,g=Number.MAX_SAFE_INTEGER||9007199254740991,m={millisecond:{common:!0,size:1,steps:[1,2,5,10,20,50,100,250,500]},second:{common:!0,size:1e3,steps:[1,2,5,10,30]},minute:{common:!0,size:6e4,steps:[1,2,5,10,30]},hour:{common:!0,size:36e5,steps:[1,2,3,6,12]},day:{common:!0,size:864e5,steps:[1,2,5]},week:{common:!1,size:6048e5,steps:[1,2,3,4]},month:{common:!0,size:2628e6,steps:[1,2,3]},quarter:{common:!1,size:7884e6,steps:[1,2,3,4]},year:{common:!0,size:3154e7}},p=Object.keys(m);t.exports=function(e){var t=e.Scale.extend({initialize:function(){if(!c)throw new Error("Chart.js - Moment.js could not be found! You must include it before Chart.js to use the time scale. Download at https://momentjs.com");this.mergeTicksOptions(),e.Scale.prototype.initialize.call(this)},update:function(){var t=this,n=t.options;return n.time&&n.time.format&&console.warn("options.time.format is deprecated and replaced by options.time.parser."),e.Scale.prototype.update.apply(t,arguments)},getRightValue:function(t){return t&&void 0!==t.t&&(t=t.t),e.Scale.prototype.getRightValue.call(this,t)},determineDataLimits:function(){var e,t,n,r,a,l,u=this,d=u.chart,m=u.options.time,p=g,v=h,y=[],b=[],C=[];for(e=0,n=d.data.labels.length;e<n;++e)C.push(s(d.data.labels[e],u));for(e=0,n=(d.data.datasets||[]).length;e<n;++e)if(d.isDatasetVisible(e))if(f.isObject((a=d.data.datasets[e].data)[0]))for(b[e]=[],t=0,r=a.length;t<r;++t)l=s(a[t],u),y.push(l),b[e][t]=l;else y.push.apply(y,C),b[e]=C.slice(0);else b[e]=[];C.length&&(C=i(C).sort(o),p=Math.min(p,C[0]),v=Math.max(v,C[C.length-1])),y.length&&(y=i(y).sort(o),p=Math.min(p,y[0]),v=Math.max(v,y[y.length-1])),p=s(m.min,u)||p,v=s(m.max,u)||v,p=p===g?+c().startOf("day"):p,v=v===h?+c().endOf("day")+1:v,u.min=Math.min(p,v),u.max=Math.max(p+1,v),u._horizontal=u.isHorizontal(),u._table=[],u._timestamps={data:y,datasets:b,labels:C}},buildTicks:function(){var e,t,n,o=this,i=o.min,r=o.max,a=o.options,d=a.time,h=[],v=[];switch(a.ticks.source){case"data":h=o._timestamps.data;break;case"labels":h=o._timestamps.labels;break;case"auto":default:h=function(e,t,n,o){var i,r=o.time,a=r.unit||function(e,t,n,o){var i,r,a=p.length;for(i=p.indexOf(e);i<a-1;++i)if((r=m[p[i]]).common&&Math.ceil((n-t)/((r.steps?r.steps[r.steps.length-1]:g)*r.size))<=o)return p[i];return p[a-1]}(r.minUnit,e,t,n),s=l(a),u=f.valueOrDefault(r.stepSize,r.unitStepSize),d="week"===a&&r.isoWeekday,h=o.ticks.major.enabled,v=m[a],y=c(e),b=c(t),C=[];for(u||(u=function(e,t,n,o){var i,r,a,s=t-e,l=m[n],u=l.size,c=l.steps;if(!c)return Math.ceil(s/((o||1)*u));for(i=0,r=c.length;i<r&&(a=c[i],!(Math.ceil(s/(u*a))<=o));++i);return a}(e,t,a,n)),d&&(y=y.isoWeekday(d),b=b.isoWeekday(d)),y=y.startOf(d?"day":a),(b=b.startOf(d?"day":a))<t&&b.add(1,a),i=c(y),h&&s&&!d&&!r.round&&(i.startOf(s),i.add(~~((y-i)/(v.size*u))*u,a));i<b;i.add(u,a))C.push(+i);return C.push(+i),C}(i,r,o.getLabelCapacity(i),a)}for("ticks"===a.bounds&&h.length&&(i=h[0],r=h[h.length-1]),i=s(d.min,o)||i,r=s(d.max,o)||r,e=0,t=h.length;e<t;++e)(n=h[e])>=i&&n<=r&&v.push(n);return o.min=i,o.max=r,o._unit=d.unit||function(e,t,n,o){var i,r,a=c.duration(c(o).diff(c(n)));for(i=p.length-1;i>=p.indexOf(t);i--)if(m[r=p[i]].common&&a.as(r)>=e.length)return r;return p[t?p.indexOf(t):0]}(v,d.minUnit,o.min,o.max),o._majorUnit=l(o._unit),o._table=function(e,t,n,o){if("linear"===o||!e.length)return[{time:t,pos:0},{time:n,pos:1}];var i,r,a,s,l,u=[],c=[t];for(i=0,r=e.length;i<r;++i)(s=e[i])>t&&s<n&&c.push(s);for(c.push(n),i=0,r=c.length;i<r;++i)l=c[i+1],s=c[i],void 0!==(a=c[i-1])&&void 0!==l&&Math.round((l+a)/2)===s||u.push({time:s,pos:i/(r-1)});return u}(o._timestamps.data,i,r,a.distribution),o._offsets=u(o._table,v,i,r,a),function(e,t){var n,o,i,r,a=[];for(n=0,o=e.length;n<o;++n)i=e[n],r=!!t&&i===+c(i).startOf(t),a.push({value:i,major:r});return a}(v,o._majorUnit)},getLabelForIndex:function(e,t){var n=this,o=n.chart.data,i=n.options.time,r=o.labels&&e<o.labels.length?o.labels[e]:"",s=o.datasets[t].data[e];return f.isObject(s)&&(r=n.getRightValue(s)),i.tooltipFormat&&(r=a(r,i).format(i.tooltipFormat)),r},tickFormatFunction:function(e,t,n,o){var i=this,r=i.options,a=e.valueOf(),s=r.time.displayFormats,l=s[i._unit],u=i._majorUnit,c=s[u],d=e.clone().startOf(u).valueOf(),h=r.ticks.major,g=h.enabled&&u&&c&&a===d,m=e.format(o||(g?c:l)),p=g?h:r.ticks.minor,v=f.valueOrDefault(p.callback,p.userCallback);return v?v(m,t,n):m},convertTicksToLabels:function(e){var t,n,o=[];for(t=0,n=e.length;t<n;++t)o.push(this.tickFormatFunction(c(e[t].value),t,e));return o},getPixelForOffset:function(e){var t=this,n=t._horizontal?t.width:t.height,o=t._horizontal?t.left:t.top,i=r(t._table,"time",e,"pos");return o+n*(t._offsets.left+i)/(t._offsets.left+1+t._offsets.right)},getPixelForValue:function(e,t,n){var o=this,i=null;if(void 0!==t&&void 0!==n&&(i=o._timestamps.datasets[n][t]),null===i&&(i=s(e,o)),null!==i)return o.getPixelForOffset(i)},getPixelForTick:function(e){var t=this.getTicks();return e>=0&&e<t.length?this.getPixelForOffset(t[e].value):null},getValueForPixel:function(e){var t=this,n=t._horizontal?t.width:t.height,o=r(t._table,"pos",(n?(e-(t._horizontal?t.left:t.top))/n:0)*(t._offsets.left+1+t._offsets.left)-t._offsets.right,"time");return c(o)},getLabelWidth:function(e){var t=this.options.ticks,n=this.ctx.measureText(e).width,o=f.toRadians(t.maxRotation),i=Math.cos(o),r=Math.sin(o);return n*i+f.valueOrDefault(t.fontSize,d.global.defaultFontSize)*r},getLabelCapacity:function(e){var t=this,n=t.options.time.displayFormats.millisecond,o=t.tickFormatFunction(c(e),0,[],n),i=t.getLabelWidth(o),r=t.isHorizontal()?t.width:t.height;return Math.floor(r/i)}});e.scaleService.registerScaleType("time",t,{position:"bottom",distribution:"linear",bounds:"data",time:{parser:!1,format:!1,unit:!1,round:!1,displayFormat:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{millisecond:"h:mm:ss.SSS a",second:"h:mm:ss a",minute:"h:mm a",hour:"hA",day:"MMM D",week:"ll",month:"MMM YYYY",quarter:"[Q]Q - YYYY",year:"YYYY"}},ticks:{autoSkip:!1,source:"auto",major:{enabled:!1}}})}},{1:1,25:25,45:45}]},{},[7])(7)})),function(){if(!window.CKEDITOR||!window.CKEDITOR.dom){var e;window.CKEDITOR||(window.CKEDITOR=function(){var e=/(^|.*[\\\/])ckeditor\.js(?:\?.*|;.*)?$/i,t={timestamp:"J8Q8",version:"4.13.0",revision:"83e9de8d6b",rnd:Math.floor(900*Math.random())+100,_:{pending:[],basePathSrcPattern:e},status:"unloaded",basePath:function(){var t=window.CKEDITOR_BASEPATH||"";if(!t)for(var n=document.getElementsByTagName("script"),o=0;o<n.length;o++){var i=n[o].src.match(e);if(i){t=i[1];break}}if(-1==t.indexOf(":/")&&"//"!=t.slice(0,2)&&(t=0===t.indexOf("/")?location.href.match(/^.*?:\/\/[^\/]*/)[0]+t:location.href.match(/^[^\?]*\/(?:)/)[0]+t),!t)throw'The CKEditor installation path could not be automatically detected. Please set the global variable "CKEDITOR_BASEPATH" before creating editor instances.';return t}(),getUrl:function(e){return-1==e.indexOf(":/")&&0!==e.indexOf("/")&&(e=this.basePath+e),this.timestamp&&"/"!=e.charAt(e.length-1)&&!/[&?]t=/.test(e)&&(e+=(0<=e.indexOf("?")?"&":"?")+"t="+this.timestamp),e},domReady:function(){function e(){try{document.addEventListener?(document.removeEventListener("DOMContentLoaded",e,!1),t()):document.attachEvent&&"complete"===document.readyState&&(document.detachEvent("onreadystatechange",e),t())}catch(n){}}function t(){for(var e;e=n.shift();)e()}var n=[];return function(t){if(n.push(t),"complete"===document.readyState&&setTimeout(e,1),1==n.length)if(document.addEventListener)document.addEventListener("DOMContentLoaded",e,!1),window.addEventListener("load",e,!1);else if(document.attachEvent){document.attachEvent("onreadystatechange",e),window.attachEvent("onload",e),t=!1;try{t=!window.frameElement}catch(o){}document.documentElement.doScroll&&t&&function n(){try{document.documentElement.doScroll("left")}catch(t){return void setTimeout(n,1)}e()}()}}}()},n=window.CKEDITOR_GETURL;if(n){var i=t.getUrl;t.getUrl=function(e){return n.call(t,e)||i.call(t,e)}}return t}()),CKEDITOR.event||(CKEDITOR.event=function(){},CKEDITOR.event.implementOn=function(e){var t,n=CKEDITOR.event.prototype;for(t in n)null==e[t]&&(e[t]=n[t])},CKEDITOR.event.prototype=function(){function e(e){var o=t(this);return o[e]||(o[e]=new n(e))}var t=function(e){return(e=e.getPrivate&&e.getPrivate()||e._||(e._={})).events||(e.events={})},n=function(e){this.name=e,this.listeners=[]};return n.prototype={getListenerIndex:function(e){for(var t=0,n=this.listeners;t<n.length;t++)if(n[t].fn==e)return t;return-1}},{define:function(t,n){var o=e.call(this,t);CKEDITOR.tools.extend(o,n,!0)},on:function(t,n,o,i,r){function a(e,r,a,l){return!1!==n.call(o,e={name:t,sender:this,editor:e,data:r,listenerData:i,stop:a,cancel:l,removeListener:s})&&e.data}function s(){u.removeListener(t,n)}var l=e.call(this,t);if(0>l.getListenerIndex(n)){l=l.listeners,o||(o=this),isNaN(r)&&(r=10);var u=this;a.fn=n,a.priority=r;for(var c=l.length-1;0<=c;c--)if(l[c].priority<=r)return l.splice(c+1,0,a),{removeListener:s};l.unshift(a)}return{removeListener:s}},once:function(){var e=Array.prototype.slice.call(arguments),t=e[1];return e[1]=function(e){return e.removeListener(),t.apply(this,arguments)},this.on.apply(this,e)},capture:function(){CKEDITOR.event.useCapture=1;var e=this.on.apply(this,arguments);return CKEDITOR.event.useCapture=0,e},fire:function(){var e=0,n=function(){e=1},o=0,i=function(){o=1};return function(a,s,l){var u=t(this)[a];a=e;var c=o;if(e=o=0,u&&(f=u.listeners).length)for(var d,f=f.slice(0),h=0;h<f.length;h++){if(u.errorProof)try{d=f[h].call(this,l,s,n,i)}catch(r){}else d=f[h].call(this,l,s,n,i);if(!1===d?o=1:void 0!==d&&(s=d),e||o)break}return s=!o&&(void 0===s||s),e=a,o=c,s}}(),fireOnce:function(e,n,o){return n=this.fire(e,n,o),delete t(this)[e],n},removeListener:function(e,n){var o=t(this)[e];if(o){var i=o.getListenerIndex(n);0<=i&&o.listeners.splice(i,1)}},removeAllListeners:function(){var e,n=t(this);for(e in n)delete n[e]},hasListeners:function(e){return(e=t(this)[e])&&0<e.listeners.length}}}()),CKEDITOR.editor||(CKEDITOR.editor=function(){CKEDITOR._.pending.push([this,arguments]),CKEDITOR.event.call(this)},CKEDITOR.editor.prototype.fire=function(e,t){return e in{instanceReady:1,loaded:1}&&(this[e]=!0),CKEDITOR.event.prototype.fire.call(this,e,t,this)},CKEDITOR.editor.prototype.fireOnce=function(e,t){return e in{instanceReady:1,loaded:1}&&(this[e]=!0),CKEDITOR.event.prototype.fireOnce.call(this,e,t,this)},CKEDITOR.event.implementOn(CKEDITOR.editor.prototype)),CKEDITOR.env||(CKEDITOR.env=function(){var e=navigator.userAgent.toLowerCase(),t=e.match(/edge[ \/](\d+.?\d*)/),n=-1<e.indexOf("trident/");(n={ie:n=!(!t&&!n),edge:!!t,webkit:!n&&-1<e.indexOf(" applewebkit/"),air:-1<e.indexOf(" adobeair/"),mac:-1<e.indexOf("macintosh"),quirks:"BackCompat"==document.compatMode&&(!document.documentMode||10>document.documentMode),mobile:-1<e.indexOf("mobile"),iOS:/(ipad|iphone|ipod)/.test(e),isCustomDomain:function(){if(!this.ie)return!1;var e=document.domain,t=window.location.hostname;return e!=t&&e!="["+t+"]"},secure:"https:"==location.protocol}).gecko="Gecko"==navigator.product&&!n.webkit&&!n.ie,n.webkit&&(-1<e.indexOf("chrome")?n.chrome=!0:n.safari=!0);var o=0;return n.ie&&(o=t?parseFloat(t[1]):n.quirks||!document.documentMode?parseFloat(e.match(/msie (\d+)/)[1]):document.documentMode,n.ie9Compat=9==o,n.ie8Compat=8==o,n.ie7Compat=7==o,n.ie6Compat=7>o||n.quirks),n.gecko&&(t=e.match(/rv:([\d\.]+)/))&&(o=1e4*(t=t[1].split("."))[0]+100*(t[1]||0)+1*(t[2]||0)),n.air&&(o=parseFloat(e.match(/ adobeair\/(\d+)/)[1])),n.webkit&&(o=parseFloat(e.match(/ applewebkit\/(\d+)/)[1])),n.version=o,n.isCompatible=!(n.ie&&7>o||n.gecko&&4e4>o||n.webkit&&534>o),n.hidpi=2<=window.devicePixelRatio,n.needsBrFiller=n.gecko||n.webkit||n.ie&&10<o,n.needsNbspFiller=n.ie&&11>o,n.cssClass="cke_browser_"+(n.ie?"ie":n.gecko?"gecko":n.webkit?"webkit":"unknown"),n.quirks&&(n.cssClass+=" cke_browser_quirks"),n.ie&&(n.cssClass+=" cke_browser_ie"+(n.quirks?"6 cke_browser_iequirks":n.version)),n.air&&(n.cssClass+=" cke_browser_air"),n.iOS&&(n.cssClass+=" cke_browser_ios"),n.hidpi&&(n.cssClass+=" cke_hidpi"),n}()),"unloaded"==CKEDITOR.status&&(CKEDITOR.event.implementOn(CKEDITOR),CKEDITOR.loadFullCore=function(){if("basic_ready"!=CKEDITOR.status)CKEDITOR.loadFullCore._load=1;else{delete CKEDITOR.loadFullCore;var e=document.createElement("script");e.type="text/javascript",e.src=CKEDITOR.basePath+"ckeditor.js",document.getElementsByTagName("head")[0].appendChild(e)}},CKEDITOR.loadFullCoreTimeout=0,CKEDITOR.add=function(e){(this._.pending||(this._.pending=[])).push(e)},CKEDITOR.domReady((function(){var e=CKEDITOR.loadFullCore,t=CKEDITOR.loadFullCoreTimeout;e&&(CKEDITOR.status="basic_ready",e&&e._load?e():t&&setTimeout((function(){CKEDITOR.loadFullCore&&CKEDITOR.loadFullCore()}),1e3*t))})),CKEDITOR.status="basic_loaded"),CKEDITOR.VERBOSITY_WARN=1,CKEDITOR.VERBOSITY_ERROR=2,CKEDITOR.verbosity=CKEDITOR.VERBOSITY_WARN|CKEDITOR.VERBOSITY_ERROR,CKEDITOR.warn=function(e,t){CKEDITOR.verbosity&CKEDITOR.VERBOSITY_WARN&&CKEDITOR.fire("log",{type:"warn",errorCode:e,additionalData:t})},CKEDITOR.error=function(e,t){CKEDITOR.verbosity&CKEDITOR.VERBOSITY_ERROR&&CKEDITOR.fire("log",{type:"error",errorCode:e,additionalData:t})},CKEDITOR.on("log",(function(e){if(window.console&&window.console.log){var t=console[e.data.type]?e.data.type:"log",n=e.data.errorCode;(e=e.data.additionalData)?console[t]("[CKEDITOR] Error code: "+n+".",e):console[t]("[CKEDITOR] Error code: "+n+"."),console[t]("[CKEDITOR] For more information about this error go to https://ckeditor.com/docs/ckeditor4/latest/guide/dev_errors.html#"+n)}}),null,null,999),CKEDITOR.dom={},function(){function e(e,t,n){this._minInterval=e,this._context=n,this._lastOutput=this._scheduledTimer=0,this._output=CKEDITOR.tools.bind(t,n||{});var o=this;this.input=function(){function e(){o._lastOutput=(new Date).getTime(),o._scheduledTimer=0,o._call()}if(!o._scheduledTimer||!1!==o._reschedule()){var t=(new Date).getTime()-o._lastOutput;t<o._minInterval?o._scheduledTimer=setTimeout(e,o._minInterval-t):e()}}}function t(t,n,o){e.call(this,t,n,o),this._args=[];var i=this;this.input=CKEDITOR.tools.override(this.input,(function(e){return function(){i._args=Array.prototype.slice.call(arguments),e.call(this)}}))}var n=[],o=CKEDITOR.env.gecko?"-moz-":CKEDITOR.env.webkit?"-webkit-":CKEDITOR.env.ie?"-ms-":"",i=/&/g,r=/>/g,a=/</g,s=/"/g,l=/&(lt|gt|amp|quot|nbsp|shy|#\d{1,5});/g,u={lt:"<",gt:">",amp:"&",quot:'"',nbsp:" ",shy:"­"},c=function(e,t){return"#"==t[0]?String.fromCharCode(parseInt(t.slice(1),10)):u[t]};CKEDITOR.on("reset",(function(){n=[]})),CKEDITOR.tools={arrayCompare:function(e,t){if(!e&&!t)return!0;if(!e||!t||e.length!=t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!=t[n])return!1;return!0},getIndex:function(e,t){for(var n=0;n<e.length;++n)if(t(e[n]))return n;return-1},clone:function(e){var t;if(e&&e instanceof Array){t=[];for(var n=0;n<e.length;n++)t[n]=CKEDITOR.tools.clone(e[n]);return t}if(null===e||"object"!=typeof e||e instanceof String||e instanceof Number||e instanceof Boolean||e instanceof Date||e instanceof RegExp||e.nodeType||e.window===e)return e;for(n in t=new e.constructor,e)t[n]=CKEDITOR.tools.clone(e[n]);return t},capitalize:function(e,t){return e.charAt(0).toUpperCase()+(t?e.slice(1):e.slice(1).toLowerCase())},extend:function(e){var t,n,o=arguments.length;"boolean"==typeof(t=arguments[o-1])?o--:"boolean"==typeof(t=arguments[o-2])&&(n=arguments[o-1],o-=2);for(var i=1;i<o;i++){var r=arguments[i]||{};CKEDITOR.tools.array.forEach(CKEDITOR.tools.object.keys(r),(function(o){!0!==t&&null!=e[o]||n&&!(o in n)||(e[o]=r[o])}))}return e},prototypedCopy:function(e){var t=function(){};return t.prototype=e,new t},copy:function(e){var t,n={};for(t in e)n[t]=e[t];return n},isArray:function(e){return"[object Array]"==Object.prototype.toString.call(e)},isEmpty:function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0},cssVendorPrefix:function(e,t,n){return n?o+e+":"+t+";"+e+":"+t:((n={})[e]=t,n[o+e]=t,n)},cssStyleToDomStyle:function(){var e=document.createElement("div").style,t=void 0!==e.cssFloat?"cssFloat":void 0!==e.styleFloat?"styleFloat":"float";return function(e){return"float"==e?t:e.replace(/-./g,(function(e){return e.substr(1).toUpperCase()}))}}(),buildStyleHtml:function(e){e=[].concat(e);for(var t,n=[],o=0;o<e.length;o++)(t=e[o])&&(/@import|[{}]/.test(t)?n.push("<style>"+t+"</style>"):n.push('<link type="text/css" rel=stylesheet href="'+t+'">'));return n.join("")},htmlEncode:function(e){return null==e?"":String(e).replace(i,"&amp;").replace(r,"&gt;").replace(a,"&lt;")},htmlDecode:function(e){return e.replace(l,c)},htmlEncodeAttr:function(e){return CKEDITOR.tools.htmlEncode(e).replace(s,"&quot;")},htmlDecodeAttr:function(e){return CKEDITOR.tools.htmlDecode(e)},transformPlainTextToHtml:function(e,t){var n=t==CKEDITOR.ENTER_BR,o=(o=this.htmlEncode(e.replace(/\r\n/g,"\n"))).replace(/\t/g,"&nbsp;&nbsp; &nbsp;"),i=t==CKEDITOR.ENTER_P?"p":"div";if(!n){var r=/\n{2}/g;if(r.test(o)){var a="<"+i+">",s="</"+i+">";o=a+o.replace(r,(function(){return s+a}))+s}}return o=o.replace(/\n/g,"<br>"),n||(o=o.replace(new RegExp("<br>(?=</"+i+">)"),(function(e){return CKEDITOR.tools.repeat(e,2)}))),(o=o.replace(/^ | $/g,"&nbsp;")).replace(/(>|\s) /g,(function(e,t){return t+"&nbsp;"})).replace(/ (?=<)/g,"&nbsp;")},getNextNumber:function(){var e=0;return function(){return++e}}(),getNextId:function(){return"cke_"+this.getNextNumber()},getUniqueId:function(){for(var e="e",t=0;8>t;t++)e+=Math.floor(65536*(1+Math.random())).toString(16).substring(1);return e},override:function(e,t){var n=t(e);return n.prototype=e.prototype,n},setTimeout:function(e,t,n,o,i){return i||(i=window),n||(n=i),i.setTimeout((function(){o?e.apply(n,[].concat(o)):e.apply(n)}),t||0)},throttle:function(e,t,n){return new this.buffers.throttle(e,t,n)},trim:function(){var e=/(?:^[ \t\n\r]+)|(?:[ \t\n\r]+$)/g;return function(t){return t.replace(e,"")}}(),ltrim:function(){var e=/^[ \t\n\r]+/g;return function(t){return t.replace(e,"")}}(),rtrim:function(){var e=/[ \t\n\r]+$/g;return function(t){return t.replace(e,"")}}(),indexOf:function(e,t){if("function"==typeof t){for(var n=0,o=e.length;n<o;n++)if(t(e[n]))return n}else{if(e.indexOf)return e.indexOf(t);for(n=0,o=e.length;n<o;n++)if(e[n]===t)return n}return-1},search:function(e,t){var n=CKEDITOR.tools.indexOf(e,t);return 0<=n?e[n]:null},bind:function(e,t){var n=Array.prototype.slice.call(arguments,2);return function(){return e.apply(t,n.concat(Array.prototype.slice.call(arguments)))}},createClass:function(e){var t=e.$,n=e.base,o=e.privates||e._,i=e.proto;if(e=e.statics,!t&&(t=function(){n&&this.base.apply(this,arguments)}),o){var r=t;t=function(){var e,t=this._||(this._={});for(e in o){var n=o[e];t[e]="function"==typeof n?CKEDITOR.tools.bind(n,this):n}r.apply(this,arguments)}}return n&&(t.prototype=this.prototypedCopy(n.prototype),t.prototype.constructor=t,t.base=n,t.baseProto=n.prototype,t.prototype.base=function e(){this.base=n.prototype.base,n.apply(this,arguments),this.base=e}),i&&this.extend(t.prototype,i,!0),e&&this.extend(t,e,!0),t},addFunction:function(e,t){return n.push((function(){return e.apply(t||this,arguments)}))-1},removeFunction:function(e){n[e]=null},callFunction:function(e){var t=n[e];return t&&t.apply(window,Array.prototype.slice.call(arguments,1))},cssLength:function(){var e,t=/^-?\d+\.?\d*px$/;return function(n){return e=CKEDITOR.tools.trim(n+"")+"px",t.test(e)?e:n||""}}(),convertToPx:function(){var e;return function(t){if(e||(e=CKEDITOR.dom.element.createFromHtml('<div style="position:absolute;left:-9999px;top:-9999px;margin:0px;padding:0px;border:0px;"></div>',CKEDITOR.document),CKEDITOR.document.getBody().append(e)),!/%$/.test(t)){var n=0>parseFloat(t);return n&&(t=t.replace("-","")),e.setStyle("width",t),t=e.$.clientWidth,n?-t:t}return t}}(),repeat:function(e,t){return Array(t+1).join(e)},tryThese:function(){for(var e,t=0,n=arguments.length;t<n;t++){var o=arguments[t];try{e=o();break}catch(s){}}return e},genKey:function(){return Array.prototype.slice.call(arguments).join("-")},defer:function(e){return function(){var t=arguments,n=this;window.setTimeout((function(){e.apply(n,t)}),0)}},normalizeCssText:function(e,t){var n,o=[],i=CKEDITOR.tools.parseCssText(e,!0,t);for(n in i)o.push(n+":"+i[n]);return o.sort(),o.length?o.join(";")+";":""},convertRgbToHex:function(e){return e.replace(/(?:rgb\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\))/gi,(function(e,t,n,o){for(e=[t,n,o],t=0;3>t;t++)e[t]=("0"+parseInt(e[t],10).toString(16)).slice(-2);return"#"+e.join("")}))},normalizeHex:function(e){return e.replace(/#(([0-9a-f]{3}){1,2})($|;|\s+)/gi,(function(e,t,n,o){return 3==(e=t.toLowerCase()).length&&(e=[(e=e.split(""))[0],e[0],e[1],e[1],e[2],e[2]].join("")),"#"+e+o}))},parseCssText:function(e,t,n){var o={};return n&&(e=new CKEDITOR.dom.element("span").setAttribute("style",e).getAttribute("style")||""),e&&(e=CKEDITOR.tools.normalizeHex(CKEDITOR.tools.convertRgbToHex(e))),e&&";"!=e?(e.replace(/&quot;/g,'"').replace(/\s*([^:;\s]+)\s*:\s*([^;]+)\s*(?=;|$)/g,(function(e,n,i){t&&("font-family"==(n=n.toLowerCase())&&(i=i.replace(/\s*,\s*/g,",")),i=CKEDITOR.tools.trim(i)),o[n]=i})),o):o},writeCssText:function(e,t){var n,o=[];for(n in e)o.push(n+":"+e[n]);return t&&o.sort(),o.join("; ")},objectCompare:function(e,t,n){var o;if(!e&&!t)return!0;if(!e||!t)return!1;for(o in e)if(e[o]!=t[o])return!1;if(!n)for(o in t)if(e[o]!=t[o])return!1;return!0},objectKeys:function(e){return CKEDITOR.tools.object.keys(e)},convertArrayToObject:function(e,t){var n={};1==arguments.length&&(t=!0);for(var o=0,i=e.length;o<i;++o)n[e[o]]=t;return n},fixDomain:function(){for(var e;;)try{e=window.parent.document.domain;break}catch(n){if(!(e=e?e.replace(/.+?(?:\.|$)/,""):document.domain))break;document.domain=e}return!!e},eventsBuffer:function(e,t,n){return new this.buffers.event(e,t,n)},enableHtml5Elements:function(e,t){for(var n,o="abbr article aside audio bdi canvas data datalist details figcaption figure footer header hgroup main mark meter nav output progress section summary time video".split(" "),i=o.length;i--;)n=e.createElement(o[i]),t&&e.appendChild(n)},checkIfAnyArrayItemMatches:function(e,t){for(var n=0,o=e.length;n<o;++n)if(e[n].match(t))return!0;return!1},checkIfAnyObjectPropertyMatches:function(e,t){for(var n in e)if(n.match(t))return!0;return!1},keystrokeToString:function(e,t){var n=this.keystrokeToArray(e,t);return n.display=n.display.join("+"),n.aria=n.aria.join("+"),n},keystrokeToArray:function(e,t){var n=16711680&t,o=65535&t,i=CKEDITOR.env.mac,r=[],a=[];return n&CKEDITOR.CTRL&&(r.push(i?"⌘":e[17]),a.push(i?e[224]:e[17])),n&CKEDITOR.ALT&&(r.push(i?"⌥":e[18]),a.push(e[18])),n&CKEDITOR.SHIFT&&(r.push(i?"⇧":e[16]),a.push(e[16])),o&&(e[o]?(r.push(e[o]),a.push(e[o])):(r.push(String.fromCharCode(o)),a.push(String.fromCharCode(o)))),{display:r,aria:a}},transparentImageData:"data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==",getCookie:function(e){e=e.toLowerCase();for(var t,n=document.cookie.split(";"),o=0;o<n.length;o++)if(t=n[o].split("="),decodeURIComponent(CKEDITOR.tools.trim(t[0]).toLowerCase())===e)return decodeURIComponent(1<t.length?t[1]:"");return null},setCookie:function(e,t){document.cookie=encodeURIComponent(e)+"="+encodeURIComponent(t)+";path=/"},getCsrfToken:function(){if(!(e=CKEDITOR.tools.getCookie("ckCsrfToken"))||40!=e.length){var e=[],t="";if(window.crypto&&window.crypto.getRandomValues)e=new Uint8Array(40),window.crypto.getRandomValues(e);else for(var n=0;40>n;n++)e.push(Math.floor(256*Math.random()));for(n=0;n<e.length;n++){var o="abcdefghijklmnopqrstuvwxyz0123456789".charAt(e[n]%36);t+=.5<Math.random()?o.toUpperCase():o}e=t,CKEDITOR.tools.setCookie("ckCsrfToken",e)}return e},escapeCss:function(e){return e?window.CSS&&CSS.escape?CSS.escape(e):isNaN(parseInt(e.charAt(0),10))?e:"\\3"+e.charAt(0)+" "+e.substring(1,e.length):""},getMouseButton:function(e){return!!(e=e&&e.data?e.data.$:e)&&CKEDITOR.tools.normalizeMouseButton(e.button)},normalizeMouseButton:function(e,t){if(!CKEDITOR.env.ie||9<=CKEDITOR.env.version&&!CKEDITOR.env.ie6Compat)return e;for(var n=[[CKEDITOR.MOUSE_BUTTON_LEFT,1],[CKEDITOR.MOUSE_BUTTON_MIDDLE,4],[CKEDITOR.MOUSE_BUTTON_RIGHT,2]],o=0;o<n.length;o++){var i=n[o];if(i[0]===e&&t)return i[1];if(!t&&i[1]===e)return i[0]}},convertHexStringToBytes:function(e){var t,n=[],o=e.length/2;for(t=0;t<o;t++)n.push(parseInt(e.substr(2*t,2),16));return n},convertBytesToBase64:function(e){var t,n="",o=e.length;for(t=0;t<o;t+=3){var i,r=e.slice(t,t+3),a=r.length,s=[];if(3>a)for(i=a;3>i;i++)r[i]=0;for(s[0]=(252&r[0])>>2,s[1]=(3&r[0])<<4|r[1]>>4,s[2]=(15&r[1])<<2|(192&r[2])>>6,s[3]=63&r[2],i=0;4>i;i++)n=i<=a?n+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(s[i]):n+"="}return n},style:{parse:{_colors:{aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#00FFFF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000000",blanchedalmond:"#FFEBCD",blue:"#0000FF",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#00FFFF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgreen:"#006400",darkgrey:"#A9A9A9",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#FF00FF",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",green:"#008000",greenyellow:"#ADFF2F",grey:"#808080",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgreen:"#90EE90",lightgrey:"#D3D3D3",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#00FF00",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#FF00FF",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",rebeccapurple:"#663399",red:"#FF0000",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",windowtext:"windowtext",wheat:"#F5DEB3",white:"#FFFFFF",whitesmoke:"#F5F5F5",yellow:"#FFFF00",yellowgreen:"#9ACD32"},_borderStyle:"none hidden dotted dashed solid double groove ridge inset outset".split(" "),_widthRegExp:/^(thin|medium|thick|[\+-]?\d+(\.\d+)?[a-z%]+|[\+-]?0+(\.0+)?|\.\d+[a-z%]+)$/,_rgbaRegExp:/rgba?\(\s*\d+%?\s*,\s*\d+%?\s*,\s*\d+%?\s*(?:,\s*[0-9.]+\s*)?\)/gi,_hslaRegExp:/hsla?\(\s*[0-9.]+\s*,\s*\d+%\s*,\s*\d+%\s*(?:,\s*[0-9.]+\s*)?\)/gi,background:function(e){var t={},n=this._findColor(e);return n.length&&(t.color=n[0],CKEDITOR.tools.array.forEach(n,(function(t){e=e.replace(t,"")}))),(e=CKEDITOR.tools.trim(e))&&(t.unprocessed=e),t},margin:function(e){return CKEDITOR.tools.style.parse.sideShorthand(e,(function(e){return e.match(/(?:\-?[\.\d]+(?:%|\w*)|auto|inherit|initial|unset|revert)/g)||["0px"]}))},sideShorthand:function(e,t){function n(e){o.top=i[e[0]],o.right=i[e[1]],o.bottom=i[e[2]],o.left=i[e[3]]}var o={},i=t?t(e):e.split(/\s+/);switch(i.length){case 1:n([0,0,0,0]);break;case 2:n([0,1,0,1]);break;case 3:n([0,1,2,1]);break;case 4:n([0,1,2,3])}return o},border:function(e){return CKEDITOR.tools.style.border.fromCssRule(e)},_findColor:function(e){var t=[],n=CKEDITOR.tools.array;return(t=(t=t.concat(e.match(this._rgbaRegExp)||[])).concat(e.match(this._hslaRegExp)||[])).concat(n.filter(e.split(/\s+/),(function(e){return!!e.match(/^\#[a-f0-9]{3}(?:[a-f0-9]{3})?$/gi)||e.toLowerCase()in CKEDITOR.tools.style.parse._colors})))}}},array:{filter:function(e,t,n){var o=[];return this.forEach(e,(function(i,r){t.call(n,i,r,e)&&o.push(i)})),o},find:function(e,t,n){for(var o=e.length,i=0;i<o;){if(t.call(n,e[i],i,e))return e[i];i++}},forEach:function(e,t,n){var o,i=e.length;for(o=0;o<i;o++)t.call(n,e[o],o,e)},map:function(e,t,n){for(var o=[],i=0;i<e.length;i++)o.push(t.call(n,e[i],i,e));return o},reduce:function(e,t,n,o){for(var i=0;i<e.length;i++)n=t.call(o,n,e[i],i,e);return n},every:function(e,t,n){return!e.length||(t=this.filter(e,t,n),e.length===t.length)},some:function(e,t,n){for(var o=0;o<e.length;o++)if(t.call(n,e[o],o,e))return!0;return!1}},object:{DONT_ENUMS:"toString toLocaleString valueOf hasOwnProperty isPrototypeOf propertyIsEnumerable constructor".split(" "),entries:function(e){return CKEDITOR.tools.array.map(CKEDITOR.tools.object.keys(e),(function(t){return[t,e[t]]}))},values:function(e){return CKEDITOR.tools.array.map(CKEDITOR.tools.object.keys(e),(function(t){return e[t]}))},keys:function(e){var t=Object.prototype.hasOwnProperty,n=[],o=CKEDITOR.tools.object.DONT_ENUMS;if(CKEDITOR.env.ie&&9>CKEDITOR.env.version&&(!e||"object"!=typeof e)){if(t=[],"string"==typeof e)for(n=0;n<e.length;n++)t.push(String(n));return t}for(var i in e)n.push(i);if(CKEDITOR.env.ie&&9>CKEDITOR.env.version)for(i=0;i<o.length;i++)t.call(e,o[i])&&n.push(o[i]);return n},findKey:function(e,t){if("object"!=typeof e)return null;for(var n in e)if(e[n]===t)return n;return null},merge:function(e,t){var n=CKEDITOR.tools,o=n.clone(e),i=n.clone(t);return n.array.forEach(n.object.keys(i),(function(e){o[e]="object"==typeof i[e]&&"object"==typeof o[e]?n.object.merge(o[e],i[e]):i[e]})),o}},getAbsoluteRectPosition:function(e,t){var n=CKEDITOR.tools.copy(t);!function e(t){if(t){var o=t.getClientRect();n.top+=o.top,n.left+=o.left,"x"in n&&"y"in n&&(n.x+=o.x,n.y+=o.y),e(t.getWindow().getFrame())}}(e.getFrame());var o=CKEDITOR.document.getWindow().getScrollPosition();return n.top+=o.y,n.left+=o.x,"x"in n&&"y"in n&&(n.y+=o.y,n.x+=o.x),n.right=n.left+n.width,n.bottom=n.top+n.height,n}},e.prototype={reset:function(){this._lastOutput=0,this._clearTimer()},_reschedule:function(){return!1},_call:function(){this._output()},_clearTimer:function(){this._scheduledTimer&&clearTimeout(this._scheduledTimer),this._scheduledTimer=0}},(t.prototype=CKEDITOR.tools.prototypedCopy(e.prototype))._reschedule=function(){this._scheduledTimer&&this._clearTimer()},t.prototype._call=function(){this._output.apply(this._context,this._args)},CKEDITOR.tools.buffers={},CKEDITOR.tools.buffers.event=e,CKEDITOR.tools.buffers.throttle=t,CKEDITOR.tools.style.border=CKEDITOR.tools.createClass({$:function(e){this.width=(e=e||{}).width,this.style=e.style,this.color=e.color,this._.normalize()},_:{normalizeMap:{color:[[/windowtext/g,"black"]]},normalize:function(){for(var e in this._.normalizeMap){var t=this[e];t&&(this[e]=CKEDITOR.tools.array.reduce(this._.normalizeMap[e],(function(e,t){return e.replace(t[0],t[1])}),t))}}},proto:{toString:function(){return CKEDITOR.tools.array.filter([this.width,this.style,this.color],(function(e){return!!e})).join(" ")}},statics:{fromCssRule:function(e){var t={},n=e.split(/\s+/g);return(e=CKEDITOR.tools.style.parse._findColor(e)).length&&(t.color=e[0]),CKEDITOR.tools.array.forEach(n,(function(e){t.style||-1===CKEDITOR.tools.indexOf(CKEDITOR.tools.style.parse._borderStyle,e)?!t.width&&CKEDITOR.tools.style.parse._widthRegExp.test(e)&&(t.width=e):t.style=e})),new CKEDITOR.tools.style.border(t)},splitCssValues:function(e,t){t=t||{};var n=CKEDITOR.tools.array.reduce(["width","style","color"],(function(n,o){var i=e["border-"+o]||t[o];return n[o]=i?CKEDITOR.tools.style.parse.sideShorthand(i):null,n}),{});return CKEDITOR.tools.array.reduce(["top","right","bottom","left"],(function(t,o){var i,r={};for(i in n)r[i]=e["border-"+o+"-"+i]||n[i]&&n[i][o];return t["border-"+o]=new CKEDITOR.tools.style.border(r),t}),{})}}}),CKEDITOR.tools.array.indexOf=CKEDITOR.tools.indexOf,CKEDITOR.tools.array.isArray=CKEDITOR.tools.isArray,CKEDITOR.MOUSE_BUTTON_LEFT=0,CKEDITOR.MOUSE_BUTTON_MIDDLE=1,CKEDITOR.MOUSE_BUTTON_RIGHT=2}(),CKEDITOR.dtd=function(){var e=CKEDITOR.tools.extend,t=function(e,t){for(var n=CKEDITOR.tools.clone(e),o=1;o<arguments.length;o++)for(var i in t=arguments[o])delete n[i];return n},n={},o={},i={address:1,article:1,aside:1,blockquote:1,details:1,div:1,dl:1,fieldset:1,figure:1,footer:1,form:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,header:1,hgroup:1,hr:1,main:1,menu:1,nav:1,ol:1,p:1,pre:1,section:1,table:1,ul:1},r={command:1,link:1,meta:1,noscript:1,script:1,style:1},a={},s={"#":1},l={center:1,dir:1,noframes:1};return e(n,{a:1,abbr:1,area:1,audio:1,b:1,bdi:1,bdo:1,br:1,button:1,canvas:1,cite:1,code:1,command:1,datalist:1,del:1,dfn:1,em:1,embed:1,i:1,iframe:1,img:1,input:1,ins:1,kbd:1,keygen:1,label:1,map:1,mark:1,meter:1,noscript:1,object:1,output:1,progress:1,q:1,ruby:1,s:1,samp:1,script:1,select:1,small:1,span:1,strong:1,sub:1,sup:1,textarea:1,time:1,u:1,var:1,video:1,wbr:1},s,{acronym:1,applet:1,basefont:1,big:1,font:1,isindex:1,strike:1,style:1,tt:1}),e(o,i,n,l),t={a:t(n,{a:1,button:1}),abbr:n,address:o,area:a,article:o,aside:o,audio:e({source:1,track:1},o),b:n,base:a,bdi:n,bdo:n,blockquote:o,body:o,br:a,button:t(n,{a:1,button:1}),canvas:n,caption:o,cite:n,code:n,col:a,colgroup:{col:1},command:a,datalist:e({option:1},n),dd:o,del:n,details:e({summary:1},o),dfn:n,div:o,dl:{dt:1,dd:1},dt:o,em:n,embed:a,fieldset:e({legend:1},o),figcaption:o,figure:e({figcaption:1},o),footer:o,form:o,h1:n,h2:n,h3:n,h4:n,h5:n,h6:n,head:e({title:1,base:1},r),header:o,hgroup:{h1:1,h2:1,h3:1,h4:1,h5:1,h6:1},hr:a,html:e({head:1,body:1},o,r),i:n,iframe:s,img:a,input:a,ins:n,kbd:n,keygen:a,label:n,legend:n,li:o,link:a,main:o,map:o,mark:n,menu:e({li:1},o),meta:a,meter:t(n,{meter:1}),nav:o,noscript:e({link:1,meta:1,style:1},n),object:e({param:1},n),ol:{li:1},optgroup:{option:1},option:s,output:n,p:n,param:a,pre:n,progress:t(n,{progress:1}),q:n,rp:n,rt:n,ruby:e({rp:1,rt:1},n),s:n,samp:n,script:s,section:o,select:{optgroup:1,option:1},small:n,source:a,span:n,strong:n,style:s,sub:n,summary:e({h1:1,h2:1,h3:1,h4:1,h5:1,h6:1},n),sup:n,table:{caption:1,colgroup:1,thead:1,tfoot:1,tbody:1,tr:1},tbody:{tr:1},td:o,textarea:s,tfoot:{tr:1},th:o,thead:{tr:1},time:t(n,{time:1}),title:s,tr:{th:1,td:1},track:a,u:n,ul:{li:1},var:n,video:e({source:1,track:1},o),wbr:a,acronym:n,applet:e({param:1},o),basefont:a,big:n,center:o,dialog:a,dir:{li:1},font:n,isindex:a,noframes:o,strike:n,tt:n},e(t,{$block:e({audio:1,dd:1,dt:1,figcaption:1,li:1,video:1},i,l),$blockLimit:{article:1,aside:1,audio:1,body:1,caption:1,details:1,dir:1,div:1,dl:1,fieldset:1,figcaption:1,figure:1,footer:1,form:1,header:1,hgroup:1,main:1,menu:1,nav:1,ol:1,section:1,table:1,td:1,th:1,tr:1,ul:1,video:1},$cdata:{script:1,style:1},$editable:{address:1,article:1,aside:1,blockquote:1,body:1,details:1,div:1,fieldset:1,figcaption:1,footer:1,form:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,header:1,hgroup:1,main:1,nav:1,p:1,pre:1,section:1},$empty:{area:1,base:1,basefont:1,br:1,col:1,command:1,dialog:1,embed:1,hr:1,img:1,input:1,isindex:1,keygen:1,link:1,meta:1,param:1,source:1,track:1,wbr:1},$inline:n,$list:{dl:1,ol:1,ul:1},$listItem:{dd:1,dt:1,li:1},$nonBodyContent:e({body:1,head:1,html:1},t.head),$nonEditable:{applet:1,audio:1,button:1,embed:1,iframe:1,map:1,object:1,option:1,param:1,script:1,textarea:1,video:1},$object:{applet:1,audio:1,button:1,hr:1,iframe:1,img:1,input:1,object:1,select:1,table:1,textarea:1,video:1},$removeEmpty:{abbr:1,acronym:1,b:1,bdi:1,bdo:1,big:1,cite:1,code:1,del:1,dfn:1,em:1,font:1,i:1,ins:1,label:1,kbd:1,mark:1,meter:1,output:1,q:1,ruby:1,s:1,samp:1,small:1,span:1,strike:1,strong:1,sub:1,sup:1,time:1,tt:1,u:1,var:1},$tabIndex:{a:1,area:1,button:1,input:1,object:1,select:1,textarea:1},$tableContent:{caption:1,col:1,colgroup:1,tbody:1,td:1,tfoot:1,th:1,thead:1,tr:1},$transparent:{a:1,audio:1,canvas:1,del:1,ins:1,map:1,noscript:1,object:1,video:1},$intermediate:{caption:1,colgroup:1,dd:1,dt:1,figcaption:1,legend:1,li:1,optgroup:1,option:1,rp:1,rt:1,summary:1,tbody:1,td:1,tfoot:1,th:1,thead:1,tr:1}}),t}(),CKEDITOR.dom.event=function(e){this.$=e},CKEDITOR.dom.event.prototype={getKey:function(){return this.$.keyCode||this.$.which},getKeystroke:function(){var e=this.getKey();return(this.$.ctrlKey||this.$.metaKey)&&(e+=CKEDITOR.CTRL),this.$.shiftKey&&(e+=CKEDITOR.SHIFT),this.$.altKey&&(e+=CKEDITOR.ALT),e},preventDefault:function(e){var t=this.$;t.preventDefault?t.preventDefault():t.returnValue=!1,e&&this.stopPropagation()},stopPropagation:function(){var e=this.$;e.stopPropagation?e.stopPropagation():e.cancelBubble=!0},getTarget:function(){var e=this.$.target||this.$.srcElement;return e?new CKEDITOR.dom.node(e):null},getPhase:function(){return this.$.eventPhase||2},getPageOffset:function(){var e=this.getTarget().getDocument().$;return{x:this.$.pageX||this.$.clientX+(e.documentElement.scrollLeft||e.body.scrollLeft),y:this.$.pageY||this.$.clientY+(e.documentElement.scrollTop||e.body.scrollTop)}}},CKEDITOR.CTRL=1114112,CKEDITOR.SHIFT=2228224,CKEDITOR.ALT=4456448,CKEDITOR.EVENT_PHASE_CAPTURING=1,CKEDITOR.EVENT_PHASE_AT_TARGET=2,CKEDITOR.EVENT_PHASE_BUBBLING=3,CKEDITOR.dom.domObject=function(e){e&&(this.$=e)},CKEDITOR.dom.domObject.prototype=(e=function(e,t){return function(n){"undefined"!=typeof CKEDITOR&&e.fire(t,new CKEDITOR.dom.event(n))}},{getPrivate:function(){var e;return(e=this.getCustomData("_"))||this.setCustomData("_",e={}),e},on:function(t){var n=this.getCustomData("_cke_nativeListeners");return n||this.setCustomData("_cke_nativeListeners",n={}),n[t]||(n=n[t]=e(this,t),this.$.addEventListener?this.$.addEventListener(t,n,!!CKEDITOR.event.useCapture):this.$.attachEvent&&this.$.attachEvent("on"+t,n)),CKEDITOR.event.prototype.on.apply(this,arguments)},removeListener:function(e){if(CKEDITOR.event.prototype.removeListener.apply(this,arguments),!this.hasListeners(e)){var t=this.getCustomData("_cke_nativeListeners"),n=t&&t[e];n&&(this.$.removeEventListener?this.$.removeEventListener(e,n,!1):this.$.detachEvent&&this.$.detachEvent("on"+e,n),delete t[e])}},removeAllListeners:function(){try{var e,t=this.getCustomData("_cke_nativeListeners");for(e in t){var o=t[e];this.$.detachEvent?this.$.detachEvent("on"+e,o):this.$.removeEventListener&&this.$.removeEventListener(e,o,!1),delete t[e]}}catch(n){if(!CKEDITOR.env.edge||-2146828218!==n.number)throw n}CKEDITOR.event.prototype.removeAllListeners.call(this)}}),function(e){var t={};CKEDITOR.on("reset",(function(){t={}})),e.equals=function(e){try{return e&&e.$===this.$}catch(t){return!1}},e.setCustomData=function(e,n){var o=this.getUniqueId();return(t[o]||(t[o]={}))[e]=n,this},e.getCustomData=function(e){var n=this.$["data-cke-expando"];return(n=n&&t[n])&&e in n?n[e]:null},e.removeCustomData=function(e){var n,o,i;return(n=(n=this.$["data-cke-expando"])&&t[n])&&(o=n[e],i=e in n,delete n[e]),i?o:null},e.clearCustomData=function(){this.removeAllListeners();var e=this.getUniqueId();e&&delete t[e]},e.getUniqueId=function(){return this.$["data-cke-expando"]||(this.$["data-cke-expando"]=CKEDITOR.tools.getNextNumber())},CKEDITOR.event.implementOn(e)}(CKEDITOR.dom.domObject.prototype),CKEDITOR.dom.node=function(e){return e?new CKEDITOR.dom[e.nodeType==CKEDITOR.NODE_DOCUMENT?"document":e.nodeType==CKEDITOR.NODE_ELEMENT?"element":e.nodeType==CKEDITOR.NODE_TEXT?"text":e.nodeType==CKEDITOR.NODE_COMMENT?"comment":e.nodeType==CKEDITOR.NODE_DOCUMENT_FRAGMENT?"documentFragment":"domObject"](e):this},CKEDITOR.dom.node.prototype=new CKEDITOR.dom.domObject,CKEDITOR.NODE_ELEMENT=1,CKEDITOR.NODE_DOCUMENT=9,CKEDITOR.NODE_TEXT=3,CKEDITOR.NODE_COMMENT=8,CKEDITOR.NODE_DOCUMENT_FRAGMENT=11,CKEDITOR.POSITION_IDENTICAL=0,CKEDITOR.POSITION_DISCONNECTED=1,CKEDITOR.POSITION_FOLLOWING=2,CKEDITOR.POSITION_PRECEDING=4,CKEDITOR.POSITION_IS_CONTAINED=8,CKEDITOR.POSITION_CONTAINS=16,CKEDITOR.tools.extend(CKEDITOR.dom.node.prototype,{appendTo:function(e,t){return e.append(this,t),e},clone:function(e,t){var n=this.$.cloneNode(e);return function n(o){if(o["data-cke-expando"]&&(o["data-cke-expando"]=!1),(o.nodeType==CKEDITOR.NODE_ELEMENT||o.nodeType==CKEDITOR.NODE_DOCUMENT_FRAGMENT)&&(t||o.nodeType!=CKEDITOR.NODE_ELEMENT||o.removeAttribute("id",!1),e)){o=o.childNodes;for(var i=0;i<o.length;i++)n(o[i])}}(n),n=new CKEDITOR.dom.node(n),CKEDITOR.env.ie&&9>CKEDITOR.env.version&&(this.type==CKEDITOR.NODE_ELEMENT||this.type==CKEDITOR.NODE_DOCUMENT_FRAGMENT)&&function t(n){if(n.type==CKEDITOR.NODE_ELEMENT||n.type==CKEDITOR.NODE_DOCUMENT_FRAGMENT){if(n.type!=CKEDITOR.NODE_DOCUMENT_FRAGMENT){var o=n.getName();":"==o[0]&&n.renameNode(o.substring(1))}if(e)for(o=0;o<n.getChildCount();o++)t(n.getChild(o))}}(n),n},hasPrevious:function(){return!!this.$.previousSibling},hasNext:function(){return!!this.$.nextSibling},insertAfter:function(e){return e.$.parentNode.insertBefore(this.$,e.$.nextSibling),e},insertBefore:function(e){return e.$.parentNode.insertBefore(this.$,e.$),e},insertBeforeMe:function(e){return this.$.parentNode.insertBefore(e.$,this.$),e},getAddress:function(e){for(var t=[],n=this.getDocument().$.documentElement,o=this;o&&o!=n;){var i=o.getParent();i&&t.unshift(this.getIndex.call(o,e)),o=i}return t},getDocument:function(){return new CKEDITOR.dom.document(this.$.ownerDocument||this.$.parentNode.ownerDocument)},getIndex:function(e){function t(e,n){var o=n?e.getNext():e.getPrevious();return o&&o.type==CKEDITOR.NODE_TEXT?o.isEmpty()?t(o,n):o:null}var n,o=this,i=-1;if(!this.getParent()||e&&o.type==CKEDITOR.NODE_TEXT&&o.isEmpty()&&!t(o)&&!t(o,!0))return-1;do{e&&!o.equals(this)&&o.type==CKEDITOR.NODE_TEXT&&(n||o.isEmpty())||(i++,n=o.type==CKEDITOR.NODE_TEXT)}while(o=o.getPrevious());return i},getNextSourceNode:function(e,t,n){if(n&&!n.call){var o=n;n=function(e){return!e.equals(o)}}var i;if(!(e=!e&&this.getFirst&&this.getFirst())){if(this.type==CKEDITOR.NODE_ELEMENT&&n&&!1===n(this,!0))return null;e=this.getNext()}for(;!e&&(i=(i||this).getParent());){if(n&&!1===n(i,!0))return null;e=i.getNext()}return!e||n&&!1===n(e)?null:t&&t!=e.type?e.getNextSourceNode(!1,t,n):e},getPreviousSourceNode:function(e,t,n){if(n&&!n.call){var o=n;n=function(e){return!e.equals(o)}}var i;if(!(e=!e&&this.getLast&&this.getLast())){if(this.type==CKEDITOR.NODE_ELEMENT&&n&&!1===n(this,!0))return null;e=this.getPrevious()}for(;!e&&(i=(i||this).getParent());){if(n&&!1===n(i,!0))return null;e=i.getPrevious()}return!e||n&&!1===n(e)?null:t&&e.type!=t?e.getPreviousSourceNode(!1,t,n):e},getPrevious:function(e){var t,n=this.$;do{t=(n=n.previousSibling)&&10!=n.nodeType&&new CKEDITOR.dom.node(n)}while(t&&e&&!e(t));return t},getNext:function(e){var t,n=this.$;do{t=(n=n.nextSibling)&&new CKEDITOR.dom.node(n)}while(t&&e&&!e(t));return t},getParent:function(e){var t=this.$.parentNode;return t&&(t.nodeType==CKEDITOR.NODE_ELEMENT||e&&t.nodeType==CKEDITOR.NODE_DOCUMENT_FRAGMENT)?new CKEDITOR.dom.node(t):null},getParents:function(e){var t=this,n=[];do{n[e?"push":"unshift"](t)}while(t=t.getParent());return n},getCommonAncestor:function(e){if(e.equals(this))return this;if(e.contains&&e.contains(this))return e;var t=this.contains?this:this.getParent();do{if(t.contains(e))return t}while(t=t.getParent());return null},getPosition:function(e){var t=this.$,n=e.$;if(t.compareDocumentPosition)return t.compareDocumentPosition(n);if(t==n)return CKEDITOR.POSITION_IDENTICAL;if(this.type==CKEDITOR.NODE_ELEMENT&&e.type==CKEDITOR.NODE_ELEMENT){if(t.contains){if(t.contains(n))return CKEDITOR.POSITION_CONTAINS+CKEDITOR.POSITION_PRECEDING;if(n.contains(t))return CKEDITOR.POSITION_IS_CONTAINED+CKEDITOR.POSITION_FOLLOWING}if("sourceIndex"in t)return 0>t.sourceIndex||0>n.sourceIndex?CKEDITOR.POSITION_DISCONNECTED:t.sourceIndex<n.sourceIndex?CKEDITOR.POSITION_PRECEDING:CKEDITOR.POSITION_FOLLOWING}t=this.getAddress(),e=e.getAddress(),n=Math.min(t.length,e.length);for(var o=0;o<n;o++)if(t[o]!=e[o])return t[o]<e[o]?CKEDITOR.POSITION_PRECEDING:CKEDITOR.POSITION_FOLLOWING;return t.length<e.length?CKEDITOR.POSITION_CONTAINS+CKEDITOR.POSITION_PRECEDING:CKEDITOR.POSITION_IS_CONTAINED+CKEDITOR.POSITION_FOLLOWING},getAscendant:function(e,t){var n,i,r=this.$;for(t||(r=r.parentNode),"function"==typeof e?(i=!0,n=e):(i=!1,n=function(t){return t="string"==typeof t.nodeName?t.nodeName.toLowerCase():"","string"==typeof e?t==e:t in e});r;){if(n(i?new CKEDITOR.dom.node(r):r))return new CKEDITOR.dom.node(r);try{r=r.parentNode}catch(o){r=null}}return null},hasAscendant:function(e,t){var n=this.$;for(t||(n=n.parentNode);n;){if(n.nodeName&&n.nodeName.toLowerCase()==e)return!0;n=n.parentNode}return!1},move:function(e,t){e.append(this.remove(),t)},remove:function(e){var t=this.$,n=t.parentNode;if(n){if(e)for(;e=t.firstChild;)n.insertBefore(t.removeChild(e),t);n.removeChild(t)}return this},replace:function(e){this.insertBefore(e),e.remove()},trim:function(){this.ltrim(),this.rtrim()},ltrim:function(){for(var e;this.getFirst&&(e=this.getFirst());){if(e.type==CKEDITOR.NODE_TEXT){var t=CKEDITOR.tools.ltrim(e.getText()),n=e.getLength();if(!t){e.remove();continue}t.length<n&&(e.split(n-t.length),this.$.removeChild(this.$.firstChild))}break}},rtrim:function(){for(var e;this.getLast&&(e=this.getLast());){if(e.type==CKEDITOR.NODE_TEXT){var t=CKEDITOR.tools.rtrim(e.getText()),n=e.getLength();if(!t){e.remove();continue}t.length<n&&(e.split(t.length),this.$.lastChild.parentNode.removeChild(this.$.lastChild))}break}CKEDITOR.env.needsBrFiller&&(e=this.$.lastChild)&&1==e.type&&"br"==e.nodeName.toLowerCase()&&e.parentNode.removeChild(e)},isReadOnly:function(e){var t=this;if(this.type!=CKEDITOR.NODE_ELEMENT&&(t=this.getParent()),CKEDITOR.env.edge&&t&&t.is("textarea","input")&&(e=!0),!e&&t&&void 0!==t.$.isContentEditable)return!(t.$.isContentEditable||t.data("cke-editable"));for(;t;){if(t.data("cke-editable"))return!1;if(t.hasAttribute("contenteditable"))return"false"==t.getAttribute("contenteditable");t=t.getParent()}return!0}}),CKEDITOR.dom.window=function(e){CKEDITOR.dom.domObject.call(this,e)},CKEDITOR.dom.window.prototype=new CKEDITOR.dom.domObject,CKEDITOR.tools.extend(CKEDITOR.dom.window.prototype,{focus:function(){this.$.focus()},getViewPaneSize:function(){var e=this.$.document,t="CSS1Compat"==e.compatMode;return{width:(t?e.documentElement.clientWidth:e.body.clientWidth)||0,height:(t?e.documentElement.clientHeight:e.body.clientHeight)||0}},getScrollPosition:function(){var e=this.$;return"pageXOffset"in e?{x:e.pageXOffset||0,y:e.pageYOffset||0}:{x:(e=e.document).documentElement.scrollLeft||e.body.scrollLeft||0,y:e.documentElement.scrollTop||e.body.scrollTop||0}},getFrame:function(){var e=this.$.frameElement;return e?new CKEDITOR.dom.element.get(e):null}}),CKEDITOR.dom.document=function(e){CKEDITOR.dom.domObject.call(this,e)},CKEDITOR.dom.document.prototype=new CKEDITOR.dom.domObject,CKEDITOR.tools.extend(CKEDITOR.dom.document.prototype,{type:CKEDITOR.NODE_DOCUMENT,appendStyleSheet:function(e){if(this.$.createStyleSheet)this.$.createStyleSheet(e);else{var t=new CKEDITOR.dom.element("link");t.setAttributes({rel:"stylesheet",type:"text/css",href:e}),this.getHead().append(t)}},appendStyleText:function(e){if(this.$.createStyleSheet){var t=this.$.createStyleSheet("");t.cssText=e}else{var n=new CKEDITOR.dom.element("style",this);n.append(new CKEDITOR.dom.text(e,this)),this.getHead().append(n)}return t||n.$.sheet},createElement:function(e,t){var n=new CKEDITOR.dom.element(e,this);return t&&(t.attributes&&n.setAttributes(t.attributes),t.styles&&n.setStyles(t.styles)),n},createText:function(e){return new CKEDITOR.dom.text(e,this)},focus:function(){this.getWindow().focus()},getActive:function(){var e;try{e=this.$.activeElement}catch(t){return null}return new CKEDITOR.dom.element(e)},getById:function(e){return(e=this.$.getElementById(e))?new CKEDITOR.dom.element(e):null},getByAddress:function(e,t){for(var n=this.$.documentElement,o=0;n&&o<e.length;o++){var i=e[o];if(t)for(var r=-1,a=0;a<n.childNodes.length;a++){var s=n.childNodes[a];if((!0!==t||3!=s.nodeType||!s.previousSibling||3!=s.previousSibling.nodeType)&&++r==i){n=s;break}}else n=n.childNodes[i]}return n?new CKEDITOR.dom.node(n):null},getElementsByTag:function(e,t){return CKEDITOR.env.ie&&8>=document.documentMode||!t||(e=t+":"+e),new CKEDITOR.dom.nodeList(this.$.getElementsByTagName(e))},getHead:function(){var e=this.$.getElementsByTagName("head")[0];return e?new CKEDITOR.dom.element(e):this.getDocumentElement().append(new CKEDITOR.dom.element("head"),!0)},getBody:function(){return new CKEDITOR.dom.element(this.$.body)},getDocumentElement:function(){return new CKEDITOR.dom.element(this.$.documentElement)},getWindow:function(){return new CKEDITOR.dom.window(this.$.parentWindow||this.$.defaultView)},write:function(e){this.$.open("text/html","replace"),CKEDITOR.env.ie&&(e=e.replace(/(?:^\s*<!DOCTYPE[^>]*?>)|^/i,'$&\n<script data-cke-temp="1">('+CKEDITOR.tools.fixDomain+")();<\/script>")),this.$.write(e),this.$.close()},find:function(e){return new CKEDITOR.dom.nodeList(this.$.querySelectorAll(e))},findOne:function(e){return(e=this.$.querySelector(e))?new CKEDITOR.dom.element(e):null},_getHtml5ShivFrag:function(){var e=this.getCustomData("html5ShivFrag");return e||(e=this.$.createDocumentFragment(),CKEDITOR.tools.enableHtml5Elements(e,!0),this.setCustomData("html5ShivFrag",e)),e}}),CKEDITOR.dom.nodeList=function(e){this.$=e},CKEDITOR.dom.nodeList.prototype={count:function(){return this.$.length},getItem:function(e){return 0>e||e>=this.$.length?null:(e=this.$[e])?new CKEDITOR.dom.node(e):null},toArray:function(){return CKEDITOR.tools.array.map(this.$,(function(e){return new CKEDITOR.dom.node(e)}))}},CKEDITOR.dom.element=function(e,t){"string"==typeof e&&(e=(t?t.$:document).createElement(e)),CKEDITOR.dom.domObject.call(this,e)},CKEDITOR.dom.element.get=function(e){return(e="string"==typeof e?document.getElementById(e)||document.getElementsByName(e)[0]:e)&&(e.$?e:new CKEDITOR.dom.element(e))},CKEDITOR.dom.element.prototype=new CKEDITOR.dom.node,CKEDITOR.dom.element.createFromHtml=function(e,t){var n=new CKEDITOR.dom.element("div",t);return n.setHtml(e),n.getFirst().remove()},CKEDITOR.dom.element.setMarker=function(e,t,n,o){var i=t.getCustomData("list_marker_id")||t.setCustomData("list_marker_id",CKEDITOR.tools.getNextNumber()).getCustomData("list_marker_id"),r=t.getCustomData("list_marker_names")||t.setCustomData("list_marker_names",{}).getCustomData("list_marker_names");return e[i]=t,r[n]=1,t.setCustomData(n,o)},CKEDITOR.dom.element.clearAllMarkers=function(e){for(var t in e)CKEDITOR.dom.element.clearMarkers(e,e[t],1)},CKEDITOR.dom.element.clearMarkers=function(e,t,n){var o,i=t.getCustomData("list_marker_names"),r=t.getCustomData("list_marker_id");for(o in i)t.removeCustomData(o);t.removeCustomData("list_marker_names"),n&&(t.removeCustomData("list_marker_id"),delete e[r])},function(){function e(e,t){return-1<(" "+e+" ").replace(r," ").indexOf(" "+t+" ")}function t(e){var t=!0;return e.$.id||(e.$.id="cke_tmp_"+CKEDITOR.tools.getNextNumber(),t=!1),function(){t||e.removeAttribute("id")}}function n(e,t){var n=CKEDITOR.tools.escapeCss(e.$.id);return"#"+n+" "+t.split(/,\s*/).join(", #"+n+" ")}function o(e){for(var t=0,n=0,o=a[e].length;n<o;n++)t+=parseFloat(this.getComputedStyle(a[e][n])||0,10)||0;return t}var i=void 0!==(i=document.createElement("_").classList)&&null!==String(i.add).match(/\[Native code\]/gi),r=/[\n\t\r]/g;CKEDITOR.tools.extend(CKEDITOR.dom.element.prototype,{type:CKEDITOR.NODE_ELEMENT,addClass:i?function(e){return this.$.classList.add(e),this}:function(t){var n=this.$.className;return n&&(e(n,t)||(n+=" "+t)),this.$.className=n||t,this},removeClass:i?function(e){var t=this.$;return t.classList.remove(e),t.className||t.removeAttribute("class"),this}:function(t){var n=this.getAttribute("class");return n&&e(n,t)&&((n=n.replace(new RegExp("(?:^|\\s+)"+t+"(?=\\s|$)"),"").replace(/^\s+/,""))?this.setAttribute("class",n):this.removeAttribute("class")),this},hasClass:function(t){return e(this.$.className,t)},append:function(e,t){return"string"==typeof e&&(e=this.getDocument().createElement(e)),t?this.$.insertBefore(e.$,this.$.firstChild):this.$.appendChild(e.$),e},appendHtml:function(e){if(this.$.childNodes.length){var t=new CKEDITOR.dom.element("div",this.getDocument());t.setHtml(e),t.moveChildren(this)}else this.setHtml(e)},appendText:function(e){null!=this.$.text&&CKEDITOR.env.ie&&9>CKEDITOR.env.version?this.$.text+=e:this.append(new CKEDITOR.dom.text(e))},appendBogus:function(e){if(e||CKEDITOR.env.needsBrFiller){for(e=this.getLast();e&&e.type==CKEDITOR.NODE_TEXT&&!CKEDITOR.tools.rtrim(e.getText());)e=e.getPrevious();e&&e.is&&e.is("br")||(e=this.getDocument().createElement("br"),CKEDITOR.env.gecko&&e.setAttribute("type","_moz"),this.append(e))}},breakParent:function(e,t){var n=new CKEDITOR.dom.range(this.getDocument());n.setStartAfter(this),n.setEndAfter(e);var o,i=n.extractContents(!1,t||!1);if(n.insertNode(this.remove()),CKEDITOR.env.ie&&!CKEDITOR.env.edge){for(n=new CKEDITOR.dom.element("div");o=i.getFirst();)o.$.style.backgroundColor&&(o.$.style.backgroundColor=o.$.style.backgroundColor),n.append(o);n.insertAfter(this),n.remove(!0)}else i.insertAfterNode(this)},contains:document.compareDocumentPosition?function(e){return!!(16&this.$.compareDocumentPosition(e.$))}:function(e){var t=this.$;return e.type!=CKEDITOR.NODE_ELEMENT?t.contains(e.getParent().$):t!=e.$&&t.contains(e.$)},focus:function(){function e(){try{this.$.focus()}catch(n){}}return function(t){t?CKEDITOR.tools.setTimeout(e,100,this):e.call(this)}}(),getHtml:function(){var e=this.$.innerHTML;return CKEDITOR.env.ie?e.replace(/<\?[^>]*>/g,""):e},getOuterHtml:function(){if(this.$.outerHTML)return this.$.outerHTML.replace(/<\?[^>]*>/,"");var e=this.$.ownerDocument.createElement("div");return e.appendChild(this.$.cloneNode(!0)),e.innerHTML},getClientRect:function(e){var t=CKEDITOR.tools.extend({},this.$.getBoundingClientRect());return!t.width&&(t.width=t.right-t.left),!t.height&&(t.height=t.bottom-t.top),e?CKEDITOR.tools.getAbsoluteRectPosition(this.getWindow(),t):t},setHtml:CKEDITOR.env.ie&&9>CKEDITOR.env.version?function(e){try{var t=this.$;if(this.getParent())return t.innerHTML=e;var n=this.getDocument()._getHtml5ShivFrag();return n.appendChild(t),t.innerHTML=e,n.removeChild(t),e}catch(o){for(this.$.innerHTML="",(t=new CKEDITOR.dom.element("body",this.getDocument())).$.innerHTML=e,t=t.getChildren();t.count();)this.append(t.getItem(0));return e}}:function(e){return this.$.innerHTML=e},setText:function(){var e=document.createElement("p");return e.innerHTML="x",e=e.textContent,function(t){this.$[e?"textContent":"innerText"]=t}}(),getAttribute:CKEDITOR.env.ie&&(CKEDITOR.env.ie7Compat||CKEDITOR.env.quirks)?function(e){switch(e){case"class":e="className";break;case"http-equiv":e="httpEquiv";break;case"name":return this.$.name;case"tabindex":return 0!==(e=this.$.getAttribute(e,2))&&0===this.$.tabIndex&&(e=null),e;case"checked":return((e=this.$.attributes.getNamedItem(e)).specified?e.nodeValue:this.$.checked)?"checked":null;case"hspace":case"value":return this.$[e];case"style":return this.$.style.cssText;case"contenteditable":case"contentEditable":return this.$.attributes.getNamedItem("contentEditable").specified?this.$.getAttribute("contentEditable"):null}return this.$.getAttribute(e,2)}:function(e){return this.$.getAttribute(e,2)},getAttributes:function(e){var t,n={},o=this.$.attributes;for(e=CKEDITOR.tools.isArray(e)?e:[],t=0;t<o.length;t++)-1===CKEDITOR.tools.indexOf(e,o[t].name)&&(n[o[t].name]=o[t].value);return n},getChildren:function(){return new CKEDITOR.dom.nodeList(this.$.childNodes)},getClientSize:function(){return{width:this.$.clientWidth,height:this.$.clientHeight}},getComputedStyle:document.defaultView&&document.defaultView.getComputedStyle?function(e){var t=this.getWindow().$.getComputedStyle(this.$,null);return t?t.getPropertyValue(e):""}:function(e){return this.$.currentStyle[CKEDITOR.tools.cssStyleToDomStyle(e)]},getDtd:function(){var e=CKEDITOR.dtd[this.getName()];return this.getDtd=function(){return e},e},getElementsByTag:CKEDITOR.dom.document.prototype.getElementsByTag,getTabIndex:function(){var e=this.$.tabIndex;return 0!==e||CKEDITOR.dtd.$tabIndex[this.getName()]||0===parseInt(this.getAttribute("tabindex"),10)?e:-1},getText:function(){return this.$.textContent||this.$.innerText||""},getWindow:function(){return this.getDocument().getWindow()},getId:function(){return this.$.id||null},getNameAtt:function(){return this.$.name||null},getName:function(){var e=this.$.nodeName.toLowerCase();if(CKEDITOR.env.ie&&8>=document.documentMode){var t=this.$.scopeName;"HTML"!=t&&(e=t.toLowerCase()+":"+e)}return this.getName=function(){return e},this.getName()},getValue:function(){return this.$.value},getFirst:function(e){var t=this.$.firstChild;return(t=t&&new CKEDITOR.dom.node(t))&&e&&!e(t)&&(t=t.getNext(e)),t},getLast:function(e){var t=this.$.lastChild;return(t=t&&new CKEDITOR.dom.node(t))&&e&&!e(t)&&(t=t.getPrevious(e)),t},getStyle:function(e){return this.$.style[CKEDITOR.tools.cssStyleToDomStyle(e)]},is:function(){var e=this.getName();if("object"==typeof arguments[0])return!!arguments[0][e];for(var t=0;t<arguments.length;t++)if(arguments[t]==e)return!0;return!1},isEditable:function(e){var t=this.getName();return!(this.isReadOnly()||"none"==this.getComputedStyle("display")||"hidden"==this.getComputedStyle("visibility")||CKEDITOR.dtd.$nonEditable[t]||CKEDITOR.dtd.$empty[t]||this.is("a")&&(this.data("cke-saved-name")||this.hasAttribute("name"))&&!this.getChildCount()||!1!==e&&(!(e=CKEDITOR.dtd[t]||CKEDITOR.dtd.span)||!e["#"]))},isIdentical:function(e){var t=this.clone(0,1);if(e=e.clone(0,1),t.removeAttributes(["_moz_dirty","data-cke-expando","data-cke-saved-href","data-cke-saved-name"]),e.removeAttributes(["_moz_dirty","data-cke-expando","data-cke-saved-href","data-cke-saved-name"]),t.$.isEqualNode)return t.$.style.cssText=CKEDITOR.tools.normalizeCssText(t.$.style.cssText),e.$.style.cssText=CKEDITOR.tools.normalizeCssText(e.$.style.cssText),t.$.isEqualNode(e.$);if(t=t.getOuterHtml(),e=e.getOuterHtml(),CKEDITOR.env.ie&&9>CKEDITOR.env.version&&this.is("a")){var n=this.getParent();n.type==CKEDITOR.NODE_ELEMENT&&((n=n.clone()).setHtml(t),t=n.getHtml(),n.setHtml(e),e=n.getHtml())}return t==e},isVisible:function(){var e,t,n=(this.$.offsetHeight||this.$.offsetWidth)&&"hidden"!=this.getComputedStyle("visibility");return n&&CKEDITOR.env.webkit&&!(e=this.getWindow()).equals(CKEDITOR.document.getWindow())&&(t=e.$.frameElement)&&(n=new CKEDITOR.dom.element(t).isVisible()),!!n},isEmptyInlineRemoveable:function(){if(!CKEDITOR.dtd.$removeEmpty[this.getName()])return!1;for(var e=this.getChildren(),t=0,n=e.count();t<n;t++){var o=e.getItem(t);if((o.type!=CKEDITOR.NODE_ELEMENT||!o.data("cke-bookmark"))&&(o.type==CKEDITOR.NODE_ELEMENT&&!o.isEmptyInlineRemoveable()||o.type==CKEDITOR.NODE_TEXT&&CKEDITOR.tools.trim(o.getText())))return!1}return!0},hasAttributes:CKEDITOR.env.ie&&(CKEDITOR.env.ie7Compat||CKEDITOR.env.quirks)?function(){for(var e=this.$.attributes,t=0;t<e.length;t++){var n=e[t];switch(n.nodeName){case"class":if(this.getAttribute("class"))return!0;case"data-cke-expando":continue;default:if(n.specified)return!0}}return!1}:function(){var e=this.$.attributes,t=e.length,n={"data-cke-expando":1,_moz_dirty:1};return 0<t&&(2<t||!n[e[0].nodeName]||2==t&&!n[e[1].nodeName])},hasAttribute:function(){function e(e){var t=this.$.attributes.getNamedItem(e);if("input"==this.getName())switch(e){case"class":return 0<this.$.className.length;case"checked":return!!this.$.checked;case"value":return"checkbox"==(e=this.getAttribute("type"))||"radio"==e?"on"!=this.$.value:!!this.$.value}return!!t&&t.specified}return CKEDITOR.env.ie?8>CKEDITOR.env.version?function(t){return"name"==t?!!this.$.name:e.call(this,t)}:e:function(e){return!!this.$.attributes.getNamedItem(e)}}(),hide:function(){this.setStyle("display","none")},moveChildren:function(e,t){var n,o=this.$;if(o!=(e=e.$))if(t)for(;n=o.lastChild;)e.insertBefore(o.removeChild(n),e.firstChild);else for(;n=o.firstChild;)e.appendChild(o.removeChild(n))},mergeSiblings:function(){function e(e,t,n){if(t&&t.type==CKEDITOR.NODE_ELEMENT){for(var o=[];t.data("cke-bookmark")||t.isEmptyInlineRemoveable();)if(o.push(t),!(t=n?t.getNext():t.getPrevious())||t.type!=CKEDITOR.NODE_ELEMENT)return;if(e.isIdentical(t)){for(var i=n?e.getLast():e.getFirst();o.length;)o.shift().move(e,!n);t.moveChildren(e,!n),t.remove(),i&&i.type==CKEDITOR.NODE_ELEMENT&&i.mergeSiblings()}}}return function(t){(!1===t||CKEDITOR.dtd.$removeEmpty[this.getName()]||this.is("a"))&&(e(this,this.getNext(),!0),e(this,this.getPrevious()))}}(),show:function(){this.setStyles({display:"",visibility:""})},setAttribute:function(){var e=function(e,t){return this.$.setAttribute(e,t),this};return CKEDITOR.env.ie&&(CKEDITOR.env.ie7Compat||CKEDITOR.env.quirks)?function(t,n){return"class"==t?this.$.className=n:"style"==t?this.$.style.cssText=n:"tabindex"==t?this.$.tabIndex=n:"checked"==t?this.$.checked=n:"contenteditable"==t?e.call(this,"contentEditable",n):e.apply(this,arguments),this}:CKEDITOR.env.ie8Compat&&CKEDITOR.env.secure?function(t,n){if("src"==t&&n.match(/^http:\/\//))try{e.apply(this,arguments)}catch(o){}else e.apply(this,arguments);return this}:e}(),setAttributes:function(e){for(var t in e)this.setAttribute(t,e[t]);return this},setValue:function(e){return this.$.value=e,this},removeAttribute:CKEDITOR.env.ie&&(CKEDITOR.env.ie7Compat||CKEDITOR.env.quirks)?function(e){"class"==e?e="className":"tabindex"==e?e="tabIndex":"contenteditable"==e&&(e="contentEditable"),this.$.removeAttribute(e)}:function(e){this.$.removeAttribute(e)},removeAttributes:function(e){if(CKEDITOR.tools.isArray(e))for(var t=0;t<e.length;t++)this.removeAttribute(e[t]);else for(t in e=e||this.getAttributes())e.hasOwnProperty(t)&&this.removeAttribute(t)},removeStyle:function(e){if((o=this.$.style).removeProperty||"border"!=e&&"margin"!=e&&"padding"!=e)o.removeProperty?o.removeProperty(e):o.removeAttribute(CKEDITOR.tools.cssStyleToDomStyle(e)),this.$.style.cssText||this.removeAttribute("style");else{var t,n=["top","left","right","bottom"];"border"==e&&(t=["color","style","width"]);for(var o=[],i=0;i<n.length;i++)if(t)for(var r=0;r<t.length;r++)o.push([e,n[i],t[r]].join("-"));else o.push([e,n[i]].join("-"));for(e=0;e<o.length;e++)this.removeStyle(o[e])}},setStyle:function(e,t){return this.$.style[CKEDITOR.tools.cssStyleToDomStyle(e)]=t,this},setStyles:function(e){for(var t in e)this.setStyle(t,e[t]);return this},setOpacity:function(e){CKEDITOR.env.ie&&9>CKEDITOR.env.version?(e=Math.round(100*e),this.setStyle("filter",100<=e?"":"progid:DXImageTransform.Microsoft.Alpha(opacity="+e+")")):this.setStyle("opacity",e)},unselectable:function(){if(this.setStyles(CKEDITOR.tools.cssVendorPrefix("user-select","none")),CKEDITOR.env.ie){this.setAttribute("unselectable","on");for(var e=this.getElementsByTag("*"),t=0,n=e.count();t<n;t++)e.getItem(t).setAttribute("unselectable","on")}},getPositionedAncestor:function(){for(var e=this;"html"!=e.getName();){if("static"!=e.getComputedStyle("position"))return e;e=e.getParent()}return null},getDocumentPosition:function(e){var t=0,n=0,o=this.getDocument(),i=o.getBody(),r="BackCompat"==o.$.compatMode;if(!document.documentElement.getBoundingClientRect||CKEDITOR.env.ie&&8===CKEDITOR.env.version)for(l=this,u=null;l&&"body"!=l.getName()&&"html"!=l.getName();){for(t+=l.$.offsetLeft-l.$.scrollLeft,n+=l.$.offsetTop-l.$.scrollTop,l.equals(this)||(t+=l.$.clientLeft||0,n+=l.$.clientTop||0);u&&!u.equals(l);)t-=u.$.scrollLeft,n-=u.$.scrollTop,u=u.getParent();u=l,l=(a=l.$.offsetParent)?new CKEDITOR.dom.element(a):null}else{var a=this.$.getBoundingClientRect(),s=o.$.documentElement,l=s.clientTop||i.$.clientTop||0,u=s.clientLeft||i.$.clientLeft||0,c=!0;CKEDITOR.env.ie&&(c=o.getDocumentElement().contains(this),o=o.getBody().contains(this),c=r&&o||!r&&c),c&&(CKEDITOR.env.webkit||CKEDITOR.env.ie&&12<=CKEDITOR.env.version?(t=i.$.scrollLeft||s.scrollLeft,n=i.$.scrollTop||s.scrollTop):(t=(n=r?i.$:s).scrollLeft,n=n.scrollTop),t=a.left+t-u,n=a.top+n-l)}return e&&(a=this.getWindow(),l=e.getWindow(),!a.equals(l)&&a.$.frameElement&&(t+=(e=new CKEDITOR.dom.element(a.$.frameElement).getDocumentPosition(e)).x,n+=e.y)),document.documentElement.getBoundingClientRect||!CKEDITOR.env.gecko||r||(t+=this.$.clientLeft?1:0,n+=this.$.clientTop?1:0),{x:t,y:n}},scrollIntoView:function(e){var n=this.getParent();if(n)do{if((n.$.clientWidth&&n.$.clientWidth<n.$.scrollWidth||n.$.clientHeight&&n.$.clientHeight<n.$.scrollHeight)&&!n.is("body")&&this.scrollIntoParent(n,e,1),n.is("html")){var o=n.getWindow();try{var i=o.$.frameElement;i&&(n=new CKEDITOR.dom.element(i))}catch(t){}}}while(n=n.getParent())},scrollIntoParent:function(e,t,n){var o,i,r,a;function s(t,n){/body|html/.test(e.getName())?e.getWindow().$.scrollBy(t,n):(e.$.scrollLeft+=t,e.$.scrollTop+=n)}function l(e,t){var n={x:0,y:0};if(!e.is(c?"body":"html")){var o=e.$.getBoundingClientRect();n.x=o.left,n.y=o.top}return(o=e.getWindow()).equals(t)||(o=l(CKEDITOR.dom.element.get(o.$.frameElement),t),n.x+=o.x,n.y+=o.y),n}function u(e,t){return parseInt(e.getComputedStyle("margin-"+t)||0,10)||0}!e&&(e=this.getWindow());var c="BackCompat"==(r=e.getDocument()).$.compatMode;e instanceof CKEDITOR.dom.window&&(e=c?r.getBody():r.getDocumentElement()),CKEDITOR.env.webkit&&(r=this.getEditor(!1))&&(r._.previousScrollTop=null),i=l(this,r=e.getWindow());var d=l(e,r),f=this.$.offsetHeight;o=this.$.offsetWidth;var h=e.$.clientHeight,g=e.$.clientWidth;r=i.x-u(this,"left")-d.x||0,a=i.y-u(this,"top")-d.y||0,o=i.x+o+u(this,"right")-(d.x+g)||0,i=i.y+f+u(this,"bottom")-(d.y+h)||0,(0>a||0<i)&&s(0,!0===t?a:!1===t?i:0>a?a:i),n&&(0>r||0<o)&&s(0>r?r:o,0)},setState:function(e,t,n){switch(t=t||"cke",e){case CKEDITOR.TRISTATE_ON:this.addClass(t+"_on"),this.removeClass(t+"_off"),this.removeClass(t+"_disabled"),n&&this.setAttribute("aria-pressed",!0),n&&this.removeAttribute("aria-disabled");break;case CKEDITOR.TRISTATE_DISABLED:this.addClass(t+"_disabled"),this.removeClass(t+"_off"),this.removeClass(t+"_on"),n&&this.setAttribute("aria-disabled",!0),n&&this.removeAttribute("aria-pressed");break;default:this.addClass(t+"_off"),this.removeClass(t+"_on"),this.removeClass(t+"_disabled"),n&&this.removeAttribute("aria-pressed"),n&&this.removeAttribute("aria-disabled")}},getFrameDocument:function(){var e=this.$;return e&&new CKEDITOR.dom.document(e.contentWindow.document)},copyAttributes:function(e,t){var n=this.$.attributes;t=t||{};for(var o=0;o<n.length;o++){var i,r=n[o],a=r.nodeName.toLowerCase();a in t||("checked"==a&&(i=this.getAttribute(a))?e.setAttribute(a,i):CKEDITOR.env.ie&&!this.hasAttribute(a)||(null===(i=this.getAttribute(a))&&(i=r.nodeValue),e.setAttribute(a,i)))}""!==this.$.style.cssText&&(e.$.style.cssText=this.$.style.cssText)},renameNode:function(e){if(this.getName()!=e){var t=this.getDocument();e=new CKEDITOR.dom.element(e,t),this.copyAttributes(e),this.moveChildren(e),this.getParent(!0)&&this.$.parentNode.replaceChild(e.$,this.$),e.$["data-cke-expando"]=this.$["data-cke-expando"],this.$=e.$,delete this.getName}},getChild:function(){function e(e,t){var n=e.childNodes;if(0<=t&&t<n.length)return n[t]}return function(t){var n=this.$;if(t.slice)for(t=t.slice();0<t.length&&n;)n=e(n,t.shift());else n=e(n,t);return n?new CKEDITOR.dom.node(n):null}}(),getChildCount:function(){return this.$.childNodes.length},disableContextMenu:function(){function e(e){return e.type==CKEDITOR.NODE_ELEMENT&&e.hasClass("cke_enable_context_menu")}this.on("contextmenu",(function(t){t.data.getTarget().getAscendant(e,!0)||t.data.preventDefault()}))},getDirection:function(e){return e?this.getComputedStyle("direction")||this.getDirection()||this.getParent()&&this.getParent().getDirection(1)||this.getDocument().$.dir||"ltr":this.getStyle("direction")||this.getAttribute("dir")},data:function(e,t){return e="data-"+e,void 0===t?this.getAttribute(e):(!1===t?this.removeAttribute(e):this.setAttribute(e,t),null)},getEditor:function(e){var t,n,o,i=CKEDITOR.instances;for(t in e=e||void 0===e,i)if((n=i[t]).element.equals(this)&&n.elementMode!=CKEDITOR.ELEMENT_MODE_APPENDTO||!e&&(o=n.editable())&&(o.equals(this)||o.contains(this)))return n;return null},find:function(e){var o=t(this);return e=new CKEDITOR.dom.nodeList(this.$.querySelectorAll(n(this,e))),o(),e},findOne:function(e){var o=t(this);return e=this.$.querySelector(n(this,e)),o(),e?new CKEDITOR.dom.element(e):null},forEach:function(e,t,n){if(!(n||t&&this.type!=t))var o=e(this);if(!1!==o){n=this.getChildren();for(var i=0;i<n.count();i++)(o=n.getItem(i)).type==CKEDITOR.NODE_ELEMENT?o.forEach(e,t):t&&o.type!=t||e(o)}},fireEventHandler:function(e,t){var n="on"+e,o=this.$;if(CKEDITOR.env.ie&&9>CKEDITOR.env.version){var i,r=o.ownerDocument.createEventObject();for(i in t)r[i]=t[i];o.fireEvent(n,r)}else o[o[e]?e:n](t)},isDetached:function(){var e=this.getDocument(),t=e.getDocumentElement();return!t.equals(this)&&!t.contains(this)||(!CKEDITOR.env.ie||8<CKEDITOR.env.version&&!CKEDITOR.env.quirks)&&!e.$.defaultView}});var a={width:["border-left-width","border-right-width","padding-left","padding-right"],height:["border-top-width","border-bottom-width","padding-top","padding-bottom"]};CKEDITOR.dom.element.prototype.setSize=function(e,t,n){"number"==typeof t&&(!n||CKEDITOR.env.ie&&CKEDITOR.env.quirks||(t-=o.call(this,e)),this.setStyle(e,t+"px"))},CKEDITOR.dom.element.prototype.getSize=function(e,t){var n=Math.max(this.$["offset"+CKEDITOR.tools.capitalize(e)],this.$["client"+CKEDITOR.tools.capitalize(e)])||0;return t&&(n-=o.call(this,e)),n}}(),CKEDITOR.dom.documentFragment=function(e){e=e||CKEDITOR.document,this.$=e.type==CKEDITOR.NODE_DOCUMENT?e.$.createDocumentFragment():e},CKEDITOR.tools.extend(CKEDITOR.dom.documentFragment.prototype,CKEDITOR.dom.element.prototype,{type:CKEDITOR.NODE_DOCUMENT_FRAGMENT,insertAfterNode:function(e){(e=e.$).parentNode.insertBefore(this.$,e.nextSibling)},getHtml:function(){var e=new CKEDITOR.dom.element("div");return this.clone(1,1).appendTo(e),e.getHtml().replace(/\s*data-cke-expando=".*?"/g,"")}},!0,{append:1,appendBogus:1,clone:1,getFirst:1,getHtml:1,getLast:1,getParent:1,getNext:1,getPrevious:1,appendTo:1,moveChildren:1,insertBefore:1,insertAfterNode:1,replace:1,trim:1,type:1,ltrim:1,rtrim:1,getDocument:1,getChildCount:1,getChild:1,getChildren:1}),CKEDITOR.tools.extend(CKEDITOR.dom.documentFragment.prototype,CKEDITOR.dom.document.prototype,!0,{find:1,findOne:1}),function(){function e(e,t){var n=this.range;if(this._.end)return null;if(!this._.start){if(this._.start=1,n.collapsed)return this.end(),null;n.optimize()}var o,i=n.startContainer;o=n.endContainer;var r,a=n.startOffset,s=n.endOffset,l=this.guard,u=this.type,c=e?"getPreviousSourceNode":"getNextSourceNode";if(!e&&!this._.guardLTR){var d=o.type==CKEDITOR.NODE_ELEMENT?o:o.getParent(),f=o.type==CKEDITOR.NODE_ELEMENT?o.getChild(s):o.getNext();this._.guardLTR=function(e,t){return!(t&&d.equals(e)||f&&e.equals(f)||e.type==CKEDITOR.NODE_ELEMENT&&t&&e.equals(n.root))}}if(e&&!this._.guardRTL){var h=i.type==CKEDITOR.NODE_ELEMENT?i:i.getParent(),g=i.type==CKEDITOR.NODE_ELEMENT?a?i.getChild(a-1):null:i.getPrevious();this._.guardRTL=function(e,t){return!(t&&h.equals(e)||g&&e.equals(g)||e.type==CKEDITOR.NODE_ELEMENT&&t&&e.equals(n.root))}}var m=e?this._.guardRTL:this._.guardLTR;for(r=l?function(e,t){return!1!==m(e,t)&&l(e,t)}:m,this.current?o=this.current[c](!1,u,r):(e?o.type==CKEDITOR.NODE_ELEMENT&&(o=0<s?o.getChild(s-1):!1===r(o,!0)?null:o.getPreviousSourceNode(!0,u,r)):(o=i).type==CKEDITOR.NODE_ELEMENT&&((o=o.getChild(a))||(o=!1===r(i,!0)?null:i.getNextSourceNode(!0,u,r))),o&&!1===r(o)&&(o=null));o&&!this._.end;){if(this.current=o,this.evaluator&&!1===this.evaluator(o)){if(t&&this.evaluator)return!1}else if(!t)return o;o=o[c](!1,u,r)}return this.end(),this.current=null}function t(t){for(var n,o=null;n=e.call(this,t);)o=n;return o}CKEDITOR.dom.walker=CKEDITOR.tools.createClass({$:function(e){this.range=e,this._={}},proto:{end:function(){this._.end=1},next:function(){return e.call(this)},previous:function(){return e.call(this,1)},checkForward:function(){return!1!==e.call(this,0,1)},checkBackward:function(){return!1!==e.call(this,1,1)},lastForward:function(){return t.call(this)},lastBackward:function(){return t.call(this,1)},reset:function(){delete this.current,this._={}}}});var n={block:1,"list-item":1,table:1,"table-row-group":1,"table-header-group":1,"table-footer-group":1,"table-row":1,"table-column-group":1,"table-column":1,"table-cell":1,"table-caption":1},o={absolute:1,fixed:1};CKEDITOR.dom.element.prototype.isBlockBoundary=function(e){return!("none"!=this.getComputedStyle("float")||this.getComputedStyle("position")in o||!n[this.getComputedStyle("display")])||!!(this.is(CKEDITOR.dtd.$block)||e&&this.is(e))},CKEDITOR.dom.walker.blockBoundary=function(e){return function(t){return!(t.type==CKEDITOR.NODE_ELEMENT&&t.isBlockBoundary(e))}},CKEDITOR.dom.walker.listItemBoundary=function(){return this.blockBoundary({br:1})},CKEDITOR.dom.walker.bookmark=function(e,t){function n(e){return e&&e.getName&&"span"==e.getName()&&e.data("cke-bookmark")}return function(o){var i,r;return i=o&&o.type!=CKEDITOR.NODE_ELEMENT&&(r=o.getParent())&&n(r),i=e?i:i||n(o),!!(t^i)}},CKEDITOR.dom.walker.whitespaces=function(e){return function(t){var n;return t&&t.type==CKEDITOR.NODE_TEXT&&(n=!CKEDITOR.tools.trim(t.getText())||CKEDITOR.env.webkit&&t.getText()==CKEDITOR.dom.selection.FILLING_CHAR_SEQUENCE),!!(e^n)}},CKEDITOR.dom.walker.invisible=function(e){var t=CKEDITOR.dom.walker.whitespaces(),n=CKEDITOR.env.webkit?1:0;return function(o){return t(o)?o=1:(o.type==CKEDITOR.NODE_TEXT&&(o=o.getParent()),o=o.$.offsetWidth<=n),!!(e^o)}},CKEDITOR.dom.walker.nodeType=function(e,t){return function(n){return!!(t^n.type==e)}},CKEDITOR.dom.walker.bogus=function(e){function t(e){return!r(e)&&!a(e)}return function(n){var o=CKEDITOR.env.needsBrFiller?n.is&&n.is("br"):n.getText&&i.test(n.getText());return o&&(o=n.getParent(),n=n.getNext(t),o=o.isBlockBoundary()&&(!n||n.type==CKEDITOR.NODE_ELEMENT&&n.isBlockBoundary())),!!(e^o)}},CKEDITOR.dom.walker.temp=function(e){return function(t){return t.type!=CKEDITOR.NODE_ELEMENT&&(t=t.getParent()),t=t&&t.hasAttribute("data-cke-temp"),!!(e^t)}};var i=/^[\t\r\n ]*(?:&nbsp;|\xa0)$/,r=CKEDITOR.dom.walker.whitespaces(),a=CKEDITOR.dom.walker.bookmark(),s=CKEDITOR.dom.walker.temp(),l=function(e){return a(e)||r(e)||e.type==CKEDITOR.NODE_ELEMENT&&e.is(CKEDITOR.dtd.$inline)&&!e.is(CKEDITOR.dtd.$empty)};CKEDITOR.dom.walker.ignored=function(e){return function(t){return t=r(t)||a(t)||s(t),!!(e^t)}};var u=CKEDITOR.dom.walker.ignored();CKEDITOR.dom.walker.empty=function(e){return function(t){for(var n=0,o=t.getChildCount();n<o;++n)if(!u(t.getChild(n)))return!!e;return!e}};var c=CKEDITOR.dom.walker.empty(),d=CKEDITOR.dom.walker.validEmptyBlockContainers=CKEDITOR.tools.extend(function(e){var t,n={};for(t in e)CKEDITOR.dtd[t]["#"]&&(n[t]=1);return n}(CKEDITOR.dtd.$block),{caption:1,td:1,th:1});CKEDITOR.dom.walker.editable=function(e){return function(t){return t=!u(t)&&!!(t.type==CKEDITOR.NODE_TEXT||t.type==CKEDITOR.NODE_ELEMENT&&(t.is(CKEDITOR.dtd.$inline)||t.is("hr")||"false"==t.getAttribute("contenteditable")||!CKEDITOR.env.needsBrFiller&&t.is(d)&&c(t))),!!(e^t)}},CKEDITOR.dom.element.prototype.getBogus=function(){var e=this;do{e=e.getPreviousSourceNode()}while(l(e));return!(!e||!(CKEDITOR.env.needsBrFiller?e.is&&e.is("br"):e.getText&&i.test(e.getText())))&&e}}(),CKEDITOR.dom.range=function(e){this.endOffset=this.endContainer=this.startOffset=this.startContainer=null,this.collapsed=!0;var t=e instanceof CKEDITOR.dom.document;this.document=t?e:e.getDocument(),this.root=t?e.getBody():e},function(){function e(e){e.collapsed=e.startContainer&&e.endContainer&&e.startContainer.equals(e.endContainer)&&e.startOffset==e.endOffset}function t(e,t,n,o,i){function r(e,t,n,o){var r=n?e.getPrevious():e.getNext();return o&&a||(l||o?t.append(e.clone(!0,i),n):(e.remove(),s&&t.append(e,n))),r}e.optimizeBookmark();var a=0===t,s=1==t,l=2==t;t=l||s;var u,c,d,f,h,g,m=e.startContainer,p=e.endContainer,v=e.startOffset,y=e.endOffset;if(l&&p.type==CKEDITOR.NODE_TEXT&&(m.equals(p)||m.type===CKEDITOR.NODE_ELEMENT&&m.getFirst().equals(p)))n.append(e.document.createText(p.substring(v,y)));else{p.type==CKEDITOR.NODE_TEXT?l?g=!0:p=p.split(y):0<p.getChildCount()?y>=p.getChildCount()?(p=p.getChild(y-1),c=!0):p=p.getChild(y):f=c=!0,m.type==CKEDITOR.NODE_TEXT?l?h=!0:m.split(v):0<m.getChildCount()?0===v?(m=m.getChild(v),u=!0):m=m.getChild(v-1):d=u=!0;for(var b,C,T,x=m.getParents(),E=p.getParents(),_=function(){var e,t=Math.min(x.length,E.length);for(e=0;e<t;e++)if(!x[e].equals(E[e]))return e;return e-1}(),I=x.length-1,D=E.length-1,O=n,w=-1,R=_;R<=I;R++){for(T=(C=x[R]).getNext(),R!=I||C.equals(E[R])&&I<D?t&&(b=O.append(C.clone(0,i))):u?r(C,O,!1,d):h&&O.append(e.document.createText(C.substring(v)));T;){if(T.equals(E[R])){w=R;break}T=r(T,O)}O=b}for(O=n,R=_;R<=D;R++)if(T=(n=E[R]).getPrevious(),n.equals(x[R]))t&&(O=O.getChild(0));else{if(R!=D||n.equals(x[R])&&D<I?t&&(b=O.append(n.clone(0,i))):c?r(n,O,!1,f):g&&O.append(e.document.createText(n.substring(0,y))),R>w)for(;T;)T=r(T,O,!0);O=b}l||function(){var t=_-1,n=d&&f&&!m.equals(p);t<I-1||t<D-1||n?(n?e.moveToPosition(p,CKEDITOR.POSITION_BEFORE_START):D==t+1&&c?e.moveToPosition(E[t],CKEDITOR.POSITION_BEFORE_END):e.moveToPosition(E[t+1],CKEDITOR.POSITION_BEFORE_START),o&&(t=x[t+1])&&t.type==CKEDITOR.NODE_ELEMENT&&((n=CKEDITOR.dom.element.createFromHtml('<span data-cke-bookmark="1" style="display:none">&nbsp;</span>',e.document)).insertAfter(t),t.mergeSiblings(!1),e.moveToBookmark({startNode:n}))):e.collapse(!0)}()}}function n(){var e=!1,t=CKEDITOR.dom.walker.whitespaces(),n=CKEDITOR.dom.walker.bookmark(!0),o=CKEDITOR.dom.walker.bogus();return function(r){return!(!n(r)&&!t(r))||(o(r)&&!e?e=!0:!(r.type==CKEDITOR.NODE_TEXT&&(r.hasAscendant("pre")||CKEDITOR.tools.trim(r.getText()).length)||r.type==CKEDITOR.NODE_ELEMENT&&!r.is(i)))}}function o(e){return function(){var t;return this[e?"getPreviousNode":"getNextNode"]((function(e){return!t&&l(e)&&(t=e),s(e)&&!(r(e)&&e.equals(t))}))}}var i={abbr:1,acronym:1,b:1,bdo:1,big:1,cite:1,code:1,del:1,dfn:1,em:1,font:1,i:1,ins:1,label:1,kbd:1,q:1,samp:1,small:1,span:1,strike:1,strong:1,sub:1,sup:1,tt:1,u:1,var:1},r=CKEDITOR.dom.walker.bogus(),a=/^[\t\r\n ]*(?:&nbsp;|\xa0)$/,s=CKEDITOR.dom.walker.editable(),l=CKEDITOR.dom.walker.ignored(!0);CKEDITOR.dom.range.prototype={clone:function(){var e=new CKEDITOR.dom.range(this.root);return e._setStartContainer(this.startContainer),e.startOffset=this.startOffset,e._setEndContainer(this.endContainer),e.endOffset=this.endOffset,e.collapsed=this.collapsed,e},collapse:function(e){e?(this._setEndContainer(this.startContainer),this.endOffset=this.startOffset):(this._setStartContainer(this.endContainer),this.startOffset=this.endOffset),this.collapsed=!0},cloneContents:function(e){var n=new CKEDITOR.dom.documentFragment(this.document);return this.collapsed||t(this,2,n,!1,void 0===e||e),n},deleteContents:function(e){this.collapsed||t(this,0,null,e)},extractContents:function(e,n){var o=new CKEDITOR.dom.documentFragment(this.document);return this.collapsed||t(this,1,o,e,void 0===n||n),o},equals:function(e){return this.startOffset===e.startOffset&&this.endOffset===e.endOffset&&this.startContainer.equals(e.startContainer)&&this.endContainer.equals(e.endContainer)},createBookmark:function(e){function t(e){return e.getAscendant((function(e){var t;return(t=e.data&&e.data("cke-temp"))&&(t=-1===CKEDITOR.tools.array.indexOf(["cke_copybin","cke_pastebin"],e.getAttribute("id"))),t}),!0)}var n,o,i,r,a=this.startContainer,s=this.endContainer,l=this.collapsed;return(n=this.document.createElement("span")).data("cke-bookmark",1),n.setStyle("display","none"),n.setHtml("&nbsp;"),e&&(i="cke_bm_"+CKEDITOR.tools.getNextNumber(),n.setAttribute("id",i+(l?"C":"S"))),l||((o=n.clone()).setHtml("&nbsp;"),e&&o.setAttribute("id",i+"E"),r=this.clone(),t(s)&&(s=t(s),r.moveToPosition(s,CKEDITOR.POSITION_AFTER_END)),r.collapse(),r.insertNode(o)),r=this.clone(),t(a)&&(s=t(a),r.moveToPosition(s,CKEDITOR.POSITION_BEFORE_START)),r.collapse(!0),r.insertNode(n),o?(this.setStartAfter(n),this.setEndBefore(o)):this.moveToPosition(n,CKEDITOR.POSITION_AFTER_END),{startNode:e?i+(l?"C":"S"):n,endNode:e?i+"E":o,serializable:e,collapsed:l}},createBookmark2:function(){function e(e){var t,o=e.container,i=e.offset,r=i;if((t=(t=o).type!=CKEDITOR.NODE_ELEMENT||0===r||r==t.getChildCount()?0:t.getChild(r-1).type==CKEDITOR.NODE_TEXT&&t.getChild(r).type==CKEDITOR.NODE_TEXT)&&(i=(o=o.getChild(i-1)).getLength()),o.type==CKEDITOR.NODE_ELEMENT&&0<i){e:{for(t=o;i--;)if(0<=(r=t.getChild(i).getIndex(!0))){i=r;break e}i=-1}i+=1}if(o.type==CKEDITOR.NODE_TEXT){for(t=o,r=0;(t=t.getPrevious())&&t.type==CKEDITOR.NODE_TEXT;)r+=t.getText().replace(CKEDITOR.dom.selection.FILLING_CHAR_SEQUENCE,"").length;t=r,o.isEmpty()?(r=o.getPrevious(n),t?(i=t,o=r?r.getNext():o.getParent().getFirst()):(o=o.getParent(),i=r?r.getIndex(!0)+1:0)):i+=t}e.container=o,e.offset=i}function t(e,t){var n=t.getCustomData("cke-fillingChar");if(n){var o=e.container;n.equals(o)&&(e.offset-=CKEDITOR.dom.selection.FILLING_CHAR_SEQUENCE.length,0>=e.offset&&(e.offset=o.getIndex(),e.container=o.getParent()))}}var n=CKEDITOR.dom.walker.nodeType(CKEDITOR.NODE_TEXT,!0);return function(n){var o=this.collapsed,i={container:this.startContainer,offset:this.startOffset},r={container:this.endContainer,offset:this.endOffset};return n&&(e(i),t(i,this.root),o||(e(r),t(r,this.root))),{start:i.container.getAddress(n),end:o?null:r.container.getAddress(n),startOffset:i.offset,endOffset:r.offset,normalized:n,collapsed:o,is2:!0}}}(),moveToBookmark:function(e){if(e.is2){var t=this.document.getByAddress(e.start,e.normalized),n=e.startOffset,o=e.end&&this.document.getByAddress(e.end,e.normalized);e=e.endOffset,this.setStart(t,n),o?this.setEnd(o,e):this.collapse(!0)}else t=(n=e.serializable)?this.document.getById(e.startNode):e.startNode,e=n?this.document.getById(e.endNode):e.endNode,this.setStartBefore(t),t.remove(),e?(this.setEndBefore(e),e.remove()):this.collapse(!0)},getBoundaryNodes:function(){var e,t=this.startContainer,n=this.endContainer,o=this.startOffset,i=this.endOffset;if(t.type==CKEDITOR.NODE_ELEMENT)if((e=t.getChildCount())>o)t=t.getChild(o);else if(1>e)t=t.getPreviousSourceNode();else{for(t=t.$;t.lastChild;)t=t.lastChild;t=(t=new CKEDITOR.dom.node(t)).getNextSourceNode()||t}if(n.type==CKEDITOR.NODE_ELEMENT)if((e=n.getChildCount())>i)n=n.getChild(i).getPreviousSourceNode(!0);else if(1>e)n=n.getPreviousSourceNode();else{for(n=n.$;n.lastChild;)n=n.lastChild;n=new CKEDITOR.dom.node(n)}return t.getPosition(n)&CKEDITOR.POSITION_FOLLOWING&&(t=n),{startNode:t,endNode:n}},getCommonAncestor:function(e,t){var n=this.endContainer,o=(o=this.startContainer).equals(n)?e&&o.type==CKEDITOR.NODE_ELEMENT&&this.startOffset==this.endOffset-1?o.getChild(this.startOffset):o:o.getCommonAncestor(n);return t&&!o.is?o.getParent():o},optimize:function(){var e=this.startContainer,t=this.startOffset;e.type!=CKEDITOR.NODE_ELEMENT&&(t?t>=e.getLength()&&this.setStartAfter(e):this.setStartBefore(e)),t=this.endOffset,(e=this.endContainer).type!=CKEDITOR.NODE_ELEMENT&&(t?t>=e.getLength()&&this.setEndAfter(e):this.setEndBefore(e))},optimizeBookmark:function(){var e=this.startContainer,t=this.endContainer;e.is&&e.is("span")&&e.data("cke-bookmark")&&this.setStartAt(e,CKEDITOR.POSITION_BEFORE_START),t&&t.is&&t.is("span")&&t.data("cke-bookmark")&&this.setEndAt(t,CKEDITOR.POSITION_AFTER_END)},trim:function(e,t){var n=this.startContainer,o=this.startOffset,i=this.collapsed;if((!e||i)&&n&&n.type==CKEDITOR.NODE_TEXT){if(o)if(o>=n.getLength())o=n.getIndex()+1,n=n.getParent();else{var r=n.split(o);o=n.getIndex()+1,n=n.getParent(),this.startContainer.equals(this.endContainer)?this.setEnd(r,this.endOffset-this.startOffset):n.equals(this.endContainer)&&(this.endOffset+=1)}else o=n.getIndex(),n=n.getParent();if(this.setStart(n,o),i)return void this.collapse(!0)}n=this.endContainer,o=this.endOffset,t||i||!n||n.type!=CKEDITOR.NODE_TEXT||(o?(o>=n.getLength()||n.split(o),o=n.getIndex()+1):o=n.getIndex(),n=n.getParent(),this.setEnd(n,o))},enlarge:function(e,t){function n(e){return e&&e.type==CKEDITOR.NODE_ELEMENT&&e.hasAttribute("contenteditable")?null:e}var o=new RegExp(/[^\s\ufeff]/);switch(e){case CKEDITOR.ENLARGE_INLINE:var i=1;case CKEDITOR.ENLARGE_ELEMENT:var r=function(e,t){var n,i;for((n=new CKEDITOR.dom.range(g)).setStart(e,t),n.setEndAt(g,CKEDITOR.POSITION_BEFORE_END),(n=new CKEDITOR.dom.walker(n)).guard=function(e){return!(e.type==CKEDITOR.NODE_ELEMENT&&e.isBlockBoundary())};i=n.next();){if(i.type!=CKEDITOR.NODE_TEXT)return!1;if(f=i!=e?i.getText():i.substring(t),o.test(f))return!1}return!0};if(this.collapsed)break;var a,s,l,u,c,d,f,h=this.getCommonAncestor(),g=this.root,m=!1,p=this.startOffset;for((d=this.startContainer).type==CKEDITOR.NODE_TEXT?(p&&(m=!!(d=!CKEDITOR.tools.trim(d.substring(0,p)).length&&d)),d&&((u=d.getPrevious())||(l=d.getParent()))):(p&&(u=d.getChild(p-1)||d.getLast()),u||(l=d)),l=n(l);l||u;){if(l&&!u){if(!c&&l.equals(h)&&(c=!0),i?l.isBlockBoundary():!g.contains(l))break;m&&"inline"==l.getComputedStyle("display")||(m=!1,c?a=l:this.setStartBefore(l)),u=l.getPrevious()}for(;u;)if(d=!1,u.type==CKEDITOR.NODE_COMMENT)u=u.getPrevious();else{if(u.type==CKEDITOR.NODE_TEXT)f=u.getText(),o.test(f)&&(u=null),d=/[\s\ufeff]$/.test(f);else if((u.$.offsetWidth>(CKEDITOR.env.webkit?1:0)||t&&u.is("br"))&&!u.data("cke-bookmark"))if(m&&CKEDITOR.dtd.$removeEmpty[u.getName()]){if(f=u.getText(),o.test(f))u=null;else{p=u.$.getElementsByTagName("*");for(var v,y=0;v=p[y++];)if(!CKEDITOR.dtd.$removeEmpty[v.nodeName.toLowerCase()]){u=null;break}}u&&(d=!!f.length)}else u=null;if(d&&(m?c?a=l:l&&this.setStartBefore(l):m=!0),u){if(d=u.getPrevious(),!l&&!d){l=u,u=null;break}u=d}else l=null}l&&(l=n(l.getParent()))}for(p=this.endOffset,l=u=null,c=m=!1,(d=this.endContainer).type==CKEDITOR.NODE_TEXT?CKEDITOR.tools.trim(d.substring(p)).length?m=!0:(m=!d.getLength(),p==d.getLength()?(u=d.getNext())||(l=d.getParent()):r(d,p)&&(l=d.getParent())):(u=d.getChild(p))||(l=d);l||u;){if(l&&!u){if(!c&&l.equals(h)&&(c=!0),i?l.isBlockBoundary():!g.contains(l))break;m&&"inline"==l.getComputedStyle("display")||(m=!1,c?s=l:l&&this.setEndAfter(l)),u=l.getNext()}for(;u;){if(d=!1,u.type==CKEDITOR.NODE_TEXT)f=u.getText(),r(u,0)||(u=null),d=/^[\s\ufeff]/.test(f);else if(u.type==CKEDITOR.NODE_ELEMENT){if((0<u.$.offsetWidth||t&&u.is("br"))&&!u.data("cke-bookmark"))if(m&&CKEDITOR.dtd.$removeEmpty[u.getName()]){if(f=u.getText(),o.test(f))u=null;else for(p=u.$.getElementsByTagName("*"),y=0;v=p[y++];)if(!CKEDITOR.dtd.$removeEmpty[v.nodeName.toLowerCase()]){u=null;break}u&&(d=!!f.length)}else u=null}else d=1;if(d&&m&&(c?s=l:this.setEndAfter(l)),u){if(d=u.getNext(),!l&&!d){l=u,u=null;break}u=d}else l=null}l&&(l=n(l.getParent()))}a&&s&&(h=a.contains(s)?s:a,this.setStartBefore(h),this.setEndAfter(h));break;case CKEDITOR.ENLARGE_BLOCK_CONTENTS:case CKEDITOR.ENLARGE_LIST_ITEM_CONTENTS:(l=new CKEDITOR.dom.range(this.root)).setStartAt(g=this.root,CKEDITOR.POSITION_AFTER_START),l.setEnd(this.startContainer,this.startOffset),l=new CKEDITOR.dom.walker(l);var b,C,T=CKEDITOR.dom.walker.blockBoundary(e==CKEDITOR.ENLARGE_LIST_ITEM_CONTENTS?{br:1}:null),x=null,E=function(e){if(e.type==CKEDITOR.NODE_ELEMENT&&"false"==e.getAttribute("contenteditable"))if(x){if(x.equals(e))return void(x=null)}else x=e;else if(x)return;var t=T(e);return t||(b=e),t};if(i=function(e){var t=E(e);return!t&&e.is&&e.is("br")&&(C=e),t},l.guard=E,l=l.lastBackward(),this.setStartAt(b=b||g,!b.is("br")&&(!l&&this.checkStartOfBlock()||l&&b.contains(l))?CKEDITOR.POSITION_AFTER_START:CKEDITOR.POSITION_AFTER_END),e==CKEDITOR.ENLARGE_LIST_ITEM_CONTENTS){l=this.clone(),l=new CKEDITOR.dom.walker(l);var _=CKEDITOR.dom.walker.whitespaces(),I=CKEDITOR.dom.walker.bookmark();if(l.evaluator=function(e){return!_(e)&&!I(e)},(l=l.previous())&&l.type==CKEDITOR.NODE_ELEMENT&&l.is("br"))break}(l=this.clone()).collapse(),l.setEndAt(g,CKEDITOR.POSITION_BEFORE_END),(l=new CKEDITOR.dom.walker(l)).guard=e==CKEDITOR.ENLARGE_LIST_ITEM_CONTENTS?i:E,b=x=C=null,l=l.lastForward(),this.setEndAt(b=b||g,!l&&this.checkEndOfBlock()||l&&b.contains(l)?CKEDITOR.POSITION_BEFORE_END:CKEDITOR.POSITION_BEFORE_START),C&&this.setEndAfter(C)}},shrink:function(e,t,n){var o="boolean"==typeof n?n:!n||"boolean"!=typeof n.shrinkOnBlockBoundary||n.shrinkOnBlockBoundary,i=n&&n.skipBogus;if(!this.collapsed){e=e||CKEDITOR.SHRINK_TEXT;var r=this.clone(),a=this.startContainer,s=this.endContainer,l=this.startOffset,u=this.endOffset,c=n=1;a&&a.type==CKEDITOR.NODE_TEXT&&(l?l>=a.getLength()?r.setStartAfter(a):(r.setStartBefore(a),n=0):r.setStartBefore(a)),s&&s.type==CKEDITOR.NODE_TEXT&&(u?u>=s.getLength()?r.setEndAfter(s):(r.setEndAfter(s),c=0):r.setEndBefore(s)),r=new CKEDITOR.dom.walker(r);var d,f=CKEDITOR.dom.walker.bookmark(),h=CKEDITOR.dom.walker.bogus();return r.evaluator=function(t){return t.type==(e==CKEDITOR.SHRINK_ELEMENT?CKEDITOR.NODE_ELEMENT:CKEDITOR.NODE_TEXT)},r.guard=function(t,n){return!!(i&&h(t)||f(t))||!(e==CKEDITOR.SHRINK_ELEMENT&&t.type==CKEDITOR.NODE_TEXT||n&&t.equals(d)||!1===o&&t.type==CKEDITOR.NODE_ELEMENT&&t.isBlockBoundary()||t.type==CKEDITOR.NODE_ELEMENT&&t.hasAttribute("contenteditable"))&&(n||t.type!=CKEDITOR.NODE_ELEMENT||(d=t),!0)},n&&(a=r[e==CKEDITOR.SHRINK_ELEMENT?"lastForward":"next"]())&&this.setStartAt(a,t?CKEDITOR.POSITION_AFTER_START:CKEDITOR.POSITION_BEFORE_START),c&&(r.reset(),(r=r[e==CKEDITOR.SHRINK_ELEMENT?"lastBackward":"previous"]())&&this.setEndAt(r,t?CKEDITOR.POSITION_BEFORE_END:CKEDITOR.POSITION_AFTER_END)),!(!n&&!c)}},insertNode:function(e){this.optimizeBookmark(),this.trim(!1,!0);var t=this.startContainer,n=t.getChild(this.startOffset);n?e.insertBefore(n):t.append(e),e.getParent()&&e.getParent().equals(this.endContainer)&&this.endOffset++,this.setStartBefore(e)},moveToPosition:function(e,t){this.setStartAt(e,t),this.collapse(!0)},moveToRange:function(e){this.setStart(e.startContainer,e.startOffset),this.setEnd(e.endContainer,e.endOffset)},selectNodeContents:function(e){this.setStart(e,0),this.setEnd(e,e.type==CKEDITOR.NODE_TEXT?e.getLength():e.getChildCount())},setStart:function(t,n){t.type==CKEDITOR.NODE_ELEMENT&&CKEDITOR.dtd.$empty[t.getName()]&&(n=t.getIndex(),t=t.getParent()),this._setStartContainer(t),this.startOffset=n,this.endContainer||(this._setEndContainer(t),this.endOffset=n),e(this)},setEnd:function(t,n){t.type==CKEDITOR.NODE_ELEMENT&&CKEDITOR.dtd.$empty[t.getName()]&&(n=t.getIndex()+1,t=t.getParent()),this._setEndContainer(t),this.endOffset=n,this.startContainer||(this._setStartContainer(t),this.startOffset=n),e(this)},setStartAfter:function(e){this.setStart(e.getParent(),e.getIndex()+1)},setStartBefore:function(e){this.setStart(e.getParent(),e.getIndex())},setEndAfter:function(e){this.setEnd(e.getParent(),e.getIndex()+1)},setEndBefore:function(e){this.setEnd(e.getParent(),e.getIndex())},setStartAt:function(t,n){switch(n){case CKEDITOR.POSITION_AFTER_START:this.setStart(t,0);break;case CKEDITOR.POSITION_BEFORE_END:t.type==CKEDITOR.NODE_TEXT?this.setStart(t,t.getLength()):this.setStart(t,t.getChildCount());break;case CKEDITOR.POSITION_BEFORE_START:this.setStartBefore(t);break;case CKEDITOR.POSITION_AFTER_END:this.setStartAfter(t)}e(this)},setEndAt:function(t,n){switch(n){case CKEDITOR.POSITION_AFTER_START:this.setEnd(t,0);break;case CKEDITOR.POSITION_BEFORE_END:t.type==CKEDITOR.NODE_TEXT?this.setEnd(t,t.getLength()):this.setEnd(t,t.getChildCount());break;case CKEDITOR.POSITION_BEFORE_START:this.setEndBefore(t);break;case CKEDITOR.POSITION_AFTER_END:this.setEndAfter(t)}e(this)},fixBlock:function(e,t){var n=this.createBookmark(),o=this.document.createElement(t);this.collapse(e),this.enlarge(CKEDITOR.ENLARGE_BLOCK_CONTENTS),this.extractContents().appendTo(o),o.trim(),this.insertNode(o);var i=o.getBogus();return i&&i.remove(),o.appendBogus(),this.moveToBookmark(n),o},splitBlock:function(e,t){var n=new CKEDITOR.dom.elementPath(this.startContainer,this.root),o=new CKEDITOR.dom.elementPath(this.endContainer,this.root),i=n.block,r=o.block,a=null;return n.blockLimit.equals(o.blockLimit)?("br"!=e&&(i||(i=this.fixBlock(!0,e),r=new CKEDITOR.dom.elementPath(this.endContainer,this.root).block),r||(r=this.fixBlock(!1,e))),n=i&&this.checkStartOfBlock(),o=r&&this.checkEndOfBlock(),this.deleteContents(),i&&i.equals(r)&&(o?(a=new CKEDITOR.dom.elementPath(this.startContainer,this.root),this.moveToPosition(r,CKEDITOR.POSITION_AFTER_END),r=null):n?(a=new CKEDITOR.dom.elementPath(this.startContainer,this.root),this.moveToPosition(i,CKEDITOR.POSITION_BEFORE_START),i=null):(r=this.splitElement(i,t||!1),i.is("ul","ol")||i.appendBogus())),{previousBlock:i,nextBlock:r,wasStartOfBlock:n,wasEndOfBlock:o,elementPath:a}):null},splitElement:function(e,t){if(!this.collapsed)return null;this.setEndAt(e,CKEDITOR.POSITION_BEFORE_END);var n=this.extractContents(!1,t||!1),o=e.clone(!1,t||!1);return n.appendTo(o),o.insertAfter(e),this.moveToPosition(e,CKEDITOR.POSITION_AFTER_END),o},removeEmptyBlocksAtEnd:function(){function e(e){return function(o){return!(t(o)||n(o)||o.type==CKEDITOR.NODE_ELEMENT&&o.isEmptyInlineRemoveable()||e.is("table")&&o.is("caption"))}}var t=CKEDITOR.dom.walker.whitespaces(),n=CKEDITOR.dom.walker.bookmark(!1);return function(t){for(var n,o=this.createBookmark(),i=this[t?"endPath":"startPath"](),r=i.block||i.blockLimit;r&&!r.equals(i.root)&&!r.getFirst(e(r));)n=r.getParent(),this[t?"setEndAt":"setStartAt"](r,CKEDITOR.POSITION_AFTER_END),r.remove(1),r=n;this.moveToBookmark(o)}}(),startPath:function(){return new CKEDITOR.dom.elementPath(this.startContainer,this.root)},endPath:function(){return new CKEDITOR.dom.elementPath(this.endContainer,this.root)},checkBoundaryOfElement:function(e,t){var n=t==CKEDITOR.START,o=this.clone();return o.collapse(n),o[n?"setStartAt":"setEndAt"](e,n?CKEDITOR.POSITION_AFTER_START:CKEDITOR.POSITION_BEFORE_END),(o=new CKEDITOR.dom.walker(o)).evaluator=function(e){var t=CKEDITOR.dom.walker.whitespaces(),n=CKEDITOR.dom.walker.bookmark(1);return function(o){return!(!n(o)&&!t(o))||!e&&r(o)||o.type==CKEDITOR.NODE_ELEMENT&&o.is(CKEDITOR.dtd.$removeEmpty)}}(n),o[n?"checkBackward":"checkForward"]()},checkStartOfBlock:function(){var e=this.startContainer,t=this.startOffset;return CKEDITOR.env.ie&&t&&e.type==CKEDITOR.NODE_TEXT&&(e=CKEDITOR.tools.ltrim(e.substring(0,t)),a.test(e)&&this.trim(0,1)),this.trim(),e=new CKEDITOR.dom.elementPath(this.startContainer,this.root),(t=this.clone()).collapse(!0),t.setStartAt(e.block||e.blockLimit,CKEDITOR.POSITION_AFTER_START),(e=new CKEDITOR.dom.walker(t)).evaluator=n(),e.checkBackward()},checkEndOfBlock:function(){var e=this.endContainer,t=this.endOffset;return CKEDITOR.env.ie&&e.type==CKEDITOR.NODE_TEXT&&(e=CKEDITOR.tools.rtrim(e.substring(t)),a.test(e)&&this.trim(1,0)),this.trim(),e=new CKEDITOR.dom.elementPath(this.endContainer,this.root),(t=this.clone()).collapse(!1),t.setEndAt(e.block||e.blockLimit,CKEDITOR.POSITION_BEFORE_END),(e=new CKEDITOR.dom.walker(t)).evaluator=n(),e.checkForward()},getPreviousNode:function(e,t,n){var o=this.clone();return o.collapse(1),o.setStartAt(n||this.root,CKEDITOR.POSITION_AFTER_START),(n=new CKEDITOR.dom.walker(o)).evaluator=e,n.guard=t,n.previous()},getNextNode:function(e,t,n){var o=this.clone();return o.collapse(),o.setEndAt(n||this.root,CKEDITOR.POSITION_BEFORE_END),(n=new CKEDITOR.dom.walker(o)).evaluator=e,n.guard=t,n.next()},checkReadOnly:function(){function e(e,t){for(;e;){if(e.type==CKEDITOR.NODE_ELEMENT){if("false"==e.getAttribute("contentEditable")&&!e.data("cke-editable"))return 0;if(e.is("html")||"true"==e.getAttribute("contentEditable")&&(e.contains(t)||e.equals(t)))break}e=e.getParent()}return 1}return function(){var t=this.startContainer,n=this.endContainer;return!(e(t,n)&&e(n,t))}}(),moveToElementEditablePosition:function(e,t){if(e.type==CKEDITOR.NODE_ELEMENT&&!e.isEditable(!1))return this.moveToPosition(e,t?CKEDITOR.POSITION_AFTER_END:CKEDITOR.POSITION_BEFORE_START),!0;for(var n=0;e;){if(e.type==CKEDITOR.NODE_TEXT){t&&this.endContainer&&this.checkEndOfBlock()&&a.test(e.getText())?this.moveToPosition(e,CKEDITOR.POSITION_BEFORE_START):this.moveToPosition(e,t?CKEDITOR.POSITION_AFTER_END:CKEDITOR.POSITION_BEFORE_START),n=1;break}if(e.type==CKEDITOR.NODE_ELEMENT)if(e.isEditable())this.moveToPosition(e,t?CKEDITOR.POSITION_BEFORE_END:CKEDITOR.POSITION_AFTER_START),n=1;else if(t&&e.is("br")&&this.endContainer&&this.checkEndOfBlock())this.moveToPosition(e,CKEDITOR.POSITION_BEFORE_START);else if("false"==e.getAttribute("contenteditable")&&e.is(CKEDITOR.dtd.$block))return this.setStartBefore(e),this.setEndAfter(e),!0;var o=e,i=n,r=void 0;o.type==CKEDITOR.NODE_ELEMENT&&o.isEditable(!1)&&(r=o[t?"getLast":"getFirst"](l)),i||r||(r=o[t?"getPrevious":"getNext"](l)),e=r}return!!n},moveToClosestEditablePosition:function(e,t){var n,o,i,r=0,a=[CKEDITOR.POSITION_AFTER_END,CKEDITOR.POSITION_BEFORE_START];return e?(n=new CKEDITOR.dom.range(this.root)).moveToPosition(e,a[t?0:1]):n=this.clone(),e&&!e.is(CKEDITOR.dtd.$block)?r=1:(o=n[t?"getNextEditableNode":"getPreviousEditableNode"]())&&(r=1,(i=o.type==CKEDITOR.NODE_ELEMENT)&&o.is(CKEDITOR.dtd.$block)&&"false"==o.getAttribute("contenteditable")?(n.setStartAt(o,CKEDITOR.POSITION_BEFORE_START),n.setEndAt(o,CKEDITOR.POSITION_AFTER_END)):!CKEDITOR.env.needsBrFiller&&i&&o.is(CKEDITOR.dom.walker.validEmptyBlockContainers)?(n.setEnd(o,0),n.collapse()):n.moveToPosition(o,a[t?1:0])),r&&this.moveToRange(n),!!r},moveToElementEditStart:function(e){return this.moveToElementEditablePosition(e)},moveToElementEditEnd:function(e){return this.moveToElementEditablePosition(e,!0)},getEnclosedNode:function(){if((e=this.clone()).optimize(),e.startContainer.type!=CKEDITOR.NODE_ELEMENT||e.endContainer.type!=CKEDITOR.NODE_ELEMENT)return null;var e=new CKEDITOR.dom.walker(e),t=CKEDITOR.dom.walker.bookmark(!1,!0),n=CKEDITOR.dom.walker.whitespaces(!0);e.evaluator=function(e){return n(e)&&t(e)};var o=e.next();return e.reset(),o&&o.equals(e.previous())?o:null},getTouchedStartNode:function(){var e=this.startContainer;return this.collapsed||e.type!=CKEDITOR.NODE_ELEMENT?e:e.getChild(this.startOffset)||e},getTouchedEndNode:function(){var e=this.endContainer;return this.collapsed||e.type!=CKEDITOR.NODE_ELEMENT?e:e.getChild(this.endOffset-1)||e},getNextEditableNode:o(),getPreviousEditableNode:o(1),_getTableElement:function(e){e=e||{td:1,th:1,tr:1,tbody:1,thead:1,tfoot:1,table:1};var t=this.getTouchedStartNode(),n=this.getTouchedEndNode(),o=t.getAscendant("table",!0);return n=n.getAscendant("table",!0),o&&!this.root.contains(o)?null:this.getEnclosedNode()?this.getEnclosedNode().getAscendant(e,!0):o&&n&&(o.equals(n)||o.contains(n)||n.contains(o))?t.getAscendant(e,!0):null},scrollIntoView:function(){var e,t,n,o=new CKEDITOR.dom.element.createFromHtml("<span>&nbsp;</span>",this.document),i=this.clone();i.optimize(),(n=i.startContainer.type==CKEDITOR.NODE_TEXT)?(t=i.startContainer.getText(),e=i.startContainer.split(i.startOffset),o.insertAfter(i.startContainer)):i.insertNode(o),o.scrollIntoView(),n&&(i.startContainer.setText(t),e.remove()),o.remove()},getClientRects:function(){function e(e,t,o){var i;return t.collapsed?o.startContainer instanceof CKEDITOR.dom.element?(e=o.checkStartOfBlock(),i=new CKEDITOR.dom.text("​"),e?o.startContainer.append(i,!0):0===o.startOffset?i.insertBefore(o.startContainer.getFirst()):(o=o.startContainer.getChildren().getItem(o.startOffset-1),i.insertAfter(o)),t.setStart(i.$,0),t.setEnd(i.$,0),e=t.getClientRects(),i.remove()):o.startContainer instanceof CKEDITOR.dom.text&&(""===o.startContainer.getText()?(o.startContainer.setText("​"),e=t.getClientRects(),o.startContainer.setText("")):e=[n(o.createBookmark())]):e=[n(o.createBookmark())],e}function t(e,t,n){return e=CKEDITOR.tools.extend({},e),t&&(e=CKEDITOR.tools.getAbsoluteRectPosition(n.document.getWindow(),e)),!e.width&&(e.width=e.right-e.left),!e.height&&(e.height=e.bottom-e.top),e}function n(e){var t,n=e.startNode;return e=e.endNode,n.setText("​"),n.removeStyle("display"),e?(e.setText("​"),e.removeStyle("display"),t=[n.getClientRect(),e.getClientRect()],e.remove()):t=[n.getClientRect(),n.getClientRect()],n.remove(),{right:Math.max(t[0].right,t[1].right),bottom:Math.max(t[0].bottom,t[1].bottom),left:Math.min(t[0].left,t[1].left),top:Math.min(t[0].top,t[1].top),width:Math.abs(t[0].left-t[1].left),height:Math.max(t[0].bottom,t[1].bottom)-Math.min(t[0].top,t[1].top)}}return void 0!==this.document.getSelection?function(n){var o,i=this.root.getDocument().$.createRange();return i.setStart(this.startContainer.$,this.startOffset),i.setEnd(this.endContainer.$,this.endOffset),(o=function(e,t){var n,o,i,r=CKEDITOR.tools.array.map(e,(function(e){return e})),a=new CKEDITOR.dom.range(t.root);if(t.startContainer instanceof CKEDITOR.dom.element&&(o=0===t.startOffset&&t.startContainer.hasAttribute("data-widget")),t.endContainer instanceof CKEDITOR.dom.element&&(i=(i=t.endOffset===(t.endContainer.getChildCount?t.endContainer.getChildCount():t.endContainer.length))&&t.endContainer.hasAttribute("data-widget")),o&&a.setStart(t.startContainer.getParent(),t.startContainer.getIndex()),i&&a.setEnd(t.endContainer.getParent(),t.endContainer.getIndex()+1),(o||i)&&(t=a),a=t.cloneContents().find("[data-cke-widget-id]").toArray(),a=CKEDITOR.tools.array.map(a,(function(e){var n=t.root.editor;return e=e.getAttribute("data-cke-widget-id"),n.widgets.instances[e].element})))return a=CKEDITOR.tools.array.map(a,(function(e){var t;return t=e.getParent().hasClass("cke_widget_wrapper")?e.getParent():e,(n=this.root.getDocument().$.createRange()).setStart(t.getParent().$,t.getIndex()),n.setEnd(t.getParent().$,t.getIndex()+1),(t=n.getClientRects()).widgetRect=e.getClientRect(),t}),t),CKEDITOR.tools.array.forEach(a,(function(e){var t;!function n(o){CKEDITOR.tools.array.forEach(r,(function(n,i){var a=CKEDITOR.tools.objectCompare(e[o],n);a||(a=CKEDITOR.tools.objectCompare(e.widgetRect,n)),a&&(Array.prototype.splice.call(r,i,e.length-o,e.widgetRect),t=!0)})),t||(o<r.length-1?n(o+1):r.push(e.widgetRect))}(0)})),r}(o=i.getClientRects(),this)).length||(o=e(o,i,this)),CKEDITOR.tools.array.map(o,(function(e){return t(e,n,this)}),this)}:function(e){return[t(n(this.createBookmark()),e,this)]}}(),_setStartContainer:function(e){this.startContainer=e},_setEndContainer:function(e){this.endContainer=e},_find:function(e,t){var n,o,i,r,a=this.getCommonAncestor(),s=this.getBoundaryNodes(),l=[];if(a&&a.find)for(o=a.find(e),n=0;n<o.count();n++)a=o.getItem(n),(t||!a.isReadOnly())&&(i=a.getPosition(s.startNode)&CKEDITOR.POSITION_FOLLOWING||s.startNode.equals(a),r=a.getPosition(s.endNode)&CKEDITOR.POSITION_PRECEDING+CKEDITOR.POSITION_IS_CONTAINED||s.endNode.equals(a),i&&r&&l.push(a));return l}},CKEDITOR.dom.range.mergeRanges=function(e){return CKEDITOR.tools.array.reduce(e,(function(e,t){var n=e[e.length-1],o=!1;if((t=t.clone()).enlarge(CKEDITOR.ENLARGE_ELEMENT),n){var i=new CKEDITOR.dom.range(t.root),r=(o=new CKEDITOR.dom.walker(i),CKEDITOR.dom.walker.whitespaces());for(i.setStart(n.endContainer,n.endOffset),i.setEnd(t.startContainer,t.startOffset),i=o.next();r(i)||t.endContainer.equals(i);)i=o.next();o=!i}return o?n.setEnd(t.endContainer,t.endOffset):e.push(t),e}),[])}}(),CKEDITOR.POSITION_AFTER_START=1,CKEDITOR.POSITION_BEFORE_END=2,CKEDITOR.POSITION_BEFORE_START=3,CKEDITOR.POSITION_AFTER_END=4,CKEDITOR.ENLARGE_ELEMENT=1,CKEDITOR.ENLARGE_BLOCK_CONTENTS=2,CKEDITOR.ENLARGE_LIST_ITEM_CONTENTS=3,CKEDITOR.ENLARGE_INLINE=4,CKEDITOR.START=1,CKEDITOR.END=2,CKEDITOR.SHRINK_ELEMENT=1,CKEDITOR.SHRINK_TEXT=2,function(){function e(e){1>arguments.length||(this.range=e,this.forceBrBreak=0,this.enlargeBr=1,this.enforceRealBlocks=0,this._||(this._={}))}function t(e,n,o,i){e:{null==i&&(i=function(e){var t=[];return e.forEach((function(e){if("true"==e.getAttribute("contenteditable"))return t.push(e),!1}),CKEDITOR.NODE_ELEMENT,!0),t}(o));for(var r;r=i.shift();)if(r.getDtd().p){i={element:r,remaining:i};break e}i=null}return i?(r=CKEDITOR.filter.instances[i.element.data("cke-filter")])&&!r.check(n)?t(e,n,o,i.remaining):((n=new CKEDITOR.dom.range(i.element)).selectNodeContents(i.element),(n=n.createIterator()).enlargeBr=e.enlargeBr,n.enforceRealBlocks=e.enforceRealBlocks,n.activeFilter=n.filter=r,e._.nestedEditable={element:i.element,container:o,remaining:i.remaining,iterator:n},1):0}function n(e,t,n){return!!t&&((e=e.clone()).collapse(!n),e.checkBoundaryOfElement(t,n?CKEDITOR.START:CKEDITOR.END))}var o=/^[\r\n\t ]+$/,i=CKEDITOR.dom.walker.bookmark(!1,!0),r=CKEDITOR.dom.walker.whitespaces(!0),a=function(e){return i(e)&&r(e)},s={dd:1,dt:1,li:1};e.prototype={getNextParagraph:function(e){var r,l,u,c,d;if(e=e||"p",this._.nestedEditable){if(r=this._.nestedEditable.iterator.getNextParagraph(e))return this.activeFilter=this._.nestedEditable.iterator.activeFilter,r;if(this.activeFilter=this.filter,t(this,e,this._.nestedEditable.container,this._.nestedEditable.remaining))return this.activeFilter=this._.nestedEditable.iterator.activeFilter,this._.nestedEditable.iterator.getNextParagraph(e);this._.nestedEditable=null}if(!this.range.root.getDtd()[e])return null;if(!this._.started){var f=this.range.clone();l=f.startPath();var h=f.endPath(),g=!f.collapsed&&n(f,l.block),m=!f.collapsed&&n(f,h.block,1);f.shrink(CKEDITOR.SHRINK_ELEMENT,!0),g&&f.setStartAt(l.block,CKEDITOR.POSITION_BEFORE_END),m&&f.setEndAt(h.block,CKEDITOR.POSITION_AFTER_START),l=f.endContainer.hasAscendant("pre",!0)||f.startContainer.hasAscendant("pre",!0),f.enlarge(this.forceBrBreak&&!l||!this.enlargeBr?CKEDITOR.ENLARGE_LIST_ITEM_CONTENTS:CKEDITOR.ENLARGE_BLOCK_CONTENTS),f.collapsed||(l=new CKEDITOR.dom.walker(f.clone()),h=CKEDITOR.dom.walker.bookmark(!0,!0),l.evaluator=h,this._.nextNode=l.next(),(l=new CKEDITOR.dom.walker(f.clone())).evaluator=h,l=l.previous(),this._.lastNode=l.getNextSourceNode(!0,null,f.root),this._.lastNode&&this._.lastNode.type==CKEDITOR.NODE_TEXT&&!CKEDITOR.tools.trim(this._.lastNode.getText())&&this._.lastNode.getParent().isBlockBoundary()&&((h=this.range.clone()).moveToPosition(this._.lastNode,CKEDITOR.POSITION_AFTER_END),h.checkEndOfBlock()&&(h=new CKEDITOR.dom.elementPath(h.endContainer,h.root),this._.lastNode=(h.block||h.blockLimit).getNextSourceNode(!0))),this._.lastNode&&f.root.contains(this._.lastNode)||(this._.lastNode=this._.docEndMarker=f.document.createText(""),this._.lastNode.insertAfter(l)),f=null),this._.started=1,l=f}for(h=this._.nextNode,f=this._.lastNode,this._.nextNode=null;h;){g=0,m=h.hasAscendant("pre");var p=h.type!=CKEDITOR.NODE_ELEMENT,v=0;if(p)h.type==CKEDITOR.NODE_TEXT&&o.test(h.getText())&&(p=0);else{var y=h.getName();if(CKEDITOR.dtd.$block[y]&&"false"==h.getAttribute("contenteditable")){t(this,e,r=h);break}if(h.isBlockBoundary(this.forceBrBreak&&!m&&{br:1})){if("br"==y)p=1;else if(!l&&!h.getChildCount()&&"hr"!=y){r=h,u=h.equals(f);break}l&&(l.setEndAt(h,CKEDITOR.POSITION_BEFORE_START),"br"!=y&&(this._.nextNode=h)),g=1}else{if(h.getFirst()){l||(l=this.range.clone()).setStartAt(h,CKEDITOR.POSITION_BEFORE_START),h=h.getFirst();continue}p=1}}if(p&&!l&&(l=this.range.clone()).setStartAt(h,CKEDITOR.POSITION_BEFORE_START),u=(!g||p)&&h.equals(f),l&&!g)for(;!h.getNext(a)&&!u;){if((y=h.getParent()).isBlockBoundary(this.forceBrBreak&&!m&&{br:1})){g=1,p=0,u||y.equals(f),l.setEndAt(y,CKEDITOR.POSITION_BEFORE_END);break}p=1,u=(h=y).equals(f),v=1}if(p&&l.setEndAt(h,CKEDITOR.POSITION_AFTER_END),(u=!(h=this._getNextSourceNode(h,v,f)))||g&&l)break}if(!r){if(!l)return this._.docEndMarker&&this._.docEndMarker.remove(),this._.nextNode=null;h=(r=new CKEDITOR.dom.elementPath(l.startContainer,l.root)).blockLimit,g={div:1,th:1,td:1},!(r=r.block)&&h&&!this.enforceRealBlocks&&g[h.getName()]&&l.checkStartOfBlock()&&l.checkEndOfBlock()&&!h.equals(l.root)?r=h:!r||this.enforceRealBlocks&&r.is(s)?(r=this.range.document.createElement(e),l.extractContents().appendTo(r),r.trim(),l.insertNode(r),c=d=!0):"li"!=r.getName()?l.checkStartOfBlock()&&l.checkEndOfBlock()||(r=r.clone(!1),l.extractContents().appendTo(r),r.trim(),c=!(d=l.splitBlock()).wasStartOfBlock,d=!d.wasEndOfBlock,l.insertNode(r)):u||(this._.nextNode=r.equals(f)?null:this._getNextSourceNode(l.getBoundaryNodes().endNode,1,f))}return c&&(c=r.getPrevious())&&c.type==CKEDITOR.NODE_ELEMENT&&("br"==c.getName()?c.remove():c.getLast()&&"br"==c.getLast().$.nodeName.toLowerCase()&&c.getLast().remove()),d&&(c=r.getLast())&&c.type==CKEDITOR.NODE_ELEMENT&&"br"==c.getName()&&(!CKEDITOR.env.needsBrFiller||c.getPrevious(i)||c.getNext(i))&&c.remove(),this._.nextNode||(this._.nextNode=u||r.equals(f)||!f?null:this._getNextSourceNode(r,1,f)),r},_getNextSourceNode:function(e,t,n){function o(e){return!(e.equals(n)||e.equals(r))}var r=this.range.root;for(e=e.getNextSourceNode(t,null,o);!i(e);)e=e.getNextSourceNode(t,null,o);return e}},CKEDITOR.dom.range.prototype.createIterator=function(){return new e(this)}}(),CKEDITOR.command=function(e,t){var n;this.uiItems=[],this.exec=function(n){return!(this.state==CKEDITOR.TRISTATE_DISABLED||!this.checkAllowed())&&(this.editorFocus&&e.focus(),!1===this.fire("exec")||!1!==t.exec.call(this,e,n))},this.refresh=function(e,n){return!(this.readOnly||!e.readOnly)||(this.context&&!n.isContextFor(this.context)||!this.checkAllowed(!0)?(this.disable(),!0):(this.startDisabled||this.enable(),this.modes&&!this.modes[e.mode]&&this.disable(),!1===this.fire("refresh",{editor:e,path:n})||t.refresh&&!1!==t.refresh.apply(this,arguments)))},this.checkAllowed=function(t){return t||"boolean"!=typeof n?n=e.activeFilter.checkFeature(this):n},CKEDITOR.tools.extend(this,t,{modes:{wysiwyg:1},editorFocus:1,contextSensitive:!!t.context,state:CKEDITOR.TRISTATE_DISABLED}),CKEDITOR.event.call(this)},CKEDITOR.command.prototype={enable:function(){this.state==CKEDITOR.TRISTATE_DISABLED&&this.checkAllowed()&&this.setState(this.preserveState&&void 0!==this.previousState?this.previousState:CKEDITOR.TRISTATE_OFF)},disable:function(){this.setState(CKEDITOR.TRISTATE_DISABLED)},setState:function(e){return!(this.state==e||e!=CKEDITOR.TRISTATE_DISABLED&&!this.checkAllowed()||(this.previousState=this.state,this.state=e,this.fire("state"),0))},toggleState:function(){this.state==CKEDITOR.TRISTATE_OFF?this.setState(CKEDITOR.TRISTATE_ON):this.state==CKEDITOR.TRISTATE_ON&&this.setState(CKEDITOR.TRISTATE_OFF)}},CKEDITOR.event.implementOn(CKEDITOR.command.prototype),CKEDITOR.ENTER_P=1,CKEDITOR.ENTER_BR=2,CKEDITOR.ENTER_DIV=3,CKEDITOR.config={customConfig:"config.js",autoUpdateElement:!0,language:"",defaultLanguage:"en",contentsLangDirection:"",enterMode:CKEDITOR.ENTER_P,forceEnterMode:!1,shiftEnterMode:CKEDITOR.ENTER_BR,docType:"<!DOCTYPE html>",bodyId:"",bodyClass:"",fullPage:!1,height:200,contentsCss:CKEDITOR.getUrl("contents.css"),extraPlugins:"",removePlugins:"",protectedSource:[],tabIndex:0,width:"",baseFloatZIndex:1e4,blockedKeystrokes:[CKEDITOR.CTRL+66,CKEDITOR.CTRL+73,CKEDITOR.CTRL+85]},function(){function e(e,t,n,o,i){var r,s,l;for(r in e=[],t){s="boolean"==typeof(s=t[r])?{}:"function"==typeof s?{match:s}:I(s),"$"!=r.charAt(0)&&(s.elements=r),n&&(s.featureName=n.toLowerCase());var u=s;u.elements=a(u.elements,/\s+/)||null,u.propertiesOnly=u.propertiesOnly||!0===u.elements;var c=/\s*,\s*/,d=void 0;for(d in R){u[d]=a(u[d],c)||null;var f=u,h=S[d],g=a(u[S[d]],c),p=u[d],v=[],y=!0,b=void 0;for(b in g?y=!1:g={},p)"!"==b.charAt(0)&&(b=b.slice(1),v.push(b),g[b]=!0,y=!1);for(;b=v.pop();)p[b]=p["!"+b],delete p["!"+b];f[h]=!y&&g||null}u.match=u.match||null,o.push(s),e.push(s)}for(t=i.elements,i=i.generic,n=0,o=e.length;n<o;++n){for(c in s=!0===(r=I(e[n])).classes||!0===r.styles||!0===r.attributes,u=r,d=h=c=void 0,R)u[c]=m(u[c]);for(d in f=!0,S){for(p in g=[],p=void 0,h=u[c=S[d]])-1<p.indexOf("*")?g.push(new RegExp("^"+p.replace(/\*/g,".*")+"$")):g.push(p);(h=g).length&&(u[c]=h,f=!1)}if(u.nothingRequired=f,u.noProperties=!(u.attributes||u.classes||u.styles),!0===r.elements||null===r.elements)i[s?"unshift":"push"](r);else for(l in u=r.elements,delete r.elements,u)t[l]?t[l][s?"unshift":"push"](r):t[l]=[r]}}function t(e,t,o,i){if((!e.match||e.match(t))&&(i||function(e,t){if(e.nothingRequired)return!0;var n,o,i,r;if(i=e.requiredClasses)for(r=t.classes,n=0;n<i.length;++n)if("string"==typeof(o=i[n])){if(-1==CKEDITOR.tools.indexOf(r,o))return!1}else if(!CKEDITOR.tools.checkIfAnyArrayItemMatches(r,o))return!1;return s(t.styles,e.requiredStyles)&&s(t.attributes,e.requiredAttributes)}(e,t))&&(e.propertiesOnly||(o.valid=!0),o.allAttributes||(o.allAttributes=n(e.attributes,t.attributes,o.validAttributes)),o.allStyles||(o.allStyles=n(e.styles,t.styles,o.validStyles)),!o.allClasses)){if(t=t.classes,i=o.validClasses,e=e.classes)if(!0===e)e=!0;else{for(var r,a=0,l=t.length;a<l;++a)i[r=t[a]]||(i[r]=e(r));e=!1}else e=!1;o.allClasses=e}}function n(e,t,n){if(!e)return!1;if(!0===e)return!0;for(var o in t)n[o]||(n[o]=e(o));return!1}function o(e,t,n){if(!e.match||e.match(t)){if(e.noProperties)return!1;if(n.hadInvalidAttribute=i(e.attributes,t.attributes)||n.hadInvalidAttribute,n.hadInvalidStyle=i(e.styles,t.styles)||n.hadInvalidStyle,t=t.classes,e=e.classes){for(var o=!1,r=!0===e,a=t.length;a--;)(r||e(t[a]))&&(t.splice(a,1),o=!0);e=o}else e=!1;n.hadInvalidClass=e||n.hadInvalidClass}}function i(e,t){if(!e)return!1;var n,o=!1,i=!0===e;for(n in t)(i||e(n))&&(delete t[n],o=!0);return o}function r(e,t,n){return!(e.disabled||e.customConfig&&!n||!t||(e._.cachedChecks={},0))}function a(e,t){if(!e)return!1;if(!0===e)return e;if("string"==typeof e)return"*"==(e=D(e))||CKEDITOR.tools.convertArrayToObject(e.split(t));if(CKEDITOR.tools.isArray(e))return!!e.length&&CKEDITOR.tools.convertArrayToObject(e);var n,o={},i=0;for(n in e)o[n]=e[n],i++;return!!i&&o}function s(e,t){if(!t)return!0;for(var n,o=0;o<t.length;++o)if("string"==typeof(n=t[o])){if(!(n in e))return!1}else if(!CKEDITOR.tools.checkIfAnyObjectPropertyMatches(e,n))return!1;return!0}function l(e){if(!e)return{};e=e.split(/\s*,\s*/).sort();for(var t={};e.length;)t[e.shift()]="cke-test";return t}function u(e){var t,n,o,i,r={},a=1;for(e=D(e);t=e.match(k);)(n=t[2])?(o=c(n,"styles"),i=c(n,"attrs"),n=c(n,"classes")):o=i=n=null,r["$"+a++]={elements:t[1],classes:n,styles:o,attributes:i},e=e.slice(t[0].length);return r}function c(e,t){var n=e.match(A[t]);return n?D(n[1]):null}function d(e){var t=e.styleBackup=e.attributes.style,n=e.classBackup=e.attributes.class;e.styles||(e.styles=CKEDITOR.tools.parseCssText(t||"",1)),e.classes||(e.classes=n?n.split(/\s+/):[])}function f(e,n,i,r){var a,s=0;if(r.toHtml&&(n.name=n.name.replace(N,"$1")),r.doCallbacks&&e.elementCallbacks){e:{for(var l,u=0,c=(a=e.elementCallbacks).length;u<c;++u)if(l=a[u](n)){a=l;break e}a=void 0}if(a)return a}if(r.doTransform&&(a=e._.transformations[n.name])){for(d(n),u=0;u<a.length;++u)b(e,n,a[u]);h(n)}if(r.doFilter){e:{e=(c=e._).allowedRules.elements[u=n.name],a=c.allowedRules.generic,u=c.disallowedRules.elements[u],c=c.disallowedRules.generic,l=r.skipRequired;var f,m,p={valid:!1,validAttributes:{},validClasses:{},validStyles:{},allAttributes:!1,allClasses:!1,allStyles:!1,hadInvalidAttribute:!1,hadInvalidClass:!1,hadInvalidStyle:!1};if(e||a){if(d(n),u)for(f=0,m=u.length;f<m;++f)if(!1===o(u[f],n,p)){e=null;break e}if(c)for(f=0,m=c.length;f<m;++f)o(c[f],n,p);if(e)for(f=0,m=e.length;f<m;++f)t(e[f],n,p,l);if(a)for(f=0,m=a.length;f<m;++f)t(a[f],n,p,l);e=p}else e=null}if(!e||!e.valid)return i.push(n),1;m=e.validAttributes;var v=e.validStyles;a=e.validClasses;var y=n.styles;c=n.classes,l=n.classBackup;var C,T,x=n.styleBackup,E=[],_=(p=[],/^data-cke-/);if(f=!1,delete(u=n.attributes).style,delete u.class,delete n.classBackup,delete n.styleBackup,!e.allAttributes)for(C in u)m[C]||_.test(C)&&(C==(T=C.replace(/^data-cke-saved-/,""))||m[T])||(delete u[C],f=!0);if(!e.allStyles||e.hadInvalidStyle){for(C in y)e.allStyles||v[C]?E.push(C+":"+y[C]):f=!0;E.length&&(u.style=E.sort().join("; "))}else x&&(u.style=x);if(!e.allClasses||e.hadInvalidClass){for(C=0;C<c.length;++C)(e.allClasses||a[c[C]])&&p.push(c[C]);p.length&&(u.class=p.sort().join(" ")),l&&p.length<l.split(/\s+/).length&&(f=!0)}else l&&(u.class=l);if(f&&(s=1),!r.skipFinalValidation&&!g(n))return i.push(n),1}return r.toHtml&&(n.name=n.name.replace(M,"cke:$1")),s}function h(e){var t,n=e.attributes;delete n.style,delete n.class,(t=CKEDITOR.tools.writeCssText(e.styles,!0))&&(n.style=t),e.classes.length&&(n.class=e.classes.sort().join(" "))}function g(e){switch(e.name){case"a":if(!(e.children.length||e.attributes.name||e.attributes.id))return!1;break;case"img":if(!e.attributes.src)return!1}return!0}function m(e){if(!e)return!1;if(!0===e)return!0;var t=function(e){var t,n=[];for(t in e)-1<t.indexOf("*")&&n.push(t.replace(/\*/g,".*"));return n.length?new RegExp("^(?:"+n.join("|")+")$"):null}(e);return function(n){return n in e||t&&n.match(t)}}function p(){return new CKEDITOR.htmlParser.element("br")}function v(e){return e.type==CKEDITOR.NODE_ELEMENT&&("br"==e.name||_.$block[e.name])}function y(e,t,n){if(_.$empty[o=e.name]||!e.children.length)"hr"==o&&"br"==t?e.replaceWith(p()):(e.parent&&n.push({check:"it",el:e.parent}),e.remove());else if(_.$block[o]||"tr"==o)if("br"==t)e.previous&&!v(e.previous)&&(t=p()).insertBefore(e),e.next&&!v(e.next)&&(t=p()).insertAfter(e),e.replaceWithChildren();else{var o,i;e:{i=_[t];for(var r,a=0,s=(o=e.children).length;a<s;++a)if((r=o[a]).type==CKEDITOR.NODE_ELEMENT&&!i[r.name]){i=!1;break e}i=!0}if(i)e.name=t,e.attributes={},n.push({check:"parent-down",el:e});else{var l,u;for(a=(i=e.parent).type==CKEDITOR.NODE_DOCUMENT_FRAGMENT||"body"==i.name,s=o.length;0<s;)r=o[--s],a&&(r.type==CKEDITOR.NODE_TEXT||r.type==CKEDITOR.NODE_ELEMENT&&_.$inline[r.name])?(l||((l=new CKEDITOR.htmlParser.element(t)).insertAfter(e),n.push({check:"parent-down",el:l})),l.add(r,0)):(l=null,u=_[i.name]||_.span,r.insertAfter(e),i.type==CKEDITOR.NODE_DOCUMENT_FRAGMENT||r.type!=CKEDITOR.NODE_ELEMENT||u[r.name]||n.push({check:"el-up",el:r}));e.remove()}}else o in{style:1,script:1}?e.remove():(e.parent&&n.push({check:"it",el:e.parent}),e.replaceWithChildren())}function b(e,t,n){var o,i;for(o=0;o<n.length;++o)if(!((i=n[o]).check&&!e.check(i.check,!1)||i.left&&!i.left(t))){i.right(t,w);break}}function C(e,t){var n,o,i,r,a=t.getDefinition(),s=a.attributes,l=a.styles;if(e.name!=a.element)return!1;for(n in s)if("class"==n){for(a=s[n].split(/\s+/),i=e.classes.join("|");r=a.pop();)if(-1==i.indexOf(r))return!1}else if(e.attributes[n]!=s[n])return!1;for(o in l)if(e.styles[o]!=l[o])return!1;return!0}function T(e,t){var n,o;return"string"==typeof e?n=e:e instanceof CKEDITOR.style?o=e:(n=e[0],o=e[1]),[{element:n,left:o,right:function(e,n){n.transform(e,t)}}]}function x(e){return function(t){return C(t,e)}}function E(e){return function(t,n){n[e](t)}}var _=CKEDITOR.dtd,I=CKEDITOR.tools.copy,D=CKEDITOR.tools.trim,O=["","p","br","div"];CKEDITOR.FILTER_SKIP_TREE=2,CKEDITOR.filter=function(e,t){this.allowedContent=[],this.disallowedContent=[],this.elementCallbacks=null,this.disabled=!1,this.editor=null,this.id=CKEDITOR.tools.getNextNumber(),this._={allowedRules:{elements:{},generic:[]},disallowedRules:{elements:{},generic:[]},transformations:{},cachedTests:{},cachedChecks:{}},CKEDITOR.filter.instances[this.id]=this;var n=this.editor=e instanceof CKEDITOR.editor?e:null;if(n&&!t){this.customConfig=!0;var o=n.config.allowedContent;!0===o?this.disabled=!0:(o||(this.customConfig=!1),this.allow(o,"config",1),this.allow(n.config.extraAllowedContent,"extra",1),this.allow(O[n.enterMode]+" "+O[n.shiftEnterMode],"default",1),this.disallow(n.config.disallowedContent))}else this.customConfig=!1,this.allow(t||e,"default",1)},CKEDITOR.filter.instances={},CKEDITOR.filter.prototype={allow:function(t,n,o){if(!r(this,t,o))return!1;var i,a;if("string"==typeof t)t=u(t);else if(t instanceof CKEDITOR.style){if(t.toAllowedContentRules)return this.allow(t.toAllowedContentRules(this.editor),n,o);o=(i=t.getDefinition()).attributes,(t={})[i.element]=i={styles:i.styles,requiredStyles:i.styles&&CKEDITOR.tools.object.keys(i.styles)},o&&(o=I(o),i.classes=o.class?o.class.split(/\s+/):null,i.requiredClasses=i.classes,delete o.class,i.attributes=o,i.requiredAttributes=o&&CKEDITOR.tools.object.keys(o))}else if(CKEDITOR.tools.isArray(t)){for(i=0;i<t.length;++i)a=this.allow(t[i],n,o);return a}return e(this,t,n,this.allowedContent,this._.allowedRules),!0},applyTo:function(e,t,n,o){if(this.disabled)return!1;var i,r,a,s=this,l=[],u=this.editor&&this.editor.config.protectedSource,c=!1,d={doFilter:!n,doTransform:!0,doCallbacks:!0,toHtml:t};for(e.forEach((function(e){if(e.type==CKEDITOR.NODE_ELEMENT){if("off"==e.attributes["data-cke-filter"])return!1;if(!t||"span"!=e.name||!~CKEDITOR.tools.object.keys(e.attributes).join("|").indexOf("data-cke-"))if(1&(i=f(s,e,l,d)))c=!0;else if(2&i)return!1}else if(e.type==CKEDITOR.NODE_COMMENT&&e.value.match(/^\{cke_protected\}(?!\{C\})/)){var n;e:{var o,r,a,h=decodeURIComponent(e.value.replace(/^\{cke_protected\}/,""));if(n=[],u)for(r=0;r<u.length;++r)if((a=h.match(u[r]))&&a[0].length==h.length){n=!0;break e}1==(h=CKEDITOR.htmlParser.fragment.fromHtml(h)).children.length&&(o=h.children[0]).type==CKEDITOR.NODE_ELEMENT&&f(s,o,n,d),n=!n.length}n||l.push(e)}}),null,!0),l.length&&(c=!0),e=[],o=O[o||(this.editor?this.editor.enterMode:CKEDITOR.ENTER_P)];n=l.pop();)n.type==CKEDITOR.NODE_ELEMENT?y(n,o,e):n.remove();for(;r=e.pop();)if((n=r.el).parent)switch(a=_[n.parent.name]||_.span,r.check){case"it":_.$removeEmpty[n.name]&&!n.children.length?y(n,o,e):g(n)||y(n,o,e);break;case"el-up":n.parent.type==CKEDITOR.NODE_DOCUMENT_FRAGMENT||a[n.name]||y(n,o,e);break;case"parent-down":n.parent.type==CKEDITOR.NODE_DOCUMENT_FRAGMENT||a[n.name]||y(n.parent,o,e)}return c},checkFeature:function(e){return!(!this.disabled&&e)||(e.toFeature&&(e=e.toFeature(this.editor)),!e.requiredContent||this.check(e.requiredContent))},disable:function(){this.disabled=!0},disallow:function(t){return!!r(this,t,!0)&&("string"==typeof t&&(t=u(t)),e(this,t,null,this.disallowedContent,this._.disallowedRules),!0)},addContentForms:function(e){if(!this.disabled&&e){var t,n,o,i=[];for(t=0;t<e.length&&!o;++t)("string"==typeof(n=e[t])||n instanceof CKEDITOR.style)&&this.check(n)&&(o=n);if(o){for(t=0;t<e.length;++t)i.push(T(e[t],o));this.addTransformations(i)}}},addElementCallback:function(e){this.elementCallbacks||(this.elementCallbacks=[]),this.elementCallbacks.push(e)},addFeature:function(e){return!(!this.disabled&&e)||(e.toFeature&&(e=e.toFeature(this.editor)),this.allow(e.allowedContent,e.name),this.addTransformations(e.contentTransformations),this.addContentForms(e.contentForms),!e.requiredContent||!this.customConfig&&!this.disallowedContent.length||this.check(e.requiredContent))},addTransformations:function(e){var t,n;if(!this.disabled&&e){var o,i=this._.transformations;for(o=0;o<e.length;++o){t=e[o];var r=void 0,a=void 0,s=void 0,l=void 0,u=void 0,c=void 0;for(n=[],a=0;a<t.length;++a)"string"==typeof(s=t[a])?(l=(s=s.split(/\s*:\s*/))[0],u=null,c=s[1]):(l=s.check,u=s.left,c=s.right),r||(r=(r=s).element?r.element:l?l.match(/^([a-z0-9]+)/i)[0]:r.left.getDefinition().element),u instanceof CKEDITOR.style&&(u=x(u)),n.push({check:l==r?null:l,left:u,right:"string"==typeof c?E(c):c});i[t=r]||(i[t]=[]),i[t].push(n)}}},check:function(e,t,n){if(this.disabled)return!0;if(CKEDITOR.tools.isArray(e)){for(var o=e.length;o--;)if(this.check(e[o],t,n))return!0;return!1}var i,r;if("string"==typeof e){if((r=e+"<"+(!1===t?"0":"1")+(n?"1":"0")+">")in this._.cachedChecks)return this._.cachedChecks[r];var a=(i=u(e).$1).styles;o=i.classes,i.name=i.elements,i.classes=o=o?o.split(/\s*,\s*/):[],i.styles=l(a),i.attributes=l(i.attributes),i.children=[],o.length&&(i.attributes.class=o.join(" ")),a&&(i.attributes.style=CKEDITOR.tools.writeCssText(i.styles))}else o=(i=e.getDefinition()).attributes||{},(a=i.styles)&&!CKEDITOR.tools.isEmpty(a)?(a=I(a),o.style=CKEDITOR.tools.writeCssText(a,!0)):a={},i={name:i.element,attributes:o,classes:o.class?o.class.split(/\s+/):[],styles:a,children:[]};a=CKEDITOR.tools.clone(i);var s,c=[];if(!1!==t&&(s=this._.transformations[i.name])){for(o=0;o<s.length;++o)b(this,i,s[o]);h(i)}return f(this,a,c,{doFilter:!0,doTransform:!1!==t,skipRequired:!n,skipFinalValidation:!n}),0<c.length?n=!1:((t=i.attributes.class)&&(i.attributes.class=i.attributes.class.split(" ").sort().join(" ")),n=CKEDITOR.tools.objectCompare(i.attributes,a.attributes,!0),t&&(i.attributes.class=t)),"string"==typeof e&&(this._.cachedChecks[r]=n),n},getAllowedEnterMode:function(){var e=["p","div","br"],t={p:CKEDITOR.ENTER_P,div:CKEDITOR.ENTER_DIV,br:CKEDITOR.ENTER_BR};return function(n,o){var i,r=e.slice();if(this.check(O[n]))return n;for(o||(r=r.reverse());i=r.pop();)if(this.check(i))return t[i];return CKEDITOR.ENTER_BR}}(),clone:function(){var e=new CKEDITOR.filter,t=CKEDITOR.tools.clone;return e.allowedContent=t(this.allowedContent),e._.allowedRules=t(this._.allowedRules),e.disallowedContent=t(this.disallowedContent),e._.disallowedRules=t(this._.disallowedRules),e._.transformations=t(this._.transformations),e.disabled=this.disabled,e.editor=this.editor,e},destroy:function(){delete CKEDITOR.filter.instances[this.id],delete this._,delete this.allowedContent,delete this.disallowedContent}};var w,R={styles:1,attributes:1,classes:1},S={styles:"requiredStyles",attributes:"requiredAttributes",classes:"requiredClasses"},k=/^([a-z0-9\-*\s]+)((?:\s*\{[!\w\-,\s\*]+\}\s*|\s*\[[!\w\-,\s\*]+\]\s*|\s*\([!\w\-,\s\*]+\)\s*){0,3})(?:;\s*|$)/i,A={styles:/{([^}]+)}/,attrs:/\[([^\]]+)\]/,classes:/\(([^\)]+)\)/},N=/^cke:(object|embed|param)$/,M=/^(object|embed|param)$/;w=CKEDITOR.filter.transformationsTools={sizeToStyle:function(e){this.lengthToStyle(e,"width"),this.lengthToStyle(e,"height")},sizeToAttribute:function(e){this.lengthToAttribute(e,"width"),this.lengthToAttribute(e,"height")},lengthToStyle:function(e,t,n){if(!((n=n||t)in e.styles)){var o=e.attributes[t];o&&(/^\d+$/.test(o)&&(o+="px"),e.styles[n]=o)}delete e.attributes[t]},lengthToAttribute:function(e,t,n){if(!((n=n||t)in e.attributes)){var o=e.styles[t],i=o&&o.match(/^(\d+)(?:\.\d*)?px$/);i?e.attributes[n]=i[1]:"cke-test"==o&&(e.attributes[n]="cke-test")}delete e.styles[t]},alignmentToStyle:function(e){if(!("float"in e.styles)){var t=e.attributes.align;"left"!=t&&"right"!=t||(e.styles.float=t)}delete e.attributes.align},alignmentToAttribute:function(e){if(!("align"in e.attributes)){var t=e.styles.float;"left"!=t&&"right"!=t||(e.attributes.align=t)}delete e.styles.float},splitBorderShorthand:function(e){if(e.styles.border){var t=CKEDITOR.tools.style.parse.border(e.styles.border);t.color&&(e.styles["border-color"]=t.color),t.style&&(e.styles["border-style"]=t.style),t.width&&(e.styles["border-width"]=t.width),delete e.styles.border}},listTypeToStyle:function(e){if(e.attributes.type)switch(e.attributes.type){case"a":e.styles["list-style-type"]="lower-alpha";break;case"A":e.styles["list-style-type"]="upper-alpha";break;case"i":e.styles["list-style-type"]="lower-roman";break;case"I":e.styles["list-style-type"]="upper-roman";break;case"1":e.styles["list-style-type"]="decimal";break;default:e.styles["list-style-type"]=e.attributes.type}},splitMarginShorthand:function(e){function t(t){e.styles["margin-top"]=n[t[0]],e.styles["margin-right"]=n[t[1]],e.styles["margin-bottom"]=n[t[2]],e.styles["margin-left"]=n[t[3]]}if(e.styles.margin){var n=e.styles.margin.match(/(\-?[\.\d]+\w+)/g)||["0px"];switch(n.length){case 1:t([0,0,0,0]);break;case 2:t([0,1,0,1]);break;case 3:t([0,1,2,1]);break;case 4:t([0,1,2,3])}delete e.styles.margin}},matchesStyle:C,transform:function(e,t){if("string"==typeof t)e.name=t;else{var n,o,i,r,a=t.getDefinition(),s=a.styles,l=a.attributes;for(n in e.name=a.element,l)if("class"==n)for(a=e.classes.join("|"),i=l[n].split(/\s+/);r=i.pop();)-1==a.indexOf(r)&&e.classes.push(r);else e.attributes[n]=l[n];for(o in s)e.styles[o]=s[o]}}}}(),CKEDITOR.focusManager=function(e){return e.focusManager?e.focusManager:(this.hasFocus=!1,this.currentActive=null,this._={editor:e},this)},CKEDITOR.focusManager._={blurDelay:200},CKEDITOR.focusManager.prototype={focus:function(e){this._.timer&&clearTimeout(this._.timer),e&&(this.currentActive=e),this.hasFocus||this._.locked||((e=CKEDITOR.currentInstance)&&e.focusManager.blur(1),this.hasFocus=!0,(e=this._.editor.container)&&e.addClass("cke_focus"),this._.editor.fire("focus"))},lock:function(){this._.locked=1},unlock:function(){delete this._.locked},blur:function(e){function t(){if(this.hasFocus){this.hasFocus=!1;var e=this._.editor.container;e&&e.removeClass("cke_focus"),this._.editor.fire("blur")}}if(!this._.locked){this._.timer&&clearTimeout(this._.timer);var n=CKEDITOR.focusManager._.blurDelay;e||!n?t.call(this):this._.timer=CKEDITOR.tools.setTimeout((function(){delete this._.timer,t.call(this)}),n,this)}},add:function(e,t){if(!(n=e.getCustomData("focusmanager"))||n!=this){n&&n.remove(e);var n="focus",o="blur";t&&(CKEDITOR.env.ie?(n="focusin",o="focusout"):CKEDITOR.event.useCapture=1);var i={blur:function(){e.equals(this.currentActive)&&this.blur()},focus:function(){this.focus(e)}};e.on(n,i.focus,this),e.on(o,i.blur,this),t&&(CKEDITOR.event.useCapture=0),e.setCustomData("focusmanager",this),e.setCustomData("focusmanager_handlers",i)}},remove:function(e){e.removeCustomData("focusmanager");var t=e.removeCustomData("focusmanager_handlers");e.removeListener("blur",t.blur),e.removeListener("focus",t.focus)}},CKEDITOR.keystrokeHandler=function(e){return e.keystrokeHandler?e.keystrokeHandler:(this.keystrokes={},this.blockedKeystrokes={},this._={editor:e},this)},function(){var e,t=function(t){var n=(t=t.data).getKeystroke(),o=this.keystrokes[n],i=this._.editor;return(e=!1===i.fire("key",{keyCode:n,domEvent:t}))||(o&&(e=!1!==i.execCommand(o,{from:"keystrokeHandler"})),e||(e=!!this.blockedKeystrokes[n])),e&&t.preventDefault(!0),!e},n=function(t){e&&(e=!1,t.data.preventDefault(!0))};CKEDITOR.keystrokeHandler.prototype={attach:function(e){e.on("keydown",t,this),CKEDITOR.env.gecko&&CKEDITOR.env.mac&&e.on("keypress",n,this)}}}(),CKEDITOR.lang={languages:{af:1,ar:1,az:1,bg:1,bn:1,bs:1,ca:1,cs:1,cy:1,da:1,de:1,"de-ch":1,el:1,"en-au":1,"en-ca":1,"en-gb":1,en:1,eo:1,es:1,"es-mx":1,et:1,eu:1,fa:1,fi:1,fo:1,"fr-ca":1,fr:1,gl:1,gu:1,he:1,hi:1,hr:1,hu:1,id:1,is:1,it:1,ja:1,ka:1,km:1,ko:1,ku:1,lt:1,lv:1,mk:1,mn:1,ms:1,nb:1,nl:1,no:1,oc:1,pl:1,"pt-br":1,pt:1,ro:1,ru:1,si:1,sk:1,sl:1,sq:1,"sr-latn":1,sr:1,sv:1,th:1,tr:1,tt:1,ug:1,uk:1,vi:1,"zh-cn":1,zh:1},rtl:{ar:1,fa:1,he:1,ku:1,ug:1},load:function(e,t,n){e&&CKEDITOR.lang.languages[e]||(e=this.detect(t,e));var o=this;t=function(){o[e].dir=o.rtl[e]?"rtl":"ltr",n(e,o[e])},this[e]?t():CKEDITOR.scriptLoader.load(CKEDITOR.getUrl("lang/"+e+".js"),t,this)},detect:function(e,t){var n,o=this.languages,i=(n=(t=t||navigator.userLanguage||navigator.language||e).toLowerCase().match(/([a-z]+)(?:-([a-z]+))?/))[1];return o[i+"-"+(n=n[2])]?i=i+"-"+n:o[i]||(i=null),CKEDITOR.lang.detect=i?function(){return i}:function(e){return e},i||e}},CKEDITOR.scriptLoader=function(){var e={},t={};return{load:function(n,o,i,r){var a="string"==typeof n;a&&(n=[n]),i||(i=CKEDITOR);var s=n.length,l=[],u=[],c=function(e){o&&(a?o.call(i,e):o.call(i,l,u))};if(0===s)c(!0);else{var d=function(e,t){(t?l:u).push(e),0>=--s&&(r&&CKEDITOR.document.getDocumentElement().removeStyle("cursor"),c(t))},f=function(n,o){e[n]=1;var i=t[n];delete t[n];for(var r=0;r<i.length;r++)i[r](n,o)},h=function(n){if(e[n])d(n,!0);else{var i=t[n]||(t[n]=[]);if(i.push(d),!(1<i.length)){var r=new CKEDITOR.dom.element("script");r.setAttributes({type:"text/javascript",src:n}),o&&(CKEDITOR.env.ie&&(8>=CKEDITOR.env.version||CKEDITOR.env.ie9Compat)?r.$.onreadystatechange=function(){"loaded"!=r.$.readyState&&"complete"!=r.$.readyState||(r.$.onreadystatechange=null,f(n,!0))}:(r.$.onload=function(){setTimeout((function(){r.$.onload=null,r.$.onerror=null,f(n,!0)}),0)},r.$.onerror=function(){r.$.onload=null,r.$.onerror=null,f(n,!1)})),r.appendTo(CKEDITOR.document.getHead())}}};r&&CKEDITOR.document.getDocumentElement().setStyle("cursor","wait");for(var g=0;g<s;g++)h(n[g])}},queue:function(){function e(){var e;(e=t[0])&&this.load(e.scriptUrl,e.callback,CKEDITOR,0)}var t=[];return function(n,o){var i=this;t.push({scriptUrl:n,callback:function(){o&&o.apply(this,arguments),t.shift(),e.call(i)}}),1==t.length&&e.call(this)}}()}}(),CKEDITOR.resourceManager=function(e,t){this.basePath=e,this.fileName=t,this.registered={},this.loaded={},this.externals={},this._={waitingList:{}}},CKEDITOR.resourceManager.prototype={add:function(e,t){if(this.registered[e])throw Error('[CKEDITOR.resourceManager.add] The resource name "'+e+'" is already registered.');var n=this.registered[e]=t||{};return n.name=e,n.path=this.getPath(e),CKEDITOR.fire(e+CKEDITOR.tools.capitalize(this.fileName)+"Ready",n),this.get(e)},get:function(e){return this.registered[e]||null},getPath:function(e){var t=this.externals[e];return CKEDITOR.getUrl(t&&t.dir||this.basePath+e+"/")},getFilePath:function(e){var t=this.externals[e];return CKEDITOR.getUrl(this.getPath(e)+(t?t.file:this.fileName+".js"))},addExternal:function(e,t,n){n||(t=t.replace(/[^\/]+$/,(function(e){return n=e,""}))),n=n||this.fileName+".js",e=e.split(",");for(var o=0;o<e.length;o++)this.externals[e[o]]={dir:t,file:n}},load:function(e,t,n){CKEDITOR.tools.isArray(e)||(e=e?[e]:[]);for(var o=this.loaded,i=this.registered,r=[],a={},s={},l=0;l<e.length;l++){var u=e[l];if(u)if(o[u]||i[u])s[u]=this.get(u);else{var c=this.getFilePath(u);r.push(c),c in a||(a[c]=[]),a[c].push(u)}}CKEDITOR.scriptLoader.load(r,(function(e,i){if(i.length)throw Error('[CKEDITOR.resourceManager.load] Resource name "'+a[i[0]].join(",")+'" was not found at "'+i[0]+'".');for(var r=0;r<e.length;r++)for(var l=a[e[r]],u=0;u<l.length;u++){var c=l[u];s[c]=this.get(c),o[c]=1}t.call(n,s)}),this)}},CKEDITOR.plugins=new CKEDITOR.resourceManager("plugins/","plugin"),CKEDITOR.plugins.load=CKEDITOR.tools.override(CKEDITOR.plugins.load,(function(e){var t={};return function(n,o,i){var r={},a=function(n){e.call(this,n,(function(e){CKEDITOR.tools.extend(r,e);var n,s=[];for(n in e){var l=e[n],u=l&&l.requires;if(!t[n]){if(l.icons)for(var c=l.icons.split(","),d=c.length;d--;)CKEDITOR.skin.addIcon(c[d],l.path+"icons/"+(CKEDITOR.env.hidpi&&l.hidpi?"hidpi/":"")+c[d]+".png");l.isSupportedEnvironment=l.isSupportedEnvironment||function(){return!0},t[n]=1}if(u)for(u.split&&(u=u.split(",")),l=0;l<u.length;l++)r[u[l]]||s.push(u[l])}if(s.length)a.call(this,s);else{for(n in r)(l=r[n]).onLoad&&!l.onLoad._called&&(!1===l.onLoad()&&delete r[n],l.onLoad._called=1);o&&o.call(i||window,r)}}),this)};a.call(this,n)}})),CKEDITOR.plugins.setLang=function(e,t,n){var o=this.get(e);e=o.langEntries||(o.langEntries={}),(o=o.lang||(o.lang=[])).split&&(o=o.split(",")),-1==CKEDITOR.tools.indexOf(o,t)&&o.push(t),e[t]=n},CKEDITOR.ui=function(e){return e.ui?e.ui:(this.items={},this.instances={},this.editor=e,this._={handlers:{}},this)},CKEDITOR.ui.prototype={add:function(e,t,n){n.name=e.toLowerCase();var o=this.items[e]={type:t,command:n.command||null,args:Array.prototype.slice.call(arguments,2)};CKEDITOR.tools.extend(o,n)},get:function(e){return this.instances[e]},create:function(e){var t=this.items[e],n=t&&this._.handlers[t.type],o=t&&t.command&&this.editor.getCommand(t.command);return n=n&&n.create.apply(this,t.args),this.instances[e]=n,o&&o.uiItems.push(n),n&&!n.type&&(n.type=t.type),n},addHandler:function(e,t){this._.handlers[e]=t},space:function(e){return CKEDITOR.document.getById(this.spaceId(e))},spaceId:function(e){return this.editor.id+"_"+e}},CKEDITOR.event.implementOn(CKEDITOR.ui),function(){function e(e,n,i){if(CKEDITOR.event.call(this),e=e&&CKEDITOR.tools.clone(e),void 0!==n){if(!(n instanceof CKEDITOR.dom.element))throw Error("Expect element of type CKEDITOR.dom.element.");if(!i)throw Error("One of the element modes must be specified.");if(CKEDITOR.env.ie&&CKEDITOR.env.quirks&&i==CKEDITOR.ELEMENT_MODE_INLINE)throw Error("Inline element mode is not supported on IE quirks.");if(!function(e,t){return t==CKEDITOR.ELEMENT_MODE_INLINE?e.is(CKEDITOR.dtd.$editable)||e.is("textarea"):t==CKEDITOR.ELEMENT_MODE_REPLACE?!e.is(CKEDITOR.dtd.$nonBodyContent):1}(n,i))throw Error('The specified element mode is not supported on element: "'+n.getName()+'".');this.element=n,this.elementMode=i,this.name=this.elementMode!=CKEDITOR.ELEMENT_MODE_APPENDTO&&(n.getId()||n.getNameAtt())}else this.elementMode=CKEDITOR.ELEMENT_MODE_NONE;this._={},this.commands={},this.templates={},this.name=this.name||function(){do{var e="editor"+ ++r}while(CKEDITOR.instances[e]);return e}(),this.id=CKEDITOR.tools.getNextId(),this.status="unloaded",this.config=CKEDITOR.tools.prototypedCopy(CKEDITOR.config),this.ui=new CKEDITOR.ui(this),this.focusManager=new CKEDITOR.focusManager(this),this.keystrokeHandler=new CKEDITOR.keystrokeHandler(this),this.on("readOnly",t),this.on("selectionChange",(function(e){o(this,e.data.path)})),this.on("activeFilterChange",(function(){o(this,this.elementPath(),!0)})),this.on("mode",t),CKEDITOR.dom.selection.setupEditorOptimization(this),this.on("instanceReady",(function(){if(this.config.startupFocus){if("end"===this.config.startupFocus){var e=this.createRange();e.selectNodeContents(this.editable()),e.shrink(CKEDITOR.SHRINK_ELEMENT,!0),e.collapse(),this.getSelection().selectRanges([e])}this.focus()}})),CKEDITOR.fire("instanceCreated",null,this),CKEDITOR.add(this),CKEDITOR.tools.setTimeout((function(){this.isDestroyed()||this.isDetached()||function(e,t){e.on("customConfigLoaded",(function(){if(t){if(t.on)for(var n in t.on)e.on(n,t.on[n]);CKEDITOR.tools.extend(e.config,t,!0),delete e.config.on}e.readOnly=!!(n=e.config).readOnly||(e.elementMode==CKEDITOR.ELEMENT_MODE_INLINE?e.element.is("textarea")?e.element.hasAttribute("disabled")||e.element.hasAttribute("readonly"):e.element.isReadOnly():e.elementMode==CKEDITOR.ELEMENT_MODE_REPLACE&&(e.element.hasAttribute("disabled")||e.element.hasAttribute("readonly"))),e.blockless=e.elementMode==CKEDITOR.ELEMENT_MODE_INLINE&&!(e.element.is("textarea")||CKEDITOR.dtd[e.element.getName()].p),e.tabIndex=n.tabIndex||e.element&&e.element.getAttribute("tabindex")||0,e.activeEnterMode=e.enterMode=e.blockless?CKEDITOR.ENTER_BR:n.enterMode,e.activeShiftEnterMode=e.shiftEnterMode=e.blockless?CKEDITOR.ENTER_BR:n.shiftEnterMode,n.skin&&(CKEDITOR.skinName=n.skin),e.fireOnce("configLoaded"),e.dataProcessor=new CKEDITOR.htmlDataProcessor(e),e.filter=e.activeFilter=new CKEDITOR.filter(e),function(e){CKEDITOR.skin.loadPart("editor",(function(){!function(e){CKEDITOR.lang.load(e.config.language,e.config.defaultLanguage,(function(t,n){var o=e.config.title;e.langCode=t,e.lang=CKEDITOR.tools.prototypedCopy(n),e.title="string"==typeof o||!1===o?o:[e.lang.editor,e.name].join(", "),e.config.contentsLangDirection||(e.config.contentsLangDirection=e.elementMode==CKEDITOR.ELEMENT_MODE_INLINE?e.element.getDirection(1):e.lang.dir),e.fire("langLoaded"),function(e){e.getStylesSet((function(t){e.once("loaded",(function(){e.fire("stylesSet",{styles:t})}),null,null,1),function(e){function t(e){return e?(CKEDITOR.tools.isArray(e)&&(e=e.join(",")),e.replace(/\s/g,"")):""}var n=e.config,o=t(n.plugins),i=t(n.extraPlugins),r=t(n.removePlugins);if(i){var a=new RegExp("(?:^|,)(?:"+i.replace(/,/g,"|")+")(?=,|$)","g");o=(o=o.replace(a,""))+","+i}if(r){var s=new RegExp("(?:^|,)(?:"+r.replace(/,/g,"|")+")(?=,|$)","g");o=o.replace(s,"")}CKEDITOR.env.air&&(o+=",adobeair"),CKEDITOR.plugins.load(o.split(","),(function(t){var o=[],i=[],r=[];for(var a in e.plugins=CKEDITOR.tools.extend({},e.plugins,t),t){var l,u=t[a],c=u.lang,d=null,f=u.requires;if(CKEDITOR.tools.isArray(f)&&(f=f.join(",")),f&&(l=f.match(s)))for(;f=l.pop();)CKEDITOR.error("editor-plugin-required",{plugin:f.replace(",",""),requiredBy:a});c&&!e.lang[a]&&(c.split&&(c=c.split(",")),d=0<=CKEDITOR.tools.indexOf(c,e.langCode)?e.langCode:(d=e.langCode.replace(/-.*/,""))!=e.langCode&&0<=CKEDITOR.tools.indexOf(c,d)?d:0<=CKEDITOR.tools.indexOf(c,"en")?"en":c[0],u.langEntries&&u.langEntries[d]?(e.lang[a]=u.langEntries[d],d=null):r.push(CKEDITOR.getUrl(u.path+"lang/"+d+".js"))),i.push(d),o.push(u)}CKEDITOR.scriptLoader.load(r,(function(){if(!e.isDestroyed()&&!e.isDetached()){for(var t=["beforeInit","init","afterInit"],r=0;r<t.length;r++)for(var a=0;a<o.length;a++){var s=o[a];0===r&&i[a]&&s.lang&&s.langEntries&&(e.lang[s.name]=s.langEntries[i[a]]),s[t[r]]&&s[t[r]](e)}for(e.fireOnce("pluginsLoaded"),n.keystrokes&&e.setKeystroke(e.config.keystrokes),a=0;a<e.config.blockedKeystrokes.length;a++)e.keystrokeHandler.blockedKeystrokes[e.config.blockedKeystrokes[a]]=1;e.status="loaded",e.fireOnce("loaded"),CKEDITOR.fire("instanceLoaded",null,e)}}))}))}(e)}))}(e)}))}(e)}))}(e)})),t&&null!=t.customConfig&&(e.config.customConfig=t.customConfig),function e(t){if(!(n=t.config.customConfig))return!1;var n=CKEDITOR.getUrl(n),o=a[n]||(a[n]={});return o.fn?(o.fn.call(t,t.config),CKEDITOR.getUrl(t.config.customConfig)!=n&&e(t)||t.fireOnce("customConfigLoaded")):CKEDITOR.scriptLoader.queue(n,(function(){o.fn=CKEDITOR.editorConfig?CKEDITOR.editorConfig:function(){},e(t)})),!0}(e)||e.fireOnce("customConfigLoaded")}(this,e)}),0,this)}function t(){var e,t=this.commands;for(e in t)n(this,t[e])}function n(e,t){t[t.startDisabled||e.readOnly&&!t.readOnly?"disable":t.modes[e.mode]?"enable":"disable"]()}function o(e,t,n){if(t){var o,i,r=e.commands;for(i in r)o=r[i],(n||o.contextSensitive)&&o.refresh(e,t)}}function i(){var e=this.element;if(e&&this.elementMode!=CKEDITOR.ELEMENT_MODE_APPENDTO){var t=this.getData();return this.config.htmlEncodeOutput&&(t=CKEDITOR.tools.htmlEncode(t)),e.is("textarea")?e.setValue(t):e.setHtml(t),!0}return!1}e.prototype=CKEDITOR.editor.prototype,CKEDITOR.editor=e;var r=0,a={};CKEDITOR.tools.extend(CKEDITOR.editor.prototype,{plugins:{detectConflict:function(e,t){for(var n=0;n<t.length;n++){var o=t[n];if(this[o])return CKEDITOR.warn("editor-plugin-conflict",{plugin:e,replacedWith:o}),!0}return!1}},addCommand:function(e,t){t.name=e.toLowerCase();var o=t instanceof CKEDITOR.command?t:new CKEDITOR.command(this,t);return this.mode&&n(this,o),this.commands[e]=o},_attachToForm:function(){function e(e){t.updateElement(),t._.required&&!n.getValue()&&!1===t.fire("required")&&e.data.preventDefault()}var t=this,n=t.element,o=new CKEDITOR.dom.element(n.$.form);n.is("textarea")&&o&&(o.on("submit",e),function(e){return!!(e&&e.call&&e.apply)}(o.$.submit)&&(o.$.submit=CKEDITOR.tools.override(o.$.submit,(function(t){return function(){e(),t.apply?t.apply(this):t()}}))),t.on("destroy",(function(){o.removeListener("submit",e)})))},destroy:function(e){var t=CKEDITOR.filter.instances,n=this;this.fire("beforeDestroy"),!e&&i.call(this),this.editable(null),this.filter&&delete this.filter,CKEDITOR.tools.array.forEach(CKEDITOR.tools.object.keys(t),(function(e){n===(e=t[e]).editor&&e.destroy()})),delete this.activeFilter,this.status="destroyed",this.fire("destroy"),this.removeAllListeners(),CKEDITOR.remove(this),CKEDITOR.fire("instanceDestroyed",null,this)},elementPath:function(e){if(!e){if(!(e=this.getSelection()))return null;e=e.getStartElement()}return e?new CKEDITOR.dom.elementPath(e,this.editable()):null},createRange:function(){var e=this.editable();return e?new CKEDITOR.dom.range(e):null},execCommand:function(e,t){var n=this.getCommand(e),o={name:e,commandData:t||{},command:n};return!(!n||n.state==CKEDITOR.TRISTATE_DISABLED||!1===this.fire("beforeCommandExec",o)||(o.returnValue=n.exec(o.commandData),n.async||!1===this.fire("afterCommandExec",o)))&&o.returnValue},getCommand:function(e){return this.commands[e]},getData:function(e){!e&&this.fire("beforeGetData");var t=this._.data;return"string"!=typeof t&&(t=(t=this.element)&&this.elementMode==CKEDITOR.ELEMENT_MODE_REPLACE?t.is("textarea")?t.getValue():t.getHtml():""),t={dataValue:t},!e&&this.fire("getData",t),t.dataValue},getSnapshot:function(){var e=this.fire("getSnapshot");return"string"!=typeof e&&(e=(e=this.element)&&this.elementMode==CKEDITOR.ELEMENT_MODE_REPLACE?e.is("textarea")?e.getValue():e.getHtml():""),e},loadSnapshot:function(e){this.fire("loadSnapshot",e)},setData:function(e,t,n){var o=!0,i=t;t&&"object"==typeof t&&(n=t.internal,i=t.callback,o=!t.noSnapshot),!n&&o&&this.fire("saveSnapshot"),!i&&n||this.once("dataReady",(function(e){!n&&o&&this.fire("saveSnapshot"),i&&i.call(e.editor)})),e={dataValue:e},!n&&this.fire("setData",e),this._.data=e.dataValue,!n&&this.fire("afterSetData",e)},setReadOnly:function(e){this.readOnly!=(e=null==e||e)&&(this.readOnly=e,this.keystrokeHandler.blockedKeystrokes[8]=+e,this.editable().setReadOnly(e),this.fire("readOnly"))},insertHtml:function(e,t,n){this.fire("insertHtml",{dataValue:e,mode:t,range:n})},insertText:function(e){this.fire("insertText",e)},insertElement:function(e){this.fire("insertElement",e)},getSelectedHtml:function(e){var t=this.editable(),n=(n=this.getSelection())&&n.getRanges();return t&&n&&0!==n.length?(t=function(e,t){function n(e){var t=e.startContainer,n=e.endContainer;return!(!t.is||!(t.is("tr")||t.is("td")&&t.equals(n)&&e.endOffset===t.getChildCount()))}function o(e){var t=e.startContainer;return t.is("tr")?e.cloneContents():t.clone(!0)}for(var i,r,a,s=new CKEDITOR.dom.documentFragment,l=0;l<e.length;l++){var u=e[l],c=u.startContainer.getAscendant("tr",!0);n(u)?(i||((i=c.getAscendant("table").clone()).append(c.getAscendant({thead:1,tbody:1,tfoot:1}).clone()),s.append(i),i=i.findOne("thead, tbody, tfoot")),r&&r.equals(c)||(r=c,a=c.clone(),i.append(a)),a.append(o(u))):s.append(u.cloneContents())}return i?s:t.getHtmlFromRange(e[0])}(n,t),e?t.getHtml():t):null},extractSelectedHtml:function(e,t){var n,o=this.editable(),i=this.getSelection().getRanges(),r=new CKEDITOR.dom.documentFragment;if(!o||0===i.length)return null;for(n=0;n<i.length;n++)r.append(o.extractHtmlFromRange(i[n],t));return t||this.getSelection().selectRanges([i[0]]),e?r.getHtml():r},focus:function(){this.fire("beforeFocus")},checkDirty:function(){return"ready"==this.status&&this._.previousValue!==this.getSnapshot()},resetDirty:function(){this._.previousValue=this.getSnapshot()},updateElement:function(){return i.call(this)},setKeystroke:function(){for(var e,t,n=this.keystrokeHandler.keystrokes,o=CKEDITOR.tools.isArray(arguments[0])?arguments[0]:[[].slice.call(arguments,0)],i=o.length;i--;)e=o[i],t=0,CKEDITOR.tools.isArray(e)&&(t=e[1],e=e[0]),t?n[e]=t:delete n[e]},getCommandKeystroke:function(e,t){var n="string"==typeof e?this.getCommand(e):e,o=[];if(n){var i=CKEDITOR.tools.object.findKey(this.commands,n),r=this.keystrokeHandler.keystrokes;if(n.fakeKeystroke)o.push(n.fakeKeystroke);else for(var a in r)r[a]===i&&o.push(a)}return t?o:o[0]||null},addFeature:function(e){return this.filter.addFeature(e)},setActiveFilter:function(e){e||(e=this.filter),this.activeFilter!==e&&(this.activeFilter=e,this.fire("activeFilterChange"),e===this.filter?this.setActiveEnterMode(null,null):this.setActiveEnterMode(e.getAllowedEnterMode(this.enterMode),e.getAllowedEnterMode(this.shiftEnterMode,!0)))},setActiveEnterMode:function(e,t){e=e?this.blockless?CKEDITOR.ENTER_BR:e:this.enterMode,t=t?this.blockless?CKEDITOR.ENTER_BR:t:this.shiftEnterMode,this.activeEnterMode==e&&this.activeShiftEnterMode==t||(this.activeEnterMode=e,this.activeShiftEnterMode=t,this.fire("activeEnterModeChange"))},showNotification:function(e){alert(e)},isDetached:function(){return!!this.container&&this.container.isDetached()},isDestroyed:function(){return"destroyed"===this.status}}),CKEDITOR.editor._getEditorElement=function(e){if(!CKEDITOR.env.isCompatible)return null;var t=CKEDITOR.dom.element.get(e);return t?t.getEditor()?(CKEDITOR.error("editor-element-conflict",{editorName:t.getEditor().name}),null):t:(CKEDITOR.error("editor-incorrect-element",{element:e}),null)}}(),CKEDITOR.ELEMENT_MODE_NONE=0,CKEDITOR.ELEMENT_MODE_REPLACE=1,CKEDITOR.ELEMENT_MODE_APPENDTO=2,CKEDITOR.ELEMENT_MODE_INLINE=3,CKEDITOR.htmlParser=function(){this._={htmlPartsRegex:/<(?:(?:\/([^>]+)>)|(?:!--([\S|\s]*?)--\x3e)|(?:([^\/\s>]+)((?:\s+[\w\-:.]+(?:\s*=\s*?(?:(?:"[^"]*")|(?:'[^']*')|[^\s"'\/>]+))?)*)[\S\s]*?(\/?)>))/g}},function(){var e=/([\w\-:.]+)(?:(?:\s*=\s*(?:(?:"([^"]*)")|(?:'([^']*)')|([^\s>]+)))|(?=\s|$))/g,t={checked:1,compact:1,declare:1,defer:1,disabled:1,ismap:1,multiple:1,nohref:1,noresize:1,noshade:1,nowrap:1,readonly:1,selected:1};CKEDITOR.htmlParser.prototype={onTagOpen:function(){},onTagClose:function(){},onText:function(){},onCDATA:function(){},onComment:function(){},parse:function(n){for(var o,i,r,a=0;o=this._.htmlPartsRegex.exec(n);)if((i=o.index)>a&&(a=n.substring(a,i),r?r.push(a):this.onText(a)),a=this._.htmlPartsRegex.lastIndex,!(i=o[1])||(i=i.toLowerCase(),r&&CKEDITOR.dtd.$cdata[i]&&(this.onCDATA(r.join("")),r=null),r))if(r)r.push(o[0]);else if(i=o[3]){if(i=i.toLowerCase(),!/="/.test(i)){var s,l={},u=o[4];if(o=!!o[5],u)for(;s=e.exec(u);){var c=s[1].toLowerCase();l[c]=!(s=s[2]||s[3]||s[4]||"")&&t[c]?c:CKEDITOR.tools.htmlDecodeAttr(s)}this.onTagOpen(i,l,o),!r&&CKEDITOR.dtd.$cdata[i]&&(r=[])}}else(i=o[2])&&this.onComment(i);else this.onTagClose(i);n.length>a&&this.onText(n.substring(a,n.length))}}}(),CKEDITOR.htmlParser.basicWriter=CKEDITOR.tools.createClass({$:function(){this._={output:[]}},proto:{openTag:function(e){this._.output.push("<",e)},openTagClose:function(e,t){this._.output.push(t?" />":">")},attribute:function(e,t){"string"==typeof t&&(t=CKEDITOR.tools.htmlEncodeAttr(t)),this._.output.push(" ",e,'="',t,'"')},closeTag:function(e){this._.output.push("</",e,">")},text:function(e){this._.output.push(e)},comment:function(e){this._.output.push("\x3c!--",e,"--\x3e")},write:function(e){this._.output.push(e)},reset:function(){this._.output=[],this._.indent=!1},getHtml:function(e){var t=this._.output.join("");return e&&this.reset(),t}}}),CKEDITOR.htmlParser.node=function(){},CKEDITOR.htmlParser.node.prototype={remove:function(){var e=this.parent.children,t=CKEDITOR.tools.indexOf(e,this),n=this.previous,o=this.next;n&&(n.next=o),o&&(o.previous=n),e.splice(t,1),this.parent=null},replaceWith:function(e){var t=this.parent.children,n=CKEDITOR.tools.indexOf(t,this),o=e.previous=this.previous,i=e.next=this.next;o&&(o.next=e),i&&(i.previous=e),t[n]=e,e.parent=this.parent,this.parent=null},insertAfter:function(e){var t=e.parent.children,n=CKEDITOR.tools.indexOf(t,e),o=e.next;t.splice(n+1,0,this),this.next=e.next,this.previous=e,e.next=this,o&&(o.previous=this),this.parent=e.parent},insertBefore:function(e){var t=e.parent.children,n=CKEDITOR.tools.indexOf(t,e);t.splice(n,0,this),this.next=e,(this.previous=e.previous)&&(e.previous.next=this),e.previous=this,this.parent=e.parent},getAscendant:function(e){for(var t="function"==typeof e?e:"string"==typeof e?function(t){return t.name==e}:function(t){return t.name in e},n=this.parent;n&&n.type==CKEDITOR.NODE_ELEMENT;){if(t(n))return n;n=n.parent}return null},wrapWith:function(e){return this.replaceWith(e),e.add(this),e},getIndex:function(){return CKEDITOR.tools.indexOf(this.parent.children,this)},getFilterContext:function(e){return e||{}}},CKEDITOR.htmlParser.comment=function(e){this.value=e,this._={isBlockLike:!1}},CKEDITOR.htmlParser.comment.prototype=CKEDITOR.tools.extend(new CKEDITOR.htmlParser.node,{type:CKEDITOR.NODE_COMMENT,filter:function(e,t){var n=this.value;return(n=e.onComment(t,n,this))?"string"!=typeof n?(this.replaceWith(n),!1):(this.value=n,!0):(this.remove(),!1)},writeHtml:function(e,t){t&&this.filter(t),e.comment(this.value)}}),CKEDITOR.htmlParser.text=function(e){this.value=e,this._={isBlockLike:!1}},CKEDITOR.htmlParser.text.prototype=CKEDITOR.tools.extend(new CKEDITOR.htmlParser.node,{type:CKEDITOR.NODE_TEXT,filter:function(e,t){if(!(this.value=e.onText(t,this.value,this)))return this.remove(),!1},writeHtml:function(e,t){t&&this.filter(t),e.text(this.value)}}),CKEDITOR.htmlParser.cdata=function(e){this.value=e},CKEDITOR.htmlParser.cdata.prototype=CKEDITOR.tools.extend(new CKEDITOR.htmlParser.node,{type:CKEDITOR.NODE_TEXT,filter:function(){},writeHtml:function(e){e.write(this.value)}}),CKEDITOR.htmlParser.fragment=function(){this.children=[],this.parent=null,this._={isBlockLike:!0,hasInlineStarted:!1}},function(){function e(e){return!e.attributes["data-cke-survive"]&&("a"==e.name&&e.attributes.href||CKEDITOR.dtd.$removeEmpty[e.name])}var t=CKEDITOR.tools.extend({table:1,ul:1,ol:1,dl:1},CKEDITOR.dtd.table,CKEDITOR.dtd.ul,CKEDITOR.dtd.ol,CKEDITOR.dtd.dl),n={ol:1,ul:1},o=CKEDITOR.tools.extend({},{html:1},CKEDITOR.dtd.html,CKEDITOR.dtd.body,CKEDITOR.dtd.head,{style:1,script:1}),i={ul:"li",ol:"li",dl:"dd",table:"tbody",tbody:"tr",thead:"tr",tfoot:"tr",tr:"td"};CKEDITOR.htmlParser.fragment.fromHtml=function(r,a,s){function l(e){var t;if(0<p.length)for(var n=0;n<p.length;n++){var o=p[n],i=o.name,r=CKEDITOR.dtd[i],a=y.name&&CKEDITOR.dtd[y.name];a&&!a[i]||e&&r&&!r[e]&&CKEDITOR.dtd[e]?i==y.name&&(d(y,y.parent,1),n--):(t||(u(),t=1),(o=o.clone()).parent=y,y=o,p.splice(n,1),n--)}}function u(){for(;v.length;)d(v.shift(),y)}function c(e){if(e._.isBlockLike&&"pre"!=e.name&&"textarea"!=e.name){var t,n=e.children.length,o=e.children[n-1];o&&o.type==CKEDITOR.NODE_TEXT&&((t=CKEDITOR.tools.rtrim(o.value))?o.value=t:e.children.length=n-1)}}function d(t,n,o){n=n||y||m;var i=y;void 0===t.previous&&(f(n,t)&&(y=n,g.onTagOpen(s,{}),t.returnPoint=n=y),c(t),e(t)&&!t.children.length||n.add(t),"pre"==t.name&&(C=!1),"textarea"==t.name&&(b=!1)),t.returnPoint?(y=t.returnPoint,delete t.returnPoint):y=o?n:i}function f(e,t){var n,o;if((e==m||"body"==e.name)&&s&&(!e.name||CKEDITOR.dtd[e.name][s]))return(n=t.attributes&&(o=t.attributes["data-cke-real-element-type"])?o:t.name)&&n in CKEDITOR.dtd.$inline&&!(n in CKEDITOR.dtd.head)&&!t.isOrphan||t.type==CKEDITOR.NODE_TEXT}function h(e,t){return(e in CKEDITOR.dtd.$listItem||e in CKEDITOR.dtd.$tableContent)&&(e==t||"dt"==e&&"dd"==t||"dd"==e&&"dt"==t)}var g=new CKEDITOR.htmlParser,m=a instanceof CKEDITOR.htmlParser.element?a:"string"==typeof a?new CKEDITOR.htmlParser.element(a):new CKEDITOR.htmlParser.fragment,p=[],v=[],y=m,b="textarea"==m.name,C="pre"==m.name;for(g.onTagOpen=function(i,r,a,s){if((r=new CKEDITOR.htmlParser.element(i,r)).isUnknown&&a&&(r.isEmpty=!0),r.isOptionalClose=s,e(r))p.push(r);else{if("pre"==i)C=!0;else{if("br"==i&&C)return void y.add(new CKEDITOR.htmlParser.text("\n"));"textarea"==i&&(b=!0)}if("br"==i)v.push(r);else{for(;s=(a=y.name)?CKEDITOR.dtd[a]||(y._.isBlockLike?CKEDITOR.dtd.div:CKEDITOR.dtd.span):o,!(r.isUnknown||y.isUnknown||s[i]);)if(y.isOptionalClose)g.onTagClose(a);else if(i in n&&a in n)(a=(a=y.children)[a.length-1])&&"li"==a.name||d(a=new CKEDITOR.htmlParser.element("li"),y),!r.returnPoint&&(r.returnPoint=y),y=a;else if(i in CKEDITOR.dtd.$listItem&&!h(i,a))g.onTagOpen("li"==i?"ul":"dl",{},0,1);else if(a in t&&!h(i,a))!r.returnPoint&&(r.returnPoint=y),y=y.parent;else{if(a in CKEDITOR.dtd.$inline&&p.unshift(y),!y.parent){r.isOrphan=1;break}d(y,y.parent,1)}l(i),u(),r.parent=y,r.isEmpty?d(r):y=r}}},g.onTagClose=function(e){for(var t=p.length-1;0<=t;t--)if(e==p[t].name)return void p.splice(t,1);for(var n=[],o=[],i=y;i!=m&&i.name!=e;)i._.isBlockLike||o.unshift(i),n.push(i),i=i.returnPoint||i.parent;if(i!=m){for(t=0;t<n.length;t++){var r=n[t];d(r,r.parent)}y=i,i._.isBlockLike&&u(),d(i,i.parent),i==y&&(y=y.parent),p=p.concat(o)}"body"==e&&(s=!1)},g.onText=function(e){if(y._.hasInlineStarted&&!v.length||C||b||0!==(e=CKEDITOR.tools.ltrim(e)).length){var n=y.name,r=n?CKEDITOR.dtd[n]||(y._.isBlockLike?CKEDITOR.dtd.div:CKEDITOR.dtd.span):o;b||r["#"]||!(n in t)?(u(),l(),C||b||(e=e.replace(/[\t\r\n ]{2,}|[\t\r\n]/g," ")),e=new CKEDITOR.htmlParser.text(e),f(y,e)&&this.onTagOpen(s,{},0,1),y.add(e)):(g.onTagOpen(i[n]||""),g.onText(e))}},g.onCDATA=function(e){y.add(new CKEDITOR.htmlParser.cdata(e))},g.onComment=function(e){u(),l(),y.add(new CKEDITOR.htmlParser.comment(e))},g.parse(r),u();y!=m;)d(y,y.parent,1);return c(m),m},CKEDITOR.htmlParser.fragment.prototype={type:CKEDITOR.NODE_DOCUMENT_FRAGMENT,add:function(e,t){isNaN(t)&&(t=this.children.length);var n=0<t?this.children[t-1]:null;if(n){if(e._.isBlockLike&&n.type==CKEDITOR.NODE_TEXT&&(n.value=CKEDITOR.tools.rtrim(n.value),0===n.value.length))return this.children.pop(),void this.add(e);n.next=e}e.previous=n,e.parent=this,this.children.splice(t,0,e),this._.hasInlineStarted||(this._.hasInlineStarted=e.type==CKEDITOR.NODE_TEXT||e.type==CKEDITOR.NODE_ELEMENT&&!e._.isBlockLike)},filter:function(e,t){t=this.getFilterContext(t),e.onRoot(t,this),this.filterChildren(e,!1,t)},filterChildren:function(e,t,n){if(this.childrenFilteredBy!=e.id)for(n=this.getFilterContext(n),t&&!this.parent&&e.onRoot(n,this),this.childrenFilteredBy=e.id,t=0;t<this.children.length;t++)!1===this.children[t].filter(e,n)&&t--},writeHtml:function(e,t){t&&this.filter(t),this.writeChildrenHtml(e)},writeChildrenHtml:function(e,t,n){var o=this.getFilterContext();for(n&&!this.parent&&t&&t.onRoot(o,this),t&&this.filterChildren(t,!1,o),t=0,o=(n=this.children).length;t<o;t++)n[t].writeHtml(e)},forEach:function(e,t,n){if(!(n||t&&this.type!=t))var o=e(this);if(!1!==o){n=this.children;for(var i=0;i<n.length;i++)(o=n[i]).type==CKEDITOR.NODE_ELEMENT?o.forEach(e,t):t&&o.type!=t||e(o)}},getFilterContext:function(e){return e||{}}}}(),function(){function e(){this.rules=[]}function t(t,n,o,i){var r,a;for(r in n)(a=t[r])||(a=t[r]=new e),a.add(n[r],o,i)}CKEDITOR.htmlParser.filter=CKEDITOR.tools.createClass({$:function(t){this.id=CKEDITOR.tools.getNextNumber(),this.elementNameRules=new e,this.attributeNameRules=new e,this.elementsRules={},this.attributesRules={},this.textRules=new e,this.commentRules=new e,this.rootRules=new e,t&&this.addRules(t,10)},proto:{addRules:function(e,n){var o;"number"==typeof n?o=n:n&&"priority"in n&&(o=n.priority),"number"!=typeof o&&(o=10),"object"!=typeof n&&(n={}),e.elementNames&&this.elementNameRules.addMany(e.elementNames,o,n),e.attributeNames&&this.attributeNameRules.addMany(e.attributeNames,o,n),e.elements&&t(this.elementsRules,e.elements,o,n),e.attributes&&t(this.attributesRules,e.attributes,o,n),e.text&&this.textRules.add(e.text,o,n),e.comment&&this.commentRules.add(e.comment,o,n),e.root&&this.rootRules.add(e.root,o,n)},applyTo:function(e){e.filter(this)},onElementName:function(e,t){return this.elementNameRules.execOnName(e,t)},onAttributeName:function(e,t){return this.attributeNameRules.execOnName(e,t)},onText:function(e,t,n){return this.textRules.exec(e,t,n)},onComment:function(e,t,n){return this.commentRules.exec(e,t,n)},onRoot:function(e,t){return this.rootRules.exec(e,t)},onElement:function(e,t){for(var n,o=[this.elementsRules["^"],this.elementsRules[t.name],this.elementsRules.$],i=0;3>i;i++)if(n=o[i]){if(!1===(n=n.exec(e,t,this)))return null;if(n&&n!=t)return this.onNode(e,n);if(t.parent&&!t.name)break}return t},onNode:function(e,t){var n=t.type;return n==CKEDITOR.NODE_ELEMENT?this.onElement(e,t):n==CKEDITOR.NODE_TEXT?new CKEDITOR.htmlParser.text(this.onText(e,t.value)):n==CKEDITOR.NODE_COMMENT?new CKEDITOR.htmlParser.comment(this.onComment(e,t.value)):null},onAttribute:function(e,t,n,o){return(n=this.attributesRules[n])?n.exec(e,o,t,this):o}}}),CKEDITOR.htmlParser.filterRulesGroup=e,e.prototype={add:function(e,t,n){this.rules.splice(this.findIndex(t),0,{value:e,priority:t,options:n})},addMany:function(e,t,n){for(var o=[this.findIndex(t),0],i=0,r=e.length;i<r;i++)o.push({value:e[i],priority:t,options:n});this.rules.splice.apply(this.rules,o)},findIndex:function(e){for(var t=this.rules,n=t.length-1;0<=n&&e<t[n].priority;)n--;return n+1},exec:function(e,t){var n,o,i,r,a=t instanceof CKEDITOR.htmlParser.node||t instanceof CKEDITOR.htmlParser.fragment,s=Array.prototype.slice.call(arguments,1),l=this.rules,u=l.length;for(r=0;r<u;r++)if(a&&(n=t.type,o=t.name),i=l[r],!(e.nonEditable&&!i.options.applyToAll||e.nestedEditable&&i.options.excludeNestedEditable)){if(!1===(i=i.value.apply(null,s))||a&&i&&(i.name!=o||i.type!=n))return i;null!=i&&(s[0]=t=i)}return t},execOnName:function(e,t){for(var n,o=0,i=this.rules,r=i.length;t&&o<r;o++)n=i[o],e.nonEditable&&!n.options.applyToAll||e.nestedEditable&&n.options.excludeNestedEditable||(t=t.replace(n.value[0],n.value[1]));return t}}}(),function(){function e(e,t){function s(e){return e||CKEDITOR.env.needsNbspFiller?new CKEDITOR.htmlParser.text(" "):new CKEDITOR.htmlParser.element("br",{"data-cke-bogus":1})}function l(e,t){return function(i){if(i.type!=CKEDITOR.NODE_DOCUMENT_FRAGMENT){var a,l,c=[],d=n(i);if(d)for(u(d,1)&&c.push(d);d;)r(d)&&(a=o(d))&&u(a)&&((l=o(a))&&!r(l)?c.push(a):(s(f).insertAfter(a),a.remove())),d=d.previous;for(d=0;d<c.length;d++)c[d].remove();(c=!e||!1!==("function"==typeof t?t(i):t))&&(c=!(!f&&!CKEDITOR.env.needsBrFiller&&i.type==CKEDITOR.NODE_DOCUMENT_FRAGMENT||!f&&!CKEDITOR.env.needsBrFiller&&(7<document.documentMode||i.name in CKEDITOR.dtd.tr||i.name in CKEDITOR.dtd.$listItem)||(c=n(i))&&("form"!=i.name||"input"!=c.name))),c&&i.add(s(e))}}}function u(e,t){return!(f&&!CKEDITOR.env.needsBrFiller||e.type!=CKEDITOR.NODE_ELEMENT||"br"!=e.name||e.attributes["data-cke-eol"])||!!(e.type==CKEDITOR.NODE_TEXT&&(n=e.value.match(m))&&(n.index&&(new CKEDITOR.htmlParser.text(e.value.substring(0,n.index)).insertBefore(e),e.value=n[0]),!CKEDITOR.env.needsBrFiller&&f&&(!t||e.parent.name in h)||!f&&((n=e.previous)&&"br"==n.name||!n||r(n))));var n}var c,d={elements:{}},f="html"==t,h=CKEDITOR.tools.extend({},b);for(c in h)"#"in v[c]||delete h[c];for(c in h)d.elements[c]=l(f,e.config.fillEmptyBlocks);return d.root=l(f,!1),d.elements.br=function(e){return function(t){if(t.parent.type!=CKEDITOR.NODE_DOCUMENT_FRAGMENT){var n=t.attributes;if("data-cke-bogus"in n||"data-cke-eol"in n)delete n["data-cke-bogus"];else{for(n=t.next;n&&i(n);)n=n.next;var l=o(t);!n&&r(t.parent)?a(t.parent,s(e)):r(n)&&l&&!r(l)&&s(e).insertBefore(n)}}}}(f),d}function t(e,t){return e!=CKEDITOR.ENTER_BR&&!1!==t&&(e==CKEDITOR.ENTER_DIV?"div":"p")}function n(e){for(e=e.children[e.children.length-1];e&&i(e);)e=e.previous;return e}function o(e){for(e=e.previous;e&&i(e);)e=e.previous;return e}function i(e){return e.type==CKEDITOR.NODE_TEXT&&!CKEDITOR.tools.trim(e.value)||e.type==CKEDITOR.NODE_ELEMENT&&e.attributes["data-cke-bookmark"]}function r(e){return e&&(e.type==CKEDITOR.NODE_ELEMENT&&e.name in b||e.type==CKEDITOR.NODE_DOCUMENT_FRAGMENT)}function a(e,t){var n=e.children[e.children.length-1];e.children.push(t),t.parent=e,n&&(n.next=t,t.previous=n)}function s(e){"false"!=(e=e.attributes).contenteditable&&(e["data-cke-editable"]=e.contenteditable?"true":1),e.contenteditable="false"}function l(e){switch((e=e.attributes)["data-cke-editable"]){case"true":e.contenteditable="true";break;case"1":delete e.contenteditable}}function u(e,t){return e.replace(t,(function(e,t,n){return 0===e.indexOf("<textarea")&&(e=t+h(n).replace(/</g,"&lt;").replace(/>/g,"&gt;")+"</textarea>"),"<cke:encoded>"+encodeURIComponent(e)+"</cke:encoded>"}))}function c(e){return e.replace(R,(function(e,t){return decodeURIComponent(t)}))}function d(e){return CKEDITOR.tools.array.reduce(e.split(""),(function(e,t){var n=t.toLowerCase(),o=t.toUpperCase(),i=f(n);return n!==o&&(i+="|"+f(o)),e+"("+i+")"}),"")}function f(e){var t,n=(t=e.charCodeAt(0)).toString(16);for(var o in t={htmlCode:"&#"+t+";?",hex:"&#x0*"+n+";?",entity:{"<":"&lt;",">":"&gt;",":":"&colon;"}[e]})t[o]&&(e+="|"+t[o]);return e}function h(e){return e.replace(/\x3c!--\{cke_protected\}\{C\}([\s\S]+?)--\x3e/g,(function(e,t){return decodeURIComponent(t)}))}function g(e,t){var n=t._.dataStore;return e.replace(/\x3c!--\{cke_protected\}([\s\S]+?)--\x3e/g,(function(e,t){return decodeURIComponent(t)})).replace(/\{cke_protected_(\d+)\}/g,(function(e,t){return n&&n[t]||""}))}CKEDITOR.htmlDataProcessor=function(n){var o,i,r=this;this.editor=n,this.dataFilter=o=new CKEDITOR.htmlParser.filter,this.htmlFilter=i=new CKEDITOR.htmlParser.filter,this.writer=new CKEDITOR.htmlParser.basicWriter,o.addRules(C),o.addRules(T,{applyToAll:!0}),o.addRules(e(n,"data"),{applyToAll:!0}),i.addRules(x),i.addRules(E,{applyToAll:!0}),i.addRules(e(n,"html"),{applyToAll:!0}),n.on("toHtml",(function(e){var o,i,r=function(e,t){var n=[],o=t.config.protectedSource,i=t._.dataStore||(t._.dataStore={id:1}),r=/<\!--\{cke_temp(comment)?\}(\d*?)--\x3e/g;o=[/<script[\s\S]*?(<\/script>|$)/gi,/<noscript[\s\S]*?<\/noscript>/gi,/<meta[\s\S]*?\/?>/gi].concat(o),e=e.replace(/\x3c!--[\s\S]*?--\x3e/g,(function(e){return"\x3c!--{cke_tempcomment}"+(n.push(e)-1)+"--\x3e"}));for(var a=0;a<o.length;a++)e=e.replace(o[a],(function(e){return e=e.replace(r,(function(e,t,o){return n[o]})),/cke_temp(comment)?/.test(e)?e:"\x3c!--{cke_temp}"+(n.push(e)-1)+"--\x3e"}));return(e=(e=e.replace(r,(function(e,t,o){return"\x3c!--"+p+(t?"{C}":"")+encodeURIComponent(n[o]).replace(/--/g,"%2D%2D")+"--\x3e"}))).replace(/<\w+(?:\s+(?:(?:[^\s=>]+\s*=\s*(?:[^'"\s>]+|'[^']*'|"[^"]*"))|[^\s=\/>]+))+\s*\/?>/g,(function(e){return e.replace(/\x3c!--\{cke_protected\}([^>]*)--\x3e/g,(function(e,t){return i[i.id]=decodeURIComponent(t),"{cke_protected_"+i.id+++"}"}))}))).replace(/<(title|iframe|textarea)([^>]*)>([\s\S]*?)<\/\1>/g,(function(e,n,o,i){return"<"+n+o+">"+g(h(i),t)+"</"+n+">"}))}(r=(r=(e=e.data).dataValue).replace(S,""),n);r=u(r,w),r=(r=(r=(r=(r=u(r=function(e){return e.replace(_,(function(e,t,n){return"<"+t+n.replace(I,(function(e,t){return D.test(t)&&-1==n.indexOf("data-cke-saved-"+t)?" data-cke-saved-"+e+" data-cke-"+CKEDITOR.rnd+"-"+e:e}))+">"}))}(r),O)).replace(k,"$1cke:$2")).replace(N,"<cke:$1$2></cke:$1>")).replace(/(<pre\b[^>]*>)(\r\n|\n)/g,"$1$2$2")).replace(/([^a-z0-9<\-])(on\w{3,})(?!>)/gi,"$1data-cke-"+CKEDITOR.rnd+"-$2"),o=e.context||n.editable().getName(),CKEDITOR.env.ie&&9>CKEDITOR.env.version&&"pre"==o&&(o="div",r="<pre>"+r+"</pre>",i=1),(o=n.document.createElement(o)).setHtml("a"+r),r=(r=o.getHtml().substr(1)).replace(new RegExp("data-cke-"+CKEDITOR.rnd+"-","ig"),""),i&&(r=r.replace(/^<pre>|<\/pre>$/gi,"")),r=h(r=c(r=r.replace(A,"$1$2"))),o=!1!==e.fixForBody&&t(e.enterMode,n.config.autoParagraph),r=CKEDITOR.htmlParser.fragment.fromHtml(r,e.context,o),o&&!(i=r).children.length&&CKEDITOR.dtd[i.name][o]&&(o=new CKEDITOR.htmlParser.element(o),i.add(o)),e.dataValue=r}),null,null,5),n.on("toHtml",(function(e){e.data.filter.applyTo(e.data.dataValue,!0,e.data.dontFilter,e.data.enterMode)&&n.fire("dataFiltered")}),null,null,6),n.on("toHtml",(function(e){e.data.dataValue.filterChildren(r.dataFilter,!0)}),null,null,10),n.on("toHtml",(function(e){var t=(e=e.data).dataValue,n=new CKEDITOR.htmlParser.basicWriter;t.writeChildrenHtml(n),t=n.getHtml(!0),e.dataValue=function(e){return e.replace(/\x3c!--(?!{cke_protected})[\s\S]+?--\x3e/g,(function(e){return"\x3c!--"+p+"{C}"+encodeURIComponent(e).replace(/--/g,"%2D%2D")+"--\x3e"}))}(t)}),null,null,15),n.on("toDataFormat",(function(e){var o=e.data.dataValue;e.data.enterMode!=CKEDITOR.ENTER_BR&&(o=o.replace(/^<br *\/?>/i,"")),e.data.dataValue=CKEDITOR.htmlParser.fragment.fromHtml(o,e.data.context,t(e.data.enterMode,n.config.autoParagraph))}),null,null,5),n.on("toDataFormat",(function(e){e.data.dataValue.filterChildren(r.htmlFilter,!0)}),null,null,10),n.on("toDataFormat",(function(e){e.data.filter.applyTo(e.data.dataValue,!1,!0)}),null,null,11),n.on("toDataFormat",(function(e){var t=e.data.dataValue,o=r.writer;o.reset(),t.writeChildrenHtml(o),t=g(t=h(t=o.getHtml(!0)),n),e.data.dataValue=t}),null,null,15)},CKEDITOR.htmlDataProcessor.prototype={toHtml:function(e,t,n,o){var i,r,a,s,l=this.editor;return t&&"object"==typeof t?(i=t.context,n=t.fixForBody,o=t.dontFilter,r=t.filter,a=t.enterMode,s=t.protectedWhitespaces):i=t,i||null===i||(i=l.editable().getName()),l.fire("toHtml",{dataValue:e,context:i,fixForBody:n,dontFilter:o,filter:r||l.filter,enterMode:a||l.enterMode,protectedWhitespaces:s}).dataValue},toDataFormat:function(e,t){var n,o,i;return t&&(n=t.context,o=t.filter,i=t.enterMode),n||null===n||(n=this.editor.editable().getName()),this.editor.fire("toDataFormat",{dataValue:e,filter:o||this.editor.filter,context:n,enterMode:i||this.editor.enterMode}).dataValue}};var m=/(?:&nbsp;|\xa0)$/,p="{cke_protected}",v=CKEDITOR.dtd,y="caption colgroup col thead tfoot tbody".split(" "),b=CKEDITOR.tools.extend({},v.$blockLimit,v.$block),C={elements:{input:s,textarea:s}},T={attributeNames:[[/^on/,"data-cke-pa-on"],[/^srcdoc/,"data-cke-pa-srcdoc"],[/^data-cke-expando$/,""]],elements:{iframe:function(e){if(e.attributes&&e.attributes.src){var t=e.attributes.src.toLowerCase().replace(/[^a-z]/gi,"");0!==t.indexOf("javascript")&&0!==t.indexOf("data")||(e.attributes["data-cke-pa-src"]=e.attributes.src,delete e.attributes.src)}}}},x={elements:{embed:function(e){if((n=e.parent)&&"object"==n.name){var t=n.attributes.width,n=n.attributes.height;t&&(e.attributes.width=t),n&&(e.attributes.height=n)}},a:function(e){var t=e.attributes;if(!(e.children.length||t.name||t.id||e.attributes["data-cke-saved-name"]))return!1}}},E={elementNames:[[/^cke:/,""],[/^\?xml:namespace$/,""]],attributeNames:[[/^data-cke-(saved|pa)-/,""],[/^data-cke-.*/,""],["hidefocus",""]],elements:{$:function(e){var t=e.attributes;if(t){if(t["data-cke-temp"])return!1;for(var n=["name","href","src"],o=0;o<n.length;o++)"data-cke-saved-"+n[o]in t&&delete t[n[o]]}return e},table:function(e){e.children.slice(0).sort((function(e,t){var n,o;return e.type==CKEDITOR.NODE_ELEMENT&&t.type==e.type&&(n=CKEDITOR.tools.indexOf(y,e.name),o=CKEDITOR.tools.indexOf(y,t.name)),-1<n&&-1<o&&n!=o||(n=e.parent?e.getIndex():-1,o=t.parent?t.getIndex():-1),n>o?1:-1}))},param:function(e){return e.children=[],e.isEmpty=!0,e},span:function(e){"Apple-style-span"==e.attributes.class&&delete e.name},html:function(e){delete e.attributes.contenteditable,delete e.attributes.class},body:function(e){delete e.attributes.spellcheck,delete e.attributes.contenteditable},style:function(e){var t=e.children[0];t&&t.value&&(t.value=CKEDITOR.tools.trim(t.value)),e.attributes.type||(e.attributes.type="text/css")},title:function(e){var t=e.children[0];!t&&a(e,t=new CKEDITOR.htmlParser.text),t.value=e.attributes["data-cke-title"]||""},input:l,textarea:l},attributes:{class:function(e){return CKEDITOR.tools.ltrim(e.replace(/(?:^|\s+)cke_[^\s]*/g,""))||!1}}};CKEDITOR.env.ie&&(E.attributes.style=function(e){return e.replace(/(^|;)([^\:]+)/g,(function(e){return e.toLowerCase()}))});var _=/<(a|area|img|input|source)\b([^>]*)>/gi,I=/([\w-:]+)\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|(?:[^ "'>]+))/gi,D=/^(href|src|name)$/i,O=/(?:<style(?=[ >])[^>]*>[\s\S]*?<\/style>)|(?:<(:?link|meta|base)[^>]*>)/gi,w=/(<textarea(?=[ >])[^>]*>)([\s\S]*?)(?:<\/textarea>)/gi,R=/<cke:encoded>([^<]*)<\/cke:encoded>/gi,S=new RegExp("("+d("<cke:encoded>")+"(.*?)"+d("</cke:encoded>")+")|("+d("<")+d("/")+"?"+d("cke:encoded>")+")","gi"),k=/(<\/?)((?:object|embed|param|html|body|head|title)([\s][^>]*)?>)/gi,A=/(<\/?)cke:((?:html|body|head|title)[^>]*>)/gi,N=/<cke:(param|embed)([^>]*?)\/?>(?!\s*<\/cke:\1)/gi}(),CKEDITOR.htmlParser.element=function(e,t){this.name=e,this.attributes=t||{},this.children=[];var n=e||"",o=n.match(/^cke:(.*)/);o&&(n=o[1]),n=!!(CKEDITOR.dtd.$nonBodyContent[n]||CKEDITOR.dtd.$block[n]||CKEDITOR.dtd.$listItem[n]||CKEDITOR.dtd.$tableContent[n]||CKEDITOR.dtd.$nonEditable[n]||"br"==n),this.isEmpty=!!CKEDITOR.dtd.$empty[e],this.isUnknown=!CKEDITOR.dtd[e],this._={isBlockLike:n,hasInlineStarted:this.isEmpty||!n}},CKEDITOR.htmlParser.cssStyle=function(e){var t={};return((e instanceof CKEDITOR.htmlParser.element?e.attributes.style:e)||"").replace(/&quot;/g,'"').replace(/\s*([^ :;]+)\s*:\s*([^;]+)\s*(?=;|$)/g,(function(e,n,o){"font-family"==n&&(o=o.replace(/["']/g,"")),t[n.toLowerCase()]=o})),{rules:t,populate:function(e){var t=this.toString();t&&(e instanceof CKEDITOR.dom.element?e.setAttribute("style",t):e instanceof CKEDITOR.htmlParser.element?e.attributes.style=t:e.style=t)},toString:function(){var e,n=[];for(e in t)t[e]&&n.push(e,":",t[e],";");return n.join("")}}},function(){var e=function(e,t){return(e=e[0])<(t=t[0])?-1:e>t?1:0},t=CKEDITOR.htmlParser.fragment.prototype;CKEDITOR.htmlParser.element.prototype=CKEDITOR.tools.extend(new CKEDITOR.htmlParser.node,{type:CKEDITOR.NODE_ELEMENT,add:t.add,clone:function(){return new CKEDITOR.htmlParser.element(this.name,this.attributes)},filter:function(e,t){var n,o,i,r,a=this;for(t=a.getFilterContext(t),a.parent||e.onRoot(t,a);;){if(!(o=e.onElementName(t,n=a.name)))return this.remove(),!1;if(a.name=o,!(a=e.onElement(t,a)))return this.remove(),!1;if(a!==this)return this.replaceWith(a),!1;if(a.name==n)break;if(a.type!=CKEDITOR.NODE_ELEMENT)return this.replaceWith(a),!1;if(!a.name)return this.replaceWithChildren(),!1}for(i in n=a.attributes){for(o=n[i];;){if(!(r=e.onAttributeName(t,i))){delete n[i];break}if(r==i)break;delete n[i],i=r}r&&(!1===(o=e.onAttribute(t,a,r,o))?delete n[r]:n[r]=o)}return a.isEmpty||this.filterChildren(e,!1,t),!0},filterChildren:t.filterChildren,writeHtml:function(t,n){n&&this.filter(n);var o,i,r=this.name,a=[],s=this.attributes;for(o in t.openTag(r,s),s)a.push([o,s[o]]);for(t.sortAttributes&&a.sort(e),o=0,i=a.length;o<i;o++)t.attribute((s=a[o])[0],s[1]);t.openTagClose(r,this.isEmpty),this.writeChildrenHtml(t),this.isEmpty||t.closeTag(r)},writeChildrenHtml:t.writeChildrenHtml,replaceWithChildren:function(){for(var e=this.children,t=e.length;t;)e[--t].insertAfter(this);this.remove()},forEach:t.forEach,getFirst:function(e){if(!e)return this.children.length?this.children[0]:null;"function"!=typeof e&&(e=function(e){return function(t){return t.type==CKEDITOR.NODE_ELEMENT&&("string"==typeof e?t.name==e:t.name in e)}}(e));for(var t=0,n=this.children.length;t<n;++t)if(e(this.children[t]))return this.children[t];return null},getHtml:function(){var e=new CKEDITOR.htmlParser.basicWriter;return this.writeChildrenHtml(e),e.getHtml()},setHtml:function(e){for(var t=0,n=(e=this.children=CKEDITOR.htmlParser.fragment.fromHtml(e).children).length;t<n;++t)e[t].parent=this},getOuterHtml:function(){var e=new CKEDITOR.htmlParser.basicWriter;return this.writeHtml(e),e.getHtml()},split:function(e){for(var t=this.children.splice(e,this.children.length-e),n=this.clone(),o=0;o<t.length;++o)t[o].parent=n;return n.children=t,t[0]&&(t[0].previous=null),0<e&&(this.children[e-1].next=null),this.parent.add(n,this.getIndex()+1),n},find:function(e,t){void 0===t&&(t=!1);var n,o=[];for(n=0;n<this.children.length;n++){var i=this.children[n];("function"==typeof e&&e(i)||"string"==typeof e&&i.name===e)&&o.push(i),t&&i.find&&(o=o.concat(i.find(e,t)))}return o},findOne:function(e,t){var n=null,o=CKEDITOR.tools.array.find(this.children,(function(o){var i="function"==typeof e?e(o):o.name===e;return i||!t?i:(o.children&&o.findOne&&(n=o.findOne(e,!0)),!!n)}));return n||o||null},addClass:function(e){if(!this.hasClass(e)){var t=this.attributes.class||"";this.attributes.class=t+(t?" ":"")+e}},removeClass:function(e){var t=this.attributes.class;t&&((t=CKEDITOR.tools.trim(t.replace(new RegExp("(?:\\s+|^)"+e+"(?:\\s+|$)")," ")))?this.attributes.class=t:delete this.attributes.class)},hasClass:function(e){var t=this.attributes.class;return!!t&&new RegExp("(?:^|\\s)"+e+"(?=\\s|$)").test(t)},getFilterContext:function(e){var t=[];if(e||(e={nonEditable:!1,nestedEditable:!1}),e.nonEditable||"false"!=this.attributes.contenteditable?e.nonEditable&&!e.nestedEditable&&"true"==this.attributes.contenteditable&&t.push("nestedEditable",!0):t.push("nonEditable",!0),t.length){e=CKEDITOR.tools.copy(e);for(var n=0;n<t.length;n+=2)e[t[n]]=t[n+1]}return e}},!0)}(),function(){var e=/{([^}]+)}/g;CKEDITOR.template=function(e){this.source="function"==typeof e?e:String(e)},CKEDITOR.template.prototype.output=function(t,n){var o=("function"==typeof this.source?this.source(t):this.source).replace(e,(function(e,n){return void 0!==t[n]?t[n]:e}));return n?n.push(o):o}}(),delete CKEDITOR.loadFullCore,CKEDITOR.instances={},CKEDITOR.document=new CKEDITOR.dom.document(document),CKEDITOR.add=function(e){function t(){CKEDITOR.currentInstance==e&&(CKEDITOR.currentInstance=null,CKEDITOR.fire("currentInstance"))}CKEDITOR.instances[e.name]=e,e.on("focus",(function(){CKEDITOR.currentInstance!=e&&(CKEDITOR.currentInstance=e,CKEDITOR.fire("currentInstance"))})),e.on("blur",t),e.on("destroy",t),CKEDITOR.fire("instance",null,e)},CKEDITOR.remove=function(e){delete CKEDITOR.instances[e.name]},function(){var e={};CKEDITOR.addTemplate=function(t,n){var o=e[t];return o||(o={name:t,source:n},CKEDITOR.fire("template",o),e[t]=new CKEDITOR.template(o.source))},CKEDITOR.getTemplate=function(t){return e[t]}}(),function(){var e=[];CKEDITOR.addCss=function(t){e.push(t)},CKEDITOR.getCss=function(){return e.join("\n")}}(),CKEDITOR.on("instanceDestroyed",(function(){CKEDITOR.tools.isEmpty(this.instances)&&CKEDITOR.fire("reset")})),CKEDITOR.TRISTATE_ON=1,CKEDITOR.TRISTATE_OFF=2,CKEDITOR.TRISTATE_DISABLED=0,CKEDITOR.inline=function(e,t){if(!(e=CKEDITOR.editor._getEditorElement(e)))return null;var n=new CKEDITOR.editor(t,e,CKEDITOR.ELEMENT_MODE_INLINE),o=e.is("textarea")?e:null;return o?(n.setData(o.getValue(),null,!0),(e=CKEDITOR.dom.element.createFromHtml('<div contenteditable="'+!!n.readOnly+'" class="cke_textarea_inline">'+o.getValue()+"</div>",CKEDITOR.document)).insertAfter(o),o.hide(),o.$.form&&n._attachToForm()):n.setData(e.getHtml(),null,!0),n.on("loaded",(function(){n.fire("uiReady"),n.editable(e),n.container=e,n.ui.contentsElement=e,n.setData(n.getData(1)),n.resetDirty(),n.fire("contentDom"),n.mode="wysiwyg",n.fire("mode"),n.status="ready",n.fireOnce("instanceReady"),CKEDITOR.fire("instanceReady",null,n)}),null,null,1e4),n.on("destroy",(function(){var e=n.container;o&&e&&(e.clearCustomData(),e.remove()),o&&o.show(),n.element.clearCustomData(),delete n.element})),n},CKEDITOR.inlineAll=function(){var e,t,n;for(n in CKEDITOR.dtd.$editable)for(var o=CKEDITOR.document.getElementsByTag(n),i=0,r=o.count();i<r;i++)"true"==(e=o.getItem(i)).getAttribute("contenteditable")&&(t={element:e,config:{}},!1!==CKEDITOR.fire("inline",t)&&CKEDITOR.inline(e,t.config))},CKEDITOR.domReady((function(){!CKEDITOR.disableAutoInline&&CKEDITOR.inlineAll()})),CKEDITOR.replaceClass="ckeditor",function(){function e(e,n,o,i){if(!(e=CKEDITOR.editor._getEditorElement(e)))return null;var r=new CKEDITOR.editor(n,e,i);return i==CKEDITOR.ELEMENT_MODE_REPLACE&&(e.setStyle("visibility","hidden"),r._.required=e.hasAttribute("required"),e.removeAttribute("required")),o&&r.setData(o,null,!0),r.on("loaded",(function(){r.isDestroyed()||r.isDetached()||(function(e){var t=e.name,n=e.element,o=e.elementMode,i=e.fire("uiSpace",{space:"top",html:""}).html,r=e.fire("uiSpace",{space:"bottom",html:""}).html,a=new CKEDITOR.template('<{outerEl} id="cke_{name}" class="{id} cke cke_reset cke_chrome cke_editor_{name} cke_{langDir} '+CKEDITOR.env.cssClass+'"  dir="{langDir}" lang="{langCode}" role="application"'+(e.title?' aria-labelledby="cke_{name}_arialbl"':"")+">"+(e.title?'<span id="cke_{name}_arialbl" class="cke_voice_label">{voiceLabel}</span>':"")+'<{outerEl} class="cke_inner cke_reset" role="presentation">{topHtml}<{outerEl} id="{contentId}" class="cke_contents cke_reset" role="presentation"></{outerEl}>{bottomHtml}</{outerEl}></{outerEl}>');t=CKEDITOR.dom.element.createFromHtml(a.output({id:e.id,name:t,langDir:e.lang.dir,langCode:e.langCode,voiceLabel:e.title,topHtml:i?'<span id="'+e.ui.spaceId("top")+'" class="cke_top cke_reset_all" role="presentation" style="height:auto">'+i+"</span>":"",contentId:e.ui.spaceId("contents"),bottomHtml:r?'<span id="'+e.ui.spaceId("bottom")+'" class="cke_bottom cke_reset_all" role="presentation">'+r+"</span>":"",outerEl:CKEDITOR.env.ie?"span":"div"})),o==CKEDITOR.ELEMENT_MODE_REPLACE?(n.hide(),t.insertAfter(n)):n.append(t),e.container=t,e.ui.contentsElement=e.ui.space("contents"),i&&e.ui.space("top").unselectable(),r&&e.ui.space("bottom").unselectable(),o=e.config.height,(n=e.config.width)&&t.setStyle("width",CKEDITOR.tools.cssLength(n)),o&&e.ui.space("contents").setStyle("height",CKEDITOR.tools.cssLength(o)),t.disableContextMenu(),CKEDITOR.env.webkit&&t.on("focus",(function(){e.focus()})),e.fireOnce("uiReady")}(r),i==CKEDITOR.ELEMENT_MODE_REPLACE&&r.config.autoUpdateElement&&e.$.form&&r._attachToForm(),r.setMode(r.config.startupMode,(function(){r.resetDirty(),r.status="ready",r.fireOnce("instanceReady"),CKEDITOR.fire("instanceReady",null,r)})))})),r.on("destroy",t),r}function t(){var e=this.container,t=this.element;e&&(e.clearCustomData(),e.remove()),t&&(t.clearCustomData(),this.elementMode==CKEDITOR.ELEMENT_MODE_REPLACE&&(t.show(),this._.required&&t.setAttribute("required","required")),delete this.element)}CKEDITOR.replace=function(t,n){return e(t,n,null,CKEDITOR.ELEMENT_MODE_REPLACE)},CKEDITOR.appendTo=function(t,n,o){return e(t,n,o,CKEDITOR.ELEMENT_MODE_APPENDTO)},CKEDITOR.replaceAll=function(){for(var e=document.getElementsByTagName("textarea"),t=0;t<e.length;t++){var n=null,o=e[t];if(o.name||o.id){if("string"==typeof arguments[0]){if(!new RegExp("(?:^|\\s)"+arguments[0]+"(?:$|\\s)").test(o.className))continue}else if("function"==typeof arguments[0]&&!1===arguments[0](o,n={}))continue;this.replace(o,n)}}},CKEDITOR.editor.prototype.addMode=function(e,t){(this._.modes||(this._.modes={}))[e]=t},CKEDITOR.editor.prototype.setMode=function(e,t){var n=this,o=this._.modes;if(e!=n.mode&&o&&o[e]){if(n.fire("beforeSetMode",e),n.mode){var i,r=n.checkDirty(),a=(o=n._.previousModeData,0);n.fire("beforeModeUnload"),n.editable(0),n._.previousMode=n.mode,n._.previousModeData=i=n.getData(1),"source"==n.mode&&o==i&&(n.fire("lockSnapshot",{forceUpdate:!0}),a=1),n.ui.space("contents").setHtml(""),n.mode=""}else n._.previousModeData=n.getData(1);this._.modes[e]((function(){n.mode=e,void 0!==r&&!r&&n.resetDirty(),a?n.fire("unlockSnapshot"):"wysiwyg"==e&&n.fire("saveSnapshot"),setTimeout((function(){n.isDestroyed()||n.isDetached()||(n.fire("mode"),t&&t.call(n))}),0)}))}},CKEDITOR.editor.prototype.resize=function(e,t,n,o){var i=this.container,r=this.ui.space("contents"),a=CKEDITOR.env.webkit&&this.document&&this.document.getWindow().$.frameElement;(o=o?this.container.getFirst((function(e){return e.type==CKEDITOR.NODE_ELEMENT&&e.hasClass("cke_inner")})):i).setSize("width",e,!0),a&&(a.style.width="1%");var s=(o.$.offsetHeight||0)-(r.$.clientHeight||0);i=Math.max(t-(n?0:s),0),t=n?t+s:t,r.setStyle("height",i+"px"),a&&(a.style.width="100%"),this.fire("resize",{outerHeight:t,contentsHeight:i,outerWidth:e||o.getSize("width")})},CKEDITOR.editor.prototype.getResizable=function(e){return e?this.ui.space("contents"):this.container},CKEDITOR.domReady((function(){CKEDITOR.replaceClass&&CKEDITOR.replaceAll(CKEDITOR.replaceClass)}))}(),CKEDITOR.config.startupMode="wysiwyg",function(){function e(e){var t,o=e.editor,i=e.data.path,a=i.blockLimit,s=e.data.selection,l=s.getRanges()[0];(CKEDITOR.env.gecko||CKEDITOR.env.ie&&CKEDITOR.env.needsBrFiller)&&(s=function(e,t){if(e.isFake)return 0;var o=t.block||t.blockLimit,i=o&&o.getLast(n);return!o||!o.isBlockBoundary()||i&&i.type==CKEDITOR.NODE_ELEMENT&&i.isBlockBoundary()||o.is("pre")||o.getBogus()?void 0:o}(s,i))&&(s.appendBogus(),t=CKEDITOR.env.ie&&!CKEDITOR.env.edge||CKEDITOR.env.edge&&o._.previousActive),r(o,i.block,a)&&l.collapsed&&!l.getCommonAncestor().isReadOnly()&&((i=l.clone()).enlarge(CKEDITOR.ENLARGE_BLOCK_CONTENTS),(a=new CKEDITOR.dom.walker(i)).guard=function(e){return!n(e)||e.type==CKEDITOR.NODE_COMMENT||e.isReadOnly()},!a.checkForward()||i.checkStartOfBlock()&&i.checkEndOfBlock())&&(o=l.fixBlock(!0,o.activeEnterMode==CKEDITOR.ENTER_DIV?"div":"p"),CKEDITOR.env.needsBrFiller||(o=o.getFirst(n))&&o.type==CKEDITOR.NODE_TEXT&&CKEDITOR.tools.trim(o.getText()).match(/^(?:&nbsp;|\xa0)$/)&&o.remove(),t=1,e.cancel()),t&&l.select()}function t(e){var t=e.data.getTarget();t.is("input")&&("submit"!=(t=t.getAttribute("type"))&&"reset"!=t||e.data.preventDefault())}function n(e){return c(e)&&d(e)}function o(e,t){return function(n){var o=n.data.$.toElement||n.data.$.fromElement||n.data.$.relatedTarget;(o=o&&o.nodeType==CKEDITOR.NODE_ELEMENT?new CKEDITOR.dom.element(o):null)&&(t.equals(o)||t.contains(o))||e.call(this,n)}}function i(e){function t(e){return function(t,i){if(i&&t.type==CKEDITOR.NODE_ELEMENT&&t.is(r)&&(o=t),!(i||!n(t)||e&&h(t)))return!1}}var o,i=e.getRanges()[0];e=e.root;var r={table:1,ul:1,ol:1,dl:1};if(i.startPath().contains(r)){var a=i.clone();if(a.collapse(1),a.setStartAt(e,CKEDITOR.POSITION_AFTER_START),(e=new CKEDITOR.dom.walker(a)).guard=t(),e.checkBackward(),o)return(a=i.clone()).collapse(),a.setEndAt(o,CKEDITOR.POSITION_AFTER_END),(e=new CKEDITOR.dom.walker(a)).guard=t(!0),o=!1,e.checkForward(),o}return null}function r(e,t,n){return!1!==e.config.autoParagraph&&e.activeEnterMode!=CKEDITOR.ENTER_BR&&(e.editable().equals(n)&&!t||t&&"true"==t.getAttribute("contenteditable"))}function a(e){return e.activeEnterMode!=CKEDITOR.ENTER_BR&&!1!==e.config.autoParagraph&&(e.activeEnterMode==CKEDITOR.ENTER_DIV?"div":"p")}function s(e){e&&e.isEmptyInlineRemoveable()&&e.remove()}function l(e){var t=e.editor;t.getSelection().scrollIntoView(),setTimeout((function(){t.fire("saveSnapshot")}),0)}function u(e,t,n){var o=e.getCommonAncestor(t);for(t=e=n?t:e;(e=e.getParent())&&!o.equals(e)&&1==e.getChildCount();)t=e;t.remove()}var c,d,f,h,g,m,p,v,y,b;CKEDITOR.editable=CKEDITOR.tools.createClass({base:CKEDITOR.dom.element,$:function(e,t){this.base(t.$||t),this.editor=e,this.status="unloaded",this.hasFocus=!1,this.setup()},proto:{focus:function(){var e;if(CKEDITOR.env.webkit&&!this.hasFocus&&(e=this.editor._.previousActive||this.getDocument().getActive(),this.contains(e)))e.focus();else{CKEDITOR.env.edge&&14<CKEDITOR.env.version&&!this.hasFocus&&this.getDocument().equals(CKEDITOR.document)&&(this.editor._.previousScrollTop=this.$.scrollTop);try{if(!CKEDITOR.env.ie||CKEDITOR.env.edge&&14<CKEDITOR.env.version||!this.getDocument().equals(CKEDITOR.document))if(CKEDITOR.env.chrome){var t=this.$.scrollTop;this.$.focus(),this.$.scrollTop=t}else this.$.focus();else this.$.setActive()}catch(n){if(!CKEDITOR.env.ie)throw n}CKEDITOR.env.safari&&!this.isInline()&&((e=CKEDITOR.document.getActive()).equals(this.getWindow().getFrame())||this.getWindow().focus())}},on:function(e,t){var n=Array.prototype.slice.call(arguments,0);return CKEDITOR.env.ie&&/^focus|blur$/.exec(e)&&(e="focus"==e?"focusin":"focusout",t=o(t,this),n[0]=e,n[1]=t),CKEDITOR.dom.element.prototype.on.apply(this,n)},attachListener:function(e){!this._.listeners&&(this._.listeners=[]);var t=Array.prototype.slice.call(arguments,1);return t=e.on.apply(e,t),this._.listeners.push(t),t},clearListeners:function(){var e=this._.listeners;try{for(;e.length;)e.pop().removeListener()}catch(t){}},restoreAttrs:function(){var e,t,n=this._.attrChanges;for(t in n)n.hasOwnProperty(t)&&(null!==(e=n[t])?this.setAttribute(t,e):this.removeAttribute(t))},attachClass:function(e){var t=this.getCustomData("classes");this.hasClass(e)||(!t&&(t=[]),t.push(e),this.setCustomData("classes",t),this.addClass(e))},changeAttr:function(e,t){var n=this.getAttribute(e);t!==n&&(!this._.attrChanges&&(this._.attrChanges={}),e in this._.attrChanges||(this._.attrChanges[e]=n),this.setAttribute(e,t))},insertText:function(e){this.editor.focus(),this.insertHtml(this.transformPlainTextToHtml(e),"text")},transformPlainTextToHtml:function(e){var t=this.editor.getSelection().getStartElement().hasAscendant("pre",!0)?CKEDITOR.ENTER_BR:this.editor.activeEnterMode;return CKEDITOR.tools.transformPlainTextToHtml(e,t)},insertHtml:function(e,t,n){var o=this.editor;o.focus(),o.fire("saveSnapshot"),n||(n=o.getSelection().getRanges()[0]),m(this,t||"html",e,n),n.select(),l(this),this.editor.fire("afterInsertHtml",{})},insertHtmlIntoRange:function(e,t,n){m(this,n||"html",e,t),this.editor.fire("afterInsertHtml",{intoRange:t})},insertElement:function(e,t){(i=this.editor).focus(),i.fire("saveSnapshot");var o=i.activeEnterMode,i=i.getSelection(),r=e.getName();r=CKEDITOR.dtd.$block[r],t||(t=i.getRanges()[0]),this.insertElementIntoRange(e,t)&&(t.moveToPosition(e,CKEDITOR.POSITION_AFTER_END),r&&((r=e.getNext((function(e){return n(e)&&!h(e)})))&&r.type==CKEDITOR.NODE_ELEMENT&&r.is(CKEDITOR.dtd.$block)?r.getDtd()["#"]?t.moveToElementEditStart(r):t.moveToElementEditEnd(e):r||o==CKEDITOR.ENTER_BR||(r=t.fixBlock(!0,o==CKEDITOR.ENTER_DIV?"div":"p"),t.moveToElementEditStart(r)))),i.selectRanges([t]),l(this)},insertElementIntoSelection:function(e){this.insertElement(e)},insertElementIntoRange:function(e,t){var n,o,i=this.editor,r=i.config.enterMode,a=e.getName(),l=CKEDITOR.dtd.$block[a];if(t.checkReadOnly())return!1;if(t.deleteContents(1),t.startContainer.type==CKEDITOR.NODE_ELEMENT&&(t.startContainer.is({tr:1,table:1,tbody:1,thead:1,tfoot:1})?p(t):t.startContainer.is(CKEDITOR.dtd.$list)&&v(t)),l)for(;(n=t.getCommonAncestor(0,1))&&(o=CKEDITOR.dtd[n.getName()])&&(!o||!o[a]);)if(n.getName()in CKEDITOR.dtd.span){l=t.splitElement(n);var u=t.createBookmark();s(n),s(l),t.moveToBookmark(u)}else t.checkStartOfBlock()&&t.checkEndOfBlock()?(t.setStartBefore(n),t.collapse(!0),n.remove()):t.splitBlock(r==CKEDITOR.ENTER_DIV?"div":"p",i.editable());return t.insertNode(e),!0},setData:function(e,t){t||(e=this.editor.dataProcessor.toHtml(e)),this.setHtml(e),this.fixInitialSelection(),"unloaded"==this.status&&(this.status="ready"),this.editor.fire("dataReady")},getData:function(e){var t=this.getHtml();return e||(t=this.editor.dataProcessor.toDataFormat(t)),t},setReadOnly:function(e){this.setAttribute("contenteditable",!e)},detach:function(){this.status="detached",this.editor.setData(this.editor.getData(),{internal:!0}),this.clearListeners();try{this._.cleanCustomData()}catch(e){if(!CKEDITOR.env.ie||-2146828218!==e.number)throw e}this.editor.fire("contentDomUnload"),delete this.editor.document,delete this.editor.window,delete this.editor},isInline:function(){return this.getDocument().equals(CKEDITOR.document)},fixInitialSelection:function(){function e(){var e,n=t.getDocument().$,o=n.getSelection();e:if(o.anchorNode&&o.anchorNode==t.$)e=!0;else{if(CKEDITOR.env.webkit&&(e=t.getDocument().getActive())&&e.equals(t)&&!o.anchorNode){e=!0;break e}e=void 0}e&&((e=new CKEDITOR.dom.range(t)).moveToElementEditStart(t),(n=n.createRange()).setStart(e.startContainer.$,e.startOffset),n.collapse(!0),o.removeAllRanges(),o.addRange(n))}var t=this;CKEDITOR.env.ie&&(9>CKEDITOR.env.version||CKEDITOR.env.quirks)?this.hasFocus&&(this.focus(),function(){var e=t.getDocument().$,n=e.selection,o=t.getDocument().getActive();"None"==n.type&&o.equals(t)&&(n=new CKEDITOR.dom.range(t),e=e.body.createTextRange(),n.moveToElementEditStart(t),(n=n.startContainer).type!=CKEDITOR.NODE_ELEMENT&&(n=n.getParent()),e.moveToElementText(n.$),e.collapse(!0),e.select())}()):this.hasFocus?(this.focus(),e()):this.once("focus",(function(){e()}),null,null,-999)},getHtmlFromRange:function(e){return e.collapsed?new CKEDITOR.dom.documentFragment(e.document):(e={doc:this.getDocument(),range:e.clone()},y.eol.detect(e,this),y.bogus.exclude(e),y.cell.shrink(e),e.fragment=e.range.cloneContents(),y.tree.rebuild(e,this),y.eol.fix(e,this),new CKEDITOR.dom.documentFragment(e.fragment.$))},extractHtmlFromRange:function(e,t){var n=b,o={range:e,doc:e.document},i=this.getHtmlFromRange(e);if(e.collapsed)return e.optimize(),i;if(e.enlarge(CKEDITOR.ENLARGE_INLINE,1),n.table.detectPurge(o),o.bookmark=e.createBookmark(),delete o.range,(a=this.editor.createRange()).moveToPosition(o.bookmark.startNode,CKEDITOR.POSITION_BEFORE_START),o.targetBookmark=a.createBookmark(),n.list.detectMerge(o,this),n.table.detectRanges(o,this),n.block.detectMerge(o,this),o.tableContentsRanges?(n.table.deleteRanges(o),e.moveToBookmark(o.bookmark),o.range=e):(e.moveToBookmark(o.bookmark),o.range=e,e.extractContents(n.detectExtractMerge(o))),e.moveToBookmark(o.targetBookmark),e.optimize(),n.fixUneditableRangePosition(e),n.list.merge(o,this),n.table.purge(o,this),n.block.merge(o,this),t){if(n=e.startPath(),o=e.checkStartOfBlock()&&e.checkEndOfBlock()&&n.block&&!e.root.equals(n.block)){e:{var r,a=0;if(o=n.block.getElementsByTag("span"))for(;r=o.getItem(a++);)if(!d(r)){o=!0;break e}o=!1}o=!o}o&&(e.moveToPosition(n.block,CKEDITOR.POSITION_BEFORE_START),n.block.remove())}else n.autoParagraph(this.editor,e),f(e.startContainer)&&e.startContainer.appendBogus();return e.startContainer.mergeSiblings(),i},setup:function(){var e=this.editor;if(this.attachListener(e,"beforeGetData",(function(){var t=this.getData();this.is("textarea")||!1!==e.config.ignoreEmptyParagraph&&(t=t.replace(g,(function(e,t){return t}))),e.setData(t,null,1)}),this),this.attachListener(e,"getSnapshot",(function(e){e.data=this.getData(1)}),this),this.attachListener(e,"afterSetData",(function(){this.setData(e.getData(1))}),this),this.attachListener(e,"loadSnapshot",(function(e){this.setData(e.data,1)}),this),this.attachListener(e,"beforeFocus",(function(){var t=e.getSelection();(t=t&&t.getNative())&&"Control"==t.type||this.focus()}),this),this.attachListener(e,"insertHtml",(function(e){this.insertHtml(e.data.dataValue,e.data.mode,e.data.range)}),this),this.attachListener(e,"insertElement",(function(e){this.insertElement(e.data)}),this),this.attachListener(e,"insertText",(function(e){this.insertText(e.data)}),this),this.setReadOnly(e.readOnly),this.attachClass("cke_editable"),e.elementMode==CKEDITOR.ELEMENT_MODE_INLINE?this.attachClass("cke_editable_inline"):e.elementMode!=CKEDITOR.ELEMENT_MODE_REPLACE&&e.elementMode!=CKEDITOR.ELEMENT_MODE_APPENDTO||this.attachClass("cke_editable_themed"),this.attachClass("cke_contents_"+e.config.contentsLangDirection),e.keystrokeHandler.blockedKeystrokes[8]=+e.readOnly,e.keystrokeHandler.attach(this),this.on("blur",(function(){this.hasFocus=!1}),null,null,-1),this.on("focus",(function(){this.hasFocus=!0}),null,null,-1),CKEDITOR.env.webkit&&this.on("scroll",(function(){e._.previousScrollTop=e.editable().$.scrollTop}),null,null,-1),CKEDITOR.env.edge&&14<CKEDITOR.env.version){var o=function(){var t=e.editable();null!=e._.previousScrollTop&&t.getDocument().equals(CKEDITOR.document)&&(t.$.scrollTop=e._.previousScrollTop,e._.previousScrollTop=null,this.removeListener("scroll",o))};this.on("scroll",o)}if(e.focusManager.add(this),this.equals(CKEDITOR.document.getActive())&&(this.hasFocus=!0,e.once("contentDom",(function(){e.focusManager.focus(this)}),this)),this.isInline()&&this.changeAttr("tabindex",e.tabIndex),!this.is("textarea")){e.document=this.getDocument(),e.window=this.getWindow();var r=e.document;this.changeAttr("spellcheck",!e.config.disableNativeSpellChecker);var a=e.config.contentsLangDirection;this.getDirection(1)!=a&&this.changeAttr("dir",a);var s=CKEDITOR.getCss();if(s){var l=(a=r.getHead()).getCustomData("stylesheet");l?s!=l.getText()&&(CKEDITOR.env.ie&&9>CKEDITOR.env.version?l.$.styleSheet.cssText=s:l.setText(s)):(s=r.appendStyleText(s),s=new CKEDITOR.dom.element(s.ownerNode||s.owningElement),a.setCustomData("stylesheet",s),s.data("cke-temp",1))}a=r.getCustomData("stylesheet_ref")||0,r.setCustomData("stylesheet_ref",a+1),this.setCustomData("cke_includeReadonly",!e.config.disableReadonlyStyling),this.attachListener(this,"click",(function(e){e=e.data;var t=new CKEDITOR.dom.elementPath(e.getTarget(),this).contains("a");t&&2!=e.$.button&&t.isReadOnly()&&e.preventDefault()}));var d={8:1,46:1};this.attachListener(e,"key",(function(t){if(e.readOnly)return!0;var n,o=t.data.domEvent.getKey();if(0!==(t=e.getSelection()).getRanges().length){if(o in d){var r,a,s,l,u=t.getRanges()[0],f=u.startPath();o=8==o,CKEDITOR.env.ie&&11>CKEDITOR.env.version&&(r=t.getSelectedElement())||(r=i(t))?(e.fire("saveSnapshot"),u.moveToPosition(r,CKEDITOR.POSITION_BEFORE_START),r.remove(),u.select(),e.fire("saveSnapshot"),n=1):u.collapsed&&((a=f.block)&&(l=a[o?"getPrevious":"getNext"](c))&&l.type==CKEDITOR.NODE_ELEMENT&&l.is("table")&&u[o?"checkStartOfBlock":"checkEndOfBlock"]()?(e.fire("saveSnapshot"),u[o?"checkEndOfBlock":"checkStartOfBlock"]()&&a.remove(),u["moveToElementEdit"+(o?"End":"Start")](l),u.select(),e.fire("saveSnapshot"),n=1):f.blockLimit&&f.blockLimit.is("td")&&(s=f.blockLimit.getAscendant("table"))&&u.checkBoundaryOfElement(s,o?CKEDITOR.START:CKEDITOR.END)&&(l=s[o?"getPrevious":"getNext"](c))?(e.fire("saveSnapshot"),u["moveToElementEdit"+(o?"End":"Start")](l),u.checkStartOfBlock()&&u.checkEndOfBlock()?l.remove():u.select(),e.fire("saveSnapshot"),n=1):(s=f.contains(["td","th","caption"]))&&u.checkBoundaryOfElement(s,o?CKEDITOR.START:CKEDITOR.END)&&(n=1))}return!n}})),e.blockless&&CKEDITOR.env.ie&&CKEDITOR.env.needsBrFiller&&this.attachListener(this,"keyup",(function(t){t.data.getKeystroke()in d&&!this.getFirst(n)&&(this.appendBogus(),(t=e.createRange()).moveToPosition(this,CKEDITOR.POSITION_AFTER_START),t.select())})),this.attachListener(this,"dblclick",(function(t){if(e.readOnly)return!1;t={element:t.data.getTarget()},e.fire("doubleclick",t)})),CKEDITOR.env.ie&&this.attachListener(this,"click",t),CKEDITOR.env.ie&&!CKEDITOR.env.edge||this.attachListener(this,"mousedown",(function(t){var n=t.data.getTarget();n.is("img","hr","input","textarea","select")&&!n.isReadOnly()&&(e.getSelection().selectElement(n),n.is("input","textarea","select")&&t.data.preventDefault())})),CKEDITOR.env.edge&&this.attachListener(this,"mouseup",(function(t){(t=t.data.getTarget())&&t.is("img")&&!t.isReadOnly()&&e.getSelection().selectElement(t)})),CKEDITOR.env.gecko&&this.attachListener(this,"mouseup",(function(t){if(2==t.data.$.button&&!(t=t.data.getTarget()).getAscendant("table")&&!t.getOuterHtml().replace(g,"")){var n=e.createRange();n.moveToElementEditStart(t),n.select(!0)}})),CKEDITOR.env.webkit&&(this.attachListener(this,"click",(function(e){e.data.getTarget().is("input","select")&&e.data.preventDefault()})),this.attachListener(this,"mouseup",(function(e){e.data.getTarget().is("input","textarea")&&e.data.preventDefault()}))),CKEDITOR.env.webkit&&this.attachListener(e,"key",(function(t){if(e.readOnly)return!0;if((n=t.data.domEvent.getKey())in d&&0!==(t=e.getSelection()).getRanges().length){var n=8==n,o=t.getRanges()[0];if(t=o.startPath(),o.collapsed)e:{var i=t.block;if(i&&o[n?"checkStartOfBlock":"checkEndOfBlock"]()&&o.moveToClosestEditablePosition(i,!n)&&o.collapsed){if(o.startContainer.type==CKEDITOR.NODE_ELEMENT){var r=o.startContainer.getChild(o.startOffset-(n?1:0));if(r&&r.type==CKEDITOR.NODE_ELEMENT&&r.is("hr")){e.fire("saveSnapshot"),r.remove(),t=!0;break e}}var a;!(o=o.startPath().block)||o&&o.contains(i)?t=void 0:(e.fire("saveSnapshot"),(a=(n?o:i).getBogus())&&a.remove(),r=(a=e.getSelection()).createBookmarks(),(n?i:o).moveChildren(n?o:i,!1),t.lastElement.mergeSiblings(),u(i,o,!n),a.selectBookmarks(r),t=!0)}else t=!1}else a=t.block,o=(n=o).endPath().block,a&&o&&!a.equals(o)?(e.fire("saveSnapshot"),(i=a.getBogus())&&i.remove(),n.enlarge(CKEDITOR.ENLARGE_INLINE),n.deleteContents(),o.getParent()&&(o.moveChildren(a,!1),t.lastElement.mergeSiblings(),u(a,o,!0)),(n=e.getSelection().getRanges()[0]).collapse(1),n.optimize(),""===n.startContainer.getHtml()&&n.startContainer.appendBogus(),n.select(),t=!0):t=!1;if(!t)return;return e.getSelection().scrollIntoView(),e.fire("saveSnapshot"),!1}}),this,null,100)}},getUniqueId:function(){var e;try{this._.expandoNumber=e=CKEDITOR.dom.domObject.prototype.getUniqueId.call(this)}catch(t){e=this._&&this._.expandoNumber}return e}},_:{cleanCustomData:function(){this.removeClass("cke_editable"),this.restoreAttrs();for(var e=this.removeCustomData("classes");e&&e.length;)this.removeClass(e.pop());if(!this.is("textarea")){var t=(e=this.getDocument()).getHead();if(t.getCustomData("stylesheet")){var n=e.getCustomData("stylesheet_ref");--n?e.setCustomData("stylesheet_ref",n):(e.removeCustomData("stylesheet_ref"),t.removeCustomData("stylesheet").remove())}}}}}),CKEDITOR.editor.prototype.editable=function(e){var t=this._.editable;return t&&e?0:arguments.length?(e?t=e instanceof CKEDITOR.editable?e:new CKEDITOR.editable(this,e):(t&&t.detach(),t=null),this._.editable=t):t},CKEDITOR.on("instanceLoaded",(function(t){var n=t.editor;n.on("insertElement",(function(e){(e=e.data).type==CKEDITOR.NODE_ELEMENT&&(e.is("input")||e.is("textarea"))&&("false"!=e.getAttribute("contentEditable")&&e.data("cke-editable",e.hasAttribute("contenteditable")?"true":"1"),e.setAttribute("contentEditable",!1))})),n.on("selectionChange",(function(t){if(!n.readOnly){var o=n.getSelection();o&&!o.isLocked&&(o=n.checkDirty(),n.fire("lockSnapshot"),e(t),n.fire("unlockSnapshot"),!o&&n.resetDirty())}}))})),CKEDITOR.on("instanceCreated",(function(e){var t=e.editor;t.on("mode",(function(){var e=t.editable();if(e&&e.isInline()){var n=t.title;if(e.changeAttr("role","textbox"),e.changeAttr("aria-multiline","true"),e.changeAttr("aria-label",n),n&&e.changeAttr("title",n),(i=t.fire("ariaEditorHelpLabel",{}).label)&&(n=this.ui.space(this.elementMode==CKEDITOR.ELEMENT_MODE_INLINE?"top":"contents"))){var o=CKEDITOR.tools.getNextId(),i=CKEDITOR.dom.element.createFromHtml('<span id="'+o+'" class="cke_voice_label">'+i+"</span>");n.append(i),e.changeAttr("aria-describedby",o)}}}))})),CKEDITOR.addCss(".cke_editable{cursor:text}.cke_editable img,.cke_editable input,.cke_editable textarea{cursor:default}"),c=CKEDITOR.dom.walker.whitespaces(!0),d=CKEDITOR.dom.walker.bookmark(!1,!0),f=CKEDITOR.dom.walker.empty(),h=CKEDITOR.dom.walker.bogus(),g=/(^|<body\b[^>]*>)\s*<(p|div|address|h\d|center|pre)[^>]*>\s*(?:<br[^>]*>|&nbsp;|\u00A0|&#160;)?\s*(:?<\/\2>)?\s*(?=$|<\/body>)/gi,m=function(){function e(e){return e.type==CKEDITOR.NODE_ELEMENT}function t(n,o){var i,r=[],a=n.getChildren(),s=a.count(),l=0,c=u[o],d=!n.is(u.$inline)||n.is("br");for(d&&r.push(" ");l<s;l++)e(i=a.getItem(l))&&!i.is(c)?r=r.concat(t(i,o)):r.push(i);return d&&r.push(" "),r}function o(t){return e(t.startContainer)&&t.startContainer.getChild(t.startOffset-1)}function i(t){return t&&e(t)&&(t.is(u.$removeEmpty)||t.is("a")&&!t.isBlockBoundary())}function l(t,n,o,i){var r,a,s=t.clone();s.setEndAt(n,CKEDITOR.POSITION_BEFORE_END),(r=new CKEDITOR.dom.walker(s).next())&&e(r)&&c[r.getName()]&&(a=r.getPrevious())&&e(a)&&!a.getParent().equals(t.startContainer)&&o.contains(a)&&i.contains(r)&&r.isIdentical(a)&&(r.moveChildren(a),r.remove(),l(t,n,o,i))}var u=CKEDITOR.dtd,c={p:1,div:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,ul:1,ol:1,li:1,pre:1,dl:1,blockquote:1},d={p:1,div:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1},f=CKEDITOR.tools.extend({},u.$inline);return delete f.br,function(c,h,g,m){var p=c.editor,v=!1;if("unfiltered_html"==h&&(h="html",v=!0),!m.checkReadOnly()){v=(h={type:h,dontFilter:v,editable:c,editor:p,range:m,blockLimit:I=new CKEDITOR.dom.elementPath(m.startContainer,m.root).blockLimit||m.root,mergeCandidates:[],zombies:[]}).range;var y,b,C,T,x,E,_,I=h.mergeCandidates,D="html"===h.type;if("text"==h.type&&v.shrink(CKEDITOR.SHRINK_ELEMENT,!0,!1)&&(b=CKEDITOR.dom.element.createFromHtml("<span>&nbsp;</span>",v.document),v.insertNode(b),v.setStartAfter(b)),C=new CKEDITOR.dom.elementPath(v.startContainer),h.endPath=T=new CKEDITOR.dom.elementPath(v.endContainer),!v.collapsed){y=T.block||T.blockLimit;var O=v.getCommonAncestor();y&&!y.equals(O)&&!y.contains(O)&&v.checkEndOfBlock()&&h.zombies.push(y),v.deleteContents()}for(;(x=o(v))&&e(x)&&x.isBlockBoundary()&&C.contains(x);)v.moveToPosition(x,CKEDITOR.POSITION_BEFORE_END);for(l(v,h.blockLimit,C,T),b&&(v.setEndBefore(b),v.collapse(),b.remove()),(y=(b=v.startPath()).contains(i,!1,1))&&(E=v.splitElement(y),h.inlineStylesRoot=y,h.inlineStylesPeak=b.lastElement),b=v.createBookmark(),D&&(s(y),s(E)),(y=b.startNode.getPrevious(n))&&e(y)&&i(y)&&I.push(y),(y=b.startNode.getNext(n))&&e(y)&&i(y)&&I.push(y),y=b.startNode;(y=y.getParent())&&i(y);)I.push(y);if(v.moveToBookmark(b),p.enterMode===CKEDITOR.ENTER_DIV&&""===p.getData(!0)&&((p=c.getFirst())&&p.remove(),m.setStartAt(c,CKEDITOR.POSITION_AFTER_START),m.collapse(!0)),c=g){if(c=h.range,"text"==h.type&&h.inlineStylesRoot){for(p=(m=h.inlineStylesPeak).getDocument().createText("{cke-peak}"),E=h.inlineStylesRoot.getParent();!m.equals(E);)p=p.appendTo(m.clone()),m=m.getParent();g=p.getOuterHtml().split("{cke-peak}").join(g)}if(m=h.blockLimit.getName(),/^\s+|\s+$/.test(g)&&"span"in CKEDITOR.dtd[m]&&(g=(M='<span data-cke-marker="1">&nbsp;</span>')+g+M),g=h.editor.dataProcessor.toHtml(g,{context:null,fixForBody:!1,protectedWhitespaces:!!M,dontFilter:h.dontFilter,filter:h.editor.activeFilter,enterMode:h.editor.activeEnterMode}),(m=c.document.createElement("body")).setHtml(g),M&&(m.getFirst().remove(),m.getLast().remove()),(M=c.startPath().block)&&(1!=M.getChildCount()||!M.getBogus()))e:{var w;if(1==m.getChildCount()&&e(w=m.getFirst())&&w.is(d)&&!w.hasAttribute("contenteditable")){for(c=0,E=(M=w.getElementsByTag("*")).count();c<E;c++)if(!(p=M.getItem(c)).is(f))break e;w.moveChildren(w.getParent(1)),w.remove()}}h.dataWrapper=m,c=g}if(c){c=(w=h.range).document,m=h.blockLimit,E=0;var R,S,k,A,N,M=[];for(g=b=0,v=(x=h.endPath.elements[0]).getPosition(p=w.startContainer),I=!(!x.getCommonAncestor(p)||v==CKEDITOR.POSITION_IDENTICAL||v&CKEDITOR.POSITION_CONTAINS+CKEDITOR.POSITION_IS_CONTAINED),function(t,n){function o(t,n){if(n.isBlock&&n.isElement&&!n.node.is("br")&&e(t)&&t.is("br"))return t.remove(),1}var i=n.endContainer.getChild(n.endOffset),r=n.endContainer.getChild(n.endOffset-1);i&&o(i,t[t.length-1]),r&&o(r,t[0])&&(n.setEnd(n.endContainer,n.endOffset-1),n.collapse())}(p=function t(n,o){var i,r,a,s,l=[],c=o.range.startContainer;i=o.range.startPath(),c=u[c.getName()];for(var d=0,f=n.getChildren(),h=f.count(),g=-1,m=-1,p=0,v=i.contains(u.$list);d<h;++d)e(i=f.getItem(d))?(a=i.getName(),v&&a in CKEDITOR.dtd.$list?l=l.concat(t(i,o)):(s=!!c[a],"br"!=a||!i.data("cke-eol")||d&&d!=h-1||(p=(r=d?l[d-1].node:f.getItem(d+1))&&(!e(r)||!r.is("br")),r=r&&e(r)&&u.$block[r.getName()]),-1!=g||s||(g=d),s||(m=d),l.push({isElement:1,isLineBreak:p,isBlock:i.isBlockBoundary(),hasBlockSibling:r,node:i,name:a,allowed:s}),r=p=0)):l.push({isElement:0,node:i,allowed:1});return-1<g&&(l[g].firstNotAllowed=1),-1<m&&(l[m].lastNotAllowed=1),l}(h.dataWrapper,h),w);E<p.length;E++)if((D=(v=p[E]).isLineBreak)&&(D=w,y=m,T=C=void 0,v.hasBlockSibling?D=1:(C=D.startContainer.getAscendant(u.$block,1))&&C.is({div:1,p:1})?(T=C.getPosition(y))==CKEDITOR.POSITION_IDENTICAL||T==CKEDITOR.POSITION_CONTAINS?D=0:(y=D.splitElement(C),D.moveToPosition(y,CKEDITOR.POSITION_AFTER_START),D=1):D=0),D)g=0<E;else{if(D=w.startPath(),!v.isBlock&&r(h.editor,D.block,D.blockLimit)&&(k=a(h.editor))&&((k=c.createElement(k)).appendBogus(),w.insertNode(k),CKEDITOR.env.needsBrFiller&&(R=k.getBogus())&&R.remove(),w.moveToPosition(k,CKEDITOR.POSITION_BEFORE_END)),(D=w.startPath().block)&&!D.equals(S)&&((R=D.getBogus())&&(R.remove(),M.push(D)),S=D),v.firstNotAllowed&&(b=1),b&&v.isElement){for(D=w.startContainer,y=null;D&&!u[D.getName()][v.name];){if(D.equals(m)){D=null;break}y=D,D=D.getParent()}if(D)y&&(A=w.splitElement(y),h.zombies.push(A),h.zombies.push(y));else{y=m.getName(),N=!E,D=E==p.length-1,C=[],T=(y=t(v.node,y)).length,O=0;for(var K=void 0,P=0,L=-1;O<T;O++)" "==(K=y[O])?(P||N&&!O||(C.push(new CKEDITOR.dom.text(" ")),L=C.length),P=1):(C.push(K),P=0);D&&L==C.length&&C.pop(),N=C}}if(N){for(;D=N.pop();)w.insertNode(D);N=0}else w.insertNode(v.node);v.lastNotAllowed&&E<p.length-1&&((A=I?x:A)&&w.setEndAt(A,CKEDITOR.POSITION_AFTER_START),b=0),w.collapse()}(R=1==p.length&&(R=p[0]).isElement&&"false"==R.node.getAttribute("contenteditable"))&&(g=!0,w.setStartAt(D=p[0].node,CKEDITOR.POSITION_BEFORE_START),w.setEndAt(D,CKEDITOR.POSITION_AFTER_END)),h.dontMoveCaret=g,h.bogusNeededBlocks=M}for(A=h.bogusNeededBlocks,N=(R=h.range).createBookmark();S=h.zombies.pop();)S.getParent()&&((k=R.clone()).moveToElementEditStart(S),k.removeEmptyBlocksAtEnd());if(A)for(;S=A.pop();)CKEDITOR.env.needsBrFiller?S.appendBogus():S.append(R.document.createText(" "));for(;S=h.mergeCandidates.pop();)S.mergeSiblings();if(R.moveToBookmark(N),!h.dontMoveCaret){for(S=o(R);S&&e(S)&&!S.is(u.$empty);){if(S.isBlockBoundary())R.moveToPosition(S,CKEDITOR.POSITION_BEFORE_END);else{if(i(S)&&S.getHtml().match(/(\s|&nbsp;)$/g)){_=null;break}(_=R.clone()).moveToPosition(S,CKEDITOR.POSITION_BEFORE_END)}S=S.getLast(n)}_&&R.moveToRange(_)}}}}(),p=function(){function e(e){return(e=new CKEDITOR.dom.walker(e)).guard=function(e,t){return!t&&(e.type==CKEDITOR.NODE_ELEMENT?e.is(CKEDITOR.dtd.$tableContent):void 0)},e.evaluator=function(e){return e.type==CKEDITOR.NODE_ELEMENT},e}function t(e,t,n){return t=e.getDocument().createElement(t),e.append(t,n),t}function n(e){for(var t,n=e.count();0<n--;)t=e.getItem(n),CKEDITOR.tools.trim(t.getHtml())||(t.appendBogus(),CKEDITOR.env.ie&&9>CKEDITOR.env.version&&t.getChildCount()&&t.getFirst().remove())}return function(o){var i=o.startContainer,r=i.getAscendant("table",1),a=!1;n(r.getElementsByTag("td")),n(r.getElementsByTag("th")),(r=o.clone()).setStart(i,0),(r=e(r).lastBackward())||((r=o.clone()).setEndAt(i,CKEDITOR.POSITION_BEFORE_END),r=e(r).lastForward(),a=!0),r||(r=i),r.is("table")?(o.setStartAt(r,CKEDITOR.POSITION_BEFORE_START),o.collapse(!0),r.remove()):(r.is({tbody:1,thead:1,tfoot:1})&&(r=t(r,"tr",a)),r.is("tr")&&(r=t(r,r.getParent().is("thead")?"th":"td",a)),(i=r.getBogus())&&i.remove(),o.moveToPosition(r,a?CKEDITOR.POSITION_AFTER_START:CKEDITOR.POSITION_BEFORE_END))}}(),v=function(){function e(e){return(e=new CKEDITOR.dom.walker(e)).guard=function(e,t){return!t&&(e.type==CKEDITOR.NODE_ELEMENT?e.is(CKEDITOR.dtd.$list)||e.is(CKEDITOR.dtd.$listItem):void 0)},e.evaluator=function(e){return e.type==CKEDITOR.NODE_ELEMENT&&e.is(CKEDITOR.dtd.$listItem)},e}return function(t){var n,o=t.startContainer,i=!1;(n=t.clone()).setStart(o,0),(n=e(n).lastBackward())||((n=t.clone()).setEndAt(o,CKEDITOR.POSITION_BEFORE_END),n=e(n).lastForward(),i=!0),n||(n=o),n.is(CKEDITOR.dtd.$list)?(t.setStartAt(n,CKEDITOR.POSITION_BEFORE_START),t.collapse(!0),n.remove()):((o=n.getBogus())&&o.remove(),t.moveToPosition(n,i?CKEDITOR.POSITION_AFTER_START:CKEDITOR.POSITION_BEFORE_END),t.select())}}(),y={eol:{detect:function(e,t){var n=e.range,o=n.clone(),i=n.clone(),r=new CKEDITOR.dom.elementPath(n.startContainer,t),a=new CKEDITOR.dom.elementPath(n.endContainer,t);o.collapse(1),i.collapse(),r.block&&o.checkBoundaryOfElement(r.block,CKEDITOR.END)&&(n.setStartAfter(r.block),e.prependEolBr=1),a.block&&i.checkBoundaryOfElement(a.block,CKEDITOR.START)&&(n.setEndBefore(a.block),e.appendEolBr=1)},fix:function(e,t){var n,o=t.getDocument();e.appendEolBr&&(n=this.createEolBr(o),e.fragment.append(n)),!e.prependEolBr||n&&!n.getPrevious()||e.fragment.append(this.createEolBr(o),1)},createEolBr:function(e){return e.createElement("br",{attributes:{"data-cke-eol":1}})}},bogus:{exclude:function(e){var t,n=(t=e.range.getBoundaryNodes()).startNode;!(t=t.endNode)||!h(t)||n&&n.equals(t)||e.range.setEndBefore(t)}},tree:{rebuild:function(e,t){var n,o=(a=e.range).getCommonAncestor(),i=new CKEDITOR.dom.elementPath(o,t),r=new CKEDITOR.dom.elementPath(a.startContainer,t),a=new CKEDITOR.dom.elementPath(a.endContainer,t);if(o.type==CKEDITOR.NODE_TEXT&&(o=o.getParent()),i.blockLimit.is({tr:1,table:1})){var s=i.contains("table").getParent();n=function(e){return!e.equals(s)}}else if(i.block&&i.block.is(CKEDITOR.dtd.$listItem)&&(r=r.contains(CKEDITOR.dtd.$list),a=a.contains(CKEDITOR.dtd.$list),!r.equals(a))){var l=i.contains(CKEDITOR.dtd.$list).getParent();n=function(e){return!e.equals(l)}}n||(n=function(e){return!e.equals(i.block)&&!e.equals(i.blockLimit)}),this.rebuildFragment(e,t,o,n)},rebuildFragment:function(e,t,n,o){for(var i;n&&!n.equals(t)&&o(n);)i=n.clone(0,1),e.fragment.appendTo(i),e.fragment=i,n=n.getParent()}},cell:{shrink:function(e){var t=(e=e.range).startContainer,n=e.startOffset,o=e.endOffset;t.type==CKEDITOR.NODE_ELEMENT&&t.equals(e.endContainer)&&t.is("tr")&&++n==o&&e.shrink(CKEDITOR.SHRINK_TEXT)}}},b=function(){function e(e,t){var n=e.getParent();n.is(CKEDITOR.dtd.$inline)&&e[t?"insertBefore":"insertAfter"](n)}function t(t,n,o){e(n),e(o,1);for(var i;i=o.getNext();)i.insertAfter(n),n=i;f(t)&&t.remove()}function n(e,t){var n=new CKEDITOR.dom.range(e);return n.setStartAfter(t.startNode),n.setEndBefore(t.endNode),n}return{list:{detectMerge:function(e,t){var o=n(t,e.bookmark),i=o.startPath(),r=o.endPath(),a=i.contains(CKEDITOR.dtd.$list),s=r.contains(CKEDITOR.dtd.$list);e.mergeList=a&&s&&a.getParent().equals(s.getParent())&&!a.equals(s),e.mergeListItems=i.block&&r.block&&i.block.is(CKEDITOR.dtd.$listItem)&&r.block.is(CKEDITOR.dtd.$listItem),(e.mergeList||e.mergeListItems)&&((o=o.clone()).setStartBefore(e.bookmark.startNode),o.setEndAfter(e.bookmark.endNode),e.mergeListBookmark=o.createBookmark())},merge:function(e,n){if(e.mergeListBookmark){var o=e.mergeListBookmark.startNode,i=e.mergeListBookmark.endNode,r=new CKEDITOR.dom.elementPath(o,n),a=new CKEDITOR.dom.elementPath(i,n);if(e.mergeList){var s=r.contains(CKEDITOR.dtd.$list),l=a.contains(CKEDITOR.dtd.$list);s.equals(l)||(l.moveChildren(s),l.remove())}e.mergeListItems&&(r=r.contains(CKEDITOR.dtd.$listItem),a=a.contains(CKEDITOR.dtd.$listItem),r.equals(a)||t(a,o,i)),o.remove(),i.remove()}}},block:{detectMerge:function(e,t){if(!e.tableContentsRanges&&!e.mergeListBookmark){var n=new CKEDITOR.dom.range(t);n.setStartBefore(e.bookmark.startNode),n.setEndAfter(e.bookmark.endNode),e.mergeBlockBookmark=n.createBookmark()}},merge:function(e,n){if(e.mergeBlockBookmark&&!e.purgeTableBookmark){var o=e.mergeBlockBookmark.startNode,i=e.mergeBlockBookmark.endNode,r=new CKEDITOR.dom.elementPath(o,n),a=(a=new CKEDITOR.dom.elementPath(i,n)).block;(r=r.block)&&a&&!r.equals(a)&&t(a,o,i),o.remove(),i.remove()}}},table:function(){function e(e){var n,i=[],r=new CKEDITOR.dom.walker(e),a=e.startPath().contains(o),s=e.endPath().contains(o),l={};return r.guard=function(r,u){if(r.type==CKEDITOR.NODE_ELEMENT){if(r.getCustomData(c="visited_"+(u?"out":"in")))return;CKEDITOR.dom.element.setMarker(l,r,c,1)}if(u&&a&&r.equals(a))(n=e.clone()).setEndAt(a,CKEDITOR.POSITION_BEFORE_END),i.push(n);else if(!u&&s&&r.equals(s))(n=e.clone()).setStartAt(s,CKEDITOR.POSITION_AFTER_START),i.push(n);else{if((c=!u)&&(c=r.type==CKEDITOR.NODE_ELEMENT&&r.is(o)&&(!a||t(r,a))&&(!s||t(r,s))),!c&&(c=u))if(r.is(o)){var c=a&&a.getAscendant("table",!0),d=s&&s.getAscendant("table",!0),f=r.getAscendant("table",!0);c=c&&c.contains(f)||d&&d.contains(f)}else c=void 0;c&&((n=e.clone()).selectNodeContents(r),i.push(n))}},r.lastForward(),CKEDITOR.dom.element.clearAllMarkers(l),i}function t(e,t){var n=CKEDITOR.POSITION_CONTAINS+CKEDITOR.POSITION_IS_CONTAINED,o=e.getPosition(t);return o!==CKEDITOR.POSITION_IDENTICAL&&0==(o&n)}var o={td:1,th:1,caption:1};return{detectPurge:function(e){var t=e.range;(n=t.clone()).enlarge(CKEDITOR.ENLARGE_ELEMENT);var n=new CKEDITOR.dom.walker(n),i=0;if(n.evaluator=function(e){e.type==CKEDITOR.NODE_ELEMENT&&e.is(o)&&++i},n.checkForward(),1<i){n=t.startPath().contains("table");var r=t.endPath().contains("table");n&&r&&t.checkBoundaryOfElement(n,CKEDITOR.START)&&t.checkBoundaryOfElement(r,CKEDITOR.END)&&((t=e.range.clone()).setStartBefore(n),t.setEndAfter(r),e.purgeTableBookmark=t.createBookmark())}},detectRanges:function(i,r){var a,s,l=n(r,i.bookmark),u=l.clone(),c=l.getCommonAncestor();c.is(CKEDITOR.dtd.$tableContent)&&!c.is(o)&&(c=c.getAscendant("table",!0)),s=c,c=new CKEDITOR.dom.elementPath(l.startContainer,s),s=new CKEDITOR.dom.elementPath(l.endContainer,s),c=c.contains("table"),s=s.contains("table"),(c||s)&&(c&&s&&t(c,s)?(i.tableSurroundingRange=u,u.setStartAt(c,CKEDITOR.POSITION_AFTER_END),u.setEndAt(s,CKEDITOR.POSITION_BEFORE_START),(u=l.clone()).setEndAt(c,CKEDITOR.POSITION_AFTER_END),(a=l.clone()).setStartAt(s,CKEDITOR.POSITION_BEFORE_START),a=e(u).concat(e(a))):c?s||(i.tableSurroundingRange=u,u.setStartAt(c,CKEDITOR.POSITION_AFTER_END),l.setEndAt(c,CKEDITOR.POSITION_AFTER_END)):(i.tableSurroundingRange=u,u.setEndAt(s,CKEDITOR.POSITION_BEFORE_START),l.setStartAt(s,CKEDITOR.POSITION_AFTER_START)),i.tableContentsRanges=a||e(l))},deleteRanges:function(e){for(var t;t=e.tableContentsRanges.pop();)t.extractContents(),f(t.startContainer)&&t.startContainer.appendBogus();e.tableSurroundingRange&&e.tableSurroundingRange.extractContents()},purge:function(e){if(e.purgeTableBookmark){var t=e.doc,n=e.range.clone();(t=t.createElement("p")).insertBefore(e.purgeTableBookmark.startNode),n.moveToBookmark(e.purgeTableBookmark),n.deleteContents(),e.range.moveToPosition(t,CKEDITOR.POSITION_AFTER_START)}}}}(),detectExtractMerge:function(e){return!(e.range.startPath().contains(CKEDITOR.dtd.$listItem)&&e.range.endPath().contains(CKEDITOR.dtd.$listItem))},fixUneditableRangePosition:function(e){e.startContainer.getDtd()["#"]||e.moveToClosestEditablePosition(null,!0)},autoParagraph:function(e,t){var n,o=t.startPath();r(e,o.block,o.blockLimit)&&(n=a(e))&&((n=t.document.createElement(n)).appendBogus(),t.insertNode(n),t.moveToPosition(n,CKEDITOR.POSITION_AFTER_START))}}}()}(),function(){function e(e){return CKEDITOR.plugins.widget&&CKEDITOR.plugins.widget.isDomWidget(e)}function t(t,n){if(0===t.length||e(t[0].getEnclosedNode()))return!1;var o,i;if((o=!n&&1===t.length)&&!(o=t[0].collapsed)){var r=t[0];o=r.startContainer.getAscendant({td:1,th:1},!0);var a=r.endContainer.getAscendant({td:1,th:1},!0);i=CKEDITOR.tools.trim,o=!(!o||!o.equals(a)||o.findOne("td, th, tr, tbody, table")||(r=r.cloneContents()).getFirst()&&i(r.getFirst().getText())===i(o.getText()))}if(o)return!1;for(i=0;i<t.length;i++)if(!(o=t[i]._getTableElement()))return!1;return!0}function n(e){var t=this.root.editor,n=t.getSelection(1);this.reset(),f=!0,n.root.once("selectionchange",(function(e){e.cancel()}),null,null,0),n.selectRanges([e[0]]),(n=this._.cache).ranges=new CKEDITOR.dom.rangeList(e),n.type=CKEDITOR.SELECTION_TEXT,n.selectedElement=e[0]._getTableElement(),n.selectedText=function(e){e=function(e){function t(e){e=e.find("td, th");var t,n=[];for(t=0;t<e.count();t++)n.push(e.getItem(t));return n}var n,o,i=[];for(o=0;o<e.length;o++)(n=e[o]._getTableElement()).is&&n.is({td:1,th:1})?i.push(n):i=i.concat(t(n));return i}(e);var t,n,o="",i=[];for(n=0;n<e.length;n++)t&&!t.equals(e[n].getAscendant("tr"))?(o+=i.join("\t")+"\n",t=e[n].getAscendant("tr"),i=[]):0===n&&(t=e[n].getAscendant("tr")),i.push(e[n].getText());return o+i.join("\t")}(e),n.nativeSel=null,this.isFake=1,this.rev=p++,t._.fakeSelection=this,f=!1,this.root.fire("selectionchange")}function o(){var n,o=this._.fakeSelection;if(o){var i;if(!(i=!(n=this.getSelection(1)))&&(i=!n.isHidden())){i=o;var r=n.getRanges(),a=i.getRanges(),s=r.length&&r[0]._getTableElement()&&r[0]._getTableElement().getAscendant("table",!0),l=a.length&&a[0]._getTableElement()&&a[0]._getTableElement().getAscendant("table",!0),u=1===r.length&&r[0]._getTableElement()&&r[0]._getTableElement().is("table"),c=1===a.length&&a[0]._getTableElement()&&a[0]._getTableElement().is("table");if(e(i.getSelectedElement()))i=!1;else{var d=1===r.length&&r[0].collapsed;a=t(r,!!CKEDITOR.env.webkit)&&t(a),(s=!(!s||!l)&&(s.equals(l)||l.contains(s)))&&(d||a)?(u&&!c&&i.selectRanges(r),i=!0):i=!1}i=!i}i&&(o.reset(),o=0)}(o||(o=n||this.getSelection(1))&&o.getType()!=CKEDITOR.SELECTION_NONE)&&(this.fire("selectionCheck",o),(n=this.elementPath()).compare(this._.selectionPreviousPath)||(i=this._.selectionPreviousPath&&this._.selectionPreviousPath.blockLimit.equals(n.blockLimit),!CKEDITOR.env.webkit&&!CKEDITOR.env.gecko||i||(this._.previousActive=this.document.getActive()),this._.selectionPreviousPath=n,this.fire("selectionChange",{selection:o,path:n})))}function i(){g=!0,h||(a.call(this),h=CKEDITOR.tools.setTimeout(a,200,this))}function a(){h=null,g&&(CKEDITOR.tools.setTimeout(o,0,this),g=!1)}function s(e){return!(!C(e)&&(e.type!=CKEDITOR.NODE_ELEMENT||e.is(CKEDITOR.dtd.$empty)))}function l(e){function t(t,n){return!(!t||t.type==CKEDITOR.NODE_TEXT)&&e.clone()["moveToElementEdit"+(n?"End":"Start")](t)}if(!(e.root instanceof CKEDITOR.editable))return!1;var n=e.startContainer,o=e.getPreviousNode(s,null,n),i=e.getNextNode(s,null,n);return!(!t(o)&&!t(i,1)&&(o||i||n.type==CKEDITOR.NODE_ELEMENT&&n.isBlockBoundary()&&n.getBogus()))}function u(e){c(e,!1);var t=e.getDocument().createText(v);return e.setCustomData("cke-fillingChar",t),t}function c(e,t){var n=e&&e.removeCustomData("cke-fillingChar");if(n){if(!1!==t){var o=e.getDocument().getSelection().getNative(),i=o&&"None"!=o.type&&o.getRangeAt(0),r=v.length;if(n.getLength()>r&&i&&i.intersectsNode(n.$)){var a=[{node:o.anchorNode,offset:o.anchorOffset},{node:o.focusNode,offset:o.focusOffset}];o.anchorNode==n.$&&o.anchorOffset>r&&(a[0].offset-=r),o.focusNode==n.$&&o.focusOffset>r&&(a[1].offset-=r)}}n.setText(d(n.getText(),1)),a&&(o=(n=e.getDocument().$).getSelection(),(n=n.createRange()).setStart(a[0].node,a[0].offset),n.collapse(!0),o.removeAllRanges(),o.addRange(n),o.extend(a[1].node,a[1].offset))}}function d(e,t){return t?e.replace(y,(function(e,t){return t?" ":""})):e.replace(v,"")}var f,h,g,m="function"!=typeof window.getSelection,p=1,v=CKEDITOR.tools.repeat("​",7),y=new RegExp(v+"( )?","g"),C=CKEDITOR.dom.walker.invisible(1),T=function(){function e(e){return function(t){var n=t.editor.createRange();return n.moveToClosestEditablePosition(t.selected,e)&&t.editor.getSelection().selectRanges([n]),!1}}function t(e){return function(t){var n,o=t.editor,i=o.createRange();if(!o.readOnly)return(n=i.moveToClosestEditablePosition(t.selected,e))||(n=i.moveToClosestEditablePosition(t.selected,!e)),n&&o.getSelection().selectRanges([i]),o.fire("saveSnapshot"),t.selected.remove(),n||(i.moveToElementEditablePosition(o.editable()),o.getSelection().selectRanges([i])),o.fire("saveSnapshot"),!1}}var n=e(),o=e(1);return{37:n,38:n,39:o,40:o,8:t(),46:t(1)}}();CKEDITOR.on("instanceCreated",(function(e){function n(){var e=r.getSelection();e&&e.removeAllRanges()}var r=e.editor;r.on("contentDom",(function(){function e(){(s=new CKEDITOR.dom.selection(r.getSelection())).lock()}function n(){g.removeListener("mouseup",n),y.removeListener("mouseup",n);var e=CKEDITOR.document.$.selection,t=e.createRange();"None"!=e.type&&t.parentElement()&&t.parentElement().ownerDocument==h.$&&t.select()}var a,s,l,u,d,f,h=r.document,g=CKEDITOR.document,p=r.editable(),v=h.getBody(),y=h.getDocumentElement(),b=p.isInline();CKEDITOR.env.gecko&&p.attachListener(p,"focus",(function(e){e.removeListener(),0!==a&&(e=r.getSelection().getNative())&&e.isCollapsed&&e.anchorNode==p.$&&((e=r.createRange()).moveToElementEditStart(p),e.select())}),null,null,-2),p.attachListener(p,CKEDITOR.env.webkit||CKEDITOR.env.gecko?"focusin":"focus",(function(){a&&(CKEDITOR.env.webkit||CKEDITOR.env.gecko)&&(a=r._.previousActive&&r._.previousActive.equals(h.getActive()),CKEDITOR.env.webkit&&a&&null!=r._.previousScrollTop&&r._.previousScrollTop!=p.$.scrollTop&&(p.$.scrollTop=r._.previousScrollTop)),r.unlockSelection(a),a=0}),null,null,-1),p.attachListener(p,"mousedown",(function(){a=0})),(CKEDITOR.env.ie||CKEDITOR.env.gecko||b)&&(m?p.attachListener(p,"beforedeactivate",e,null,null,-1):p.attachListener(r,"selectionCheck",e,null,null,-1),p.attachListener(p,CKEDITOR.env.webkit||CKEDITOR.env.gecko?"focusout":"blur",(function(){var e=s&&(s.isFake||2>s.getRanges());CKEDITOR.env.gecko&&!b&&e||(r.lockSelection(s),a=1)}),null,null,-1),p.attachListener(p,"mousedown",(function(){a=0}))),CKEDITOR.env.ie&&!b&&(p.attachListener(p,"mousedown",(function(e){2==e.data.$.button&&((e=r.document.getSelection())&&e.getType()!=CKEDITOR.SELECTION_NONE||(l=r.window.getScrollPosition()))})),p.attachListener(p,"mouseup",(function(e){2==e.data.$.button&&l&&(r.document.$.documentElement.scrollLeft=l.x,r.document.$.documentElement.scrollTop=l.y),l=null})),"BackCompat"!=h.$.compatMode)&&((CKEDITOR.env.ie7Compat||CKEDITOR.env.ie6Compat)&&y.on("mousedown",(function(e){function n(e){if(e=e.data.$,d){var n=v.$.createTextRange();try{n.moveToPoint(e.clientX,e.clientY)}catch(t){}d.setEndPoint(0>f.compareEndPoints("StartToStart",n)?"EndToEnd":"StartToStart",n),d.select()}}function o(){y.removeListener("mousemove",n),g.removeListener("mouseup",o),y.removeListener("mouseup",o),d.select()}if((e=e.data).getTarget().is("html")&&e.$.y<y.$.clientHeight&&e.$.x<y.$.clientWidth){d=v.$.createTextRange();try{d.moveToPoint(e.$.clientX,e.$.clientY)}catch(t){}f=d.duplicate(),y.on("mousemove",n),g.on("mouseup",o),y.on("mouseup",o)}})),7<CKEDITOR.env.version&&11>CKEDITOR.env.version&&y.on("mousedown",(function(e){e.data.getTarget().is("html")&&(g.on("mouseup",n),y.on("mouseup",n))}))),p.attachListener(p,"selectionchange",o,r),p.attachListener(p,"keyup",i,r),p.attachListener(p,"touchstart",i,r),p.attachListener(p,"touchend",i,r),CKEDITOR.env.ie&&p.attachListener(p,"keydown",(function(e){var t=this.getSelection(1),n=function(e){return(e=e.getRanges()[0])&&(e=e.startContainer.getAscendant((function(e){return e.type==CKEDITOR.NODE_ELEMENT&&e.hasAttribute("contenteditable")}),!0))&&"false"===e.getAttribute("contenteditable")?e:null}(t);n&&!n.equals(p)&&(t.selectElement(n),e.data.preventDefault())}),r),p.attachListener(p,CKEDITOR.env.webkit||CKEDITOR.env.gecko?"focusin":"focus",(function(){r.forceNextSelectionCheck(),r.selectionChange(1)})),b&&(CKEDITOR.env.webkit||CKEDITOR.env.gecko)?(p.attachListener(p,"mousedown",(function(){u=1})),p.attachListener(h.getDocumentElement(),"mouseup",(function(){u&&i.call(r),u=0}))):p.attachListener(CKEDITOR.env.ie?p:h.getDocumentElement(),"mouseup",i,r),CKEDITOR.env.webkit&&p.attachListener(h,"keydown",(function(e){switch(e.data.getKey()){case 13:case 33:case 34:case 35:case 36:case 37:case 39:case 8:case 45:case 46:p.hasFocus&&c(p)}}),null,null,-1),p.attachListener(p,"keydown",function(e){var t={37:1,39:1,8:1,46:1};return function(n){var o=n.data.getKeystroke();if(t[o]){var i=e.getSelection().getRanges(),r=i[0];1==i.length&&r.collapsed&&(o=r[38>o?"getPreviousEditableNode":"getNextEditableNode"]())&&o.type==CKEDITOR.NODE_ELEMENT&&"false"==o.getAttribute("contenteditable")&&(e.getSelection().fake(o),n.data.preventDefault(),n.cancel())}}}(r),null,null,-1)})),r.on("setData",(function(){r.unlockSelection(),CKEDITOR.env.webkit&&n()})),r.on("contentDomUnload",(function(){r.unlockSelection()})),CKEDITOR.env.ie9Compat&&r.on("beforeDestroy",n,null,null,9),r.on("dataReady",(function(){delete r._.fakeSelection,delete r._.hiddenSelectionContainer,r.selectionChange(1)})),r.on("loadSnapshot",(function(){var e=CKEDITOR.dom.walker.nodeType(CKEDITOR.NODE_ELEMENT),t=r.editable().getLast(e);t&&t.hasAttribute("data-cke-hidden-sel")&&(t.remove(),CKEDITOR.env.gecko&&(e=r.editable().getFirst(e))&&e.is("br")&&e.getAttribute("_moz_editor_bogus_node")&&e.remove())}),null,null,100),r.on("key",(function(e){if("wysiwyg"==r.mode){var t=r.getSelection();if(t.isFake){var n=T[e.data.keyCode];if(n)return n({editor:r,selected:t.getSelectedElement(),selection:t,keyEvent:e})}}}))})),CKEDITOR.env.webkit&&CKEDITOR.on("instanceReady",(function(e){var t=e.editor;t.on("selectionChange",(function(){var e=t.editable(),n=e.getCustomData("cke-fillingChar");n&&(n.getCustomData("ready")?(c(e),e.editor.fire("selectionCheck")):n.setCustomData("ready",1))}),null,null,-1),t.on("beforeSetMode",(function(){c(t.editable())}),null,null,-1),t.on("getSnapshot",(function(e){e.data&&(e.data=d(e.data))}),t,null,20),t.on("toDataFormat",(function(e){e.data.dataValue=d(e.data.dataValue)}),null,null,0)})),CKEDITOR.editor.prototype.selectionChange=function(e){(e?o:i).call(this)},CKEDITOR.editor.prototype.getSelection=function(e){return!this._.savedSelection&&!this._.fakeSelection||e?(e=this.editable())&&"wysiwyg"==this.mode?new CKEDITOR.dom.selection(e):null:this._.savedSelection||this._.fakeSelection},CKEDITOR.editor.prototype.lockSelection=function(e){return(e=e||this.getSelection(1)).getType()!=CKEDITOR.SELECTION_NONE&&(!e.isLocked&&e.lock(),this._.savedSelection=e,!0)},CKEDITOR.editor.prototype.unlockSelection=function(e){var t=this._.savedSelection;return!!t&&(t.unlock(e),delete this._.savedSelection,!0)},CKEDITOR.editor.prototype.forceNextSelectionCheck=function(){delete this._.selectionPreviousPath},CKEDITOR.dom.document.prototype.getSelection=function(){return new CKEDITOR.dom.selection(this)},CKEDITOR.dom.range.prototype.select=function(){var e=this.root instanceof CKEDITOR.editable?this.root.editor.getSelection():new CKEDITOR.dom.selection(this.root);return e.selectRanges([this]),e},CKEDITOR.SELECTION_NONE=1,CKEDITOR.SELECTION_TEXT=2,CKEDITOR.SELECTION_ELEMENT=3,CKEDITOR.dom.selection=function(e){if(e instanceof CKEDITOR.dom.selection){var t=e;e=e.root}var o,i,r=e instanceof CKEDITOR.dom.element;if(this.rev=t?t.rev:p++,this.document=e instanceof CKEDITOR.dom.document?e:e.getDocument(),this.root=r?e:this.document.getBody(),this.isLocked=0,this._={cache:{}},t)return CKEDITOR.tools.extend(this._.cache,t._.cache),this.isFake=t.isFake,this.isLocked=t.isLocked,this;if(e=this.getNative())if(e.getRangeAt)o=(i=e.rangeCount&&e.getRangeAt(0))&&new CKEDITOR.dom.node(i.commonAncestorContainer);else{try{i=e.createRange()}catch(n){}o=i&&CKEDITOR.dom.element.get(i.item&&i.item(0)||i.parentElement())}return(!o||o.type!=CKEDITOR.NODE_ELEMENT&&o.type!=CKEDITOR.NODE_TEXT||!this.root.equals(o)&&!this.root.contains(o))&&(this._.cache.type=CKEDITOR.SELECTION_NONE,this._.cache.startElement=null,this._.cache.selectedElement=null,this._.cache.selectedText="",this._.cache.ranges=new CKEDITOR.dom.rangeList),this};var x={img:1,hr:1,li:1,table:1,tr:1,td:1,th:1,embed:1,object:1,ol:1,ul:1,a:1,input:1,form:1,select:1,textarea:1,button:1,fieldset:1,thead:1,tfoot:1};CKEDITOR.tools.extend(CKEDITOR.dom.selection,{_removeFillingCharSequenceString:d,_createFillingCharSequenceNode:u,FILLING_CHAR_SEQUENCE:v}),CKEDITOR.dom.selection.prototype={getNative:function(){return void 0!==this._.cache.nativeSel?this._.cache.nativeSel:this._.cache.nativeSel=m?this.document.$.selection:this.document.getWindow().$.getSelection()},getType:m?function(){var e=this._.cache;if(e.type)return e.type;var t=CKEDITOR.SELECTION_NONE;try{var n=this.getNative(),o=n.type;"Text"==o&&(t=CKEDITOR.SELECTION_TEXT),"Control"==o&&(t=CKEDITOR.SELECTION_ELEMENT),n.createRange().parentElement()&&(t=CKEDITOR.SELECTION_TEXT)}catch(u){}return e.type=t}:function(){var e=this._.cache;if(e.type)return e.type;var t=CKEDITOR.SELECTION_TEXT;if((n=this.getNative())&&n.rangeCount){if(1==n.rangeCount){var n,o=(n=n.getRangeAt(0)).startContainer;o==n.endContainer&&1==o.nodeType&&1==n.endOffset-n.startOffset&&x[o.childNodes[n.startOffset].nodeName.toLowerCase()]&&(t=CKEDITOR.SELECTION_ELEMENT)}}else t=CKEDITOR.SELECTION_NONE;return e.type=t},getRanges:function(){var e=m?function(){function e(e){return new CKEDITOR.dom.node(e).getIndex()}var t=function(t,n){(t=t.duplicate()).collapse(n);var o=t.parentElement();if(!o.hasChildNodes())return{container:o,offset:0};for(var i,r,a,s,u=o.children,c=t.duplicate(),d=0,f=u.length-1,h=-1;d<=f;)if(h=Math.floor((d+f)/2),c.moveToElementText(i=u[h]),0<(a=c.compareEndPoints("StartToStart",t)))f=h-1;else{if(!(0>a))return{container:o,offset:e(i)};d=h+1}if(-1==h||h==u.length-1&&0>a){if(c.moveToElementText(o),c.setEndPoint("StartToStart",t),c=c.text.replace(/(\r\n|\r)/g,"\n").length,u=o.childNodes,!c)return(i=u[u.length-1]).nodeType!=CKEDITOR.NODE_TEXT?{container:o,offset:u.length}:{container:i,offset:i.nodeValue.length};for(o=u.length;0<c&&0<o;)(r=u[--o]).nodeType==CKEDITOR.NODE_TEXT&&(s=r,c-=r.nodeValue.length);return{container:s,offset:-c}}if(c.collapse(0<a),c.setEndPoint(0<a?"StartToStart":"EndToStart",t),!(c=c.text.replace(/(\r\n|\r)/g,"\n").length))return{container:o,offset:e(i)+(0<a?0:1)};for(;0<c;)try{(r=i[0<a?"previousSibling":"nextSibling"]).nodeType==CKEDITOR.NODE_TEXT&&(c-=r.nodeValue.length,s=r),i=r}catch(l){return{container:o,offset:e(i)}}return{container:s,offset:0<a?-c:s.nodeValue.length+c}};return function(){var e=(s=this.getNative())&&s.createRange(),n=this.getType();if(!s)return[];if(n==CKEDITOR.SELECTION_TEXT)return s=new CKEDITOR.dom.range(this.root),n=t(e,!0),s.setStart(new CKEDITOR.dom.node(n.container),n.offset),n=t(e),s.setEnd(new CKEDITOR.dom.node(n.container),n.offset),s.endContainer.getPosition(s.startContainer)&CKEDITOR.POSITION_PRECEDING&&s.endOffset<=s.startContainer.getIndex()&&s.collapse(),[s];if(n==CKEDITOR.SELECTION_ELEMENT){n=[];for(var o=0;o<e.length;o++){for(var i=e.item(o),r=i.parentNode,a=0,s=new CKEDITOR.dom.range(this.root);a<r.childNodes.length&&r.childNodes[a]!=i;a++);s.setStart(new CKEDITOR.dom.node(r),a),s.setEnd(new CKEDITOR.dom.node(r),a+1),n.push(s)}return n}return[]}}():function(){var e,t=[],n=this.getNative();if(!n)return t;for(var o=0;o<n.rangeCount;o++){var i=n.getRangeAt(o);(e=new CKEDITOR.dom.range(this.root)).setStart(new CKEDITOR.dom.node(i.startContainer),i.startOffset),e.setEnd(new CKEDITOR.dom.node(i.endContainer),i.endOffset),t.push(e)}return t};return function(t){var n=this._.cache,o=n.ranges;return o||(n.ranges=o=new CKEDITOR.dom.rangeList(e.call(this))),t?function(e){for(var t=0;t<e.length;t++){var n=e[t];if(n.getCommonAncestor().isReadOnly()&&e.splice(t,1),!n.collapsed){if(n.startContainer.isReadOnly())for(var o,i=n.startContainer;i&&!((o=i.type==CKEDITOR.NODE_ELEMENT)&&i.is("body")||!i.isReadOnly());)o&&"false"==i.getAttribute("contentEditable")&&n.setStartAfter(i),i=i.getParent();i=n.startContainer,o=n.endContainer;var r=n.startOffset,a=n.endOffset,s=n.clone();i&&i.type==CKEDITOR.NODE_TEXT&&(r>=i.getLength()?s.setStartAfter(i):s.setStartBefore(i)),o&&o.type==CKEDITOR.NODE_TEXT&&(a?s.setEndAfter(o):s.setEndBefore(o)),(i=new CKEDITOR.dom.walker(s)).evaluator=function(o){if(o.type==CKEDITOR.NODE_ELEMENT&&o.isReadOnly()){var i=n.clone();return n.setEndBefore(o),n.collapsed&&e.splice(t--,1),o.getPosition(s.endContainer)&CKEDITOR.POSITION_CONTAINS||(i.setStartAfter(o),i.collapsed||e.splice(t+1,0,i)),!0}return!1},i.next()}}return e}(new CKEDITOR.dom.rangeList(o.slice())):o}}(),getStartElement:function(){var e,t=this._.cache;if(void 0!==t.startElement)return t.startElement;switch(this.getType()){case CKEDITOR.SELECTION_ELEMENT:return this.getSelectedElement();case CKEDITOR.SELECTION_TEXT:var n=this.getRanges()[0];if(n){if(n.collapsed)(e=n.startContainer).type!=CKEDITOR.NODE_ELEMENT&&(e=e.getParent());else{for(n.optimize();n.startOffset==((e=n.startContainer).getChildCount?e.getChildCount():e.getLength())&&!e.isBlockBoundary();)n.setStartAfter(e);if((e=n.startContainer).type!=CKEDITOR.NODE_ELEMENT)return e.getParent();if((e=e.getChild(n.startOffset))&&e.type==CKEDITOR.NODE_ELEMENT)for(n=e.getFirst();n&&n.type==CKEDITOR.NODE_ELEMENT;)e=n,n=n.getFirst();else e=n.startContainer}e=e.$}}return t.startElement=e?new CKEDITOR.dom.element(e):null},getSelectedElement:function(){var e=this._.cache;if(void 0!==e.selectedElement)return e.selectedElement;var t=this,n=CKEDITOR.tools.tryThese((function(){return t.getNative().createRange().item(0)}),(function(){for(var e,n,o=t.getRanges()[0].clone(),i=2;i&&!((e=o.getEnclosedNode())&&e.type==CKEDITOR.NODE_ELEMENT&&x[e.getName()]&&(n=e));i--)o.shrink(CKEDITOR.SHRINK_ELEMENT);return n&&n.$}));return e.selectedElement=n?new CKEDITOR.dom.element(n):null},getSelectedText:function(){var e=this._.cache;if(void 0!==e.selectedText)return e.selectedText;var t=this.getNative();return t=m?"Control"==t.type?"":t.createRange().text:t.toString(),e.selectedText=t},lock:function(){this.getRanges(),this.getStartElement(),this.getSelectedElement(),this.getSelectedText(),this._.cache.nativeSel=null,this.isLocked=1},unlock:function(e){if(this.isLocked){if(e)var o=this.getSelectedElement(),i=this.getRanges(),r=this.isFake;this.isLocked=0,this.reset(),e&&(e=o||i[0]&&i[0].getCommonAncestor())&&e.getAscendant("body",1)&&(this.root.editor.plugins.tableselection&&t(i)?n.call(this,i):r?this.fake(o):o&&2>i.length?this.selectElement(o):this.selectRanges(i))}},reset:function(){this._.cache={},this.isFake=0;var e=this.root.editor;if(e&&e._.fakeSelection)if(this.rev==e._.fakeSelection.rev){delete e._.fakeSelection;var t=e._.hiddenSelectionContainer;if(t){var n=e.checkDirty();e.fire("lockSnapshot"),t.remove(),e.fire("unlockSnapshot"),!n&&e.resetDirty()}delete e._.hiddenSelectionContainer}else CKEDITOR.warn("selection-fake-reset");this.rev=p++},selectElement:function(e){var t=new CKEDITOR.dom.range(this.root);t.setStartBefore(e),t.setEndAfter(e),this.selectRanges([t])},selectRanges:function(e){var o=this.root.editor,i=o&&o._.hiddenSelectionContainer;if(this.reset(),i){i=this.root;for(var a,s=0;s<e.length;++s)(a=e[s]).endContainer.equals(i)&&(a.endOffset=Math.min(a.endOffset,i.getChildCount()))}if(e.length)if(this.isLocked){var h=CKEDITOR.document.getActive();this.unlock(),this.selectRanges(e),this.lock(),h&&!h.equals(this.root)&&h.focus()}else{var g,p,v;if(1==e.length&&!(v=e[0]).collapsed&&(g=v.getEnclosedNode())&&g.type==CKEDITOR.NODE_ELEMENT&&((v=v.clone()).shrink(CKEDITOR.SHRINK_ELEMENT,!0),(p=v.getEnclosedNode())&&p.type==CKEDITOR.NODE_ELEMENT&&(g=p),"false"==g.getAttribute("contenteditable"))||(g=void 0),g)this.fake(g);else if(o&&o.plugins.tableselection&&o.plugins.tableselection.isSupportedEnvironment()&&t(e)&&!f&&!e[0]._getTableElement({table:1}).hasAttribute("data-cke-tableselection-ignored"))n.call(this,e);else{if(m){var y,b,C;if(p=CKEDITOR.dom.walker.whitespaces(!0),g=/\ufeff|\u00a0/,v={table:1,tbody:1,tr:1},1<e.length&&e[0].setEnd((o=e[e.length-1]).endContainer,o.endOffset),e=(o=e[0]).collapsed,(i=o.getEnclosedNode())&&i.type==CKEDITOR.NODE_ELEMENT&&i.getName()in x&&(!i.is("a")||!i.getText()))try{return(C=i.$.createControlRange()).addElement(i.$),void C.select()}catch(r){}(o.startContainer.type==CKEDITOR.NODE_ELEMENT&&o.startContainer.getName()in v||o.endContainer.type==CKEDITOR.NODE_ELEMENT&&o.endContainer.getName()in v)&&(o.shrink(CKEDITOR.NODE_ELEMENT,!0),e=o.collapsed),v=(C=o.createBookmark()).startNode,e||(h=C.endNode),(C=o.document.$.body.createTextRange()).moveToElementText(v.$),C.moveStart("character",1),h?((g=o.document.$.body.createTextRange()).moveToElementText(h.$),C.setEndPoint("EndToEnd",g),C.moveEnd("character",-1)):(y=v.getNext(p),b=v.hasAscendant("pre"),y=!(y&&y.getText&&y.getText().match(g))&&(b||!v.hasPrevious()||v.getPrevious().is&&v.getPrevious().is("br")),(b=o.document.createElement("span")).setHtml("&#65279;"),b.insertBefore(v),y&&o.document.createText("\ufeff").insertBefore(v)),o.setStartBefore(v),v.remove(),e?(y?(C.moveStart("character",-1),C.select(),o.document.$.selection.clear()):C.select(),o.moveToPosition(b,CKEDITOR.POSITION_BEFORE_START),b.remove()):(o.setEndBefore(h),h.remove(),C.select())}else{if(!(h=this.getNative()))return;for(this.removeAllRanges(),C=0;C<e.length;C++)if(C<e.length-1&&(b=e[C+1],(g=(y=e[C]).clone()).setStart(y.endContainer,y.endOffset),g.setEnd(b.startContainer,b.startOffset),!g.collapsed&&(g.shrink(CKEDITOR.NODE_ELEMENT,!0),o=g.getCommonAncestor(),g=g.getEnclosedNode(),o.isReadOnly()||g&&g.isReadOnly())))b.setStart(y.startContainer,y.startOffset),e.splice(C--,1);else{o=e[C],b=this.document.$.createRange(),o.collapsed&&CKEDITOR.env.webkit&&l(o)&&(g=u(this.root),o.insertNode(g),(y=g.getNext())&&!g.getPrevious()&&y.type==CKEDITOR.NODE_ELEMENT&&"br"==y.getName()?(c(this.root),o.moveToPosition(y,CKEDITOR.POSITION_BEFORE_START)):o.moveToPosition(g,CKEDITOR.POSITION_AFTER_END)),b.setStart(o.startContainer.$,o.startOffset);try{b.setEnd(o.endContainer.$,o.endOffset)}catch(d){if(!(0<=d.toString().indexOf("NS_ERROR_ILLEGAL_VALUE")))throw d;o.collapse(1),b.setEnd(o.endContainer.$,o.endOffset)}h.addRange(b)}}this.reset(),this.root.fire("selectionchange")}}},fake:function(e,t){var n=this.root.editor;void 0===t&&e.hasAttribute("aria-label")&&(t=e.getAttribute("aria-label")),this.reset(),function(e,t){var n=t&&CKEDITOR.tools.htmlEncode(t)||"&nbsp;";n=CKEDITOR.dom.element.createFromHtml('<div data-cke-hidden-sel="1" data-cke-temp="1" style="'+(CKEDITOR.env.ie&&14>CKEDITOR.env.version?"display:none":"position:fixed;top:0;left:-1000px;width:0;height:0;overflow:hidden;")+'">'+n+"</div>",e.document),e.fire("lockSnapshot"),e.editable().append(n);var o=e.getSelection(1),i=e.createRange(),r=o.root.on("selectionchange",(function(e){e.cancel()}),null,null,0);i.setStartAt(n,CKEDITOR.POSITION_AFTER_START),i.setEndAt(n,CKEDITOR.POSITION_BEFORE_END),o.selectRanges([i]),r.removeListener(),e.fire("unlockSnapshot"),e._.hiddenSelectionContainer=n}(n,t);var o=this._.cache,i=new CKEDITOR.dom.range(this.root);i.setStartBefore(e),i.setEndAfter(e),o.ranges=new CKEDITOR.dom.rangeList(i),o.selectedElement=o.startElement=e,o.type=CKEDITOR.SELECTION_ELEMENT,o.selectedText=o.nativeSel=null,this.isFake=1,this.rev=p++,n._.fakeSelection=this,this.root.fire("selectionchange")},isHidden:function(){var e=this.getCommonAncestor();return e&&e.type==CKEDITOR.NODE_TEXT&&(e=e.getParent()),!(!e||!e.data("cke-hidden-sel"))},isInTable:function(e){return t(this.getRanges(),e)},isCollapsed:function(){var e=this.getRanges();return 1===e.length&&e[0].collapsed},createBookmarks:function(e){return e=this.getRanges().createBookmarks(e),this.isFake&&(e.isFake=1),e},createBookmarks2:function(e){return e=this.getRanges().createBookmarks2(e),this.isFake&&(e.isFake=1),e},selectBookmarks:function(e){for(var n,o=[],i=0;i<e.length;i++){var r=new CKEDITOR.dom.range(this.root);r.moveToBookmark(e[i]),o.push(r)}return e.isFake&&((n=t(o)?o[0]._getTableElement():o[0].getEnclosedNode())&&n.type==CKEDITOR.NODE_ELEMENT||(CKEDITOR.warn("selection-not-fake"),e.isFake=0)),e.isFake&&!t(o)?this.fake(n):this.selectRanges(o),this},getCommonAncestor:function(){var e=this.getRanges();return e.length?e[0].startContainer.getCommonAncestor(e[e.length-1].endContainer):null},scrollIntoView:function(){this.type!=CKEDITOR.SELECTION_NONE&&this.getRanges()[0].scrollIntoView()},removeAllRanges:function(){if(this.getType()!=CKEDITOR.SELECTION_NONE){var e=this.getNative();try{e&&e[m?"empty":"removeAllRanges"]()}catch(b){}this.reset()}}}}(),CKEDITOR.STYLE_BLOCK=1,CKEDITOR.STYLE_INLINE=2,CKEDITOR.STYLE_OBJECT=3,function(){function e(e,t){for(var n,o;(e=e.getParent())&&!e.equals(t);)if(e.getAttribute("data-nostyle"))n=e;else if(!o){var i=e.getAttribute("contentEditable");"false"==i?n=e:"true"==i&&(o=1)}return n}function t(e,t,n,o){return(e.getPosition(t)|o)==o&&(!n.childRule||n.childRule(e))}function n(o){var r=o.document;if(o.collapsed)r=m(this,r),o.insertNode(r),o.moveToPosition(r,CKEDITOR.POSITION_BEFORE_END);else{var a,s=this.element,l=this._.definition,u=(y=l.ignoreReadonly)||l.includeReadonly;null==u&&(u=o.root.getCustomData("cke_includeReadonly"));var c=CKEDITOR.dtd[s];c||(a=!0,c=CKEDITOR.dtd.span),o.enlarge(CKEDITOR.ENLARGE_INLINE,1),o.trim();var d,h=o.createBookmark(),g=h.startNode,p=h.endNode,v=g;if(!y){var y=e(g,b=o.getCommonAncestor()),b=e(p,b);y&&(v=y.getNextSourceNode(!0)),b&&(p=b)}for(v.getPosition(p)==CKEDITOR.POSITION_FOLLOWING&&(v=0);v;){if(y=!1,v.equals(p))v=null,y=!0;else{b=(O=v.type==CKEDITOR.NODE_ELEMENT?v.getName():null)&&"false"==v.getAttribute("contentEditable");var C=O&&v.getAttribute("data-nostyle");if(O&&v.data("cke-bookmark")||v.type===CKEDITOR.NODE_COMMENT){v=v.getNextSourceNode(!0);continue}if(b&&u&&CKEDITOR.dtd.$block[O])for(var T=void 0,x=0,E=(M=(N=i(E=v)).length)&&new CKEDITOR.dom.range(E.getDocument());x<M;++x){T=N[x];var _=CKEDITOR.filter.instances[T.data("cke-filter")];_&&!_.check(this)||(E.selectNodeContents(T),n.call(this,E))}if(N=O?!c[O]||C||b&&!u?0:t(v,p,l,w):1){if(N=l,M=s,x=a,!(T=v.getParent())||!(T.getDtd()||CKEDITOR.dtd.span)[M]&&!x||N.parentRule&&!N.parentRule(T))y=!0;else if(d||O&&CKEDITOR.dtd.$removeEmpty[O]&&(v.getPosition(p)|w)!=w||(d=o.clone()).setStartBefore(v),(O=v.type)==CKEDITOR.NODE_TEXT||b||O==CKEDITOR.NODE_ELEMENT&&!v.getChildCount()){for(var I,O=v;(y=!O.getNext(D))&&c[(I=O.getParent()).getName()]&&t(I,g,l,R);)O=I;d.setEndAfter(O)}}else y=!0;v=v.getNextSourceNode(C||b)}if(y&&d&&!d.collapsed){b=(y=m(this,r)).hasAttributes(),C=d.getCommonAncestor(),O={};for(var S,k,A,N={},M=(T={},{});y&&C;){if(C.getName()==s){for(S in l.attributes)!M[S]&&(A=C.getAttribute(k))&&(y.getAttribute(S)==A?N[S]=1:M[S]=1);for(k in l.styles)!T[k]&&(A=C.getStyle(k))&&(y.getStyle(k)==A?O[k]=1:T[k]=1)}C=C.getParent()}for(S in N)y.removeAttribute(S);for(k in O)y.removeStyle(k);b&&!y.hasAttributes()&&(y=null),y?(d.extractContents().appendTo(y),d.insertNode(y),f.call(this,y),y.mergeSiblings(),CKEDITOR.env.ie||y.$.normalize()):(y=new CKEDITOR.dom.element("span"),d.extractContents().appendTo(y),d.insertNode(y),f.call(this,y),y.remove(!0)),d=null}}o.moveToBookmark(h),o.shrink(CKEDITOR.SHRINK_TEXT),o.shrink(CKEDITOR.NODE_ELEMENT,!0)}}function o(e){function t(){for(var e=new CKEDITOR.dom.elementPath(o.getParent()),t=new CKEDITOR.dom.elementPath(c.getParent()),n=null,i=null,r=0;r<e.elements.length;r++){var a=e.elements[r];if(a==e.block||a==e.blockLimit)break;f.checkElementRemovable(a,!0)&&(n=a)}for(r=0;r<t.elements.length&&(a=t.elements[r])!=t.block&&a!=t.blockLimit;r++)f.checkElementRemovable(a,!0)&&(i=a);i&&c.breakParent(i),n&&o.breakParent(n)}e.enlarge(CKEDITOR.ENLARGE_INLINE,1);var n=e.createBookmark(),o=n.startNode,i=this._.definition.alwaysRemoveElement;if(e.collapsed){for(var r,a,s=new CKEDITOR.dom.elementPath(o.getParent(),e.root),l=0;l<s.elements.length&&(a=s.elements[l])&&a!=s.block&&a!=s.blockLimit;l++)if(this.checkElementRemovable(a)){var u;!i&&e.collapsed&&(e.checkBoundaryOfElement(a,CKEDITOR.END)||(u=e.checkBoundaryOfElement(a,CKEDITOR.START)))?(r=a).match=u?"start":"end":(a.mergeSiblings(),a.is(this.element)?d.call(this,a):h(a,y(this)[a.getName()]))}if(r){for(i=o,l=0;!(a=s.elements[l]).equals(r);l++)a.match||((a=a.clone()).append(i),i=a);i["start"==r.match?"insertBefore":"insertAfter"](r)}}else{var c=n.endNode,f=this;for(t(),s=o;!s.equals(c);)r=s.getNextSourceNode(),s.type==CKEDITOR.NODE_ELEMENT&&this.checkElementRemovable(s)&&(s.getName()==this.element?d.call(this,s):h(s,y(this)[s.getName()]),r.type==CKEDITOR.NODE_ELEMENT&&r.contains(o)&&(t(),r=o.getNext())),s=r}e.moveToBookmark(n),e.shrink(CKEDITOR.NODE_ELEMENT,!0)}function i(e){var t=[];return e.forEach((function(e){if("true"==e.getAttribute("contenteditable"))return t.push(e),!1}),CKEDITOR.NODE_ELEMENT,!0),t}function r(e){var t=e.getEnclosedNode()||e.getCommonAncestor(!1,!0);(e=new CKEDITOR.dom.elementPath(t,e.root).contains(this.element,1))&&!e.isReadOnly()&&p(e,this)}function a(e){var t=e.getCommonAncestor(!0,!0);if(e=new CKEDITOR.dom.elementPath(t,e.root).contains(this.element,1)){var n=(t=this._.definition).attributes;if(n)for(var o in n)e.removeAttribute(o,n[o]);if(t.styles)for(var i in t.styles)t.styles.hasOwnProperty(i)&&e.removeStyle(i)}}function s(e){var t=e.createBookmark(!0),n=e.createIterator();n.enforceRealBlocks=!0,this._.enterMode&&(n.enlargeBr=this._.enterMode!=CKEDITOR.ENTER_BR);for(var o,i=e.document;o=n.getNextParagraph();)!o.isReadOnly()&&(!n.activeFilter||n.activeFilter.check(this))&&u(o,m(this,i,o));e.moveToBookmark(t)}function l(e){var t,n,o=e.createBookmark(1),i=e.createIterator();for(i.enforceRealBlocks=!0,i.enlargeBr=this._.enterMode!=CKEDITOR.ENTER_BR;t=i.getNextParagraph();)this.checkElementRemovable(t)&&(t.is("pre")?((n=this._.enterMode==CKEDITOR.ENTER_BR?null:e.document.createElement(this._.enterMode==CKEDITOR.ENTER_P?"p":"div"))&&t.copyAttributes(n),u(t,n)):d.call(this,t));e.moveToBookmark(o)}function u(e,t){(n=!t)&&(t=e.getDocument().createElement("div"),e.copyAttributes(t));var n,o,i=t&&t.is("pre"),r=e.is("pre"),a=!i&&r;if(i&&!r){if(r=t,(a=e.getBogus())&&a.remove(),a=(a=(a=(a=c(a=e.getHtml(),/(?:^[ \t\n\r]+)|(?:[ \t\n\r]+$)/g,"")).replace(/[ \t\r\n]*(<br[^>]*>)[ \t\r\n]*/gi,"$1")).replace(/([ \t\n\r]+|&nbsp;)/g," ")).replace(/<br\b[^>]*>/gi,"\n"),CKEDITOR.env.ie){var s=e.getDocument().createElement("div");s.append(r),r.$.outerHTML="<pre>"+a+"</pre>",r.copyAttributes(s.getFirst()),r=s.getFirst().remove()}else r.setHtml(a);t=r}else a?t=function(e,t){var n;1<e.length&&(n=new CKEDITOR.dom.documentFragment(t.getDocument()));for(var o=0;o<e.length;o++){var i=c(i=(i=e[o]).replace(/(\r\n|\r)/g,"\n"),/^[ \t]*\n/,"");if(i=c(i,/\n$/,""),i=(i=(i=c(i,/^[ \t]+|[ \t]+$/g,(function(e,t){return 1==e.length?"&nbsp;":t?" "+CKEDITOR.tools.repeat("&nbsp;",e.length-1):CKEDITOR.tools.repeat("&nbsp;",e.length-1)+" "}))).replace(/\n/g,"<br>")).replace(/[ \t]{2,}/g,(function(e){return CKEDITOR.tools.repeat("&nbsp;",e.length-1)+" "})),n){var r=t.clone();r.setHtml(i),n.append(r)}else t.setHtml(i)}return n||t}(n?[e.getHtml()]:function(e){var t=[];return c(e.getOuterHtml(),/(\S\s*)\n(?:\s|(<span[^>]+data-cke-bookmark.*?\/span>))*\n(?!$)/gi,(function(e,t,n){return t+"</pre>"+n+"<pre>"})).replace(/<pre\b.*?>([\s\S]*?)<\/pre>/gi,(function(e,n){t.push(n)})),t}(e),t):e.moveChildren(t);t.replace(e),i?(o=(n=t).getPrevious(O))&&o.type==CKEDITOR.NODE_ELEMENT&&o.is("pre")&&(i=c(o.getHtml(),/\n$/,"")+"\n\n"+c(n.getHtml(),/^\n/,""),CKEDITOR.env.ie?n.$.outerHTML="<pre>"+i+"</pre>":n.setHtml(i),o.remove()):n&&g(t)}function c(e,t,n){var o="",i="";return e=e.replace(/(^<span[^>]+data-cke-bookmark.*?\/span>)|(<span[^>]+data-cke-bookmark.*?\/span>$)/gi,(function(e,t,n){return t&&(o=t),n&&(i=n),""})),o+e.replace(t,n)+i}function d(e,t){var n,o=(i=this._.definition).attributes,i=i.styles,r=y(this)[e.getName()],a=CKEDITOR.tools.isEmpty(o)&&CKEDITOR.tools.isEmpty(i);for(n in o)("class"!=n&&!this._.definition.fullMatch||e.getAttribute(n)==b(n,o[n]))&&(t&&"data-"==n.slice(0,5)||(a=e.hasAttribute(n),e.removeAttribute(n)));for(var s in i)this._.definition.fullMatch&&e.getStyle(s)!=b(s,i[s],!0)||(a=a||!!e.getStyle(s),e.removeStyle(s));h(e,r,x[e.getName()]),a&&(this._.definition.alwaysRemoveElement?g(e,1):!CKEDITOR.dtd.$block[e.getName()]||this._.enterMode==CKEDITOR.ENTER_BR&&!e.hasAttributes()?g(e):e.renameNode(this._.enterMode==CKEDITOR.ENTER_P?"p":"div"))}function f(e){for(var t,n=y(this),o=e.getElementsByTag(this.element),i=o.count();0<=--i;)(t=o.getItem(i)).isReadOnly()||d.call(this,t,!0);for(var r in n)if(r!=this.element)for(i=(o=e.getElementsByTag(r)).count()-1;0<=i;i--)(t=o.getItem(i)).isReadOnly()||h(t,n[r])}function h(e,t,n){if(t=t&&t.attributes)for(var o=0;o<t.length;o++){var i,r=t[o][0];if(i=e.getAttribute(r)){var a=t[o][1];(null===a||a.test&&a.test(i)||"string"==typeof a&&i==a)&&e.removeAttribute(r)}}n||g(e)}function g(e,t){if(!e.hasAttributes()||t)if(CKEDITOR.dtd.$block[e.getName()]){var n=e.getPrevious(O),o=e.getNext(O);!n||n.type!=CKEDITOR.NODE_TEXT&&n.isBlockBoundary({br:1})||e.append("br",1),!o||o.type!=CKEDITOR.NODE_TEXT&&o.isBlockBoundary({br:1})||e.append("br"),e.remove(!0)}else n=e.getFirst(),o=e.getLast(),e.remove(!0),n&&(n.type==CKEDITOR.NODE_ELEMENT&&n.mergeSiblings(),o&&!n.equals(o)&&o.type==CKEDITOR.NODE_ELEMENT&&o.mergeSiblings())}function m(e,t,n){var o;return"*"==(o=e.element)&&(o="span"),o=new CKEDITOR.dom.element(o,t),n&&n.copyAttributes(o),o=p(o,e),t.getCustomData("doc_processing_style")&&o.hasAttribute("id")?o.removeAttribute("id"):t.setCustomData("doc_processing_style",1),o}function p(e,t){var n=(o=t._.definition).attributes,o=CKEDITOR.style.getStyleText(o);if(n)for(var i in n)e.setAttribute(i,n[i]);return o&&e.setAttribute("style",o),e.getDocument().removeCustomData("doc_processing_style"),e}function v(e,t){for(var n in e)e[n]=e[n].replace(I,(function(e,n){return t[n]}))}function y(e){if(e._.overrides)return e._.overrides;var t=e._.overrides={},n=e._.definition.overrides;if(n){CKEDITOR.tools.isArray(n)||(n=[n]);for(var o=0;o<n.length;o++){var i,r;if("string"==typeof(s=n[o])?i=s.toLowerCase():(i=s.element?s.element.toLowerCase():e.element,r=s.attributes),s=t[i]||(t[i]={}),r){var a,s=s.attributes=s.attributes||[];for(a in r)s.push([a.toLowerCase(),r[a]])}}}return t}function b(e,t,n){var o=new CKEDITOR.dom.element("span");return o[n?"setStyle":"setAttribute"](e,t),o[n?"getStyle":"getAttribute"](e)}function C(e,t){function n(e,t){return"font-family"==t.toLowerCase()?e.replace(/["']/g,""):e}for(var o in"string"==typeof e&&(e=CKEDITOR.tools.parseCssText(e)),"string"==typeof t&&(t=CKEDITOR.tools.parseCssText(t,!0)),e)if(!(o in t)||n(t[o],o)!=n(e[o],o)&&"inherit"!=e[o]&&"inherit"!=t[o])return!1;return!0}function T(e,t,n){var o=e.getRanges();t=t?this.removeFromRange:this.applyToRange;for(var i,r=o.createIterator();i=r.getNextRange();)t.call(this,i,n);e.selectRanges(o)}var x={address:1,div:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,p:1,pre:1,section:1,header:1,footer:1,nav:1,article:1,aside:1,figure:1,dialog:1,hgroup:1,time:1,meter:1,menu:1,command:1,keygen:1,output:1,progress:1,details:1,datagrid:1,datalist:1},E={a:1,blockquote:1,embed:1,hr:1,img:1,li:1,object:1,ol:1,table:1,td:1,tr:1,th:1,ul:1,dl:1,dt:1,dd:1,form:1,audio:1,video:1},_=/\s*(?:;\s*|$)/,I=/#\((.+?)\)/g,D=CKEDITOR.dom.walker.bookmark(0,1),O=CKEDITOR.dom.walker.whitespaces(1);CKEDITOR.style=function(e,t){if("string"==typeof e.type)return new CKEDITOR.style.customHandlers[e.type](e);var n=e.attributes;n&&n.style&&(e.styles=CKEDITOR.tools.extend({},e.styles,CKEDITOR.tools.parseCssText(n.style)),delete n.style),t&&(v((e=CKEDITOR.tools.clone(e)).attributes,t),v(e.styles,t)),n=this.element=e.element?"string"==typeof e.element?e.element.toLowerCase():e.element:"*",this.type=e.type||(x[n]?CKEDITOR.STYLE_BLOCK:E[n]?CKEDITOR.STYLE_OBJECT:CKEDITOR.STYLE_INLINE),"object"==typeof this.element&&(this.type=CKEDITOR.STYLE_OBJECT),this._={definition:e}},CKEDITOR.style.prototype={apply:function(e){if(e instanceof CKEDITOR.dom.document)return T.call(this,e.getSelection());if(this.checkApplicable(e.elementPath(),e)){var t=this._.enterMode;t||(this._.enterMode=e.activeEnterMode),T.call(this,e.getSelection(),0,e),this._.enterMode=t}},remove:function(e){if(e instanceof CKEDITOR.dom.document)return T.call(this,e.getSelection(),1);if(this.checkApplicable(e.elementPath(),e)){var t=this._.enterMode;t||(this._.enterMode=e.activeEnterMode),T.call(this,e.getSelection(),1,e),this._.enterMode=t}},applyToRange:function(e){return this.applyToRange=this.type==CKEDITOR.STYLE_INLINE?n:this.type==CKEDITOR.STYLE_BLOCK?s:this.type==CKEDITOR.STYLE_OBJECT?r:null,this.applyToRange(e)},removeFromRange:function(e){return this.removeFromRange=this.type==CKEDITOR.STYLE_INLINE?o:this.type==CKEDITOR.STYLE_BLOCK?l:this.type==CKEDITOR.STYLE_OBJECT?a:null,this.removeFromRange(e)},applyToObject:function(e){p(e,this)},checkActive:function(e,t){switch(this.type){case CKEDITOR.STYLE_BLOCK:return this.checkElementRemovable(e.block||e.blockLimit,!0,t);case CKEDITOR.STYLE_OBJECT:case CKEDITOR.STYLE_INLINE:for(var n,o=e.elements,i=0;i<o.length;i++)if(n=o[i],this.type!=CKEDITOR.STYLE_INLINE||n!=e.block&&n!=e.blockLimit){if(this.type==CKEDITOR.STYLE_OBJECT){var r=n.getName();if(!("string"==typeof this.element?r==this.element:r in this.element))continue}if(this.checkElementRemovable(n,!0,t))return!0}}return!1},checkApplicable:function(e,t,n){if(t&&t instanceof CKEDITOR.filter&&(n=t),n&&!n.check(this))return!1;switch(this.type){case CKEDITOR.STYLE_OBJECT:return!!e.contains(this.element);case CKEDITOR.STYLE_BLOCK:return!!e.blockLimit.getDtd()[this.element]}return!0},checkElementMatch:function(e,t){var n=this._.definition;if(!e||!n.ignoreReadonly&&e.isReadOnly())return!1;var o=e.getName();if("string"==typeof this.element?o==this.element:o in this.element){if(!t&&!e.hasAttributes())return!0;if(o=n._AC)n=o;else{o={};var i=0,r=n.attributes;if(r)for(var a in r)i++,o[a]=r[a];(a=CKEDITOR.style.getStyleText(n))&&(o.style||i++,o.style=a),o._length=i,n=n._AC=o}if(!n._length)return!0;for(var s in n)if("_length"!=s)if(o=e.getAttribute(s)||"","style"==s?C(n[s],o):n[s]==o){if(!t)return!0}else if(t)return!1;if(t)return!0}return!1},checkElementRemovable:function(e,t,n){if(this.checkElementMatch(e,t,n))return!0;if(t=y(this)[e.getName()]){var o;if(!(t=t.attributes))return!0;for(n=0;n<t.length;n++)if(o=e.getAttribute(o=t[n][0])){var i=t[n][1];if(null===i)return!0;if("string"==typeof i){if(o==i)return!0}else if(i.test(o))return!0}}return!1},buildPreview:function(e){var t=this._.definition,n=[],o=t.element;"bdo"==o&&(o="span"),n=["<",o];var i=t.attributes;if(i)for(var r in i)n.push(" ",r,'="',i[r],'"');return(i=CKEDITOR.style.getStyleText(t))&&n.push(' style="',i,'"'),n.push(">",e||t.name,"</",o,">"),n.join("")},getDefinition:function(){return this._.definition}},CKEDITOR.style.getStyleText=function(e){if(t=e._ST)return t;var t=e.styles,n=e.attributes&&e.attributes.style||"",o="";for(var i in n.length&&(n=n.replace(_,";")),t){var r=t[i],a=(i+":"+r).replace(_,";");"inherit"==r?o+=a:n+=a}return n.length&&(n=CKEDITOR.tools.normalizeCssText(n,!0)),e._ST=n+o},CKEDITOR.style.customHandlers={},CKEDITOR.style.addCustomHandler=function(e){var t=function(e){this._={definition:e},this.setup&&this.setup(e)};return t.prototype=CKEDITOR.tools.extend(CKEDITOR.tools.prototypedCopy(CKEDITOR.style.prototype),{assignedTo:CKEDITOR.STYLE_OBJECT},e,!0),this.customHandlers[e.type]=t};var w=CKEDITOR.POSITION_PRECEDING|CKEDITOR.POSITION_IDENTICAL|CKEDITOR.POSITION_IS_CONTAINED,R=CKEDITOR.POSITION_FOLLOWING|CKEDITOR.POSITION_IDENTICAL|CKEDITOR.POSITION_IS_CONTAINED}(),CKEDITOR.styleCommand=function(e,t){this.requiredContent=this.allowedContent=this.style=e,CKEDITOR.tools.extend(this,t,!0)},CKEDITOR.styleCommand.prototype.exec=function(e){e.focus(),this.state==CKEDITOR.TRISTATE_OFF?e.applyStyle(this.style):this.state==CKEDITOR.TRISTATE_ON&&e.removeStyle(this.style)},CKEDITOR.stylesSet=new CKEDITOR.resourceManager("","stylesSet"),CKEDITOR.addStylesSet=CKEDITOR.tools.bind(CKEDITOR.stylesSet.add,CKEDITOR.stylesSet),CKEDITOR.loadStylesSet=function(e,t,n){CKEDITOR.stylesSet.addExternal(e,t,""),CKEDITOR.stylesSet.load(e,n)},CKEDITOR.tools.extend(CKEDITOR.editor.prototype,{attachStyleStateChange:function(e,t){var n=this._.styleStateChangeCallbacks;n||(n=this._.styleStateChangeCallbacks=[],this.on("selectionChange",(function(e){for(var t=0;t<n.length;t++){var o=n[t],i=o.style.checkActive(e.data.path,this)?CKEDITOR.TRISTATE_ON:CKEDITOR.TRISTATE_OFF;o.fn.call(this,i)}}))),n.push({style:e,fn:t})},applyStyle:function(e){e.apply(this)},removeStyle:function(e){e.remove(this)},getStylesSet:function(e){if(this._.stylesDefinitions)e(this._.stylesDefinitions);else{var t=this;if(!1===(n=t.config.stylesCombo_stylesSet||t.config.stylesSet))e(null);else if(n instanceof Array)t._.stylesDefinitions=n,e(n);else{n||(n="default");var n,o=(n=n.split(":"))[0];CKEDITOR.stylesSet.addExternal(o,n[1]?n.slice(1).join(":"):CKEDITOR.getUrl("styles.js"),""),CKEDITOR.stylesSet.load(o,(function(n){t._.stylesDefinitions=n[o],e(t._.stylesDefinitions)}))}}}}),function(){if(window.Promise)CKEDITOR.tools.promise=Promise;else{var e=CKEDITOR.getUrl("vendor/promise.js");if("function"==typeof window.define&&window.define.amd&&"function"==typeof window.require)return window.require([e],(function(e){CKEDITOR.tools.promise=e}));CKEDITOR.scriptLoader.load(e,(function(t){return t?void 0!==window.ES6Promise?CKEDITOR.tools.promise=ES6Promise:void 0:CKEDITOR.error("no-vendor-lib",{path:e})}))}}(),function(){function e(e,o,i){e.once("selectionCheck",(function(e){if(!t){var r=e.data.getRanges()[0];i.equals(r)?e.cancel():o.equals(r)&&(n=!0)}}),null,null,-1)}var t=!0,n=!1;CKEDITOR.dom.selection.setupEditorOptimization=function(e){e.on("selectionCheck",(function(e){e.data&&!n&&e.data.optimizeInElementEnds(),n=!1})),e.on("contentDom",(function(){var t=e.editable();t&&(t.attachListener(t,"keydown",(function(e){this._.shiftPressed=e.data.$.shiftKey}),this),t.attachListener(t,"keyup",(function(e){this._.shiftPressed=e.data.$.shiftKey}),this))}))},CKEDITOR.dom.selection.prototype.optimizeInElementEnds=function(){var n,o=this.getRanges()[0],i=this.root.editor;if(this.root.editor._.shiftPressed||this.isFake||o.isCollapsed||o.startContainer.equals(o.endContainer))n=!1;else if(0===o.endOffset)n=!0;else{n=o.startContainer.type===CKEDITOR.NODE_TEXT;var r=o.endContainer.type===CKEDITOR.NODE_TEXT,a=n?o.startContainer.getLength():o.startContainer.getChildCount();n=o.startOffset===a||n^r}n&&(n=o.clone(),o.shrink(CKEDITOR.SHRINK_TEXT,!1,{skipBogus:!0}),t=!1,e(i,o,n),o.select(),t=!0)}}(),CKEDITOR.dom.comment=function(e,t){"string"==typeof e&&(e=(t?t.$:document).createComment(e)),CKEDITOR.dom.domObject.call(this,e)},CKEDITOR.dom.comment.prototype=new CKEDITOR.dom.node,CKEDITOR.tools.extend(CKEDITOR.dom.comment.prototype,{type:CKEDITOR.NODE_COMMENT,getOuterHtml:function(){return"\x3c!--"+this.$.nodeValue+"--\x3e"}}),function(){var e,t={},n={};for(e in CKEDITOR.dtd.$blockLimit)e in CKEDITOR.dtd.$list||(t[e]=1);for(e in CKEDITOR.dtd.$block)e in CKEDITOR.dtd.$blockLimit||e in CKEDITOR.dtd.$empty||(n[e]=1);CKEDITOR.dom.elementPath=function(e,o){var i,r=null,a=null,s=[],l=e;o=o||e.getDocument().getBody(),l||(l=o);do{if(l.type==CKEDITOR.NODE_ELEMENT){if(s.push(l),!this.lastElement&&(this.lastElement=l,l.is(CKEDITOR.dtd.$object)||"false"==l.getAttribute("contenteditable")))continue;if(l.equals(o))break;if(!a&&(i=l.getName(),"true"==l.getAttribute("contenteditable")?a=l:!r&&n[i]&&(r=l),t[i])){if(i=!r&&"div"==i){e:{for(var u=0,c=(i=l.getChildren()).count();u<c;u++){var d=i.getItem(u);if(d.type==CKEDITOR.NODE_ELEMENT&&CKEDITOR.dtd.$block[d.getName()]){i=!0;break e}}i=!1}i=!i}i?r=l:a=l}}}while(l=l.getParent());a||(a=o),this.block=r,this.blockLimit=a,this.root=o,this.elements=s}}(),CKEDITOR.dom.elementPath.prototype={compare:function(e){var t=this.elements;if(!(e=e&&e.elements)||t.length!=e.length)return!1;for(var n=0;n<t.length;n++)if(!t[n].equals(e[n]))return!1;return!0},contains:function(e,t,n){var o,i=0;"string"==typeof e&&(o=function(t){return t.getName()==e}),e instanceof CKEDITOR.dom.element?o=function(t){return t.equals(e)}:CKEDITOR.tools.isArray(e)?o=function(t){return-1<CKEDITOR.tools.indexOf(e,t.getName())}:"function"==typeof e?o=e:"object"==typeof e&&(o=function(t){return t.getName()in e});var r=this.elements,a=r.length;for(t&&(n?i+=1:--a),n&&(r=Array.prototype.slice.call(r,0)).reverse();i<a;i++)if(o(r[i]))return r[i];return null},isContextFor:function(e){return!(e in CKEDITOR.dtd.$block)||!!(this.contains(CKEDITOR.dtd.$intermediate)||this.root.equals(this.block)&&this.block||this.blockLimit).getDtd()[e]},direction:function(){return(this.block||this.blockLimit||this.root).getDirection(1)}},CKEDITOR.dom.text=function(e,t){"string"==typeof e&&(e=(t?t.$:document).createTextNode(e)),this.$=e},CKEDITOR.dom.text.prototype=new CKEDITOR.dom.node,CKEDITOR.tools.extend(CKEDITOR.dom.text.prototype,{type:CKEDITOR.NODE_TEXT,getLength:function(){return this.$.nodeValue.length},getText:function(){return this.$.nodeValue},setText:function(e){this.$.nodeValue=e},isEmpty:function(e){var t=this.getText();return e&&(t=CKEDITOR.tools.trim(t)),!t||t===CKEDITOR.dom.selection.FILLING_CHAR_SEQUENCE},split:function(e){var t=this.$.parentNode,n=t.childNodes.length,o=this.getLength(),i=this.getDocument(),r=new CKEDITOR.dom.text(this.$.splitText(e),i);return t.childNodes.length==n&&(e>=o?(r=i.createText("")).insertAfter(this):((e=i.createText("")).insertAfter(r),e.remove())),r},substring:function(e,t){return"number"!=typeof t?this.$.nodeValue.substr(e):this.$.nodeValue.substring(e,t)}}),function(){function e(e,t,n){var o=e.serializable,i=t[n?"endContainer":"startContainer"],r=n?"endOffset":"startOffset",a=o?t.document.getById(e.startNode):e.startNode;return e=o?t.document.getById(e.endNode):e.endNode,i.equals(a.getPrevious())?(t.startOffset=t.startOffset-i.getLength()-e.getPrevious().getLength(),i=e.getNext()):i.equals(e.getPrevious())&&(t.startOffset-=i.getLength(),i=e.getNext()),i.equals(a.getParent())&&t[r]++,i.equals(e.getParent())&&t[r]++,t[n?"endContainer":"startContainer"]=i,t}CKEDITOR.dom.rangeList=function(e){return e instanceof CKEDITOR.dom.rangeList?e:(e?e instanceof CKEDITOR.dom.range&&(e=[e]):e=[],CKEDITOR.tools.extend(e,t))};var t={createIterator:function(){var e,t=this,n=CKEDITOR.dom.walker.bookmark(),o=[];return{getNextRange:function(i){var r=t[e=void 0===e?0:e+1];if(r&&1<t.length){if(!e)for(var a=t.length-1;0<=a;a--)o.unshift(t[a].createBookmark(!0));if(i)for(var s=0;t[e+s+1];){var l=r.document;for(i=0,a=l.getById(o[s].endNode),l=l.getById(o[s+1].startNode);;){if(a=a.getNextSourceNode(!1),l.equals(a))i=1;else if(n(a)||a.type==CKEDITOR.NODE_ELEMENT&&a.isBlockBoundary())continue;break}if(!i)break;s++}for(r.moveToBookmark(o.shift());s--;)(a=t[++e]).moveToBookmark(o.shift()),r.setEnd(a.endContainer,a.endOffset)}return r}}},createBookmarks:function(t){for(var n,o=[],i=0;i<this.length;i++){o.push(n=this[i].createBookmark(t,!0));for(var r=i+1;r<this.length;r++)this[r]=e(n,this[r]),this[r]=e(n,this[r],!0)}return o},createBookmarks2:function(e){for(var t=[],n=0;n<this.length;n++)t.push(this[n].createBookmark2(e));return t},moveToBookmarks:function(e){for(var t=0;t<this.length;t++)this[t].moveToBookmark(e[t])}}}(),function(){function e(){return CKEDITOR.getUrl(CKEDITOR.skinName.split(",")[1]||"skins/"+CKEDITOR.skinName.split(",")[0]+"/")}function t(t){var n=CKEDITOR.skin["ua_"+t],o=CKEDITOR.env;if(n){n=n.split(",").sort((function(e,t){return e>t?-1:1}));for(var i,r=0;r<n.length;r++)if(i=n[r],o.ie&&(i.replace(/^ie/,"")==o.version||o.quirks&&"iequirks"==i)&&(i="ie"),o[i]){t+="_"+n[r];break}}return CKEDITOR.getUrl(e()+t+".css")}function n(e,n){r[e]||(CKEDITOR.document.appendStyleSheet(t(e)),r[e]=1),n&&n()}function o(e){var t=e.getById(a);return t||((t=e.getHead().append("style")).setAttribute("id",a),t.setAttribute("type","text/css")),t}function i(e,t,n){var o,i,r;if(CKEDITOR.env.webkit)for(t=t.split("}").slice(0,-1),i=0;i<t.length;i++)t[i]=t[i].split("{");for(var a=0;a<e.length;a++)if(CKEDITOR.env.webkit)for(i=0;i<t.length;i++){for(r=t[i][1],o=0;o<n.length;o++)r=r.replace(n[o][0],n[o][1]);e[a].$.sheet.addRule(t[i][0],r)}else{for(r=t,o=0;o<n.length;o++)r=r.replace(n[o][0],n[o][1]);CKEDITOR.env.ie&&11>CKEDITOR.env.version?e[a].$.styleSheet.cssText+=r:e[a].$.innerHTML+=r}}var r={};CKEDITOR.skin={path:e,loadPart:function(t,o){CKEDITOR.skin.name!=CKEDITOR.skinName.split(",")[0]?CKEDITOR.scriptLoader.load(CKEDITOR.getUrl(e()+"skin.js"),(function(){n(t,o)})):n(t,o)},getPath:function(e){return CKEDITOR.getUrl(t(e))},icons:{},addIcon:function(e,t,n,o){e=e.toLowerCase(),this.icons[e]||(this.icons[e]={path:t,offset:n||0,bgsize:o||"16px"})},getIconStyle:function(e,t,n,o,i){var r;return e&&(e=e.toLowerCase(),t&&(r=this.icons[e+"-rtl"]),r||(r=this.icons[e])),o=o||r&&r.offset,i=i||r&&r.bgsize||"16px",(e=n||r&&r.path||"")&&(e=e.replace(/'/g,"\\'")),e&&"background-image:url('"+CKEDITOR.getUrl(e)+"');background-position:0 "+o+"px;background-size:"+i+";"}},CKEDITOR.tools.extend(CKEDITOR.editor.prototype,{getUiColor:function(){return this.uiColor},setUiColor:function(e){var t=o(CKEDITOR.document);return(this.setUiColor=function(e){this.uiColor=e;var n=CKEDITOR.skin.chameleon,o="",r="";"function"==typeof n&&(o=n(this,"editor"),r=n(this,"panel")),i([t],o,e=[[l,e]]),i(s,r,e)}).call(this,e)}});var a="cke_ui_color",s=[],l=/\$color/g;CKEDITOR.on("instanceLoaded",(function(e){if(!CKEDITOR.env.ie||!CKEDITOR.env.quirks){var t=e.editor;e=function(e){if(!(e=(e.data[0]||e.data).element.getElementsByTag("iframe").getItem(0).getFrameDocument()).getById("cke_ui_color")){var n=o(e);s.push(n),t.on("destroy",(function(){s=CKEDITOR.tools.array.filter(s,(function(e){return n!==e}))})),(e=t.getUiColor())&&i([n],CKEDITOR.skin.chameleon(t,"panel"),[[l,e]])}},t.on("panelShow",e),t.on("menuShow",e),t.config.uiColor&&t.setUiColor(t.config.uiColor)}}))}(),function(){if(CKEDITOR.env.webkit)CKEDITOR.env.hc=!1;else{var e=CKEDITOR.dom.element.createFromHtml('<div style="width:0;height:0;position:absolute;left:-10000px;border:1px solid;border-color:red blue"></div>',CKEDITOR.document);e.appendTo(CKEDITOR.document.getHead());try{var t=e.getComputedStyle("border-top-color"),n=e.getComputedStyle("border-right-color");CKEDITOR.env.hc=!(!t||t!=n)}catch(o){CKEDITOR.env.hc=!1}e.remove()}if(CKEDITOR.env.hc&&(CKEDITOR.env.cssClass+=" cke_hc"),CKEDITOR.document.appendStyleText(".cke{visibility:hidden;}"),CKEDITOR.status="loaded",CKEDITOR.fireOnce("loaded"),e=CKEDITOR._.pending)for(delete CKEDITOR._.pending,t=0;t<e.length;t++)CKEDITOR.editor.prototype.constructor.apply(e[t][0],e[t][1]),CKEDITOR.add(e[t][0])}(),CKEDITOR.skin.name="bootstrapck",CKEDITOR.skin.ua_editor="ie,iequirks,ie7,ie8,gecko",CKEDITOR.skin.ua_dialog="ie,iequirks,ie7,ie8,opera",CKEDITOR.skin.chameleon=function(){var e=function(e,t){for(var n=e.match(/[^#]./g),o=0;3>o;o++){var i,r=n,a=o;i=parseInt(n[o],16),i=("0"+(0>t?0|i*(1+t):0|i+(255-i)*t).toString(16)).slice(-2),r[a]=i}return"#"+n.join("")},t=function(){var e=new CKEDITOR.template("background:#{to};background-image:-webkit-gradient(linear,lefttop,leftbottom,from({from}),to({to}));background-image:-moz-linear-gradient(top,{from},{to});background-image:-webkit-linear-gradient(top,{from},{to});background-image:-o-linear-gradient(top,{from},{to});background-image:-ms-linear-gradient(top,{from},{to});background-image:linear-gradient(top,{from},{to});filter:progid:DXImageTransform.Microsoft.gradient(gradientType=0,startColorstr='{from}',endColorstr='{to}');");return function(t,n){return e.output({from:t,to:n})}}(),n={editor:new CKEDITOR.template("{id}.cke_chrome [border-color:{defaultBorder};] {id} .cke_top [ {defaultGradient}border-bottom-color:{defaultBorder};] {id} .cke_bottom [{defaultGradient}border-top-color:{defaultBorder};] {id} .cke_resizer [border-right-color:{ckeResizer}] {id} .cke_dialog_title [{defaultGradient}border-bottom-color:{defaultBorder};] {id} .cke_dialog_footer [{defaultGradient}outline-color:{defaultBorder};border-top-color:{defaultBorder};] {id} .cke_dialog_tab [{lightGradient}border-color:{defaultBorder};] {id} .cke_dialog_tab:hover [{mediumGradient}] {id} .cke_dialog_contents [border-top-color:{defaultBorder};] {id} .cke_dialog_tab_selected, {id} .cke_dialog_tab_selected:hover [background:{dialogTabSelected};border-bottom-color:{dialogTabSelectedBorder};] {id} .cke_dialog_body [background:{dialogBody};border-color:{defaultBorder};] {id} .cke_toolgroup [{lightGradient}border-color:{defaultBorder};] {id} a.cke_button_off:hover, {id} a.cke_button_off:focus, {id} a.cke_button_off:active [{mediumGradient}] {id} .cke_button_on [{ckeButtonOn}] {id} .cke_toolbar_separator [background-color: {ckeToolbarSeparator};] {id} .cke_combo_button [border-color:{defaultBorder};{lightGradient}] {id} a.cke_combo_button:hover, {id} a.cke_combo_button:focus, {id} .cke_combo_on a.cke_combo_button [border-color:{defaultBorder};{mediumGradient}] {id} .cke_path_item [color:{elementsPathColor};] {id} a.cke_path_item:hover, {id} a.cke_path_item:focus, {id} a.cke_path_item:active [background-color:{elementsPathBg};] {id}.cke_panel [border-color:{defaultBorder};] "),panel:new CKEDITOR.template(".cke_panel_grouptitle [{lightGradient}border-color:{defaultBorder};] .cke_menubutton_icon [background-color:{menubuttonIcon};] .cke_menubutton:hover .cke_menubutton_icon, .cke_menubutton:focus .cke_menubutton_icon, .cke_menubutton:active .cke_menubutton_icon [background-color:{menubuttonIconHover};] .cke_menuseparator [background-color:{menubuttonIcon};] a:hover.cke_colorbox, a:focus.cke_colorbox, a:active.cke_colorbox [border-color:{defaultBorder};] a:hover.cke_colorauto, a:hover.cke_colormore, a:focus.cke_colorauto, a:focus.cke_colormore, a:active.cke_colorauto, a:active.cke_colormore [background-color:{ckeColorauto};border-color:{defaultBorder};] ")};return function(o,i){var r={id:"."+o.id,defaultBorder:e(r=o.uiColor,-.1),defaultGradient:t(e(r,.9),r),lightGradient:t(e(r,1),e(r,.7)),mediumGradient:t(e(r,.8),e(r,.5)),ckeButtonOn:t(e(r,.6),e(r,.7)),ckeResizer:e(r,-.4),ckeToolbarSeparator:e(r,.5),ckeColorauto:e(r,.8),dialogBody:e(r,.7),dialogTabSelected:t("#FFFFFF","#FFFFFF"),dialogTabSelectedBorder:"#FFF",elementsPathColor:e(r,-.6),elementsPathBg:r,menubuttonIcon:e(r,.5),menubuttonIconHover:e(r,.3)};return n[i].output(r).replace(/\[/g,"{").replace(/\]/g,"}")}}(),CKEDITOR.plugins.add("dialogui",{onLoad:function(){var e=function(e){this._||(this._={}),this._.default=this._.initValue=e.default||"",this._.required=e.required||!1;for(var t=[this._],n=1;n<arguments.length;n++)t.push(arguments[n]);return t.push(!0),CKEDITOR.tools.extend.apply(CKEDITOR.tools,t),this._},t={build:function(e,t,n){return new CKEDITOR.ui.dialog.textInput(e,t,n)}},n={build:function(e,t,n){return new CKEDITOR.ui.dialog[t.type](e,t,n)}},o={isChanged:function(){return this.getValue()!=this.getInitValue()},reset:function(e){this.setValue(this.getInitValue(),e)},setInitValue:function(){this._.initValue=this.getValue()},resetInitValue:function(){this._.initValue=this._.default},getInitValue:function(){return this._.initValue}},i=CKEDITOR.tools.extend({},CKEDITOR.ui.dialog.uiElement.prototype.eventProcessors,{onChange:function(e,t){this._.domOnChangeRegistered||(e.on("load",(function(){this.getInputElement().on("change",(function(){e.parts.dialog.isVisible()&&this.fire("change",{value:this.getValue()})}),this)}),this),this._.domOnChangeRegistered=!0),this.on("change",t)}},!0),r=/^on([A-Z]\w+)/,a=function(e){for(var t in e)(r.test(t)||"title"==t||"type"==t)&&delete e[t];return e},s=function(e){(e=e.data.getKeystroke())==CKEDITOR.SHIFT+CKEDITOR.ALT+36?this.setDirectionMarker("ltr"):e==CKEDITOR.SHIFT+CKEDITOR.ALT+35&&this.setDirectionMarker("rtl")};CKEDITOR.tools.extend(CKEDITOR.ui.dialog,{labeledElement:function(t,n,o,i){if(!(4>arguments.length)){var r=e.call(this,n);r.labelId=CKEDITOR.tools.getNextId()+"_label",this._.children=[];var a={role:n.role||"presentation"};n.includeLabel&&(a["aria-labelledby"]=r.labelId),CKEDITOR.ui.dialog.uiElement.call(this,t,n,o,"div",null,a,(function(){var e=[],o=n.required?" cke_required":"";return"horizontal"!=n.labelLayout?e.push('<label class="cke_dialog_ui_labeled_label'+o+'" ',' id="'+r.labelId+'"',r.inputId?' for="'+r.inputId+'"':"",(n.labelStyle?' style="'+n.labelStyle+'"':"")+">",n.label,"</label>",'<div class="cke_dialog_ui_labeled_content"',n.controlStyle?' style="'+n.controlStyle+'"':"",' role="presentation">',i.call(this,t,n),"</div>"):(o={type:"hbox",widths:n.widths,padding:0,children:[{type:"html",html:'<label class="cke_dialog_ui_labeled_label'+o+'" id="'+r.labelId+'" for="'+r.inputId+'"'+(n.labelStyle?' style="'+n.labelStyle+'"':"")+">"+CKEDITOR.tools.htmlEncode(n.label)+"</label>"},{type:"html",html:'<span class="cke_dialog_ui_labeled_content"'+(n.controlStyle?' style="'+n.controlStyle+'"':"")+">"+i.call(this,t,n)+"</span>"}]},CKEDITOR.dialog._.uiElementBuilders.hbox.build(t,o,e)),e.join("")}))}},textInput:function(t,n,o){if(!(3>arguments.length)){e.call(this,n);var i=this._.inputId=CKEDITOR.tools.getNextId()+"_textInput",r={class:"cke_dialog_ui_input_"+n.type,id:i,type:n.type};n.validate&&(this.validate=n.validate),n.maxLength&&(r.maxlength=n.maxLength),n.size&&(r.size=n.size),n.inputStyle&&(r.style=n.inputStyle);var a=this,l=!1;t.on("load",(function(){a.getInputElement().on("keydown",(function(e){13==e.data.getKeystroke()&&(l=!0)})),a.getInputElement().on("keyup",(function(e){13==e.data.getKeystroke()&&l&&(t.getButton("ok")&&setTimeout((function(){t.getButton("ok").click()}),0),l=!1),a.bidi&&s.call(a,e)}),null,null,1e3)})),CKEDITOR.ui.dialog.labeledElement.call(this,t,n,o,(function(){var e=['<div class="cke_dialog_ui_input_',n.type,'" role="presentation"'];for(var t in n.width&&e.push('style="width:'+n.width+'" '),e.push("><input "),r["aria-labelledby"]=this._.labelId,this._.required&&(r["aria-required"]=this._.required),r)e.push(t+'="'+r[t]+'" ');return e.push(" /></div>"),e.join("")}))}},textarea:function(t,n,o){if(!(3>arguments.length)){e.call(this,n);var i=this,r=this._.inputId=CKEDITOR.tools.getNextId()+"_textarea",a={};n.validate&&(this.validate=n.validate),a.rows=n.rows||5,a.cols=n.cols||20,a.class="cke_dialog_ui_input_textarea "+(n.class||""),void 0!==n.inputStyle&&(a.style=n.inputStyle),n.dir&&(a.dir=n.dir),i.bidi&&t.on("load",(function(){i.getInputElement().on("keyup",s)}),i),CKEDITOR.ui.dialog.labeledElement.call(this,t,n,o,(function(){a["aria-labelledby"]=this._.labelId,this._.required&&(a["aria-required"]=this._.required);var e,t=['<div class="cke_dialog_ui_input_textarea" role="presentation"><textarea id="',r,'" '];for(e in a)t.push(e+'="'+CKEDITOR.tools.htmlEncode(a[e])+'" ');return t.push(">",CKEDITOR.tools.htmlEncode(i._.default),"</textarea></div>"),t.join("")}))}},checkbox:function(t,n,o){if(!(3>arguments.length)){var i=e.call(this,n,{default:!!n.default});n.validate&&(this.validate=n.validate),CKEDITOR.ui.dialog.uiElement.call(this,t,n,o,"span",null,null,(function(){var e=CKEDITOR.tools.extend({},n,{id:n.id?n.id+"_checkbox":CKEDITOR.tools.getNextId()+"_checkbox"},!0),o=[],r=CKEDITOR.tools.getNextId()+"_label",s={class:"cke_dialog_ui_checkbox_input",type:"checkbox","aria-labelledby":r};return a(e),n.default&&(s.checked="checked"),void 0!==e.inputStyle&&(e.style=e.inputStyle),i.checkbox=new CKEDITOR.ui.dialog.uiElement(t,e,o,"input",null,s),o.push(' <label id="',r,'" for="',s.id,'"'+(n.labelStyle?' style="'+n.labelStyle+'"':"")+">",CKEDITOR.tools.htmlEncode(n.label),"</label>"),o.join("")}))}},radio:function(t,n,o){if(!(3>arguments.length)){e.call(this,n),this._.default||(this._.default=this._.initValue=n.items[0][1]),n.validate&&(this.validate=n.validate);var i=[],r=this;n.role="radiogroup",n.includeLabel=!0,CKEDITOR.ui.dialog.labeledElement.call(this,t,n,o,(function(){for(var e=[],o=[],s=(n.id?n.id:CKEDITOR.tools.getNextId())+"_radio",l=0;l<n.items.length;l++){var u=n.items[l],c=void 0!==u[2]?u[2]:u[0],d=void 0!==u[1]?u[1]:u[0],f=(h=CKEDITOR.tools.getNextId()+"_radio_input")+"_label",h=CKEDITOR.tools.extend({},n,{id:h,title:null,type:null},!0),g=(c=CKEDITOR.tools.extend({},h,{title:c},!0),{type:"radio",class:"cke_dialog_ui_radio_input",name:s,value:d,"aria-labelledby":f}),m=[];r._.default==d&&(g.checked="checked"),a(h),a(c),void 0!==h.inputStyle&&(h.style=h.inputStyle),h.keyboardFocusable=!0,i.push(new CKEDITOR.ui.dialog.uiElement(t,h,m,"input",null,g)),m.push(" "),new CKEDITOR.ui.dialog.uiElement(t,c,m,"label",null,{id:f,for:g.id},u[0]),e.push(m.join(""))}return new CKEDITOR.ui.dialog.hbox(t,i,e,o),o.join("")})),this._.children=i}},button:function(t,n,o){if(arguments.length){"function"==typeof n&&(n=n(t.getParentEditor())),e.call(this,n,{disabled:n.disabled||!1}),CKEDITOR.event.implementOn(this);var i=this;t.on("load",(function(){var e=this.getElement();e.on("click",(function(e){i.click(),e.data.preventDefault()})),e.on("keydown",(function(e){e.data.getKeystroke()in{32:1}&&(i.click(),e.data.preventDefault())})),e.unselectable()}),this);var r=CKEDITOR.tools.extend({},n);delete r.style;var a=CKEDITOR.tools.getNextId()+"_label";CKEDITOR.ui.dialog.uiElement.call(this,t,r,o,"a",null,{style:n.style,href:"javascript:void(0)",title:n.label,hidefocus:"true",class:n.class,role:"button","aria-labelledby":a},'<span id="'+a+'" class="cke_dialog_ui_button">'+CKEDITOR.tools.htmlEncode(n.label)+"</span>")}},select:function(t,n,o){if(!(3>arguments.length)){var i=e.call(this,n);n.validate&&(this.validate=n.validate),i.inputId=CKEDITOR.tools.getNextId()+"_select",CKEDITOR.ui.dialog.labeledElement.call(this,t,n,o,(function(){var e=CKEDITOR.tools.extend({},n,{id:n.id?n.id+"_select":CKEDITOR.tools.getNextId()+"_select"},!0),o=[],r=[],s={id:i.inputId,class:"cke_dialog_ui_input_select","aria-labelledby":this._.labelId};o.push('<div class="cke_dialog_ui_input_',n.type,'" role="presentation"'),n.width&&o.push('style="width:'+n.width+'" '),o.push(">"),void 0!==n.size&&(s.size=n.size),void 0!==n.multiple&&(s.multiple=n.multiple),a(e);for(var l,u=0;u<n.items.length&&(l=n.items[u]);u++)r.push('<option value="',CKEDITOR.tools.htmlEncode(void 0!==l[1]?l[1]:l[0]).replace(/"/g,"&quot;"),'" /> ',CKEDITOR.tools.htmlEncode(l[0]));return void 0!==e.inputStyle&&(e.style=e.inputStyle),i.select=new CKEDITOR.ui.dialog.uiElement(t,e,o,"select",null,s,r.join("")),o.push("</div>"),o.join("")}))}},file:function(t,n,o){if(!(3>arguments.length)){void 0===n.default&&(n.default="");var i=CKEDITOR.tools.extend(e.call(this,n),{definition:n,buttons:[]});n.validate&&(this.validate=n.validate),t.on("load",(function(){CKEDITOR.document.getById(i.frameId).getParent().addClass("cke_dialog_ui_input_file")})),CKEDITOR.ui.dialog.labeledElement.call(this,t,n,o,(function(){i.frameId=CKEDITOR.tools.getNextId()+"_fileInput";var e=['<iframe frameborder="0" allowtransparency="0" class="cke_dialog_ui_input_file" role="presentation" id="',i.frameId,'" title="',n.label,'" src="javascript:void('];return e.push(CKEDITOR.env.ie?"(function(){"+encodeURIComponent("document.open();("+CKEDITOR.tools.fixDomain+")();document.close();")+"})()":"0"),e.push(')"></iframe>'),e.join("")}))}},fileButton:function(t,n,o){var i=this;if(!(3>arguments.length)){e.call(this,n),n.validate&&(this.validate=n.validate);var r=CKEDITOR.tools.extend({},n),a=r.onClick;r.className=(r.className?r.className+" ":"")+"cke_dialog_ui_button",r.onClick=function(e){var o=n.for;!1!==(e=!!a&&a.call(this,e))&&("xhr"!==e&&t.getContentElement(o[0],o[1]).submit(),this.disable())},t.on("load",(function(){t.getContentElement(n.for[0],n.for[1])._.buttons.push(i)})),CKEDITOR.ui.dialog.button.call(this,t,r,o)}},html:function(){var e=/^\s*<[\w:]+\s+([^>]*)?>/,t=/^(\s*<[\w:]+(?:\s+[^>]*)?)((?:.|\r|\n)+)$/,n=/\/$/;return function(o,i,r){if(!(3>arguments.length)){var a=[],s=i.html;"<"!=s.charAt(0)&&(s="<span>"+s+"</span>");var l=i.focus;if(l){var u=this.focus;this.focus=function(){("function"==typeof l?l:u).call(this),this.fire("focus")},i.isFocusable&&(this.isFocusable=this.isFocusable),this.keyboardFocusable=!0}CKEDITOR.ui.dialog.uiElement.call(this,o,i,a,"span",null,null,""),a=a.join("").match(e),s=s.match(t)||["","",""],n.test(s[1])&&(s[1]=s[1].slice(0,-1),s[2]="/"+s[2]),r.push([s[1]," ",a[1]||"",s[2]].join(""))}}}(),fieldset:function(e,t,n,o,i){var r=i.label;this._={children:t},CKEDITOR.ui.dialog.uiElement.call(this,e,i,o,"fieldset",null,null,(function(){var e=[];r&&e.push("<legend"+(i.labelStyle?' style="'+i.labelStyle+'"':"")+">"+r+"</legend>");for(var t=0;t<n.length;t++)e.push(n[t]);return e.join("")}))}},!0),CKEDITOR.ui.dialog.html.prototype=new CKEDITOR.ui.dialog.uiElement,CKEDITOR.ui.dialog.labeledElement.prototype=CKEDITOR.tools.extend(new CKEDITOR.ui.dialog.uiElement,{setLabel:function(e){var t=CKEDITOR.document.getById(this._.labelId);return 1>t.getChildCount()?new CKEDITOR.dom.text(e,CKEDITOR.document).appendTo(t):t.getChild(0).$.nodeValue=e,this},getLabel:function(){var e=CKEDITOR.document.getById(this._.labelId);return!e||1>e.getChildCount()?"":e.getChild(0).getText()},eventProcessors:i},!0),CKEDITOR.ui.dialog.button.prototype=CKEDITOR.tools.extend(new CKEDITOR.ui.dialog.uiElement,{click:function(){return!this._.disabled&&this.fire("click",{dialog:this._.dialog})},enable:function(){this._.disabled=!1;var e=this.getElement();e&&e.removeClass("cke_disabled")},disable:function(){this._.disabled=!0,this.getElement().addClass("cke_disabled")},isVisible:function(){return this.getElement().getFirst().isVisible()},isEnabled:function(){return!this._.disabled},eventProcessors:CKEDITOR.tools.extend({},CKEDITOR.ui.dialog.uiElement.prototype.eventProcessors,{onClick:function(e,t){this.on("click",(function(){t.apply(this,arguments)}))}},!0),accessKeyUp:function(){this.click()},accessKeyDown:function(){this.focus()},keyboardFocusable:!0},!0),CKEDITOR.ui.dialog.textInput.prototype=CKEDITOR.tools.extend(new CKEDITOR.ui.dialog.labeledElement,{getInputElement:function(){return CKEDITOR.document.getById(this._.inputId)},focus:function(){var e=this.selectParentTab();setTimeout((function(){var t=e.getInputElement();t&&t.$.focus()}),0)},select:function(){var e=this.selectParentTab();setTimeout((function(){var t=e.getInputElement();t&&(t.$.focus(),t.$.select())}),0)},accessKeyUp:function(){this.select()},setValue:function(e){if(this.bidi){var t=e&&e.charAt(0);(t="‪"==t?"ltr":"‫"==t?"rtl":null)&&(e=e.slice(1)),this.setDirectionMarker(t)}return e||(e=""),CKEDITOR.ui.dialog.uiElement.prototype.setValue.apply(this,arguments)},getValue:function(){var e=CKEDITOR.ui.dialog.uiElement.prototype.getValue.call(this);if(this.bidi&&e){var t=this.getDirectionMarker();t&&(e=("ltr"==t?"‪":"‫")+e)}return e},setDirectionMarker:function(e){var t=this.getInputElement();e?t.setAttributes({dir:e,"data-cke-dir-marker":e}):this.getDirectionMarker()&&t.removeAttributes(["dir","data-cke-dir-marker"])},getDirectionMarker:function(){return this.getInputElement().data("cke-dir-marker")},keyboardFocusable:!0},o,!0),CKEDITOR.ui.dialog.textarea.prototype=new CKEDITOR.ui.dialog.textInput,CKEDITOR.ui.dialog.select.prototype=CKEDITOR.tools.extend(new CKEDITOR.ui.dialog.labeledElement,{getInputElement:function(){return this._.select.getElement()},add:function(e,t,n){var o=new CKEDITOR.dom.element("option",this.getDialog().getParentEditor().document),i=this.getInputElement().$;return o.$.text=e,o.$.value=null==t?e:t,null==n?CKEDITOR.env.ie?i.add(o.$):i.add(o.$,null):i.add(o.$,n),this},remove:function(e){return this.getInputElement().$.remove(e),this},clear:function(){for(var e=this.getInputElement().$;0<e.length;)e.remove(0);return this},keyboardFocusable:!0},o,!0),CKEDITOR.ui.dialog.checkbox.prototype=CKEDITOR.tools.extend(new CKEDITOR.ui.dialog.uiElement,{getInputElement:function(){return this._.checkbox.getElement()},setValue:function(e,t){this.getInputElement().$.checked=e,!t&&this.fire("change",{value:e})},getValue:function(){return this.getInputElement().$.checked},accessKeyUp:function(){this.setValue(!this.getValue())},eventProcessors:{onChange:function(e,t){return!CKEDITOR.env.ie||8<CKEDITOR.env.version?i.onChange.apply(this,arguments):(e.on("load",(function(){var e=this._.checkbox.getElement();e.on("propertychange",(function(t){"checked"==(t=t.data.$).propertyName&&this.fire("change",{value:e.$.checked})}),this)}),this),this.on("change",t),null)}},keyboardFocusable:!0},o,!0),CKEDITOR.ui.dialog.radio.prototype=CKEDITOR.tools.extend(new CKEDITOR.ui.dialog.uiElement,{setValue:function(e,t){for(var n,o=this._.children,i=0;i<o.length&&(n=o[i]);i++)n.getElement().$.checked=n.getValue()==e;!t&&this.fire("change",{value:e})},getValue:function(){for(var e=this._.children,t=0;t<e.length;t++)if(e[t].getElement().$.checked)return e[t].getValue();return null},accessKeyUp:function(){var e,t=this._.children;for(e=0;e<t.length;e++)if(t[e].getElement().$.checked)return void t[e].getElement().focus();t[0].getElement().focus()},eventProcessors:{onChange:function(e,t){return!CKEDITOR.env.ie||8<CKEDITOR.env.version?i.onChange.apply(this,arguments):(e.on("load",(function(){for(var e=this._.children,t=this,n=0;n<e.length;n++)e[n].getElement().on("propertychange",(function(e){"checked"==(e=e.data.$).propertyName&&this.$.checked&&t.fire("change",{value:this.getAttribute("value")})}))}),this),this.on("change",t),null)}}},o,!0),CKEDITOR.ui.dialog.file.prototype=CKEDITOR.tools.extend(new CKEDITOR.ui.dialog.labeledElement,o,{getInputElement:function(){var e=CKEDITOR.document.getById(this._.frameId).getFrameDocument();return 0<e.$.forms.length?new CKEDITOR.dom.element(e.$.forms[0].elements[0]):this.getElement()},submit:function(){return this.getInputElement().getParent().$.submit(),this},getAction:function(){return this.getInputElement().getParent().$.action},registerEvents:function(e){var t,n,o=/^on([A-Z]\w+)/,i=function(e,t,n,o){e.on("formLoaded",(function(){e.getInputElement().on(n,o,e)}))};for(n in e)(t=n.match(o))&&(this.eventProcessors[n]?this.eventProcessors[n].call(this,this._.dialog,e[n]):i(this,0,t[1].toLowerCase(),e[n]));return this},reset:function(){function e(){n.$.open();var e="";o.size&&(e=o.size-(CKEDITOR.env.ie?7:0));var u=t.frameId+"_input";for(n.$.write(['<html dir="'+s+'" lang="'+l+'"><head><title></title></head><body style="margin: 0; overflow: hidden; background: transparent;">','<form enctype="multipart/form-data" method="POST" dir="'+s+'" lang="'+l+'" action="',CKEDITOR.tools.htmlEncode(o.action),'"><label id="',t.labelId,'" for="',u,'" style="display:none">',CKEDITOR.tools.htmlEncode(o.label),'</label><input style="width:100%" id="',u,'" aria-labelledby="',t.labelId,'" type="file" name="',CKEDITOR.tools.htmlEncode(o.id||"cke_upload"),'" size="',CKEDITOR.tools.htmlEncode(0<e?e:""),'" /></form></body></html><script>',CKEDITOR.env.ie?"("+CKEDITOR.tools.fixDomain+")();":"","window.parent.CKEDITOR.tools.callFunction("+r+");","window.onbeforeunload = function() {window.parent.CKEDITOR.tools.callFunction("+a+")}","<\/script>"].join("")),n.$.close(),e=0;e<i.length;e++)i[e].enable()}var t=this._,n=CKEDITOR.document.getById(t.frameId).getFrameDocument(),o=t.definition,i=t.buttons,r=this.formLoadedNumber,a=this.formUnloadNumber,s=t.dialog._.editor.lang.dir,l=t.dialog._.editor.langCode;r||(r=this.formLoadedNumber=CKEDITOR.tools.addFunction((function(){this.fire("formLoaded")}),this),a=this.formUnloadNumber=CKEDITOR.tools.addFunction((function(){this.getInputElement().clearCustomData()}),this),this.getDialog()._.editor.on("destroy",(function(){CKEDITOR.tools.removeFunction(r),CKEDITOR.tools.removeFunction(a)}))),CKEDITOR.env.gecko?setTimeout(e,500):e()},getValue:function(){return this.getInputElement().$.value||""},setInitValue:function(){this._.initValue=""},eventProcessors:{onChange:function(e,t){this._.domOnChangeRegistered||(this.on("formLoaded",(function(){this.getInputElement().on("change",(function(){this.fire("change",{value:this.getValue()})}),this)}),this),this._.domOnChangeRegistered=!0),this.on("change",t)}},keyboardFocusable:!0},!0),CKEDITOR.ui.dialog.fileButton.prototype=new CKEDITOR.ui.dialog.button,CKEDITOR.ui.dialog.fieldset.prototype=CKEDITOR.tools.clone(CKEDITOR.ui.dialog.hbox.prototype),CKEDITOR.dialog.addUIElement("text",t),CKEDITOR.dialog.addUIElement("password",t),CKEDITOR.dialog.addUIElement("tel",t),CKEDITOR.dialog.addUIElement("textarea",n),CKEDITOR.dialog.addUIElement("checkbox",n),CKEDITOR.dialog.addUIElement("radio",n),CKEDITOR.dialog.addUIElement("button",n),CKEDITOR.dialog.addUIElement("select",n),CKEDITOR.dialog.addUIElement("file",n),CKEDITOR.dialog.addUIElement("fileButton",n),CKEDITOR.dialog.addUIElement("html",n),CKEDITOR.dialog.addUIElement("fieldset",{build:function(e,t,n){for(var o,i=t.children,r=[],a=[],s=0;s<i.length&&(o=i[s]);s++){var l=[];r.push(l),a.push(CKEDITOR.dialog._.uiElementBuilders[o.type].build(e,o,l))}return new CKEDITOR.ui.dialog[t.type](e,a,r,n,t)}})}}),CKEDITOR.DIALOG_RESIZE_NONE=0,CKEDITOR.DIALOG_RESIZE_WIDTH=1,CKEDITOR.DIALOG_RESIZE_HEIGHT=2,CKEDITOR.DIALOG_RESIZE_BOTH=3,CKEDITOR.DIALOG_STATE_IDLE=1,CKEDITOR.DIALOG_STATE_BUSY=2,function(){function e(){for(var e=this._.tabIdList.length,t=CKEDITOR.tools.indexOf(this._.tabIdList,this._.currentTabId)+e,n=t-1;n>t-e;n--)if(this._.tabs[this._.tabIdList[n%e]][0].$.offsetHeight)return this._.tabIdList[n%e];return null}function t(){for(var e=this._.tabIdList.length,t=CKEDITOR.tools.indexOf(this._.tabIdList,this._.currentTabId),n=t+1;n<t+e;n++)if(this._.tabs[this._.tabIdList[n%e]][0].$.offsetHeight)return this._.tabIdList[n%e];return null}function n(e,t){for(var n=e.$.getElementsByTagName("input"),o=0,i=n.length;o<i;o++){var r=new CKEDITOR.dom.element(n[o]);"text"==r.getAttribute("type").toLowerCase()&&(t?(r.setAttribute("value",r.getCustomData("fake_value")||""),r.removeCustomData("fake_value")):(r.setCustomData("fake_value",r.getAttribute("value")),r.setAttribute("value","")))}}function o(e,t){var n=this.getInputElement();n&&(e?n.removeAttribute("aria-invalid"):n.setAttribute("aria-invalid",!0)),e||(this.select?this.select():this.focus()),t&&alert(t),this.fire("validated",{valid:e,msg:t})}function i(){var e=this.getInputElement();e&&e.removeAttribute("aria-invalid")}function r(e,t,n){this.element=t,this.focusIndex=n,this.tabIndex=0,this.isFocusable=function(){return!t.getAttribute("disabled")&&t.isVisible()},this.focus=function(){e._.currentFocusIndex=this.focusIndex,this.element.focus()},t.on("keydown",(function(e){e.data.getKeystroke()in{32:1,13:1}&&this.fire("click")})),t.on("focus",(function(){this.fire("mouseover")})),t.on("blur",(function(){this.fire("mouseout")}))}function a(e,t){this._={dialog:e},CKEDITOR.tools.extend(this,t)}function s(e,t,n){var o=e.parts.dialog.getParent().getClientSize(),i=e.getSize(),r=e._.viewportRatio,a=Math.max(o.width-i.width,0);o=Math.max(o.height-i.height,0),r.width=a?t/a:r.width,r.height=o?n/o:r.height,e._.viewportRatio=r}function l(e){e.data.preventDefault(1)}function u(e){var t=e.config,n=CKEDITOR.skinName||e.config.skin,o=t.dialog_backgroundCoverColor||("moono-lisa"==n?"black":"white"),i=(n=t.dialog_backgroundCoverOpacity,t.baseFloatZIndex),r=(t=CKEDITOR.tools.genKey(o,n,i),C[t]);CKEDITOR.document.getBody().addClass("cke_dialog_open"),r?r.show():(i=['<div tabIndex="-1" style="position: ',CKEDITOR.env.ie6Compat?"absolute":"fixed","; z-index: ",i,"; top: 0px; left: 0px; ","; width: 100%; height: 100%;",CKEDITOR.env.ie6Compat?"":"background-color: "+o,'" class="cke_dialog_background_cover">'],CKEDITOR.env.ie6Compat&&(o="<html><body style=\\'background-color:"+o+";\\'></body></html>",i.push('<iframe hidefocus="true" frameborder="0" id="cke_dialog_background_iframe" src="javascript:'),i.push("void((function(){"+encodeURIComponent("document.open();("+CKEDITOR.tools.fixDomain+")();document.write( '"+o+"' );document.close();")+"})())"),i.push('" style="position:absolute;left:0;top:0;width:100%;height: 100%;filter: progid:DXImageTransform.Microsoft.Alpha(opacity=0)"></iframe>')),i.push("</div>"),(r=CKEDITOR.dom.element.createFromHtml(i.join(""))).setOpacity(void 0!==n?n:.5),r.on("keydown",l),r.on("keypress",l),r.on("keyup",l),r.appendTo(CKEDITOR.document.getBody()),C[t]=r),e.focusManager.add(r),b=r,CKEDITOR.env.mac&&CKEDITOR.env.webkit||r.focus()}function c(e){CKEDITOR.document.getBody().removeClass("cke_dialog_open"),b&&(e.focusManager.remove(b),b.hide())}var d=CKEDITOR.tools.cssLength,f=!CKEDITOR.env.ie||CKEDITOR.env.edge,h='<div class="cke_reset_all cke_dialog_container {editorId} {editorDialogClass} {hidpi}" dir="{langDir}" style="'+(f?"display:flex":"")+'" lang="{langCode}" role="dialog" aria-labelledby="cke_dialog_title_{id}"><table class="cke_dialog '+CKEDITOR.env.cssClass+' cke_{langDir}" style="'+(f?"margin:auto":"position:absolute")+'" role="presentation"><tr><td role="presentation"><div class="cke_dialog_body" role="presentation"><div id="cke_dialog_title_{id}" class="cke_dialog_title" role="presentation"></div><a id="cke_dialog_close_button_{id}" class="cke_dialog_close_button" href="javascript:void(0)" title="{closeTitle}" role="button"><span class="cke_label">X</span></a><div id="cke_dialog_tabs_{id}" class="cke_dialog_tabs" role="tablist"></div><table class="cke_dialog_contents" role="presentation"><tr><td id="cke_dialog_contents_{id}" class="cke_dialog_contents_body" role="presentation"></td></tr><tr><td id="cke_dialog_footer_{id}" class="cke_dialog_footer" role="presentation"></td></tr></table></div></td></tr></table></div>';CKEDITOR.dialog=function(n,r){function a(e){var t=x._.focusList;if(e=e||0,!(1>t.length)){var n=x._.currentFocusIndex;x._.tabBarMode&&0>e&&(n=0);try{t[n].getInputElement().$.blur()}catch(l){}var o=n,i=1<x._.pageCount;do{if(o+=e,i&&!x._.tabBarMode&&(o==t.length||-1==o))return x._.tabBarMode=!0,x._.tabs[x._.currentTabId][0].focus(),void(x._.currentFocusIndex=-1);if((o=(o+t.length)%t.length)==n)break}while(e&&!t[o].isFocusable());t[o].focus(),"text"==t[o].type&&t[o].select()}}function l(o){if(x==CKEDITOR.dialog._.currentTop){var i=o.data.getKeystroke(),r="rtl"==n.lang.dir;if(c=d=0,9==i||i==CKEDITOR.SHIFT+9)a(i==CKEDITOR.SHIFT+9?-1:1),c=1;else if(i==CKEDITOR.ALT+121&&!x._.tabBarMode&&1<x.getPageCount())x._.tabBarMode=!0,x._.tabs[x._.currentTabId][0].focus(),x._.currentFocusIndex=-1,c=1;else if(-1!=CKEDITOR.tools.indexOf([37,38,39,40],i)&&x._.tabBarMode)i=-1!=CKEDITOR.tools.indexOf([r?39:37,38],i)?e.call(x):t.call(x),x.selectPage(i),x._.tabs[i][0].focus(),c=1;else if(13!=i&&32!=i||!x._.tabBarMode)if(13==i)(i=o.data.getTarget()).is("a","button","select","textarea")||i.is("input")&&"button"==i.$.type||((i=this.getButton("ok"))&&CKEDITOR.tools.setTimeout(i.click,0,i),c=1),d=1;else{if(27!=i)return;(i=this.getButton("cancel"))?CKEDITOR.tools.setTimeout(i.click,0,i):!1!==this.fire("cancel",{hide:!0}).hide&&this.hide(),d=1}else this.selectPage(this._.currentTabId),this._.tabBarMode=!1,this._.currentFocusIndex=-1,a(1),c=1;u(o)}}function u(e){c?e.data.preventDefault(1):d&&e.data.stopPropagation()}var c,d,f=CKEDITOR.dialog._.dialogDefinitions[r],m=CKEDITOR.tools.clone(g),p=n.config.dialog_buttonsOrder||"OS",v=n.lang.dir,C={};if(("OS"==p&&CKEDITOR.env.mac||"rtl"==p&&"ltr"==v||"ltr"==p&&"rtl"==v)&&m.buttons.reverse(),f=CKEDITOR.tools.extend(f(n),m),f=CKEDITOR.tools.clone(f),f=new y(this,f),m=function(e){var t=CKEDITOR.dom.element.createFromHtml(CKEDITOR.addTemplate("dialog",h).output({id:CKEDITOR.tools.getNextNumber(),editorId:e.id,langDir:e.lang.dir,langCode:e.langCode,editorDialogClass:"cke_editor_"+e.name.replace(/\./g,"\\.")+"_dialog",closeTitle:e.lang.common.close,hidpi:CKEDITOR.env.hidpi?"cke_hidpi":""})),n=t.getChild([0,0,0,0,0]),o=n.getChild(0),i=n.getChild(1);return e.plugins.clipboard&&CKEDITOR.plugins.clipboard.preventDefaultDropOnElement(n),!CKEDITOR.env.ie||CKEDITOR.env.quirks||CKEDITOR.env.edge||(e="javascript:void(function(){"+encodeURIComponent("document.open();("+CKEDITOR.tools.fixDomain+")();document.close();")+"}())",CKEDITOR.dom.element.createFromHtml('<iframe frameBorder="0" class="cke_iframe_shim" src="'+e+'" tabIndex="-1"></iframe>').appendTo(n.getParent())),o.unselectable(),i.unselectable(),{element:t,parts:{dialog:t.getChild(0),title:o,close:i,tabs:n.getChild(2),contents:n.getChild([3,0,0,0]),footer:n.getChild([3,0,1,0])}}}(n),this._={editor:n,element:m.element,name:r,model:null,contentSize:{width:0,height:0},size:{width:0,height:0},contents:{},buttons:{},accessKeyMap:{},viewportRatio:{width:.5,height:.5},tabs:{},tabIdList:[],currentTabId:null,currentTabIndex:null,pageCount:0,lastTab:null,tabBarMode:!1,focusList:[],currentFocusIndex:0,hasFocus:!1},this.parts=m.parts,CKEDITOR.tools.setTimeout((function(){n.fire("ariaWidget",this.parts.contents)}),0,this),m={top:0,visibility:"hidden"},CKEDITOR.env.ie6Compat&&(m.position="absolute"),m["rtl"==v?"right":"left"]=0,this.parts.dialog.setStyles(m),CKEDITOR.event.call(this),this.definition=f=CKEDITOR.fire("dialogDefinition",{name:r,definition:f,dialog:this},n).definition,!("removeDialogTabs"in n._)&&n.config.removeDialogTabs){for(m=n.config.removeDialogTabs.split(";"),v=0;v<m.length;v++)if(2==(p=m[v].split(":")).length){var T=p[0];C[T]||(C[T]=[]),C[T].push(p[1])}n._.removeDialogTabs=C}if(n._.removeDialogTabs&&(C=n._.removeDialogTabs[r]))for(v=0;v<C.length;v++)f.removeContents(C[v]);f.onLoad&&this.on("load",f.onLoad),f.onShow&&this.on("show",f.onShow),f.onHide&&this.on("hide",f.onHide),f.onOk&&this.on("ok",(function(e){n.fire("saveSnapshot"),setTimeout((function(){n.fire("saveSnapshot")}),0),!1===f.onOk.call(this,e)&&(e.data.hide=!1)})),this.state=CKEDITOR.DIALOG_STATE_IDLE,f.onCancel&&this.on("cancel",(function(e){!1===f.onCancel.call(this,e)&&(e.data.hide=!1)}));var x=this,E=function(e){var t,n=x._.contents;for(t in n)for(var o in n[t])if(e.call(this,n[t][o]))return};this.on("ok",(function(e){E((function(t){if(t.validate){var n=t.validate(this),i="string"==typeof n||!1===n;return i&&(e.data.hide=!1,e.stop()),o.call(t,!i,"string"==typeof n?n:void 0),i}}))}),this,null,0),this.on("cancel",(function(e){E((function(t){if(t.isChanged())return n.config.dialog_noConfirmCancel||confirm(n.lang.common.confirmCancel)||(e.data.hide=!1),!0}))}),this,null,0),this.parts.close.on("click",(function(e){!1!==this.fire("cancel",{hide:!0}).hide&&this.hide(),e.data.preventDefault()}),this),this.changeFocus=a;var _=this._.element;for(n.focusManager.add(_,1),this.on("show",(function(){_.on("keydown",l,this),CKEDITOR.env.gecko&&_.on("keypress",u,this)})),this.on("hide",(function(){_.removeListener("keydown",l),CKEDITOR.env.gecko&&_.removeListener("keypress",u),E((function(e){i.apply(e)}))})),this.on("iframeAdded",(function(e){new CKEDITOR.dom.document(e.data.iframe.$.contentWindow.document).on("keydown",l,this,null,0)})),this.on("show",(function(){!function(){var e=x._.focusList;e.sort((function(e,t){return e.tabIndex!=t.tabIndex?t.tabIndex-e.tabIndex:e.focusIndex-t.focusIndex}));for(var t=e.length,n=0;n<t;n++)e[n].focusIndex=n}();var e=1<x._.pageCount;n.config.dialog_startupFocusTab&&e?(x._.tabBarMode=!0,x._.tabs[x._.currentTabId][0].focus(),x._.currentFocusIndex=-1):this._.hasFocus||(this._.currentFocusIndex=e?-1:this._.focusList.length-1,f.onFocus?(e=f.onFocus.call(this))&&e.focus():a(1))}),this,null,4294967295),CKEDITOR.env.ie6Compat&&this.on("load",(function(){var e=this.getElement(),t=e.getFirst();t.remove(),t.appendTo(e)}),this),function(e){function t(t){var n=e.getSize(),l=e.parts.dialog.getParent().getClientSize(),u=t.data.$.screenX,c=t.data.$.screenY,d=u-o.x,f=c-o.y;o={x:u,y:c},i.x+=d,i.y+=f,u=i.x+s[3]<a?-s[3]:i.x-s[1]>l.width-n.width-a?l.width-n.width+("rtl"==r.lang.dir?0:s[1]):i.x,n=i.y+s[0]<a?-s[0]:i.y-s[2]>l.height-n.height-a?l.height-n.height+s[2]:i.y,u=Math.floor(u),n=Math.floor(n),e.move(u,n,1),t.data.preventDefault()}function n(){if(CKEDITOR.document.removeListener("mousemove",t),CKEDITOR.document.removeListener("mouseup",n),CKEDITOR.env.ie6Compat){var e=b.getChild(0).getFrameDocument();e.removeListener("mousemove",t),e.removeListener("mouseup",n)}}var o=null,i=null,r=e.getParentEditor(),a=r.config.dialog_magnetDistance,s=CKEDITOR.skin.margins||[0,0,0,0];void 0===a&&(a=20),e.parts.title.on("mousedown",(function(r){if(!e._.moved){var a=e._.element;a.getFirst().setStyle("position","absolute"),a.removeStyle("display"),e._.moved=!0,e.layout()}o={x:r.data.$.screenX,y:r.data.$.screenY},CKEDITOR.document.on("mousemove",t),CKEDITOR.document.on("mouseup",n),i=e.getPosition(),CKEDITOR.env.ie6Compat&&((a=b.getChild(0).getFrameDocument()).on("mousemove",t),a.on("mouseup",n)),r.data.preventDefault()}),e)}(this),function(e){function t(t){var n="rtl"==f.lang.dir,d=c.width,h=c.height,g=d+(t.data.$.screenX-u.x)*(n?-1:1)*(e._.moved?1:2),m=h+(t.data.$.screenY-u.y)*(e._.moved?1:2),p=e._.element.getFirst(),v=(p=n&&parseInt(p.getComputedStyle("right")),e.getPosition());v.x=v.x||0,v.y=v.y||0,v.y+m>l.height&&(m=l.height-v.y),(n?p:v.x)+g>l.width&&(g=l.width-(n?p:v.x)),m=Math.floor(m),g=Math.floor(g),i!=CKEDITOR.DIALOG_RESIZE_WIDTH&&i!=CKEDITOR.DIALOG_RESIZE_BOTH||(d=Math.max(o.minWidth||0,g-r)),i!=CKEDITOR.DIALOG_RESIZE_HEIGHT&&i!=CKEDITOR.DIALOG_RESIZE_BOTH||(h=Math.max(o.minHeight||0,m-a)),e.resize(d,h),e._.moved&&s(e,e._.position.x,e._.position.y),e._.moved||e.layout(),t.data.preventDefault()}function n(){if(CKEDITOR.document.removeListener("mouseup",n),CKEDITOR.document.removeListener("mousemove",t),d&&(d.remove(),d=null),CKEDITOR.env.ie6Compat){var e=b.getChild(0).getFrameDocument();e.removeListener("mouseup",n),e.removeListener("mousemove",t)}}var o=e.definition,i=o.resizable;if(i!=CKEDITOR.DIALOG_RESIZE_NONE){var r,a,l,u,c,d,f=e.getParentEditor(),h=CKEDITOR.tools.addFunction((function(o){function i(e){return e.isVisible()}c=e.getSize();var s=e.parts.contents,f=s.$.getElementsByTagName("iframe").length,h=!(CKEDITOR.env.gecko||CKEDITOR.env.ie&&CKEDITOR.env.quirks);f&&(d=CKEDITOR.dom.element.createFromHtml('<div class="cke_dialog_resize_cover" style="height: 100%; position: absolute; width: 100%; left:0; top:0;"></div>'),s.append(d)),a=c.height-e.parts.contents.getFirst(i).getSize("height",h),r=c.width-e.parts.contents.getFirst(i).getSize("width",1),u={x:o.screenX,y:o.screenY},l=CKEDITOR.document.getWindow().getViewPaneSize(),CKEDITOR.document.on("mousemove",t),CKEDITOR.document.on("mouseup",n),CKEDITOR.env.ie6Compat&&((s=b.getChild(0).getFrameDocument()).on("mousemove",t),s.on("mouseup",n)),o.preventDefault&&o.preventDefault()}));e.on("load",(function(){var t="";i==CKEDITOR.DIALOG_RESIZE_WIDTH?t=" cke_resizer_horizontal":i==CKEDITOR.DIALOG_RESIZE_HEIGHT&&(t=" cke_resizer_vertical"),t=CKEDITOR.dom.element.createFromHtml('<div class="cke_resizer'+t+" cke_resizer_"+f.lang.dir+'" title="'+CKEDITOR.tools.htmlEncode(f.lang.common.resize)+'" onmousedown="CKEDITOR.tools.callFunction('+h+', event )">'+("ltr"==f.lang.dir?"◢":"◣")+"</div>"),e.parts.footer.append(t,1)})),f.on("destroy",(function(){CKEDITOR.tools.removeFunction(h)}))}}(this),new CKEDITOR.dom.text(f.title,CKEDITOR.document).appendTo(this.parts.title),v=0;v<f.contents.length;v++)(C=f.contents[v])&&this.addPage(C);for(this.parts.tabs.on("click",(function(e){var t=e.data.getTarget();t.hasClass("cke_dialog_tab")&&(this.selectPage((t=t.$.id).substring(4,t.lastIndexOf("_"))),this._.tabBarMode&&(this._.tabBarMode=!1,this._.currentFocusIndex=-1,a(1)),e.data.preventDefault())}),this),v=[],C=CKEDITOR.dialog._.uiElementBuilders.hbox.build(this,{type:"hbox",className:"cke_dialog_footer_buttons",widths:[],children:f.buttons},v).getChild(),this.parts.footer.setHtml(v.join("")),v=0;v<C.length;v++)this._.buttons[C[v].id]=C[v]},CKEDITOR.dialog.prototype={destroy:function(){this.hide(),this._.element.remove()},resize:function(e,t){if(!this._.contentSize||this._.contentSize.width!=e||this._.contentSize.height!=t){if(CKEDITOR.dialog.fire("resize",{dialog:this,width:e,height:t},this._.editor),this.fire("resize",{width:e,height:t},this._.editor),this.parts.contents.setStyles({width:e+"px",height:t+"px"}),"rtl"==this._.editor.lang.dir&&this._.position){var n=this.parts.dialog.getParent().getClientSize().width;this._.position.x=n-this._.contentSize.width-parseInt(this._.element.getFirst().getStyle("right"),10)}this._.contentSize={width:e,height:t}}},getSize:function(){var e=this._.element.getFirst();return{width:e.$.offsetWidth||0,height:e.$.offsetHeight||0}},move:function(e,t,n){var o=this._.element.getFirst(),i="rtl"==this._.editor.lang.dir;CKEDITOR.env.ie&&o.setStyle("zoom","100%");var r=this.parts.dialog.getParent().getClientSize(),a=this.getSize(),l=this._.viewportRatio,u=Math.max(r.width-a.width,0);r=Math.max(r.height-a.height,0),this._.position&&this._.position.x==e&&this._.position.y==t?(e=Math.floor(u*l.width),t=Math.floor(r*l.height)):s(this,e,t),this._.position={x:e,y:t},i&&(e=u-e),(t={top:(0<t?t:0)+"px"})[i?"right":"left"]=(0<e?e:0)+"px",o.setStyles(t),n&&(this._.moved=1)},getPosition:function(){return CKEDITOR.tools.extend({},this._.position)},show:function(){var e=this._.element,t=this.definition;for(var n in e.getParent()&&e.getParent().equals(CKEDITOR.document.getBody())?e.setStyle("display",f?"flex":"block"):e.appendTo(CKEDITOR.document.getBody()),this.resize(this._.contentSize&&this._.contentSize.width||t.width||t.minWidth,this._.contentSize&&this._.contentSize.height||t.height||t.minHeight),this.reset(),null===this._.currentTabId&&this.selectPage(this.definition.contents[0].id),null===CKEDITOR.dialog._.currentZIndex&&(CKEDITOR.dialog._.currentZIndex=this._.editor.config.baseFloatZIndex),this._.element.getFirst().setStyle("z-index",CKEDITOR.dialog._.currentZIndex+=10),null===CKEDITOR.dialog._.currentTop?(CKEDITOR.dialog._.currentTop=this,this._.parentDialog=null,u(this._.editor)):(this._.parentDialog=CKEDITOR.dialog._.currentTop,this._.parentDialog.getElement().getFirst().$.style.zIndex-=Math.floor(this._.editor.config.baseFloatZIndex/2),CKEDITOR.dialog._.currentTop=this),e.on("keydown",x),e.on("keyup",E),this._.hasFocus=!1,t.contents)if(t.contents[n]){var o=this._.tabs[(e=t.contents[n]).id],i=e.requiredContent,r=0;if(o){for(var a in this._.contents[e.id]){var s=this._.contents[e.id][a];"hbox"!=s.type&&"vbox"!=s.type&&s.getInputElement()&&(s.requiredContent&&!this._.editor.activeFilter.check(s.requiredContent)?s.disable():(s.enable(),r++))}!r||i&&!this._.editor.activeFilter.check(i)?o[0].addClass("cke_dialog_tab_disabled"):o[0].removeClass("cke_dialog_tab_disabled")}}CKEDITOR.tools.setTimeout((function(){this.layout(),function(e){function t(){e.layout()}var n=CKEDITOR.document.getWindow();n.on("resize",t),e.on("hide",(function(){n.removeListener("resize",t)}))}(this),this.parts.dialog.setStyle("visibility",""),this.fireOnce("load",{}),CKEDITOR.ui.fire("ready",this),this.fire("show",{}),this._.editor.fire("dialogShow",this),this._.parentDialog||this._.editor.focusManager.lock(),this.foreach((function(e){e.setInitValue&&e.setInitValue()}))}),100,this)},layout:function(){var e=this.parts.dialog;if(this._.moved||!f){var t,n=this.getSize(),o=CKEDITOR.document.getWindow().getViewPaneSize();this._.moved&&this._.position?(t=this._.position.x,n=this._.position.y):(t=(o.width-n.width)/2,n=(o.height-n.height)/2),CKEDITOR.env.ie6Compat||(e.setStyle("position","absolute"),e.removeStyle("margin")),t=Math.floor(t),n=Math.floor(n),this.move(t,n)}},foreach:function(e){for(var t in this._.contents)for(var n in this._.contents[t])e.call(this,this._.contents[t][n]);return this},reset:function(){var e=function(e){e.reset&&e.reset(1)};return function(){return this.foreach(e),this}}(),setupContent:function(){var e=arguments;this.foreach((function(t){t.setup&&t.setup.apply(t,e)}))},commitContent:function(){var e=arguments;this.foreach((function(t){CKEDITOR.env.ie&&this._.currentFocusIndex==t.focusIndex&&t.getInputElement().$.blur(),t.commit&&t.commit.apply(t,e)}))},hide:function(){if(this.parts.dialog.isVisible()){this.fire("hide",{}),this._.editor.fire("dialogHide",this),this.selectPage(this._.tabIdList[0]);var e=this._.element;for(e.setStyle("display","none"),this.parts.dialog.setStyle("visibility","hidden"),I(this);CKEDITOR.dialog._.currentTop!=this;)CKEDITOR.dialog._.currentTop.hide();if(this._.parentDialog){var t=this._.parentDialog.getElement().getFirst();t.setStyle("z-index",parseInt(t.$.style.zIndex,10)+Math.floor(this._.editor.config.baseFloatZIndex/2))}else c(this._.editor);if(CKEDITOR.dialog._.currentTop=this._.parentDialog)CKEDITOR.dialog._.currentZIndex-=10;else{CKEDITOR.dialog._.currentZIndex=null,e.removeListener("keydown",x),e.removeListener("keyup",E);var n=this._.editor;n.focus(),setTimeout((function(){n.focusManager.unlock(),CKEDITOR.env.iOS&&n.window.focus()}),0)}delete this._.parentDialog,this.foreach((function(e){e.resetInitValue&&e.resetInitValue()})),this.setState(CKEDITOR.DIALOG_STATE_IDLE)}},addPage:function(e){if(!e.requiredContent||this._.editor.filter.check(e.requiredContent)){for(var t=[],n=e.label?' title="'+CKEDITOR.tools.htmlEncode(e.label)+'"':"",o=CKEDITOR.dialog._.uiElementBuilders.vbox.build(this,{type:"vbox",className:"cke_dialog_page_contents",children:e.elements,expand:!!e.expand,padding:e.padding,style:e.style||"width: 100%;"},t),i=this._.contents[e.id]={},r=o.getChild(),a=0;o=r.shift();)o.notAllowed||"hbox"==o.type||"vbox"==o.type||a++,i[o.id]=o,"function"==typeof o.getChild&&r.push.apply(r,o.getChild());a||(e.hidden=!0),(t=CKEDITOR.dom.element.createFromHtml(t.join(""))).setAttribute("role","tabpanel"),t.setStyle("min-height","100%"),o=CKEDITOR.env,i="cke_"+e.id+"_"+CKEDITOR.tools.getNextNumber(),n=CKEDITOR.dom.element.createFromHtml(['<a class="cke_dialog_tab"',0<this._.pageCount?" cke_last":"cke_first",n,e.hidden?' style="display:none"':"",' id="',i,'"',o.gecko&&!o.hc?"":' href="javascript:void(0)"',' tabIndex="-1" hidefocus="true" role="tab">',e.label,"</a>"].join("")),t.setAttribute("aria-labelledby",i),this._.tabs[e.id]=[n,t],this._.tabIdList.push(e.id),!e.hidden&&this._.pageCount++,this._.lastTab=n,this.updateStyle(),t.setAttribute("name",e.id),t.appendTo(this.parts.contents),n.unselectable(),this.parts.tabs.append(n),e.accessKey&&(_(this,this,"CTRL+"+e.accessKey,O,D),this._.accessKeyMap["CTRL+"+e.accessKey]=e.id)}},selectPage:function(e){if(this._.currentTabId!=e&&!this._.tabs[e][0].hasClass("cke_dialog_tab_disabled")&&!1!==this.fire("selectPage",{page:e,currentPage:this._.currentTabId})){for(var t in this._.tabs){var o=this._.tabs[t][1];t!=e&&(this._.tabs[t][0].removeClass("cke_dialog_tab_selected"),o.hide()),o.setAttribute("aria-hidden",t!=e)}var i=this._.tabs[e];i[0].addClass("cke_dialog_tab_selected"),CKEDITOR.env.ie6Compat||CKEDITOR.env.ie7Compat?(n(i[1]),i[1].show(),setTimeout((function(){n(i[1],1)}),0)):i[1].show(),this._.currentTabId=e,this._.currentTabIndex=CKEDITOR.tools.indexOf(this._.tabIdList,e)}},updateStyle:function(){this.parts.dialog[(1===this._.pageCount?"add":"remove")+"Class"]("cke_single_page")},hidePage:function(t){var n=this._.tabs[t]&&this._.tabs[t][0];n&&1!=this._.pageCount&&n.isVisible()&&(t==this._.currentTabId&&this.selectPage(e.call(this)),n.hide(),this._.pageCount--,this.updateStyle())},showPage:function(e){(e=this._.tabs[e]&&this._.tabs[e][0])&&(e.show(),this._.pageCount++,this.updateStyle())},getElement:function(){return this._.element},getName:function(){return this._.name},getContentElement:function(e,t){var n=this._.contents[e];return n&&n[t]},getValueOf:function(e,t){return this.getContentElement(e,t).getValue()},setValueOf:function(e,t,n){return this.getContentElement(e,t).setValue(n)},getButton:function(e){return this._.buttons[e]},click:function(e){return this._.buttons[e].click()},disableButton:function(e){return this._.buttons[e].disable()},enableButton:function(e){return this._.buttons[e].enable()},getPageCount:function(){return this._.pageCount},getParentEditor:function(){return this._.editor},getSelectedElement:function(){return this.getParentEditor().getSelection().getSelectedElement()},addFocusable:function(e,t){if(void 0===t)this._.focusList.push(new r(this,e,t=this._.focusList.length));else{this._.focusList.splice(t,0,new r(this,e,t));for(var n=t+1;n<this._.focusList.length;n++)this._.focusList[n].focusIndex++}},setState:function(e){if(this.state!=e){if(this.state=e,e==CKEDITOR.DIALOG_STATE_BUSY){if(!this.parts.spinner){var t=this.getParentEditor().lang.dir,n={attributes:{class:"cke_dialog_spinner"},styles:{float:"rtl"==t?"right":"left"}};n.styles["margin-"+("rtl"==t?"left":"right")]="8px",this.parts.spinner=CKEDITOR.document.createElement("div",n),this.parts.spinner.setHtml("&#8987;"),this.parts.spinner.appendTo(this.parts.title,1)}this.parts.spinner.show(),this.getButton("ok").disable()}else e==CKEDITOR.DIALOG_STATE_IDLE&&(this.parts.spinner&&this.parts.spinner.hide(),this.getButton("ok").enable());this.fire("state",e)}},getModel:function(e){return this._.model?this._.model:this.definition.getModel?this.definition.getModel(e):null},setModel:function(e){this._.model=e},getMode:function(e){return this.definition.getMode?this.definition.getMode(e):!(e=this.getModel(e))||e instanceof CKEDITOR.dom.element&&!e.getParent()?CKEDITOR.dialog.CREATION_MODE:CKEDITOR.dialog.EDITING_MODE}},CKEDITOR.tools.extend(CKEDITOR.dialog,{CREATION_MODE:0,EDITING_MODE:1,add:function(e,t){this._.dialogDefinitions[e]&&"function"!=typeof t||(this._.dialogDefinitions[e]=t)},exists:function(e){return!!this._.dialogDefinitions[e]},getCurrent:function(){return CKEDITOR.dialog._.currentTop},isTabEnabled:function(e,t,n){return!((e=e.config.removeDialogTabs)&&e.match(new RegExp("(?:^|;)"+t+":"+n+"(?:$|;)","i")))},okButton:function(){var e=function(e,t){return t=t||{},CKEDITOR.tools.extend({id:"ok",type:"button",label:e.lang.common.ok,class:"cke_dialog_ui_button_ok",onClick:function(e){!1!==(e=e.data.dialog).fire("ok",{hide:!0}).hide&&e.hide()}},t,!0)};return e.type="button",e.override=function(t){return CKEDITOR.tools.extend((function(n){return e(n,t)}),{type:"button"},!0)},e}(),cancelButton:function(){var e=function(e,t){return t=t||{},CKEDITOR.tools.extend({id:"cancel",type:"button",label:e.lang.common.cancel,class:"cke_dialog_ui_button_cancel",onClick:function(e){!1!==(e=e.data.dialog).fire("cancel",{hide:!0}).hide&&e.hide()}},t,!0)};return e.type="button",e.override=function(t){return CKEDITOR.tools.extend((function(n){return e(n,t)}),{type:"button"},!0)},e}(),addUIElement:function(e,t){this._.uiElementBuilders[e]=t}}),CKEDITOR.dialog._={uiElementBuilders:{},dialogDefinitions:{},currentTop:null,currentZIndex:null},CKEDITOR.event.implementOn(CKEDITOR.dialog),CKEDITOR.event.implementOn(CKEDITOR.dialog.prototype);var g={resizable:CKEDITOR.DIALOG_RESIZE_BOTH,minWidth:600,minHeight:400,buttons:[CKEDITOR.dialog.okButton,CKEDITOR.dialog.cancelButton]},m=function(e,t,n){for(var o,i=0;o=e[i];i++)if(o.id==t||n&&o[n]&&(o=m(o[n],t,n)))return o;return null},p=function(e,t,n,o,i){if(n){for(var r,a=0;r=e[a];a++){if(r.id==n)return e.splice(a,0,t),t;if(o&&r[o]&&(r=p(r[o],t,n,o,!0)))return r}if(i)return null}return e.push(t),t},v=function(e,t,n){for(var o,i=0;o=e[i];i++){if(o.id==t)return e.splice(i,1);if(n&&o[n]&&(o=v(o[n],t,n)))return o}return null},y=function(e,t){this.dialog=e;for(var n,o=t.contents,i=0;n=o[i];i++)o[i]=n&&new a(e,n);CKEDITOR.tools.extend(this,t)};y.prototype={getContents:function(e){return m(this.contents,e)},getButton:function(e){return m(this.buttons,e)},addContents:function(e,t){return p(this.contents,e,t)},addButton:function(e,t){return p(this.buttons,e,t)},removeContents:function(e){v(this.contents,e)},removeButton:function(e){v(this.buttons,e)}},a.prototype={get:function(e){return m(this.elements,e,"children")},add:function(e,t){return p(this.elements,e,t,"children")},remove:function(e){v(this.elements,e,"children")}};var b,C={},T={},x=function(e){var t=e.data.$.ctrlKey||e.data.$.metaKey,n=e.data.$.altKey,o=e.data.$.shiftKey,i=String.fromCharCode(e.data.$.keyCode);(t=T[(t?"CTRL+":"")+(n?"ALT+":"")+(o?"SHIFT+":"")+i])&&t.length&&((t=t[t.length-1]).keydown&&t.keydown.call(t.uiElement,t.dialog,t.key),e.data.preventDefault())},E=function(e){var t=e.data.$.ctrlKey||e.data.$.metaKey,n=e.data.$.altKey,o=e.data.$.shiftKey,i=String.fromCharCode(e.data.$.keyCode);(t=T[(t?"CTRL+":"")+(n?"ALT+":"")+(o?"SHIFT+":"")+i])&&t.length&&(t=t[t.length-1]).keyup&&(t.keyup.call(t.uiElement,t.dialog,t.key),e.data.preventDefault())},_=function(e,t,n,o,i){(T[n]||(T[n]=[])).push({uiElement:e,dialog:t,key:n,keyup:i||e.accessKeyUp,keydown:o||e.accessKeyDown})},I=function(e){for(var t in T){for(var n=T[t],o=n.length-1;0<=o;o--)n[o].dialog!=e&&n[o].uiElement!=e||n.splice(o,1);0===n.length&&delete T[t]}},D=function(e,t){e._.accessKeyMap[t]&&e.selectPage(e._.accessKeyMap[t])},O=function(){};CKEDITOR.ui.dialog={uiElement:function(e,t,n,o,i,r,a){if(!(4>arguments.length)){var s=(o.call?o(t):o)||"div",l=["<",s," "],u=(i&&i.call?i(t):i)||{},c=(r&&r.call?r(t):r)||{},d=(a&&a.call?a.call(this,e,t):a)||"",f=this.domId=c.id||CKEDITOR.tools.getNextId()+"_uiElement";t.requiredContent&&!e.getParentEditor().filter.check(t.requiredContent)&&(u.display="none",this.notAllowed=!0),c.id=f;var h={};t.type&&(h["cke_dialog_ui_"+t.type]=1),t.className&&(h[t.className]=1),t.disabled&&(h.cke_disabled=1);var g=c.class&&c.class.split?c.class.split(" "):[];for(f=0;f<g.length;f++)g[f]&&(h[g[f]]=1);for(f in g=[],h)g.push(f);for(f in c.class=g.join(" "),t.title&&(c.title=t.title),h=(t.style||"").split(";"),t.align&&(u["margin-left"]="left"==(g=t.align)?0:"auto",u["margin-right"]="right"==g?0:"auto"),u)h.push(f+":"+u[f]);for(t.hidden&&h.push("display:none"),f=h.length-1;0<=f;f--)""===h[f]&&h.splice(f,1);for(f in 0<h.length&&(c.style=(c.style?c.style+"; ":"")+h.join("; ")),c)l.push(f+'="'+CKEDITOR.tools.htmlEncode(c[f])+'" ');l.push(">",d,"</",s,">"),n.push(l.join("")),(this._||(this._={})).dialog=e,"boolean"==typeof t.isChanged&&(this.isChanged=function(){return t.isChanged}),"function"==typeof t.isChanged&&(this.isChanged=t.isChanged),"function"==typeof t.setValue&&(this.setValue=CKEDITOR.tools.override(this.setValue,(function(e){return function(n){e.call(this,t.setValue.call(this,n))}}))),"function"==typeof t.getValue&&(this.getValue=CKEDITOR.tools.override(this.getValue,(function(e){return function(){return t.getValue.call(this,e.call(this))}}))),CKEDITOR.event.implementOn(this),this.registerEvents(t),this.accessKeyUp&&this.accessKeyDown&&t.accessKey&&_(this,e,"CTRL+"+t.accessKey);var m=this;e.on("load",(function(){var t=m.getInputElement();if(t){var n=m.type in{checkbox:1,ratio:1}&&CKEDITOR.env.ie&&8>CKEDITOR.env.version?"cke_dialog_ui_focused":"";t.on("focus",(function(){e._.tabBarMode=!1,e._.hasFocus=!0,m.fire("focus"),n&&this.addClass(n)})),t.on("blur",(function(){m.fire("blur"),n&&this.removeClass(n)}))}})),CKEDITOR.tools.extend(this,t),this.keyboardFocusable&&(this.tabIndex=t.tabIndex||0,this.focusIndex=e._.focusList.push(this)-1,this.on("focus",(function(){e._.currentFocusIndex=m.focusIndex})))}},hbox:function(e,t,n,o,i){if(!(4>arguments.length)){this._||(this._={});var r,a=this._.children=t,s=i&&i.widths||null,l=i&&i.height||null,u={role:"presentation"};i&&i.align&&(u.align=i.align),CKEDITOR.ui.dialog.uiElement.call(this,e,i||{type:"hbox"},o,"table",{},u,(function(){var e=['<tbody><tr class="cke_dialog_ui_hbox">'];for(r=0;r<n.length;r++){var t="cke_dialog_ui_hbox_child",o=[];0===r&&(t="cke_dialog_ui_hbox_first"),r==n.length-1&&(t="cke_dialog_ui_hbox_last"),e.push('<td class="',t,'" role="presentation" '),s?s[r]&&o.push("width:"+d(s[r])):o.push("width:"+Math.floor(100/n.length)+"%"),l&&o.push("height:"+d(l)),i&&void 0!==i.padding&&o.push("padding:"+d(i.padding)),CKEDITOR.env.ie&&CKEDITOR.env.quirks&&a[r].align&&o.push("text-align:"+a[r].align),0<o.length&&e.push('style="'+o.join("; ")+'" '),e.push(">",n[r],"</td>")}return e.push("</tr></tbody>"),e.join("")}))}},vbox:function(e,t,n,o,i){if(!(3>arguments.length)){this._||(this._={});var r=this._.children=t,a=i&&i.width||null,s=i&&i.heights||null;CKEDITOR.ui.dialog.uiElement.call(this,e,i||{type:"vbox"},o,"div",null,{role:"presentation"},(function(){var t=['<table role="presentation" cellspacing="0" border="0" '];t.push('style="'),i&&i.expand&&t.push("height:100%;"),t.push("width:"+d(a||"100%"),";"),CKEDITOR.env.webkit&&t.push("float:none;"),t.push('"'),t.push('align="',CKEDITOR.tools.htmlEncode(i&&i.align||("ltr"==e.getParentEditor().lang.dir?"left":"right")),'" '),t.push("><tbody>");for(var o=0;o<n.length;o++){var l=[];t.push('<tr><td role="presentation" '),a&&l.push("width:"+d(a||"100%")),s?l.push("height:"+d(s[o])):i&&i.expand&&l.push("height:"+Math.floor(100/n.length)+"%"),i&&void 0!==i.padding&&l.push("padding:"+d(i.padding)),CKEDITOR.env.ie&&CKEDITOR.env.quirks&&r[o].align&&l.push("text-align:"+r[o].align),0<l.length&&t.push('style="',l.join("; "),'" '),t.push(' class="cke_dialog_ui_vbox_child">',n[o],"</td></tr>")}return t.push("</tbody></table>"),t.join("")}))}}},CKEDITOR.ui.dialog.uiElement.prototype={getElement:function(){return CKEDITOR.document.getById(this.domId)},getInputElement:function(){return this.getElement()},getDialog:function(){return this._.dialog},setValue:function(e,t){return this.getInputElement().setValue(e),!t&&this.fire("change",{value:e}),this},getValue:function(){return this.getInputElement().getValue()},isChanged:function(){return!1},selectParentTab:function(){for(var e=this.getInputElement();(e=e.getParent())&&-1==e.$.className.search("cke_dialog_page_contents"););return e?(e=e.getAttribute("name"),this._.dialog._.currentTabId!=e&&this._.dialog.selectPage(e),this):this},focus:function(){return this.selectParentTab().getInputElement().focus(),this},registerEvents:function(e){var t,n,o=/^on([A-Z]\w+)/,i=function(e,t,n,o){t.on("load",(function(){e.getInputElement().on(n,o,e)}))};for(n in e)(t=n.match(o))&&(this.eventProcessors[n]?this.eventProcessors[n].call(this,this._.dialog,e[n]):i(this,this._.dialog,t[1].toLowerCase(),e[n]));return this},eventProcessors:{onLoad:function(e,t){e.on("load",t,this)},onShow:function(e,t){e.on("show",t,this)},onHide:function(e,t){e.on("hide",t,this)}},accessKeyDown:function(){this.focus()},accessKeyUp:function(){},disable:function(){var e=this.getElement();this.getInputElement().setAttribute("disabled","true"),e.addClass("cke_disabled")},enable:function(){var e=this.getElement();this.getInputElement().removeAttribute("disabled"),e.removeClass("cke_disabled")},isEnabled:function(){return!this.getElement().hasClass("cke_disabled")},isVisible:function(){return this.getInputElement().isVisible()},isFocusable:function(){return!(!this.isEnabled()||!this.isVisible())}},CKEDITOR.ui.dialog.hbox.prototype=CKEDITOR.tools.extend(new CKEDITOR.ui.dialog.uiElement,{getChild:function(e){return 1>arguments.length?this._.children.concat():(e.splice||(e=[e]),2>e.length?this._.children[e[0]]:this._.children[e[0]]&&this._.children[e[0]].getChild?this._.children[e[0]].getChild(e.slice(1,e.length)):null)}},!0),CKEDITOR.ui.dialog.vbox.prototype=new CKEDITOR.ui.dialog.hbox,function(){var e={build:function(e,t,n){for(var o,i=t.children,r=[],a=[],s=0;s<i.length&&(o=i[s]);s++){var l=[];r.push(l),a.push(CKEDITOR.dialog._.uiElementBuilders[o.type].build(e,o,l))}return new CKEDITOR.ui.dialog[t.type](e,a,r,n,t)}};CKEDITOR.dialog.addUIElement("hbox",e),CKEDITOR.dialog.addUIElement("vbox",e)}(),CKEDITOR.dialogCommand=function(e,t){this.dialogName=e,CKEDITOR.tools.extend(this,t,!0)},CKEDITOR.dialogCommand.prototype={exec:function(e){var t=this.tabId;e.openDialog(this.dialogName,(function(e){t&&e.selectPage(t)}))},canUndo:!1,editorFocus:1},function(){var e=/^([a]|[^a])+$/,t=/^\d*$/,n=/^\d*(?:\.\d+)?$/,o=/^(((\d*(\.\d+))|(\d*))(px|\%)?)?$/,i=/^(((\d*(\.\d+))|(\d*))(px|em|ex|in|cm|mm|pt|pc|\%)?)?$/i,r=/^(\s*[\w-]+\s*:\s*[^:;]+(?:;|$))*$/;CKEDITOR.VALIDATE_OR=1,CKEDITOR.VALIDATE_AND=2,CKEDITOR.dialog.validate={functions:function(){var e=arguments;return function(){var t,n,o=this&&this.getValue?this.getValue():e[0],i=CKEDITOR.VALIDATE_AND,r=[];for(n=0;n<e.length&&"function"==typeof e[n];n++)r.push(e[n]);n<e.length&&"string"==typeof e[n]&&(t=e[n],n++),n<e.length&&"number"==typeof e[n]&&(i=e[n]);var a=i==CKEDITOR.VALIDATE_AND;for(n=0;n<r.length;n++)a=i==CKEDITOR.VALIDATE_AND?a&&r[n](o):a||r[n](o);return!!a||t}},regex:function(e,t){return function(n){return n=this&&this.getValue?this.getValue():n,!!e.test(n)||t}},notEmpty:function(t){return this.regex(e,t)},integer:function(e){return this.regex(t,e)},number:function(e){return this.regex(n,e)},cssLength:function(e){return this.functions((function(e){return i.test(CKEDITOR.tools.trim(e))}),e)},htmlLength:function(e){return this.functions((function(e){return o.test(CKEDITOR.tools.trim(e))}),e)},inlineStyle:function(e){return this.functions((function(e){return r.test(CKEDITOR.tools.trim(e))}),e)},equals:function(e,t){return this.functions((function(t){return t==e}),t)},notEqual:function(e,t){return this.functions((function(t){return t!=e}),t)}},CKEDITOR.on("instanceDestroyed",(function(e){if(CKEDITOR.tools.isEmpty(CKEDITOR.instances)){for(var t;t=CKEDITOR.dialog._.currentTop;)t.hide();for(var n in C)C[n].remove();C={}}for(var o in e=e.editor._.storedDialogs)e[o].destroy()}))}(),CKEDITOR.tools.extend(CKEDITOR.editor.prototype,{openDialog:function(e,t,n){var o=null,i=CKEDITOR.dialog._.dialogDefinitions[e];if(null===CKEDITOR.dialog._.currentTop&&u(this),"function"==typeof i)i=this._.storedDialogs||(this._.storedDialogs={}),(o=i[e]||(i[e]=new CKEDITOR.dialog(this,e))).setModel(n),t&&t.call(o,o),o.show();else{if("failed"==i)throw c(this),Error('[CKEDITOR.dialog.openDialog] Dialog "'+e+'" failed when loading definition.');"string"==typeof i&&CKEDITOR.scriptLoader.load(CKEDITOR.getUrl(i),(function(){"function"!=typeof CKEDITOR.dialog._.dialogDefinitions[e]&&(CKEDITOR.dialog._.dialogDefinitions[e]="failed"),this.openDialog(e,t,n)}),this,0,1)}return CKEDITOR.skin.loadPart("dialog"),o&&o.once("hide",(function(){o.setModel(null)}),null,null,999),o}})}();var t,n,o,i,a,s=!1;CKEDITOR.plugins.add("dialog",{requires:"dialogui",init:function(e){s||(CKEDITOR.document.appendStyleSheet(this.path+"styles/dialog.css"),s=!0),e.on("doubleclick",(function(t){t.data.dialog&&e.openDialog(t.data.dialog)}),null,null,999)}}),CKEDITOR.plugins.add("about",{requires:"dialog",init:function(e){var t=e.addCommand("about",new CKEDITOR.dialogCommand("about"));t.modes={wysiwyg:1,source:1},t.canUndo=!1,t.readOnly=1,e.ui.addButton&&e.ui.addButton("About",{label:e.lang.about.dlgTitle,command:"about",toolbar:"about"}),CKEDITOR.dialog.add("about",this.path+"dialogs/about.js")}}),CKEDITOR.plugins.add("a11yhelp",{requires:"dialog",availableLangs:{af:1,ar:1,az:1,bg:1,ca:1,cs:1,cy:1,da:1,de:1,"de-ch":1,el:1,en:1,"en-au":1,"en-gb":1,eo:1,es:1,"es-mx":1,et:1,eu:1,fa:1,fi:1,fo:1,fr:1,"fr-ca":1,gl:1,gu:1,he:1,hi:1,hr:1,hu:1,id:1,it:1,ja:1,km:1,ko:1,ku:1,lt:1,lv:1,mk:1,mn:1,nb:1,nl:1,no:1,oc:1,pl:1,pt:1,"pt-br":1,ro:1,ru:1,si:1,sk:1,sl:1,sq:1,sr:1,"sr-latn":1,sv:1,th:1,tr:1,tt:1,ug:1,uk:1,vi:1,zh:1,"zh-cn":1},init:function(e){var t=this;e.addCommand("a11yHelp",{exec:function(){var n=t.availableLangs[n=e.langCode]?n:t.availableLangs[n.replace(/-.*/,"")]?n.replace(/-.*/,""):"en";CKEDITOR.scriptLoader.load(CKEDITOR.getUrl(t.path+"dialogs/lang/"+n+".js"),(function(){e.lang.a11yhelp=t.langEntries[n],e.openDialog("a11yHelp")}))},modes:{wysiwyg:1,source:1},readOnly:1,canUndo:!1}),e.setKeystroke(CKEDITOR.ALT+48,"a11yHelp"),CKEDITOR.dialog.add("a11yHelp",this.path+"dialogs/a11yhelp.js"),e.on("ariaEditorHelpLabel",(function(t){t.data.label=e.lang.common.editorHelp}))}}),function(){function e(e){var t=this.att;void 0!==(e=e&&e.hasAttribute(t)&&e.getAttribute(t)||"")&&this.setValue(e)}function t(){for(var e,t=0;t<arguments.length;t++)if(arguments[t]instanceof CKEDITOR.dom.element){e=arguments[t];break}if(e){t=this.att;var n=this.getValue();n?e.setAttribute(t,n):e.removeAttribute(t,n)}}var n={id:1,dir:1,classes:1,styles:1};CKEDITOR.plugins.add("dialogadvtab",{requires:"dialog",allowedContent:function(e){e||(e=n);var t=[];e.id&&t.push("id"),e.dir&&t.push("dir");var o="";return t.length&&(o+="["+t.join(",")+"]"),e.classes&&(o+="(*)"),e.styles&&(o+="{*}"),o},createAdvancedTab:function(o,i,r){i||(i=n);var a=o.lang.common,s={id:"advanced",label:a.advancedTab,title:a.advancedTab,elements:[{type:"vbox",padding:1,children:[]}]},l=[];return(i.id||i.dir)&&(i.id&&l.push({id:"advId",att:"id",type:"text",requiredContent:r?r+"[id]":null,label:a.id,setup:e,commit:t}),i.dir&&l.push({id:"advLangDir",att:"dir",type:"select",requiredContent:r?r+"[dir]":null,label:a.langDir,default:"",style:"width:100%",items:[[a.notSet,""],[a.langDirLTR,"ltr"],[a.langDirRTL,"rtl"]],setup:e,commit:t}),s.elements[0].children.push({type:"hbox",widths:["50%","50%"],children:[].concat(l)})),(i.styles||i.classes)&&(l=[],i.styles&&l.push({id:"advStyles",att:"style",type:"text",requiredContent:r?r+"{cke-xyz}":null,label:a.styles,default:"",validate:CKEDITOR.dialog.validate.inlineStyle(a.invalidInlineStyle),onChange:function(){},getStyle:function(e,t){var n=this.getValue().match(new RegExp("(?:^|;)\\s*"+e+"\\s*:\\s*([^;]*)","i"));return n?n[1]:t},updateStyle:function(e,t){var n=this.getValue(),i=o.document.createElement("span");i.setAttribute("style",n),i.setStyle(e,t),n=CKEDITOR.tools.normalizeCssText(i.getAttribute("style")),this.setValue(n,1)},setup:e,commit:t}),i.classes&&l.push({type:"hbox",widths:["45%","55%"],children:[{id:"advCSSClasses",att:"class",type:"text",requiredContent:r?r+"(cke-xyz)":null,label:a.cssClasses,default:"",setup:e,commit:t}]}),s.elements[0].children.push({type:"hbox",widths:["50%","50%"],children:[].concat(l)})),s}})}(),CKEDITOR.plugins.add("basicstyles",{init:function(e){var t=0,n=function(n,i,r,a){if(a){a=new CKEDITOR.style(a);var s=o[r];s.unshift(a),e.attachStyleStateChange(a,(function(t){!e.readOnly&&e.getCommand(r).setState(t)})),e.addCommand(r,new CKEDITOR.styleCommand(a,{contentForms:s})),e.ui.addButton&&e.ui.addButton(n,{label:i,command:r,toolbar:"basicstyles,"+(t+=10)})}},o={bold:["strong","b",["span",function(e){return"bold"==(e=e.styles["font-weight"])||700<=+e}]],italic:["em","i",["span",function(e){return"italic"==e.styles["font-style"]}]],underline:["u",["span",function(e){return"underline"==e.styles["text-decoration"]}]],strike:["s","strike",["span",function(e){return"line-through"==e.styles["text-decoration"]}]],subscript:["sub"],superscript:["sup"]},i=e.config,r=e.lang.basicstyles;n("Bold",r.bold,"bold",i.coreStyles_bold),n("Italic",r.italic,"italic",i.coreStyles_italic),n("Underline",r.underline,"underline",i.coreStyles_underline),n("Strike",r.strike,"strike",i.coreStyles_strike),n("Subscript",r.subscript,"subscript",i.coreStyles_subscript),n("Superscript",r.superscript,"superscript",i.coreStyles_superscript),e.setKeystroke([[CKEDITOR.CTRL+66,"bold"],[CKEDITOR.CTRL+73,"italic"],[CKEDITOR.CTRL+85,"underline"]])}}),CKEDITOR.config.coreStyles_bold={element:"strong",overrides:"b"},CKEDITOR.config.coreStyles_italic={element:"em",overrides:"i"},CKEDITOR.config.coreStyles_underline={element:"u"},CKEDITOR.config.coreStyles_strike={element:"s",overrides:"strike"},CKEDITOR.config.coreStyles_subscript={element:"sub"},CKEDITOR.config.coreStyles_superscript={element:"sup"},function(){function e(e,t,n,o){if(!e.isReadOnly()&&!e.equals(n.editable())){CKEDITOR.dom.element.setMarker(o,e,"bidi_processed",1),o=e;for(var i=n.editable();(o=o.getParent())&&!o.equals(i);)if(o.getCustomData("bidi_processed"))return e.removeStyle("direction"),void e.removeAttribute("dir");((o="useComputedState"in n.config?n.config.useComputedState:1)?e.getComputedStyle("direction"):e.getStyle("direction")||e.hasAttribute("dir"))!=t&&(e.removeStyle("direction"),o?(e.removeAttribute("dir"),t!=e.getComputedStyle("direction")&&e.setAttribute("dir",t)):e.setAttribute("dir",t),n.forceNextSelectionCheck())}}function t(e,t,n){var o=e.getCommonAncestor(!1,!0);if((e=e.clone()).enlarge(n==CKEDITOR.ENTER_BR?CKEDITOR.ENLARGE_LIST_ITEM_CONTENTS:CKEDITOR.ENLARGE_BLOCK_CONTENTS),e.checkBoundaryOfElement(o,CKEDITOR.START)&&e.checkBoundaryOfElement(o,CKEDITOR.END)){for(var i;o&&o.type==CKEDITOR.NODE_ELEMENT&&(i=o.getParent())&&1==i.getChildCount()&&!(o.getName()in t);)o=i;return o.type==CKEDITOR.NODE_ELEMENT&&o.getName()in t&&o}}function n(n){return{context:"p",allowedContent:{"h1 h2 h3 h4 h5 h6 table ul ol blockquote div tr p div li td":{propertiesOnly:!0,attributes:"dir"}},requiredContent:"p[dir]",refresh:function(e,t){var n,o;if(!(o=void 0===(o=e.config.useComputedState)||o)){n=t.lastElement;for(var i=e.editable();n&&!(n.getName()in a)&&!n.equals(i);){var r=n.getParent();if(!r)break;n=r}}(n=n||t.block||t.blockLimit).equals(e.editable())&&(i=e.getSelection().getRanges()[0].getEnclosedNode())&&i.type==CKEDITOR.NODE_ELEMENT&&(n=i),n&&(o=o?n.getComputedStyle("direction"):n.getStyle("direction")||n.getAttribute("dir"),e.getCommand("bidirtl").setState("rtl"==o?CKEDITOR.TRISTATE_ON:CKEDITOR.TRISTATE_OFF),e.getCommand("bidiltr").setState("ltr"==o?CKEDITOR.TRISTATE_ON:CKEDITOR.TRISTATE_OFF)),(o=(t.block||t.blockLimit||e.editable()).getDirection(1))!=(e._.selDir||e.lang.dir)&&(e._.selDir=o,e.fire("contentDirChanged",o))},exec:function(o){var a=o.getSelection(),s=o.config.enterMode;if((d=a.getRanges())&&d.length){for(var l,u={},c=a.createBookmarks(),d=d.createIterator(),f=0;l=d.getNextRange(1);){var h=l.getEnclosedNode();h&&(!h||h.type==CKEDITOR.NODE_ELEMENT&&h.getName()in r)||(h=t(l,i,s)),h&&e(h,n,o,u);var g=new CKEDITOR.dom.walker(l),m=c[f].startNode,p=c[f++].endNode;for(g.evaluator=function(e){var t,n=s==CKEDITOR.ENTER_P?"p":"div";return(t=!!e&&e.type==CKEDITOR.NODE_ELEMENT&&e.getName()in i)&&((n=e.is(n))&&(n=!!(n=e.getParent())&&n.type==CKEDITOR.NODE_ELEMENT),t=!(n&&e.getParent().is("blockquote"))),!!(t&&e.getPosition(m)&CKEDITOR.POSITION_FOLLOWING&&(e.getPosition(p)&CKEDITOR.POSITION_PRECEDING+CKEDITOR.POSITION_CONTAINS)==CKEDITOR.POSITION_PRECEDING)};h=g.next();)e(h,n,o,u);for((l=l.createIterator()).enlargeBr=s!=CKEDITOR.ENTER_BR;h=l.getNextParagraph(s==CKEDITOR.ENTER_P?"p":"div");)e(h,n,o,u)}CKEDITOR.dom.element.clearAllMarkers(u),o.forceNextSelectionCheck(),a.selectBookmarks(c),o.focus()}}}}function o(e){var t=e==s.setAttribute,n=e==s.removeAttribute,o=/\bdirection\s*:\s*(.*?)\s*(:?$|;)/;return function(i,r){if(!this.isReadOnly()){var a;if(a=i==(t||n?"dir":"direction")||"style"==i&&(n||o.test(r))){e:{for(var s=(a=this).getDocument().getBody().getParent();a;){if(a.equals(s)){a=!1;break e}a=a.getParent()}a=!0}a=!a}if(a&&(a=this.getDirection(1),s=e.apply(this,arguments),a!=this.getDirection(1)))return this.getDocument().fire("dirChanged",this),s}return e.apply(this,arguments)}}var i={table:1,ul:1,ol:1,blockquote:1,div:1},r={},a={};CKEDITOR.tools.extend(r,i,{tr:1,p:1,div:1,li:1}),CKEDITOR.tools.extend(a,r,{td:1}),CKEDITOR.plugins.add("bidi",{init:function(e){function t(t,n,o,i,r){e.addCommand(o,new CKEDITOR.command(e,i)),e.ui.addButton&&e.ui.addButton(t,{label:n,command:o,toolbar:"bidi,"+r})}if(!e.blockless){var o=e.lang.bidi;t("BidiLtr",o.ltr,"bidiltr",n("ltr"),10),t("BidiRtl",o.rtl,"bidirtl",n("rtl"),20),e.on("contentDom",(function(){e.document.on("dirChanged",(function(t){e.fire("dirChanged",{node:t.data,dir:t.data.getDirection(1)})}))})),e.on("contentDirChanged",(function(t){t=(e.lang.dir!=t.data?"add":"remove")+"Class";var n=e.ui.space(e.config.toolbarLocation);n&&n[t]("cke_mixed_dir_content")}))}}});for(var s=CKEDITOR.dom.element.prototype,l=["setStyle","removeStyle","setAttribute","removeAttribute"],u=0;u<l.length;u++)s[l[u]]=CKEDITOR.tools.override(s[l[u]],o)}(),t={exec:function(e){var t=e.getCommand("blockquote").state,n=e.getSelection(),o=n&&n.getRanges()[0];if(o){var i=n.createBookmarks();if(CKEDITOR.env.ie){var r,a=i[0].startNode,s=i[0].endNode;if(a&&"blockquote"==a.getParent().getName())for(r=a;r=r.getNext();)if(r.type==CKEDITOR.NODE_ELEMENT&&r.isBlockBoundary()){a.move(r,!0);break}if(s&&"blockquote"==s.getParent().getName())for(r=s;r=r.getPrevious();)if(r.type==CKEDITOR.NODE_ELEMENT&&r.isBlockBoundary()){s.move(r);break}}if((l=o.createIterator()).enlargeBr=e.config.enterMode!=CKEDITOR.ENTER_BR,t==CKEDITOR.TRISTATE_OFF){for(a=[];t=l.getNextParagraph();)a.push(t);for(1>a.length&&(t=e.document.createElement(e.config.enterMode==CKEDITOR.ENTER_P?"p":"div"),s=i.shift(),o.insertNode(t),t.append(new CKEDITOR.dom.text("\ufeff",e.document)),o.moveToBookmark(s),o.selectNodeContents(t),o.collapse(!0),s=o.createBookmark(),a.push(t),i.unshift(s)),r=a[0].getParent(),o=[],s=0;s<a.length;s++)r=r.getCommonAncestor((t=a[s]).getParent());for(t={table:1,tbody:1,tr:1,ol:1,ul:1};t[r.getName()];)r=r.getParent();for(s=null;0<a.length;){for(t=a.shift();!t.getParent().equals(r);)t=t.getParent();t.equals(s)||o.push(t),s=t}for(;0<o.length;)if("blockquote"==(t=o.shift()).getName()){for(s=new CKEDITOR.dom.documentFragment(e.document);t.getFirst();)s.append(t.getFirst().remove()),a.push(s.getLast());s.replace(t)}else a.push(t);for((o=e.document.createElement("blockquote")).insertBefore(a[0]);0<a.length;)t=a.shift(),o.append(t)}else if(t==CKEDITOR.TRISTATE_ON){for(s=[],r={};t=l.getNextParagraph();){for(a=o=null;t.getParent();){if("blockquote"==t.getParent().getName()){o=t.getParent(),a=t;break}t=t.getParent()}o&&a&&!a.getCustomData("blockquote_moveout")&&(s.push(a),CKEDITOR.dom.element.setMarker(r,a,"blockquote_moveout",!0))}for(CKEDITOR.dom.element.clearAllMarkers(r),t=[],a=[],r={};0<s.length;)o=(l=s.shift()).getParent(),l.getPrevious()?l.getNext()?(l.breakParent(l.getParent()),a.push(l.getNext())):l.remove().insertAfter(o):l.remove().insertBefore(o),o.getCustomData("blockquote_processed")||(a.push(o),CKEDITOR.dom.element.setMarker(r,o,"blockquote_processed",!0)),t.push(l);for(CKEDITOR.dom.element.clearAllMarkers(r),s=a.length-1;0<=s;s--){e:{for(var l=0,u=(r=o=a[s]).getChildCount(),c=void 0;l<u&&(c=r.getChild(l));l++)if(c.type==CKEDITOR.NODE_ELEMENT&&c.isBlockBoundary()){r=!1;break e}r=!0}r&&o.remove()}if(e.config.enterMode==CKEDITOR.ENTER_BR)for(o=!0;t.length;)if("div"==(l=t.shift()).getName()){for(s=new CKEDITOR.dom.documentFragment(e.document),!o||!l.getPrevious()||l.getPrevious().type==CKEDITOR.NODE_ELEMENT&&l.getPrevious().isBlockBoundary()||s.append(e.document.createElement("br")),o=l.getNext()&&!(l.getNext().type==CKEDITOR.NODE_ELEMENT&&l.getNext().isBlockBoundary());l.getFirst();)l.getFirst().remove().appendTo(s);o&&s.append(e.document.createElement("br")),s.replace(l),o=!1}}n.selectBookmarks(i),e.focus()}},refresh:function(e,t){this.setState(e.elementPath(t.block||t.blockLimit).contains("blockquote",1)?CKEDITOR.TRISTATE_ON:CKEDITOR.TRISTATE_OFF)},context:"blockquote",allowedContent:"blockquote",requiredContent:"blockquote"},CKEDITOR.plugins.add("blockquote",{init:function(e){e.blockless||(e.addCommand("blockquote",t),e.ui.addButton&&e.ui.addButton("Blockquote",{label:e.lang.blockquote.toolbar,command:"blockquote",toolbar:"blocks,10"}))}}),function(){function e(e,t){CKEDITOR.tools.extend(this,t,{editor:e,id:"cke-"+CKEDITOR.tools.getUniqueId(),area:e._.notificationArea}),t.type||(this.type="info"),this.element=this._createElement(),e.plugins.clipboard&&CKEDITOR.plugins.clipboard.preventDefaultDropOnElement(this.element)}function t(e){var t=this;this.editor=e,this.notifications=[],this.element=this._createElement(),this._uiBuffer=CKEDITOR.tools.eventsBuffer(10,this._layout,this),this._changeBuffer=CKEDITOR.tools.eventsBuffer(500,this._layout,this),e.on("destroy",(function(){t._removeListeners(),t.element.remove()}))}CKEDITOR.plugins.add("notification",{init:function(e){e._.notificationArea=new t(e),e.showNotification=function(t,n,o){var i,r;return"progress"==n?i=o:r=o,(t=new CKEDITOR.plugins.notification(e,{message:t,type:n,progress:i,duration:r})).show(),t},e.on("key",(function(t){if(27==t.data.keyCode){var n=e._.notificationArea.notifications;n.length&&(function(e){var t=new CKEDITOR.dom.element("div");t.setStyles({position:"fixed","margin-left":"-9999px"}),t.setAttributes({"aria-live":"assertive","aria-atomic":"true"}),t.setText(e),CKEDITOR.document.getBody().append(t),setTimeout((function(){t.remove()}),100)}(e.lang.notification.closed),n[n.length-1].hide(),t.cancel())}}))}}),e.prototype={show:function(){!1!==this.editor.fire("notificationShow",{notification:this})&&(this.area.add(this),this._hideAfterTimeout())},update:function(e){var t=!0;!1===this.editor.fire("notificationUpdate",{notification:this,options:e})&&(t=!1);var n=this.element,o=n.findOne(".cke_notification_message"),i=n.findOne(".cke_notification_progress"),r=e.type;n.removeAttribute("role"),e.progress&&"progress"!=this.type&&(r="progress"),r&&(n.removeClass(this._getClass()),n.removeAttribute("aria-label"),this.type=r,n.addClass(this._getClass()),n.setAttribute("aria-label",this.type),"progress"!=this.type||i?"progress"!=this.type&&i&&i.remove():(i=this._createProgressElement()).insertBefore(o)),void 0!==e.message&&(this.message=e.message,o.setHtml(this.message)),void 0!==e.progress&&(this.progress=e.progress,i&&i.setStyle("width",this._getPercentageProgress())),t&&e.important&&(n.setAttribute("role","alert"),this.isVisible()||this.area.add(this)),this.duration=e.duration,this._hideAfterTimeout()},hide:function(){!1!==this.editor.fire("notificationHide",{notification:this})&&this.area.remove(this)},isVisible:function(){return 0<=CKEDITOR.tools.indexOf(this.area.notifications,this)},_createElement:function(){var e,t,n=this,o=this.editor.lang.common.close;return(e=new CKEDITOR.dom.element("div")).addClass("cke_notification"),e.addClass(this._getClass()),e.setAttributes({id:this.id,role:"alert","aria-label":this.type}),"progress"==this.type&&e.append(this._createProgressElement()),(t=new CKEDITOR.dom.element("p")).addClass("cke_notification_message"),t.setHtml(this.message),e.append(t),t=CKEDITOR.dom.element.createFromHtml('<a class="cke_notification_close" href="javascript:void(0)" title="'+o+'" role="button" tabindex="-1"><span class="cke_label">X</span></a>'),e.append(t),t.on("click",(function(){n.editor.focus(),n.hide()})),e},_getClass:function(){return"progress"==this.type?"cke_notification_info":"cke_notification_"+this.type},_createProgressElement:function(){var e=new CKEDITOR.dom.element("span");return e.addClass("cke_notification_progress"),e.setStyle("width",this._getPercentageProgress()),e},_getPercentageProgress:function(){return Math.round(100*(this.progress||0))+"%"},_hideAfterTimeout:function(){var e,t=this;this._hideTimeoutId&&clearTimeout(this._hideTimeoutId),"number"==typeof this.duration?e=this.duration:"info"!=this.type&&"success"!=this.type||(e="number"==typeof this.editor.config.notification_duration?this.editor.config.notification_duration:5e3),e&&(t._hideTimeoutId=setTimeout((function(){t.hide()}),e))}},t.prototype={add:function(e){this.notifications.push(e),this.element.append(e.element),1==this.element.getChildCount()&&(CKEDITOR.document.getBody().append(this.element),this._attachListeners()),this._layout()},remove:function(e){var t=CKEDITOR.tools.indexOf(this.notifications,e);0>t||(this.notifications.splice(t,1),e.element.remove(),this.element.getChildCount()||(this._removeListeners(),this.element.remove()))},_createElement:function(){var e=this.editor,t=e.config,n=new CKEDITOR.dom.element("div");return n.addClass("cke_notifications_area"),n.setAttribute("id","cke_notifications_area_"+e.name),n.setStyle("z-index",t.baseFloatZIndex-2),n},_attachListeners:function(){var e=CKEDITOR.document.getWindow(),t=this.editor;e.on("scroll",this._uiBuffer.input),e.on("resize",this._uiBuffer.input),t.on("change",this._changeBuffer.input),t.on("floatingSpaceLayout",this._layout,this,null,20),t.on("blur",this._layout,this,null,20)},_removeListeners:function(){var e=CKEDITOR.document.getWindow(),t=this.editor;e.removeListener("scroll",this._uiBuffer.input),e.removeListener("resize",this._uiBuffer.input),t.removeListener("change",this._changeBuffer.input),t.removeListener("floatingSpaceLayout",this._layout),t.removeListener("blur",this._layout)},_layout:function(){function e(){i.setStyle("left",m(p+a.width-u-c))}var t,n,o,i=this.element,r=this.editor,a=r.ui.contentsElement.getClientRect(),s=r.ui.contentsElement.getDocumentPosition(),l=i.getClientRect(),u=this._notificationWidth,c=this._notificationMargin,d=(o=CKEDITOR.document.getWindow()).getScrollPosition(),f=o.getViewPaneSize(),h=CKEDITOR.document.getBody(),g=h.getDocumentPosition(),m=CKEDITOR.tools.cssLength;u&&c||(o=this.element.getChild(0),u=this._notificationWidth=o.getClientRect().width,c=this._notificationMargin=parseInt(o.getComputedStyle("margin-left"),10)+parseInt(o.getComputedStyle("margin-right"),10)),r.toolbar&&(n=(t=r.ui.space("top")).getClientRect()),t&&t.isVisible()&&n.bottom>a.top&&n.bottom<a.bottom-l.height?i.setStyles({position:"fixed",top:m(n.bottom)}):i.setStyles(0<a.top?{position:"absolute",top:m(s.y)}:s.y+a.height-l.height>d.y?{position:"fixed",top:0}:{position:"absolute",top:m(s.y+a.height-l.height)});var p="fixed"==i.getStyle("position")?a.left:"static"!=h.getComputedStyle("position")?s.x-g.x:s.x;a.width<u+c?s.x+u+c>d.x+f.width?e():i.setStyle("left",m(p)):s.x+u+c>d.x+f.width?i.setStyle("left",m(p)):s.x+a.width/2+u/2+c>d.x+f.width?i.setStyle("left",m(p-s.x+d.x+f.width-u-c)):0>a.left+a.width-u-c?e():i.setStyle("left",m(0>a.left+a.width/2-u/2?p-s.x+d.x:p+a.width/2-u/2-c/2))}},CKEDITOR.plugins.notification=e}(),function(){var e='<a id="{id}" class="cke_button cke_button__{name} cke_button_{state} {cls}"'+(CKEDITOR.env.gecko&&!CKEDITOR.env.hc?"":" href=\"javascript:void('{titleJs}')\"")+' title="{title}" tabindex="-1" hidefocus="true" role="button" aria-labelledby="{id}_label" aria-describedby="{id}_description" aria-haspopup="{hasArrow}" aria-disabled="{ariaDisabled}"';CKEDITOR.env.gecko&&CKEDITOR.env.mac&&(e+=' onkeypress="return false;"'),CKEDITOR.env.gecko&&(e+=' onblur="this.style.cssText = this.style.cssText;"');var t="";CKEDITOR.env.ie&&(t='return false;" onmouseup="CKEDITOR.tools.getMouseButton(event)==CKEDITOR.MOUSE_BUTTON_LEFT&&'),e=e+' onkeydown="return CKEDITOR.tools.callFunction({keydownFn},event);" onfocus="return CKEDITOR.tools.callFunction({focusFn},event);" onclick="'+t+'CKEDITOR.tools.callFunction({clickFn},this);return false;"><span class="cke_button_icon cke_button__{iconName}_icon" style="{style}">&nbsp;</span><span id="{id}_label" class="cke_button_label cke_button__{name}_label" aria-hidden="false">{label}</span><span id="{id}_description" class="cke_button_label" aria-hidden="false">{ariaShortcut}</span>{arrowHtml}</a>';var n=CKEDITOR.addTemplate("buttonArrow",'<span class="cke_button_arrow">'+(CKEDITOR.env.hc?"&#9660;":"")+"</span>"),o=CKEDITOR.addTemplate("button",e);CKEDITOR.plugins.add("button",{beforeInit:function(e){e.ui.addHandler(CKEDITOR.UI_BUTTON,CKEDITOR.ui.button.handler)}}),CKEDITOR.UI_BUTTON="button",CKEDITOR.ui.button=function(e){CKEDITOR.tools.extend(this,e,{title:e.label,click:e.click||function(t){t.execCommand(e.command)}}),this._={}},CKEDITOR.ui.button.handler={create:function(e){return new CKEDITOR.ui.button(e)}},CKEDITOR.ui.button.prototype={render:function(e,t){function i(){var t=e.mode;t&&(t=this.modes[t]?void 0!==l[t]?l[t]:CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED,t=e.readOnly&&!this.readOnly?CKEDITOR.TRISTATE_DISABLED:t,this.setState(t),this.refresh&&this.refresh())}var r,a,s,l=null,u=CKEDITOR.env,c=this._.id=CKEDITOR.tools.getNextId(),d="",f=this.command;this._.editor=e;var h,g={id:c,button:this,editor:e,focus:function(){CKEDITOR.document.getById(c).focus()},execute:function(){this.button.click(e)},attach:function(e){this.button.attach(e)}},m=CKEDITOR.tools.addFunction((function(e){if(g.onkey)return e=new CKEDITOR.dom.event(e),!1!==g.onkey(g,e.getKeystroke())})),p=CKEDITOR.tools.addFunction((function(e){var t;return g.onfocus&&(t=!1!==g.onfocus(g,new CKEDITOR.dom.event(e))),t})),v=0;g.clickFn=r=CKEDITOR.tools.addFunction((function(){v&&(e.unlockSelection(1),v=0),g.execute(),u.iOS&&e.focus()})),this.modes?(l={},e.on("beforeModeUnload",(function(){e.mode&&this._.state!=CKEDITOR.TRISTATE_DISABLED&&(l[e.mode]=this._.state)}),this),e.on("activeFilterChange",i,this),e.on("mode",i,this),!this.readOnly&&e.on("readOnly",i,this)):f&&(f=e.getCommand(f))&&(f.on("state",(function(){this.setState(f.state)}),this),d+=f.state==CKEDITOR.TRISTATE_ON?"on":f.state==CKEDITOR.TRISTATE_DISABLED?"disabled":"off"),this.directional&&e.on("contentDirChanged",(function(t){var n=CKEDITOR.document.getById(this._.id),o=n.getFirst();(t=t.data)!=e.lang.dir?n.addClass("cke_"+t):n.removeClass("cke_ltr").removeClass("cke_rtl"),o.setAttribute("style",CKEDITOR.skin.getIconStyle(h,"rtl"==t,this.icon,this.iconOffset))}),this),f?(a=e.getCommandKeystroke(f))&&(s=CKEDITOR.tools.keystrokeToString(e.lang.common.keyboard,a)):d+="off";var y=null,b=this.icon;return h=a=this.name||this.command,this.icon&&!/\./.test(this.icon)?(h=this.icon,b=null):(this.icon&&(y=this.icon),CKEDITOR.env.hidpi&&this.iconHiDpi&&(y=this.iconHiDpi)),y?(CKEDITOR.skin.addIcon(y,y),b=null):y=h,d={id:c,name:a,iconName:h,label:this.label,cls:(this.hasArrow?"cke_button_expandable ":"")+(this.className||""),state:d,ariaDisabled:"disabled"==d?"true":"false",title:this.title+(s?" ("+s.display+")":""),ariaShortcut:s?e.lang.common.keyboardShortcut+" "+s.aria:"",titleJs:u.gecko&&!u.hc?"":(this.title||"").replace("'",""),hasArrow:"string"==typeof this.hasArrow&&this.hasArrow||(this.hasArrow?"true":"false"),keydownFn:m,focusFn:p,clickFn:r,style:CKEDITOR.skin.getIconStyle(y,"rtl"==e.lang.dir,b,this.iconOffset),arrowHtml:this.hasArrow?n.output():""},o.output(d,t),this.onRender&&this.onRender(),g},setState:function(e){if(this._.state==e)return!1;this._.state=e;var t=CKEDITOR.document.getById(this._.id);return!!t&&(t.setState(e,"cke_button"),t.setAttribute("aria-disabled",e==CKEDITOR.TRISTATE_DISABLED),this.hasArrow?t.setAttribute("aria-expanded",e==CKEDITOR.TRISTATE_ON):e===CKEDITOR.TRISTATE_ON?t.setAttribute("aria-pressed",!0):t.removeAttribute("aria-pressed"),!0)},getState:function(){return this._.state},toFeature:function(e){if(this._.feature)return this._.feature;var t=this;return this.allowedContent||this.requiredContent||!this.command||(t=e.getCommand(this.command)||t),this._.feature=t}},CKEDITOR.ui.prototype.addButton=function(e,t){this.add(e,CKEDITOR.UI_BUTTON,t)}}(),function(){function e(e){function n(t,n){if(n.length){t.items?t.items.push(e.ui.create("-")):t.items=[];for(var i;i=n.shift();)i="string"==typeof i?i:i.name,o&&-1!=CKEDITOR.tools.indexOf(o,i)||(i=e.ui.create(i))&&e.addFeature(i)&&t.items.push(i)}}var o=(o=e.config.removeButtons)&&o.split(","),i=e.config.toolbar;return"string"==typeof i&&(i=e.config["toolbar_"+i]),e.toolbar=i?function(e){var t,o,i,r=[];for(t=0;t<e.length;++t)i={},"/"==(o=e[t])?r.push(o):CKEDITOR.tools.isArray(o)?(n(i,CKEDITOR.tools.clone(o)),r.push(i)):o.items&&(n(i,CKEDITOR.tools.clone(o.items)),i.name=o.name,r.push(i));return r}(i):function(){for(var o=function(){var t,n,o,i={};for(t in e.ui.items)o=(o=(n=e.ui.items[t]).toolbar||"others").split(","),n=o[0],o=parseInt(o[1]||-1,10),i[n]||(i[n]=[]),i[n].push({name:t,order:o});for(n in i)i[n]=i[n].sort((function(e,t){return e.order==t.order?0:0>t.order?-1:0>e.order?1:e.order<t.order?-1:1}));return i}(),i=CKEDITOR.tools.clone(e.config.toolbarGroups)||t(e),r=0;r<i.length;r++){var a=i[r];if("/"!=a){"string"==typeof a&&(a=i[r]={name:a});var s,l=a.groups;if(l)for(var u=0;u<l.length;u++)(s=o[s=l[u]])&&n(a,s);(s=o[a.name])&&n(a,s)}}return i}()}function t(e){return e._.toolbarGroups||(e._.toolbarGroups=[{name:"document",groups:["mode","document","doctools"]},{name:"clipboard",groups:["clipboard","undo"]},{name:"editing",groups:["find","selection","spellchecker"]},{name:"forms"},"/",{name:"basicstyles",groups:["basicstyles","cleanup"]},{name:"paragraph",groups:["list","indent","blocks","align","bidi"]},{name:"links"},{name:"insert"},"/",{name:"styles"},{name:"colors"},{name:"tools"},{name:"others"},{name:"about"}])}var n=function(){this.toolbars=[],this.focusCommandExecuted=!1};n.prototype.focus=function(){for(var e,t=0;e=this.toolbars[t++];)for(var n,o=0;n=e.items[o++];)if(n.focus)return void n.focus()};var o={modes:{wysiwyg:1,source:1},readOnly:1,exec:function(e){e.toolbox&&(e.toolbox.focusCommandExecuted=!0,CKEDITOR.env.ie||CKEDITOR.env.air?setTimeout((function(){e.toolbox.focus()}),100):e.toolbox.focus())}};CKEDITOR.plugins.add("toolbar",{requires:"button",init:function(t){var i,r=function(e,n){var o,a=(s="rtl"==t.lang.dir)?37:39,s=s?39:37,l=void 0===(l=t.config.toolbarGroupCycling)||l;switch(n){case 9:case CKEDITOR.SHIFT+9:for(;!o||!o.items.length;)if((o=9==n?(o?o.next:e.toolbar.next)||t.toolbox.toolbars[0]:(o?o.previous:e.toolbar.previous)||t.toolbox.toolbars[t.toolbox.toolbars.length-1]).items.length)for(e=o.items[i?o.items.length-1:0];e&&!e.focus;)(e=i?e.previous:e.next)||(o=0);return e&&e.focus(),!1;case a:o=e;do{!(o=o.next)&&l&&(o=e.toolbar.items[0])}while(o&&!o.focus);return o?o.focus():r(e,9),!1;case 40:return e.button&&e.button.hasArrow?e.execute():r(e,40==n?a:s),!1;case s:case 38:o=e;do{!(o=o.previous)&&l&&(o=e.toolbar.items[e.toolbar.items.length-1])}while(o&&!o.focus);return o?o.focus():(i=1,r(e,CKEDITOR.SHIFT+9),i=0),!1;case 27:return t.focus(),!1;case 13:case 32:return e.execute(),!1}return!0};t.on("uiSpace",(function(o){if(o.data.space==t.config.toolbarLocation){o.removeListener(),t.toolbox=new n;var i,a,s=['<span id="',l=CKEDITOR.tools.getNextId(),'" class="cke_voice_label">',t.lang.toolbar.toolbars,"</span>",'<span id="'+t.ui.spaceId("toolbox")+'" class="cke_toolbox" role="group" aria-labelledby="',l,'" onmousedown="return false;">'],l=!1!==t.config.toolbarStartupExpanded;t.config.toolbarCanCollapse&&t.elementMode!=CKEDITOR.ELEMENT_MODE_INLINE&&s.push('<span class="cke_toolbox_main"'+(l?">":' style="display:none">'));for(var u=t.toolbox.toolbars,c=e(t),d=c.length,f=0;f<d;f++){var h,g,m,p=0,v=c[f],y="/"!==v&&("/"===c[f+1]||f==d-1);if(v)if(i&&(s.push("</span>"),a=i=0),"/"===v)s.push('<span class="cke_toolbar_break"></span>');else{m=v.items||v;for(var b=0;b<m.length;b++){var C,T=m[b];if(T){var x=function(e){e=e.render(t,s),0<(E=p.items.push(e)-1)&&(e.previous=p.items[E-1],e.previous.next=e),e.toolbar=p,e.onkey=r,e.onfocus=function(){t.toolbox.focusCommandExecuted||t.focus()}};if(T.type==CKEDITOR.UI_SEPARATOR)a=i&&T;else{if(C=!1!==T.canGroup,!p){h=CKEDITOR.tools.getNextId(),p={id:h,items:[]},s.push('<span id="',h,'" class="cke_toolbar'+(y?' cke_toolbar_last"':'"'),(g=v.name&&(t.lang.toolbar.toolbarGroups[v.name]||v.name))?' aria-labelledby="'+h+'_label"':"",' role="toolbar">'),g&&s.push('<span id="',h,'_label" class="cke_voice_label">',g,"</span>"),s.push('<span class="cke_toolbar_start"></span>');var E=u.push(p)-1;0<E&&(p.previous=u[E-1],p.previous.next=p)}C?i||(s.push('<span class="cke_toolgroup" role="presentation">'),i=1):i&&(s.push("</span>"),i=0),a&&(x(a),a=0),x(T)}}}i&&(s.push("</span>"),a=i=0),p&&s.push('<span class="cke_toolbar_end"></span></span>')}}if(t.config.toolbarCanCollapse&&s.push("</span>"),t.config.toolbarCanCollapse&&t.elementMode!=CKEDITOR.ELEMENT_MODE_INLINE){var _=CKEDITOR.tools.addFunction((function(){t.execCommand("toolbarCollapse")}));t.on("destroy",(function(){CKEDITOR.tools.removeFunction(_)})),t.addCommand("toolbarCollapse",{readOnly:1,exec:function(e){var t=e.ui.space("toolbar_collapser"),n=t.getPrevious(),o=e.ui.space("contents"),i=n.getParent(),r=parseInt(o.$.style.height,10),a=i.$.offsetHeight,s=t.hasClass("cke_toolbox_collapser_min");s?(n.show(),t.removeClass("cke_toolbox_collapser_min"),t.setAttribute("title",e.lang.toolbar.toolbarCollapse)):(n.hide(),t.addClass("cke_toolbox_collapser_min"),t.setAttribute("title",e.lang.toolbar.toolbarExpand)),t.getFirst().setText(s?"▲":"◀"),o.setStyle("height",r-(i.$.offsetHeight-a)+"px"),e.fire("resize",{outerHeight:e.container.$.offsetHeight,contentsHeight:o.$.offsetHeight,outerWidth:e.container.$.offsetWidth})},modes:{wysiwyg:1,source:1}}),t.setKeystroke(CKEDITOR.ALT+(CKEDITOR.env.ie||CKEDITOR.env.webkit?189:109),"toolbarCollapse"),s.push('<a title="'+(l?t.lang.toolbar.toolbarCollapse:t.lang.toolbar.toolbarExpand)+'" id="'+t.ui.spaceId("toolbar_collapser")+'" tabIndex="-1" class="cke_toolbox_collapser'),l||s.push(" cke_toolbox_collapser_min"),s.push('" onclick="CKEDITOR.tools.callFunction('+_+')">','<span class="cke_arrow">&#9650;</span>',"</a>")}s.push("</span>"),o.data.html+=s.join("")}})),t.on("destroy",(function(){if(this.toolbox){var e,t,n,o,i=0;for(e=this.toolbox.toolbars;i<e.length;i++)for(n=e[i].items,t=0;t<n.length;t++)(o=n[t]).clickFn&&CKEDITOR.tools.removeFunction(o.clickFn),o.keyDownFn&&CKEDITOR.tools.removeFunction(o.keyDownFn)}})),t.on("uiReady",(function(){var e=t.ui.space("toolbox");e&&t.focusManager.add(e,1)})),t.addCommand("toolbarFocus",o),t.setKeystroke(CKEDITOR.ALT+121,"toolbarFocus"),t.ui.add("-",CKEDITOR.UI_SEPARATOR,{}),t.ui.addHandler(CKEDITOR.UI_SEPARATOR,{create:function(){return{render:function(e,t){return t.push('<span class="cke_toolbar_separator" role="separator"></span>'),{}}}}})}}),CKEDITOR.ui.prototype.addToolbarGroup=function(e,n,o){var i=t(this.editor),r=0===n,a={name:e};if(o){if(o=CKEDITOR.tools.search(i,(function(e){return e.name==o})))return!o.groups&&(o.groups=[]),n&&0<=(n=CKEDITOR.tools.indexOf(o.groups,n))?void o.groups.splice(n+1,0,e):void(r?o.groups.splice(0,0,e):o.groups.push(e));n=null}n&&(n=CKEDITOR.tools.indexOf(i,(function(e){return e.name==n}))),r?i.splice(0,0,e):"number"==typeof n?i.splice(n+1,0,a):i.push(e)}}(),CKEDITOR.UI_SEPARATOR="separator",CKEDITOR.config.toolbarLocation="top",function(){function e(e,t,n){return t.type||(t.type="auto"),!(n&&!1===e.fire("beforePaste",t)||!t.dataValue&&t.dataTransfer.isEmpty())&&(t.dataValue||(t.dataValue=""),CKEDITOR.env.gecko&&"drop"==t.method&&e.toolbox&&e.once("afterPaste",(function(){e.toolbox.focus()})),e.fire("paste",t))}function t(e,t,n){t=CKEDITOR.htmlParser.fragment.fromHtml(t);var o=new CKEDITOR.htmlParser.basicWriter;return n.applyTo(t,!0,!1,e.activeEnterMode),t.writeHtml(o),o.getHtml()}function i(e){e.data.preventDefault(),e.data.$.dataTransfer.dropEffect="none"}var r;CKEDITOR.plugins.add("clipboard",{requires:"dialog,notification,toolbar",init:function(n){var o,i=function(e){function t(){var e,t={};for(e in CKEDITOR.dtd)"$"!=e.charAt(0)&&"div"!=e&&"span"!=e&&(t[e]=1);return t}var n={};return{get:function(o){return"plain-text"==o?n.plainText||(n.plainText=new CKEDITOR.filter(e,"br")):"semantic-content"==o?((o=n.semanticContent)||((o=new CKEDITOR.filter(e,{})).allow({$1:{elements:t(),attributes:!0,styles:!1,classes:!1}}),o=n.semanticContent=o),o):o?new CKEDITOR.filter(e,o):null}}}(n);if(n.config.forcePasteAsPlainText?o="plain-text":n.config.pasteFilter?o=n.config.pasteFilter:!CKEDITOR.env.webkit||"pasteFilter"in n.config||(o="semantic-content"),n.pasteFilter=i.get(o),function(t){function n(){var e,n=t.editable();if(CKEDITOR.plugins.clipboard.isCustomCopyCutSupported){var o=function(e){t.getSelection().isCollapsed()||(t.readOnly&&"cut"==e.name||g.initPasteDataTransfer(e,t),e.data.preventDefault())};n.on("copy",o),n.on("cut",o),n.on("cut",(function(){t.readOnly||t.extractSelectedHtml()}),null,null,999)}n.on(g.mainPasteEvent,(function(e){"beforepaste"==g.mainPasteEvent&&m||d(e)})),"beforepaste"==g.mainPasteEvent&&(n.on("paste",(function(e){p||(i(),e.data.preventDefault(),d(e),s("paste"))})),n.on("contextmenu",r,null,null,0),n.on("beforepaste",(function(e){!e.data||e.data.$.ctrlKey||e.data.$.shiftKey||r()}),null,null,0)),n.on("beforecut",(function(){!m&&l()})),n.attachListener(CKEDITOR.env.ie?n:t.document.getDocumentElement(),"mouseup",(function(){e=setTimeout(f,0)})),t.on("destroy",(function(){clearTimeout(e)})),n.on("keyup",f)}function o(e){return{type:e,canUndo:"cut"==e,startDisabled:!0,fakeKeystroke:"cut"==e?CKEDITOR.CTRL+88:CKEDITOR.CTRL+67,exec:function(){var e;"cut"==this.type&&l();var n=this.type;if(CKEDITOR.env.ie)e=s(n);else try{e=t.document.$.execCommand(n,!1,null)}catch(a){e=!1}return e||t.showNotification(t.lang.clipboard[this.type+"Error"]),e}}}function i(){p=1,setTimeout((function(){p=0}),100)}function r(){m=1,setTimeout((function(){m=0}),10)}function s(e){var n=t.document,o=n.getBody(),i=!1,r=function(){i=!0};return o.on(e,r),7<CKEDITOR.env.version?n.$.execCommand(e):n.$.selection.createRange().execCommand(e),o.removeListener(e,r),i}function l(){if(CKEDITOR.env.ie&&!CKEDITOR.env.quirks){var e,n,o,i=t.getSelection();i.getType()==CKEDITOR.SELECTION_ELEMENT&&(e=i.getSelectedElement())&&(n=i.getRanges()[0],(o=t.document.createText("")).insertBefore(e),n.setStartBefore(o),n.setEndAfter(e),i.selectRanges([n]),setTimeout((function(){e.getParent()&&(o.remove(),i.selectElement(e))}),0))}}function u(){if("paste"==g.mainPasteEvent)return t.fire("beforePaste",{type:"auto",method:"paste"}),!1;t.focus(),i();var e=t.focusManager;return e.lock(),t.editable().fire(g.mainPasteEvent)&&!s("paste")?(e.unlock(),!1):(e.unlock(),!0)}function c(e){if("wysiwyg"==t.mode)switch(e.data.keyCode){case CKEDITOR.CTRL+86:case CKEDITOR.SHIFT+45:e=t.editable(),i(),"paste"==g.mainPasteEvent&&e.fire("beforepaste");break;case CKEDITOR.CTRL+88:case CKEDITOR.SHIFT+46:t.fire("saveSnapshot"),setTimeout((function(){t.fire("saveSnapshot")}),50)}}function d(n){var o={type:"auto",method:"paste",dataTransfer:g.initPasteDataTransfer(n)};o.dataTransfer.cacheData();var i=!1!==t.fire("beforePaste",o);i&&g.canClipboardApiBeTrusted(o.dataTransfer,t)?(n.data.preventDefault(),setTimeout((function(){e(t,o)}),0)):function(e,n){var o,i=t.document,r=t.editable(),a=function(e){e.cancel()};if(!i.getById("cke_pastebin")){var s=t.getSelection(),l=s.createBookmarks();CKEDITOR.env.ie&&s.root.fire("selectionchange");var u=new CKEDITOR.dom.element(!CKEDITOR.env.webkit&&!r.is("body")||CKEDITOR.env.ie?"div":"body",i);u.setAttributes({id:"cke_pastebin","data-cke-temp":"1"});var c=0;i=i.getWindow(),CKEDITOR.env.webkit?(r.append(u),u.addClass("cke_editable"),r.is("body")||(c=(c="static"!=r.getComputedStyle("position")?r:CKEDITOR.dom.element.get(r.$.offsetParent)).getDocumentPosition().y)):r.getAscendant(CKEDITOR.env.ie?"body":"html",1).append(u),u.setStyles({position:"absolute",top:i.getScrollPosition().y-c+10+"px",width:"1px",height:Math.max(1,i.getViewPaneSize().height-20)+"px",overflow:"hidden",margin:0,padding:0}),CKEDITOR.env.safari&&u.setStyles(CKEDITOR.tools.cssVendorPrefix("user-select","text")),(c=u.getParent().isReadOnly())?(u.setOpacity(0),u.setAttribute("contenteditable",!0)):u.setStyle("ltr"==t.config.contentsLangDirection?"left":"right","-10000px"),t.on("selectionChange",a,null,null,0),(CKEDITOR.env.webkit||CKEDITOR.env.gecko)&&(o=r.once("blur",a,null,null,-100)),c&&u.focus(),(c=new CKEDITOR.dom.range(u)).selectNodeContents(u);var d=c.select();CKEDITOR.env.ie&&(o=r.once("blur",(function(){t.lockSelection(d)})));var f=CKEDITOR.document.getWindow().getScrollPosition().y;setTimeout((function(){var e;CKEDITOR.env.webkit&&(CKEDITOR.document.getBody().$.scrollTop=f),o&&o.removeListener(),CKEDITOR.env.ie&&r.focus(),s.selectBookmarks(l),u.remove(),CKEDITOR.env.webkit&&(e=u.getFirst())&&e.is&&e.hasClass("Apple-style-span")&&(u=e),t.removeListener("selectionChange",a),n(u.getHtml())}),0)}}(0,(function(n){o.dataValue=n.replace(/<span[^>]+data-cke-bookmark[^<]*?<\/span>/gi,""),i&&e(t,o)}))}function f(){if("wysiwyg"==t.mode){var e=h("paste");t.getCommand("cut").setState(h("cut")),t.getCommand("copy").setState(h("copy")),t.getCommand("paste").setState(e),t.fire("pasteState",e)}}function h(e){var n=(n=t.getSelection())&&n.getRanges()[0];return(t.readOnly||n&&n.checkReadOnly())&&e in{paste:1,cut:1}?CKEDITOR.TRISTATE_DISABLED:"paste"==e?CKEDITOR.TRISTATE_OFF:(n=(e=t.getSelection()).getRanges(),e.getType()==CKEDITOR.SELECTION_NONE||1==n.length&&n[0].collapsed?CKEDITOR.TRISTATE_DISABLED:CKEDITOR.TRISTATE_OFF)}var g=CKEDITOR.plugins.clipboard,m=0,p=0;!function(){if(t.on("key",c),t.on("contentDom",n),t.on("selectionChange",f),t.contextMenu){t.contextMenu.addListener((function(){return{cut:h("cut"),copy:h("copy"),paste:h("paste")}}));var e=null;t.on("menuShow",(function(){e&&(e.removeListener(),e=null);var n=t.contextMenu.findItemByCommandName("paste");n&&n.element&&(e=n.element.on("touchend",(function(){t._.forcePasteDialog=!0})))}))}t.ui.addButton&&t.once("instanceReady",(function(){t._.pasteButtons&&CKEDITOR.tools.array.forEach(t._.pasteButtons,(function(e){(e=t.ui.get(e))&&(e=CKEDITOR.document.getById(e._.id))&&e.on("touchend",(function(){t._.forcePasteDialog=!0}))}))}))}(),function(){function n(e,n,o,i,r){var a=t.lang.clipboard[n];t.addCommand(n,o),t.ui.addButton&&t.ui.addButton(e,{label:a,command:n,toolbar:"clipboard,"+i}),t.addMenuItems&&t.addMenuItem(n,{label:a,command:n,group:"clipboard",order:r})}n("Cut","cut",o("cut"),10,1),n("Copy","copy",o("copy"),20,4),n("Paste","paste",{canUndo:!1,async:!0,fakeKeystroke:CKEDITOR.CTRL+86,exec:function(t,n){function o(n,o){o=void 0===o||o,n?(n.method="paste",n.dataTransfer||(n.dataTransfer=g.initPasteDataTransfer()),e(t,n,o)):r&&!t._.forcePasteDialog&&t.showNotification(l,"info",t.config.clipboard_notificationDuration),t._.forcePasteDialog=!1,t.fire("afterCommandExec",{name:"paste",command:i,returnValue:!!n})}var i=this,r=void 0===(n=null!=n?n:{}).notification||n.notification,a=n.type,s=CKEDITOR.tools.keystrokeToString(t.lang.common.keyboard,t.getCommandKeystroke(this)),l="string"==typeof r?r:t.lang.clipboard.pasteNotification.replace(/%1/,'<kbd aria-label="'+s.aria+'">'+s.display+"</kbd>");s="string"==typeof n?n:n.dataValue,a&&!0!==t.config.forcePasteAsPlainText&&"allow-word"!==t.config.forcePasteAsPlainText?t._.nextPasteType=a:delete t._.nextPasteType,"string"==typeof s?o({dataValue:s}):t.getClipboardData(o)}},30,8),t._.pasteButtons||(t._.pasteButtons=[]),t._.pasteButtons.push("Paste")}(),t.getClipboardData=function(e,n){function o(e){e.removeListener(),e.cancel(),n(e.data)}function i(e){e.removeListener(),e.cancel(),n({type:a,dataValue:e.data.dataValue,dataTransfer:e.data.dataTransfer,method:"paste"})}var r=!1,a="auto";n||(n=e,e=null),t.on("beforePaste",(function(e){e.removeListener(),r=!0,a=e.data.type}),null,null,1e3),t.on("paste",o,null,null,0),!1===u()&&(t.removeListener("paste",o),t._.forcePasteDialog&&r&&t.fire("pasteDialog")?(t.on("pasteDialogCommit",i),t.on("dialogHide",(function(e){e.removeListener(),e.data.removeListener("pasteDialogCommit",i),e.data._.committed||n(null)}))):n(null))}}(n),function(t){var n=CKEDITOR.plugins.clipboard;t.on("contentDom",(function(){function o(e,n,o){var i={$:e.data.$,target:e.data.getTarget()};n&&(i.dragRange=n),o&&(i.dropRange=o),!1===t.fire(e.name,i)&&e.data.preventDefault()}function i(e){return e.type!=CKEDITOR.NODE_ELEMENT&&(e=e.getParent()),e.getChildCount()}var r=t.editable(),a=CKEDITOR.plugins.clipboard.getDropTarget(t),s=t.ui.space("top"),l=t.ui.space("bottom");n.preventDefaultDropOnElement(s),n.preventDefaultDropOnElement(l),r.attachListener(a,"dragstart",o),r.attachListener(t,"dragstart",n.resetDragDataTransfer,n,null,1),r.attachListener(t,"dragstart",(function(e){n.initDragDataTransfer(e,t)}),null,null,2),r.attachListener(t,"dragstart",(function(){var e=n.dragRange=t.getSelection().getRanges()[0];CKEDITOR.env.ie&&10>CKEDITOR.env.version&&(n.dragStartContainerChildCount=e?i(e.startContainer):null,n.dragEndContainerChildCount=e?i(e.endContainer):null)}),null,null,100),r.attachListener(a,"dragend",o),r.attachListener(t,"dragend",n.initDragDataTransfer,n,null,1),r.attachListener(t,"dragend",n.resetDragDataTransfer,n,null,100),r.attachListener(a,"dragover",(function(e){if(CKEDITOR.env.edge)e.data.preventDefault();else{var t=e.data.getTarget();(t&&t.is&&t.is("html")||CKEDITOR.env.ie&&CKEDITOR.plugins.clipboard.isFileApiSupported&&e.data.$.dataTransfer.types.contains("Files"))&&e.data.preventDefault()}})),r.attachListener(a,"drop",(function(e){var i;e.data.$.defaultPrevented||(e.data.preventDefault(),t.readOnly)||(!(i=e.data.getTarget()).isReadOnly()||i.type==CKEDITOR.NODE_ELEMENT&&i.is("html"))&&(i=n.getRangeAtDropPosition(e,t))&&o(e,n.dragRange,i)}),null,null,9999),r.attachListener(t,"drop",n.initDragDataTransfer,n,null,1),r.attachListener(t,"drop",(function(o){if(o=o.data){var i=o.dropRange,r=o.dragRange,a=o.dataTransfer;a.getTransferType(t)==CKEDITOR.DATA_TRANSFER_INTERNAL?setTimeout((function(){n.internalDrop(r,i,a,t)}),0):a.getTransferType(t)==CKEDITOR.DATA_TRANSFER_CROSS_EDITORS?function(n,o,i){o.select(),e(t,{dataTransfer:i,method:"drop"},1),i.sourceEditor.fire("saveSnapshot"),i.sourceEditor.editable().extractHtmlFromRange(n),i.sourceEditor.getSelection().selectRanges([n]),i.sourceEditor.fire("saveSnapshot")}(r,i,a):(s=a,i.select(),e(t,{dataTransfer:s,method:"drop"},1),n.resetDragDataTransfer())}var s}),null,null,9999)}))}(n),CKEDITOR.dialog.add("paste",CKEDITOR.getUrl(this.path+"dialogs/paste.js")),CKEDITOR.env.gecko){var r,a=["image/png","image/jpeg","image/gif"];n.on("paste",(function(e){var t=e.data,o=t.dataTransfer;if(!t.dataValue&&"paste"==t.method&&o&&1==o.getFilesCount()&&r!=o.id&&(o=o.getFile(0),-1!=CKEDITOR.tools.indexOf(a,o.type))){var i=new FileReader;i.addEventListener("load",(function(){e.data.dataValue='<img src="'+i.result+'" />',n.fire("paste",e.data)}),!1),i.addEventListener("abort",(function(){n.fire("paste",e.data)}),!1),i.addEventListener("error",(function(){n.fire("paste",e.data)}),!1),i.readAsDataURL(o),r=t.dataTransfer.id,e.stop()}}),null,null,1)}n.on("paste",(function(e){if(e.data.dataTransfer||(e.data.dataTransfer=new CKEDITOR.plugins.clipboard.dataTransfer),!e.data.dataValue){var t=e.data.dataTransfer,o=t.getData("text/html");o?(e.data.dataValue=o,e.data.type="html"):(o=t.getData("text/plain"))&&(e.data.dataValue=n.editable().transformPlainTextToHtml(o),e.data.type="text")}}),null,null,1),n.on("paste",(function(e){var t=e.data.dataValue,n=CKEDITOR.dtd.$block;if(-1<t.indexOf("Apple-")&&(t=t.replace(/<span class="Apple-converted-space">&nbsp;<\/span>/gi," "),"html"!=e.data.type&&(t=t.replace(/<span class="Apple-tab-span"[^>]*>([^<]*)<\/span>/gi,(function(e,t){return t.replace(/\t/g,"&nbsp;&nbsp; &nbsp;")}))),-1<t.indexOf('<br class="Apple-interchange-newline">')&&(e.data.startsWithEOL=1,e.data.preSniffing="html",t=t.replace(/<br class="Apple-interchange-newline">/,"")),t=t.replace(/(<[^>]+) class="Apple-[^"]*"/gi,"$1")),t.match(/^<[^<]+cke_(editable|contents)/i)){var o,i,r=new CKEDITOR.dom.element("div");for(r.setHtml(t);1==r.getChildCount()&&(o=r.getFirst())&&o.type==CKEDITOR.NODE_ELEMENT&&(o.hasClass("cke_editable")||o.hasClass("cke_contents"));)r=i=o;i&&(t=i.getHtml().replace(/<br>$/i,""))}CKEDITOR.env.ie?t=t.replace(/^&nbsp;(?: |\r\n)?<(\w+)/g,(function(t,o){return o.toLowerCase()in n?(e.data.preSniffing="html","<"+o):t})):CKEDITOR.env.webkit?t=t.replace(/<\/(\w+)><div><br><\/div>$/,(function(t,o){return o in n?(e.data.endsWithEOL=1,"</"+o+">"):t})):CKEDITOR.env.gecko&&(t=t.replace(/(\s)<br>$/,"$1")),e.data.dataValue=t}),null,null,3),n.on("paste",(function(e){e=e.data;var o,r=n._.nextPasteType||e.type,a=e.dataValue,s=n.config.clipboard_defaultContentType||"html",l=e.dataTransfer.getTransferType(n)==CKEDITOR.DATA_TRANSFER_EXTERNAL,u=!0===n.config.forcePasteAsPlainText;o="html"==r||"html"==e.preSniffing?"html":function(e){if(CKEDITOR.env.webkit){if(!e.match(/^[^<]*$/g)&&!e.match(/^(<div><br( ?\/)?><\/div>|<div>[^<]*<\/div>)*$/gi))return"html"}else if(CKEDITOR.env.ie){if(!e.match(/^([^<]|<br( ?\/)?>)*$/gi)&&!e.match(/^(<p>([^<]|<br( ?\/)?>)*<\/p>|(\r\n))*$/gi))return"html"}else{if(!CKEDITOR.env.gecko)return"html";if(!e.match(/^([^<]|<br( ?\/)?>)*$/gi))return"html"}return"htmlifiedtext"}(a),delete n._.nextPasteType,"htmlifiedtext"==o&&(a=function(e,t){function n(e){return CKEDITOR.tools.repeat("</p><p>",~~(e/2))+(1==e%2?"<br>":"")}return(t=(t=t.replace(/(?!\u3000)\s+/g," ").replace(/> +</g,"><").replace(/<br ?\/>/gi,"<br>")).replace(/<\/?[A-Z]+>/g,(function(e){return e.toLowerCase()}))).match(/^[^<]$/)?t:(CKEDITOR.env.webkit&&-1<t.indexOf("<div>")&&((t=t.replace(/^(<div>(<br>|)<\/div>)(?!$|(<div>(<br>|)<\/div>))/g,"<br>").replace(/^(<div>(<br>|)<\/div>){2}(?!$)/g,"<div></div>")).match(/<div>(<br>|)<\/div>/)&&(t="<p>"+t.replace(/(<div>(<br>|)<\/div>)+/g,(function(e){return n(e.split("</div><div>").length+1)}))+"</p>"),t=(t=t.replace(/<\/div><div>/g,"<br>")).replace(/<\/?div>/g,"")),CKEDITOR.env.gecko&&e.enterMode!=CKEDITOR.ENTER_BR&&(CKEDITOR.env.gecko&&(t=t.replace(/^<br><br>$/,"<br>")),-1<t.indexOf("<br><br>")&&(t="<p>"+t.replace(/(<br>){2,}/g,(function(e){return n(e.length/4)}))+"</p>")),function(e,t){return e.enterMode==CKEDITOR.ENTER_BR?t=t.replace(/(<\/p><p>)+/g,(function(e){return CKEDITOR.tools.repeat("<br>",e.length/7*2)})).replace(/<\/?p>/g,""):e.enterMode==CKEDITOR.ENTER_DIV&&(t=t.replace(/<(\/)?p>/g,"<$1div>")),t}(e,t))}(n.config,a)),"text"==r&&"html"==o?a=t(n,a,i.get("plain-text")):(l&&n.pasteFilter&&!e.dontFilter||u)&&(a=t(n,a,n.pasteFilter)),e.startsWithEOL&&(a='<br data-cke-eol="1">'+a),e.endsWithEOL&&(a+='<br data-cke-eol="1">'),"auto"==r&&(r="html"==o||"html"==s?"html":"text"),e.type=r,e.dataValue=a,delete e.preSniffing,delete e.startsWithEOL,delete e.endsWithEOL}),null,null,6),n.on("paste",(function(e){(e=e.data).dataValue&&(n.insertHtml(e.dataValue,e.type,e.range),setTimeout((function(){n.fire("afterPaste")}),0))}),null,null,1e3),n.on("pasteDialog",(function(e){setTimeout((function(){n.openDialog("paste",e.data)}),0)}))}}),CKEDITOR.plugins.clipboard={isCustomCopyCutSupported:!(CKEDITOR.env.ie&&16>CKEDITOR.env.version||CKEDITOR.env.iOS&&605>CKEDITOR.env.version),isCustomDataTypesSupported:!CKEDITOR.env.ie||16<=CKEDITOR.env.version,isFileApiSupported:!CKEDITOR.env.ie||9<CKEDITOR.env.version,mainPasteEvent:CKEDITOR.env.ie&&!CKEDITOR.env.edge?"beforepaste":"paste",addPasteButton:function(e,t,n){e.ui.addButton&&(e.ui.addButton(t,n),e._.pasteButtons||(e._.pasteButtons=[]),e._.pasteButtons.push(t))},canClipboardApiBeTrusted:function(e,t){return!!(e.getTransferType(t)!=CKEDITOR.DATA_TRANSFER_EXTERNAL||CKEDITOR.env.chrome&&!e.isEmpty()||CKEDITOR.env.gecko&&(e.getData("text/html")||e.getFilesCount())||CKEDITOR.env.safari&&603<=CKEDITOR.env.version&&!CKEDITOR.env.iOS||CKEDITOR.env.iOS&&605<=CKEDITOR.env.version||CKEDITOR.env.edge&&16<=CKEDITOR.env.version)},getDropTarget:function(e){var t=e.editable();return CKEDITOR.env.ie&&9>CKEDITOR.env.version||t.isInline()?t:e.document},fixSplitNodesAfterDrop:function(e,t,n,o){function i(e,n,o){var i=e;if(i.type==CKEDITOR.NODE_TEXT&&(i=e.getParent()),i.equals(n)&&o!=n.getChildCount())return e=t.startContainer.getChild(t.startOffset-1),n=t.startContainer.getChild(t.startOffset),e&&e.type==CKEDITOR.NODE_TEXT&&n&&n.type==CKEDITOR.NODE_TEXT&&(o=e.getLength(),e.setText(e.getText()+n.getText()),n.remove(),t.setStart(e,o),t.collapse(!0)),!0}var r=t.startContainer;"number"==typeof o&&"number"==typeof n&&r.type==CKEDITOR.NODE_ELEMENT&&(i(e.startContainer,r,n)||i(e.endContainer,r,o))},isDropRangeAffectedByDragRange:function(e,t){var n=t.startContainer,o=t.endOffset;return!!(e.endContainer.equals(n)&&e.endOffset<=o||e.startContainer.getParent().equals(n)&&e.startContainer.getIndex()<o||e.endContainer.getParent().equals(n)&&e.endContainer.getIndex()<o)},internalDrop:function(t,n,o,i){var r,a,s=CKEDITOR.plugins.clipboard,l=i.editable();i.fire("saveSnapshot"),i.fire("lockSnapshot",{dontUpdate:1}),CKEDITOR.env.ie&&10>CKEDITOR.env.version&&this.fixSplitNodesAfterDrop(t,n,s.dragStartContainerChildCount,s.dragEndContainerChildCount),(a=this.isDropRangeAffectedByDragRange(t,n))||(r=t.createBookmark(!1)),s=n.clone().createBookmark(!1),a&&(r=t.createBookmark(!1)),t=r.startNode,a=s.startNode,(n=r.endNode)&&t.getPosition(a)&CKEDITOR.POSITION_PRECEDING&&n.getPosition(a)&CKEDITOR.POSITION_FOLLOWING&&a.insertBefore(t),(t=i.createRange()).moveToBookmark(r),l.extractHtmlFromRange(t,1),n=i.createRange(),s.startNode.getCommonAncestor(l)||(s=i.getSelection().createBookmarks()[0]),n.moveToBookmark(s),e(i,{dataTransfer:o,method:"drop",range:n},1),i.fire("unlockSnapshot")},getRangeAtDropPosition:function(e,t){var n=e.data.$,o=n.clientX,i=n.clientY,a=t.getSelection(!0).getRanges()[0],s=t.createRange();if(e.data.testRange)return e.data.testRange;if(document.caretRangeFromPoint&&t.document.$.caretRangeFromPoint(o,i))n=t.document.$.caretRangeFromPoint(o,i),s.setStart(CKEDITOR.dom.node(n.startContainer),n.startOffset),s.collapse(!0);else if(n.rangeParent)s.setStart(CKEDITOR.dom.node(n.rangeParent),n.rangeOffset),s.collapse(!0);else{if(CKEDITOR.env.ie&&8<CKEDITOR.env.version&&a&&t.editable().hasFocus)return a;if(!document.body.createTextRange)return null;t.focus(),n=t.document.getBody().$.createTextRange();try{for(var l=!1,u=0;20>u&&!l;u++){if(!l)try{n.moveToPoint(o,i-u),l=!0}catch(r){}if(!l)try{n.moveToPoint(o,i+u),l=!0}catch(m){}}if(l){var c="cke-temp-"+(new Date).getTime();n.pasteHTML('<span id="'+c+'">​</span>');var d=t.document.getById(c);s.moveToPosition(d,CKEDITOR.POSITION_BEFORE_START),d.remove()}else{var f,h=t.document.$.elementFromPoint(o,i),g=new CKEDITOR.dom.element(h);if(g.equals(t.editable())||"html"==g.getName())return a&&a.startContainer&&!a.startContainer.equals(t.editable())?a:null;f=g.getClientRect(),s.setStartAt(g,o<f.left?CKEDITOR.POSITION_AFTER_START:CKEDITOR.POSITION_BEFORE_END),s.collapse(!0)}}catch(p){return null}}return s},initDragDataTransfer:function(e,t){var n=e.data.$?e.data.$.dataTransfer:null,o=new this.dataTransfer(n,t);"dragstart"===e.name&&o.storeId(),n?this.dragData&&o.id==this.dragData.id?o=this.dragData:this.dragData=o:this.dragData?o=this.dragData:this.dragData=o,e.data.dataTransfer=o},resetDragDataTransfer:function(){this.dragData=null},initPasteDataTransfer:function(e,t){if(this.isCustomCopyCutSupported){if(e&&e.data&&e.data.$){var n=e.data.$.clipboardData,o=new this.dataTransfer(n,t);return"copy"!==e.name&&"cut"!==e.name||o.storeId(),this.copyCutData&&o.id==this.copyCutData.id?(o=this.copyCutData).$=n:this.copyCutData=o,o}return new this.dataTransfer(null,t)}return new this.dataTransfer(CKEDITOR.env.edge&&e&&e.data.$&&e.data.$.clipboardData||null,t)},preventDefaultDropOnElement:function(e){e&&e.on("dragover",i)}},r=CKEDITOR.plugins.clipboard.isCustomDataTypesSupported?"cke/id":"Text",CKEDITOR.plugins.clipboard.dataTransfer=function(e,t){e&&(this.$=e),this._={metaRegExp:/^<meta.*?>/i,bodyRegExp:/<body(?:[\s\S]*?)>([\s\S]*)<\/body>/i,fragmentRegExp:/\x3c!--(?:Start|End)Fragment--\x3e/g,data:{},files:[],nativeHtmlCache:"",normalizeType:function(e){return"text"==(e=e.toLowerCase())||"text/plain"==e?"Text":"url"==e?"URL":e}},this._.fallbackDataTransfer=new CKEDITOR.plugins.clipboard.fallbackDataTransfer(this),this.id=this.getData(r),this.id||(this.id="Text"==r?"":"cke-"+CKEDITOR.tools.getUniqueId()),t&&(this.sourceEditor=t,this.setData("text/html",t.getSelectedHtml(1)),"Text"==r||this.getData("text/plain")||this.setData("text/plain",t.getSelection().getSelectedText()))},CKEDITOR.DATA_TRANSFER_INTERNAL=1,CKEDITOR.DATA_TRANSFER_CROSS_EDITORS=2,CKEDITOR.DATA_TRANSFER_EXTERNAL=3,CKEDITOR.plugins.clipboard.dataTransfer.prototype={getData:function(e,t){if(null==(o="text/html"==(e=this._.normalizeType(e))&&t?this._.nativeHtmlCache:this._.data[e])||""===o){if(this._.fallbackDataTransfer.isRequired())o=this._.fallbackDataTransfer.getData(e,t);else try{o=this.$.getData(e)||""}catch(i){o=""}"text/html"!=e||t||(o=this._stripHtml(o))}if("Text"==e&&CKEDITOR.env.gecko&&this.getFilesCount()&&"file://"==o.substring(0,7)&&(o=""),"string"==typeof o)var n=o.indexOf("</html>"),o=-1!==n?o.substring(0,n+7):o;return o},setData:function(e,t){if("text/html"==(e=this._.normalizeType(e))?(this._.data[e]=this._stripHtml(t),this._.nativeHtmlCache=t):this._.data[e]=t,CKEDITOR.plugins.clipboard.isCustomDataTypesSupported||"URL"==e||"Text"==e)if("Text"==r&&"Text"==e&&(this.id=t),this._.fallbackDataTransfer.isRequired())this._.fallbackDataTransfer.setData(e,t);else try{this.$.setData(e,t)}catch(n){}},storeId:function(){"Text"!==r&&this.setData(r,this.id)},getTransferType:function(e){return this.sourceEditor?this.sourceEditor==e?CKEDITOR.DATA_TRANSFER_INTERNAL:CKEDITOR.DATA_TRANSFER_CROSS_EDITORS:CKEDITOR.DATA_TRANSFER_EXTERNAL},cacheData:function(){function e(e){e=o._.normalizeType(e);var t=o.getData(e);"text/html"==e&&(o._.nativeHtmlCache=o.getData(e,!0),t=o._stripHtml(t)),t&&(o._.data[e]=t)}if(this.$){var t,n,o=this;if(CKEDITOR.plugins.clipboard.isCustomDataTypesSupported){if(this.$.types)for(t=0;t<this.$.types.length;t++)e(this.$.types[t])}else e("Text"),e("URL");if(n=this._getImageFromClipboard(),this.$&&this.$.files||n){if(this._.files=[],this.$.files&&this.$.files.length)for(t=0;t<this.$.files.length;t++)this._.files.push(this.$.files[t]);0===this._.files.length&&n&&this._.files.push(n)}}},getFilesCount:function(){return this._.files.length?this._.files.length:this.$&&this.$.files&&this.$.files.length?this.$.files.length:this._getImageFromClipboard()?1:0},getFile:function(e){return this._.files.length?this._.files[e]:this.$&&this.$.files&&this.$.files.length?this.$.files[e]:0===e?this._getImageFromClipboard():void 0},isEmpty:function(){var e,t={};if(this.getFilesCount())return!1;if(CKEDITOR.tools.array.forEach(CKEDITOR.tools.object.keys(this._.data),(function(e){t[e]=1})),this.$)if(CKEDITOR.plugins.clipboard.isCustomDataTypesSupported){if(this.$.types)for(var n=0;n<this.$.types.length;n++)t[this.$.types[n]]=1}else t.Text=1,t.URL=1;for(e in"Text"!=r&&(t[r]=0),t)if(t[e]&&""!==this.getData(e))return!1;return!0},_getImageFromClipboard:function(){var e;try{if(this.$&&this.$.items&&this.$.items[0]&&(e=this.$.items[0].getAsFile())&&e.type)return e}catch(b){}},_stripHtml:function(e){if(e&&e.length){e=e.replace(this._.metaRegExp,"");var t=this._.bodyRegExp.exec(e);t&&t.length&&(e=(e=t[1]).replace(this._.fragmentRegExp,""))}return e}},CKEDITOR.plugins.clipboard.fallbackDataTransfer=function(e){this._dataTransfer=e,this._customDataFallbackType="text/html"},CKEDITOR.plugins.clipboard.fallbackDataTransfer._isCustomMimeTypeSupported=null,CKEDITOR.plugins.clipboard.fallbackDataTransfer._customTypes=[],CKEDITOR.plugins.clipboard.fallbackDataTransfer.prototype={isRequired:function(){var e=CKEDITOR.plugins.clipboard.fallbackDataTransfer,t=this._dataTransfer.$;if(null===e._isCustomMimeTypeSupported){if(!t)return!1;if(e._isCustomMimeTypeSupported=!1,CKEDITOR.env.edge&&17<=CKEDITOR.env.version)return!0;try{t.setData("cke/mimetypetest","cke test value"),e._isCustomMimeTypeSupported="cke test value"===t.getData("cke/mimetypetest"),t.clearData("cke/mimetypetest")}catch(n){}}return!e._isCustomMimeTypeSupported},getData:function(e,t){var n,o=this._getData(this._customDataFallbackType,!0);return t?o:(o=this._extractDataComment(o),null!==(n=e===this._customDataFallbackType?o.content:o.data&&o.data[e]?o.data[e]:this._getData(e,!0))?n:"")},setData:function(e,t){(a=e===this._customDataFallbackType)&&(t=this._applyDataComment(t,this._getFallbackTypeData()));var i=t,r=this._dataTransfer.$;try{r.setData(e,i),a&&(this._dataTransfer._.nativeHtmlCache=i)}catch(o){if(this._isUnsupportedMimeTypeError(o)){a=CKEDITOR.plugins.clipboard.fallbackDataTransfer,-1===CKEDITOR.tools.indexOf(a._customTypes,e)&&a._customTypes.push(e);var a=this._getFallbackTypeContent(),s=this._getFallbackTypeData();s[e]=i;try{i=this._applyDataComment(a,s),r.setData(this._customDataFallbackType,i),this._dataTransfer._.nativeHtmlCache=i}catch(n){i=""}}}return i},_getData:function(e,t){var n=this._dataTransfer._.data;if(!t&&n[e])return n[e];try{return this._dataTransfer.$.getData(e)}catch(o){return null}},_getFallbackTypeContent:function(){var e=this._dataTransfer._.data[this._customDataFallbackType];return e||(e=this._extractDataComment(this._getData(this._customDataFallbackType,!0)).content),e},_getFallbackTypeData:function(){var e=CKEDITOR.plugins.clipboard.fallbackDataTransfer._customTypes,t=this._extractDataComment(this._getData(this._customDataFallbackType,!0)).data||{},n=this._dataTransfer._.data;return CKEDITOR.tools.array.forEach(e,(function(e){void 0!==n[e]?t[e]=n[e]:void 0!==t[e]&&(t[e]=t[e])}),this),t},_isUnsupportedMimeTypeError:function(e){return e.message&&-1!==e.message.search(/element not found/gi)},_extractDataComment:function(e){var t,n={data:null,content:e||""};return e&&16<e.length&&(t=/\x3c!--cke-data:(.*?)--\x3e/g.exec(e))&&t[1]&&(n.data=JSON.parse(decodeURIComponent(t[1])),n.content=e.replace(t[0],"")),n},_applyDataComment:function(e,t){var n="";return t&&CKEDITOR.tools.object.keys(t).length&&(n="\x3c!--cke-data:"+encodeURIComponent(JSON.stringify(t))+"--\x3e"),n+(e&&e.length?e:"")}}}(),CKEDITOR.config.clipboard_notificationDuration=1e4,CKEDITOR.plugins.add("panelbutton",{requires:"button",onLoad:function(){function e(e){var t=this._;t.state!=CKEDITOR.TRISTATE_DISABLED&&(this.createPanel(e),t.on?t.panel.hide():t.panel.showBlock(this._.id,this.document.getById(this._.id),4))}CKEDITOR.ui.panelButton=CKEDITOR.tools.createClass({base:CKEDITOR.ui.button,$:function(t){var n=t.panel||{};delete t.panel,this.base(t),this.document=n.parent&&n.parent.getDocument()||CKEDITOR.document,n.block={attributes:n.attributes},n.toolbarRelated=!0,this.hasArrow="listbox",this.click=e,this._={panelDefinition:n}},statics:{handler:{create:function(e){return new CKEDITOR.ui.panelButton(e)}}},proto:{createPanel:function(e){var t=this._;if(!t.panel){var n=this._.panelDefinition.block,o=(r=this._.panelDefinition).parent||CKEDITOR.document.getBody(),i=this._.panel=new CKEDITOR.ui.floatPanel(e,o,r),r=i.addBlock(t.id,n),a=this;i.onShow=function(){a.className&&this.element.addClass(a.className+"_panel"),a.setState(CKEDITOR.TRISTATE_ON),t.on=1,a.editorFocus&&e.focus(),a.onOpen&&a.onOpen()},i.onHide=function(n){a.className&&this.element.getFirst().removeClass(a.className+"_panel"),a.setState(a.modes&&a.modes[e.mode]?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED),t.on=0,!n&&a.onClose&&a.onClose()},i.onEscape=function(){i.hide(1),a.document.getById(t.id).focus()},this.onBlock&&this.onBlock(i,r),r.onHide=function(){t.on=0,a.setState(CKEDITOR.TRISTATE_OFF)}}}}})},beforeInit:function(e){e.ui.addHandler(CKEDITOR.UI_PANELBUTTON,CKEDITOR.ui.panelButton.handler)}}),CKEDITOR.UI_PANELBUTTON="panelbutton",function(){CKEDITOR.plugins.add("panel",{beforeInit:function(e){e.ui.addHandler(CKEDITOR.UI_PANEL,CKEDITOR.ui.panel.handler)}}),CKEDITOR.UI_PANEL="panel",CKEDITOR.ui.panel=function(e,t){t&&CKEDITOR.tools.extend(this,t),CKEDITOR.tools.extend(this,{className:"",css:[]}),this.id=CKEDITOR.tools.getNextId(),this.document=e,this.isFramed=this.forceIFrame||this.css.length,this._={blocks:{}}},CKEDITOR.ui.panel.handler={create:function(e){return new CKEDITOR.ui.panel(e)}};var e=CKEDITOR.addTemplate("panel",'<div lang="{langCode}" id="{id}" dir={dir} class="cke cke_reset_all {editorId} cke_panel cke_panel {cls} cke_{dir}" style="z-index:{z-index}" role="presentation">{frame}</div>'),t=CKEDITOR.addTemplate("panel-frame",'<iframe id="{id}" class="cke_panel_frame" role="presentation" frameborder="0" src="{src}"></iframe>'),n=CKEDITOR.addTemplate("panel-frame-inner",'<!DOCTYPE html><html class="cke_panel_container {env}" dir="{dir}" lang="{langCode}"><head>{css}</head><body class="cke_{dir}" style="margin:0;padding:0" onload="{onload}"></body></html>');CKEDITOR.ui.panel.prototype={render:function(o,i){var r={editorId:o.id,id:this.id,langCode:o.langCode,dir:o.lang.dir,cls:this.className,frame:"",env:CKEDITOR.env.cssClass,"z-index":o.config.baseFloatZIndex+1};if(this.getHolderElement=function(){if(!(t=this._.holder)){if(this.isFramed){var e=(t=this.document.getById(this.id+"_frame")).getParent(),t=t.getFrameDocument();CKEDITOR.env.iOS&&e.setStyles({overflow:"scroll","-webkit-overflow-scrolling":"touch"}),e=CKEDITOR.tools.addFunction(CKEDITOR.tools.bind((function(){this.isLoaded=!0,this.onLoad&&this.onLoad()}),this)),t.write(n.output(CKEDITOR.tools.extend({css:CKEDITOR.tools.buildStyleHtml(this.css),onload:"window.parent.CKEDITOR.tools.callFunction("+e+");"},r))),t.getWindow().$.CKEDITOR=CKEDITOR,t.on("keydown",(function(e){var t=e.data.getKeystroke(),n=this.document.getById(this.id).getAttribute("dir");("input"!==e.data.getTarget().getName()||37!==t&&39!==t)&&(this._.onKeyDown&&!1===this._.onKeyDown(t)?"input"===e.data.getTarget().getName()&&32===t||e.data.preventDefault():(27==t||t==("rtl"==n?39:37))&&this.onEscape&&!1===this.onEscape(t)&&e.data.preventDefault())}),this),(t=t.getBody()).unselectable(),CKEDITOR.env.air&&CKEDITOR.tools.callFunction(e)}else t=this.document.getById(this.id);this._.holder=t}return t},this.isFramed){var a=CKEDITOR.env.air?"javascript:void(0)":CKEDITOR.env.ie&&!CKEDITOR.env.edge?"javascript:void(function(){"+encodeURIComponent("document.open();("+CKEDITOR.tools.fixDomain+")();document.close();")+"}())":"";r.frame=t.output({id:this.id+"_frame",src:a})}return a=e.output(r),i&&i.push(a),a},addBlock:function(e,t){return t=this._.blocks[e]=t instanceof CKEDITOR.ui.panel.block?t:new CKEDITOR.ui.panel.block(this.getHolderElement(),t),this._.currentBlock||this.showBlock(e),t},getBlock:function(e){return this._.blocks[e]},showBlock:function(e){e=this._.blocks[e];var t=this._.currentBlock,n=!this.forceIFrame||CKEDITOR.env.ie?this._.holder:this.document.getById(this.id+"_frame");return t&&t.hide(),this._.currentBlock=e,CKEDITOR.fire("ariaWidget",n),e._.focusIndex=-1,this._.onKeyDown=e.onKeyDown&&CKEDITOR.tools.bind(e.onKeyDown,e),e.show(),e},destroy:function(){this.element&&this.element.remove()}},CKEDITOR.ui.panel.block=CKEDITOR.tools.createClass({$:function(e,t){this.element=e.append(e.getDocument().createElement("div",{attributes:{tabindex:-1,class:"cke_panel_block"},styles:{display:"none"}})),t&&CKEDITOR.tools.extend(this,t),this.element.setAttributes({role:this.attributes.role||"presentation","aria-label":this.attributes["aria-label"],title:this.attributes.title||this.attributes["aria-label"]}),this.keys={},this._.focusIndex=-1,this.element.disableContextMenu()},_:{markItem:function(e){-1!=e&&(e=this._.getItems().getItem(this._.focusIndex=e),CKEDITOR.env.webkit&&e.getDocument().getWindow().focus(),e.focus(),this.onMark&&this.onMark(e))},markFirstDisplayed:function(e){for(var t,n,o=function(e){return e.type==CKEDITOR.NODE_ELEMENT&&"none"==e.getStyle("display")},i=this._.getItems(),r=i.count()-1;0<=r;r--)if((t=i.getItem(r)).getAscendant(o)||(n=t,this._.focusIndex=r),"true"==t.getAttribute("aria-selected")){n=t,this._.focusIndex=r;break}n&&(e&&e(),CKEDITOR.env.webkit&&n.getDocument().getWindow().focus(),n.focus(),this.onMark&&this.onMark(n))},getItems:function(){return this.element.find("a,input")}},proto:{show:function(){this.element.setStyle("display","")},hide:function(){this.onHide&&!0===this.onHide.call(this)||this.element.setStyle("display","none")},onKeyDown:function(e,t){switch(i=this.keys[e]){case"next":for(var n,o=this._.focusIndex,i=this._.getItems();n=i.getItem(++o);)if(n.getAttribute("_cke_focus")&&n.$.offsetWidth){this._.focusIndex=o,n.focus(!0);break}return!n&&!t&&(this._.focusIndex=-1,this.onKeyDown(e,1));case"prev":for(o=this._.focusIndex,i=this._.getItems();0<o&&(n=i.getItem(--o));){if(n.getAttribute("_cke_focus")&&n.$.offsetWidth){this._.focusIndex=o,n.focus(!0);break}n=null}return!n&&!t&&(this._.focusIndex=i.count(),this.onKeyDown(e,1));case"click":case"mouseup":return(n=0<=(o=this._.focusIndex)&&this._.getItems().getItem(o))&&n.fireEventHandler(i,{button:CKEDITOR.tools.normalizeMouseButton(CKEDITOR.MOUSE_BUTTON_LEFT,!0)}),!1}return!0}}})}(),CKEDITOR.plugins.add("floatpanel",{requires:"panel"}),n={},CKEDITOR.ui.floatPanel=CKEDITOR.tools.createClass({$:function(e,t,o,i){function r(){u.hide()}o.forceIFrame=1,o.toolbarRelated&&e.elementMode==CKEDITOR.ELEMENT_MODE_INLINE&&(t=CKEDITOR.document.getById("cke_"+e.name));var a=t.getDocument(),s=(i=function(e,t,o,i,r){r=CKEDITOR.tools.genKey(t.getUniqueId(),o.getUniqueId(),e.lang.dir,e.uiColor||"",i.css||"",r||"");var a=n[r];return a||((a=n[r]=new CKEDITOR.ui.panel(t,i)).element=o.append(CKEDITOR.dom.element.createFromHtml(a.render(e),t)),a.element.setStyles({display:"none",position:"absolute"})),a}(e,a,t,o,i||0)).element,l=s.getFirst(),u=this;s.disableContextMenu(),this.element=s,this._={editor:e,panel:i,parentElement:t,definition:o,document:a,iframe:l,children:[],dir:e.lang.dir,showBlockParams:null,markFirst:void 0===o.markFirst||o.markFirst},e.on("mode",r),e.on("resize",r),a.getWindow().on("resize",(function(){this.reposition()}),this)},proto:{addBlock:function(e,t){return this._.panel.addBlock(e,t)},addListBlock:function(e,t){return this._.panel.addListBlock(e,t)},getBlock:function(e){return this._.panel.getBlock(e)},showBlock:function(e,t,n,o,i,r){var a=this._.panel,s=a.showBlock(e);this._.showBlockParams=[].slice.call(arguments),this.allowBlur(!1);var l=this._.editor.editable();this._.returnFocus=l.hasFocus?l:new CKEDITOR.dom.element(CKEDITOR.document.$.activeElement),this._.hideTimeout=0;var u=this.element,c=(l=this._.iframe,l=CKEDITOR.env.ie&&!CKEDITOR.env.edge?l:new CKEDITOR.dom.window(l.$.contentWindow),u.getDocument()),d=this._.parentElement.getPositionedAncestor(),f=t.getDocumentPosition(c),h=(c=d?d.getDocumentPosition(c):{x:0,y:0},"rtl"==this._.dir),g=f.x+(o||0)-c.x,m=f.y+(i||0)-c.y;!h||1!=n&&4!=n?h||2!=n&&3!=n||(g+=t.$.offsetWidth-1):g+=t.$.offsetWidth,3!=n&&4!=n||(m+=t.$.offsetHeight-1),this._.panel._.offsetParentId=t.getId(),u.setStyles({top:m+"px",left:0,display:""}),u.setOpacity(0),u.getFirst().removeStyle("width"),this._.editor.focusManager.add(l),this._.blurSet||(CKEDITOR.event.useCapture=!0,l.on("blur",(function(e){function t(){delete this._.returnFocus,this.hide()}this.allowBlur()&&e.data.getPhase()==CKEDITOR.EVENT_PHASE_AT_TARGET&&this.visible&&!this._.activeChild&&(CKEDITOR.env.iOS?this._.hideTimeout||(this._.hideTimeout=CKEDITOR.tools.setTimeout(t,0,this)):t.call(this))}),this),l.on("focus",(function(){this._.focused=!0,this.hideChild(),this.allowBlur(!0)}),this),CKEDITOR.env.iOS&&(l.on("touchstart",(function(){clearTimeout(this._.hideTimeout)}),this),l.on("touchend",(function(){this._.hideTimeout=0,this.focus()}),this)),CKEDITOR.event.useCapture=!1,this._.blurSet=1),a.onEscape=CKEDITOR.tools.bind((function(e){if(this.onEscape&&!1===this.onEscape(e))return!1}),this),CKEDITOR.tools.setTimeout((function(){var e=CKEDITOR.tools.bind((function(){if((n=u).removeStyle("width"),s.autoSize){var e=s.element.getDocument();e=(CKEDITOR.env.webkit||CKEDITOR.env.edge?s.element:e.getBody()).$.scrollWidth,CKEDITOR.env.ie&&CKEDITOR.env.quirks&&0<e&&(e+=(n.$.offsetWidth||0)-(n.$.clientWidth||0)+3),n.setStyle("width",e+10+"px"),e=s.element.$.scrollHeight,CKEDITOR.env.ie&&CKEDITOR.env.quirks&&0<e&&(e+=(n.$.offsetHeight||0)-(n.$.clientHeight||0)+3),n.setStyle("height",e+"px"),a._.currentBlock.element.setStyle("display","none").removeStyle("display")}else n.removeStyle("height");h&&(g-=u.$.offsetWidth),u.setStyle("left",g+"px"),e=a.element.getWindow();var t,n=u.$.getBoundingClientRect(),o=(e=e.getViewPaneSize(),n.width||n.right-n.left),i=n.height||n.bottom-n.top,l=h?n.right:e.width-n.left,c=h?e.width-n.right:n.left;h?l<o&&(g=c>o?g+o:e.width>o?g-n.left:g-n.right+e.width):l<o&&(g=c>o?g-o:e.width>o?g-n.right+e.width:g-n.left),o=n.top,e.height-n.top<i&&(m=o>i?m-i:e.height>i?m-n.bottom+e.height:m-n.top),CKEDITOR.env.ie&&!CKEDITOR.env.edge&&((e=n=u.$.offsetParent&&new CKEDITOR.dom.element(u.$.offsetParent))&&"html"==e.getName()&&(e=e.getDocument().getBody()),e&&"rtl"==e.getComputedStyle("direction")&&(g=CKEDITOR.env.ie8Compat?g-2*u.getDocument().getDocumentElement().$.scrollLeft:g-(n.$.scrollWidth-n.$.clientWidth))),(t=(n=u.getFirst()).getCustomData("activePanel"))&&t.onHide&&t.onHide.call(this,1),n.setCustomData("activePanel",this),u.setStyles({top:m+"px",left:g+"px"}),u.setOpacity(1),r&&r()}),this);a.isLoaded?e():a.onLoad=e,CKEDITOR.tools.setTimeout((function(){var e=CKEDITOR.env.webkit&&CKEDITOR.document.getWindow().getScrollPosition().y;this.focus(),s.element.focus(),CKEDITOR.env.webkit&&(CKEDITOR.document.getBody().$.scrollTop=e),this.allowBlur(!0),this._.markFirst&&(CKEDITOR.env.ie?CKEDITOR.tools.setTimeout((function(){s.markFirstDisplayed?s.markFirstDisplayed():s._.markFirstDisplayed()}),0):s.markFirstDisplayed?s.markFirstDisplayed():s._.markFirstDisplayed()),this._.editor.fire("panelShow",this)}),0,this)}),CKEDITOR.env.air?200:0,this),this.visible=1,this.onShow&&this.onShow.call(this)},reposition:function(){var e=this._.showBlockParams;this.visible&&this._.showBlockParams&&(this.hide(),this.showBlock.apply(this,e))},focus:function(){if(CKEDITOR.env.webkit){var e=CKEDITOR.document.getActive();e&&!e.equals(this._.iframe)&&e.$.blur()}(this._.lastFocused||this._.iframe.getFrameDocument().getWindow()).focus()},blur:function(){var e=this._.iframe.getFrameDocument().getActive();e&&e.is("a")&&(this._.lastFocused=e)},hide:function(e){!this.visible||this.onHide&&!0===this.onHide.call(this)||(this.hideChild(),CKEDITOR.env.gecko&&this._.iframe.getFrameDocument().$.activeElement.blur(),this.element.setStyle("display","none"),this.visible=0,this.element.getFirst().removeCustomData("activePanel"),(e=e&&this._.returnFocus)&&(CKEDITOR.env.webkit&&e.type&&e.getWindow().$.focus(),e.focus()),delete this._.lastFocused,this._.showBlockParams=null,this._.editor.fire("panelHide",this))},allowBlur:function(e){var t=this._.panel;return void 0!==e&&(t.allowBlur=e),t.allowBlur},showAsChild:function(e,t,n,o,i,r){this._.activeChild==e&&e._.panel._.offsetParentId==n.getId()||(this.hideChild(),e.onHide=CKEDITOR.tools.bind((function(){CKEDITOR.tools.setTimeout((function(){this._.focused||this.hide()}),0,this)}),this),this._.activeChild=e,this._.focused=!1,e.showBlock(t,n,o,i,r),this.blur(),(CKEDITOR.env.ie7Compat||CKEDITOR.env.ie6Compat)&&setTimeout((function(){e.element.getChild(0).$.style.cssText+=""}),100))},hideChild:function(e){var t=this._.activeChild;t&&(delete t.onHide,delete this._.activeChild,t.hide(),e&&this.focus())}}}),CKEDITOR.on("instanceDestroyed",(function(){var e,t=CKEDITOR.tools.isEmpty(CKEDITOR.instances);for(e in n){var o=n[e];t?o.destroy():o.element.hide()}t&&(n={})})),CKEDITOR.plugins.add("colorbutton",{requires:"panelbutton,floatpanel",init:function(e){function t(t,a,s,l,u){var c,d=new CKEDITOR.style(i["colorButton_"+a+"Style"]),f=CKEDITOR.tools.getNextId()+"_colorBox",h={type:a};u=u||{},e.ui.add(t,CKEDITOR.UI_PANELBUTTON,{label:s,title:s,modes:{wysiwyg:1},editorFocus:0,toolbar:"colors,"+l,allowedContent:d,requiredContent:d,contentTransformations:u.contentTransformations,panel:{css:CKEDITOR.skin.getPath("editor"),attributes:{role:"listbox","aria-label":r.panelTitle}},onBlock:function(t,o){c=o,o.autoSize=!0,o.element.addClass("cke_colorblock"),o.element.setHtml(function(t,o,a,s){t=[];var l=i.colorButton_colors.split(","),u=i.colorButton_colorsPerRow||6,c=e.plugins.colordialog&&!1!==i.colorButton_enableMore,d=l.length+(c?2:1),f=CKEDITOR.tools.addFunction((function(t,o){function r(t){var r=i["colorButton_"+o+"Style"];e.removeStyle(new CKEDITOR.style(r,{color:"inherit"})),r.childRule="back"==o?function(e){return n(e)}:function(e){return!(e.is("a")||e.getElementsByTag("a").count())||n(e)},e.focus(),t&&e.applyStyle(new CKEDITOR.style(r,{color:t})),e.fire("saveSnapshot")}if(e.focus(),e.fire("saveSnapshot"),"?"!=t)return r(t&&"#"+t);e.getColorFromDialog((function(e){if(e)return r(e)}),null,s)}));for(!1!==i.colorButton_enableAutomatic&&t.push('<a class="cke_colorauto" _cke_focus=1 hidefocus=true title="',r.auto,'" draggable="false" ondragstart="return false;" onclick="CKEDITOR.tools.callFunction(',f,",null,'",o,"');return false;\" href=\"javascript:void('",r.auto,'\')" role="option" aria-posinset="1" aria-setsize="',d,'"><table role="presentation" cellspacing=0 cellpadding=0 width="100%"><tr><td colspan="'+u+'" align="center"><span class="cke_colorbox" id="',a,'"></span>',r.auto,"</td></tr></table></a>"),t.push('<table role="presentation" cellspacing=0 cellpadding=0 width="100%">'),a=0;a<l.length;a++){0==a%u&&t.push("</tr><tr>");var h=l[a].split("/"),g=h[0],m=h[1]||g;t.push('<td><a class="cke_colorbox" _cke_focus=1 hidefocus=true title="',h[1]?g:e.lang.colorbutton.colors[m]||m,'" draggable="false" ondragstart="return false;" onclick="CKEDITOR.tools.callFunction(',f,",'",m,"','",o,"'); return false;\" href=\"javascript:void('",m,'\')" data-value="'+m+'" role="option" aria-posinset="',a+2,'" aria-setsize="',d,'"><span class="cke_colorbox" style="background-color:#',m,'"></span></a></td>')}return c&&t.push('</tr><tr><td colspan="'+u+'" align="center"><a class="cke_colormore" _cke_focus=1 hidefocus=true title="',r.more,'" draggable="false" ondragstart="return false;" onclick="CKEDITOR.tools.callFunction(',f,",'?','",o,"');return false;\" href=\"javascript:void('",r.more,"')\"",' role="option" aria-posinset="',d,'" aria-setsize="',d,'">',r.more,"</a></td>"),t.push("</tr></table>"),t.join("")}(t,a,f,h)),o.element.getDocument().getBody().setStyle("overflow","hidden"),CKEDITOR.ui.fire("ready",this);var s=o.keys,l="rtl"==e.lang.dir;s[l?37:39]="next",s[40]="next",s[9]="next",s[l?39:37]="prev",s[38]="prev",s[CKEDITOR.SHIFT+9]="prev",s[32]="click"},refresh:function(){e.activeFilter.check(d)||this.setState(CKEDITOR.TRISTATE_DISABLED)},onOpen:function(){var t=(r=e.getSelection())&&r.getStartElement(),n=e.elementPath(t);if(n){t=n.block||n.blockLimit||e.document.getBody();do{n=t&&t.getComputedStyle("back"==a?"background-color":"color")||"transparent"}while("back"==a&&"transparent"==n&&t&&(t=t.getParent()));if(n&&"transparent"!=n||(n="#ffffff"),!1!==i.colorButton_enableAutomatic&&this._.panel._.iframe.getFrameDocument().getById(f).setStyle("background-color",n),t=r&&r.getRanges()[0]){var r=new CKEDITOR.dom.walker(t),s=t.collapsed?t.startContainer:r.next();for(t="";s;){if(s.type!==CKEDITOR.NODE_ELEMENT&&(s=s.getParent()),s=o(s.getComputedStyle("back"==a?"background-color":"color")),(t=t||s)!==s){t="";break}s=r.next()}for("transparent"==t&&(t=""),"fore"==a&&(h.automaticTextColor="#"+o(n)),h.selectionColor=t?"#"+t:"",r=t,t=c._.getItems(),s=0;s<t.count();s++){var l=t.getItem(s);l.removeAttribute("aria-selected"),r&&r==o(l.getAttribute("data-value"))&&l.setAttribute("aria-selected",!0)}}return n}}})}function n(e){return"false"==e.getAttribute("contentEditable")||e.getAttribute("data-nostyle")}function o(e){return CKEDITOR.tools.normalizeHex("#"+CKEDITOR.tools.convertRgbToHex(e||"")).replace(/#/g,"")}var i=e.config,r=e.lang.colorbutton;if(!CKEDITOR.env.hc){t("TextColor","fore",r.textColorTitle,10,{contentTransformations:[[{element:"font",check:"span{color}",left:function(e){return!!e.attributes.color},right:function(e){e.name="span",e.attributes.color&&(e.styles.color=e.attributes.color),delete e.attributes.color}}]]});var a={},s=e.config.colorButton_normalizeBackground;(void 0===s||s)&&(a.contentTransformations=[[{element:"span",left:function(e){var t=CKEDITOR.tools;return!("span"!=e.name||!e.styles||!e.styles.background)&&(e=t.style.parse.background(e.styles.background)).color&&1===t.object.keys(e).length},right:function(t){var n=new CKEDITOR.style(e.config.colorButton_backStyle,{color:t.styles.background}).getDefinition();return t.name=n.element,t.styles=n.styles,t.attributes=n.attributes||{},t}}]]),t("BGColor","back",r.bgColorTitle,20,a)}}}),CKEDITOR.config.colorButton_colors="1ABC9C,2ECC71,3498DB,9B59B6,4E5F70,F1C40F,16A085,27AE60,2980B9,8E44AD,2C3E50,F39C12,E67E22,E74C3C,ECF0F1,95A5A6,DDD,FFF,D35400,C0392B,BDC3C7,7F8C8D,999,000",CKEDITOR.config.colorButton_foreStyle={element:"span",styles:{color:"#(color)"},overrides:[{element:"font",attributes:{color:null}}]},CKEDITOR.config.colorButton_backStyle={element:"span",styles:{"background-color":"#(color)"}},CKEDITOR.plugins.colordialog={requires:"dialog",init:function(e){var t=new CKEDITOR.dialogCommand("colordialog");t.editorFocus=!1,e.addCommand("colordialog",t),CKEDITOR.dialog.add("colordialog",this.path+"dialogs/colordialog.js"),e.getColorFromDialog=function(t,n,o){var i,r,a,s;i=function(e){a(this),e="ok"==e.name?this.getValueOf("picker","selectedColor"):null,/^[0-9a-f]{3}([0-9a-f]{3})?$/i.test(e)&&(e="#"+e),t.call(n,e)},r=function(e){o&&(e.data=o)},a=function(e){e.removeListener("ok",i),e.removeListener("cancel",i),e.removeListener("show",r)},s=function(e){e.on("ok",i),e.on("cancel",i),e.on("show",r,null,null,5)},e.execCommand("colordialog"),e._.storedDialogs&&e._.storedDialogs.colordialog?s(e._.storedDialogs.colordialog):CKEDITOR.on("dialogDefinition",(function(e){if("colordialog"==e.data.name){var t=e.data.definition;e.removeListener(),t.onLoad=CKEDITOR.tools.override(t.onLoad,(function(e){return function(){s(this),t.onLoad=e,"function"==typeof e&&e.call(this)}}))}}))}}},CKEDITOR.plugins.add("colordialog",CKEDITOR.plugins.colordialog),function(){CKEDITOR.plugins.add("templates",{requires:"dialog",init:function(e){CKEDITOR.dialog.add("templates",CKEDITOR.getUrl(this.path+"dialogs/templates.js")),e.addCommand("templates",new CKEDITOR.dialogCommand("templates")),e.ui.addButton&&e.ui.addButton("Templates",{label:e.lang.templates.button,command:"templates",toolbar:"doctools,10"})}});var e={},t={};CKEDITOR.addTemplates=function(t,n){e[t]=n},CKEDITOR.getTemplates=function(t){return e[t]},CKEDITOR.loadTemplates=function(e,n){for(var o=[],i=0,r=e.length;i<r;i++)t[e[i]]||(o.push(e[i]),t[e[i]]=1);o.length?CKEDITOR.scriptLoader.load(o,n):setTimeout(n,0)}}(),CKEDITOR.config.templates_files=[CKEDITOR.getUrl("plugins/templates/templates/default.js")],CKEDITOR.config.templates_replaceContent=!0,CKEDITOR.plugins.add("menu",{requires:"floatpanel",beforeInit:function(e){for(var t=e.config.menu_groups.split(","),n=e._.menuGroups={},o=e._.menuItems={},i=0;i<t.length;i++)n[t[i]]=i+1;e.addMenuGroup=function(e,t){n[e]=t||100},e.addMenuItem=function(e,t){n[t.group]&&(o[e]=new CKEDITOR.menuItem(this,e,t))},e.addMenuItems=function(e){for(var t in e)this.addMenuItem(t,e[t])},e.getMenuItem=function(e){return o[e]},e.removeMenuItem=function(e){delete o[e]}}}),function(){var e='<span class="cke_menuitem"><a id="{id}" class="cke_menubutton cke_menubutton__{name} cke_menubutton_{state} {cls}" href="{href}" title="{title}" tabindex="-1" _cke_focus=1 hidefocus="true" role="{role}" aria-label="{label}" aria-describedby="{id}_description" aria-haspopup="{hasPopup}" aria-disabled="{disabled}" {ariaChecked} draggable="false"',t="";CKEDITOR.env.gecko&&CKEDITOR.env.mac&&(e+=' onkeypress="return false;"'),CKEDITOR.env.gecko&&(e+=' onblur="this.style.cssText = this.style.cssText;" ondragstart="return false;"'),CKEDITOR.env.ie&&(t='return false;" onmouseup="CKEDITOR.tools.getMouseButton(event)===CKEDITOR.MOUSE_BUTTON_LEFT&&'),e=e+' onmouseover="CKEDITOR.tools.callFunction({hoverFn},{index});" onmouseout="CKEDITOR.tools.callFunction({moveOutFn},{index});" onclick="'+t+'CKEDITOR.tools.callFunction({clickFn},{index}); return false;"><span class="cke_menubutton_inner"><span class="cke_menubutton_icon"><span class="cke_button_icon cke_button__{iconName}_icon" style="{iconStyle}"></span></span><span class="cke_menubutton_label">{label}</span>{shortcutHtml}{arrowHtml}</span></a><span id="{id}_description" class="cke_voice_label" aria-hidden="false">{ariaShortcut}</span></span>';var n=CKEDITOR.addTemplate("menuItem",e),o=CKEDITOR.addTemplate("menuArrow",'<span class="cke_menuarrow"><span>{label}</span></span>'),i=CKEDITOR.addTemplate("menuShortcut",'<span class="cke_menubutton_label cke_menubutton_shortcut">{shortcut}</span>');CKEDITOR.menu=CKEDITOR.tools.createClass({$:function(e,t){t=this._.definition=t||{},this.id=CKEDITOR.tools.getNextId(),this.editor=e,this.items=[],this._.listeners=[],this._.level=t.level||1;var n=CKEDITOR.tools.extend({},t.panel,{css:[CKEDITOR.skin.getPath("editor")],level:this._.level-1,block:{}}),o=n.block.attributes=n.attributes||{};!o.role&&(o.role="menu"),this._.panelDefinition=n},_:{onShow:function(){var e=this.editor.getSelection(),t=e&&e.getStartElement(),n=this.editor.elementPath(),o=this._.listeners;this.removeAll();for(var i=0;i<o.length;i++){var r=o[i](t,e,n);if(r)for(var a in r){var s=this.editor.getMenuItem(a);!s||s.command&&!this.editor.getCommand(s.command).state||(s.state=r[a],this.add(s))}}},onClick:function(e){this.hide(),e.onClick?e.onClick():e.command&&this.editor.execCommand(e.command)},onEscape:function(e){var t=this.parent;return t?t._.panel.hideChild(1):27==e&&this.hide(1),!1},onHide:function(){this.onHide&&this.onHide()},showSubMenu:function(e){var t=this._.subMenu,n=this.items[e];if(n=n.getItems&&n.getItems()){for(var o in t?t.removeAll():((t=this._.subMenu=new CKEDITOR.menu(this.editor,CKEDITOR.tools.extend({},this._.definition,{level:this._.level+1},!0))).parent=this,t._.onClick=CKEDITOR.tools.bind(this._.onClick,this)),n){var i=this.editor.getMenuItem(o);i&&(i.state=n[o],t.add(i))}var r=this._.panel.getBlock(this.id).element.getDocument().getById(this.id+String(e));setTimeout((function(){t.show(r,2)}),0)}else this._.panel.hideChild(1)}},proto:{add:function(e){e.order||(e.order=this.items.length),this.items.push(e)},removeAll:function(){this.items=[]},show:function(e,t,n,o){if(this.parent||(this._.onShow(),this.items.length)){t=t||("rtl"==this.editor.lang.dir?2:1);var i=this.items,r=this.editor,a=this._.panel,s=this._.element;a||((a=this._.panel=new CKEDITOR.ui.floatPanel(this.editor,CKEDITOR.document.getBody(),this._.panelDefinition,this._.level)).onEscape=CKEDITOR.tools.bind((function(e){if(!1===this._.onEscape(e))return!1}),this),a.onShow=function(){a._.panel.getHolderElement().getParent().addClass("cke").addClass("cke_reset_all")},a.onHide=CKEDITOR.tools.bind((function(){this._.onHide&&this._.onHide()}),this),(s=a.addBlock(this.id,this._.panelDefinition.block)).autoSize=!0,(l=s.keys)[40]="next",l[9]="next",l[38]="prev",l[CKEDITOR.SHIFT+9]="prev",l["rtl"==r.lang.dir?37:39]=CKEDITOR.env.ie?"mouseup":"click",l[32]=CKEDITOR.env.ie?"mouseup":"click",CKEDITOR.env.ie&&(l[13]="mouseup"),(l=(s=this._.element=s.element).getDocument()).getBody().setStyle("overflow","hidden"),l.getElementsByTag("html").getItem(0).setStyle("overflow","hidden"),this._.itemOverFn=CKEDITOR.tools.addFunction((function(e){clearTimeout(this._.showSubTimeout),this._.showSubTimeout=CKEDITOR.tools.setTimeout(this._.showSubMenu,r.config.menu_subMenuDelay||400,this,[e])}),this),this._.itemOutFn=CKEDITOR.tools.addFunction((function(){clearTimeout(this._.showSubTimeout)}),this),this._.itemClickFn=CKEDITOR.tools.addFunction((function(e){var t=this.items[e];t.state==CKEDITOR.TRISTATE_DISABLED?this.hide(1):t.getItems?this._.showSubMenu(e):this._.onClick(t)}),this)),function(e){e.sort((function(e,t){return e.group<t.group?-1:e.group>t.group?1:e.order<t.order?-1:e.order>t.order?1:0}))}(i);for(var l=['<div class="cke_menu'+((l=r.elementPath())&&l.direction()!=r.lang.dir?" cke_mixed_dir_content":"")+'" role="presentation">'],u=i.length,c=u&&i[0].group,d=0;d<u;d++){var f=i[d];c!=f.group&&(l.push('<div class="cke_menuseparator" role="separator"></div>'),c=f.group),f.render(this,d,l)}l.push("</div>"),s.setHtml(l.join("")),CKEDITOR.ui.fire("ready",this),this.parent?this.parent._.panel.showAsChild(a,this.id,e,t,n,o):a.showBlock(this.id,e,t,n,o),r.fire("menuShow",[a])}},addListener:function(e){this._.listeners.push(e)},hide:function(e){this._.onHide&&this._.onHide(),this._.panel&&this._.panel.hide(e)},findItemByCommandName:function(e){var t=CKEDITOR.tools.array.filter(this.items,(function(t){return e===t.command}));return t.length?{item:t=t[0],element:this._.element.findOne("."+t.className)}:null}}}),CKEDITOR.menuItem=CKEDITOR.tools.createClass({$:function(e,t,n){CKEDITOR.tools.extend(this,n,{order:0,className:"cke_menubutton__"+t}),this.group=e._.menuGroups[this.group],this.editor=e,this.name=t},proto:{render:function(e,t,r){var a,s,l=e.id+String(t),u=void 0===this.state?CKEDITOR.TRISTATE_OFF:this.state,c="",d=this.editor,f=u==CKEDITOR.TRISTATE_ON?"on":u==CKEDITOR.TRISTATE_DISABLED?"disabled":"off";this.role in{menuitemcheckbox:1,menuitemradio:1}&&(c=' aria-checked="'+(u==CKEDITOR.TRISTATE_ON?"true":"false")+'"');var h=this.getItems,g="&#"+("rtl"==this.editor.lang.dir?"9668":"9658")+";",m=this.name;this.icon&&!/\./.test(this.icon)&&(m=this.icon),this.command&&(a=d.getCommand(this.command),(a=d.getCommandKeystroke(a))&&(s=CKEDITOR.tools.keystrokeToString(d.lang.common.keyboard,a))),e={id:l,name:this.name,iconName:m,label:this.label,cls:this.className||"",state:f,hasPopup:h?"true":"false",disabled:u==CKEDITOR.TRISTATE_DISABLED,title:this.label+(s?" ("+s.display+")":""),ariaShortcut:s?d.lang.common.keyboardShortcut+" "+s.aria:"",href:"javascript:void('"+(this.label||"").replace("'")+"')",hoverFn:e._.itemOverFn,moveOutFn:e._.itemOutFn,clickFn:e._.itemClickFn,index:t,iconStyle:CKEDITOR.skin.getIconStyle(m,"rtl"==this.editor.lang.dir,m==this.icon?null:this.icon,this.iconOffset),shortcutHtml:s?i.output({shortcut:s.display}):"",arrowHtml:h?o.output({label:g}):"",role:this.role?this.role:"menuitem",ariaChecked:c},n.output(e,r)}}})}(),CKEDITOR.config.menu_groups="clipboard,form,tablecell,tablecellproperties,tablerow,tablecolumn,table,anchor,link,image,flash,checkbox,radio,textfield,hiddenfield,imagebutton,button,select,textarea,div",CKEDITOR.plugins.add("contextmenu",{requires:"menu",onLoad:function(){CKEDITOR.plugins.contextMenu=CKEDITOR.tools.createClass({base:CKEDITOR.menu,$:function(e){this.base.call(this,e,{panel:{css:e.config.contextmenu_contentsCss,className:"cke_menu_panel",attributes:{"aria-label":e.lang.contextmenu.options}}})},proto:{addTarget:function(e,t){function n(){i=!1}var o,i;if(e.on("contextmenu",(function(e){e=e.data;var n=CKEDITOR.env.webkit?o:CKEDITOR.env.mac?e.$.metaKey:e.$.ctrlKey;if(!(t&&n||(e.preventDefault(),i))){CKEDITOR.env.mac&&CKEDITOR.env.webkit&&(n=this.editor,(r=new CKEDITOR.dom.elementPath(e.getTarget(),n.editable()).contains((function(e){return e.hasAttribute("contenteditable")}),!0))&&"false"==r.getAttribute("contenteditable")&&n.getSelection().fake(r));var r=e.getTarget().getDocument(),a=e.getTarget().getDocument().getDocumentElement(),s=(n=!r.equals(CKEDITOR.document),r=r.getWindow().getScrollPosition(),n?e.$.clientX:e.$.pageX||r.x+e.$.clientX),l=n?e.$.clientY:e.$.pageY||r.y+e.$.clientY;CKEDITOR.tools.setTimeout((function(){this.open(a,null,s,l)}),CKEDITOR.env.ie?200:0,this)}}),this),CKEDITOR.env.webkit){var r=function(){o=0};e.on("keydown",(function(e){o=CKEDITOR.env.mac?e.data.$.metaKey:e.data.$.ctrlKey})),e.on("keyup",r),e.on("contextmenu",r)}CKEDITOR.env.gecko&&!CKEDITOR.env.mac&&(e.on("keydown",(function(e){e.data.$.shiftKey&&121===e.data.$.keyCode&&(i=!0)}),null,null,0),e.on("keyup",n),e.on("contextmenu",n))},open:function(e,t,n,o){!1!==this.editor.config.enableContextMenu&&this.editor.getSelection().getType()!==CKEDITOR.SELECTION_NONE&&(this.editor.focus(),e=e||CKEDITOR.document.getDocumentElement(),this.editor.selectionChange(1),this.show(e,t,n,o))}}})},beforeInit:function(e){var t=e.contextMenu=new CKEDITOR.plugins.contextMenu(e);e.on("contentDom",(function(){t.addTarget(e.editable(),!1!==e.config.browserContextMenuOnCtrl)})),e.addCommand("contextMenu",{exec:function(e){var t,n=0,o=0;(t=(t=(t=e.getSelection().getRanges())[t.length-1].getClientRects(e.editable().isInline()))[t.length-1])&&(n=t["rtl"===e.lang.dir?"left":"right"],o=t.bottom),e.contextMenu.open(e.document.getBody().getParent(),null,n,o)}}),e.setKeystroke(CKEDITOR.SHIFT+121,"contextMenu"),e.setKeystroke(CKEDITOR.CTRL+CKEDITOR.SHIFT+121,"contextMenu")}}),function(){function e(e,t,n,o){var i=new CKEDITOR.dom.walker(e);if(!(e=e.startContainer.getAscendant(t,!0)||e.endContainer.getAscendant(t,!0))||(n(e),!o))for(;(e=i.next())&&(!(e=e.getAscendant(t,!0))||(n(e),!o)););}function t(e,t){var n={ul:"ol",ol:"ul"};return-1!==o(t,(function(t){return t.element===e||t.element===n[e]}))}function n(e){this.styles=null,this.sticky=!1,this.editor=e,this.filter=new CKEDITOR.filter(e,e.config.copyFormatting_allowRules),!0===e.config.copyFormatting_allowRules&&(this.filter.disabled=!0),e.config.copyFormatting_disallowRules&&this.filter.disallow(e.config.copyFormatting_disallowRules)}var o=CKEDITOR.tools.indexOf,i=CKEDITOR.tools.getMouseButton,r=!1;CKEDITOR.plugins.add("copyformatting",{lang:"az,de,en,it,ja,nb,nl,oc,pl,pt-br,ru,sv,tr,zh,zh-cn",icons:"copyformatting",hidpi:!0,init:function(e){var n=CKEDITOR.plugins.copyformatting;n._addScreenReaderContainer(),r||(CKEDITOR.document.appendStyleSheet(this.path+"styles/copyformatting.css"),r=!0),e.addContentsCss&&e.addContentsCss(this.path+"styles/copyformatting.css"),e.copyFormatting=new n.state(e),e.addCommand("copyFormatting",n.commands.copyFormatting),e.addCommand("applyFormatting",n.commands.applyFormatting),e.ui.addButton("CopyFormatting",{label:e.lang.copyformatting.label,command:"copyFormatting",toolbar:"cleanup,0"}),e.on("contentDom",(function(){var t=e.getCommand("copyFormatting"),n=e.editable(),o=n.isInline()?n:e.document,r=e.ui.get("CopyFormatting");n.attachListener(o,"mouseup",(function(n){i(n)===CKEDITOR.MOUSE_BUTTON_LEFT&&t.state===CKEDITOR.TRISTATE_ON&&e.execCommand("applyFormatting")})),n.attachListener(CKEDITOR.document,"mouseup",(function(o){i(o)!==CKEDITOR.MOUSE_BUTTON_LEFT||t.state!==CKEDITOR.TRISTATE_ON||n.contains(o.data.getTarget())||e.execCommand("copyFormatting")})),r&&(o=CKEDITOR.document.getById(r._.id),n.attachListener(o,"dblclick",(function(){e.execCommand("copyFormatting",{sticky:!0})})),n.attachListener(o,"mouseup",(function(e){e.data.stopPropagation()})))})),e.config.copyFormatting_keystrokeCopy&&e.setKeystroke(e.config.copyFormatting_keystrokeCopy,"copyFormatting"),e.on("key",(function(t){var n=e.getCommand("copyFormatting");(t=t.data.domEvent).getKeystroke&&27===t.getKeystroke()&&n.state===CKEDITOR.TRISTATE_ON&&e.execCommand("copyFormatting")})),e.copyFormatting.on("extractFormatting",(function(t){var o=t.data.element;return o.contains(e.editable())||o.equals(e.editable())?t.cancel():(o=n._convertElementToStyleDef(o),e.copyFormatting.filter.check(new CKEDITOR.style(o),!0,!0)?void(t.data.styleDef=o):t.cancel())})),e.copyFormatting.on("applyFormatting",(function(i){if(!i.data.preventFormatStripping){var r,a,s=i.data.range,l=n._extractStylesFromRange(e,s),u=n._determineContext(s);if(e.copyFormatting._isContextAllowed(u))for(a=0;a<l.length;a++)u=l[a],r=s.createBookmark(),-1===o(n.preservedElements,u.element)?CKEDITOR.env.webkit&&!CKEDITOR.env.chrome?l[a].removeFromRange(i.data.range,i.editor):l[a].remove(i.editor):t(u.element,i.data.styles)&&n._removeStylesFromElementInRange(s,u.element),s.moveToBookmark(r)}})),e.copyFormatting.on("applyFormatting",(function(t){var n=CKEDITOR.plugins.copyformatting,o=n._determineContext(t.data.range);"list"===o&&e.copyFormatting._isContextAllowed("list")?n._applyStylesToListContext(t.editor,t.data.range,t.data.styles):"table"===o&&e.copyFormatting._isContextAllowed("table")?n._applyStylesToTableContext(t.editor,t.data.range,t.data.styles):e.copyFormatting._isContextAllowed("text")&&n._applyStylesToTextContext(t.editor,t.data.range,t.data.styles)}),null,null,999)}}),n.prototype._isContextAllowed=function(e){var t=this.editor.config.copyFormatting_allowedContexts;return!0===t||-1!==o(t,e)},CKEDITOR.event.implementOn(n.prototype),CKEDITOR.plugins.copyformatting={state:n,inlineBoundary:"h1 h2 h3 h4 h5 h6 p div".split(" "),excludedAttributes:["id","style","href","data-cke-saved-href","dir"],elementsForInlineTransform:["li"],excludedElementsFromInlineTransform:["table","thead","tbody","ul","ol"],excludedAttributesFromInlineTransform:["value","type"],preservedElements:"ul ol li td th tr thead tbody table".split(" "),breakOnElements:["ul","ol","table"],_initialKeystrokePasteCommand:null,commands:{copyFormatting:{exec:function(e,t){var n=CKEDITOR.plugins.copyformatting,o=e.copyFormatting,i=!!t&&"keystrokeHandler"==t.from,r=!!t&&(t.sticky||i),a=n._getCursorContainer(e),s=CKEDITOR.document.getDocumentElement();if(this.state===CKEDITOR.TRISTATE_ON)return o.styles=null,o.sticky=!1,a.removeClass("cke_copyformatting_active"),s.removeClass("cke_copyformatting_disabled"),s.removeClass("cke_copyformatting_tableresize_cursor"),n._putScreenReaderMessage(e,"canceled"),n._detachPasteKeystrokeHandler(e),this.setState(CKEDITOR.TRISTATE_OFF);o.styles=n._extractStylesFromElement(e,e.elementPath().lastElement),this.setState(CKEDITOR.TRISTATE_ON),i||(a.addClass("cke_copyformatting_active"),s.addClass("cke_copyformatting_tableresize_cursor"),e.config.copyFormatting_outerCursor&&s.addClass("cke_copyformatting_disabled")),o.sticky=r,n._putScreenReaderMessage(e,"copied"),n._attachPasteKeystrokeHandler(e)}},applyFormatting:{editorFocus:!(CKEDITOR.env.ie&&!CKEDITOR.env.edge),exec:function(e,t){var n=e.getCommand("copyFormatting"),o=!!t&&"keystrokeHandler"==t.from,i=CKEDITOR.plugins.copyformatting,r=e.copyFormatting,a=i._getCursorContainer(e),s=CKEDITOR.document.getDocumentElement();if(o&&!r.styles)return i._putScreenReaderMessage(e,"failed"),i._detachPasteKeystrokeHandler(e),!1;o=i._applyFormat(e,r.styles),r.sticky||(r.styles=null,a.removeClass("cke_copyformatting_active"),s.removeClass("cke_copyformatting_disabled"),s.removeClass("cke_copyformatting_tableresize_cursor"),n.setState(CKEDITOR.TRISTATE_OFF),i._detachPasteKeystrokeHandler(e)),i._putScreenReaderMessage(e,o?"applied":"canceled")}}},_getCursorContainer:function(e){return e.elementMode===CKEDITOR.ELEMENT_MODE_INLINE?e.editable():e.editable().getParent()},_convertElementToStyleDef:function(e){var t=CKEDITOR.tools,n=e.getAttributes(CKEDITOR.plugins.copyformatting.excludedAttributes);return t=t.parseCssText(e.getAttribute("style"),!0,!0),{element:e.getName(),type:CKEDITOR.STYLE_INLINE,attributes:n,styles:t}},_extractStylesFromElement:function(e,t){var n={},i=[];do{if(t.type===CKEDITOR.NODE_ELEMENT&&!t.hasAttribute("data-cke-bookmark")&&(n.element=t,e.copyFormatting.fire("extractFormatting",n,e)&&n.styleDef&&i.push(new CKEDITOR.style(n.styleDef)),t.getName&&-1!==o(CKEDITOR.plugins.copyformatting.breakOnElements,t.getName())))break}while((t=t.getParent())&&t.type===CKEDITOR.NODE_ELEMENT);return i},_extractStylesFromRange:function(e,t){for(var n,o=[],i=new CKEDITOR.dom.walker(t);n=i.next();)o=o.concat(CKEDITOR.plugins.copyformatting._extractStylesFromElement(e,n));return o},_removeStylesFromElementInRange:function(e,t){for(var n,i=-1!==o(["ol","ul","table"],t),r=new CKEDITOR.dom.walker(e);(n=r.next())&&(!(n=n.getAscendant(t,!0))||(n.removeAttributes(n.getAttributes()),!i)););},_getSelectedWordOffset:function(e){function t(e,t){return e[t?"getPrevious":"getNext"]((function(e){return e.type!==CKEDITOR.NODE_COMMENT}))}function n(e){return e.type==CKEDITOR.NODE_ELEMENT?(e=e.getHtml().replace(/<span.*?>&nbsp;<\/span>/g,"")).replace(/<.*?>/g,""):e.getText()}function i(e,r){var a,s,l=e,u=/\s/g,c="p br ol ul li td th div caption body".split(" "),d=!1,f=!1;do{for(a=t(l,r);!a&&l.getParent();){if(l=l.getParent(),-1!==o(c,l.getName())){f=d=!0;break}a=t(l,r)}if(a&&a.getName&&-1!==o(c,a.getName())){d=!0;break}l=a}while(l&&l.getStyle&&("none"==l.getStyle("display")||!l.getText()));for(l||(l=e);l.type!==CKEDITOR.NODE_TEXT;)l=l.getChild(!d||r||f?0:l.getChildCount()-1);for(c=n(l);null!=(f=u.exec(c))&&(s=f.index,r););if("number"!=typeof s&&!d)return i(l,r);if(d)s=r?0:(f=(u=/([\.\b]*$)/).exec(c))?f.index:c.length;else if(r&&(s+=1)>c.length)return i(l);return{node:l,offset:s}}var r,a,s,l,u,c=/\b\w+\b/gi;for(r=n(s=l=u=e.startContainer);null!=(a=c.exec(r));)if(a.index+a[0].length>=e.startOffset)return e=a.index,c=a.index+a[0].length,0===a.index&&(l=(a=i(s,!0)).node,e=a.offset),c>=r.length&&(u=(r=i(s)).node,c=r.offset),{startNode:l,startOffset:e,endNode:u,endOffset:c};return null},_filterStyles:function(e){var t,n,o=CKEDITOR.tools.isEmpty,i=[];for(n=0;n<e.length;n++)t=e[n]._.definition,-1!==CKEDITOR.tools.indexOf(CKEDITOR.plugins.copyformatting.inlineBoundary,t.element)&&(t.element=e[n].element="span"),"span"===t.element&&o(t.attributes)&&o(t.styles)||i.push(e[n]);return i},_determineContext:function(e){function t(t){var n,o=new CKEDITOR.dom.walker(e);if(e.startContainer.getAscendant(t,!0)||e.endContainer.getAscendant(t,!0))return!0;for(;n=o.next();)if(n.getAscendant(t,!0))return!0}return t({ul:1,ol:1})?"list":t("table")?"table":"text"},_applyStylesToTextContext:function(e,t,n){var i,r,a=CKEDITOR.plugins.copyformatting,s=a.excludedAttributesFromInlineTransform;for(CKEDITOR.env.webkit&&!CKEDITOR.env.chrome&&e.getSelection().selectRanges([t]),i=0;i<n.length;i++)if(-1===o(a.excludedElementsFromInlineTransform,(t=n[i]).element)){if(-1!==o(a.elementsForInlineTransform,t.element))for(t.element=t._.definition.element="span",r=0;r<s.length;r++)t._.definition.attributes[s[r]]&&delete t._.definition.attributes[s[r]];t.apply(e)}},_applyStylesToListContext:function(t,n,o){var i,r,a;for(a=0;a<o.length;a++)i=o[a],r=n.createBookmark(),"ol"===i.element||"ul"===i.element?e(n,{ul:1,ol:1},(function(e){var t=i;e.getName()!==t.element&&e.renameNode(t.element),t.applyToObject(e)}),!0):"li"===i.element?e(n,"li",(function(e){i.applyToObject(e)})):CKEDITOR.plugins.copyformatting._applyStylesToTextContext(t,n,[i]),n.moveToBookmark(r)},_applyStylesToTableContext:function(t,n,i){function r(e,t){e.getName()!==t.element&&((t=t.getDefinition()).element=e.getName(),t=new CKEDITOR.style(t)),t.applyToObject(e)}var a,s,l;for(l=0;l<i.length;l++)a=i[l],s=n.createBookmark(),-1!==o(["table","tr"],a.element)?e(n,a.element,(function(e){a.applyToObject(e)})):-1!==o(["td","th"],a.element)?e(n,{td:1,th:1},(function(e){r(e,a)})):-1!==o(["thead","tbody"],a.element)?e(n,{thead:1,tbody:1},(function(e){r(e,a)})):CKEDITOR.plugins.copyformatting._applyStylesToTextContext(t,n,[a]),n.moveToBookmark(s)},_applyFormat:function(e,t){var n,o,i=e.getSelection().getRanges()[0],r=CKEDITOR.plugins.copyformatting;if(!i)return!1;if(i.collapsed){if(o=e.getSelection().createBookmarks(),!(n=r._getSelectedWordOffset(i)))return;(i=e.createRange()).setStart(n.startNode,n.startOffset),i.setEnd(n.endNode,n.endOffset),i.select()}return t=r._filterStyles(t),!!e.copyFormatting.fire("applyFormatting",{styles:t,range:i,preventFormatStripping:!1},e)&&(o&&e.getSelection().selectBookmarks(o),!0)},_putScreenReaderMessage:function(e,t){var n=this._getScreenReaderContainer();n&&n.setText(e.lang.copyformatting.notification[t])},_addScreenReaderContainer:function(){return this._getScreenReaderContainer()?this._getScreenReaderContainer():CKEDITOR.env.ie6Compat||CKEDITOR.env.ie7Compat?void 0:CKEDITOR.document.getBody().append(CKEDITOR.dom.element.createFromHtml('<div class="cke_screen_reader_only cke_copyformatting_notification"><div aria-live="polite"></div></div>')).getChild(0)},_getScreenReaderContainer:function(){if(!CKEDITOR.env.ie6Compat&&!CKEDITOR.env.ie7Compat)return CKEDITOR.document.getBody().findOne(".cke_copyformatting_notification div[aria-live]")},_attachPasteKeystrokeHandler:function(e){var t=e.config.copyFormatting_keystrokePaste;t&&(this._initialKeystrokePasteCommand=e.keystrokeHandler.keystrokes[t],e.setKeystroke(t,"applyFormatting"))},_detachPasteKeystrokeHandler:function(e){var t=e.config.copyFormatting_keystrokePaste;t&&e.setKeystroke(t,this._initialKeystrokePasteCommand||!1)}},CKEDITOR.config.copyFormatting_outerCursor=!0,CKEDITOR.config.copyFormatting_allowRules="b s u i em strong span p div td th ol ul li(*)[*]{*}",CKEDITOR.config.copyFormatting_disallowRules="*[data-cke-widget*,data-widget*,data-cke-realelement](cke_widget*)",CKEDITOR.config.copyFormatting_allowedContexts=!0,CKEDITOR.config.copyFormatting_keystrokeCopy=CKEDITOR.CTRL+CKEDITOR.SHIFT+67,CKEDITOR.config.copyFormatting_keystrokePaste=CKEDITOR.CTRL+CKEDITOR.SHIFT+86}(),CKEDITOR.plugins.add("div",{requires:"dialog",init:function(e){if(!e.blockless){var t=e.lang.div,n="div(*)";CKEDITOR.dialog.isTabEnabled(e,"editdiv","advanced")&&(n+=";div[dir,id,lang,title]{*}"),e.addCommand("creatediv",new CKEDITOR.dialogCommand("creatediv",{allowedContent:n,requiredContent:"div",contextSensitive:!0,contentTransformations:[["div: alignmentToStyle"]],refresh:function(e,t){this.setState("div"in(e.config.div_wrapTable?t.root:t.blockLimit).getDtd()?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED)}})),e.addCommand("editdiv",new CKEDITOR.dialogCommand("editdiv",{requiredContent:"div"})),e.addCommand("removediv",{requiredContent:"div",exec:function(e){function t(t){(t=CKEDITOR.plugins.div.getSurroundDiv(e,t))&&!t.data("cke-div-added")&&(a.push(t),t.data("cke-div-added"))}for(var n,o=e.getSelection(),i=o&&o.getRanges(),r=o.createBookmarks(),a=[],s=0;s<i.length;s++)(n=i[s]).collapsed?t(o.getStartElement()):((n=new CKEDITOR.dom.walker(n)).evaluator=t,n.lastForward());for(s=0;s<a.length;s++)a[s].remove(!0);o.selectBookmarks(r)}}),e.ui.addButton&&e.ui.addButton("CreateDiv",{label:t.toolbar,command:"creatediv",toolbar:"blocks,50"}),e.addMenuItems&&(e.addMenuItems({editdiv:{label:t.edit,command:"editdiv",group:"div",order:1},removediv:{label:t.remove,command:"removediv",group:"div",order:5}}),e.contextMenu&&e.contextMenu.addListener((function(t){return!t||t.isReadOnly()?null:CKEDITOR.plugins.div.getSurroundDiv(e)?{editdiv:CKEDITOR.TRISTATE_OFF,removediv:CKEDITOR.TRISTATE_OFF}:null}))),CKEDITOR.dialog.add("creatediv",this.path+"dialogs/div.js"),CKEDITOR.dialog.add("editdiv",this.path+"dialogs/div.js")}}}),CKEDITOR.plugins.div={getSurroundDiv:function(e,t){var n=e.elementPath(t);return e.elementPath(n.blockLimit).contains((function(e){return e.is("div")&&!e.isReadOnly()}),1)}},CKEDITOR.plugins.add("resize",{init:function(e){function t(t){var n=s.width,i=s.height,l=n+(t.data.$.screenX-a.x)*("rtl"==r?-1:1);t=i+(t.data.$.screenY-a.y),u&&(n=Math.max(o.resize_minWidth,Math.min(l,o.resize_maxWidth))),c&&(i=Math.max(o.resize_minHeight,Math.min(t,o.resize_maxHeight))),e.resize(u?n:null,i)}function n(){CKEDITOR.document.removeListener("mousemove",t),CKEDITOR.document.removeListener("mouseup",n),e.document&&(e.document.removeListener("mousemove",t),e.document.removeListener("mouseup",n))}var o=e.config,i=e.ui.spaceId("resizer"),r=e.element?e.element.getDirection(1):"ltr";if(!o.resize_dir&&(o.resize_dir="vertical"),void 0===o.resize_maxWidth&&(o.resize_maxWidth=3e3),void 0===o.resize_maxHeight&&(o.resize_maxHeight=3e3),void 0===o.resize_minWidth&&(o.resize_minWidth=750),void 0===o.resize_minHeight&&(o.resize_minHeight=250),!1!==o.resize_enabled){var a,s,l=null,u=("both"==o.resize_dir||"horizontal"==o.resize_dir)&&o.resize_minWidth!=o.resize_maxWidth,c=("both"==o.resize_dir||"vertical"==o.resize_dir)&&o.resize_minHeight!=o.resize_maxHeight,d=CKEDITOR.tools.addFunction((function(i){l||(l=e.getResizable()),a={x:i.screenX,y:i.screenY},o.resize_minWidth>(s={width:l.$.offsetWidth||0,height:l.$.offsetHeight||0}).width&&(o.resize_minWidth=s.width),o.resize_minHeight>s.height&&(o.resize_minHeight=s.height),CKEDITOR.document.on("mousemove",t),CKEDITOR.document.on("mouseup",n),e.document&&(e.document.on("mousemove",t),e.document.on("mouseup",n)),i.preventDefault&&i.preventDefault()}));e.on("destroy",(function(){CKEDITOR.tools.removeFunction(d)})),e.on("uiSpace",(function(t){if("bottom"==t.data.space){var n="";u&&!c&&(n=" cke_resizer_horizontal"),!u&&c&&(n=" cke_resizer_vertical");var o='<span id="'+i+'" class="cke_resizer'+n+" cke_resizer_"+r+'" title="'+CKEDITOR.tools.htmlEncode(e.lang.common.resize)+'" onmousedown="CKEDITOR.tools.callFunction('+d+', event)">'+("ltr"==r?"◢":"◣")+"</span>";"ltr"==r&&"ltr"==n?t.data.html+=o:t.data.html=o+t.data.html}}),e,null,100),e.on("maximize",(function(t){e.ui.space("resizer")[t.data==CKEDITOR.TRISTATE_ON?"hide":"show"]()}))}}}),function(){var e={toolbarFocus:{editorFocus:!1,readOnly:1,exec:function(e){(e=CKEDITOR.document.getById(e._.elementsPath.idBase+"0"))&&e.focus(CKEDITOR.env.ie||CKEDITOR.env.air)}}},t="";CKEDITOR.env.gecko&&CKEDITOR.env.mac&&(t+=' onkeypress="return false;"'),CKEDITOR.env.gecko&&(t+=' onblur="this.style.cssText = this.style.cssText;"');var n=CKEDITOR.addTemplate("pathItem",'<a id="{id}" href="{jsTitle}" tabindex="-1" class="cke_path_item" title="{label}"'+t+' hidefocus="true"  draggable="false"  ondragstart="return false;" onkeydown="return CKEDITOR.tools.callFunction({keyDownFn},{index}, event );" onclick="CKEDITOR.tools.callFunction({clickFn},{index}); return false;" role="button" aria-label="{label}">{text}</a>');CKEDITOR.plugins.add("elementspath",{init:function(t){t._.elementsPath={idBase:"cke_elementspath_"+CKEDITOR.tools.getNextNumber()+"_",filters:[]},t.on("uiSpace",(function(o){"bottom"==o.data.space&&function(t,o){function i(e){var n;(e=l.list[e]).equals(t.editable())||"true"==e.getAttribute("contenteditable")?((n=t.createRange()).selectNodeContents(e),n=n.select()):(n=t.getSelection()).selectElement(e),CKEDITOR.env.ie&&t.fire("selectionChange",{selection:n,path:new CKEDITOR.dom.elementPath(e)}),t.focus()}function r(){a&&a.setHtml('<span class="cke_path_empty">&nbsp;</span>'),delete l.list}var a,s=t.ui.spaceId("path"),l=t._.elementsPath,u=l.idBase;o.html+='<span id="'+s+'_label" class="cke_voice_label">'+t.lang.elementspath.eleLabel+'</span><span id="'+s+'" class="cke_path" role="group" aria-labelledby="'+s+'_label"><span class="cke_path_empty">&nbsp;</span></span>',t.on("uiReady",(function(){var e=t.ui.space("path");e&&t.focusManager.add(e,1)})),l.onClick=i;var c=CKEDITOR.tools.addFunction(i),d=CKEDITOR.tools.addFunction((function(e,n){var o,r=l.idBase;switch(n=new CKEDITOR.dom.event(n),o="rtl"==t.lang.dir,n.getKeystroke()){case o?39:37:case 9:return(o=CKEDITOR.document.getById(r+(e+1)))||(o=CKEDITOR.document.getById(r+"0")),o.focus(),!1;case o?37:39:case CKEDITOR.SHIFT+9:return(o=CKEDITOR.document.getById(r+(e-1)))||(o=CKEDITOR.document.getById(r+(l.list.length-1))),o.focus(),!1;case 27:return t.focus(),!1;case 13:case 32:return i(e),!1}return!0}));t.on("selectionChange",(function(e){for(var o=[],i=l.list=[],r=[],f=l.filters,h=!0,g=e.data.path.elements,m=g.length;m--;){var p=g[m],v=0;e=p.data("cke-display-name")?p.data("cke-display-name"):p.data("cke-real-element-type")?p.data("cke-real-element-type"):p.getName(),(h=p.hasAttribute("contenteditable")?"true"==p.getAttribute("contenteditable"):h)||p.hasAttribute("contenteditable")||(v=1);for(var y=0;y<f.length;y++){var b=f[y](p,e);if(!1===b){v=1;break}e=b||e}v||(i.unshift(p),r.unshift(e))}for(i=i.length,f=0;f<i;f++)h=t.lang.elementspath.eleTitle.replace(/%1/,e=r[f]),e=n.output({id:u+f,label:h,text:e,jsTitle:"javascript:void('"+e+"')",index:f,keyDownFn:d,clickFn:c}),o.unshift(e);a||(a=CKEDITOR.document.getById(s)),(r=a).setHtml(o.join("")+'<span class="cke_path_empty">&nbsp;</span>'),t.fire("elementsPathUpdate",{space:r})})),t.on("readOnly",r),t.on("contentDomUnload",r),t.addCommand("elementsPathFocus",e.toolbarFocus),t.setKeystroke(CKEDITOR.ALT+122,"elementsPathFocus")}(t,o.data)}))}})}(),function(){function e(e,t,n){if(n=e.config.forceEnterMode||n,"wysiwyg"==e.mode){t||(t=e.activeEnterMode);var r=e.elementPath();r&&!r.isContextFor("p")&&(t=CKEDITOR.ENTER_BR,n=1),e.fire("saveSnapshot"),t==CKEDITOR.ENTER_BR?o(e,t,null,n):i(e,t,null,n),e.fire("saveSnapshot")}}function t(e){for(var t=(e=e.getSelection().getRanges(!0)).length-1;0<t;t--)e[t].deleteContents();return e[0]}CKEDITOR.plugins.add("enterkey",{init:function(t){t.addCommand("enter",{modes:{wysiwyg:1},editorFocus:!1,exec:function(t){e(t)}}),t.addCommand("shiftEnter",{modes:{wysiwyg:1},editorFocus:!1,exec:function(t){e(t,t.activeShiftEnterMode,1)}}),t.setKeystroke([[13,"enter"],[CKEDITOR.SHIFT+13,"shiftEnter"]])}});var n,o,i,r,a=CKEDITOR.dom.walker.whitespaces(),s=CKEDITOR.dom.walker.bookmark();CKEDITOR.plugins.enterkey={enterBlock:function(e,n,i,l){if(i=i||t(e)){var u,c=(i=function(e){var t=e.startContainer.getAscendant((function(e){return e.type==CKEDITOR.NODE_ELEMENT&&"true"==e.getAttribute("contenteditable")}),!0);return e.root.equals(t)?e:((t=new CKEDITOR.dom.range(t)).moveToRange(e),t)}(i)).document,d=i.checkStartOfBlock(),f=i.checkEndOfBlock(),h=e.elementPath(i.startContainer),g=h.block,m=n==CKEDITOR.ENTER_DIV?"div":"p";if(g&&d&&f){if((d=g.getParent()).is("li")&&1<d.getChildCount())return c=new CKEDITOR.dom.element("li"),u=e.createRange(),c.insertAfter(d),g.remove(),u.setStart(c,0),void e.getSelection().selectRanges([u]);if(g.is("li")||g.getParent().is("li")){g.is("li")||(d=(g=g.getParent()).getParent()),u=d.getParent(),i=!g.hasPrevious();var p=!g.hasNext(),v=(m=(l=e.getSelection()).createBookmarks(),g.getDirection(1)),y=(f=g.getAttribute("class"),g.getAttribute("style")),b=u.getDirection(1)!=v;if(e=e.enterMode!=CKEDITOR.ENTER_BR||b||y||f,u.is("li"))i||p?(i&&p&&d.remove(),g[p?"insertAfter":"insertBefore"](u)):g.breakParent(u);else{if(e)h.block.is("li")?(u=c.createElement(n==CKEDITOR.ENTER_P?"p":"div"),b&&u.setAttribute("dir",v),y&&u.setAttribute("style",y),f&&u.setAttribute("class",f),g.moveChildren(u)):u=h.block,i||p?u[i?"insertBefore":"insertAfter"](d):(g.breakParent(d),u.insertAfter(d));else if(g.appendBogus(!0),i||p)for(;c=g[i?"getFirst":"getLast"]();)c[i?"insertBefore":"insertAfter"](d);else for(g.breakParent(d);c=g.getLast();)c.insertAfter(d);g.remove()}return void l.selectBookmarks(m)}if(g&&g.getParent().is("blockquote"))return g.breakParent(g.getParent()),g.getPrevious().getFirst(CKEDITOR.dom.walker.invisible(1))||g.getPrevious().remove(),g.getNext().getFirst(CKEDITOR.dom.walker.invisible(1))||g.getNext().remove(),i.moveToElementEditStart(g),void i.select()}else if(g&&g.is("pre")&&!f)return void o(e,n,i,l);if(y=i.splitBlock(m)){if(e=y.previousBlock,d=y.wasStartOfBlock,f=y.wasEndOfBlock,(g=y.nextBlock)?(p=g.getParent()).is("li")&&(g.breakParent(p),g.move(g.getNext(),1)):e&&(p=e.getParent())&&p.is("li")&&(e.breakParent(p),p=e.getNext(),i.moveToElementEditStart(p),e.move(e.getPrevious())),d||f)if(function(e){var t;return e!==CKEDITOR.ENTER_BR&&-1!==CKEDITOR.tools.indexOf(["td","th"],h.lastElement.getName())&&1===h.lastElement.getChildCount()&&((t=(e=h.lastElement.getChild(0).clone(!0)).getBogus())&&t.remove(),!e.getText().length)}(n))i.moveToElementEditStart(i.getTouchedStartNode());else{if(e?(e.is("li")||!r.test(e.getName())&&!e.is("pre"))&&(u=e.clone()):g&&(u=g.clone()),u?l&&!u.is("li")&&u.renameNode(m):p&&p.is("li")?u=p:(u=c.createElement(m),e&&(v=e.getDirection())&&u.setAttribute("dir",v)),c=y.elementPath)for(n=0,l=c.elements.length;n<l&&!(m=c.elements[n]).equals(c.block)&&!m.equals(c.blockLimit);n++)CKEDITOR.dtd.$removeEmpty[m.getName()]&&(m=m.clone(),u.moveChildren(m),u.append(m));u.appendBogus(),u.getParent()||i.insertNode(u),u.is("li")&&u.removeAttribute("value"),!CKEDITOR.env.ie||!d||f&&e.getChildCount()||(i.moveToElementEditStart(f?e:u),i.select()),i.moveToElementEditStart(d&&!f?g:u)}else g.is("li")&&((u=i.clone()).selectNodeContents(g),(u=new CKEDITOR.dom.walker(u)).evaluator=function(e){return!(s(e)||a(e)||e.type==CKEDITOR.NODE_ELEMENT&&e.getName()in CKEDITOR.dtd.$inline&&!(e.getName()in CKEDITOR.dtd.$empty))},(p=u.next())&&p.type==CKEDITOR.NODE_ELEMENT&&p.is("ul","ol")&&(CKEDITOR.env.needsBrFiller?c.createElement("br"):c.createText(" ")).insertBefore(p)),g&&i.moveToElementEditStart(g);i.select(),i.scrollIntoView()}}},enterBr:function(e,n,o,a){if(o=o||t(e)){var s=o.document,l=o.checkEndOfBlock(),u=new CKEDITOR.dom.elementPath(e.getSelection().getStartElement()),c=u.block,d=c&&u.block.getName();a||"li"!=d?(!a&&l&&r.test(d)?(l=c.getDirection())?((s=s.createElement("div")).setAttribute("dir",l),s.insertAfter(c),o.setStart(s,0)):(s.createElement("br").insertAfter(c),CKEDITOR.env.gecko&&s.createText("").insertAfter(c),o.setStartAt(c.getNext(),CKEDITOR.env.ie?CKEDITOR.POSITION_BEFORE_START:CKEDITOR.POSITION_AFTER_START)):(e="pre"==d&&CKEDITOR.env.ie&&8>CKEDITOR.env.version?s.createText("\r"):s.createElement("br"),o.deleteContents(),o.insertNode(e),CKEDITOR.env.needsBrFiller?(s.createText("\ufeff").insertAfter(e),l&&(c||u.blockLimit).appendBogus(),e.getNext().$.nodeValue="",o.setStartAt(e.getNext(),CKEDITOR.POSITION_AFTER_START)):o.setStartAt(e,CKEDITOR.POSITION_AFTER_END)),o.collapse(!0),o.select(),o.scrollIntoView()):i(e,n,o,a)}}},n=CKEDITOR.plugins.enterkey,o=n.enterBr,i=n.enterBlock,r=/^h[1-6]$/}(),function(){function e(e,t){var n={},o=[],i={nbsp:" ",shy:"­",gt:">",lt:"<",amp:"&",apos:"'",quot:'"'};if(e=(e=e.replace(/\b(nbsp|shy|gt|lt|amp|apos|quot)(?:,|$)/g,(function(e,r){var a=t?"&"+r+";":i[r];return n[a]=t?i[r]:"&"+r+";",o.push(a),""}))).replace(/,$/,""),!t&&e){e=e.split(",");var r,a=document.createElement("div");for(a.innerHTML="&"+e.join(";&")+";",r=a.innerHTML,a=null,a=0;a<r.length;a++){var s=r.charAt(a);n[s]="&"+e[a]+";",o.push(s)}}return n.regex=o.join(t?"|":""),n}CKEDITOR.plugins.add("entities",{afterInit:function(t){function n(e){return l[e]}function o(e){return"force"!=i.entities_processNumerical&&a[e]?a[e]:"&#"+e.charCodeAt(0)+";"}var i=t.config;if(t=(t=t.dataProcessor)&&t.htmlFilter){var r=[];!1!==i.basicEntities&&r.push("nbsp,gt,lt,amp"),i.entities&&(r.length&&r.push("quot,iexcl,cent,pound,curren,yen,brvbar,sect,uml,copy,ordf,laquo,not,shy,reg,macr,deg,plusmn,sup2,sup3,acute,micro,para,middot,cedil,sup1,ordm,raquo,frac14,frac12,frac34,iquest,times,divide,fnof,bull,hellip,prime,Prime,oline,frasl,weierp,image,real,trade,alefsym,larr,uarr,rarr,darr,harr,crarr,lArr,uArr,rArr,dArr,hArr,forall,part,exist,empty,nabla,isin,notin,ni,prod,sum,minus,lowast,radic,prop,infin,ang,and,or,cap,cup,int,there4,sim,cong,asymp,ne,equiv,le,ge,sub,sup,nsub,sube,supe,oplus,otimes,perp,sdot,lceil,rceil,lfloor,rfloor,lang,rang,loz,spades,clubs,hearts,diams,circ,tilde,ensp,emsp,thinsp,zwnj,zwj,lrm,rlm,ndash,mdash,lsquo,rsquo,sbquo,ldquo,rdquo,bdquo,dagger,Dagger,permil,lsaquo,rsaquo,euro"),i.entities_latin&&r.push("Agrave,Aacute,Acirc,Atilde,Auml,Aring,AElig,Ccedil,Egrave,Eacute,Ecirc,Euml,Igrave,Iacute,Icirc,Iuml,ETH,Ntilde,Ograve,Oacute,Ocirc,Otilde,Ouml,Oslash,Ugrave,Uacute,Ucirc,Uuml,Yacute,THORN,szlig,agrave,aacute,acirc,atilde,auml,aring,aelig,ccedil,egrave,eacute,ecirc,euml,igrave,iacute,icirc,iuml,eth,ntilde,ograve,oacute,ocirc,otilde,ouml,oslash,ugrave,uacute,ucirc,uuml,yacute,thorn,yuml,OElig,oelig,Scaron,scaron,Yuml"),i.entities_greek&&r.push("Alpha,Beta,Gamma,Delta,Epsilon,Zeta,Eta,Theta,Iota,Kappa,Lambda,Mu,Nu,Xi,Omicron,Pi,Rho,Sigma,Tau,Upsilon,Phi,Chi,Psi,Omega,alpha,beta,gamma,delta,epsilon,zeta,eta,theta,iota,kappa,lambda,mu,nu,xi,omicron,pi,rho,sigmaf,sigma,tau,upsilon,phi,chi,psi,omega,thetasym,upsih,piv"),i.entities_additional&&r.push(i.entities_additional));var a=e(r.join(",")),s=a.regex?"["+a.regex+"]":"a^";delete a.regex,i.entities&&i.entities_processNumerical&&(s="[^ -~]|"+s),s=new RegExp(s,"g");var l=e("nbsp,gt,lt,amp,shy",!0),u=new RegExp(l.regex,"g");t.addRules({text:function(e){return e.replace(u,n).replace(s,o)}},{applyToAll:!0,excludeNestedEditable:!0})}}})}(),CKEDITOR.config.basicEntities=!0,CKEDITOR.config.entities=!0,CKEDITOR.config.entities_latin=!0,CKEDITOR.config.entities_greek=!0,CKEDITOR.config.entities_additional="#39",CKEDITOR.plugins.add("popup"),CKEDITOR.tools.extend(CKEDITOR.editor.prototype,{popup:function(e,t,n,i){n=n||"70%","string"==typeof(t=t||"80%")&&1<t.length&&"%"==t.substr(t.length-1,1)&&(t=parseInt(window.screen.width*parseInt(t,10)/100,10)),"string"==typeof n&&1<n.length&&"%"==n.substr(n.length-1,1)&&(n=parseInt(window.screen.height*parseInt(n,10)/100,10)),640>t&&(t=640),420>n&&(n=420);var r=parseInt((window.screen.height-n)/2,10),a=parseInt((window.screen.width-t)/2,10);i=(i||"location=no,menubar=no,toolbar=no,dependent=yes,minimizable=no,modal=yes,alwaysRaised=yes,resizable=yes,scrollbars=yes")+",width="+t+",height="+n+",top="+r+",left="+a;var s=window.open("",null,i,!0);if(!s)return!1;try{-1==navigator.userAgent.toLowerCase().indexOf(" chrome/")&&(s.moveTo(a,r),s.resizeTo(t,n)),s.focus(),s.location.href=e}catch(o){window.open(e,null,i,!0)}return!0}}),function(){function e(e){this.editor=e,this.loaders=[]}function t(e,t,o){var i=e.config.fileTools_defaultFileName;this.editor=e,this.lang=e.lang,"string"==typeof t?(this.data=t,this.file=function(e){var t=e.match(n)[1];e=e.replace(n,""),e=atob(e);var o,i,r,a,s=[];for(o=0;o<e.length;o+=512){for(i=e.slice(o,o+512),r=Array(i.length),a=0;a<i.length;a++)r[a]=i.charCodeAt(a);i=new Uint8Array(r),s.push(i)}return new Blob(s,{type:t})}(this.data),this.loaded=this.total=this.file.size):(this.data=null,this.file=t,this.total=this.file.size,this.loaded=0),o?this.fileName=o:this.file.name?this.fileName=this.file.name:(e=this.file.type.split("/"),i&&(e[0]=i),this.fileName=e.join(".")),this.uploaded=0,this.responseData=this.uploadTotal=null,this.status="created",this.abort=function(){this.changeStatus("abort")}}CKEDITOR.plugins.add("filetools",{beforeInit:function(t){t.uploadRepository=new e(t),t.on("fileUploadRequest",(function(e){var t=e.data.fileLoader;t.xhr.open("POST",t.uploadUrl,!0),e.data.requestData.upload={file:t.file,name:t.fileName}}),null,null,5),t.on("fileUploadRequest",(function(e){var n=e.data.fileLoader,o=new FormData;e=e.data.requestData;var i,r,a=t.config.fileTools_requestHeaders;for(r in e){var s=e[r];"object"==typeof s&&s.file?o.append(r,s.file,s.name):o.append(r,s)}if(o.append("ckCsrfToken",CKEDITOR.tools.getCsrfToken()),a)for(i in a)n.xhr.setRequestHeader(i,a[i]);n.xhr.send(o)}),null,null,999),t.on("fileUploadResponse",(function(e){var t=e.data.fileLoader,n=t.xhr,i=e.data;try{var r=JSON.parse(n.responseText);if(r.error&&r.error.message&&(i.message=r.error.message),r.uploaded)for(var a in r)i[a]=r[a];else e.cancel()}catch(o){i.message=t.lang.filetools.responseError,CKEDITOR.warn("filetools-response-error",{responseText:n.responseText}),e.cancel()}}),null,null,999)}}),e.prototype={create:function(e,n,o){var i=this.loaders.length;return(e=new(o=o||t)(this.editor,e,n)).id=i,this.loaders[i]=e,this.fire("instanceCreated",e),e},isFinished:function(){for(var e=0;e<this.loaders.length;++e)if(!this.loaders[e].isFinished())return!1;return!0}},t.prototype={loadAndUpload:function(e,t){var n=this;this.once("loaded",(function(o){o.cancel(),n.once("update",(function(e){e.cancel()}),null,null,0),n.upload(e,t)}),null,null,0),this.load()},load:function(){var e=this,t=this.reader=new FileReader;e.changeStatus("loading"),this.abort=function(){e.reader.abort()},t.onabort=function(){e.changeStatus("abort")},t.onerror=function(){e.message=e.lang.filetools.loadError,e.changeStatus("error")},t.onprogress=function(t){e.loaded=t.loaded,e.update()},t.onload=function(){e.loaded=e.total,e.data=t.result,e.changeStatus("loaded")},t.readAsDataURL(this.file)},upload:function(e,t){var n=t||{};e?(this.uploadUrl=e,this.xhr=new XMLHttpRequest,this.attachRequestListeners(),this.editor.fire("fileUploadRequest",{fileLoader:this,requestData:n})&&this.changeStatus("uploading")):(this.message=this.lang.filetools.noUrlError,this.changeStatus("error"))},attachRequestListeners:function(){function e(){"error"!=n.status&&(n.message=n.lang.filetools.networkError,n.changeStatus("error"))}function t(){"abort"!=n.status&&n.changeStatus("abort")}var n=this,o=this.xhr;n.abort=function(){o.abort(),t()},o.onerror=e,o.onabort=t,o.upload?(o.upload.onprogress=function(e){e.lengthComputable&&(n.uploadTotal||(n.uploadTotal=e.total),n.uploaded=e.loaded,n.update())},o.upload.onerror=e,o.upload.onabort=t):(n.uploadTotal=n.total,n.update()),o.onload=function(){if(n.update(),"abort"!=n.status)if(n.uploaded=n.uploadTotal,200>o.status||299<o.status)n.message=n.lang.filetools["httpError"+o.status],n.message||(n.message=n.lang.filetools.httpError.replace("%1",o.status)),n.changeStatus("error");else{for(var e={fileLoader:n},t=["message","fileName","url"],i=n.editor.fire("fileUploadResponse",e),r=0;r<t.length;r++){var a=t[r];"string"==typeof e[a]&&(n[a]=e[a])}n.responseData=e,delete n.responseData.fileLoader,n.changeStatus(!1===i?"error":"uploaded")}}},changeStatus:function(e){this.status=e,"error"!=e&&"abort"!=e&&"loaded"!=e&&"uploaded"!=e||(this.abort=function(){}),this.fire(e),this.update()},update:function(){this.fire("update")},isFinished:function(){return!!this.status.match(/^(?:loaded|uploaded|error|abort)$/)}},CKEDITOR.event.implementOn(e.prototype),CKEDITOR.event.implementOn(t.prototype);var n=/^data:(\S*?);base64,/;CKEDITOR.fileTools||(CKEDITOR.fileTools={}),CKEDITOR.tools.extend(CKEDITOR.fileTools,{uploadRepository:e,fileLoader:t,getUploadUrl:function(e,t){var n=CKEDITOR.tools.capitalize;return t&&e[t+"UploadUrl"]?e[t+"UploadUrl"]:e.uploadUrl?e.uploadUrl:t&&e["filebrowser"+n(t,1)+"UploadUrl"]?e["filebrowser"+n(t,1)+"UploadUrl"]+"&responseType=json":e.filebrowserUploadUrl?e.filebrowserUploadUrl+"&responseType=json":null},isTypeSupported:function(e,t){return!!e.type.match(t)},isFileUploadSupported:"function"==typeof FileReader&&"function"==typeof(new FileReader).readAsDataURL&&"function"==typeof FormData&&"function"==typeof(new FormData).append&&"function"==typeof XMLHttpRequest&&"function"==typeof Blob})}(),function(){function e(e,t){var n=[];if(!t)return e;for(var o in t)n.push(o+"="+encodeURIComponent(t[o]));return e+(-1!=e.indexOf("?")?"&":"?")+n.join("&")}function t(t){return!t.match(/command=QuickUpload/)||t.match(/(\?|&)responseType=json/)?t:e(t,{responseType:"json"})}function n(e){return(e+="").charAt(0).toUpperCase()+e.substr(1)}function o(){var t=(i=this.getDialog()).getParentEditor();t._.filebrowserSe=this;var o=t.config["filebrowser"+n(i.getName())+"WindowWidth"]||t.config.filebrowserWindowWidth||"80%",i=t.config["filebrowser"+n(i.getName())+"WindowHeight"]||t.config.filebrowserWindowHeight||"70%",r=this.filebrowser.params||{};r.CKEditor=t.name,r.CKEditorFuncNum=t._.filebrowserFn,r.langCode||(r.langCode=t.langCode),r=e(this.filebrowser.url,r),t.popup(r,o,i,t.config.filebrowserWindowFeatures||t.config.fileBrowserWindowFeatures)}function i(e){var t=new CKEDITOR.dom.element(e.$.form);t&&((e=t.$.elements.ckCsrfToken)?e=new CKEDITOR.dom.element(e):((e=new CKEDITOR.dom.element("input")).setAttributes({name:"ckCsrfToken",type:"hidden"}),t.append(e)),e.setAttribute("value",CKEDITOR.tools.getCsrfToken()))}function r(){var e=this.getDialog();return e.getParentEditor()._.filebrowserSe=this,!(!e.getContentElement(this.for[0],this.for[1]).getInputElement().$.value||!e.getContentElement(this.for[0],this.for[1]).getAction())}function a(t,n,o){var i=o.params||{};i.CKEditor=t.name,i.CKEditorFuncNum=t._.filebrowserFn,i.langCode||(i.langCode=t.langCode),n.action=e(o.url,i),n.filebrowser=o}function s(e,u,d,f){if(f&&f.length)for(var h,g=f.length;g--;)if("hbox"!=(h=f[g]).type&&"vbox"!=h.type&&"fieldset"!=h.type||s(e,u,d,h.children),h.filebrowser)if("string"==typeof h.filebrowser&&(h.filebrowser={action:"fileButton"==h.type?"QuickUpload":"Browse",target:h.filebrowser}),"Browse"==h.filebrowser.action){var m=h.filebrowser.url;void 0===m&&void 0===(m=e.config["filebrowser"+n(u)+"BrowseUrl"])&&(m=e.config.filebrowserBrowseUrl),m&&(h.onClick=o,h.filebrowser.url=m,h.hidden=!1)}else if("QuickUpload"==h.filebrowser.action&&h.for&&(void 0===(m=h.filebrowser.url)&&void 0===(m=e.config["filebrowser"+n(u)+"UploadUrl"])&&(m=e.config.filebrowserUploadUrl),m)){var p=h.onClick;h.onClick=function(n){var o=n.sender,a=o.getDialog().getContentElement(this.for[0],this.for[1]).getInputElement(),s=CKEDITOR.fileTools&&CKEDITOR.fileTools.isFileUploadSupported;return(!p||!1!==p.call(o,n))&&!!r.call(o,n)&&("form"!==e.config.filebrowserUploadMethod&&s?((n=e.uploadRepository.create(a.$.files[0])).on("uploaded",(function(e){var t=e.sender.responseData;c.call(e.sender.editor,t.url,t.message)})),n.on("error",l.bind(this)),n.on("abort",l.bind(this)),n.loadAndUpload(t(m)),"xhr"):(i(a),!0))},h.filebrowser.url=m,h.hidden=!1,a(e,d.getContents(h.for[0]).get(h.for[1]),h.filebrowser)}}function l(e){var t={};try{t=JSON.parse(e.sender.xhr.response)||{}}catch(n){}this.enable(),alert(t.error?t.error.message:e.sender.message)}function u(e,t,n){if(-1!==n.indexOf(";")){n=n.split(";");for(var o=0;o<n.length;o++)if(u(e,t,n[o]))return!0;return!1}return(e=e.getContents(t).get(n).filebrowser)&&e.url}function c(e,t){var n=this._.filebrowserSe.getDialog(),o=this._.filebrowserSe.for,i=this._.filebrowserSe.filebrowser.onSelect;o&&n.getContentElement(o[0],o[1]).reset(),"function"==typeof t&&!1===t.call(this._.filebrowserSe)||i&&!1===i.call(this._.filebrowserSe,e,t)||("string"==typeof t&&t&&alert(t),e&&(n=(o=this._.filebrowserSe).getDialog(),o=o.filebrowser.target||null)&&(o=o.split(":"),(i=n.getContentElement(o[0],o[1]))&&(i.setValue(e),n.selectPage(o[0]))))}CKEDITOR.plugins.add("filebrowser",{requires:"popup,filetools",init:function(e){e._.filebrowserFn=CKEDITOR.tools.addFunction(c,e),e.on("destroy",(function(){CKEDITOR.tools.removeFunction(this._.filebrowserFn)}))}}),CKEDITOR.on("dialogDefinition",(function(e){if(e.editor.plugins.filebrowser)for(var t,n=e.data.definition,o=0;o<n.contents.length;++o)(t=n.contents[o])&&(s(e.editor,e.data.name,n,t.elements),t.hidden&&t.filebrowser&&(t.hidden=!u(n,t.id,t.filebrowser)))}))}(),CKEDITOR.plugins.add("find",{requires:"dialog",init:function(e){var t=e.addCommand("find",new CKEDITOR.dialogCommand("find")),n=e.addCommand("replace",new CKEDITOR.dialogCommand("find",{tabId:"replace"}));t.canUndo=!1,t.readOnly=1,n.canUndo=!1,e.ui.addButton&&(e.ui.addButton("Find",{label:e.lang.find.find,command:"find",toolbar:"find,10"}),e.ui.addButton("Replace",{label:e.lang.find.replace,command:"replace",toolbar:"find,20"})),CKEDITOR.dialog.add("find",this.path+"dialogs/find.js")}}),CKEDITOR.config.find_highlight={element:"span",styles:{"background-color":"#004",color:"#fff"}},function(){function e(e,t){var n=o.exec(e),i=o.exec(t);if(n){if(!n[2]&&"px"==i[2])return i[1];if("px"==n[2]&&!i[2])return i[1]+"px"}return t}var t=CKEDITOR.htmlParser.cssStyle,n=CKEDITOR.tools.cssLength,o=/^((?:\d*(?:\.\d+))|(?:\d+))(.*)?$/i,i={elements:{$:function(n){var o=n.attributes;if((o=(o=(o=o&&o["data-cke-realelement"])&&new CKEDITOR.htmlParser.fragment.fromHtml(decodeURIComponent(o)))&&o.children[0])&&n.attributes["data-cke-resizable"]){var i=new t(n).rules;n=o.attributes;var r=i.width;i=i.height,r&&(n.width=e(n.width,r)),i&&(n.height=e(n.height,i))}return o}}};CKEDITOR.plugins.add("fakeobjects",{init:function(e){e.filter.allow("img[!data-cke-realelement,src,alt,title](*){*}","fakeobjects")},afterInit:function(e){(e=(e=e.dataProcessor)&&e.htmlFilter)&&e.addRules(i,{applyToAll:!0})}}),CKEDITOR.editor.prototype.createFakeElement=function(e,o,i,r){var a=(a=this.lang.fakeobjects)[i]||a.unknown;return o={class:o,"data-cke-realelement":encodeURIComponent(e.getOuterHtml()),"data-cke-real-node-type":e.type,alt:a,title:a,align:e.getAttribute("align")||""},CKEDITOR.env.hc||(o.src=CKEDITOR.tools.transparentImageData),i&&(o["data-cke-real-element-type"]=i),r&&(o["data-cke-resizable"]=r,i=new t,r=e.getAttribute("width"),e=e.getAttribute("height"),r&&(i.rules.width=n(r)),e&&(i.rules.height=n(e)),i.populate(o)),this.document.createElement("img",{attributes:o})},CKEDITOR.editor.prototype.createFakeParserElement=function(e,o,i,r){var a,s=(s=this.lang.fakeobjects)[i]||s.unknown;return a=new CKEDITOR.htmlParser.basicWriter,e.writeHtml(a),a=a.getHtml(),o={class:o,"data-cke-realelement":encodeURIComponent(a),"data-cke-real-node-type":e.type,alt:s,title:s,align:e.attributes.align||""},CKEDITOR.env.hc||(o.src=CKEDITOR.tools.transparentImageData),i&&(o["data-cke-real-element-type"]=i),r&&(o["data-cke-resizable"]=r,r=e.attributes,e=new t,i=r.width,r=r.height,void 0!==i&&(e.rules.width=n(i)),void 0!==r&&(e.rules.height=n(r)),e.populate(o)),new CKEDITOR.htmlParser.element("img",o)},CKEDITOR.editor.prototype.restoreRealElement=function(t){if(t.data("cke-real-node-type")!=CKEDITOR.NODE_ELEMENT)return null;var n=CKEDITOR.dom.element.createFromHtml(decodeURIComponent(t.data("cke-realelement")),this.document);if(t.data("cke-resizable")){var o=t.getStyle("width");t=t.getStyle("height"),o&&n.setAttribute("width",e(n.getAttribute("width"),o)),t&&n.setAttribute("height",e(n.getAttribute("height"),t))}return n}}(),function(){function e(e){return"application/x-shockwave-flash"==(e=e.attributes).type||n.test(e.src||"")}function t(e,t){return e.createFakeParserElement(t,"cke_flash","flash",!0)}var n=/\.swf(?:$|\?)/i;CKEDITOR.plugins.add("flash",{requires:"dialog,fakeobjects",onLoad:function(){CKEDITOR.addCss("img.cke_flash{background-image: url("+CKEDITOR.getUrl(this.path+"images/placeholder.png")+");background-position: center center;background-repeat: no-repeat;border: 1px solid #a9a9a9;width: 80px;height: 80px;}")},init:function(e){var t="object[classid,codebase,height,hspace,vspace,width];param[name,value];embed[height,hspace,pluginspage,src,type,vspace,width]";CKEDITOR.dialog.isTabEnabled(e,"flash","properties")&&(t+=";object[align]; embed[allowscriptaccess,quality,scale,wmode]"),CKEDITOR.dialog.isTabEnabled(e,"flash","advanced")&&(t+=";object[id]{*}; embed[bgcolor]{*}(*)"),e.addCommand("flash",new CKEDITOR.dialogCommand("flash",{allowedContent:t,requiredContent:"embed"})),e.ui.addButton&&e.ui.addButton("Flash",{label:e.lang.common.flash,command:"flash",toolbar:"insert,20"}),CKEDITOR.dialog.add("flash",this.path+"dialogs/flash.js"),e.addMenuItems&&e.addMenuItems({flash:{label:e.lang.flash.properties,command:"flash",group:"flash"}}),e.on("doubleclick",(function(e){var t=e.data.element;t.is("img")&&"flash"==t.data("cke-real-element-type")&&(e.data.dialog="flash")})),e.contextMenu&&e.contextMenu.addListener((function(e){if(e&&e.is("img")&&!e.isReadOnly()&&"flash"==e.data("cke-real-element-type"))return{flash:CKEDITOR.TRISTATE_OFF}}))},afterInit:function(n){var o=n.dataProcessor;(o=o&&o.dataFilter)&&o.addRules({elements:{"cke:object":function(o){var i=o.attributes;if(!(i.classid&&String(i.classid).toLowerCase()||e(o))){for(i=0;i<o.children.length;i++)if("cke:embed"==o.children[i].name){if(!e(o.children[i]))break;return t(n,o)}return null}return t(n,o)},"cke:embed":function(o){return e(o)?t(n,o):null}}},5)}})}(),CKEDITOR.tools.extend(CKEDITOR.config,{flashEmbedTagOnly:!1,flashAddEmbedTag:!0,flashConvertOnEdit:!1}),function(){var e=CKEDITOR.document.getWindow(),t=CKEDITOR.tools.cssLength;CKEDITOR.plugins.add("floatingspace",{init:function(n){n.on("loaded",(function(){!function(n){var o=n.config,i=n.fire("uiSpace",{space:"top",html:""}).html,r=function(){function i(e,n,o){s.setStyle(n,t(o)),s.setStyle("position",e)}function a(e){var t=u.getDocumentPosition();switch(e){case"top":i("absolute","top",t.y-h-p);break;case"pin":i("fixed","top",y);break;case"bottom":i("absolute","top",t.y+(d.height||d.bottom-d.top)+p)}l=e}var l,u,c,d,f,h,g,m=o.floatSpaceDockedOffsetX||0,p=o.floatSpaceDockedOffsetY||0,v=o.floatSpacePinnedOffsetX||0,y=o.floatSpacePinnedOffsetY||0;return function(i){if(u=n.editable()){var y=i&&"focus"==i.name;y&&s.show(),n.fire("floatingSpaceLayout",{show:y}),s.removeStyle("left"),s.removeStyle("right"),c=s.getClientRect(),d=u.getClientRect(),f=e.getViewPaneSize(),h=c.height,g="pageXOffset"in e.$?e.$.pageXOffset:CKEDITOR.document.$.documentElement.scrollLeft,l?(a(h+p<=d.top?"top":h+p>f.height-d.bottom?"pin":"bottom"),i=f.width/2,i=o.floatSpacePreferRight?"right":0<d.left&&d.right<f.width&&d.width>c.width?"rtl"==o.contentsLangDirection?"right":"left":i-d.left>d.right-i?"left":"right",c.width>f.width?(i="left",y=0):(y="left"==i?0<d.left?d.left:0:d.right<f.width?f.width-d.right:0)+c.width>f.width&&(i="left"==i?"right":"left",y=0),s.setStyle(i,t(("pin"==l?v:m)+y+("pin"==l?0:"left"==i?g:-g)))):(l="pin",a("pin"),r(i))}}}();if(i){var a=new CKEDITOR.template('<div id="cke_{name}" class="cke {id} cke_reset_all cke_chrome cke_editor_{name} cke_float cke_{langDir} '+CKEDITOR.env.cssClass+'" dir="{langDir}" title="'+(CKEDITOR.env.gecko?" ":"")+'" lang="{langCode}" role="application" style="{style}"'+(n.title?' aria-labelledby="cke_{name}_arialbl"':" ")+">"+(n.title?'<span id="cke_{name}_arialbl" class="cke_voice_label">{voiceLabel}</span>':" ")+'<div class="cke_inner"><div id="{topId}" class="cke_top" role="presentation">{content}</div></div></div>'),s=CKEDITOR.document.getBody().append(CKEDITOR.dom.element.createFromHtml(a.output({content:i,id:n.id,langDir:n.lang.dir,langCode:n.langCode,name:n.name,style:"display:none;z-index:"+(o.baseFloatZIndex-1),topId:n.ui.spaceId("top"),voiceLabel:n.title}))),l=CKEDITOR.tools.eventsBuffer(500,r),u=CKEDITOR.tools.eventsBuffer(100,r);s.unselectable(),s.on("mousedown",(function(e){(e=e.data).getTarget().hasAscendant("a",1)||e.preventDefault()})),n.on("focus",(function(t){r(t),n.on("change",l.input),e.on("scroll",u.input),e.on("resize",u.input)})),n.on("blur",(function(){s.hide(),n.removeListener("change",l.input),e.removeListener("scroll",u.input),e.removeListener("resize",u.input)})),n.on("destroy",(function(){e.removeListener("scroll",u.input),e.removeListener("resize",u.input),s.clearCustomData(),s.remove()})),n.focusManager.hasFocus&&s.show(),n.focusManager.add(s,1)}}(this)}),null,null,20)}})}(),CKEDITOR.plugins.add("listblock",{requires:"panel",onLoad:function(){var e=CKEDITOR.addTemplate("panel-list",'<ul role="presentation" class="cke_panel_list">{items}</ul>'),t=CKEDITOR.addTemplate("panel-list-item",'<li id="{id}" class="cke_panel_listItem" role=presentation><a id="{id}_option" _cke_focus=1 hidefocus=true title="{title}" draggable="false" ondragstart="return false;" href="javascript:void(\'{val}\')"  onclick="{onclick}CKEDITOR.tools.callFunction({clickFn},\'{val}\'); return false;" role="option">{text}</a></li>'),n=CKEDITOR.addTemplate("panel-list-group",'<h1 id="{id}" draggable="false" ondragstart="return false;" class="cke_panel_grouptitle" role="presentation" >{label}</h1>'),o=/\'/g;CKEDITOR.ui.panel.prototype.addListBlock=function(e,t){return this.addBlock(e,new CKEDITOR.ui.listBlock(this.getHolderElement(),t))},CKEDITOR.ui.listBlock=CKEDITOR.tools.createClass({base:CKEDITOR.ui.panel.block,$:function(e,t){var n=(t=t||{}).attributes||(t.attributes={});(this.multiSelect=!!t.multiSelect)&&(n["aria-multiselectable"]=!0),!n.role&&(n.role="listbox"),this.base.apply(this,arguments),this.element.setAttribute("role",n.role),(n=this.keys)[40]="next",n[9]="next",n[38]="prev",n[CKEDITOR.SHIFT+9]="prev",n[32]=CKEDITOR.env.ie?"mouseup":"click",CKEDITOR.env.ie&&(n[13]="mouseup"),this._.pendingHtml=[],this._.pendingList=[],this._.items={},this._.groups={}},_:{close:function(){if(this._.started){var t=e.output({items:this._.pendingList.join("")});this._.pendingList=[],this._.pendingHtml.push(t),delete this._.started}},getClick:function(){return this._.click||(this._.click=CKEDITOR.tools.addFunction((function(e){var t=this.toggle(e);this.onClick&&this.onClick(e,t)}),this)),this._.click}},proto:{add:function(e,n,i){var r=CKEDITOR.tools.getNextId();this._.started||(this._.started=1,this._.size=this._.size||0),this._.items[e]=r,e={id:r,val:CKEDITOR.tools.htmlEncodeAttr(e).replace(o,"\\'"),onclick:CKEDITOR.env.ie?'return false;" onmouseup="CKEDITOR.tools.getMouseButton(event)===CKEDITOR.MOUSE_BUTTON_LEFT&&':"",clickFn:this._.getClick(),title:CKEDITOR.tools.htmlEncodeAttr(i||e),text:n||e},this._.pendingList.push(t.output(e))},startGroup:function(e){this._.close();var t=CKEDITOR.tools.getNextId();this._.groups[e]=t,this._.pendingHtml.push(n.output({id:t,label:e}))},commit:function(){this._.close(),this.element.appendHtml(this._.pendingHtml.join("")),delete this._.size,this._.pendingHtml=[]},toggle:function(e){var t=this.isMarked(e);return t?this.unmark(e):this.mark(e),!t},hideGroup:function(e){var t=(e=this.element.getDocument().getById(this._.groups[e]))&&e.getNext();e&&(e.setStyle("display","none"),t&&"ul"==t.getName()&&t.setStyle("display","none"))},hideItem:function(e){this.element.getDocument().getById(this._.items[e]).setStyle("display","none")},showAll:function(){var e,t=this._.items,n=this._.groups,o=this.element.getDocument();for(e in t)o.getById(t[e]).setStyle("display","");for(var i in n)e=(t=o.getById(n[i])).getNext(),t.setStyle("display",""),e&&"ul"==e.getName()&&e.setStyle("display","")},mark:function(e){this.multiSelect||this.unmarkAll(),e=this._.items[e];var t=this.element.getDocument().getById(e);t.addClass("cke_selected"),this.element.getDocument().getById(e+"_option").setAttribute("aria-selected",!0),this.onMark&&this.onMark(t)},markFirstDisplayed:function(){var e=this;this._.markFirstDisplayed((function(){e.multiSelect||e.unmarkAll()}))},unmark:function(e){var t=this.element.getDocument(),n=t.getById(e=this._.items[e]);n.removeClass("cke_selected"),t.getById(e+"_option").removeAttribute("aria-selected"),this.onUnmark&&this.onUnmark(n)},unmarkAll:function(){var e,t=this._.items,n=this.element.getDocument();for(e in t){var o=t[e];n.getById(o).removeClass("cke_selected"),n.getById(o+"_option").removeAttribute("aria-selected")}this.onUnmark&&this.onUnmark()},isMarked:function(e){return this.element.getDocument().getById(this._.items[e]).hasClass("cke_selected")},focus:function(e){this._.focusIndex=-1;var t,n=this.element.getElementsByTag("a"),o=-1;if(e){for(t=this.element.getDocument().getById(this._.items[e]).getFirst();e=n.getItem(++o);)if(e.equals(t)){this._.focusIndex=o;break}}else this.element.focus();t&&setTimeout((function(){t.focus()}),0)}}})}}),CKEDITOR.plugins.add("richcombo",{requires:"floatpanel,listblock,button",beforeInit:function(e){e.ui.addHandler(CKEDITOR.UI_RICHCOMBO,CKEDITOR.ui.richCombo.handler)}}),function(){var e='<span id="{id}" class="cke_combo cke_combo__{name} {cls}" role="presentation"><span id="{id}_label" class="cke_combo_label">{label}</span><a class="cke_combo_button" title="{title}" tabindex="-1"'+(CKEDITOR.env.gecko&&!CKEDITOR.env.hc?"":" href=\"javascript:void('{titleJs}')\"")+' hidefocus="true" role="button" aria-labelledby="{id}_label" aria-haspopup="listbox"',t="";CKEDITOR.env.gecko&&CKEDITOR.env.mac&&(e+=' onkeypress="return false;"'),CKEDITOR.env.gecko&&(e+=' onblur="this.style.cssText = this.style.cssText;"'),CKEDITOR.env.ie&&(t='return false;" onmouseup="CKEDITOR.tools.getMouseButton(event)==CKEDITOR.MOUSE_BUTTON_LEFT&&'),e=e+' onkeydown="return CKEDITOR.tools.callFunction({keydownFn},event,this);" onfocus="return CKEDITOR.tools.callFunction({focusFn},event);" onclick="'+t+'CKEDITOR.tools.callFunction({clickFn},this);return false;"><span id="{id}_text" class="cke_combo_text cke_combo_inlinelabel">{label}</span><span class="cke_combo_open"><span class="cke_combo_arrow">'+(CKEDITOR.env.hc?"&#9660;":CKEDITOR.env.air?"&nbsp;":"")+"</span></span></a></span>";var n=CKEDITOR.addTemplate("combo",e);CKEDITOR.UI_RICHCOMBO="richcombo",CKEDITOR.ui.richCombo=CKEDITOR.tools.createClass({$:function(e){CKEDITOR.tools.extend(this,e,{canGroup:!1,title:e.label,modes:{wysiwyg:1},editorFocus:1}),e=this.panel||{},delete this.panel,this.id=CKEDITOR.tools.getNextNumber(),this.document=e.parent&&e.parent.getDocument()||CKEDITOR.document,e.className="cke_combopanel",e.block={multiSelect:e.multiSelect,attributes:e.attributes},e.toolbarRelated=!0,this._={panelDefinition:e,items:{},listeners:[]}},proto:{renderHtml:function(e){var t=[];return this.render(e,t),t.join("")},render:function(e,t){function o(){if(this.getState()!=CKEDITOR.TRISTATE_ON){var t=this.modes[e.mode]?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED;e.readOnly&&!this.readOnly&&(t=CKEDITOR.TRISTATE_DISABLED),this.setState(t),this.setValue(""),t!=CKEDITOR.TRISTATE_DISABLED&&this.refresh&&this.refresh()}}var i=CKEDITOR.env,r="cke_"+this.id,a=CKEDITOR.tools.addFunction((function(t){d&&(e.unlockSelection(1),d=0),l.execute(t)}),this),s=this,l={id:r,combo:this,focus:function(){CKEDITOR.document.getById(r).getChild(1).focus()},execute:function(t){var n=s._;if(n.state!=CKEDITOR.TRISTATE_DISABLED)if(s.createPanel(e),n.on)n.panel.hide();else{s.commit();var o=s.getValue();o?n.list.mark(o):n.list.unmarkAll(),n.panel.showBlock(s.id,new CKEDITOR.dom.element(t),4)}},clickFn:a};this._.listeners.push(e.on("activeFilterChange",o,this)),this._.listeners.push(e.on("mode",o,this)),this._.listeners.push(e.on("selectionChange",o,this)),!this.readOnly&&this._.listeners.push(e.on("readOnly",o,this));var u=CKEDITOR.tools.addFunction((function(e,t){var n=(e=new CKEDITOR.dom.event(e)).getKeystroke();switch(n){case 13:case 32:case 40:CKEDITOR.tools.callFunction(a,t);break;default:l.onkey(l,n)}e.preventDefault()})),c=CKEDITOR.tools.addFunction((function(){l.onfocus&&l.onfocus()})),d=0;return l.keyDownFn=u,i={id:r,name:this.name||this.command,label:this.label,title:this.title,cls:this.className||"",titleJs:i.gecko&&!i.hc?"":(this.title||"").replace("'",""),keydownFn:u,focusFn:c,clickFn:a},n.output(i,t),this.onRender&&this.onRender(),l},createPanel:function(e){if(!this._.panel){var t=this._.panelDefinition.block,n=(r=this._.panelDefinition).parent||CKEDITOR.document.getBody(),o="cke_combopanel__"+this.name,i=new CKEDITOR.ui.floatPanel(e,n,r),r=i.addListBlock(this.id,t),a=this;i.onShow=function(){this.element.addClass(o),a.setState(CKEDITOR.TRISTATE_ON),a._.on=1,a.editorFocus&&!e.focusManager.hasFocus&&e.focus(),a.onOpen&&a.onOpen()},i.onHide=function(t){this.element.removeClass(o),a.setState(a.modes&&a.modes[e.mode]?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED),a._.on=0,!t&&a.onClose&&a.onClose()},i.onEscape=function(){i.hide(1)},r.onClick=function(e,t){a.onClick&&a.onClick.call(a,e,t),i.hide()},this._.panel=i,this._.list=r,i.getBlock(this.id).onHide=function(){a._.on=0,a.setState(CKEDITOR.TRISTATE_OFF)},this.init&&this.init()}},setValue:function(e,t){this._.value=e;var n=this.document.getById("cke_"+this.id+"_text");n&&(e||t?n.removeClass("cke_combo_inlinelabel"):(t=this.label,n.addClass("cke_combo_inlinelabel")),n.setText(void 0!==t?t:e))},getValue:function(){return this._.value||""},unmarkAll:function(){this._.list.unmarkAll()},mark:function(e){this._.list.mark(e)},hideItem:function(e){this._.list.hideItem(e)},hideGroup:function(e){this._.list.hideGroup(e)},showAll:function(){this._.list.showAll()},add:function(e,t,n){this._.items[e]=n||e,this._.list.add(e,t,n)},startGroup:function(e){this._.list.startGroup(e)},commit:function(){this._.committed||(this._.list.commit(),this._.committed=1,CKEDITOR.ui.fire("ready",this)),this._.committed=1},setState:function(e){if(this._.state!=e){var t=this.document.getById("cke_"+this.id);t.setState(e,"cke_combo"),e==CKEDITOR.TRISTATE_DISABLED?t.setAttribute("aria-disabled",!0):t.removeAttribute("aria-disabled"),this._.state=e}},getState:function(){return this._.state},enable:function(){this._.state==CKEDITOR.TRISTATE_DISABLED&&this.setState(this._.lastState)},disable:function(){this._.state!=CKEDITOR.TRISTATE_DISABLED&&(this._.lastState=this._.state,this.setState(CKEDITOR.TRISTATE_DISABLED))},destroy:function(){CKEDITOR.tools.array.forEach(this._.listeners,(function(e){e.removeListener()})),this._.listeners=[]}},statics:{handler:{create:function(e){return new CKEDITOR.ui.richCombo(e)}}}}),CKEDITOR.ui.prototype.addRichCombo=function(e,t){this.add(e,CKEDITOR.UI_RICHCOMBO,t)}}(),function(){function e(e,t,n,o,i,r,a,s){var l=e.config,u=new CKEDITOR.style(a),c=i.split(";");i=[];for(var d={},f=0;f<c.length;f++)if(h=c[f]){var h=h.split("/"),g={},m=c[f]=h[0];g[n]=i[f]=h[1]||m,d[m]=new CKEDITOR.style(a,g),d[m]._.definition.name=m}else c.splice(f--,1);e.ui.addRichCombo(t,{label:o.label,title:o.panelTitle,toolbar:"styles,"+s,defaultValue:"cke-default",allowedContent:u,requiredContent:u,contentTransformations:"span"===a.element?[[{element:"font",check:"span",left:function(e){return!!e.attributes.size||!!e.attributes.align||!!e.attributes.face},right:function(e){var t=" x-small small medium large x-large xx-large 48px".split(" ");e.name="span",e.attributes.size&&(e.styles["font-size"]=t[e.attributes.size],delete e.attributes.size),e.attributes.align&&(e.styles["text-align"]=e.attributes.align,delete e.attributes.align),e.attributes.face&&(e.styles["font-family"]=e.attributes.face,delete e.attributes.face)}}]]:null,panel:{css:[CKEDITOR.skin.getPath("editor")].concat(l.contentsCss),multiSelect:!1,attributes:{"aria-label":o.panelTitle}},init:function(){var t;t="("+e.lang.common.optionDefault+")",this.startGroup(o.panelTitle),this.add(this.defaultValue,t,t);for(var n=0;n<c.length;n++)this.add(t=c[n],d[t].buildPreview(),t)},onClick:function(t){e.focus(),e.fire("saveSnapshot");var n,o,i,r,a,s=this.getValue(),l=d[t];if(s&&t!=s)if(n=d[s],(s=e.getSelection().getRanges()[0]).collapsed){if(i=(o=e.elementPath()).contains((function(e){return n.checkElementRemovable(e)}))){if(r=s.checkBoundaryOfElement(i,CKEDITOR.START),a=s.checkBoundaryOfElement(i,CKEDITOR.END),r&&a){for(r=s.createBookmark();o=i.getFirst();)o.insertBefore(i);i.remove(),s.moveToBookmark(r)}else r||a?s.moveToPosition(i,r?CKEDITOR.POSITION_BEFORE_START:CKEDITOR.POSITION_AFTER_END):(s.splitElement(i),s.moveToPosition(i,CKEDITOR.POSITION_AFTER_END)),function e(t,n,o){var i=n.pop();if(i){if(o)return e(t,n,i.equals(o)?null:o);o=i.clone(),t.insertNode(o),t.moveToPosition(o,CKEDITOR.POSITION_AFTER_START),e(t,n)}}(s,o.elements.slice(),i);e.getSelection().selectRanges([s])}}else e.removeStyle(n);t===this.defaultValue?n&&e.removeStyle(n):e.applyStyle(l),e.fire("saveSnapshot")},onRender:function(){e.on("selectionChange",(function(t){var n=this.getValue();t=t.data.path.elements;for(var o,i=0;i<t.length;i++)for(var a in o=t[i],d)if(d[a].checkElementMatch(o,!0,e))return void(a!=n&&this.setValue(a));this.setValue("",r)}),this)},refresh:function(){e.activeFilter.check(u)||this.setState(CKEDITOR.TRISTATE_DISABLED)}})}CKEDITOR.plugins.add("font",{requires:"richcombo",init:function(t){var n=t.config;e(t,"Font","family",t.lang.font,n.font_names,n.font_defaultLabel,n.font_style,30),e(t,"FontSize","size",t.lang.font.fontSize,n.fontSize_sizes,n.fontSize_defaultLabel,n.fontSize_style,40)}})}(),CKEDITOR.config.font_names="Arial/Arial, Helvetica, sans-serif;Comic Sans MS/Comic Sans MS, cursive;Courier New/Courier New, Courier, monospace;Georgia/Georgia, serif;Lucida Sans Unicode/Lucida Sans Unicode, Lucida Grande, sans-serif;Tahoma/Tahoma, Geneva, sans-serif;Times New Roman/Times New Roman, Times, serif;Trebuchet MS/Trebuchet MS, Helvetica, sans-serif;Verdana/Verdana, Geneva, sans-serif",CKEDITOR.config.font_defaultLabel="",CKEDITOR.config.font_style={element:"span",styles:{"font-family":"#(family)"},overrides:[{element:"font",attributes:{face:null}}]},CKEDITOR.config.fontSize_sizes="8/8px;9/9px;10/10px;11/11px;12/12px;14/14px;16/16px;18/18px;20/20px;22/22px;24/24px;26/26px;28/28px;36/36px;48/48px;72/72px",CKEDITOR.config.fontSize_defaultLabel="",CKEDITOR.config.fontSize_style={element:"span",styles:{"font-size":"#(size)"},overrides:[{element:"font",attributes:{size:null}}]},CKEDITOR.plugins.add("forms",{requires:"dialog,fakeobjects",onLoad:function(){CKEDITOR.addCss(".cke_editable form{border: 1px dotted #FF0000;padding: 2px;}\n"),CKEDITOR.addCss("img.cke_hidden{background-image: url("+CKEDITOR.getUrl(this.path+"images/hiddenfield.gif")+");background-position: center center;background-repeat: no-repeat;border: 1px solid #a9a9a9;width: 16px !important;height: 16px !important;}")},init:function(e){var t=e.lang,n=0,o={email:1,password:1,search:1,tel:1,text:1,url:1},i={checkbox:"input[type,name,checked,required]",radio:"input[type,name,checked,required]",textfield:"input[type,name,value,size,maxlength,required]",textarea:"textarea[cols,rows,name,required]",select:"select[name,size,multiple,required]; option[value,selected]",button:"input[type,name,value]",form:"form[action,name,id,enctype,target,method]",hiddenfield:"input[type,name,value]",imagebutton:"input[type,alt,src]{width,height,border,border-width,border-style,margin,float}"},r={checkbox:"input",radio:"input",textfield:"input",textarea:"textarea",select:"select",button:"input",form:"form",hiddenfield:"input",imagebutton:"input"},a=function(o,a,s){var l={allowedContent:i[a],requiredContent:r[a]};"form"==a&&(l.context="form"),e.addCommand(a,new CKEDITOR.dialogCommand(a,l)),e.ui.addButton&&e.ui.addButton(o,{label:t.common[o.charAt(0).toLowerCase()+o.slice(1)],command:a,toolbar:"forms,"+(n+=10)}),CKEDITOR.dialog.add(a,s)},s=this.path+"dialogs/";!e.blockless&&a("Form","form",s+"form.js"),a("Checkbox","checkbox",s+"checkbox.js"),a("Radio","radio",s+"radio.js"),a("TextField","textfield",s+"textfield.js"),a("Textarea","textarea",s+"textarea.js"),a("Select","select",s+"select.js"),a("Button","button",s+"button.js");var l=e.plugins.image;l&&!e.plugins.image2&&a("ImageButton","imagebutton",CKEDITOR.plugins.getPath("image")+"dialogs/image.js"),a("HiddenField","hiddenfield",s+"hiddenfield.js"),e.addMenuItems&&(a={checkbox:{label:t.forms.checkboxAndRadio.checkboxTitle,command:"checkbox",group:"checkbox"},radio:{label:t.forms.checkboxAndRadio.radioTitle,command:"radio",group:"radio"},textfield:{label:t.forms.textfield.title,command:"textfield",group:"textfield"},hiddenfield:{label:t.forms.hidden.title,command:"hiddenfield",group:"hiddenfield"},button:{label:t.forms.button.title,command:"button",group:"button"},select:{label:t.forms.select.title,command:"select",group:"select"},textarea:{label:t.forms.textarea.title,command:"textarea",group:"textarea"}},l&&(a.imagebutton={label:t.image.titleButton,command:"imagebutton",group:"imagebutton"}),!e.blockless&&(a.form={label:t.forms.form.menu,command:"form",group:"form"}),e.addMenuItems(a)),e.contextMenu&&(!e.blockless&&e.contextMenu.addListener((function(e,t,n){if((e=n.contains("form",1))&&!e.isReadOnly())return{form:CKEDITOR.TRISTATE_OFF}})),e.contextMenu.addListener((function(e){if(e&&!e.isReadOnly()){var t=e.getName();if("select"==t)return{select:CKEDITOR.TRISTATE_OFF};if("textarea"==t)return{textarea:CKEDITOR.TRISTATE_OFF};if("input"==t){var n=e.getAttribute("type")||"text";switch(n){case"button":case"submit":case"reset":return{button:CKEDITOR.TRISTATE_OFF};case"checkbox":return{checkbox:CKEDITOR.TRISTATE_OFF};case"radio":return{radio:CKEDITOR.TRISTATE_OFF};case"image":return l?{imagebutton:CKEDITOR.TRISTATE_OFF}:null}if(o[n])return{textfield:CKEDITOR.TRISTATE_OFF}}if("img"==t&&"hiddenfield"==e.data("cke-real-element-type"))return{hiddenfield:CKEDITOR.TRISTATE_OFF}}}))),e.on("doubleclick",(function(t){var n=t.data.element;if(!e.blockless&&n.is("form"))t.data.dialog="form";else if(n.is("select"))t.data.dialog="select";else if(n.is("textarea"))t.data.dialog="textarea";else if(n.is("img")&&"hiddenfield"==n.data("cke-real-element-type"))t.data.dialog="hiddenfield";else if(n.is("input")){switch(n=n.getAttribute("type")||"text"){case"button":case"submit":case"reset":t.data.dialog="button";break;case"checkbox":t.data.dialog="checkbox";break;case"radio":t.data.dialog="radio";break;case"image":t.data.dialog="imagebutton"}o[n]&&(t.data.dialog="textfield")}}))},afterInit:function(e){var t=(n=e.dataProcessor)&&n.htmlFilter,n=n&&n.dataFilter;CKEDITOR.env.ie&&t&&t.addRules({elements:{input:function(e){var t=(e=e.attributes).type;t||(e.type="text"),"checkbox"!=t&&"radio"!=t||"on"!=e.value||delete e.value}}},{applyToAll:!0}),n&&n.addRules({elements:{input:function(t){if("hidden"==t.attributes.type)return e.createFakeParserElement(t,"cke_hidden","hiddenfield")}}},{applyToAll:!0})}}),CKEDITOR.plugins.forms={_setupRequiredAttribute:function(e){this.setValue(e.hasAttribute("required"))}},CKEDITOR.plugins.add("format",{requires:"richcombo",init:function(e){if(!e.blockless){for(var t=e.config,n=e.lang.format,o=t.format_tags.split(";"),i={},r=0,a=[],s=0;s<o.length;s++){var l=o[s],u=new CKEDITOR.style(t["format_"+l]);e.filter.customConfig&&!e.filter.check(u)||(r++,i[l]=u,i[l]._.enterMode=e.config.enterMode,a.push(u))}0!==r&&e.ui.addRichCombo("Format",{label:n.label,title:n.panelTitle,toolbar:"styles,20",allowedContent:a,panel:{css:[CKEDITOR.skin.getPath("editor")].concat(t.contentsCss),multiSelect:!1,attributes:{"aria-label":n.panelTitle}},init:function(){for(var e in this.startGroup(n.panelTitle),i){var t=n["tag_"+e];this.add(e,i[e].buildPreview(t),t)}},onClick:function(t){e.focus(),e.fire("saveSnapshot"),t=i[t];var n=e.elementPath();t.checkActive(n,e)||e.applyStyle(t),setTimeout((function(){e.fire("saveSnapshot")}),0)},onRender:function(){e.on("selectionChange",(function(t){var n=this.getValue();for(var o in t=t.data.path,this.refresh(),i)if(i[o].checkActive(t,e))return void(o!=n&&this.setValue(o,e.lang.format["tag_"+o]));this.setValue("")}),this)},onOpen:function(){for(var t in this.showAll(),i)e.activeFilter.check(i[t])||this.hideItem(t)},refresh:function(){var t=e.elementPath();if(t){if(t.isContextFor("p"))for(var n in i)if(e.activeFilter.check(i[n]))return;this.setState(CKEDITOR.TRISTATE_DISABLED)}}})}}}),CKEDITOR.config.format_tags="p;h1;h2;h3;h4;h5;h6;pre;address;div",CKEDITOR.config.format_p={element:"p"},CKEDITOR.config.format_div={element:"div"},CKEDITOR.config.format_pre={element:"pre"},CKEDITOR.config.format_address={element:"address"},CKEDITOR.config.format_h1={element:"h1"},CKEDITOR.config.format_h2={element:"h2"},CKEDITOR.config.format_h3={element:"h3"},CKEDITOR.config.format_h4={element:"h4"},CKEDITOR.config.format_h5={element:"h5"},CKEDITOR.config.format_h6={element:"h6"},function(){var e={canUndo:!1,exec:function(e){var t=e.document.createElement("hr");e.insertElement(t)},allowedContent:"hr",requiredContent:"hr"};CKEDITOR.plugins.add("horizontalrule",{init:function(t){t.blockless||(t.addCommand("horizontalrule",e),t.ui.addButton&&t.ui.addButton("HorizontalRule",{label:t.lang.horizontalrule.toolbar,command:"horizontalrule",toolbar:"insert,40"}))}})}(),CKEDITOR.plugins.add("htmlwriter",{init:function(e){var t=new CKEDITOR.htmlWriter;t.forceSimpleAmpersand=e.config.forceSimpleAmpersand,t.indentationChars=e.config.dataIndentationChars||"\t",e.dataProcessor.writer=t}}),CKEDITOR.htmlWriter=CKEDITOR.tools.createClass({base:CKEDITOR.htmlParser.basicWriter,$:function(){this.base(),this.indentationChars="\t",this.selfClosingEnd=" />",this.lineBreakChars="\n",this.sortAttributes=1,this._.indent=0,this._.indentation="",this._.inPre=0,this._.rules={};var e,t=CKEDITOR.dtd;for(e in CKEDITOR.tools.extend({},t.$nonBodyContent,t.$block,t.$listItem,t.$tableContent))this.setRules(e,{indent:!t[e]["#"],breakBeforeOpen:1,breakBeforeClose:!t[e]["#"],breakAfterClose:1,needsSpace:e in t.$block&&!(e in{li:1,dt:1,dd:1})});this.setRules("br",{breakAfterOpen:1}),this.setRules("title",{indent:0,breakAfterOpen:0}),this.setRules("style",{indent:0,breakBeforeClose:1}),this.setRules("pre",{breakAfterOpen:1,indent:0})},proto:{openTag:function(e){var t=this._.rules[e];this._.afterCloser&&t&&t.needsSpace&&this._.needsSpace&&this._.output.push("\n"),this._.indent?this.indentation():t&&t.breakBeforeOpen&&(this.lineBreak(),this.indentation()),this._.output.push("<",e),this._.afterCloser=0},openTagClose:function(e,t){var n=this._.rules[e];t?(this._.output.push(this.selfClosingEnd),n&&n.breakAfterClose&&(this._.needsSpace=n.needsSpace)):(this._.output.push(">"),n&&n.indent&&(this._.indentation+=this.indentationChars)),n&&n.breakAfterOpen&&this.lineBreak(),"pre"==e&&(this._.inPre=1)},attribute:function(e,t){"string"==typeof t&&(t=CKEDITOR.tools.htmlEncodeAttr(t),this.forceSimpleAmpersand&&(t=t.replace(/&amp;/g,"&"))),this._.output.push(" ",e,'="',t,'"')},closeTag:function(e){var t=this._.rules[e];t&&t.indent&&(this._.indentation=this._.indentation.substr(this.indentationChars.length)),this._.indent?this.indentation():t&&t.breakBeforeClose&&(this.lineBreak(),this.indentation()),this._.output.push("</",e,">"),"pre"==e&&(this._.inPre=0),t&&t.breakAfterClose&&(this.lineBreak(),this._.needsSpace=t.needsSpace),this._.afterCloser=1},text:function(e){this._.indent&&(this.indentation(),!this._.inPre&&(e=CKEDITOR.tools.ltrim(e))),this._.output.push(e)},comment:function(e){this._.indent&&this.indentation(),this._.output.push("\x3c!--",e,"--\x3e")},lineBreak:function(){!this._.inPre&&0<this._.output.length&&this._.output.push(this.lineBreakChars),this._.indent=1},indentation:function(){!this._.inPre&&this._.indentation&&this._.output.push(this._.indentation),this._.indent=0},reset:function(){this._.output=[],this._.indent=0,this._.indentation="",this._.afterCloser=0,this._.inPre=0,this._.needsSpace=0},setRules:function(e,t){var n=this._.rules[e];n?CKEDITOR.tools.extend(n,t,!0):this._.rules[e]=t}}}),CKEDITOR.plugins.add("iframe",{requires:"dialog,fakeobjects",onLoad:function(){CKEDITOR.addCss("img.cke_iframe{background-image: url("+CKEDITOR.getUrl(this.path+"images/placeholder.png")+");background-position: center center;background-repeat: no-repeat;border: 1px solid #a9a9a9;width: 80px;height: 80px;}")},init:function(e){var t=e.lang.iframe,n="iframe[align,longdesc,frameborder,height,name,scrolling,src,title,width]";e.plugins.dialogadvtab&&(n+=";iframe"+e.plugins.dialogadvtab.allowedContent({id:1,classes:1,styles:1})),CKEDITOR.dialog.add("iframe",this.path+"dialogs/iframe.js"),e.addCommand("iframe",new CKEDITOR.dialogCommand("iframe",{allowedContent:n,requiredContent:"iframe"})),e.ui.addButton&&e.ui.addButton("Iframe",{label:t.toolbar,command:"iframe",toolbar:"insert,80"}),e.on("doubleclick",(function(e){var t=e.data.element;t.is("img")&&"iframe"==t.data("cke-real-element-type")&&(e.data.dialog="iframe")})),e.addMenuItems&&e.addMenuItems({iframe:{label:t.title,command:"iframe",group:"image"}}),e.contextMenu&&e.contextMenu.addListener((function(e){if(e&&e.is("img")&&"iframe"==e.data("cke-real-element-type"))return{iframe:CKEDITOR.TRISTATE_OFF}}))},afterInit:function(e){var t=e.dataProcessor;(t=t&&t.dataFilter)&&t.addRules({elements:{iframe:function(t){return e.createFakeParserElement(t,"cke_iframe","iframe",!0)}}})}}),function(){function e(e){function t(e){var t=!1;s.attachListener(s,"keydown",(function(){var n=i.getBody().getElementsByTag(e);if(!t){for(var o=0;o<n.count();o++)n.getItem(o).setCustomData("retain",!0);t=!0}}),null,null,1),s.attachListener(s,"keyup",(function(){var n=i.getElementsByTag(e);t&&(1==n.count()&&!n.getItem(0).getCustomData("retain")&&CKEDITOR.tools.isEmpty(n.getItem(0).getAttributes())&&n.getItem(0).remove(1),t=!1)}))}var n=this.editor;if(n&&!n.isDetached()){var i=e.document,r=i.body,a=i.getElementById("cke_actscrpt");a&&a.parentNode.removeChild(a),(a=i.getElementById("cke_shimscrpt"))&&a.parentNode.removeChild(a),(a=i.getElementById("cke_basetagscrpt"))&&a.parentNode.removeChild(a),r.contentEditable=!0,CKEDITOR.env.ie&&(r.hideFocus=!0,r.disabled=!0,r.removeAttribute("disabled")),delete this._.isLoadingData,this.$=r,i=new CKEDITOR.dom.document(i),this.setup(),this.fixInitialSelection();var s=this;CKEDITOR.env.ie&&!CKEDITOR.env.edge&&i.getDocumentElement().addClass(i.$.compatMode),CKEDITOR.env.ie&&!CKEDITOR.env.edge&&n.enterMode!=CKEDITOR.ENTER_P?t("p"):CKEDITOR.env.edge&&15>CKEDITOR.env.version&&n.enterMode!=CKEDITOR.ENTER_DIV&&t("div"),(CKEDITOR.env.webkit||CKEDITOR.env.ie&&10<CKEDITOR.env.version)&&i.getDocumentElement().on("mousedown",(function(e){e.data.getTarget().is("html")&&setTimeout((function(){n.editable().focus()}))})),function(e){function t(e){e.returnValue=!1}if(CKEDITOR.env.gecko)try{var n=e.document.$;n.execCommand("enableObjectResizing",!1,!e.config.disableObjectResizing),n.execCommand("enableInlineTableEditing",!1,!e.config.disableNativeTableHandles)}catch(r){}else CKEDITOR.env.ie&&11>CKEDITOR.env.version&&e.config.disableObjectResizing&&function(){var n;e.editable().attachListener(e,"selectionChange",(function(){var o=e.getSelection().getSelectedElement();o&&(n&&(n.detachEvent("onresizestart",t),n=null),o.$.attachEvent("onresizestart",t),n=o.$)}))}()}(n);try{n.document.$.execCommand("2D-position",!1,!0)}catch(o){}(CKEDITOR.env.gecko||CKEDITOR.env.ie&&"CSS1Compat"==n.document.$.compatMode)&&this.attachListener(this,"keydown",(function(e){var t=e.data.getKeystroke();if(33==t||34==t)if(CKEDITOR.env.ie)setTimeout((function(){n.getSelection().scrollIntoView()}),0);else if(n.window.$.innerHeight>this.$.offsetHeight){var o=n.createRange();o[33==t?"moveToElementEditStart":"moveToElementEditEnd"](this),o.select(),e.data.preventDefault()}})),CKEDITOR.env.ie&&this.attachListener(i,"blur",(function(){try{i.$.selection.empty()}catch(e){}})),CKEDITOR.env.iOS&&this.attachListener(i,"touchend",(function(){e.focus()})),(r=n.document.getElementsByTag("title").getItem(0)).data("cke-title",r.getText()),CKEDITOR.env.ie&&(n.document.$.title=this._.docTitle),CKEDITOR.tools.setTimeout((function(){"unloaded"==this.status&&(this.status="ready"),n.fire("contentDom"),this._.isPendingFocus&&(n.focus(),this._.isPendingFocus=!1),setTimeout((function(){n.fire("dataReady")}),0)}),0,this)}}var t;CKEDITOR.plugins.add("wysiwygarea",{init:function(e){e.config.fullPage&&e.addFeature({allowedContent:"html head title; style [media,type]; body (*)[id]; meta link [*]",requiredContent:"body"}),e.addMode("wysiwyg",(function(n){function o(o){o&&o.removeListener(),e.isDestroyed()||e.isDetached()||(e.editable(new t(e,r.$.contentWindow.document.body)),e.setData(e.getData(1),n))}var i="document.open();"+(CKEDITOR.env.ie?"("+CKEDITOR.tools.fixDomain+")();":"")+"document.close();",r=(i=CKEDITOR.env.air?"javascript:void(0)":CKEDITOR.env.ie&&!CKEDITOR.env.edge?"javascript:void(function(){"+encodeURIComponent(i)+"}())":"",CKEDITOR.dom.element.createFromHtml('<iframe src="'+i+'" frameBorder="0"></iframe>'));r.setStyles({width:"100%",height:"100%"}),r.addClass("cke_wysiwyg_frame").addClass("cke_reset"),(i=e.ui.space("contents")).append(r);var a=CKEDITOR.env.ie&&!CKEDITOR.env.edge||CKEDITOR.env.gecko;a&&r.on("load",o);var s=e.title,l=e.fire("ariaEditorHelpLabel",{}).label;if(s&&(CKEDITOR.env.ie&&l&&(s+=", "+l),r.setAttribute("title",s)),l){s=CKEDITOR.tools.getNextId();var u=CKEDITOR.dom.element.createFromHtml('<span id="'+s+'" class="cke_voice_label">'+l+"</span>");i.append(u,1),r.setAttribute("aria-describedby",s)}e.on("beforeModeUnload",(function(e){e.removeListener(),u&&u.remove()})),r.setAttributes({tabIndex:e.tabIndex,allowTransparency:"true"}),!a&&o(),e.fire("ariaWidget",r)}))}}),CKEDITOR.editor.prototype.addContentsCss=function(e){var t=this.config,n=t.contentsCss;CKEDITOR.tools.isArray(n)||(t.contentsCss=n?[n]:[]),t.contentsCss.push(e)},t=CKEDITOR.tools.createClass({$:function(){this.base.apply(this,arguments),this._.frameLoadedHandler=CKEDITOR.tools.addFunction((function(t){CKEDITOR.tools.setTimeout(e,0,this,t)}),this),this._.docTitle=this.getWindow().getFrame().getAttribute("title")},base:CKEDITOR.editable,proto:{setData:function(e,n){var o=this.editor;if(n)this.setHtml(e),this.fixInitialSelection(),o.fire("dataReady");else{this._.isLoadingData=!0,o._.dataStore={id:1};var i=o.config,r=i.fullPage,a=i.docType,s=CKEDITOR.tools.buildStyleHtml(function(){var e=[];if(8<=CKEDITOR.document.$.documentMode){e.push("html.CSS1Compat [contenteditable=false]{min-height:0 !important}");var t,n=[];for(t in CKEDITOR.dtd.$removeEmpty)n.push("html.CSS1Compat "+t+"[contenteditable=false]");e.push(n.join(",")+"{display:inline-block}")}else CKEDITOR.env.gecko&&(e.push("html{height:100% !important}"),e.push("img:-moz-broken{-moz-force-broken-image-icon:1;min-width:24px;min-height:24px}"));return e.push("html{cursor:text;*cursor:auto}"),e.push("img,input,textarea{cursor:default}"),e.join("\n")}()).replace(/<style>/,'<style data-cke-temp="1">');r||(s+=CKEDITOR.tools.buildStyleHtml(o.config.contentsCss));var l=i.baseHref?'<base href="'+i.baseHref+'" data-cke-temp="1" />':"";r&&(e=e.replace(/<!DOCTYPE[^>]*>/i,(function(e){return o.docType=a=e,""})).replace(/<\?xml\s[^\?]*\?>/i,(function(e){return o.xmlDeclaration=e,""}))),e=o.dataProcessor.toHtml(e),r?(/<body[\s|>]/.test(e)||(e="<body>"+e),/<html[\s|>]/.test(e)||(e="<html>"+e+"</html>"),/<head[\s|>]/.test(e)?/<title[\s|>]/.test(e)||(e=e.replace(/<head[^>]*>/,"$&<title></title>")):e=e.replace(/<html[^>]*>/,"$&<head><title></title></head>"),l&&(e=e.replace(/<head[^>]*?>/,"$&"+l)),e=e.replace(/<\/head\s*>/,s+"$&"),e=a+e):e=i.docType+'<html dir="'+i.contentsLangDirection+'" lang="'+(i.contentsLanguage||o.langCode)+'"><head><title>'+this._.docTitle+"</title>"+l+s+"</head><body"+(i.bodyId?' id="'+i.bodyId+'"':"")+(i.bodyClass?' class="'+i.bodyClass+'"':"")+">"+e+"</body></html>",CKEDITOR.env.gecko&&(e=e.replace(/<body/,'<body contenteditable="true" '),2e4>CKEDITOR.env.version&&(e=e.replace(/<body[^>]*>/,"$&\x3c!-- cke-content-start --\x3e"))),i='<script id="cke_actscrpt" type="text/javascript"'+(CKEDITOR.env.ie?' defer="defer" ':"")+">var wasLoaded=0;function onload(){if(!wasLoaded)window.parent.CKEDITOR.tools.callFunction("+this._.frameLoadedHandler+",window);wasLoaded=1;}"+(CKEDITOR.env.ie?"onload();":'document.addEventListener("DOMContentLoaded", onload, false );')+"<\/script>",CKEDITOR.env.ie&&9>CKEDITOR.env.version&&(i+='<script id="cke_shimscrpt">window.parent.CKEDITOR.tools.enableHtml5Elements(document)<\/script>'),l&&CKEDITOR.env.ie&&10>CKEDITOR.env.version&&(i+='<script id="cke_basetagscrpt">var baseTag = document.querySelector( "base" );baseTag.href = baseTag.href;<\/script>'),e=e.replace(/(?=\s*<\/(:?head)>)/,i),this.clearCustomData(),this.clearListeners(),o.fire("contentDomUnload");var u=this.getDocument();try{u.write(e)}catch(t){setTimeout((function(){u.write(e)}),0)}}},getData:function(e){if(e)return this.getHtml();var t=(e=this.editor).config,n=(r=t.fullPage)&&e.docType,o=r&&e.xmlDeclaration,i=this.getDocument(),r=r?i.getDocumentElement().getOuterHtml():i.getBody().getHtml();return CKEDITOR.env.gecko&&t.enterMode!=CKEDITOR.ENTER_BR&&(r=r.replace(/<br>(?=\s*(:?$|<\/body>))/,"")),r=e.dataProcessor.toDataFormat(r),o&&(r=o+"\n"+r),n&&(r=n+"\n"+r),r},focus:function(){this._.isLoadingData?this._.isPendingFocus=!0:t.baseProto.focus.call(this)},detach:function(){var e=(n=this.editor).document,n=n.container.findOne("iframe.cke_wysiwyg_frame");t.baseProto.detach.call(this),this.clearCustomData(this._.expandoNumber),e.getDocumentElement().clearCustomData(),CKEDITOR.tools.removeFunction(this._.frameLoadedHandler),n&&(n.clearCustomData(),(e=n.removeCustomData("onResize"))&&e.removeListener(),n.isDetached()||n.remove())}}})}(),CKEDITOR.config.disableObjectResizing=!1,CKEDITOR.config.disableNativeTableHandles=!0,CKEDITOR.config.disableNativeSpellChecker=!0,function(){function e(e,t){if(t||(t=e.getSelection().getSelectedElement()),t&&t.is("img")&&!t.data("cke-realelement")&&!t.isReadOnly())return t}function t(e){var t=e.getStyle("float");return"inherit"!=t&&"none"!=t||(t=0),t||(t=e.getAttribute("align")),t}CKEDITOR.plugins.add("image",{requires:"dialog",init:function(t){if(!t.plugins.detectConflict("image",["easyimage","image2"])){CKEDITOR.dialog.add("image",this.path+"dialogs/image.js");var n="img[alt,!src]{border-style,border-width,float,height,margin,margin-bottom,margin-left,margin-right,margin-top,width}";CKEDITOR.dialog.isTabEnabled(t,"image","advanced")&&(n="img[alt,dir,id,lang,longdesc,!src,title]{*}(*)"),t.addCommand("image",new CKEDITOR.dialogCommand("image",{allowedContent:n,requiredContent:"img[alt,src]",contentTransformations:[["img{width}: sizeToStyle","img[width]: sizeToAttribute"],["img{float}: alignmentToStyle","img[align]: alignmentToAttribute"]]})),t.ui.addButton&&t.ui.addButton("Image",{label:t.lang.common.image,command:"image",toolbar:"insert,10"}),t.on("doubleclick",(function(e){var t=e.data.element;!t.is("img")||t.data("cke-realelement")||t.isReadOnly()||(e.data.dialog="image")})),t.addMenuItems&&t.addMenuItems({image:{label:t.lang.image.menu,command:"image",group:"image"}}),t.contextMenu&&t.contextMenu.addListener((function(n){if(e(t,n))return{image:CKEDITOR.TRISTATE_OFF}}))}},afterInit:function(n){function o(o){var i=n.getCommand("justify"+o);i&&("left"!=o&&"right"!=o||i.on("exec",(function(i){var r=e(n);r&&(t(r)==o?(r.removeStyle("float"),o==t(r)&&r.removeAttribute("align")):r.setStyle("float",o),i.cancel())})),i.on("refresh",(function(i){var r=e(n);r&&(r=t(r),this.setState(r==o?CKEDITOR.TRISTATE_ON:"right"==o||"left"==o?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED),i.cancel())})))}n.plugins.image2||(o("left"),o("right"),o("center"),o("block"))}})}(),CKEDITOR.config.image_removeLinkByEmptyURL=!0,function(){function e(e,o){var i,r;o.on("refresh",(function(e){var o,i=[t];for(o in e.data.states)i.push(e.data.states[o]);this.setState(CKEDITOR.tools.search(i,n)?n:t)}),o,null,100),o.on("exec",(function(t){i=e.getSelection(),r=i.createBookmarks(1),t.data||(t.data={}),t.data.done=!1}),o,null,0),o.on("exec",(function(){e.forceNextSelectionCheck(),i.selectBookmarks(r)}),o,null,100)}var t=CKEDITOR.TRISTATE_DISABLED,n=CKEDITOR.TRISTATE_OFF;CKEDITOR.plugins.add("indent",{init:function(t){var n=CKEDITOR.plugins.indent.genericDefinition;e(t,t.addCommand("indent",new n(!0))),e(t,t.addCommand("outdent",new n)),t.ui.addButton&&(t.ui.addButton("Indent",{label:t.lang.indent.indent,command:"indent",directional:!0,toolbar:"indent,20"}),t.ui.addButton("Outdent",{label:t.lang.indent.outdent,command:"outdent",directional:!0,toolbar:"indent,10"})),t.on("dirChanged",(function(e){var n=t.createRange(),o=e.data.node;n.setStartBefore(o),n.setEndAfter(o);for(var i,r=new CKEDITOR.dom.walker(n);i=r.next();)if(i.type==CKEDITOR.NODE_ELEMENT)if(!i.equals(o)&&i.getDirection())n.setStartAfter(i),r=new CKEDITOR.dom.walker(n);else{var a=t.config.indentClasses;if(a)for(var s="ltr"==e.data.dir?["_rtl",""]:["","_rtl"],l=0;l<a.length;l++)i.hasClass(a[l]+s[0])&&(i.removeClass(a[l]+s[0]),i.addClass(a[l]+s[1]));a=i.getStyle("margin-right"),s=i.getStyle("margin-left"),a?i.setStyle("margin-left",a):i.removeStyle("margin-left"),s?i.setStyle("margin-right",s):i.removeStyle("margin-right")}}))}}),CKEDITOR.plugins.indent={genericDefinition:function(e){this.isIndent=!!e,this.startDisabled=!this.isIndent},specificDefinition:function(e,t,n){this.name=t,this.editor=e,this.jobs={},this.enterBr=e.config.enterMode==CKEDITOR.ENTER_BR,this.isIndent=!!n,this.relatedGlobal=n?"indent":"outdent",this.indentKey=n?9:CKEDITOR.SHIFT+9,this.database={}},registerCommands:function(e,t){e.on("pluginsLoaded",(function(){for(var e in t)!function(e,t){var n,o=e.getCommand(t.relatedGlobal);for(n in t.jobs)o.on("exec",(function(o){o.data.done||(e.fire("lockSnapshot"),t.execJob(e,n)&&(o.data.done=!0),e.fire("unlockSnapshot"),CKEDITOR.dom.element.clearAllMarkers(t.database))}),this,null,n),o.on("refresh",(function(o){o.data.states||(o.data.states={}),o.data.states[t.name+"@"+n]=t.refreshJob(e,n,o.data.path)}),this,null,n);e.addFeature(t)}(this,t[e])}))}},CKEDITOR.plugins.indent.genericDefinition.prototype={context:"p",exec:function(){}},CKEDITOR.plugins.indent.specificDefinition.prototype={execJob:function(e,n){var o=this.jobs[n];if(o.state!=t)return o.exec.call(this,e)},refreshJob:function(e,n,o){return(n=this.jobs[n]).state=e.activeFilter.checkFeature(this)?n.refresh.call(this,e,o):t,n.state},getContext:function(e){return e.contains(this.context)}}}(),function(){function e(e,n,o){if(!e.getCustomData("indent_processed")){var i=this.editor,r=this.isIndent;if(n){if(o=0,(i=e.$.className.match(this.classNameRegex))&&(i=i[1],o=CKEDITOR.tools.indexOf(n,i)+1),0>(o+=r?1:-1))return;o=Math.min(o,n.length),o=Math.max(o,0),e.$.className=CKEDITOR.tools.ltrim(e.$.className.replace(this.classNameRegex,"")),0<o&&e.addClass(n[o-1])}else{n=t(e,o),o=parseInt(e.getStyle(n),10);var a=i.config.indentOffset||40;if(isNaN(o)&&(o=0),0>(o+=(r?1:-1)*a))return;o=Math.max(o,0),o=Math.ceil(o/a)*a,e.setStyle(n,o?o+(i.config.indentUnit||"px"):""),""===e.getAttribute("style")&&e.removeAttribute("style")}CKEDITOR.dom.element.setMarker(this.database,e,"indent_processed",1)}}function t(e,t){return"ltr"==(t||e.getComputedStyle("direction"))?"margin-left":"margin-right"}var n=CKEDITOR.dtd.$listItem,o=CKEDITOR.dtd.$list,i=CKEDITOR.TRISTATE_DISABLED,r=CKEDITOR.TRISTATE_OFF;CKEDITOR.plugins.add("indentblock",{requires:"indent",init:function(a){function s(){l.specificDefinition.apply(this,arguments),this.allowedContent={"div h1 h2 h3 h4 h5 h6 ol p pre ul":{propertiesOnly:!0,styles:u?null:"margin-left,margin-right",classes:u||null}},this.contentTransformations=[["div: splitMarginShorthand"],["h1: splitMarginShorthand"],["h2: splitMarginShorthand"],["h3: splitMarginShorthand"],["h4: splitMarginShorthand"],["h5: splitMarginShorthand"],["h6: splitMarginShorthand"],["ol: splitMarginShorthand"],["p: splitMarginShorthand"],["pre: splitMarginShorthand"],["ul: splitMarginShorthand"]],this.enterBr&&(this.allowedContent.div=!0),this.requiredContent=(this.enterBr?"div":"p")+(u?"("+u.join(",")+")":"{margin-left}"),this.jobs={20:{refresh:function(e,o){if(!(a=o.block||o.blockLimit).is(n))var a=(s=a.getAscendant(n))&&o.contains(s)||a;if(a.is(n)&&(a=a.getParent()),this.enterBr||this.getContext(o)){if(u){var s=u,l=(a=a.$.className.match(this.classNameRegex),this.isIndent);return(s=a?!l||a[1]!=s.slice(-1):l)?r:i}return this.isIndent?r:a?CKEDITOR[0>=(parseInt(a.getStyle(t(a)),10)||0)?"TRISTATE_DISABLED":"TRISTATE_OFF"]:i}return i},exec:function(t){var n,i=(i=t.getSelection())&&i.getRanges()[0];if(n=t.elementPath().contains(o))e.call(this,n,u);else for(i=i.createIterator(),t=t.config.enterMode,i.enforceRealBlocks=!0,i.enlargeBr=t!=CKEDITOR.ENTER_BR;n=i.getNextParagraph(t==CKEDITOR.ENTER_P?"p":"div");)n.isReadOnly()||e.call(this,n,u);return!0}}}}var l=CKEDITOR.plugins.indent,u=a.config.indentClasses;l.registerCommands(a,{indentblock:new s(a,"indentblock",!0),outdentblock:new s(a,"outdentblock")}),CKEDITOR.tools.extend(s.prototype,l.specificDefinition.prototype,{context:{div:1,dl:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,ul:1,ol:1,p:1,pre:1,table:1},classNameRegex:u?new RegExp("(?:^|\\s+)("+u.join("|")+")(?=$|\\s)"):null})}})}(),function(){function e(e){function o(t){for(var o=i.startContainer,l=i.endContainer;o&&!o.getParent().equals(t);)o=o.getParent();for(;l&&!l.getParent().equals(t);)l=l.getParent();if(!o||!l)return!1;for(var u=[],c=!1;!c;)o.equals(l)&&(c=!0),u.push(o),o=o.getNext();if(1>u.length)return!1;for(o=t.getParents(!0),l=0;l<o.length;l++)if(o[l].getName&&s[o[l].getName()]){t=o[l];break}o=r.isIndent?1:-1,l=u[0],u=u[u.length-1];var d,f=(c=CKEDITOR.plugins.list.listToArray(t,a))[u.getCustomData("listarray_index")].indent;for(l=l.getCustomData("listarray_index");l<=u.getCustomData("listarray_index");l++)if(c[l].indent+=o,0<o){for(var h=c[l].parent,g=l-1;0<=g;g--)if(c[g].indent===o){h=c[g].parent;break}c[l].parent=new CKEDITOR.dom.element(h.getName(),h.getDocument())}for(l=u.getCustomData("listarray_index")+1;l<c.length&&c[l].indent>f;l++)c[l].indent+=o;if(o=CKEDITOR.plugins.list.arrayToList(c,a,null,e.config.enterMode,t.getDirection()),!r.isIndent&&(d=t.getParent())&&d.is("li")){var m,p=[];for(l=(u=o.listNode.getChildren()).count()-1;0<=l;l--)(m=u.getItem(l))&&m.is&&m.is("li")&&p.push(m)}if(o&&o.listNode.replace(t),p&&p.length)for(l=0;l<p.length;l++){for(m=t=p[l];(m=m.getNext())&&m.is&&m.getName()in s;)CKEDITOR.env.needsNbspFiller&&!t.getFirst(n)&&t.append(i.document.createText(" ")),t.append(m);t.insertAfter(d)}return o&&e.fire("contentDomInvalidated"),!0}for(var i,r=this,a=this.database,s=this.context,l=((l=e.getSelection())&&l.getRanges()).createIterator();i=l.getNextRange();){for(var u=i.getCommonAncestor();u&&(u.type!=CKEDITOR.NODE_ELEMENT||!s[u.getName()]);){if(e.editable().equals(u)){u=!1;break}u=u.getParent()}if(u||(u=i.startPath().contains(s))&&i.setEndAt(u,CKEDITOR.POSITION_BEFORE_END),!u){var c=i.getEnclosedNode();c&&c.type==CKEDITOR.NODE_ELEMENT&&c.getName()in s&&(i.setStartAt(c,CKEDITOR.POSITION_AFTER_START),i.setEndAt(c,CKEDITOR.POSITION_BEFORE_END),u=c)}if(u&&i.startContainer.type==CKEDITOR.NODE_ELEMENT&&i.startContainer.getName()in s&&((c=new CKEDITOR.dom.walker(i)).evaluator=t,i.startContainer=c.next()),u&&i.endContainer.type==CKEDITOR.NODE_ELEMENT&&i.endContainer.getName()in s&&((c=new CKEDITOR.dom.walker(i)).evaluator=t,i.endContainer=c.previous()),u)return o(u)}return 0}function t(e){return e.type==CKEDITOR.NODE_ELEMENT&&e.is("li")}function n(e){return o(e)&&i(e)}var o=CKEDITOR.dom.walker.whitespaces(!0),i=CKEDITOR.dom.walker.bookmark(!1,!0),r=CKEDITOR.TRISTATE_DISABLED,a=CKEDITOR.TRISTATE_OFF;CKEDITOR.plugins.add("indentlist",{requires:"indent",init:function(t){function n(t){o.specificDefinition.apply(this,arguments),this.requiredContent=["ul","ol"],t.on("key",(function(e){var n=t.elementPath();if("wysiwyg"==t.mode&&e.data.keyCode==this.indentKey&&n){var o=this.getContext(n);!o||this.isIndent&&CKEDITOR.plugins.indentList.firstItemInPath(this.context,n,o)||(t.execCommand(this.relatedGlobal),e.cancel())}}),this),this.jobs[this.isIndent?10:30]={refresh:this.isIndent?function(e,t){var n=this.getContext(t),o=CKEDITOR.plugins.indentList.firstItemInPath(this.context,t,n);return n&&this.isIndent&&!o?a:r}:function(e,t){return!this.getContext(t)||this.isIndent?r:a},exec:CKEDITOR.tools.bind(e,this)}}var o=CKEDITOR.plugins.indent;o.registerCommands(t,{indentlist:new n(t,"indentlist",!0),outdentlist:new n(t,"outdentlist")}),CKEDITOR.tools.extend(n.prototype,o.specificDefinition.prototype,{context:{ol:1,ul:1}})}}),CKEDITOR.plugins.indentList={},CKEDITOR.plugins.indentList.firstItemInPath=function(e,n,o){var i=n.contains(t);return o||(o=n.contains(e)),o&&i&&i.equals(o.getFirst(t))}}(),CKEDITOR.plugins.add("smiley",{requires:"dialog",init:function(e){e.config.smiley_path=e.config.smiley_path||this.path+"images/",e.addCommand("smiley",new CKEDITOR.dialogCommand("smiley",{allowedContent:"img[alt,height,!src,title,width]",requiredContent:"img"})),e.ui.addButton&&e.ui.addButton("Smiley",{label:e.lang.smiley.toolbar,command:"smiley",toolbar:"insert,50"}),CKEDITOR.dialog.add("smiley",this.path+"dialogs/smiley.js")}}),CKEDITOR.config.smiley_images="regular_smile.png sad_smile.png wink_smile.png teeth_smile.png confused_smile.png tongue_smile.png embarrassed_smile.png omg_smile.png whatchutalkingabout_smile.png angry_smile.png angel_smile.png shades_smile.png devil_smile.png cry_smile.png lightbulb.png thumbs_down.png thumbs_up.png heart.png broken_heart.png kiss.png envelope.png".split(" "),CKEDITOR.config.smiley_descriptions="smiley;sad;wink;laugh;frown;cheeky;blush;surprise;indecision;angry;angel;cool;devil;crying;enlightened;no;yes;heart;broken heart;kiss;mail".split(";"),function(){function e(e,t){var n;if(t=void 0===t||t)n=e.getComputedStyle("text-align");else{for(;(!e.hasAttribute||!e.hasAttribute("align")&&!e.getStyle("text-align"))&&(n=e.getParent());)e=n;n=e.getStyle("text-align")||e.getAttribute("align")||""}return n&&(n=n.replace(/(?:-(?:moz|webkit)-)?(?:start|auto)/i,"")),!n&&t&&(n="rtl"==e.getComputedStyle("direction")?"right":"left"),n}function t(e,t,n){this.editor=e,this.name=t,this.value=n,this.context="p",t=e.config.justifyClasses;var o=e.config.enterMode==CKEDITOR.ENTER_P?"p":"div";if(t){switch(n){case"left":this.cssClassName=t[0];break;case"center":this.cssClassName=t[1];break;case"right":this.cssClassName=t[2];break;case"justify":this.cssClassName=t[3]}this.cssClassRegex=new RegExp("(?:^|\\s+)(?:"+t.join("|")+")(?=$|\\s)"),this.requiredContent=o+"("+this.cssClassName+")"}else this.requiredContent=o+"{text-align}";this.allowedContent={"caption div h1 h2 h3 h4 h5 h6 p pre td th li":{propertiesOnly:!0,styles:this.cssClassName?null:"text-align",classes:this.cssClassName||null}},e.config.enterMode==CKEDITOR.ENTER_BR&&(this.allowedContent.div=!0)}function n(e){var t=e.editor,n=t.createRange();n.setStartBefore(e.data.node),n.setEndAfter(e.data.node);for(var o,i=new CKEDITOR.dom.walker(n);o=i.next();)if(o.type==CKEDITOR.NODE_ELEMENT)if(!o.equals(e.data.node)&&o.getDirection())n.setStartAfter(o),i=new CKEDITOR.dom.walker(n);else{var r=t.config.justifyClasses;r&&(o.hasClass(r[0])?(o.removeClass(r[0]),o.addClass(r[2])):o.hasClass(r[2])&&(o.removeClass(r[2]),o.addClass(r[0]))),"left"==(r=o.getStyle("text-align"))?o.setStyle("text-align","right"):"right"==r&&o.setStyle("text-align","left")}}t.prototype={exec:function(t){var n=t.getSelection(),o=t.config.enterMode;if(n){for(var i,r,a=n.createBookmarks(),s=n.getRanges(),l=this.cssClassName,u=void 0===(u=t.config.useComputedState)||u,c=s.length-1;0<=c;c--)for((i=s[c].createIterator()).enlargeBr=o!=CKEDITOR.ENTER_BR;r=i.getNextParagraph(o==CKEDITOR.ENTER_P?"p":"div");)if(!r.isReadOnly()){var d,f=r.getName();if(d=t.activeFilter.check(f+"{text-align}"),(f=t.activeFilter.check(f+"("+l+")"))||d){r.removeAttribute("align"),r.removeStyle("text-align");var h=l&&(r.$.className=CKEDITOR.tools.ltrim(r.$.className.replace(this.cssClassRegex,""))),g=this.state==CKEDITOR.TRISTATE_OFF&&(!u||e(r,!0)!=this.value);l&&f?g?r.addClass(l):h||r.removeAttribute("class"):g&&d&&r.setStyle("text-align",this.value)}}t.focus(),t.forceNextSelectionCheck(),n.selectBookmarks(a)}},refresh:function(t,n){var o=n.block||n.blockLimit,i=o.getName(),r=o.equals(t.editable());i=t.activeFilter.check(this.cssClassName?i+"("+this.cssClassName+")":i+"{text-align}"),r&&!CKEDITOR.dtd.$list[n.lastElement.getName()]?this.setState(CKEDITOR.TRISTATE_OFF):this.setState(!r&&i?e(o,this.editor.config.useComputedState)==this.value?CKEDITOR.TRISTATE_ON:CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED)}},CKEDITOR.plugins.add("justify",{init:function(e){if(!e.blockless){var o=new t(e,"justifyleft","left"),i=new t(e,"justifycenter","center"),r=new t(e,"justifyright","right"),a=new t(e,"justifyblock","justify");e.addCommand("justifyleft",o),e.addCommand("justifycenter",i),e.addCommand("justifyright",r),e.addCommand("justifyblock",a),e.ui.addButton&&(e.ui.addButton("JustifyLeft",{label:e.lang.common.alignLeft,command:"justifyleft",toolbar:"align,10"}),e.ui.addButton("JustifyCenter",{label:e.lang.common.center,command:"justifycenter",toolbar:"align,20"}),e.ui.addButton("JustifyRight",{label:e.lang.common.alignRight,command:"justifyright",toolbar:"align,30"}),e.ui.addButton("JustifyBlock",{label:e.lang.common.justify,command:"justifyblock",toolbar:"align,40"})),e.on("dirChanged",n)}}})}(),CKEDITOR.plugins.add("menubutton",{requires:"button,menu",onLoad:function(){var e=function(e){var t=this._,n=t.menu;t.state!==CKEDITOR.TRISTATE_DISABLED&&(t.on&&n?n.hide():(t.previousState=t.state,n||((n=t.menu=new CKEDITOR.menu(e,{panel:{className:"cke_menu_panel",attributes:{"aria-label":e.lang.common.options}}})).onHide=CKEDITOR.tools.bind((function(){var n=this.command?e.getCommand(this.command).modes:this.modes;this.setState(!n||n[e.mode]?t.previousState:CKEDITOR.TRISTATE_DISABLED),t.on=0}),this),this.onMenu&&n.addListener(this.onMenu)),this.setState(CKEDITOR.TRISTATE_ON),t.on=1,setTimeout((function(){n.show(CKEDITOR.document.getById(t.id),4)}),0)))};CKEDITOR.ui.menuButton=CKEDITOR.tools.createClass({base:CKEDITOR.ui.button,$:function(t){delete t.panel,this.base(t),this.hasArrow="menu",this.click=e},statics:{handler:{create:function(e){return new CKEDITOR.ui.menuButton(e)}}}})},beforeInit:function(e){e.ui.addHandler(CKEDITOR.UI_MENUBUTTON,CKEDITOR.ui.menuButton.handler)}}),CKEDITOR.UI_MENUBUTTON="menubutton",CKEDITOR.plugins.add("language",{requires:"menubutton",init:function(e){var t,n,o,i,r=e.config.language_list||["ar:Arabic:rtl","fr:French","es:Spanish"],a=this,s=e.lang.language,l={};for(e.addCommand("language",{allowedContent:"span[!lang,!dir]",requiredContent:"span[lang,dir]",contextSensitive:!0,exec:function(e,t){var n=l["language_"+t];n&&e[n.style.checkActive(e.elementPath(),e)?"removeStyle":"applyStyle"](n.style)},refresh:function(e){this.setState(a.getCurrentLangElement(e)?CKEDITOR.TRISTATE_ON:CKEDITOR.TRISTATE_OFF)}}),i=0;i<r.length;i++)t=r[i].split(":"),l[o="language_"+(n=t[0])]={label:t[1],langId:n,group:"language",order:i,ltr:"rtl"!=(""+t[2]).toLowerCase(),onClick:function(){e.execCommand("language",this.langId)},role:"menuitemcheckbox"},l[o].style=new CKEDITOR.style({element:"span",attributes:{lang:n,dir:l[o].ltr?"ltr":"rtl"}});l.language_remove={label:s.remove,group:"language_remove",state:CKEDITOR.TRISTATE_DISABLED,order:l.length,onClick:function(){var t=a.getCurrentLangElement(e);t&&e.execCommand("language",t.getAttribute("lang"))}},e.addMenuGroup("language",1),e.addMenuGroup("language_remove"),e.addMenuItems(l),e.ui.add("Language",CKEDITOR.UI_MENUBUTTON,{label:s.button,allowedContent:"span[!lang,!dir]",requiredContent:"span[lang,dir]",toolbar:"bidi,30",command:"language",onMenu:function(){var t,n={},o=a.getCurrentLangElement(e);for(t in l)n[t]=CKEDITOR.TRISTATE_OFF;return n.language_remove=o?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED,o&&(n["language_"+o.getAttribute("lang")]=CKEDITOR.TRISTATE_ON),n}}),e.addRemoveFormatFilter&&e.addRemoveFormatFilter((function(e){return!(e.is("span")&&e.getAttribute("dir")&&e.getAttribute("lang"))}))},getCurrentLangElement:function(e){var t,n=e.elementPath();if(e=n&&n.elements,n)for(var o=0;o<e.length;o++)n=e[o],!t&&"span"==n.getName()&&n.hasAttribute("dir")&&n.hasAttribute("lang")&&(t=n);return t}}),function(){function e(e){return e.replace(/'/g,"\\$&")}function t(e){for(var t,n=e.length,o=[],i=0;i<n;i++)t=e.charCodeAt(i),o.push(t);return"String.fromCharCode("+o.join(",")+")"}function n(t,n){for(var o,i,r=(a=t.plugins.link).compiledProtectionFunction.params,a=[a.compiledProtectionFunction.name,"("],s=0;s<r.length;s++)i=n[o=r[s].toLowerCase()],0<s&&a.push(","),a.push("'",i?e(encodeURIComponent(n[o])):"","'");return a.push(")"),a.join("")}CKEDITOR.plugins.add("link",{requires:"dialog,fakeobjects",onLoad:function(){function e(e){return n.replace(/%1/g,"rtl"==e?"right":"left").replace(/%2/g,"cke_contents_"+e)}var t="background:url("+CKEDITOR.getUrl(this.path+"images"+(CKEDITOR.env.hidpi?"/hidpi":"")+"/anchor.png")+") no-repeat %1 center;border:1px dotted #00f;background-size:16px;",n=".%2 a.cke_anchor,.%2 a.cke_anchor_empty,.cke_editable.%2 a[name],.cke_editable.%2 a[data-cke-saved-name]{"+t+"padding-%1:18px;cursor:auto;}.%2 img.cke_anchor{"+t+"width:16px;min-height:15px;height:1.15em;vertical-align:text-bottom;}";CKEDITOR.addCss(e("ltr")+e("rtl"))},init:function(e){var t="a[!href]";CKEDITOR.dialog.isTabEnabled(e,"link","advanced")&&(t=t.replace("]",",accesskey,charset,dir,id,lang,name,rel,tabindex,title,type,download]{*}(*)")),CKEDITOR.dialog.isTabEnabled(e,"link","target")&&(t=t.replace("]",",target,onclick]")),e.addCommand("link",new CKEDITOR.dialogCommand("link",{allowedContent:t,requiredContent:"a[href]"})),e.addCommand("anchor",new CKEDITOR.dialogCommand("anchor",{allowedContent:"a[!name,id]",requiredContent:"a[name]"})),e.addCommand("unlink",new CKEDITOR.unlinkCommand),e.addCommand("removeAnchor",new CKEDITOR.removeAnchorCommand),e.setKeystroke(CKEDITOR.CTRL+76,"link"),e.setKeystroke(CKEDITOR.CTRL+75,"link"),e.ui.addButton&&(e.ui.addButton("Link",{label:e.lang.link.toolbar,command:"link",toolbar:"links,10"}),e.ui.addButton("Unlink",{label:e.lang.link.unlink,command:"unlink",toolbar:"links,20"}),e.ui.addButton("Anchor",{label:e.lang.link.anchor.toolbar,command:"anchor",toolbar:"links,30"})),CKEDITOR.dialog.add("link",this.path+"dialogs/link.js"),CKEDITOR.dialog.add("anchor",this.path+"dialogs/anchor.js"),e.on("doubleclick",(function(t){var n=t.data.element.getAscendant({a:1,img:1},!0);n&&!n.isReadOnly()&&(n.is("a")?(t.data.dialog=!n.getAttribute("name")||n.getAttribute("href")&&n.getChildCount()?"link":"anchor",t.data.link=n):CKEDITOR.plugins.link.tryRestoreFakeAnchor(e,n)&&(t.data.dialog="anchor"))}),null,null,0),e.on("doubleclick",(function(t){t.data.dialog in{link:1,anchor:1}&&t.data.link&&e.getSelection().selectElement(t.data.link)}),null,null,20),e.addMenuItems&&e.addMenuItems({anchor:{label:e.lang.link.anchor.menu,command:"anchor",group:"anchor",order:1},removeAnchor:{label:e.lang.link.anchor.remove,command:"removeAnchor",group:"anchor",order:5},link:{label:e.lang.link.menu,command:"link",group:"link",order:1},unlink:{label:e.lang.link.unlink,command:"unlink",group:"link",order:5}}),e.contextMenu&&e.contextMenu.addListener((function(t){if(!t||t.isReadOnly())return null;if(!(t=CKEDITOR.plugins.link.tryRestoreFakeAnchor(e,t))&&!(t=CKEDITOR.plugins.link.getSelectedLink(e)))return null;var n={};return t.getAttribute("href")&&t.getChildCount()&&(n={link:CKEDITOR.TRISTATE_OFF,unlink:CKEDITOR.TRISTATE_OFF}),t&&t.hasAttribute("name")&&(n.anchor=n.removeAnchor=CKEDITOR.TRISTATE_OFF),n})),this.compiledProtectionFunction=function(e){var t;return(e=e.config.emailProtection||"")&&"encode"!=e&&(t={},e.replace(/^([^(]+)\(([^)]+)\)$/,(function(e,n,o){t.name=n,t.params=[],o.replace(/[^,\s]+/g,(function(e){t.params.push(e)}))}))),t}(e)},afterInit:function(e){e.dataProcessor.dataFilter.addRules({elements:{a:function(t){return t.attributes.name?t.children.length?null:e.createFakeParserElement(t,"cke_anchor","anchor"):null}}});var t=e._.elementsPath&&e._.elementsPath.filters;t&&t.push((function(t,n){if("a"==n&&(CKEDITOR.plugins.link.tryRestoreFakeAnchor(e,t)||t.getAttribute("name")&&(!t.getAttribute("href")||!t.getChildCount())))return"anchor"}))}});var o=/^javascript:/,i=/^(?:mailto)(?:(?!\?(subject|body)=).)+/i,r=/subject=([^;?:@&=$,\/]*)/i,a=/body=([^;?:@&=$,\/]*)/i,s=/^#(.*)$/,l=/^((?:http|https|ftp|news):\/\/)?(.*)$/,u=/^(_(?:self|top|parent|blank))$/,c=/^javascript:void\(location\.href='mailto:'\+String\.fromCharCode\(([^)]+)\)(?:\+'(.*)')?\)$/,d=/^javascript:([^(]+)\(([^)]+)\)$/,f=/\s*window.open\(\s*this\.href\s*,\s*(?:'([^']*)'|null)\s*,\s*'([^']*)'\s*\)\s*;\s*return\s*false;*\s*/,h=/(?:^|,)([^=]+)=(\d+|yes|no)/gi,g=/^tel:(.*)$/,m={id:"advId",dir:"advLangDir",accessKey:"advAccessKey",name:"advName",lang:"advLangCode",tabindex:"advTabIndex",title:"advTitle",type:"advContentType",class:"advCSSClasses",charset:"advCharset",style:"advStyles",rel:"advRel"};CKEDITOR.plugins.link={getSelectedLink:function(e,t){var n,o=e.getSelection(),i=o.getSelectedElement(),r=o.getRanges(),a=[];if(!t&&i&&i.is("a"))return i;for(i=0;i<r.length;i++)if((n=o.getRanges()[i]).shrink(CKEDITOR.SHRINK_ELEMENT,!0,{skipBogus:!0}),(n=e.elementPath(n.getCommonAncestor()).contains("a",1))&&t)a.push(n);else if(n)return n;return t?a:null},getEditorAnchors:function(e){for(var t,n=(o=(n=e.editable()).isInline()&&!e.plugins.divarea?e.document:n).getElementsByTag("a"),o=o.getElementsByTag("img"),i=[],r=0;t=n.getItem(r++);)(t.data("cke-saved-name")||t.hasAttribute("name"))&&i.push({name:t.data("cke-saved-name")||t.getAttribute("name"),id:t.getAttribute("id")});for(r=0;t=o.getItem(r++);)(t=this.tryRestoreFakeAnchor(e,t))&&i.push({name:t.getAttribute("name"),id:t.getAttribute("id")});return i},fakeAnchor:!0,tryRestoreFakeAnchor:function(e,t){if(t&&t.data("cke-real-element-type")&&"anchor"==t.data("cke-real-element-type")){var n=e.restoreRealElement(t);if(n.data("cke-saved-name"))return n}},parseLinkAttributes:function(e,t){var n,p=t&&(t.data("cke-saved-href")||t.getAttribute("href"))||"",v=e.plugins.link.compiledProtectionFunction,y=e.config.emailProtection,b={};if(p.match(o)&&("encode"==y?p=p.replace(c,(function(e,t,n){return n=n||"","mailto:"+String.fromCharCode.apply(String,t.split(","))+n.replace(/\\'/g,"'")})):y&&p.replace(d,(function(e,t,n){if(t==v.name){b.type="email",e=b.email={},t=/(^')|('$)/g;for(var o,i=(n=n.match(/[^,\s]+/g)).length,r=0;r<i;r++)o=decodeURIComponent(o=n[r].replace(t,"").replace(/\\'/g,"'")),e[v.params[r].toLowerCase()]=o;e.address=[e.name,e.domain].join("@")}}))),!b.type)if(y=p.match(s))b.type="anchor",b.anchor={},b.anchor.name=b.anchor.id=y[1];else if(y=p.match(g))b.type="tel",b.tel=y[1];else if(y=p.match(i)){n=p.match(r),p=p.match(a);var C=b.email={};b.type="email",C.address=y[0].replace("mailto:",""),n&&(C.subject=decodeURIComponent(n[1])),p&&(C.body=decodeURIComponent(p[1]))}else p&&(n=p.match(l))&&(b.type="url",b.url={},b.url.protocol=n[1],b.url.url=n[2]);if(t){if(p=t.getAttribute("target"))b.target={type:p.match(u)?p:"frame",name:p};else if(p=(p=t.data("cke-pa-onclick")||t.getAttribute("onclick"))&&p.match(f))for(b.target={type:"popup",name:p[1]};y=h.exec(p[2]);)"yes"!=y[2]&&"1"!=y[2]||y[1]in{height:1,width:1,top:1,left:1}?isFinite(y[2])&&(b.target[y[1]]=y[2]):b.target[y[1]]=!0;var T;for(T in null!==t.getAttribute("download")&&(b.download=!0),p={},m)(y=t.getAttribute(T))&&(p[m[T]]=y);(T=t.data("cke-saved-name")||p.advName)&&(p.advName=T),CKEDITOR.tools.isEmpty(p)||(b.advanced=p)}return b},getLinkAttributes:function(o,i){var r=o.config.emailProtection||"",a={};switch(i.type){case"url":r=i.url&&void 0!==i.url.protocol?i.url.protocol:"http://";var s=i.url&&CKEDITOR.tools.trim(i.url.url)||"";a["data-cke-saved-href"]=0===s.indexOf("/")?s:r+s;break;case"anchor":r=i.anchor&&i.anchor.id,a["data-cke-saved-href"]="#"+(i.anchor&&i.anchor.name||r||"");break;case"email":switch(s=(c=i.email).address,r){case"":case"encode":var l=encodeURIComponent(c.subject||""),u=encodeURIComponent(c.body||""),c=[];l&&c.push("subject="+l),u&&c.push("body="+u),c=c.length?"?"+c.join("&"):"","encode"==r?(r=["javascript:void(location.href='mailto:'+",t(s)],c&&r.push("+'",e(c),"'"),r.push(")")):r=["mailto:",s,c];break;default:r=s.split("@",2),c.name=r[0],c.domain=r[1],r=["javascript:",n(o,c)]}a["data-cke-saved-href"]=r.join("");break;case"tel":a["data-cke-saved-href"]="tel:"+i.tel}if(i.target)if("popup"==i.target.type){r=["window.open(this.href, '",i.target.name||"","', '"];var d="resizable status location toolbar menubar fullscreen scrollbars dependent".split(" ");for(s=d.length,l=function(e){i.target[e]&&d.push(e+"="+i.target[e])},c=0;c<s;c++)d[c]+=i.target[d[c]]?"=yes":"=no";l("width"),l("left"),l("height"),l("top"),r.push(d.join(","),"'); return false;"),a["data-cke-pa-onclick"]=r.join("")}else"notSet"!=i.target.type&&i.target.name&&(a.target=i.target.name);if(i.download&&(a.download=""),i.advanced){for(var f in m)(r=i.advanced[m[f]])&&(a[f]=r);a.name&&(a["data-cke-saved-name"]=a.name)}for(var h in a["data-cke-saved-href"]&&(a.href=a["data-cke-saved-href"]),f={target:1,onclick:1,"data-cke-pa-onclick":1,"data-cke-saved-name":1,download:1},i.advanced&&CKEDITOR.tools.extend(f,m),a)delete f[h];return{set:a,removed:CKEDITOR.tools.object.keys(f)}},showDisplayTextForElement:function(e,t){var n=t.getSelection();return!(t.widgets&&t.widgets.focused||n&&1<n.getRanges().length||e&&e.getName&&e.is({img:1,table:1,tbody:1,thead:1,tfoot:1,input:1,select:1,textarea:1}))}},CKEDITOR.unlinkCommand=function(){},CKEDITOR.unlinkCommand.prototype={exec:function(e){if(CKEDITOR.env.ie){var t,n=e.getSelection().getRanges()[0],o=n.getPreviousEditableNode()&&n.getPreviousEditableNode().getAscendant("a",!0)||n.getNextEditableNode()&&n.getNextEditableNode().getAscendant("a",!0);n.collapsed&&o&&(t=n.createBookmark(),n.selectNodeContents(o),n.select())}o=new CKEDITOR.style({element:"a",type:CKEDITOR.STYLE_INLINE,alwaysRemoveElement:1}),e.removeStyle(o),t&&(n.moveToBookmark(t),n.select())},refresh:function(e,t){var n=t.lastElement&&t.lastElement.getAscendant("a",!0);n&&"a"==n.getName()&&n.getAttribute("href")&&n.getChildCount()?this.setState(CKEDITOR.TRISTATE_OFF):this.setState(CKEDITOR.TRISTATE_DISABLED)},contextSensitive:1,startDisabled:1,requiredContent:"a[href]",editorFocus:1},CKEDITOR.removeAnchorCommand=function(){},CKEDITOR.removeAnchorCommand.prototype={exec:function(e){var t,n=e.getSelection(),o=n.createBookmarks();n&&(t=n.getSelectedElement())&&(t.getChildCount()?t.is("a"):CKEDITOR.plugins.link.tryRestoreFakeAnchor(e,t))?t.remove(1):(t=CKEDITOR.plugins.link.getSelectedLink(e))&&(t.hasAttribute("href")?(t.removeAttributes({name:1,"data-cke-saved-name":1}),t.removeClass("cke_anchor")):t.remove(1)),n.selectBookmarks(o)},requiredContent:"a[name]"},CKEDITOR.tools.extend(CKEDITOR.config,{linkShowAdvancedTab:!0,linkShowTargetTab:!0,linkDefaultProtocol:"http://"})}(),function(){function e(e,t,n,o){for(var i=CKEDITOR.plugins.list.listToArray(t.root,n),r=[],a=0;a<t.contents.length;a++)(c=(c=t.contents[a]).getAscendant("li",!0))&&!c.getCustomData("list_item_processed")&&(r.push(c),CKEDITOR.dom.element.setMarker(n,c,"list_item_processed",!0));var s,l,u,c=t.root.getDocument();for(a=0;a<r.length;a++){var d=r[a].getCustomData("listarray_index");(s=i[d].parent).is(this.type)||(l=c.createElement(this.type),s.copyAttributes(l,{start:1,type:1}),l.removeStyle("list-style-type"),i[d].parent=l)}for(i=(n=CKEDITOR.plugins.list.arrayToList(i,n,null,e.config.enterMode)).listNode.getChildCount(),a=0;a<i&&(u=n.listNode.getChild(a));a++)u.getName()==this.type&&o.push(u);n.listNode.replace(t.root),e.fire("contentDomInvalidated")}function t(e,t,n){var o,i,r=t.contents,a=t.root.getDocument(),s=[];if(1==r.length&&r[0].equals(t.root)){var l=a.createElement("div");r[0].moveChildren&&r[0].moveChildren(l),r[0].append(l),r[0]=l}for(t=t.contents[0].getParent(),l=0;l<r.length;l++)t=t.getCommonAncestor(r[l].getParent());for(e=void 0===(e=e.config.useComputedState)||e,l=0;l<r.length;l++)for(var u,c=r[l];u=c.getParent();){if(u.equals(t)){s.push(c),!i&&c.getDirection()&&(i=1),c=c.getDirection(e),null!==o&&(o=o&&o!=c?null:c);break}c=u}if(!(1>s.length)){for(r=s[s.length-1].getNext(),l=a.createElement(this.type),n.push(l);s.length;)n=s.shift(),e=a.createElement("li"),(c=n).is("pre")||g.test(c.getName())||"false"==c.getAttribute("contenteditable")?n.appendTo(e):(n.copyAttributes(e),o&&n.getDirection()&&(e.removeStyle("direction"),e.removeAttribute("dir")),n.moveChildren(e),n.remove()),e.appendTo(l);o&&i&&l.setAttribute("dir",o),r?l.insertBefore(r):l.appendTo(t)}}function n(e,t,n){function o(n){!(l=c[n?"getFirst":"getLast"]())||l.is&&l.isBlockBoundary()||!(u=t.root[n?"getPrevious":"getNext"](CKEDITOR.dom.walker.invisible(!0)))||u.is&&u.isBlockBoundary({br:1})||e.document.createElement("br")[n?"insertBefore":"insertAfter"](l)}for(var i=CKEDITOR.plugins.list.listToArray(t.root,n),r=[],a=0;a<t.contents.length;a++){var s=t.contents[a];(s=s.getAscendant("li",!0))&&!s.getCustomData("list_item_processed")&&(r.push(s),CKEDITOR.dom.element.setMarker(n,s,"list_item_processed",!0))}for(s=null,a=0;a<r.length;a++)i[s=r[a].getCustomData("listarray_index")].indent=-1;for(a=s+1;a<i.length;a++)if(i[a].indent>i[a-1].indent+1){for(r=i[a-1].indent+1-i[a].indent,s=i[a].indent;i[a]&&i[a].indent>=s;)i[a].indent+=r,a++;a--}var l,u,c=CKEDITOR.plugins.list.arrayToList(i,n,null,e.config.enterMode,t.root.getAttribute("dir")).listNode;o(!0),o(),c.replace(t.root),e.fire("contentDomInvalidated")}function o(e,t){this.name=e,this.context=this.type=t,this.allowedContent=t+" li",this.requiredContent=t}function i(e,t,n,o){for(var i,r;i=e[o?"getLast":"getFirst"](m);)(r=i.getDirection(1))!==t.getDirection(1)&&i.setAttribute("dir",r),i.remove(),n?i[o?"insertBefore":"insertAfter"](n):t.append(i,o),n=i}function r(e){function t(t){var n=e[t?"getPrevious":"getNext"](f);n&&n.type==CKEDITOR.NODE_ELEMENT&&n.is(e.getName())&&(i(e,n,null,!t),e.remove(),e=n)}t(),t(1)}function a(e){return e.type==CKEDITOR.NODE_ELEMENT&&(e.getName()in CKEDITOR.dtd.$block||e.getName()in CKEDITOR.dtd.$listItem)&&CKEDITOR.dtd[e.getName()]["#"]}function s(e,t,n){e.fire("saveSnapshot"),n.enlarge(CKEDITOR.ENLARGE_LIST_ITEM_CONTENTS);var o=n.extractContents();t.trim(!1,!0);var a=t.createBookmark(),s=(u=new CKEDITOR.dom.elementPath(t.startContainer)).block,u=u.lastElement.getAscendant("li",1)||s,c=(d=new CKEDITOR.dom.elementPath(n.startContainer)).contains(CKEDITOR.dtd.$listItem),d=d.contains(CKEDITOR.dtd.$list);for(s?(s=s.getBogus())&&s.remove():d&&(s=d.getPrevious(f))&&h(s)&&s.remove(),(s=o.getLast())&&s.type==CKEDITOR.NODE_ELEMENT&&s.is("br")&&s.remove(),(s=t.startContainer.getChild(t.startOffset))?o.insertBefore(s):t.startContainer.append(o),c&&(o=l(c))&&(u.contains(c)?(i(o,c.getParent(),c),o.remove()):u.append(o));n.checkStartOfBlock()&&n.checkEndOfBlock()&&(o=(d=n.startPath()).block);)o.is("li")&&(u=o.getParent(),o.equals(u.getLast(f))&&o.equals(u.getFirst(f))&&(o=u)),n.moveToPosition(o,CKEDITOR.POSITION_BEFORE_START),o.remove();n=n.clone(),o=e.editable(),n.setEndAt(o,CKEDITOR.POSITION_BEFORE_END),(n=new CKEDITOR.dom.walker(n)).evaluator=function(e){return f(e)&&!h(e)},(n=n.next())&&n.type==CKEDITOR.NODE_ELEMENT&&n.getName()in CKEDITOR.dtd.$list&&r(n),t.moveToBookmark(a),t.select(),e.fire("saveSnapshot")}function l(e){return(e=e.getLast(f))&&e.type==CKEDITOR.NODE_ELEMENT&&e.getName()in u?e:null}var u={ol:1,ul:1},c=CKEDITOR.dom.walker.whitespaces(),d=CKEDITOR.dom.walker.bookmark(),f=function(e){return!(c(e)||d(e))},h=CKEDITOR.dom.walker.bogus();CKEDITOR.plugins.list={listToArray:function(e,t,n,o,i){if(!u[e.getName()])return[];o||(o=0),n||(n=[]);for(var r=0,a=e.getChildCount();r<a;r++){var s=e.getChild(r);if(s.type==CKEDITOR.NODE_ELEMENT&&s.getName()in CKEDITOR.dtd.$list&&CKEDITOR.plugins.list.listToArray(s,t,n,o+1),"li"==s.$.nodeName.toLowerCase()){var l={parent:e,indent:o,element:s,contents:[]};i?l.grandparent=i:(l.grandparent=e.getParent(),l.grandparent&&"li"==l.grandparent.$.nodeName.toLowerCase()&&(l.grandparent=l.grandparent.getParent())),t&&CKEDITOR.dom.element.setMarker(t,s,"listarray_index",n.length),n.push(l);for(var c,d=0,f=s.getChildCount();d<f;d++)(c=s.getChild(d)).type==CKEDITOR.NODE_ELEMENT&&u[c.getName()]?CKEDITOR.plugins.list.listToArray(c,t,n,o+1,l.grandparent):l.contents.push(c)}}return n},arrayToList:function(e,t,n,o,i){if(n||(n=0),!e||e.length<n+1)return null;for(var r,a,s,l=e[n].parent.getDocument(),c=new CKEDITOR.dom.documentFragment(l),h=null,g=n,m=Math.max(e[n].indent,0),p=null,v=o==CKEDITOR.ENTER_P?"p":"div";;){var y=e[g];if(r=y.grandparent,a=y.element.getDirection(1),y.indent==m){for(h&&e[g].parent.getName()==h.getName()||(h=e[g].parent.clone(!1,1),i&&h.setAttribute("dir",i),c.append(h)),p=h.append(y.element.clone(0,1)),a!=h.getDirection(1)&&p.setAttribute("dir",a),r=0;r<y.contents.length;r++)p.append(y.contents[r].clone(1,1));g++}else if(y.indent==Math.max(m,0)+1)y=e[g-1].element.getDirection(1),g=CKEDITOR.plugins.list.arrayToList(e,null,g,o,y!=a?a:null),!p.getChildCount()&&CKEDITOR.env.needsNbspFiller&&7>=l.$.documentMode&&p.append(l.createText(" ")),p.append(g.listNode),g=g.nextIndex;else{if(-1!=y.indent||n||!r)return null;u[r.getName()]?(p=y.element.clone(!1,!0),a!=r.getDirection(1)&&p.setAttribute("dir",a)):p=new CKEDITOR.dom.documentFragment(l),h=r.getDirection(1)!=a;var b,C,T=y.element,x=T.getAttribute("class"),E=T.getAttribute("style"),_=p.type==CKEDITOR.NODE_DOCUMENT_FRAGMENT&&(o!=CKEDITOR.ENTER_BR||h||E||x),I=y.contents.length;for(r=0;r<I;r++)if(d(b=y.contents[r])&&1<I)_?C=b.clone(1,1):p.append(b.clone(1,1));else if(b.type==CKEDITOR.NODE_ELEMENT&&b.isBlockBoundary()){h&&!b.getDirection()&&b.setAttribute("dir",a),s=b;var D=T.getAttribute("style");D&&s.setAttribute("style",D.replace(/([^;])$/,"$1;")+(s.getAttribute("style")||"")),x&&b.addClass(x),s=null,C&&(p.append(C),C=null),p.append(b.clone(1,1))}else _?(s||(s=l.createElement(v),p.append(s),h&&s.setAttribute("dir",a)),E&&s.setAttribute("style",E),x&&s.setAttribute("class",x),C&&(s.append(C),C=null),s.append(b.clone(1,1))):p.append(b.clone(1,1));C&&((s||p).append(C),C=null),p.type==CKEDITOR.NODE_DOCUMENT_FRAGMENT&&g!=e.length-1&&(CKEDITOR.env.needsBrFiller&&(a=p.getLast())&&a.type==CKEDITOR.NODE_ELEMENT&&a.is("br")&&a.remove(),(a=p.getLast(f))&&a.type==CKEDITOR.NODE_ELEMENT&&a.is(CKEDITOR.dtd.$block)||p.append(l.createElement("br"))),"div"!=(a=p.$.nodeName.toLowerCase())&&"p"!=a||p.appendBogus(),c.append(p),h=null,g++}if(s=null,e.length<=g||Math.max(e[g].indent,0)<m)break}if(t)for(e=c.getFirst();e;){if(e.type==CKEDITOR.NODE_ELEMENT&&(CKEDITOR.dom.element.clearMarkers(t,e),e.getName()in CKEDITOR.dtd.$listItem&&(l=i=o=void 0,o=(n=e).getDirection()))){for(i=n.getParent();i&&!(l=i.getDirection());)i=i.getParent();o==l&&n.removeAttribute("dir")}e=e.getNextSourceNode()}return{listNode:c,nextIndex:g}}};var g=/^h[1-6]$/,m=CKEDITOR.dom.walker.nodeType(CKEDITOR.NODE_ELEMENT);o.prototype={exec:function(o){function i(e){return u[e.root.getName()]&&!function(e,t){return CKEDITOR.tools.array.filter(e.getChildren().toArray(),(function(e){return-1===CKEDITOR.tools.array.indexOf(t,e.type)})).length}(e.root,[CKEDITOR.NODE_COMMENT])}function a(e){var t=!0;return 0!==e.getChildCount()&&(e.forEach((function(e){if(e.type!==CKEDITOR.NODE_COMMENT)return t=!1}),null,!0),t)}this.refresh(o,o.elementPath());var s=o.config,l=o.getSelection(),c=l&&l.getRanges();if(this.state==CKEDITOR.TRISTATE_OFF)if((h=o.editable()).getFirst(f)){var d=1==c.length&&c[0];(s=d&&d.getEnclosedNode())&&s.is&&this.type==s.getName()&&this.setState(CKEDITOR.TRISTATE_ON)}else s.enterMode==CKEDITOR.ENTER_BR?h.appendBogus():c[0].fixBlock(1,s.enterMode==CKEDITOR.ENTER_P?"p":"div"),l.selectRanges(c);s=l.createBookmarks(!0);for(var h=[],g={},m=(c=c.createIterator(),0);(d=c.getNextRange())&&++m;){var p=d.getBoundaryNodes(),v=p.endNode;for((b=p.startNode).type==CKEDITOR.NODE_ELEMENT&&"td"==b.getName()&&d.setStartAt(p.startNode,CKEDITOR.POSITION_AFTER_START),v.type==CKEDITOR.NODE_ELEMENT&&"td"==v.getName()&&d.setEndAt(p.endNode,CKEDITOR.POSITION_BEFORE_END),(d=d.createIterator()).forceBrBreak=this.state==CKEDITOR.TRISTATE_OFF;p=d.getNextParagraph();)if(!p.getCustomData("list_block")&&!a(p)){CKEDITOR.dom.element.setMarker(g,p,"list_block",1);for(var y,b=(C=o.elementPath(p)).elements,C=(v=0,C.blockLimit),T=b.length-1;0<=T&&(y=b[T]);T--)if(u[y.getName()]&&C.contains(y)){C.removeCustomData("list_group_object_"+m),(b=y.getCustomData("list_group_object"))?b.contents.push(p):(h.push(b={root:y,contents:[p]}),CKEDITOR.dom.element.setMarker(g,y,"list_group_object",b)),v=1;break}v||((v=C).getCustomData("list_group_object_"+m)?v.getCustomData("list_group_object_"+m).contents.push(p):(b={root:v,contents:[p]},CKEDITOR.dom.element.setMarker(g,v,"list_group_object_"+m,b),h.push(b)))}}for(y=[];0<h.length;)b=h.shift(),this.state==CKEDITOR.TRISTATE_OFF?i(b)||(u[b.root.getName()]?e.call(this,o,b,g,y):t.call(this,o,b,y)):this.state==CKEDITOR.TRISTATE_ON&&u[b.root.getName()]&&!i(b)&&n.call(this,o,b,g);for(T=0;T<y.length;T++)r(y[T]);CKEDITOR.dom.element.clearAllMarkers(g),l.selectBookmarks(s),o.focus()},refresh:function(e,t){var n=t.contains(u,1);n&&(t.blockLimit||t.root).contains(n)?this.setState(n.is(this.type)?CKEDITOR.TRISTATE_ON:CKEDITOR.TRISTATE_OFF):this.setState(CKEDITOR.TRISTATE_OFF)}},CKEDITOR.plugins.add("list",{requires:"indentlist",init:function(e){e.blockless||(e.addCommand("numberedlist",new o("numberedlist","ol")),e.addCommand("bulletedlist",new o("bulletedlist","ul")),e.ui.addButton&&(e.ui.addButton("NumberedList",{label:e.lang.list.numberedlist,command:"numberedlist",directional:!0,toolbar:"list,10"}),e.ui.addButton("BulletedList",{label:e.lang.list.bulletedlist,command:"bulletedlist",directional:!0,toolbar:"list,20"})),e.on("key",(function(t){var n,o=t.data.domEvent.getKey();if("wysiwyg"==e.mode&&o in{8:1,46:1}){var i=e.getSelection().getRanges()[0],r=i&&i.startPath();if(i&&i.collapsed){var c,d=8==o,g=e.editable(),m=new CKEDITOR.dom.walker(i.clone());if(m.evaluator=function(e){return f(e)&&!h(e)},m.guard=function(e,t){return!(t&&e.type==CKEDITOR.NODE_ELEMENT&&e.is("table"))},o=i.clone(),d)if((c=r.contains(u))&&i.checkBoundaryOfElement(c,CKEDITOR.START)&&(c=c.getParent())&&c.is("li")&&(c=l(c))?(n=c,c=c.getPrevious(f),o.moveToPosition(c&&h(c)?c:n,CKEDITOR.POSITION_BEFORE_START)):(m.range.setStartAt(g,CKEDITOR.POSITION_AFTER_START),m.range.setEnd(i.startContainer,i.startOffset),(c=m.previous())&&c.type==CKEDITOR.NODE_ELEMENT&&(c.getName()in u||c.is("li"))&&(c.is("li")||(m.range.selectNodeContents(c),m.reset(),m.evaluator=a,c=m.previous()),o.moveToElementEditEnd(n=c),o.moveToPosition(o.endPath().block,CKEDITOR.POSITION_BEFORE_END))),n)s(e,o,i),t.cancel();else{var p=r.contains(u);p&&i.checkBoundaryOfElement(p,CKEDITOR.START)&&(n=p.getFirst(f),i.checkBoundaryOfElement(n,CKEDITOR.START)&&(c=p.getPrevious(f),l(n)?c&&(i.moveToElementEditEnd(c),i.select()):e.execCommand("outdent"),t.cancel()))}else if(n=r.contains("li")){if(m.range.setEndAt(g,CKEDITOR.POSITION_BEFORE_END),d=(g=n.getLast(f))&&a(g)?g:n,r=0,(c=m.next())&&c.type==CKEDITOR.NODE_ELEMENT&&c.getName()in u&&c.equals(g)?(r=1,c=m.next()):i.checkBoundaryOfElement(d,CKEDITOR.END)&&(r=2),r&&c){if((i=i.clone()).moveToElementEditStart(c),1==r&&(o.optimize(),!o.startContainer.equals(n))){for(n=o.startContainer;n.is(CKEDITOR.dtd.$inline);)p=n,n=n.getParent();p&&o.moveToPosition(p,CKEDITOR.POSITION_AFTER_END)}2==r&&(o.moveToPosition(o.endPath().block,CKEDITOR.POSITION_BEFORE_END),i.endPath().block&&i.moveToPosition(i.endPath().block,CKEDITOR.POSITION_AFTER_START)),s(e,o,i),t.cancel()}}else m.range.setEndAt(g,CKEDITOR.POSITION_BEFORE_END),(c=m.next())&&c.type==CKEDITOR.NODE_ELEMENT&&c.is(u)&&(c=c.getFirst(f),r.block&&i.checkStartOfBlock()&&i.checkEndOfBlock()?(r.block.remove(),i.moveToElementEditStart(c),i.select()):l(c)?(i.moveToElementEditStart(c),i.select()):((i=i.clone()).moveToElementEditStart(c),s(e,o,i)),t.cancel());setTimeout((function(){e.selectionChange(1)}))}}})))}})}(),CKEDITOR.plugins.liststyle={requires:"dialog,contextmenu",init:function(e){var t;e.blockless||(t=new CKEDITOR.dialogCommand("numberedListStyle",{requiredContent:"ol",allowedContent:"ol{list-style-type}[start]; li{list-style-type}[value]",contentTransformations:[["ol: listTypeToStyle"]]}),t=e.addCommand("numberedListStyle",t),e.addFeature(t),CKEDITOR.dialog.add("numberedListStyle",this.path+"dialogs/liststyle.js"),t=new CKEDITOR.dialogCommand("bulletedListStyle",{requiredContent:"ul",allowedContent:"ul{list-style-type}",contentTransformations:[["ul: listTypeToStyle"]]}),t=e.addCommand("bulletedListStyle",t),e.addFeature(t),CKEDITOR.dialog.add("bulletedListStyle",this.path+"dialogs/liststyle.js"),e.addMenuGroup("list",108),e.addMenuItems({numberedlist:{label:e.lang.liststyle.numberedTitle,group:"list",command:"numberedListStyle"},bulletedlist:{label:e.lang.liststyle.bulletedTitle,group:"list",command:"bulletedListStyle"}}),e.contextMenu.addListener((function(e){if(!e||e.isReadOnly())return null;for(;e;){var t=e.getName();if("ol"==t)return{numberedlist:CKEDITOR.TRISTATE_OFF};if("ul"==t)return{bulletedlist:CKEDITOR.TRISTATE_OFF};e=e.getParent()}return null})))}},CKEDITOR.plugins.add("liststyle",CKEDITOR.plugins.liststyle),function(){function e(e,t,n){return d(t)&&d(n)&&n.equals(t.getNext((function(e){return!(q(e)||j(e)||f(e))})))}function t(e){this.upper=e[0],this.lower=e[1],this.set.apply(this,e.slice(2))}function n(e){var t=e.element;if(t&&d(t)&&(t=t.getAscendant(e.triggers,!0))&&e.editable.contains(t)){var n=a(t);if("true"==n.getAttribute("contenteditable"))return t;if(n.is(e.triggers))return n}return null}function o(e,t,n){return b(e,t),b(e,n),n=n.size.top,(e=t.size.bottom)&&n?0|(e+n)/2:e||n}function i(e,t,n){return t[n?"getPrevious":"getNext"]((function(t){return t&&t.type==CKEDITOR.NODE_TEXT&&!q(t)||d(t)&&!f(t)&&!c(e,t)}))}function r(e,t,n){return e>t&&e<n}function a(e,t){if(e.data("cke-editable"))return null;for(t||(e=e.getParent());e&&!e.data("cke-editable");){if(e.hasAttribute("contenteditable"))return e;e=e.getParent()}return null}function s(e){var t=e.doc,n=_('<span contenteditable="false" data-cke-magic-line="1" style="'+H+"position:absolute;border-top:1px dashed "+e.boxColor+'"></span>',t),o=CKEDITOR.getUrl(this.path+"images/"+(I.hidpi?"hidpi/":"")+"icon"+(e.rtl?"-rtl":"")+".png");for(x(n,{attach:function(){return this.wrap.getParent()||this.wrap.appendTo(e.editable,!0),this},lineChildren:[x(_('<span title="'+e.editor.lang.magicline.title+'" contenteditable="false">&#8629;</span>',t),{base:H+"height:17px;width:17px;"+(e.rtl?"left":"right")+":17px;background:url("+o+") center no-repeat "+e.boxColor+";cursor:pointer;"+(I.hc?"font-size: 15px;line-height:14px;border:1px solid #fff;text-align:center;":"")+(I.hidpi?"background-size: 9px 10px;":""),looks:["top:-8px; border-radius: 2px;","top:-17px; border-radius: 2px 2px 0px 0px;","top:-1px; border-radius: 0px 0px 2px 2px;"]}),x(_($,t),{base:W+"left:0px;border-left-color:"+e.boxColor+";",looks:["border-width:8px 0 8px 8px;top:-8px","border-width:8px 0 0 8px;top:-8px","border-width:0 0 8px 8px;top:0px"]}),x(_($,t),{base:W+"right:0px;border-right-color:"+e.boxColor+";",looks:["border-width:8px 8px 8px 0;top:-8px","border-width:8px 8px 0 0;top:-8px","border-width:0 8px 8px 0;top:0px"]})],detach:function(){return this.wrap.getParent()&&this.wrap.remove(),this},mouseNear:function(){b(e,this);var t=e.holdDistance,n=this.size;return!!(n&&r(e.mouse.y,n.top-t,n.bottom+t)&&r(e.mouse.x,n.left-t,n.right+t))},place:function(){var t=e.view,n=e.editable,o=e.trigger,i=o.upper,a=o.lower,s=i||a,l=s.getParent(),u={};for(var c in this.trigger=o,i&&b(e,i,!0),a&&b(e,a,!0),b(e,l,!0),e.inInlineMode&&C(e,!0),l.equals(n)?(u.left=t.scroll.x,u.right=-t.scroll.x,u.width=""):(u.left=s.size.left-s.size.margin.left+t.scroll.x-(e.inInlineMode?t.editable.left+t.editable.border.left:0),u.width=s.size.outerWidth+s.size.margin.left+s.size.margin.right+t.scroll.x,u.right=""),i&&a?u.top=i.size.margin.bottom===a.size.margin.top?0|i.size.bottom+i.size.margin.bottom/2:i.size.margin.bottom<a.size.margin.top?i.size.bottom+i.size.margin.bottom:i.size.bottom+i.size.margin.bottom-a.size.margin.top:i?a||(u.top=i.size.bottom+i.size.margin.bottom):u.top=a.size.top-a.size.margin.top,o.is(N)||r(u.top,t.scroll.y-15,t.scroll.y+5)?(u.top=e.inInlineMode?0:t.scroll.y,this.look(N)):o.is(M)||r(u.top,t.pane.bottom-5,t.pane.bottom+15)?(u.top=e.inInlineMode?t.editable.height+t.editable.padding.top+t.editable.padding.bottom:t.pane.bottom-1,this.look(M)):(e.inInlineMode&&(u.top-=t.editable.top+t.editable.border.top),this.look(K)),e.inInlineMode&&(u.top--,u.top+=t.editable.scroll.top,u.left+=t.editable.scroll.left),u)u[c]=CKEDITOR.tools.cssLength(u[c]);this.setStyles(u)},look:function(e){if(this.oldLook!=e){for(var t,n=this.lineChildren.length;n--;)(t=this.lineChildren[n]).setAttribute("style",t.base+t.looks[0|e/2]);this.oldLook=e}},wrap:new E("span",e.doc)}),t=n.lineChildren.length;t--;)n.lineChildren[t].appendTo(n);n.look(K),n.appendTo(n.wrap),n.unselectable(),n.lineChildren[0].on("mouseup",(function(t){n.detach(),l(e,(function(t){var n=e.line.trigger;t[n.is(R)?"insertBefore":"insertAfter"](n.is(R)?n.lower:n.upper)}),!0),e.editor.focus(),I.ie||e.enterMode==CKEDITOR.ENTER_BR||e.hotNode.scrollIntoView(),t.data.preventDefault(!0)})),n.on("mousedown",(function(e){e.data.preventDefault(!0)})),e.line=n}function l(e,t,n){var o,i=new CKEDITOR.dom.range(e.doc),r=e.editor;I.ie&&e.enterMode==CKEDITOR.ENTER_BR?o=e.doc.createText(P):(o=(o=a(e.element,!0))&&o.data("cke-enter-mode")||e.enterMode,(o=new E(w[o],e.doc)).is("br")||e.doc.createText(P).appendTo(o)),n&&r.fire("saveSnapshot"),t(o),i.moveToPosition(o,CKEDITOR.POSITION_AFTER_START),r.getSelection().selectRanges([i]),e.hotNode=o,n&&r.fire("saveSnapshot")}function u(e,t){return{canUndo:!0,modes:{wysiwyg:1},exec:function(){function o(n){var o=I.ie&&9>I.version?" ":P,i=e.hotNode&&e.hotNode.getText()==o&&e.element.equals(e.hotNode)&&e.lastCmdDirection===!!t;l(e,(function(o){i&&e.hotNode&&e.hotNode.remove(),o[t?"insertAfter":"insertBefore"](n),o.setAttributes({"data-cke-magicline-hot":1,"data-cke-magicline-dir":!!t}),e.lastCmdDirection=!!t})),I.ie||e.enterMode==CKEDITOR.ENTER_BR||e.hotNode.scrollIntoView(),e.line.detach()}return function(r){var s,l;r=(r=r.getSelection().getStartElement()).getAscendant(z,1),m(e,r)||!r||r.equals(e.editable)||r.contains(e.editable)||((s=a(r))&&"false"==s.getAttribute("contenteditable")&&(r=s),e.element=r,d(s=i(e,r,!t))&&s.is(e.triggers)&&s.is(F)&&(!i(e,s,!t)||(l=i(e,s,!t))&&d(l)&&l.is(e.triggers))?o(s):d(l=n(e))&&(i(e,l,!t)?(r=i(e,l,!t))&&d(r)&&r.is(e.triggers)&&o(l):o(l)))}}()}}function c(e,t){if(!t||t.type!=CKEDITOR.NODE_ELEMENT||!t.$)return!1;var n=e.line;return n.wrap.equals(t)||n.wrap.contains(t)}function d(e){return e&&e.type==CKEDITOR.NODE_ELEMENT&&e.$}function f(e){return!!d(e)&&((t=h(e))||(t=!(!d(e)||!(t={left:1,right:1,center:1})[e.getComputedStyle("float")]&&!t[e.getAttribute("align")])),t);var t}function h(e){return!!{absolute:1,fixed:1}[e.getComputedStyle("position")]}function g(e,t){return d(t)?t.is(e.triggers):null}function m(e,t){if(!t)return!1;for(var n=t.getParents(1),o=n.length;o--;)for(var i=e.tabuList.length;i--;)if(n[o].hasAttribute(e.tabuList[i]))return!0;return!1}function p(e){var n=e.editable,o=e.mouse,i=e.view,a=e.triggerOffset;C(e);var s=o.y>(e.inInlineMode?i.editable.top+i.editable.height/2:Math.min(i.editable.height,i.pane.height)/2);return(n=n[s?"getLast":"getFirst"]((function(e){return!(q(e)||j(e))})))?(c(e,n)&&(n=e.line.wrap[s?"getPrevious":"getNext"]((function(e){return!(q(e)||j(e))}))),d(n)&&!f(n)&&g(e,n)?(b(e,n),!s&&0<=n.size.top&&r(o.y,0,n.size.top+a)?new t([null,n,R,A,e=e.inInlineMode||0===i.scroll.y?N:K]):s&&n.size.bottom<=i.pane.height&&r(o.y,n.size.bottom-a,i.pane.height)?(e=e.inInlineMode||r(n.size.bottom,i.pane.height-a,i.pane.height)?M:K,new t([n,null,S,A,e])):null):null):null}function v(e){var o=e.mouse,a=e.view,s=e.triggerOffset,l=n(e);if(!l)return null;b(e,l),s=Math.min(s,0|l.size.outerHeight/2);var u,c,h=[];if(r(o.y,l.size.top-1,l.size.top+s))c=!1;else{if(!r(o.y,l.size.bottom-s,l.size.bottom+1))return null;c=!0}if(f(l)||function(e,t,n){return!!(t=t[n?"getLast":"getFirst"]((function(t){return e.isRelevant(t)&&!t.is(B)})))&&(b(e,t),n?t.size.top>e.mouse.y:t.size.bottom<e.mouse.y)}(e,l,c)||l.getParent().is(L))return null;var m=i(e,l,!c);if(m){if(m&&m.type==CKEDITOR.NODE_TEXT)return null;if(d(m)){if(f(m)||!g(e,m)||m.getParent().is(L))return null;h=[m,l][c?"reverse":"concat"]().concat([k,A])}}else l.equals(e.editable[c?"getLast":"getFirst"](e.isRelevant))?(C(e),c&&r(o.y,l.size.bottom-s,a.pane.height)&&r(l.size.bottom,a.pane.height-s,a.pane.height)?u=M:r(o.y,0,l.size.top+s)&&(u=N)):u=K,h=[null,l][c?"reverse":"concat"]().concat([c?S:R,A,u,l.equals(e.editable[c?"getLast":"getFirst"](e.isRelevant))?c?M:N:K]);return 0 in h?new t(h):null}function y(e,t,n,o){for(var i=t.getDocumentPosition(),r={},a={},s={},l={},u=X.length;u--;)r[X[u]]=parseInt(t.getComputedStyle.call(t,"border-"+X[u]+"-width"),10)||0,s[X[u]]=parseInt(t.getComputedStyle.call(t,"padding-"+X[u]),10)||0,a[X[u]]=parseInt(t.getComputedStyle.call(t,"margin-"+X[u]),10)||0;return n&&!o||T(e,o),l.top=i.y-(n?0:e.view.scroll.y),l.left=i.x-(n?0:e.view.scroll.x),l.outerWidth=t.$.offsetWidth,l.outerHeight=t.$.offsetHeight,l.height=l.outerHeight-(s.top+s.bottom+r.top+r.bottom),l.width=l.outerWidth-(s.left+s.right+r.left+r.right),l.bottom=l.top+l.outerHeight,l.right=l.left+l.outerWidth,e.inInlineMode&&(l.scroll={top:t.$.scrollTop,left:t.$.scrollLeft}),x({border:r,padding:s,margin:a,ignoreScroll:n},l,!0)}function b(e,t,n){if(!d(t))return t.size=null;if(t.size){if(t.size.ignoreScroll==n&&t.size.date>new Date-V)return null}else t.size={};return x(t.size,y(e,t,n),{date:+new Date},!0)}function C(e,t){e.view.editable=y(e,e.editable,t,!0)}function T(e,t){e.view||(e.view={});var n=e.view;if(!(!t&&n&&n.date>new Date-V)){n=(o=e.win).getScrollPosition();var o=o.getViewPaneSize();x(e.view,{scroll:{x:n.x,y:n.y,width:e.doc.$.documentElement.scrollWidth-o.width,height:e.doc.$.documentElement.scrollHeight-o.height},pane:{width:o.width,height:o.height,bottom:o.height+n.y},date:+new Date},!0)}}CKEDITOR.plugins.add("magicline",{init:function(e){var o,r,a,g=e.config,b=g.magicline_triggerOffset||30,E={editor:e,enterMode:g.enterMode,triggerOffset:b,holdDistance:0|b*(g.magicline_holdDistance||.5),boxColor:g.magicline_color||"#ff0000",rtl:"rtl"==g.contentsLangDirection,tabuList:["data-cke-hidden-sel"].concat(g.magicline_tabuList||[]),triggers:g.magicline_everywhere?z:{table:1,hr:1,div:1,ul:1,ol:1,dl:1,form:1,blockquote:1},isRelevant:function(e){return d(e)&&!c(E,e)&&!f(e)}};e.on("contentDom",(function(){var d=e.editable(),f=e.document,b=e.window;x(E,{editable:d,inInlineMode:d.isInline(),doc:f,win:b,hotNode:null},!0),E.boundary=E.inInlineMode?E.editable:E.doc.getDocumentElement(),d.is(O.$inline)||(E.inInlineMode&&!h(d)&&d.setStyles({position:"relative",top:null,left:null}),s.call(this,E),T(E),d.attachListener(e,"beforeUndoImage",(function(){E.line.detach()})),d.attachListener(e,"beforeGetData",(function(){E.line.wrap.getParent()&&(E.line.detach(),e.once("getData",(function(){E.line.attach()}),null,null,1e3))}),null,null,0),d.attachListener(E.inInlineMode?f:f.getWindow().getFrame(),"mouseout",(function(t){if("wysiwyg"==e.mode)if(E.inInlineMode){var n=t.data.$.clientX;t=t.data.$.clientY,T(E),C(E,!0);var o=E.view.editable,i=E.view.scroll;n>o.left-i.x&&n<o.right-i.x&&t>o.top-i.y&&t<o.bottom-i.y||(clearTimeout(a),a=null,E.line.detach())}else clearTimeout(a),a=null,E.line.detach()})),d.attachListener(d,"keyup",(function(){E.hiddenMode=0})),d.attachListener(d,"keydown",(function(t){if("wysiwyg"==e.mode)switch(t.data.getKeystroke()){case 2228240:case 16:E.hiddenMode=1,E.line.detach()}})),d.attachListener(E.inInlineMode?d:f,"mousemove",(function(t){if(r=!0,"wysiwyg"==e.mode&&!e.readOnly&&!a){var n={x:t.data.$.clientX,y:t.data.$.clientY};a=setTimeout((function(){E.mouse=n,a=E.trigger=null,T(E),r&&!E.hiddenMode&&e.focusManager.hasFocus&&!E.line.mouseNear()&&(E.element=U(E,!0))&&((E.trigger=p(E)||v(E)||G(E))&&!m(E,E.trigger.upper||E.trigger.lower)?E.line.attach().place():(E.trigger=null,E.line.detach()),r=!1)}),30)}})),d.attachListener(b,"scroll",(function(){"wysiwyg"==e.mode&&(E.line.detach(),I.webkit&&(E.hiddenMode=1,clearTimeout(o),o=setTimeout((function(){E.mouseDown||(E.hiddenMode=0)}),50)))})),d.attachListener(D?f:b,"mousedown",(function(){"wysiwyg"==e.mode&&(E.line.detach(),E.hiddenMode=1,E.mouseDown=1)})),d.attachListener(D?f:b,"mouseup",(function(){E.hiddenMode=0,E.mouseDown=0})),e.addCommand("accessPreviousSpace",u(E)),e.addCommand("accessNextSpace",u(E,!0)),e.setKeystroke([[g.magicline_keystrokePrevious,"accessPreviousSpace"],[g.magicline_keystrokeNext,"accessNextSpace"]]),e.on("loadSnapshot",(function(){var t,n,o,i;for(i in{p:1,br:1,div:1})for(o=(t=e.document.getElementsByTag(i)).count();o--;)if((n=t.getItem(o)).data("cke-magicline-hot"))return E.hotNode=n,void(E.lastCmdDirection="true"===n.data("cke-magicline-dir"))})),e._.magiclineBackdoor={accessFocusSpace:l,boxTrigger:t,isLine:c,getAscendantTrigger:n,getNonEmptyNeighbour:i,getSize:y,that:E,triggerEdge:v,triggerEditable:p,triggerExpand:G})}),this)}});var x=CKEDITOR.tools.extend,E=CKEDITOR.dom.element,_=E.createFromHtml,I=CKEDITOR.env,D=CKEDITOR.env.ie&&9>CKEDITOR.env.version,O=CKEDITOR.dtd,w={},R=128,S=64,k=32,A=16,N=4,M=2,K=1,P=" ",L=O.$listItem,B=O.$tableContent,F=x({},O.$nonEditable,O.$empty),z=O.$block,V=100,H="width:0px;height:0px;padding:0px;margin:0px;display:block;z-index:9999;color:#fff;position:absolute;font-size: 0px;line-height:0px;",W=H+"border-color:transparent;display:block;border-style:solid;",$="<span>"+P+"</span>";w[CKEDITOR.ENTER_BR]="br",w[CKEDITOR.ENTER_P]="p",w[CKEDITOR.ENTER_DIV]="div",t.prototype={set:function(e,t,n){return this.properties=e+t+(n||K),this},is:function(e){return(this.properties&e)==e}};var U=function(){function e(e,t){var n=e.$.elementFromPoint(t.x,t.y);return n&&n.nodeType?new CKEDITOR.dom.element(n):null}return function(t,n,o){if(!t.mouse)return null;var i=t.doc,r=t.line.wrap,a=e(i,o=o||t.mouse);return n&&c(t,a)&&(r.hide(),a=e(i,o),r.show()),!a||a.type!=CKEDITOR.NODE_ELEMENT||!a.$||I.ie&&9>I.version&&!t.boundary.equals(a)&&!t.boundary.contains(a)?null:a}}(),q=CKEDITOR.dom.walker.whitespaces(),j=CKEDITOR.dom.walker.nodeType(CKEDITOR.NODE_COMMENT),G=function(){function n(n){var a,s,l;if(!d(g=n.element)||g.contains(n.editable)||g.isReadOnly())return null;if(l=function(e,n,o,i){for(var r=i,a=i,s=0,l=!1,u=!1,c=e.view.pane.height,d=e.mouse;d.y+s<c&&0<d.y-s&&(l||(l=n(r,i)),u||(u=n(a,i)),!l&&0<d.y-s&&(r=o(e,{x:d.x,y:d.y-s})),!u&&d.y+s<c&&(a=o(e,{x:d.x,y:d.y+s})),!l||!u);)s+=2;return new t([r,a,null,null])}(n,(function(e,t){return!t.equals(e)}),(function(e,t){return U(e,!0,t)}),g),e(0,a=l.upper,s=l.lower))return l.set(k,8);if(a&&g.contains(a))for(;!a.getParent().equals(g);)a=a.getParent();else a=g.getFirst((function(e){return i(n,e)}));if(s&&g.contains(s))for(;!s.getParent().equals(g);)s=s.getParent();else s=g.getLast((function(e){return i(n,e)}));if(!a||!s)return null;if(b(n,a),b(n,s),!r(n.mouse.y,a.size.top,s.size.bottom))return null;for(var u,c,f,h,g=Number.MAX_VALUE;s&&!s.equals(a)&&(c=a.getNext(n.isRelevant));)(u=Math.abs(o(n,a,c)-n.mouse.y))<g&&(g=u,f=a,h=c),b(n,a=c);return f&&h&&r(n.mouse.y,f.size.top,h.size.bottom)?(l.upper=f,l.lower=h,l.set(k,8)):null}function i(e,t){return!(t&&t.type==CKEDITOR.NODE_TEXT||j(t)||f(t)||c(e,t)||t.type==CKEDITOR.NODE_ELEMENT&&t.$&&t.is("br"))}return function(t){var o,i=n(t);if(o=i){var r=i.lower;o=!(!(o=i.upper)||!r||f(r)||f(o)||r.equals(o)||o.equals(r)||r.contains(o)||o.contains(r)||!(g(t,o)&&g(t,r)&&e(0,o,r)))}return o?i:null}}(),X=["top","left","right","bottom"]}(),CKEDITOR.config.magicline_keystrokePrevious=CKEDITOR.CTRL+CKEDITOR.SHIFT+51,CKEDITOR.config.magicline_keystrokeNext=CKEDITOR.CTRL+CKEDITOR.SHIFT+52,function(){function e(e){if(!e||e.type!=CKEDITOR.NODE_ELEMENT||"form"!=e.getName())return[];for(var t=[],n=["style","className"],o=0;o<n.length;o++){var i=e.$.elements.namedItem(n[o]);i&&(i=new CKEDITOR.dom.element(i),t.push([i,i.nextSibling]),i.remove())}return t}function t(e,t){if(e&&e.type==CKEDITOR.NODE_ELEMENT&&"form"==e.getName()&&0<t.length)for(var n=t.length-1;0<=n;n--){var o=t[n][0],i=t[n][1];i?o.insertBefore(i):o.appendTo(e)}}function n(n,o){var i=e(n),r={},a=n.$;return o||(r.class=a.className||"",a.className=""),r.inline=a.style.cssText||"",o||(a.style.cssText="position: static; overflow: visible"),t(i),r}function o(n,o){var i=e(n),r=n.$;"class"in o&&(r.className=o.class),"inline"in o&&(r.style.cssText=o.inline),t(i)}function i(e){if(!e.editable().isInline()){var t,n=CKEDITOR.instances;for(t in n){var o=n[t];"wysiwyg"!=o.mode||o.readOnly||((o=o.document.getBody()).setAttribute("contentEditable",!1),o.setAttribute("contentEditable",!0))}e.editable().hasFocus&&(e.toolbox.focus(),e.focus())}}CKEDITOR.plugins.add("maximize",{init:function(e){function t(){var t=c.getViewPaneSize();e.resize(t.width,t.height,null,!0)}if(e.elementMode!=CKEDITOR.ELEMENT_MODE_INLINE){var r,a,s,l=e.lang,u=CKEDITOR.document,c=u.getWindow(),d=CKEDITOR.TRISTATE_OFF;e.addCommand("maximize",{modes:{wysiwyg:!CKEDITOR.env.iOS,source:!CKEDITOR.env.iOS},readOnly:1,editorFocus:!1,exec:function(){var f=e.container.getFirst((function(e){return e.type==CKEDITOR.NODE_ELEMENT&&e.hasClass("cke_inner")})),h=e.ui.space("contents");if("wysiwyg"==e.mode){var g=e.getSelection();r=g&&g.getRanges(),a=c.getScrollPosition()}else{var m=e.editable().$;r=!CKEDITOR.env.ie&&[m.selectionStart,m.selectionEnd],a=[m.scrollLeft,m.scrollTop]}if(this.state==CKEDITOR.TRISTATE_OFF){for(c.on("resize",t),s=c.getScrollPosition(),g=e.container;g=g.getParent();)g.setCustomData("maximize_saved_styles",n(g)),g.setStyle("z-index",e.config.baseFloatZIndex-5);h.setCustomData("maximize_saved_styles",n(h,!0)),f.setCustomData("maximize_saved_styles",n(f,!0)),h={overflow:CKEDITOR.env.webkit?"":"hidden",width:0,height:0},u.getDocumentElement().setStyles(h),!CKEDITOR.env.gecko&&u.getDocumentElement().setStyle("position","fixed"),CKEDITOR.env.gecko&&CKEDITOR.env.quirks||u.getBody().setStyles(h),CKEDITOR.env.ie?setTimeout((function(){c.$.scrollTo(0,0)}),0):c.$.scrollTo(0,0),f.setStyle("position",CKEDITOR.env.gecko&&CKEDITOR.env.quirks?"fixed":"absolute"),f.setStyles({"z-index":e.config.baseFloatZIndex-5,left:"0px",top:"0px"}),f.addClass("cke_maximized"),t(),h=f.getDocumentPosition(),f.setStyles({left:-1*h.x+"px",top:-1*h.y+"px"}),CKEDITOR.env.gecko&&i(e)}else if(this.state==CKEDITOR.TRISTATE_ON){c.removeListener("resize",t),g=[h,f];for(var p=0;p<g.length;p++)o(g[p],g[p].getCustomData("maximize_saved_styles")),g[p].removeCustomData("maximize_saved_styles");for(g=e.container;g=g.getParent();)o(g,g.getCustomData("maximize_saved_styles")),g.removeCustomData("maximize_saved_styles");CKEDITOR.env.ie?setTimeout((function(){c.$.scrollTo(s.x,s.y)}),0):c.$.scrollTo(s.x,s.y),f.removeClass("cke_maximized"),CKEDITOR.env.webkit&&(f.setStyle("display","inline"),setTimeout((function(){f.setStyle("display","block")}),0)),e.fire("resize",{outerHeight:e.container.$.offsetHeight,contentsHeight:h.$.offsetHeight,outerWidth:e.container.$.offsetWidth})}this.toggleState(),(g=this.uiItems[0])&&(h=this.state==CKEDITOR.TRISTATE_OFF?l.maximize.maximize:l.maximize.minimize,(g=CKEDITOR.document.getById(g._.id)).getChild(1).setHtml(h),g.setAttribute("title",h),g.setAttribute("href",'javascript:void("'+h+'");')),"wysiwyg"==e.mode?r?(CKEDITOR.env.gecko&&i(e),e.getSelection().selectRanges(r),(m=e.getSelection().getStartElement())&&m.scrollIntoView(!0)):c.$.scrollTo(a.x,a.y):(r&&(m.selectionStart=r[0],m.selectionEnd=r[1]),m.scrollLeft=a[0],m.scrollTop=a[1]),r=a=null,d=this.state,e.fire("maximize",this.state)},canUndo:!1}),e.ui.addButton&&e.ui.addButton("Maximize",{label:l.maximize.maximize,command:"maximize",toolbar:"tools,10"}),e.on("mode",(function(){var t=e.getCommand("maximize");t.setState(t.state==CKEDITOR.TRISTATE_DISABLED?CKEDITOR.TRISTATE_DISABLED:d)}),null,null,100)}}})}(),CKEDITOR.plugins.add("newpage",{init:function(e){e.addCommand("newpage",{modes:{wysiwyg:1,source:1},exec:function(e){var t=this;e.setData(e.config.newpage_html||"",(function(){e.focus(),setTimeout((function(){e.fire("afterCommandExec",{name:"newpage",command:t}),e.selectionChange()}),200)}))},async:!0}),e.ui.addButton&&e.ui.addButton("NewPage",{label:e.lang.newpage.toolbar,command:"newpage",toolbar:"document,20"})}}),function(){function e(e){return{"aria-label":e,class:"cke_pagebreak",contenteditable:"false","data-cke-display-name":"pagebreak","data-cke-pagebreak":1,style:"page-break-after: always",title:e}}CKEDITOR.plugins.add("pagebreak",{requires:"fakeobjects",onLoad:function(){var e=("background:url("+CKEDITOR.getUrl(this.path+"images/pagebreak.gif")+") no-repeat center center;clear:both;width:100%;border-top:#999 1px dotted;border-bottom:#999 1px dotted;padding:0;height:7px;cursor:default;").replace(/;/g," !important;");CKEDITOR.addCss("div.cke_pagebreak{"+e+"}")},init:function(e){e.blockless||(e.addCommand("pagebreak",CKEDITOR.plugins.pagebreakCmd),e.ui.addButton&&e.ui.addButton("PageBreak",{label:e.lang.pagebreak.toolbar,command:"pagebreak",toolbar:"insert,70"}),CKEDITOR.env.webkit&&e.on("contentDom",(function(){e.document.on("click",(function(t){(t=t.data.getTarget()).is("div")&&t.hasClass("cke_pagebreak")&&e.getSelection().selectElement(t)}))})))},afterInit:function(t){function n(n){CKEDITOR.tools.extend(n.attributes,e(t.lang.pagebreak.alt),!0),n.children.length=0}var o,i=(o=t.dataProcessor)&&o.dataFilter,r=/page-break-after\s*:\s*always/i,a=/display\s*:\s*none/i;(o=o&&o.htmlFilter)&&o.addRules({attributes:{class:function(e,t){var n=e.replace("cke_pagebreak","");if(n!=e){var o=CKEDITOR.htmlParser.fragment.fromHtml('<span style="display: none;">&nbsp;</span>').children[0];t.children.length=0,t.add(o),delete(o=t.attributes)["aria-label"],delete o.contenteditable,delete o.title}return n}}},{applyToAll:!0,priority:5}),i&&i.addRules({elements:{div:function(e){if(e.attributes["data-cke-pagebreak"])n(e);else if(r.test(e.attributes.style)){var t=e.children[0];t&&"span"==t.name&&a.test(t.attributes.style)&&n(e)}}}})}}),CKEDITOR.plugins.pagebreakCmd={exec:function(e){e.insertElement(CKEDITOR.plugins.pagebreak.createElement(e))},context:"div",allowedContent:{div:{styles:"!page-break-after"},span:{match:function(e){return(e=e.parent)&&"div"==e.name&&e.styles&&e.styles["page-break-after"]},styles:"display"}},requiredContent:"div{page-break-after}"},CKEDITOR.plugins.pagebreak={createElement:function(t){return t.document.createElement("div",{attributes:e(t.lang.pagebreak.alt)})}}}(),function(){var e={canUndo:!1,async:!0,exec:function(e,t){var n=e.lang,o=CKEDITOR.tools.keystrokeToString(n.common.keyboard,e.getCommandKeystroke(CKEDITOR.env.ie?e.commands.paste:this)),i=t&&void 0!==t.notification?t.notification:!t||!t.from||"keystrokeHandler"===t.from&&CKEDITOR.env.ie;n=i&&"string"==typeof i?i:n.pastetext.pasteNotification.replace(/%1/,'<kbd aria-label="'+o.aria+'">'+o.display+"</kbd>"),e.execCommand("paste",{type:"text",notification:!!i&&n})}};CKEDITOR.plugins.add("pastetext",{requires:"clipboard",init:function(t){var n=CKEDITOR.env.safari?CKEDITOR.CTRL+CKEDITOR.ALT+CKEDITOR.SHIFT+86:CKEDITOR.CTRL+CKEDITOR.SHIFT+86;t.addCommand("pastetext",e),t.setKeystroke(n,"pastetext"),CKEDITOR.plugins.clipboard.addPasteButton(t,"PasteText",{label:t.lang.pastetext.button,command:"pastetext",toolbar:"clipboard,40"}),t.config.forcePasteAsPlainText&&t.on("beforePaste",(function(e){"html"!=e.data.type&&(e.data.type="text")})),t.on("pasteState",(function(e){t.getCommand("pastetext").setState(e.data)}))}})}(),function(){function e(e,n){var o,i,r=0;if(!CKEDITOR.tools.array.isArray(e)||0===e.length)return!0;if(0<(o=CKEDITOR.tools.array.filter(e,(function(e){return-1===CKEDITOR.tools.array.indexOf(t,e)}))).length)for(i=0;i<o.length;i++)!function(e){CKEDITOR.scriptLoader.queue(e,(function(i){i&&t.push(e),++r===o.length&&n()}))}(o[i]);return 0===o.length}var t=[],n=CKEDITOR.tools.createClass({$:function(){this.handlers=[]},proto:{register:function(e){"number"!=typeof e.priority&&(e.priority=10),this.handlers.push(e)},addPasteListener:function(t){t.on("paste",(function(n){var o=function(e,t){return CKEDITOR.tools.array.filter(e,(function(e){return e.canHandle(t)})).sort((function(e,t){return e.priority===t.priority?0:e.priority-t.priority}))}(this.handlers,n);if(0!==o.length){if(!e(function(e){var t=CKEDITOR.tools.array.reduce(e,(function(e,t){return CKEDITOR.tools.array.isArray(t.filters)?e.concat(t.filters):e}),[]);return CKEDITOR.tools.array.filter(t,(function(e,n){return CKEDITOR.tools.array.indexOf(t,e)===n}))}(o),(function(){return t.fire("paste",n.data)})))return n.cancel();!function e(t,n){var o=t.shift();o&&o.handle(n,(function(){e(t,n)}))}(o,n)}}),this,null,3)}}});CKEDITOR.plugins.add("pastetools",{requires:"clipboard",beforeInit:function(e){e.pasteTools=new n,e.pasteTools.addPasteListener(e)}}),CKEDITOR.plugins.pastetools={filters:{},loadFilters:e,createFilter:function(e){var t=CKEDITOR.tools.array.isArray(e.rules)?e.rules:[e.rules],n=e.additionalTransforms;return function(e,o){var i,r=new CKEDITOR.htmlParser.basicWriter,a=new CKEDITOR.htmlParser.filter;return n&&(e=n(e,o)),CKEDITOR.tools.array.forEach(t,(function(t){a.addRules(t(e,o,a))})),i=CKEDITOR.htmlParser.fragment.fromHtml(e),a.applyTo(i),i.writeHtml(r),r.getHtml()}},getClipboardData:function(e,t){var n;return CKEDITOR.plugins.clipboard.isCustomDataTypesSupported||"text/html"===t?(n=e.dataTransfer.getData(t,!0))||"text/html"!==t?n:e.dataValue:null},getConfigValue:function(e,t){if(e&&e.config){var n=CKEDITOR.tools,o=e.config,i=n.object.keys(o),r=["pasteTools_"+t,"pasteFromWord_"+t,"pasteFromWord"+n.capitalize(t,!0)];return o[r=n.array.find(r,(function(e){return-1!==n.array.indexOf(i,e)}))]}}},CKEDITOR.pasteFilters={}}(),CKEDITOR.plugins.add("pastefromgdocs",{requires:"pastetools",init:function(e){var t=CKEDITOR.plugins.getPath("pastetools"),n=this.path;e.pasteTools.register({filters:[CKEDITOR.getUrl(t+"filter/common.js"),CKEDITOR.getUrl(n+"filter/default.js")],canHandle:function(e){return/id=(\"|\')?docs\-internal\-guid\-/.test(e.data.dataValue)},handle:function(t,n){var o=t.data,i=CKEDITOR.plugins.pastetools.getClipboardData(o,"text/html");o.dontFilter=!0,o.dataValue=CKEDITOR.pasteFilters.gdocs(i,e),!0===e.config.forcePasteAsPlainText&&(o.type="text"),n()}})}}),CKEDITOR.plugins.add("pastefromword",{requires:"pastetools",init:function(e){var t=0,n=CKEDITOR.plugins.getPath("pastetools"),o=this.path,i=void 0===e.config.pasteFromWord_inlineImages||e.config.pasteFromWord_inlineImages;n=[CKEDITOR.getUrl(n+"filter/common.js"),CKEDITOR.getUrl(o+"filter/default.js")],e.addCommand("pastefromword",{canUndo:!1,async:!0,exec:function(e,n){t=1,e.execCommand("paste",{type:"html",notification:!n||void 0===n.notification||n.notification})}}),CKEDITOR.plugins.clipboard.addPasteButton(e,"PasteFromWord",{label:e.lang.pastefromword.toolbar,command:"pastefromword",toolbar:"clipboard,50"}),e.pasteTools.register({filters:e.config.pasteFromWordCleanupFile?[e.config.pasteFromWordCleanupFile]:n,canHandle:function(e){var n=/(class=\"?Mso|style=(?:\"|\')[^\"]*?\bmso\-|w:WordDocument|<o:\w+>|<\/font>)/;return n=/<meta\s*name=(?:\"|\')?generator(?:\"|\')?\s*content=(?:\"|\')?microsoft/gi.test(e=e.data.dataValue)||n.test(e),e&&(t||n)},handle:function(n,o){var i=n.data,r=CKEDITOR.plugins.pastetools.getClipboardData(i,"text/html"),a=CKEDITOR.plugins.pastetools.getClipboardData(i,"text/rtf");(!1!==e.fire("pasteFromWord",r={dataValue:r,dataTransfer:{"text/rtf":a}})||t)&&(i.dontFilter=!0,(t||!e.config.pasteFromWordPromptCleanup||confirm(e.lang.pastefromword.confirmCleanup))&&(r.dataValue=CKEDITOR.cleanWord(r.dataValue,e),e.fire("afterPasteFromWord",r),i.dataValue=r.dataValue,!0===e.config.forcePasteAsPlainText?i.type="text":CKEDITOR.plugins.clipboard.isCustomCopyCutSupported||"allow-word"!==e.config.forcePasteAsPlainText||(i.type="html")),t=0,o())}}),CKEDITOR.plugins.clipboard.isCustomDataTypesSupported&&i&&e.on("afterPasteFromWord",(function(e){var t,n=CKEDITOR.plugins.pastefromword&&CKEDITOR.plugins.pastefromword.images,o=[];if(n&&e.editor.filter.check("img[src]")&&0!==(t=n.extractTagsFromHtml(e.data.dataValue)).length&&0!==(n=n.extractFromRtf(e.data.dataTransfer["text/rtf"])).length&&(CKEDITOR.tools.array.forEach(n,(function(e){o.push(e.type?"data:"+e.type+";base64,"+CKEDITOR.tools.convertBytesToBase64(CKEDITOR.tools.convertHexStringToBytes(e.hex)):null)}),this),t.length===o.length))for(n=0;n<t.length;n++)0===t[n].indexOf("file://")&&o[n]&&(e.data.dataValue=e.data.dataValue.replace(t[n],o[n]))}))}}),i={modes:{wysiwyg:1,source:1},canUndo:!1,readOnly:1,exec:function(e){var t,n,r=(a=e.config).baseHref?'<base href="'+a.baseHref+'"/>':"";if(a.fullPage)t=e.getData().replace(/<head>/,"$&"+r).replace(/[^>]*(?=<\/title>)/,"$& &mdash; "+e.lang.preview.preview);else{var a="<body ";(l=e.document&&e.document.getBody())&&(l.getAttribute("id")&&(a+='id="'+l.getAttribute("id")+'" '),l.getAttribute("class")&&(a+='class="'+l.getAttribute("class")+'" ')),a+=">",t=e.config.docType+'<html dir="'+e.config.contentsLangDirection+'"><head>'+r+"<title>"+e.lang.preview.preview+"</title>"+CKEDITOR.tools.buildStyleHtml(e.config.contentsCss)+"</head>"+a+e.getData()+"</body></html>"}r=640,a=420,l=80;try{var s=window.screen,l=(r=Math.round(.8*s.width),a=Math.round(.7*s.height),Math.round(.1*s.width))}catch(i){}return!1!==e.fire("contentPreview",e={dataValue:t})&&(s="",CKEDITOR.env.ie&&(window._cke_htmlToLoad=e.dataValue,n="javascript:void( (function(){document.open();"+("("+CKEDITOR.tools.fixDomain+")();").replace(/\/\/.*?\n/g,"").replace(/parent\./g,"window.opener.")+"document.write( window.opener._cke_htmlToLoad );document.close();window.opener._cke_htmlToLoad = null;})() )",s=""),CKEDITOR.env.gecko&&(window._cke_htmlToLoad=e.dataValue,s=CKEDITOR.getUrl(o+"preview.html")),s=window.open(s,null,"toolbar=yes,location=no,status=yes,menubar=yes,scrollbars=yes,resizable=yes,width="+r+",height="+a+",left="+l),CKEDITOR.env.ie&&s&&(s.location=n),CKEDITOR.env.ie||CKEDITOR.env.gecko||((n=s.document).open(),n.write(e.dataValue),n.close()),!0)}},CKEDITOR.plugins.add("preview",{init:function(e){e.elementMode!=CKEDITOR.ELEMENT_MODE_INLINE&&(o=this.path,e.addCommand("preview",i),e.ui.addButton&&e.ui.addButton("Preview",{label:e.lang.preview.preview,command:"preview",toolbar:"document,40"}))}}),CKEDITOR.plugins.add("print",{init:function(e){e.elementMode!=CKEDITOR.ELEMENT_MODE_INLINE&&(e.addCommand("print",CKEDITOR.plugins.print),e.ui.addButton&&e.ui.addButton("Print",{label:e.lang.print.toolbar,command:"print",toolbar:"document,50"}))}}),CKEDITOR.plugins.print={exec:function(e){CKEDITOR.env.gecko?e.window.$.print():e.document.$.execCommand("Print")},canUndo:!1,readOnly:1,modes:{wysiwyg:1}},CKEDITOR.plugins.add("removeformat",{init:function(e){e.addCommand("removeFormat",CKEDITOR.plugins.removeformat.commands.removeformat),e.ui.addButton&&e.ui.addButton("RemoveFormat",{label:e.lang.removeformat.toolbar,command:"removeFormat",toolbar:"cleanup,10"})}}),CKEDITOR.plugins.removeformat={commands:{removeformat:{exec:function(e){for(var t,n=e._.removeFormatRegex||(e._.removeFormatRegex=new RegExp("^(?:"+e.config.removeFormatTags.replace(/,/g,"|")+")$","i")),o=e._.removeAttributes||(e._.removeAttributes=e.config.removeFormatAttributes.split(",")),i=CKEDITOR.plugins.removeformat.filter,r=e.getSelection().getRanges().createIterator(),a=function(e){return e.type==CKEDITOR.NODE_ELEMENT},s=[];t=r.getNextRange();){var l=t.createBookmark();(t=e.createRange()).setStartBefore(l.startNode),l.endNode&&t.setEndAfter(l.endNode),t.collapsed||t.enlarge(CKEDITOR.ENLARGE_ELEMENT);var u=t.createBookmark(),c=u.startNode,d=u.endNode,f=function(t){for(var o,r=e.elementPath(t),a=r.elements,s=1;(o=a[s])&&!o.equals(r.block)&&!o.equals(r.blockLimit);s++)n.test(o.getName())&&i(e,o)&&t.breakParent(o)};if(f(c),d)for(f(d),c=c.getNextSourceNode(!0,CKEDITOR.NODE_ELEMENT);c&&!c.equals(d);)if(c.isReadOnly()){if(c.getPosition(d)&CKEDITOR.POSITION_CONTAINS)break;c=c.getNext(a)}else f=c.getNextSourceNode(!1,CKEDITOR.NODE_ELEMENT),"img"==c.getName()&&c.data("cke-realelement")||c.hasAttribute("data-cke-bookmark")||!i(e,c)||(n.test(c.getName())?c.remove(1):(c.removeAttributes(o),e.fire("removeFormatCleanup",c))),c=f;u.startNode.remove(),u.endNode&&u.endNode.remove(),t.moveToBookmark(l),s.push(t)}e.forceNextSelectionCheck(),e.getSelection().selectRanges(s)}}},filter:function(e,t){for(var n=e._.removeFormatFilters||[],o=0;o<n.length;o++)if(!1===n[o](t))return!1;return!0}},CKEDITOR.editor.prototype.addRemoveFormatFilter=function(e){this._.removeFormatFilters||(this._.removeFormatFilters=[]),this._.removeFormatFilters.push(e)},CKEDITOR.config.removeFormatTags="b,big,cite,code,del,dfn,em,font,i,ins,kbd,q,s,samp,small,span,strike,strong,sub,sup,tt,u,var",CKEDITOR.config.removeFormatAttributes="class,style,lang,width,height,align,hspace,valign",function(){var e={readOnly:1,modes:{wysiwyg:1,source:1},exec:function(t){if(t.fire("save")&&(t=t.element.$.form))try{t.submit()}catch(e){t.submit.click&&t.submit.click()}}};CKEDITOR.plugins.add("save",{init:function(t){t.elementMode==CKEDITOR.ELEMENT_MODE_REPLACE&&(t.addCommand("save",e).startDisabled=!t.element.$.form,t.ui.addButton&&t.ui.addButton("Save",{label:t.lang.save.toolbar,command:"save",toolbar:"document,10"}))}})}(),CKEDITOR.plugins.add("selectall",{init:function(e){e.addCommand("selectAll",{modes:{wysiwyg:1,source:1},exec:function(e){var t=e.editable();if(t.is("textarea"))e=t.$,CKEDITOR.env.ie&&e.createTextRange?e.createTextRange().execCommand("SelectAll"):(e.selectionStart=0,e.selectionEnd=e.value.length),e.focus();else{if(t.is("body"))e.document.$.execCommand("SelectAll",!1,null);else{var n=e.createRange();n.selectNodeContents(t),n.select()}e.forceNextSelectionCheck(),e.selectionChange()}},canUndo:!1}),e.ui.addButton&&e.ui.addButton("SelectAll",{label:e.lang.selectall.toolbar,command:"selectAll",toolbar:"selection,10"})}}),function(){var e={readOnly:1,preserveState:!0,editorFocus:!1,exec:function(e){this.toggleState(),this.refresh(e)},refresh:function(e){if(e.document){var t=this.state!=CKEDITOR.TRISTATE_ON||e.elementMode==CKEDITOR.ELEMENT_MODE_INLINE&&!e.focusManager.hasFocus?"removeClass":"attachClass";e.editable()[t]("cke_show_blocks")}}};CKEDITOR.plugins.add("showblocks",{onLoad:function(){var e,t,n,o,i,r,a="p div pre address blockquote h1 h2 h3 h4 h5 h6".split(" "),s=CKEDITOR.getUrl(this.path),l=!(CKEDITOR.env.ie&&9>CKEDITOR.env.version),u=l?":not([contenteditable=false]):not(.cke_show_blocks_off)":"";for(e=t=n=o="";i=a.pop();)e+=".cke_show_blocks "+i+u+(r=a.length?",":""),n+=".cke_show_blocks.cke_contents_ltr "+i+u+r,o+=".cke_show_blocks.cke_contents_rtl "+i+u+r,t+=".cke_show_blocks "+i+u+"{background-image:url("+CKEDITOR.getUrl(s+"images/block_"+i+".png")+")}";CKEDITOR.addCss((e+"{background-repeat:no-repeat;border:1px dotted gray;padding-top:8px}").concat(t,n+"{background-position:top left;padding-left:8px}",o+"{background-position:top right;padding-right:8px}")),l||CKEDITOR.addCss(".cke_show_blocks [contenteditable=false],.cke_show_blocks .cke_show_blocks_off{border:none;padding-top:0;background-image:none}.cke_show_blocks.cke_contents_rtl [contenteditable=false],.cke_show_blocks.cke_contents_rtl .cke_show_blocks_off{padding-right:0}.cke_show_blocks.cke_contents_ltr [contenteditable=false],.cke_show_blocks.cke_contents_ltr .cke_show_blocks_off{padding-left:0}")},init:function(t){function n(){o.refresh(t)}if(!t.blockless){var o=t.addCommand("showblocks",e);o.canUndo=!1,t.config.startupOutlineBlocks&&o.setState(CKEDITOR.TRISTATE_ON),t.ui.addButton&&t.ui.addButton("ShowBlocks",{label:t.lang.showblocks.toolbar,command:"showblocks",toolbar:"tools,20"}),t.on("mode",(function(){o.state!=CKEDITOR.TRISTATE_DISABLED&&o.refresh(t)})),t.elementMode==CKEDITOR.ELEMENT_MODE_INLINE&&(t.on("focus",n),t.on("blur",n)),t.on("contentDom",(function(){o.state!=CKEDITOR.TRISTATE_DISABLED&&o.refresh(t)}))}}})}(),function(){var e={preserveState:!0,editorFocus:!1,readOnly:1,exec:function(e){this.toggleState(),this.refresh(e)},refresh:function(e){if(e.document){var t=this.state==CKEDITOR.TRISTATE_ON?"attachClass":"removeClass";e.editable()[t]("cke_show_borders")}}};CKEDITOR.plugins.add("showborders",{modes:{wysiwyg:1},onLoad:function(){var e;e=(CKEDITOR.env.ie6Compat?[".%1 table.%2,",".%1 table.%2 td, .%1 table.%2 th","{","border : #d3d3d3 1px dotted","}"]:".%1 table.%2,;.%1 table.%2 > tr > td, .%1 table.%2 > tr > th,;.%1 table.%2 > tbody > tr > td, .%1 table.%2 > tbody > tr > th,;.%1 table.%2 > thead > tr > td, .%1 table.%2 > thead > tr > th,;.%1 table.%2 > tfoot > tr > td, .%1 table.%2 > tfoot > tr > th;{;border : #d3d3d3 1px dotted;}".split(";")).join("").replace(/%2/g,"cke_show_border").replace(/%1/g,"cke_show_borders "),CKEDITOR.addCss(e)},init:function(t){var n=t.addCommand("showborders",e);n.canUndo=!1,!1!==t.config.startupShowBorders&&n.setState(CKEDITOR.TRISTATE_ON),t.on("mode",(function(){n.state!=CKEDITOR.TRISTATE_DISABLED&&n.refresh(t)}),null,null,100),t.on("contentDom",(function(){n.state!=CKEDITOR.TRISTATE_DISABLED&&n.refresh(t)})),t.on("removeFormatCleanup",(function(e){e=e.data,t.getCommand("showborders").state==CKEDITOR.TRISTATE_ON&&e.is("table")&&(!e.hasAttribute("border")||0>=parseInt(e.getAttribute("border"),10))&&e.addClass("cke_show_border")}))},afterInit:function(e){var t=e.dataProcessor;e=t&&t.dataFilter,t=t&&t.htmlFilter,e&&e.addRules({elements:{table:function(e){var t=(e=e.attributes).class,n=parseInt(e.border,10);n&&!(0>=n)||t&&-1!=t.indexOf("cke_show_border")||(e.class=(t||"")+" cke_show_border")}}}),t&&t.addRules({elements:{table:function(e){var t=(e=e.attributes).class;t&&(e.class=t.replace("cke_show_border","").replace(/\s{2}/," ").replace(/^\s+|\s+$/,""))}}})}}),CKEDITOR.on("dialogDefinition",(function(e){var t=e.data.name;"table"!=t&&"tableProperties"!=t||((t=(e=e.data.definition).getContents("info").get("txtBorder")).commit=CKEDITOR.tools.override(t.commit,(function(e){return function(t,n){e.apply(this,arguments);var o=parseInt(this.getValue(),10);n[!o||0>=o?"addClass":"removeClass"]("cke_show_border")}})),(e=(e=e.getContents("advanced"))&&e.get("advCSSClasses"))&&(e.setup=CKEDITOR.tools.override(e.setup,(function(e){return function(){e.apply(this,arguments),this.setValue(this.getValue().replace(/cke_show_border/,""))}})),e.commit=CKEDITOR.tools.override(e.commit,(function(e){return function(t,n){e.apply(this,arguments),parseInt(n.getAttribute("border"),10)||n.addClass("cke_show_border")}}))))}))}(),function(){CKEDITOR.plugins.add("sourcearea",{init:function(t){function n(){var e=i&&this.equals(CKEDITOR.document.getActive());this.hide(),this.setStyle("height",this.getParent().$.clientHeight+"px"),this.setStyle("width",this.getParent().$.clientWidth+"px"),this.show(),e&&this.focus()}if(t.elementMode!=CKEDITOR.ELEMENT_MODE_INLINE){var o=CKEDITOR.plugins.sourcearea;t.addMode("source",(function(o){var i=t.ui.space("contents").getDocument().createElement("textarea");i.setStyles(CKEDITOR.tools.extend({width:CKEDITOR.env.ie7Compat?"99%":"100%",height:"100%",resize:"none",outline:"none","text-align":"left"},CKEDITOR.tools.cssVendorPrefix("tab-size",t.config.sourceAreaTabSize||4))),i.setAttribute("dir","ltr"),i.addClass("cke_source").addClass("cke_reset").addClass("cke_enable_context_menu"),t.ui.space("contents").append(i),(i=t.editable(new e(t,i))).setData(t.getData(1)),CKEDITOR.env.ie&&(i.attachListener(t,"resize",n,i),i.attachListener(CKEDITOR.document.getWindow(),"resize",n,i),CKEDITOR.tools.setTimeout(n,0,i)),t.fire("ariaWidget",this),o()})),t.addCommand("source",o.commands.source),t.ui.addButton&&t.ui.addButton("Source",{label:t.lang.sourcearea.toolbar,command:"source",toolbar:"mode,10"}),t.on("mode",(function(){t.getCommand("source").setState("source"==t.mode?CKEDITOR.TRISTATE_ON:CKEDITOR.TRISTATE_OFF)}));var i=CKEDITOR.env.ie&&9==CKEDITOR.env.version}}});var e=CKEDITOR.tools.createClass({base:CKEDITOR.editable,proto:{setData:function(e){this.setValue(e),this.status="ready",this.editor.fire("dataReady")},getData:function(){return this.getValue()},insertHtml:function(){},insertElement:function(){},insertText:function(){},setReadOnly:function(e){this[(e?"set":"remove")+"Attribute"]("readOnly","readonly")},detach:function(){e.baseProto.detach.call(this),this.clearCustomData(),this.remove()}}})}(),CKEDITOR.plugins.sourcearea={commands:{source:{modes:{wysiwyg:1,source:1},editorFocus:!1,readOnly:1,exec:function(e){"wysiwyg"==e.mode&&e.fire("saveSnapshot"),e.getCommand("source").setState(CKEDITOR.TRISTATE_DISABLED),e.setMode("source"==e.mode?"wysiwyg":"source")},canUndo:!1}}},CKEDITOR.plugins.add("specialchar",{availableLangs:{af:1,ar:1,az:1,bg:1,ca:1,cs:1,cy:1,da:1,de:1,"de-ch":1,el:1,en:1,"en-au":1,"en-ca":1,"en-gb":1,eo:1,es:1,"es-mx":1,et:1,eu:1,fa:1,fi:1,fr:1,"fr-ca":1,gl:1,he:1,hr:1,hu:1,id:1,it:1,ja:1,km:1,ko:1,ku:1,lt:1,lv:1,nb:1,nl:1,no:1,oc:1,pl:1,pt:1,"pt-br":1,ro:1,ru:1,si:1,sk:1,sl:1,sq:1,sr:1,"sr-latn":1,sv:1,th:1,tr:1,tt:1,ug:1,uk:1,vi:1,zh:1,"zh-cn":1},requires:"dialog",init:function(e){var t=this;CKEDITOR.dialog.add("specialchar",this.path+"dialogs/specialchar.js"),e.addCommand("specialchar",{exec:function(){var n=t.availableLangs[n=e.langCode]?n:t.availableLangs[n.replace(/-.*/,"")]?n.replace(/-.*/,""):"en";CKEDITOR.scriptLoader.load(CKEDITOR.getUrl(t.path+"dialogs/lang/"+n+".js"),(function(){CKEDITOR.tools.extend(e.lang.specialchar,t.langEntries[n]),e.openDialog("specialchar")}))},modes:{wysiwyg:1},canUndo:!1}),e.ui.addButton&&e.ui.addButton("SpecialChar",{label:e.lang.specialchar.toolbar,command:"specialchar",toolbar:"insert,50"})}}),CKEDITOR.config.specialChars="! &quot; # $ % &amp; ' ( ) * + - . / 0 1 2 3 4 5 6 7 8 9 : ; &lt; = &gt; ? @ A B C D E F G H I J K L M N O P Q R S T U V W X Y Z [ ] ^ _ ` a b c d e f g h i j k l m n o p q r s t u v w x y z { | } ~ &euro; &lsquo; &rsquo; &ldquo; &rdquo; &ndash; &mdash; &iexcl; &cent; &pound; &curren; &yen; &brvbar; &sect; &uml; &copy; &ordf; &laquo; &not; &reg; &macr; &deg; &sup2; &sup3; &acute; &micro; &para; &middot; &cedil; &sup1; &ordm; &raquo; &frac14; &frac12; &frac34; &iquest; &Agrave; &Aacute; &Acirc; &Atilde; &Auml; &Aring; &AElig; &Ccedil; &Egrave; &Eacute; &Ecirc; &Euml; &Igrave; &Iacute; &Icirc; &Iuml; &ETH; &Ntilde; &Ograve; &Oacute; &Ocirc; &Otilde; &Ouml; &times; &Oslash; &Ugrave; &Uacute; &Ucirc; &Uuml; &Yacute; &THORN; &szlig; &agrave; &aacute; &acirc; &atilde; &auml; &aring; &aelig; &ccedil; &egrave; &eacute; &ecirc; &euml; &igrave; &iacute; &icirc; &iuml; &eth; &ntilde; &ograve; &oacute; &ocirc; &otilde; &ouml; &divide; &oslash; &ugrave; &uacute; &ucirc; &uuml; &yacute; &thorn; &yuml; &OElig; &oelig; &#372; &#374 &#373 &#375; &sbquo; &#8219; &bdquo; &hellip; &trade; &#9658; &bull; &rarr; &rArr; &hArr; &diams; &asymp;".split(" "),CKEDITOR.plugins.add("scayt",{requires:"menubutton,dialog",tabToOpen:null,dialogName:"scaytDialog",onLoad:function(e){"moono-lisa"==(CKEDITOR.skinName||e.config.skin)&&CKEDITOR.document.appendStyleSheet(CKEDITOR.getUrl(this.path+"skins/"+CKEDITOR.skin.name+"/scayt.css")),CKEDITOR.document.appendStyleSheet(CKEDITOR.getUrl(this.path+"dialogs/dialog.css"))},init:function(e){var t=this,n=CKEDITOR.plugins.scayt;this.bindEvents(e),this.parseConfig(e),this.addRule(e),CKEDITOR.dialog.add(this.dialogName,CKEDITOR.getUrl(this.path+"dialogs/options.js")),this.addMenuItems(e);var o=e.lang.scayt,i=CKEDITOR.env;e.ui.add("Scayt",CKEDITOR.UI_MENUBUTTON,{label:o.text_title,title:e.plugins.wsc?e.lang.wsc.title:o.text_title,modes:{wysiwyg:!(i.ie&&(8>i.version||i.quirks))},toolbar:"spellchecker,20",refresh:function(){var t=e.ui.instances.Scayt.getState();e.scayt&&(t=n.state.scayt[e.name]?CKEDITOR.TRISTATE_ON:CKEDITOR.TRISTATE_OFF),e.fire("scaytButtonState",t)},onRender:function(){var t=this;e.on("scaytButtonState",(function(e){void 0!==typeof e.data&&t.setState(e.data)}))},onMenu:function(){var t=e.scayt;e.getMenuItem("scaytToggle").label=e.lang.scayt[t&&n.state.scayt[e.name]?"btn_disable":"btn_enable"];var o={scaytToggle:CKEDITOR.TRISTATE_OFF,scaytOptions:t?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED,scaytLangs:t?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED,scaytDict:t?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED,scaytAbout:t?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED,WSC:e.plugins.wsc?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED};return e.config.scayt_uiTabs[0]||delete o.scaytOptions,e.config.scayt_uiTabs[1]||delete o.scaytLangs,e.config.scayt_uiTabs[2]||delete o.scaytDict,t&&!CKEDITOR.plugins.scayt.isNewUdSupported(t)&&(delete o.scaytDict,e.config.scayt_uiTabs[2]=0,CKEDITOR.plugins.scayt.alarmCompatibilityMessage()),o}}),e.contextMenu&&e.addMenuItems&&(e.contextMenu.addListener((function(n,o){var i,r,a=e.scayt;return a&&(r=a.getSelectionNode())&&(i=t.menuGenerator(e,r),a.showBanner("."+e.contextMenu._.definition.panel.className.split(" ").join(" ."))),i})),e.contextMenu._.onHide=CKEDITOR.tools.override(e.contextMenu._.onHide,(function(t){return function(){var n=e.scayt;return n&&n.hideBanner(),t.apply(this)}})))},addMenuItems:function(e){var t=this,n=CKEDITOR.plugins.scayt;e.addMenuGroup("scaytButton");for(var o=e.config.scayt_contextMenuItemsOrder.split("|"),i=0;i<o.length;i++)o[i]="scayt_"+o[i];if((o=["grayt_description","grayt_suggest","grayt_control"].concat(o))&&o.length)for(i=0;i<o.length;i++)e.addMenuGroup(o[i],i-10);e.addCommand("scaytToggle",{exec:function(e){var t=e.scayt;n.state.scayt[e.name]=!n.state.scayt[e.name],!0===n.state.scayt[e.name]?t||n.createScayt(e):t&&n.destroy(e)}}),e.addCommand("scaytAbout",{exec:function(e){e.scayt.tabToOpen="about",n.openDialog(t.dialogName,e)}}),e.addCommand("scaytOptions",{exec:function(e){e.scayt.tabToOpen="options",n.openDialog(t.dialogName,e)}}),e.addCommand("scaytLangs",{exec:function(e){e.scayt.tabToOpen="langs",n.openDialog(t.dialogName,e)}}),e.addCommand("scaytDict",{exec:function(e){e.scayt.tabToOpen="dictionaries",n.openDialog(t.dialogName,e)}}),o={scaytToggle:{label:e.lang.scayt.btn_enable,group:"scaytButton",command:"scaytToggle"},scaytAbout:{label:e.lang.scayt.btn_about,group:"scaytButton",command:"scaytAbout"},scaytOptions:{label:e.lang.scayt.btn_options,group:"scaytButton",command:"scaytOptions"},scaytLangs:{label:e.lang.scayt.btn_langs,group:"scaytButton",command:"scaytLangs"},scaytDict:{label:e.lang.scayt.btn_dictionaries,group:"scaytButton",command:"scaytDict"}},e.plugins.wsc&&(o.WSC={label:e.lang.wsc.toolbar,group:"scaytButton",onClick:function(){var t=CKEDITOR.plugins.scayt,n=e.scayt,o=e.elementMode==CKEDITOR.ELEMENT_MODE_INLINE?e.container.getText():e.document.getBody().getText();(o=o.replace(/\s/g,""))?(n&&t.state.scayt[e.name]&&n.setMarkupPaused&&n.setMarkupPaused(!0),e.lockSelection(),e.execCommand("checkspell")):alert("Nothing to check!")}}),e.addMenuItems(o)},bindEvents:function(e){var t=CKEDITOR.plugins.scayt,n=e.elementMode==CKEDITOR.ELEMENT_MODE_INLINE,o=function(){t.destroy(e)},i=function(){!t.state.scayt[e.name]||e.readOnly||e.scayt||t.createScayt(e)},r=function(){n?e.config.scayt_inlineModeImmediateMarkup?i():(e.on("blur",(function(){setTimeout(o,0)})),e.on("focus",i),e.focusManager.hasFocus&&i()):i(),function(){var t=e.editable();t.attachListener(t,"focus",(function(t){var o,r;if(CKEDITOR.plugins.scayt&&!e.scayt&&setTimeout(i,0),t=CKEDITOR.plugins.scayt&&CKEDITOR.plugins.scayt.state.scayt[e.name]&&e.scayt,(n||t)&&e._.savedSelection){t=!(t=e._.savedSelection.getSelectedElement())&&e._.savedSelection.getRanges();for(var a=0;a<t.length;a++)"string"==typeof(r=t[a]).startContainer.$.nodeValue&&((o=r.startContainer.getText().length)<r.startOffset||o<r.endOffset)&&e.unlockSelection(!1)}}),this,null,-10)}();var t=e.editable();t.attachListener(t,"mousedown",(function(t){t=t.data.getTarget();var n=e.widgets&&e.widgets.getByElement(t);n&&(n.wrapper=t.getAscendant((function(e){return e.hasAttribute("data-cke-widget-wrapper")}),!0))}),this,null,-10)};e.on("contentDom",r),e.on("beforeCommandExec",(function(n){var o=e.scayt,i=!1,r=!1,a=!0;n.data.name in t.options.disablingCommandExec&&"wysiwyg"==e.mode?o&&(t.destroy(e),e.fire("scaytButtonState",CKEDITOR.TRISTATE_DISABLED)):"bold"!==n.data.name&&"italic"!==n.data.name&&"underline"!==n.data.name&&"strike"!==n.data.name&&"subscript"!==n.data.name&&"superscript"!==n.data.name&&"enter"!==n.data.name&&"cut"!==n.data.name&&"language"!==n.data.name||!o||("cut"===n.data.name&&(a=!1,r=!0),"language"===n.data.name&&(r=i=!0),e.fire("reloadMarkupScayt",{removeOptions:{removeInside:a,forceBookmark:r,language:i},timeout:0}))})),e.on("beforeSetMode",(function(n){"source"==n.data&&((n=e.scayt)&&(t.destroy(e),e.fire("scaytButtonState",CKEDITOR.TRISTATE_DISABLED)),e.document&&e.document.getBody().removeAttribute("_jquid"))})),e.on("afterCommandExec",(function(n){"wysiwyg"!=e.mode||"undo"!=n.data.name&&"redo"!=n.data.name||setTimeout((function(){t.reloadMarkup(e.scayt)}),250)})),e.on("readOnly",(function(n){var o;n&&(o=e.scayt,!0===n.editor.readOnly?o&&o.fire("removeMarkupInDocument",{}):o?t.reloadMarkup(o):"wysiwyg"==n.editor.mode&&!0===t.state.scayt[n.editor.name]&&(t.createScayt(e),n.editor.fire("scaytButtonState",CKEDITOR.TRISTATE_ON)))})),e.on("beforeDestroy",o),e.on("setData",(function(){o(),(e.elementMode==CKEDITOR.ELEMENT_MODE_INLINE||e.plugins.divarea)&&r()}),this,null,50),e.on("reloadMarkupScayt",(function(n){var o=n.data&&n.data.removeOptions,i=n.data&&n.data.language,r=e.scayt;r&&setTimeout((function(){i&&(o.selectionNode=e.plugins.language.getCurrentLangElement(e),o.selectionNode=o.selectionNode&&o.selectionNode.$||null),r.removeMarkupInSelectionNode(o),t.reloadMarkup(r)}),n.data&&n.data.timeout||0)})),e.on("insertElement",(function(){e.fire("reloadMarkupScayt",{removeOptions:{forceBookmark:!0}})}),this,null,50),e.on("insertHtml",(function(){e.scayt&&e.scayt.setFocused&&e.scayt.setFocused(!0),e.fire("reloadMarkupScayt")}),this,null,50),e.on("insertText",(function(){e.scayt&&e.scayt.setFocused&&e.scayt.setFocused(!0),e.fire("reloadMarkupScayt")}),this,null,50),e.on("scaytDialogShown",(function(t){t.data.selectPage(e.scayt.tabToOpen)}))},parseConfig:function(e){if((o=CKEDITOR.plugins.scayt).replaceOldOptionsNames(e.config),"boolean"!=typeof e.config.scayt_autoStartup&&(e.config.scayt_autoStartup=!1),o.state.scayt[e.name]=e.config.scayt_autoStartup,"boolean"!=typeof e.config.grayt_autoStartup&&(e.config.grayt_autoStartup=!1),"boolean"!=typeof e.config.scayt_inlineModeImmediateMarkup&&(e.config.scayt_inlineModeImmediateMarkup=!1),o.state.grayt[e.name]=e.config.grayt_autoStartup,e.config.scayt_contextCommands||(e.config.scayt_contextCommands="ignoreall|add"),e.config.scayt_contextMenuItemsOrder||(e.config.scayt_contextMenuItemsOrder="suggest|moresuggest|control"),e.config.scayt_sLang||(e.config.scayt_sLang="en_US"),(void 0===e.config.scayt_maxSuggestions||"number"!=typeof e.config.scayt_maxSuggestions||0>e.config.scayt_maxSuggestions)&&(e.config.scayt_maxSuggestions=3),(void 0===e.config.scayt_minWordLength||"number"!=typeof e.config.scayt_minWordLength||1>e.config.scayt_minWordLength)&&(e.config.scayt_minWordLength=3),void 0!==e.config.scayt_customDictionaryIds&&"string"==typeof e.config.scayt_customDictionaryIds||(e.config.scayt_customDictionaryIds=""),void 0!==e.config.scayt_userDictionaryName&&"string"==typeof e.config.scayt_userDictionaryName||(e.config.scayt_userDictionaryName=null),"string"==typeof e.config.scayt_uiTabs&&3===e.config.scayt_uiTabs.split(",").length){var t=[],n=[];e.config.scayt_uiTabs=e.config.scayt_uiTabs.split(","),CKEDITOR.tools.search(e.config.scayt_uiTabs,(function(e){1===Number(e)||0===Number(e)?(n.push(!0),t.push(Number(e))):n.push(!1)})),e.config.scayt_uiTabs=null===CKEDITOR.tools.search(n,!1)?t:[1,1,1]}else e.config.scayt_uiTabs=[1,1,1];if("string"!=typeof e.config.scayt_serviceProtocol&&(e.config.scayt_serviceProtocol=null),"string"!=typeof e.config.scayt_serviceHost&&(e.config.scayt_serviceHost=null),"string"!=typeof e.config.scayt_servicePort&&(e.config.scayt_servicePort=null),"string"!=typeof e.config.scayt_servicePath&&(e.config.scayt_servicePath=null),e.config.scayt_moreSuggestions||(e.config.scayt_moreSuggestions="on"),"string"!=typeof e.config.scayt_customerId&&(e.config.scayt_customerId="1:WvF0D4-UtPqN1-43nkD4-NKvUm2-daQqk3-LmNiI-z7Ysb4-mwry24-T8YrS3-Q2tpq2"),"string"!=typeof e.config.scayt_customPunctuation&&(e.config.scayt_customPunctuation="-"),"string"!=typeof e.config.scayt_srcUrl&&(o=-1!=(o=document.location.protocol).search(/https?:/)?o:"http:",e.config.scayt_srcUrl=o+"//svc.webspellchecker.net/spellcheck31/wscbundle/wscbundle.js"),"boolean"!=typeof CKEDITOR.config.scayt_handleCheckDirty&&(CKEDITOR.config.scayt_handleCheckDirty=!0),"boolean"!=typeof CKEDITOR.config.scayt_handleUndoRedo&&(CKEDITOR.config.scayt_handleUndoRedo=!0),CKEDITOR.config.scayt_handleUndoRedo=!!CKEDITOR.plugins.undo&&CKEDITOR.config.scayt_handleUndoRedo,"boolean"!=typeof e.config.scayt_multiLanguageMode&&(e.config.scayt_multiLanguageMode=!1),"object"!=typeof e.config.scayt_multiLanguageStyles&&(e.config.scayt_multiLanguageStyles={}),e.config.scayt_ignoreAllCapsWords&&"boolean"!=typeof e.config.scayt_ignoreAllCapsWords&&(e.config.scayt_ignoreAllCapsWords=!1),e.config.scayt_ignoreDomainNames&&"boolean"!=typeof e.config.scayt_ignoreDomainNames&&(e.config.scayt_ignoreDomainNames=!1),e.config.scayt_ignoreWordsWithMixedCases&&"boolean"!=typeof e.config.scayt_ignoreWordsWithMixedCases&&(e.config.scayt_ignoreWordsWithMixedCases=!1),e.config.scayt_ignoreWordsWithNumbers&&"boolean"!=typeof e.config.scayt_ignoreWordsWithNumbers&&(e.config.scayt_ignoreWordsWithNumbers=!1),e.config.scayt_disableOptionsStorage){var o=CKEDITOR.tools.isArray(e.config.scayt_disableOptionsStorage)?e.config.scayt_disableOptionsStorage:"string"==typeof e.config.scayt_disableOptionsStorage?[e.config.scayt_disableOptionsStorage]:void 0,i="all options lang ignore-all-caps-words ignore-domain-names ignore-words-with-mixed-cases ignore-words-with-numbers".split(" "),r=["lang","ignore-all-caps-words","ignore-domain-names","ignore-words-with-mixed-cases","ignore-words-with-numbers"],a=CKEDITOR.tools.search,s=CKEDITOR.tools.indexOf;e.config.scayt_disableOptionsStorage=function(e){for(var t=0;t<e.length;t++){var n=e[t],o=!!a(e,"options");if(!a(i,n)||o&&a(r,(function(e){if("lang"===e)return!1})))return;if(a(r,n)&&r.splice(s(r,n),1),"all"===n||o&&a(e,"lang"))return[];"options"===n&&(r=["lang"])}return[].concat(r)}(o)}e.config.scayt_disableCache&&"boolean"!=typeof e.config.scayt_disableCache&&(e.config.scayt_disableCache=!1),(void 0===e.config.scayt_cacheSize||"number"!=typeof e.config.scayt_cacheSize||1>e.config.scayt_cacheSize)&&(e.config.scayt_cacheSize=4e3)},addRule:function(e){var t=CKEDITOR.plugins.scayt,n=(i=e.dataProcessor)&&i.htmlFilter,o=e._.elementsPath&&e._.elementsPath.filters,i=i&&i.dataFilter,r=e.addRemoveFormatFilter;o&&o.push((function(n){if(e.scayt&&(n.hasAttribute(t.options.data_attribute_name)||n.hasAttribute(t.options.problem_grammar_data_attribute)))return!1})),i&&i.addRules({elements:{span:function(e){var n=e.hasClass(t.options.misspelled_word_class)&&e.attributes[t.options.data_attribute_name],o=e.hasClass(t.options.problem_grammar_class)&&e.attributes[t.options.problem_grammar_data_attribute];return t&&(n||o)&&delete e.name,e}}}),n&&n.addRules({elements:{span:function(e){var n=e.hasClass(t.options.misspelled_word_class)&&e.attributes[t.options.data_attribute_name],o=e.hasClass(t.options.problem_grammar_class)&&e.attributes[t.options.problem_grammar_data_attribute];return t&&(n||o)&&delete e.name,e}}}),r&&r.call(e,(function(n){var o=!0;return e.scayt&&(n.hasAttribute(t.options.data_attribute_name)||n.hasAttribute(t.options.problem_grammar_data_attribute))&&(o=!1),o}))},scaytMenuDefinition:function(e){var t=this,n=CKEDITOR.plugins.scayt;return{scayt:{scayt_ignore:{label:(e=e.scayt).getLocal("btn_ignore"),group:"scayt_control",order:1,exec:function(e){e.scayt.ignoreWord()}},scayt_ignoreall:{label:e.getLocal("btn_ignoreAll"),group:"scayt_control",order:2,exec:function(e){e.scayt.ignoreAllWords()}},scayt_add:{label:e.getLocal("btn_addWord"),group:"scayt_control",order:3,exec:function(e){var t=e.scayt;setTimeout((function(){t.addWordToUserDictionary()}),10)}},scayt_option:{label:e.getLocal("btn_options"),group:"scayt_control",order:4,exec:function(e){e.scayt.tabToOpen="options",n.openDialog(t.dialogName,e)},verification:function(e){return 1==e.config.scayt_uiTabs[0]}},scayt_language:{label:e.getLocal("btn_langs"),group:"scayt_control",order:5,exec:function(e){e.scayt.tabToOpen="langs",n.openDialog(t.dialogName,e)},verification:function(e){return 1==e.config.scayt_uiTabs[1]}},scayt_dictionary:{label:e.getLocal("btn_dictionaries"),group:"scayt_control",order:6,exec:function(e){e.scayt.tabToOpen="dictionaries",n.openDialog(t.dialogName,e)},verification:function(e){return 1==e.config.scayt_uiTabs[2]}},scayt_about:{label:e.getLocal("btn_about"),group:"scayt_control",order:7,exec:function(e){e.scayt.tabToOpen="about",n.openDialog(t.dialogName,e)}}},grayt:{grayt_problemdescription:{label:"Grammar problem description",group:"grayt_description",order:1,state:CKEDITOR.TRISTATE_DISABLED,exec:function(e){}},grayt_ignore:{label:e.getLocal("btn_ignore"),group:"grayt_control",order:2,exec:function(e){e.scayt.ignorePhrase()}},grayt_ignoreall:{label:e.getLocal("btn_ignoreAll"),group:"grayt_control",order:3,exec:function(e){e.scayt.ignoreAllPhrases()}}}}},buildSuggestionMenuItems:function(e,t,n){var o={},i={},r=n?"word":"phrase",a=n?"startGrammarCheck":"startSpellCheck",s=e.scayt;if(0<t.length&&"no_any_suggestions"!==t[0])if(n)for(n=0;n<t.length;n++){var l="scayt_suggest_"+CKEDITOR.plugins.scayt.suggestions[n].replace(" ","_");e.addCommand(l,this.createCommand(CKEDITOR.plugins.scayt.suggestions[n],r,a)),n<e.config.scayt_maxSuggestions?(e.addMenuItem(l,{label:t[n],command:l,group:"scayt_suggest",order:n+1}),o[l]=CKEDITOR.TRISTATE_OFF):(e.addMenuItem(l,{label:t[n],command:l,group:"scayt_moresuggest",order:n+1}),i[l]=CKEDITOR.TRISTATE_OFF,"on"===e.config.scayt_moreSuggestions&&(e.addMenuItem("scayt_moresuggest",{label:s.getLocal("btn_moreSuggestions"),group:"scayt_moresuggest",order:10,getItems:function(){return i}}),o.scayt_moresuggest=CKEDITOR.TRISTATE_OFF))}else for(n=0;n<t.length;n++)l="grayt_suggest_"+CKEDITOR.plugins.scayt.suggestions[n].replace(" ","_"),e.addCommand(l,this.createCommand(CKEDITOR.plugins.scayt.suggestions[n],r,a)),e.addMenuItem(l,{label:t[n],command:l,group:"grayt_suggest",order:n+1}),o[l]=CKEDITOR.TRISTATE_OFF;else o.no_scayt_suggest=CKEDITOR.TRISTATE_DISABLED,e.addCommand("no_scayt_suggest",{exec:function(){}}),e.addMenuItem("no_scayt_suggest",{label:s.getLocal("btn_noSuggestions")||"no_scayt_suggest",command:"no_scayt_suggest",group:"scayt_suggest",order:0});return o},menuGenerator:function(e,t){var n,o,i,r,a=e.scayt,s=this.scaytMenuDefinition(e),l={},u=e.config.scayt_contextCommands.split("|"),c=t.getAttribute(a.getLangAttribute())||a.getLang();if(o=a.isScaytNode(t),i=a.isGraytNode(t),o?(s=s.scayt,n=t.getAttribute(a.getScaytNodeAttributeName()),a.fire("getSuggestionsList",{lang:c,word:n}),l=this.buildSuggestionMenuItems(e,CKEDITOR.plugins.scayt.suggestions,o)):i&&(s=s.grayt,l=t.getAttribute(a.getGraytNodeAttributeName()),a.getGraytNodeRuleAttributeName?(n=t.getAttribute(a.getGraytNodeRuleAttributeName()),a.getProblemDescriptionText(l,n,c)):a.getProblemDescriptionText(l,c),r=a.getProblemDescriptionText(l,n,c),s.grayt_problemdescription&&r&&(r=r.replace(/([.!?])\s/g,"$1<br>"),s.grayt_problemdescription.label=r),a.fire("getGrammarSuggestionsList",{lang:c,phrase:l,rule:n}),l=this.buildSuggestionMenuItems(e,CKEDITOR.plugins.scayt.suggestions,o)),o&&"off"==e.config.scayt_contextCommands)return l;for(var d in s)o&&-1==CKEDITOR.tools.indexOf(u,d.replace("scayt_",""))&&"all"!=e.config.scayt_contextCommands||i&&"grayt_problemdescription"!==d&&-1==CKEDITOR.tools.indexOf(u,d.replace("grayt_",""))&&"all"!=e.config.scayt_contextCommands||(l[d]=void 0!==s[d].state?s[d].state:CKEDITOR.TRISTATE_OFF,"function"!=typeof s[d].verification||s[d].verification(e)||delete l[d],e.addCommand(d,{exec:s[d].exec}),e.addMenuItem(d,{label:e.lang.scayt[s[d].label]||s[d].label,command:d,group:s[d].group,order:s[d].order}));return l},createCommand:function(e,t,n){return{exec:function(o){o=o.scayt;var i={};i[t]=e,o.replaceSelectionNode(i),"startGrammarCheck"===n&&o.removeMarkupInSelectionNode({grammarOnly:!0}),o.fire(n)}}}}),CKEDITOR.plugins.scayt={charsToObserve:[{charName:"cke-fillingChar",charCode:function(){var e;if(n=(n=CKEDITOR.version.match(/^\d(\.\d*)*/))&&n[0]){e="4.5.7";var t,n=n.replace(/\./g,"");e=e.replace(/\./g,""),t=0<=(t=n.length-e.length)?t:0,e=parseInt(n)>=parseInt(e)*Math.pow(10,t)}return e?Array(7).join(String.fromCharCode(8203)):String.fromCharCode(8203)}()}],state:{scayt:{},grayt:{}},warningCounter:0,suggestions:[],options:{disablingCommandExec:{source:!0,newpage:!0,templates:!0},data_attribute_name:"data-scayt-word",misspelled_word_class:"scayt-misspell-word",problem_grammar_data_attribute:"data-grayt-phrase",problem_grammar_class:"gramm-problem"},backCompatibilityMap:{scayt_service_protocol:"scayt_serviceProtocol",scayt_service_host:"scayt_serviceHost",scayt_service_port:"scayt_servicePort",scayt_service_path:"scayt_servicePath",scayt_customerid:"scayt_customerId"},openDialog:function(e,t){var n=t.scayt;n.isAllModulesReady&&!1===n.isAllModulesReady()||(t.lockSelection(),t.openDialog(e))},alarmCompatibilityMessage:function(){5>this.warningCounter&&(console.warn("You are using the latest version of SCAYT plugin for CKEditor with the old application version. In order to have access to the newest features, it is recommended to upgrade the application version to latest one as well. Contact us for more details at support@webspellchecker.net."),this.warningCounter+=1)},isNewUdSupported:function(e){return!!e.getUserDictionary},reloadMarkup:function(e){var t;e&&(t=e.getScaytLangList(),e.reloadMarkup?e.reloadMarkup():(this.alarmCompatibilityMessage(),t&&t.ltr&&t.rtl&&e.fire("startSpellCheck, startGrammarCheck")))},replaceOldOptionsNames:function(e){for(var t in e)t in this.backCompatibilityMap&&(e[this.backCompatibilityMap[t]]=e[t],delete e[t])},createScayt:function(e){var t=this,n=CKEDITOR.plugins.scayt;this.loadScaytLibrary(e,(function(e){function o(e){return new SCAYT.CKSCAYT(e,(function(){}),(function(){}))}var r;if(e.window&&(r="BODY"==e.editable().$.nodeName?e.window.getFrame():e.editable()),r){var a;r={lang:e.config.scayt_sLang,container:r.$,customDictionary:e.config.scayt_customDictionaryIds,userDictionaryName:e.config.scayt_userDictionaryName,localization:e.langCode,customer_id:e.config.scayt_customerId,customPunctuation:e.config.scayt_customPunctuation,debug:e.config.scayt_debug,data_attribute_name:t.options.data_attribute_name,misspelled_word_class:t.options.misspelled_word_class,problem_grammar_data_attribute:t.options.problem_grammar_data_attribute,problem_grammar_class:t.options.problem_grammar_class,"options-to-restore":e.config.scayt_disableOptionsStorage,focused:e.editable().hasFocus,ignoreElementsRegex:e.config.scayt_elementsToIgnore,ignoreGraytElementsRegex:e.config.grayt_elementsToIgnore,minWordLength:e.config.scayt_minWordLength,multiLanguageMode:e.config.scayt_multiLanguageMode,multiLanguageStyles:e.config.scayt_multiLanguageStyles,graytAutoStartup:e.config.grayt_autoStartup,disableCache:e.config.scayt_disableCache,cacheSize:e.config.scayt_cacheSize,charsToObserve:n.charsToObserve},e.config.scayt_serviceProtocol&&(r.service_protocol=e.config.scayt_serviceProtocol),e.config.scayt_serviceHost&&(r.service_host=e.config.scayt_serviceHost),e.config.scayt_servicePort&&(r.service_port=e.config.scayt_servicePort),e.config.scayt_servicePath&&(r.service_path=e.config.scayt_servicePath),"boolean"==typeof e.config.scayt_ignoreAllCapsWords&&(r["ignore-all-caps-words"]=e.config.scayt_ignoreAllCapsWords),"boolean"==typeof e.config.scayt_ignoreDomainNames&&(r["ignore-domain-names"]=e.config.scayt_ignoreDomainNames),"boolean"==typeof e.config.scayt_ignoreWordsWithMixedCases&&(r["ignore-words-with-mixed-cases"]=e.config.scayt_ignoreWordsWithMixedCases),"boolean"==typeof e.config.scayt_ignoreWordsWithNumbers&&(r["ignore-words-with-numbers"]=e.config.scayt_ignoreWordsWithNumbers);try{a=o(r)}catch(i){t.alarmCompatibilityMessage(),delete r.charsToObserve,a=o(r)}a.subscribe("suggestionListSend",(function(e){for(var t={},n=[],o=0;o<e.suggestionList.length;o++)t["word_"+e.suggestionList[o]]||(t["word_"+e.suggestionList[o]]=e.suggestionList[o],n.push(e.suggestionList[o]));CKEDITOR.plugins.scayt.suggestions=n})),a.subscribe("selectionIsChanged",(function(t){e.getSelection().isLocked&&"restoreSelection"!==t.action&&e.lockSelection(),"restoreSelection"===t.action&&e.selectionChange(!0)})),a.subscribe("graytStateChanged",(function(t){n.state.grayt[e.name]=t.state})),a.addMarkupHandler&&a.addMarkupHandler((function(t){var n=e.editable(),o=n.getCustomData(t.charName);o&&(o.$=t.node,n.setCustomData(t.charName,o))})),e.scayt=a,e.fire("scaytButtonState",e.readOnly?CKEDITOR.TRISTATE_DISABLED:CKEDITOR.TRISTATE_ON)}else n.state.scayt[e.name]=!1}))},destroy:function(e){e.scayt&&e.scayt.destroy(),delete e.scayt,e.fire("scaytButtonState",CKEDITOR.TRISTATE_OFF)},loadScaytLibrary:function(e,t){var n=function(){CKEDITOR.fireOnce("scaytReady"),e.scayt||"function"==typeof t&&t(e)};void 0===window.SCAYT||"function"!=typeof window.SCAYT.CKSCAYT?CKEDITOR.scriptLoader.load(e.config.scayt_srcUrl,(function(e){e&&n()})):window.SCAYT&&"function"==typeof window.SCAYT.CKSCAYT&&n()}},CKEDITOR.on("dialogDefinition",(function(e){var t=e.data.name;e=e.data.definition.dialog,"scaytDialog"!==t&&"checkspell"!==t&&(e.on("show",(function(e){e=e.sender&&e.sender.getParentEditor();var t=CKEDITOR.plugins.scayt,n=e.scayt;n&&t.state.scayt[e.name]&&n.setMarkupPaused&&n.setMarkupPaused(!0)})),e.on("hide",(function(e){e=e.sender&&e.sender.getParentEditor();var t=CKEDITOR.plugins.scayt,n=e.scayt;n&&t.state.scayt[e.name]&&n.setMarkupPaused&&n.setMarkupPaused(!1)}))),"scaytDialog"===t&&e.on("cancel",(function(e){return!1}),this,null,-1),"checkspell"===t&&e.on("cancel",(function(e){e=e.sender&&e.sender.getParentEditor();var t=CKEDITOR.plugins.scayt,n=e.scayt;n&&t.state.scayt[e.name]&&n.setMarkupPaused&&n.setMarkupPaused(!1),e.unlockSelection()}),this,null,-2),"link"===t&&e.on("ok",(function(e){var t=e.sender&&e.sender.getParentEditor();t&&setTimeout((function(){t.fire("reloadMarkupScayt",{removeOptions:{removeInside:!0,forceBookmark:!0},timeout:0})}),0)})),"replace"===t&&e.on("hide",(function(e){e=e.sender&&e.sender.getParentEditor();var t=CKEDITOR.plugins.scayt,n=e.scayt;e&&setTimeout((function(){n&&(n.fire("removeMarkupInDocument",{}),t.reloadMarkup(n))}),0)}))})),CKEDITOR.on("scaytReady",(function(){if(!0===CKEDITOR.config.scayt_handleCheckDirty&&((e=CKEDITOR.editor.prototype).checkDirty=CKEDITOR.tools.override(e.checkDirty,(function(e){return function(){var t=null,n=this.scayt;if(CKEDITOR.plugins.scayt&&CKEDITOR.plugins.scayt.state.scayt[this.name]&&this.scayt){if(t="ready"==this.status){var o=n.removeMarkupFromString(this.getSnapshot());n=n.removeMarkupFromString(this._.previousValue),t=t&&n!==o}}else t=e.call(this);return t}})),e.resetDirty=CKEDITOR.tools.override(e.resetDirty,(function(e){return function(){CKEDITOR.plugins.scayt&&CKEDITOR.plugins.scayt.state.scayt[this.name]&&this.scayt?this._.previousValue=this.scayt.removeMarkupFromString(this.getSnapshot()):e.call(this)}}))),!0===CKEDITOR.config.scayt_handleUndoRedo){var e,t="function"==typeof(e=CKEDITOR.plugins.undo.Image.prototype).equalsContent?"equalsContent":"equals";e[t]=CKEDITOR.tools.override(e[t],(function(e){return function(t){var n=t.editor.scayt,o=this.contents,i=t.contents,r=null;return CKEDITOR.plugins.scayt&&CKEDITOR.plugins.scayt.state.scayt[t.editor.name]&&t.editor.scayt&&(this.contents=n.removeMarkupFromString(o)||"",t.contents=n.removeMarkupFromString(i)||""),r=e.apply(this,arguments),this.contents=o,t.contents=i,r}}))}})),CKEDITOR.plugins.add("stylescombo",{requires:"richcombo",init:function(e){var t=e.config,n=e.lang.stylescombo,o={},i=[],r=[];e.on("stylesSet",(function(n){if(n=n.data.styles){for(var a,s,l,u=0,c=n.length;u<c;u++)a=n[u],e.blockless&&a.element in CKEDITOR.dtd.$block||"string"==typeof a.type&&!CKEDITOR.style.customHandlers[a.type]||(s=a.name,a=new CKEDITOR.style(a),e.filter.customConfig&&!e.filter.check(a))||(a._name=s,a._.enterMode=t.enterMode,a._.type=l=a.assignedTo||a.type,a._.weight=u+1e3*(l==CKEDITOR.STYLE_OBJECT?1:l==CKEDITOR.STYLE_BLOCK?2:3),o[s]=a,i.push(a),r.push(a));i.sort((function(e,t){return e._.weight-t._.weight}))}})),e.ui.addRichCombo("Styles",{label:n.label,title:n.panelTitle,toolbar:"styles,10",allowedContent:r,panel:{css:[CKEDITOR.skin.getPath("editor")].concat(t.contentsCss),multiSelect:!0,attributes:{"aria-label":n.panelTitle}},init:function(){var e,t,o,r,a,s;for(a=0,s=i.length;a<s;a++)t=(e=i[a])._name,(r=e._.type)!=o&&(this.startGroup(n["panelTitle"+String(r)]),o=r),this.add(t,e.type==CKEDITOR.STYLE_OBJECT?t:e.buildPreview(),t);this.commit()},onClick:function(t){e.focus(),e.fire("saveSnapshot"),t=o[t];var n=e.elementPath();t.group&&t.removeStylesFromSameGroup(e)?e.applyStyle(t):e[t.checkActive(n,e)?"removeStyle":"applyStyle"](t),e.fire("saveSnapshot")},onRender:function(){e.on("selectionChange",(function(t){for(var n,i=this.getValue(),r=0,a=(t=t.data.path.elements).length;r<a;r++)for(var s in n=t[r],o)if(o[s].checkElementRemovable(n,!0,e))return void(s!=i&&this.setValue(s));this.setValue("")}),this)},onOpen:function(){var t=(t=e.getSelection()).getSelectedElement()||t.getStartElement()||e.editable(),i=(t=e.elementPath(t),[0,0,0,0]);for(var r in this.showAll(),this.unmarkAll(),o){var a=o[r],s=a._.type;a.checkApplicable(t,e,e.activeFilter)?i[s]++:this.hideItem(r),a.checkActive(t,e)&&this.mark(r)}i[CKEDITOR.STYLE_BLOCK]||this.hideGroup(n["panelTitle"+String(CKEDITOR.STYLE_BLOCK)]),i[CKEDITOR.STYLE_INLINE]||this.hideGroup(n["panelTitle"+String(CKEDITOR.STYLE_INLINE)]),i[CKEDITOR.STYLE_OBJECT]||this.hideGroup(n["panelTitle"+String(CKEDITOR.STYLE_OBJECT)])},refresh:function(){var t=e.elementPath();if(t){for(var n in o)if(o[n].checkApplicable(t,e,e.activeFilter))return;this.setState(CKEDITOR.TRISTATE_DISABLED)}},reset:function(){o={},i=[]}})}}),function(){function e(e){return{editorFocus:!1,canUndo:!1,modes:{wysiwyg:1},exec:function(t){if(t.editable().hasFocus){var n,o=t.getSelection();if(n=new CKEDITOR.dom.elementPath(o.getCommonAncestor(),o.root).contains({td:1,th:1},1)){if(o=t.createRange(),(r=CKEDITOR.tools.tryThese((function(){return n.getParent().$.cells[n.$.cellIndex+(e?-1:1)]}),(function(){var t;return(t=(t=n.getParent()).getAscendant("table").$.rows[t.$.rowIndex+(e?-1:1)]).cells[e?t.cells.length-1:0]})))||e){if(!r)return!0;r=new CKEDITOR.dom.element(r),o.moveToElementEditStart(r),o.checkStartOfBlock()&&o.checkEndOfBlock()||o.selectNodeContents(r)}else{for(var i=n.getAscendant("table").$,r=n.getParent().$.cells,a=(i=new CKEDITOR.dom.element(i.insertRow(-1),t.document),0),s=r.length;a<s;a++)i.append(new CKEDITOR.dom.element(r[a],t.document).clone(!1,!1)).appendBogus();o.moveToElementEditStart(i)}return o.select(!0),!0}}return!1}}}var t={editorFocus:!1,modes:{wysiwyg:1,source:1}},n={exec:function(e){e.container.focusNext(!0,e.tabIndex)}},o={exec:function(e){e.container.focusPrevious(!0,e.tabIndex)}};CKEDITOR.plugins.add("tab",{init:function(i){for(var r=!1!==i.config.enableTabKeyTools,a=i.config.tabSpaces||0,s="";a--;)s+=" ";s&&i.on("key",(function(e){9==e.data.keyCode&&(i.insertText(s),e.cancel())})),r&&i.on("key",(function(e){(9==e.data.keyCode&&i.execCommand("selectNextCell")||e.data.keyCode==CKEDITOR.SHIFT+9&&i.execCommand("selectPreviousCell"))&&e.cancel()})),i.addCommand("blur",CKEDITOR.tools.extend(n,t)),i.addCommand("blurBack",CKEDITOR.tools.extend(o,t)),i.addCommand("selectNextCell",e()),i.addCommand("selectPreviousCell",e(!0))}})}(),CKEDITOR.dom.element.prototype.focusNext=function(e,t){var n,o,i,r,a,s,l=void 0===t?this.getTabIndex():t;if(0>=l)for(a=this.getNextSourceNode(e,CKEDITOR.NODE_ELEMENT);a;){if(a.isVisible()&&0===a.getTabIndex()){i=a;break}a=a.getNextSourceNode(!1,CKEDITOR.NODE_ELEMENT)}else for(a=this.getDocument().getBody().getFirst();a=a.getNextSourceNode(!1,CKEDITOR.NODE_ELEMENT);){if(!n)if(!o&&a.equals(this)){if(o=!0,e){if(!(a=a.getNextSourceNode(!0,CKEDITOR.NODE_ELEMENT)))break;n=1}}else o&&!this.contains(a)&&(n=1);if(a.isVisible()&&!(0>(s=a.getTabIndex()))){if(n&&s==l){i=a;break}s>l&&(!i||!r||s<r)?(i=a,r=s):i||0!==s||(i=a,r=s)}}i&&i.focus()},CKEDITOR.dom.element.prototype.focusPrevious=function(e,t){for(var n,o,i,r,a=void 0===t?this.getTabIndex():t,s=0,l=this.getDocument().getBody().getLast();l=l.getPreviousSourceNode(!1,CKEDITOR.NODE_ELEMENT);){if(!n)if(!o&&l.equals(this)){if(o=!0,e){if(!(l=l.getPreviousSourceNode(!0,CKEDITOR.NODE_ELEMENT)))break;n=1}}else o&&!this.contains(l)&&(n=1);if(l.isVisible()&&!(0>(r=l.getTabIndex())))if(0>=a){if(n&&0===r){i=l;break}r>s&&(i=l,s=r)}else{if(n&&r==a){i=l;break}r<a&&(!i||r>s)&&(i=l,s=r)}}i&&i.focus()},CKEDITOR.plugins.add("table",{requires:"dialog",init:function(e){function t(e){return CKEDITOR.tools.extend(e||{},{contextSensitive:1,refresh:function(e,t){this.setState(t.contains("table",1)?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED)}})}if(!e.blockless){var n=e.lang.table;e.addCommand("table",new CKEDITOR.dialogCommand("table",{context:"table",allowedContent:"table{width,height,border-collapse}[align,border,cellpadding,cellspacing,summary];caption tbody thead tfoot;th td tr[scope];td{border*,background-color,vertical-align,width,height}[colspan,rowspan];"+(e.plugins.dialogadvtab?"table"+e.plugins.dialogadvtab.allowedContent():""),requiredContent:"table",contentTransformations:[["table{width}: sizeToStyle","table[width]: sizeToAttribute"],["td: splitBorderShorthand"],[{element:"table",right:function(e){if(e.styles){var t;if(e.styles.border)t=CKEDITOR.tools.style.parse.border(e.styles.border);else if(CKEDITOR.env.ie&&8===CKEDITOR.env.version){var n=e.styles;n["border-left"]&&n["border-left"]===n["border-right"]&&n["border-right"]===n["border-top"]&&n["border-top"]===n["border-bottom"]&&(t=CKEDITOR.tools.style.parse.border(n["border-top"]))}t&&t.style&&"solid"===t.style&&t.width&&0!==parseFloat(t.width)&&(e.attributes.border=1),"collapse"==e.styles["border-collapse"]&&(e.attributes.cellspacing=0)}}}]]})),e.addCommand("tableProperties",new CKEDITOR.dialogCommand("tableProperties",t())),e.addCommand("tableDelete",t({exec:function(e){var t=e.elementPath().contains("table",1);if(t){var n=t.getParent(),o=e.editable();1!=n.getChildCount()||n.is("td","th")||n.equals(o)||(t=n),(e=e.createRange()).moveToPosition(t,CKEDITOR.POSITION_BEFORE_START),t.remove(),e.select()}}})),e.ui.addButton&&e.ui.addButton("Table",{label:n.toolbar,command:"table",toolbar:"insert,30"}),CKEDITOR.dialog.add("table",this.path+"dialogs/table.js"),CKEDITOR.dialog.add("tableProperties",this.path+"dialogs/table.js"),e.addMenuItems&&e.addMenuItems({table:{label:n.menu,command:"tableProperties",group:"table",order:5},tabledelete:{label:n.deleteTable,command:"tableDelete",group:"table",order:1}}),e.on("doubleclick",(function(e){e.data.element.is("table")&&(e.data.dialog="tableProperties")})),e.contextMenu&&e.contextMenu.addListener((function(){return{tabledelete:CKEDITOR.TRISTATE_OFF,table:CKEDITOR.TRISTATE_OFF}}))}}}),function(){function e(e,t){function n(e){return!t||t.contains(e)&&e.getAscendant("table",!0).equals(t)}function o(e){0<i.length||e.type!=CKEDITOR.NODE_ELEMENT||!d.test(e.getName())||e.getCustomData("selected_cell")||(CKEDITOR.dom.element.setMarker(r,e,"selected_cell",!0),i.push(e))}var i=[],r={};if(!e)return i;for(var a=e.getRanges(),s=0;s<a.length;s++){var l,u;if((l=a[s]).collapsed)(l=l.getCommonAncestor().getAscendant({td:1,th:1},!0))&&n(l)&&i.push(l);else for((l=new CKEDITOR.dom.walker(l)).guard=o;u=l.next();)u.type==CKEDITOR.NODE_ELEMENT&&u.is(CKEDITOR.dtd.table)||(u=u.getAscendant({td:1,th:1},!0))&&!u.getCustomData("selected_cell")&&n(u)&&(CKEDITOR.dom.element.setMarker(r,u,"selected_cell",!0),i.push(u))}return CKEDITOR.dom.element.clearAllMarkers(r),i}function t(t,n){var o=(i=(s=f(t)?t:e(t))[0]).getAscendant("table"),i=i.getDocument(),r=(l=s[0].getParent()).$.rowIndex,a=(s=s[s.length-1]).getParent().$.rowIndex+s.$.rowSpan-1,s=new CKEDITOR.dom.element(o.$.rows[a]),l=(r=n?r:a,n?l:s);for(o=(s=CKEDITOR.tools.buildTableMap(o))[r],r=n?s[r-1]:s[r+1],s=s[0].length,i=i.createElement("tr"),a=0;o[a]&&a<s;a++){var u;1<o[a].rowSpan&&r&&o[a]==r[a]?(u=o[a]).rowSpan+=1:((u=new CKEDITOR.dom.element(o[a]).clone()).removeAttribute("rowSpan"),u.appendBogus(),i.append(u),u=u.$),a+=u.colSpan-1}return n?i.insertBefore(l):i.insertAfter(l),i}function n(e){for(var t=e.getParent().$.cells,n=0,o=0;o<t.length;o++){var i=t[o];if(n+=i.colSpan,i==e.$)break}return n-1}function o(e,t){for(var o=t?1/0:0,i=0;i<e.length;i++){var r=n(e[i]);(t?r<o:r>o)&&(o=r)}return o}function i(t,n){for(var i=(a=f(t)?t:e(t))[0].getAscendant("table"),r=o(a,1),a=o(a),s=n?r:a,l=CKEDITOR.tools.buildTableMap(i),u=(i=[],r=[],a=[],l.length),c=0;c<u;c++)i.push(l[c][s]),r.push(n?l[c][s-1]:l[c][s+1]);for(c=0;c<u;c++)i[c]&&(1<i[c].colSpan&&r[c]==i[c]?(l=i[c]).colSpan+=1:((l=(s=new CKEDITOR.dom.element(i[c])).clone()).removeAttribute("colSpan"),l.appendBogus(),l[n?"insertBefore":"insertAfter"].call(l,s),a.push(l),l=l.$),c+=l.rowSpan-1);return a}function r(e,t){var n=e.getStartElement().getAscendant({td:1,th:1},!0);if(n){var o=n.clone();o.appendBogus(),t?o.insertBefore(n):o.insertAfter(n)}}function a(e,t){var n=e.getDocument(),o=CKEDITOR.document;CKEDITOR.env.ie&&10==CKEDITOR.env.version&&(o.focus(),n.focus()),(n=new CKEDITOR.dom.range(n))["moveToElementEdit"+(t?"End":"Start")](e)||(n.selectNodeContents(e),n.collapse(!t)),n.select(!0)}function s(e,t,n){if(e=e[t],void 0===n)return e;for(t=0;e&&t<e.length;t++){if(n.is&&e[t]==n.$)return t;if(t==n)return new CKEDITOR.dom.element(e[t])}return n.is?-1:null}function l(t,n,o){var i,r,a=e(t);if((n?1!=a.length:2>a.length)||(i=t.getCommonAncestor())&&i.type==CKEDITOR.NODE_ELEMENT&&i.is("table"))return!1;i=(t=a[0]).getAscendant("table");var u=CKEDITOR.tools.buildTableMap(i),c=u.length,d=u[0].length,f=t.getParent().$.rowIndex,h=s(u,f,t);if(n){var g;try{var m=parseInt(t.getAttribute("rowspan"),10)||1;r=parseInt(t.getAttribute("colspan"),10)||1,g=u["up"==n?f-m:"down"==n?f+m:f]["left"==n?h-r:"right"==n?h+r:h]}catch(l){return!1}if(!g||t.$==g)return!1;a["up"==n||"left"==n?"unshift":"push"](new CKEDITOR.dom.element(g))}n=t.getDocument();var p=f,v=(m=g=0,!o&&new CKEDITOR.dom.documentFragment(n)),y=0;for(n=0;n<a.length;n++){var b=(r=a[n]).getParent(),C=r.getFirst(),T=r.$.colSpan,x=r.$.rowSpan,E=s(u,b=b.$.rowIndex,r);y+=T*x,m=Math.max(m,E-h+T),g=Math.max(g,b-f+x),o||((x=(T=r).getBogus())&&x.remove(),T.trim(),r.getChildren().count()&&(b==p||!C||C.isBlockBoundary&&C.isBlockBoundary({br:1})||!(p=v.getLast(CKEDITOR.dom.walker.whitespaces(!0)))||p.is&&p.is("br")||v.append("br"),r.moveChildren(v)),n?r.remove():r.setHtml("")),p=b}if(o)return g*m==y;for(v.moveChildren(t),t.appendBogus(),m>=d?t.removeAttribute("rowSpan"):t.$.rowSpan=g,g>=c?t.removeAttribute("colSpan"):t.$.colSpan=m,n=(a=(o=new CKEDITOR.dom.nodeList(i.$.rows)).count())-1;0<=n;n--)(i=o.getItem(n)).$.cells.length||(i.remove(),a++);return t}function u(t,n){if(1<(o=e(t)).length)return!1;if(n)return!0;var o,i,r=(c=(o=o[0]).getParent()).getAscendant("table"),a=s(d=CKEDITOR.tools.buildTableMap(r),f=c.$.rowIndex,o);if(1<(u=o.$.rowSpan)){i=Math.ceil(u/2);for(var l,u=Math.floor(u/2),c=f+i,d=(r=new CKEDITOR.dom.element(r.$.rows[c]),s(d,c)),f=(c=o.clone(),0);f<d.length;f++){if((l=d[f]).parentNode==r.$&&f>a){c.insertBefore(new CKEDITOR.dom.element(l));break}l=null}l||r.append(c)}else for(u=i=1,(r=c.clone()).insertAfter(c),r.append(c=o.clone()),l=s(d,f),a=0;a<l.length;a++)l[a].rowSpan++;return c.appendBogus(),o.$.rowSpan=i,c.$.rowSpan=u,1==i&&o.removeAttribute("rowSpan"),1==u&&c.removeAttribute("rowSpan"),c}function c(t,n){if(1<(o=e(t)).length)return!1;if(n)return!0;var o,i=(o=o[0]).getParent(),r=i.getAscendant("table"),a=s(r=CKEDITOR.tools.buildTableMap(r),i.$.rowIndex,o);if(1<(l=o.$.colSpan))i=Math.ceil(l/2),l=Math.floor(l/2);else{for(var l=i=1,u=[],c=0;c<r.length;c++){var d=r[c];u.push(d[a]),1<d[a].rowSpan&&(c+=d[a].rowSpan-1)}for(r=0;r<u.length;r++)u[r].colSpan++}return(r=o.clone()).insertAfter(o),r.appendBogus(),o.$.colSpan=i,r.$.colSpan=l,1==i&&o.removeAttribute("colSpan"),1==l&&r.removeAttribute("colSpan"),r}var d=/^(?:td|th)$/,f=CKEDITOR.tools.isArray;CKEDITOR.plugins.tabletools={requires:"table,dialog,contextmenu",init:function(n){function o(e){return CKEDITOR.tools.extend(e||{},{contextSensitive:1,refresh:function(e,t){this.setState(t.contains({td:1,th:1},1)?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED)}})}function s(e,t){var o=n.addCommand(e,t);n.addFeature(o)}var d=n.lang.table,f=CKEDITOR.tools.style.parse,h="td{width} td{height} td{border-color} td{background-color} td{white-space} td{vertical-align} td{text-align} td[colspan] td[rowspan] th".split(" ");s("cellProperties",new CKEDITOR.dialogCommand("cellProperties",o({allowedContent:"td th{width,height,border-color,background-color,white-space,vertical-align,text-align}[colspan,rowspan]",requiredContent:h,contentTransformations:[[{element:"td",left:function(e){return e.styles.background&&f.background(e.styles.background).color},right:function(e){e.styles["background-color"]=f.background(e.styles.background).color}},{element:"td",check:"td{vertical-align}",left:function(e){return e.attributes&&e.attributes.valign},right:function(e){e.styles["vertical-align"]=e.attributes.valign,delete e.attributes.valign}}],[{element:"tr",check:"td{height}",left:function(e){return e.styles&&e.styles.height},right:function(e){CKEDITOR.tools.array.forEach(e.children,(function(t){t.name in{td:1,th:1}&&(t.attributes["cke-row-height"]=e.styles.height)})),delete e.styles.height}}],[{element:"td",check:"td{height}",left:function(e){return(e=e.attributes)&&e["cke-row-height"]},right:function(e){e.styles.height=e.attributes["cke-row-height"],delete e.attributes["cke-row-height"]}}]]}))),CKEDITOR.dialog.add("cellProperties",this.path+"dialogs/tableCell.js"),s("rowDelete",o({requiredContent:"table",exec:function(t){(t=function t(n){if(n instanceof CKEDITOR.dom.selection){var o=n.getRanges(),i=(l=e(n))[0].getAscendant("table"),r=CKEDITOR.tools.buildTableMap(i),a=l[0].getParent().$.rowIndex,s=(l=l[l.length-1]).getParent().$.rowIndex+l.$.rowSpan-1,l=[];for(n.reset(),n=a;n<=s;n++){for(var u=r[n],c=new CKEDITOR.dom.element(i.$.rows[n]),d=0;d<u.length;d++){var f=new CKEDITOR.dom.element(u[d]),h=f.getParent().$.rowIndex;1==f.$.rowSpan?f.remove():(--f.$.rowSpan,h==n&&((h=r[n+1])[d-1]?f.insertAfter(new CKEDITOR.dom.element(h[d-1])):new CKEDITOR.dom.element(i.$.rows[n+1]).append(f,1))),d+=f.$.colSpan-1}l.push(c)}for(r=i.$.rows,o[0].moveToPosition(i,CKEDITOR.POSITION_BEFORE_START),a=new CKEDITOR.dom.element(r[s+1]||(0<a?r[a-1]:null)||i.$.parentNode),n=l.length;0<=n;n--)t(l[n]);return i.$.parentNode?a:(o[0].select(),null)}return n instanceof CKEDITOR.dom.element&&(1==(i=n.getAscendant("table")).$.rows.length?i.remove():n.remove()),null}(t=t.getSelection()))&&a(t)}})),s("rowInsertBefore",o({requiredContent:"table",exec:function(n){t(n=e(n=n.getSelection()),!0)}})),s("rowInsertAfter",o({requiredContent:"table",exec:function(n){t(n=e(n=n.getSelection()))}})),s("columnDelete",o({requiredContent:"table",exec:function(t){(t=function(t){CKEDITOR.env.webkit&&!t.isFake&&(t=function(e){var t,n,o;if(1!==(t=e.getRanges()).length)return e;if((t=t[0]).collapsed||0!==t.endOffset)return e;if("td"!==(o=(n=t.endContainer).getName().toLowerCase())&&"th"!==o)return e;for((o=n.getPrevious())||(o=n.getParent().getPrevious().getLast());o.type!==CKEDITOR.NODE_TEXT&&"br"!==o.getName().toLowerCase();)if(!(o=o.getLast()))return e;return t.setEndAt(o,CKEDITOR.POSITION_BEFORE_END),t.select()}(t));var n,o,i=t.getRanges(),r=(s=e(t))[0],a=s[s.length-1],s=r.getAscendant("table"),l=CKEDITOR.tools.buildTableMap(s),u=[];t.reset();var c=0;for(t=l.length;c<t;c++)for(var d=0,f=l[c].length;d<f;d++)void 0===n&&l[c][d]==r.$&&(n=d),l[c][d]==a.$&&(o=d);for(c=n;c<=o;c++)for(d=0;d<l.length;d++)a=l[d],r=new CKEDITOR.dom.element(s.$.rows[d]),(a=new CKEDITOR.dom.element(a[c])).$&&(1==a.$.colSpan?a.remove():--a.$.colSpan,d+=a.$.rowSpan-1,r.$.cells.length||u.push(r));return n=l[0].length-1>o?new CKEDITOR.dom.element(l[0][o+1]):n&&-1!==l[0][n-1].cellIndex?new CKEDITOR.dom.element(l[0][n-1]):new CKEDITOR.dom.element(s.$.parentNode),u.length==t&&(i[0].moveToPosition(s,CKEDITOR.POSITION_AFTER_END),i[0].select(),s.remove()),n}(t=t.getSelection()))&&a(t,!0)}})),s("columnInsertBefore",o({requiredContent:"table",exec:function(t){i(t=e(t=t.getSelection()),!0)}})),s("columnInsertAfter",o({requiredContent:"table",exec:function(t){i(t=e(t=t.getSelection()))}})),s("cellDelete",o({requiredContent:"table",exec:function(t){!function t(n){if(n instanceof CKEDITOR.dom.selection){var o,i=n.getRanges(),r=e(n),s=r[0]&&r[0].getAscendant("table");e:{var l=0;o=r.length-1;for(var u,c,d={};u=r[l++];)CKEDITOR.dom.element.setMarker(d,u,"delete_cell",!0);for(l=0;u=r[l++];)if((c=u.getPrevious())&&!c.getCustomData("delete_cell")||(c=u.getNext())&&!c.getCustomData("delete_cell")){CKEDITOR.dom.element.clearAllMarkers(d),o=c;break e}CKEDITOR.dom.element.clearAllMarkers(d),o=(l=(l=r[0].getParent()).getPrevious())?l.getLast():(l=(l=r[o].getParent()).getNext())?l.getChild(0):null}for(n.reset(),n=r.length-1;0<=n;n--)t(r[n]);o?a(o,!0):s&&(i[0].moveToPosition(s,CKEDITOR.POSITION_BEFORE_START),i[0].select(),s.remove())}else n instanceof CKEDITOR.dom.element&&(1==(i=n.getParent()).getChildCount()?i.remove():n.remove())}(t=t.getSelection())}})),s("cellMerge",o({allowedContent:"td[colspan,rowspan]",requiredContent:"td[colspan,rowspan]",exec:function(e,t){t.cell=l(e.getSelection()),a(t.cell,!0)}})),s("cellMergeRight",o({allowedContent:"td[colspan]",requiredContent:"td[colspan]",exec:function(e,t){t.cell=l(e.getSelection(),"right"),a(t.cell,!0)}})),s("cellMergeDown",o({allowedContent:"td[rowspan]",requiredContent:"td[rowspan]",exec:function(e,t){t.cell=l(e.getSelection(),"down"),a(t.cell,!0)}})),s("cellVerticalSplit",o({allowedContent:"td[rowspan]",requiredContent:"td[rowspan]",exec:function(e){a(c(e.getSelection()))}})),s("cellHorizontalSplit",o({allowedContent:"td[colspan]",requiredContent:"td[colspan]",exec:function(e){a(u(e.getSelection()))}})),s("cellInsertBefore",o({requiredContent:"table",exec:function(e){r(e=e.getSelection(),!0)}})),s("cellInsertAfter",o({requiredContent:"table",exec:function(e){r(e=e.getSelection())}})),n.addMenuItems&&n.addMenuItems({tablecell:{label:d.cell.menu,group:"tablecell",order:1,getItems:function(){var t=e(o=n.getSelection()),o={tablecell_insertBefore:CKEDITOR.TRISTATE_OFF,tablecell_insertAfter:CKEDITOR.TRISTATE_OFF,tablecell_delete:CKEDITOR.TRISTATE_OFF,tablecell_merge:l(o,null,!0)?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED,tablecell_merge_right:l(o,"right",!0)?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED,tablecell_merge_down:l(o,"down",!0)?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED,tablecell_split_vertical:c(o,!0)?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED,tablecell_split_horizontal:u(o,!0)?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED};return n.filter.check(h)&&(o.tablecell_properties=0<t.length?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED),o}},tablecell_insertBefore:{label:d.cell.insertBefore,group:"tablecell",command:"cellInsertBefore",order:5},tablecell_insertAfter:{label:d.cell.insertAfter,group:"tablecell",command:"cellInsertAfter",order:10},tablecell_delete:{label:d.cell.deleteCell,group:"tablecell",command:"cellDelete",order:15},tablecell_merge:{label:d.cell.merge,group:"tablecell",command:"cellMerge",order:16},tablecell_merge_right:{label:d.cell.mergeRight,group:"tablecell",command:"cellMergeRight",order:17},tablecell_merge_down:{label:d.cell.mergeDown,group:"tablecell",command:"cellMergeDown",order:18},tablecell_split_horizontal:{label:d.cell.splitHorizontal,group:"tablecell",command:"cellHorizontalSplit",order:19},tablecell_split_vertical:{label:d.cell.splitVertical,group:"tablecell",command:"cellVerticalSplit",order:20},tablecell_properties:{label:d.cell.title,group:"tablecellproperties",command:"cellProperties",order:21},tablerow:{label:d.row.menu,group:"tablerow",order:1,getItems:function(){return{tablerow_insertBefore:CKEDITOR.TRISTATE_OFF,tablerow_insertAfter:CKEDITOR.TRISTATE_OFF,tablerow_delete:CKEDITOR.TRISTATE_OFF}}},tablerow_insertBefore:{label:d.row.insertBefore,group:"tablerow",command:"rowInsertBefore",order:5},tablerow_insertAfter:{label:d.row.insertAfter,group:"tablerow",command:"rowInsertAfter",order:10},tablerow_delete:{label:d.row.deleteRow,group:"tablerow",command:"rowDelete",order:15},tablecolumn:{label:d.column.menu,group:"tablecolumn",order:1,getItems:function(){return{tablecolumn_insertBefore:CKEDITOR.TRISTATE_OFF,tablecolumn_insertAfter:CKEDITOR.TRISTATE_OFF,tablecolumn_delete:CKEDITOR.TRISTATE_OFF}}},tablecolumn_insertBefore:{label:d.column.insertBefore,group:"tablecolumn",command:"columnInsertBefore",order:5},tablecolumn_insertAfter:{label:d.column.insertAfter,group:"tablecolumn",command:"columnInsertAfter",order:10},tablecolumn_delete:{label:d.column.deleteColumn,group:"tablecolumn",command:"columnDelete",order:15}}),n.contextMenu&&n.contextMenu.addListener((function(e,t,n){return(e=n.contains({td:1,th:1},1))&&!e.isReadOnly()?{tablecell:CKEDITOR.TRISTATE_OFF,tablerow:CKEDITOR.TRISTATE_OFF,tablecolumn:CKEDITOR.TRISTATE_OFF}:null}))},getCellColIndex:n,insertRow:t,insertColumn:i,getSelectedCells:e},CKEDITOR.plugins.add("tabletools",CKEDITOR.plugins.tabletools)}(),CKEDITOR.tools.buildTableMap=function(e,t,n,o,i){e=e.$.rows,n=n||0,o="number"==typeof o?o:e.length-1,i="number"==typeof i?i:-1;var r=-1,a=[];for(t=t||0;t<=o;t++){!a[++r]&&(a[r]=[]);for(var s=-1,l=n;l<=(-1===i?e[t].cells.length-1:i)&&(c=e[t].cells[l]);l++){for(s++;a[r][s];)s++;for(var u=isNaN(c.colSpan)?1:c.colSpan,c=isNaN(c.rowSpan)?1:c.rowSpan,d=0;d<c&&!(t+d>o);d++){a[r+d]||(a[r+d]=[]);for(var f=0;f<u;f++)a[r+d][s+f]=e[t].cells[l]}if(s+=u-1,-1!==i&&s>=i)break}}return a},function(){function e(e){return CKEDITOR.plugins.widget&&CKEDITOR.plugins.widget.isDomWidget(e)}function t(e,t){var n,o,i=e.getAscendant("table"),a=t.getAscendant("table"),s=CKEDITOR.tools.buildTableMap(i),l=r(e),u=r(t),c=[],d={};for(i.contains(a)&&(u=r(t=t.getAscendant({td:1,th:1}))),l>u&&(i=l,l=u,u=i,i=e,e=t,t=i),i=0;i<s[l].length;i++)if(e.$===s[l][i]){n=i;break}for(i=0;i<s[u].length;i++)if(t.$===s[u][i]){o=i;break}for(n>o&&(i=n,n=o,o=i),i=l;i<=u;i++)for(l=n;l<=o;l++)(a=new CKEDITOR.dom.element(s[i][l])).$&&!a.getCustomData("selected_cell")&&(c.push(a),CKEDITOR.dom.element.setMarker(d,a,"selected_cell",!0));return CKEDITOR.dom.element.clearAllMarkers(d),c}function n(e,t){var n,o=e.editable().find(".cke_table-faked-selection"),i=e.editable().findOne("[data-cke-table-faked-selection-table]");for(e.fire("lockSnapshot"),e.editable().removeClass("cke_table-faked-selection-editor"),n=0;n<o.count();n++)o.getItem(n).removeClass("cke_table-faked-selection");i&&i.data("cke-table-faked-selection-table",!1),e.fire("unlockSnapshot"),t&&(p={active:!1},e.getSelection().isInTable()&&e.getSelection().reset())}function o(e,t){var n,o,i=[];for(o=0;o<t.length;o++)(n=e.createRange()).setStartBefore(t[o]),n.setEndAfter(t[o]),i.push(n);e.getSelection().selectRanges(i)}function i(e){var t,o=(e=e.editor||e.sender.editor)&&e.getSelection(),i=o&&o.getRanges()||[],r=(r=i&&i[0].getEnclosedNode())&&r.type==CKEDITOR.NODE_ELEMENT&&r.is("img");if(o&&(n(e),o.isInTable()&&o.isFake))if(r)e.getSelection().reset();else if(!i[0]._getTableElement({table:1}).hasAttribute("data-cke-tableselection-ignored")){for(1===i.length&&i[0]._getTableElement()&&i[0]._getTableElement().is("table")&&(t=i[0]._getTableElement()),t=f(o,t),e.fire("lockSnapshot"),o=0;o<t.length;o++)t[o].addClass("cke_table-faked-selection");0<t.length&&(e.editable().addClass("cke_table-faked-selection-editor"),t[0].getAscendant("table").data("cke-table-faked-selection-table","")),e.fire("unlockSnapshot")}}function r(e){return e.getAscendant("tr",!0).$.rowIndex}function a(i){function r(e){return!e.getAscendant("table",!0)&&e.getDocument().equals(s.document)}if(i.data.getTarget().getName&&("mouseup"===i.name||!e(i.data.getTarget()))){var s=i.editor||i.listenerData.editor,l=s.getSelection(1),u=function(e){return(e=e.editable().findOne(".cke_table-faked-selection"))&&e.getAscendant("table")}(s),c=(d=i.data.getTarget())&&d.getAscendant({td:1,th:1},!0),d=d&&d.getAscendant("table",!0),h={table:1,thead:1,tbody:1,tfoot:1,tr:1,td:1,th:1};d&&d.hasAttribute("data-cke-tableselection-ignored")||(function(e,t,n,o){return!("mousedown"!==e.name||CKEDITOR.tools.getMouseButton(e)!==CKEDITOR.MOUSE_BUTTON_LEFT&&o)||((t=e.name===(CKEDITOR.env.gecko?"mousedown":"mouseup")&&!r(e.data.getTarget()))&&(t=!((e=e.data.getTarget().getAscendant({td:1,th:1},!0))&&e.hasClass("cke_table-faked-selection"))),t)}(i,l,0,d)&&n(s,!0),!p.active&&"mousedown"===i.name&&CKEDITOR.tools.getMouseButton(i)===CKEDITOR.MOUSE_BUTTON_LEFT&&d&&(p={active:!0},CKEDITOR.document.on("mouseup",a,null,{editor:s})),(c||d)&&function(i,r,a){var s,l=f(i.getSelection(!0));if(r=r.is("table")?null:r,(s=p.active&&!p.first)&&!(s=r)&&(s=i.getSelection().getRanges(),s=!!(1<l.length||s[0]&&!s[0].collapsed)),s)p.first=r||l[0],p.dirty=!r&&1!==l.length;else if(p.active&&r&&p.first.getAscendant("table").equals(r.getAscendant("table"))){if(l=t(p.first,r),!p.dirty&&1===l.length&&!e(a.data.getTarget()))return n(i,"mouseup"===a.name);p.dirty=!0,p.last=r,o(i,l)}}(s,c||d,i),"mouseup"===i.name&&(CKEDITOR.tools.getMouseButton(i)===CKEDITOR.MOUSE_BUTTON_LEFT&&(r(i.data.getTarget())||function(e,t){return!(!e||!t)&&(e.equals(t)||e.contains(t)||t.contains(e)||e.getCommonAncestor(t).is(h))}(u,d))&&function(e){var n=e.editable().find(".cke_table-faked-selection");1>n.count()||o(e,n=t(n.getItem(0),n.getItem(n.count()-1)))}(s),p={active:!1},CKEDITOR.document.removeListener("mouseup",a)))}}function s(e){var t=e.data.getTarget().getAscendant("table",!0);t&&t.hasAttribute("data-cke-tableselection-ignored")||(t=e.data.getTarget().getAscendant({td:1,th:1},!0))&&!t.hasClass("cke_table-faked-selection")&&(e.cancel(),e.data.preventDefault())}function l(e){var t=e.editor||e.sender.editor,n=t.getSelection();n.isInTable()&&(n.getRanges()[0]._getTableElement({table:1}).hasAttribute("data-cke-tableselection-ignored")||function(e,t){var n,o,i,r,a=e.getSelection(),s=a.createBookmarks(),l=e.document,u=e.createRange(),c=l.getDocumentElement().$,d=CKEDITOR.env.ie&&9>CKEDITOR.env.version,f=e.blockless||CKEDITOR.env.ie?"span":"div";l.getById("cke_table_copybin")||(n=l.createElement(f),(o=l.createElement(f)).setAttributes({id:"cke_table_copybin","data-cke-temp":"1"}),n.setStyles({position:"absolute",width:"1px",height:"1px",overflow:"hidden"}),n.setStyle("ltr"==e.config.contentsLangDirection?"left":"right","-5000px"),n.setHtml(e.getSelectedHtml(!0)),e.fire("lockSnapshot"),o.append(n),e.editable().append(o),r=e.on("selectionChange",(function(e){e.cancel()}),null,null,0),d&&(i=c.scrollTop),u.selectNodeContents(n),u.select(),d&&(c.scrollTop=i),setTimeout((function(){o.remove(),a.selectBookmarks(s),r.removeListener(),e.fire("unlockSnapshot"),t&&(e.extractSelectedHtml(),e.fire("saveSnapshot"))}),100))}(t,"cut"===e.name))}function u(e){this._reset(),e&&this.setSelectedCells(e)}function c(e,t,n){e.on("beforeCommandExec",(function(n){-1!==CKEDITOR.tools.array.indexOf(t,n.data.name)&&(n.data.selectedCells=f(e.getSelection()))})),e.on("afterCommandExec",(function(o){-1!==CKEDITOR.tools.array.indexOf(t,o.data.name)&&n(e,o.data)}))}var d,f,h,g,m,p={active:!1};(u.prototype={})._reset=function(){this.cells={first:null,last:null,all:[]},this.rows={first:null,last:null}},u.prototype.setSelectedCells=function(e){this._reset(),e=e.slice(0),this._arraySortByDOMOrder(e),this.cells.all=e,this.cells.first=e[0],this.cells.last=e[e.length-1],this.rows.first=e[0].getAscendant("tr"),this.rows.last=this.cells.last.getAscendant("tr")},u.prototype.getTableMap=function(){var e,t=h(this.cells.first);e:{var n,o=(e=this.cells.last).getAscendant("table"),i=r(e);for(o=CKEDITOR.tools.buildTableMap(o),n=0;n<o[i].length;n++)if(new CKEDITOR.dom.element(o[i][n]).equals(e)){e=n;break e}e=void 0}return CKEDITOR.tools.buildTableMap(this._getTable(),r(this.rows.first),t,r(this.rows.last),e)},u.prototype._getTable=function(){return this.rows.first.getAscendant("table")},u.prototype.insertRow=function(e,t,n){if(void 0===e)e=1;else if(0>=e)return;for(var o,i=this.cells.first.$.cellIndex,r=this.cells.last.$.cellIndex,a=n?[]:this.cells.all,s=0;s<e;s++)o=g(n?this.cells.all:a,t),o=CKEDITOR.tools.array.filter(o.find("td, th").toArray(),(function(e){return!!n||e.$.cellIndex>=i&&e.$.cellIndex<=r})),a=t?o.concat(a):a.concat(o);this.setSelectedCells(a)},u.prototype.insertColumn=function(e){function t(e){return(e=r(e))>=o&&e<=i}if(void 0===e)e=1;else if(0>=e)return;for(var n=(a=this.cells).all,o=r(a.first),i=r(a.last),a=0;a<e;a++)n=n.concat(CKEDITOR.tools.array.filter(m(n),t));this.setSelectedCells(n)},u.prototype.emptyCells=function(e){e=e||this.cells.all;for(var t=0;t<e.length;t++)e[t].setHtml("")},u.prototype._arraySortByDOMOrder=function(e){e.sort((function(e,t){return e.getPosition(t)&CKEDITOR.POSITION_PRECEDING?-1:1}))};var v={onPaste:function(e){function n(e){return Math.max.apply(null,CKEDITOR.tools.array.map(e,(function(e){return e.length}),0))}var i=e.editor,r=i.getSelection();if(!(c=(c=r.getRanges()).length&&c[0]._getTableElement({table:1}))||!c.hasAttribute("data-cke-tableselection-ignored")){var a,s,l=f(r),c=this.findTableInPastedContent(i,e.data.dataValue),d=r.isInTable(!0)&&this.isBoundarySelection(r);!l.length||1===l.length&&!function(e){if(e)return(e=e.clone()).enlarge(CKEDITOR.ENLARGE_ELEMENT),(e=e.getEnclosedNode())&&e.is&&e.is(CKEDITOR.dtd.$tableContent)}(r.getRanges()[0])&&!d||d&&!c||(l=l[0].getAscendant("table"),a=new u(f(r,l)),i.once("afterPaste",(function(){var e;if(s){e=new CKEDITOR.dom.element(s[0][0]);var n=s[s.length-1];e=t(e,new CKEDITOR.dom.element(n[n.length-1]))}else e=a.cells.all;o(i,e)})),c?(e.stop(),d?(a.insertRow(1,1===d,!0),r.selectElement(a.rows.first)):(a.emptyCells(),o(i,a.cells.all)),e=a.getTableMap(),s=CKEDITOR.tools.buildTableMap(c),a.insertRow(s.length-e.length),a.insertColumn(n(s)-n(e)),e=a.getTableMap(),this.pasteTable(a,e,s),i.fire("saveSnapshot"),setTimeout((function(){i.fire("afterPaste")}),0)):(function(e){var t=i.createRange();t.selectNodeContents(e),t.select()}(a.cells.first),i.once("afterPaste",(function(){i.fire("lockSnapshot"),a.emptyCells(a.cells.all.slice(1)),o(i,a.cells.all),i.fire("unlockSnapshot")}))))}},isBoundarySelection:function(e){var t=(e=e.getRanges()[0]).endContainer.getAscendant("tr",!0);if(t&&e.collapsed){if(e.checkBoundaryOfElement(t,CKEDITOR.START))return 1;if(e.checkBoundaryOfElement(t,CKEDITOR.END))return 2}return 0},findTableInPastedContent:function(e,t){var n=e.dataProcessor,o=new CKEDITOR.dom.element("body");return n||(n=new CKEDITOR.htmlDataProcessor(e)),o.setHtml(n.toHtml(t),{fixForBody:!1}),1<o.getChildCount()?null:o.findOne("table")},pasteTable:function(e,t,n){var o,i,r,a,s,l=h(e.cells.first),u=e._getTable(),c={};for(a=0;a<n.length;a++)for(i=new CKEDITOR.dom.element(u.$.rows[e.rows.first.$.rowIndex+a]),s=0;s<n[a].length;s++)r=new CKEDITOR.dom.element(n[a][s]),o=t[a]&&t[a][s]?new CKEDITOR.dom.element(t[a][s]):null,r&&!r.getCustomData("processed")?(o&&o.getParent()?r.replace(o):(0===s||n[a][s-1])&&((o=0!==s?new CKEDITOR.dom.element(n[a][s-1]):null)&&i.equals(o.getParent())?r.insertAfter(o):0<l?i.$.cells[l]?r.insertAfter(new CKEDITOR.dom.element(i.$.cells[l])):i.append(r):i.append(r,!0)),CKEDITOR.dom.element.setMarker(c,r,"processed",!0)):r.getCustomData("processed")&&o&&o.remove();CKEDITOR.dom.element.clearAllMarkers(c)}};CKEDITOR.plugins.tableselection={getCellsBetween:t,keyboardIntegration:function(e){function t(e){var t=e.getEnclosedNode();t&&"function"==typeof t.is&&t.is({td:1,th:1})?t.setText(""):e.deleteContents(),CKEDITOR.tools.array.forEach(e._find("td"),(function(e){e.appendBogus()}))}var n=e.editable();n.attachListener(n,"keydown",function(e){function n(t,n){if(!n.length)return null;var o=e.createRange(),r=CKEDITOR.dom.range.mergeRanges(n);CKEDITOR.tools.array.forEach(r,(function(e){e.enlarge(CKEDITOR.ENLARGE_ELEMENT)}));var a=(s=r[0].getBoundaryNodes()).startNode,s=s.endNode;if(a&&a.is&&a.is(i)){for(var l=a.getAscendant("table",!0),u=a.getPreviousSourceNode(!1,CKEDITOR.NODE_ELEMENT,l),c=!1,d=function(e){return!a.contains(e)&&e.is&&e.is("td","th")};u&&!d(u);)u=u.getPreviousSourceNode(!1,CKEDITOR.NODE_ELEMENT,l);return!u&&s&&s.is&&!s.is("table")&&s.getNext()&&(u=s.getNext().findOne("td, th"),c=!0),u?o["moveToElementEdit"+(c?"Start":"End")](u):(o.setStartBefore(a.getAscendant("table",!0)),o.collapse(!0)),r[0].deleteContents(),[o]}return a?(o.moveToElementEditablePosition(a),[o]):void 0}var o={37:1,38:1,39:1,40:1,8:1,46:1,13:1},i=CKEDITOR.tools.extend({table:1},CKEDITOR.dtd.$tableContent);return delete i.td,delete i.th,function(i){var r,a,s,l,u=i.data.getKey(),c=i.data.getKeystroke(),d=37===u||38==u;if(o[u]&&!e.readOnly&&(r=e.getSelection())&&r.isInTable()&&r.isFake)if(s=(a=r.getRanges())[0]._getTableElement(),l=a[a.length-1]._getTableElement(),(13!==u||e.plugins.enterkey)&&(i.data.preventDefault(),i.cancel()),36<u&&41>u)a[0].moveToElementEditablePosition(d?s:l,!d),r.selectRanges([a[0]]);else if(13!==u||13===c||c===CKEDITOR.SHIFT+13){for(i=0;i<a.length;i++)t(a[i]);(i=n(0,a))?a=i:a[0].moveToElementEditablePosition(s),r.selectRanges(a),13===u&&e.plugins.enterkey?(e.fire("lockSnapshot"),e.execCommand(13===c?"enter":"shiftEnter"),e.fire("unlockSnapshot"),e.fire("saveSnapshot")):13!==u&&e.fire("saveSnapshot")}}}(e),null,null,-1),n.attachListener(n,"keypress",(function(n){var o,i=e.getSelection(),r=n.data.$.charCode||13===n.data.getKey();if(!e.readOnly&&i&&i.isInTable()&&i.isFake&&r&&!(n.data.getKeystroke()&CKEDITOR.CTRL)){for(r=(n=i.getRanges())[0].getEnclosedNode().getAscendant({td:1,th:1},!0),o=0;o<n.length;o++)t(n[o]);r&&(n[0].moveToElementEditablePosition(r),i.selectRanges([n[0]]))}}),null,null,-1)}},CKEDITOR.plugins.add("tableselection",{requires:"clipboard,tabletools",isSupportedEnvironment:function(){return!(CKEDITOR.env.ie&&11>CKEDITOR.env.version)},onLoad:function(){d=CKEDITOR.plugins.tabletools,f=d.getSelectedCells,h=d.getCellColIndex,g=d.insertRow,m=d.insertColumn,CKEDITOR.document.appendStyleSheet(this.path+"styles/tableselection.css")},init:function(e){this.isSupportedEnvironment()&&(e.addContentsCss&&e.addContentsCss(this.path+"styles/tableselection.css"),e.on("contentDom",(function(){var t=e.editable(),n=t.isInline()?t:e.document,o={editor:e};t.attachListener(n,"mousedown",a,null,o),t.attachListener(n,"mousemove",a,null,o),t.attachListener(n,"mouseup",a,null,o),t.attachListener(t,"dragstart",s),t.attachListener(e,"selectionCheck",i),CKEDITOR.plugins.tableselection.keyboardIntegration(e),CKEDITOR.plugins.clipboard&&!CKEDITOR.plugins.clipboard.isCustomCopyCutSupported&&(t.attachListener(t,"cut",l),t.attachListener(t,"copy",l))})),e.on("paste",v.onPaste,v),c(e,"rowInsertBefore rowInsertAfter columnInsertBefore columnInsertAfter cellInsertBefore cellInsertAfter".split(" "),(function(e,t){o(e,t.selectedCells)})),c(e,["cellMerge","cellMergeRight","cellMergeDown"],(function(e,t){o(e,[t.commandData.cell])})),c(e,["cellDelete"],(function(e){n(e,!0)})))}})}(),function(){var e=[CKEDITOR.CTRL+90,CKEDITOR.CTRL+89,CKEDITOR.CTRL+CKEDITOR.SHIFT+90],t={8:1,46:1};CKEDITOR.plugins.add("undo",{init:function(t){function o(e){a.enabled&&!1!==e.data.command.canUndo&&a.save()}function i(){a.enabled=!t.readOnly&&"wysiwyg"==t.mode,a.onChange()}var a=t.undoManager=new n(t),s=a.editingHandler=new r(a),l=t.addCommand("undo",{exec:function(){a.undo()&&(t.selectionChange(),this.fire("afterUndo"))},startDisabled:!0,canUndo:!1}),u=t.addCommand("redo",{exec:function(){a.redo()&&(t.selectionChange(),this.fire("afterRedo"))},startDisabled:!0,canUndo:!1});t.setKeystroke([[e[0],"undo"],[e[1],"redo"],[e[2],"redo"]]),a.onChange=function(){l.setState(a.undoable()?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED),u.setState(a.redoable()?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED)},t.on("beforeCommandExec",o),t.on("afterCommandExec",o),t.on("saveSnapshot",(function(e){a.save(e.data&&e.data.contentOnly)})),t.on("contentDom",s.attachListeners,s),t.on("instanceReady",(function(){t.fire("saveSnapshot")})),t.on("beforeModeUnload",(function(){"wysiwyg"==t.mode&&a.save(!0)})),t.on("mode",i),t.on("readOnly",i),t.ui.addButton&&(t.ui.addButton("Undo",{label:t.lang.undo.undo,command:"undo",toolbar:"undo,10"}),t.ui.addButton("Redo",{label:t.lang.undo.redo,command:"redo",toolbar:"undo,20"})),t.resetUndo=function(){a.reset(),t.fire("saveSnapshot")},t.on("updateSnapshot",(function(){a.currentImage&&a.update()})),t.on("lockSnapshot",(function(e){a.lock((e=e.data)&&e.dontUpdate,e&&e.forceUpdate)})),t.on("unlockSnapshot",a.unlock,a)}}),CKEDITOR.plugins.undo={};var n=CKEDITOR.plugins.undo.UndoManager=function(e){this.strokesRecorded=[0,0],this.locked=null,this.previousKeyGroup=-1,this.limit=e.config.undoStackSize||20,this.strokesLimit=25,this._filterRules=[],this.editor=e,this.reset(),CKEDITOR.env.ie&&this.addFilterRule((function(e){return e.replace(/\s+data-cke-expando=".*?"/g,"")}))};n.prototype={type:function(e,t){var o=n.getKeyGroup(e),i=this.strokesRecorded[o]+1;t=t||i>=this.strokesLimit,this.typing||(this.hasUndo=this.typing=!0,this.hasRedo=!1,this.onChange()),t?(i=0,this.editor.fire("saveSnapshot")):this.editor.fire("change"),this.strokesRecorded[o]=i,this.previousKeyGroup=o},keyGroupChanged:function(e){return n.getKeyGroup(e)!=this.previousKeyGroup},reset:function(){this.snapshots=[],this.index=-1,this.currentImage=null,this.hasRedo=this.hasUndo=!1,this.locked=null,this.resetType()},resetType:function(){this.strokesRecorded=[0,0],this.typing=!1,this.previousKeyGroup=-1},refreshState:function(){this.hasUndo=!!this.getNextImage(!0),this.hasRedo=!!this.getNextImage(!1),this.resetType(),this.onChange()},save:function(e,t,n){var i=this.editor;if(this.locked||"ready"!=i.status||"wysiwyg"!=i.mode)return!1;var r=i.editable();if(!r||"ready"!=r.status)return!1;if(r=this.snapshots,t||(t=new o(i)),!1===t.contents)return!1;if(this.currentImage)if(t.equalsContent(this.currentImage)){if(e||t.equalsSelection(this.currentImage))return!1}else!1!==n&&i.fire("change");return r.splice(this.index+1,r.length-this.index-1),r.length==this.limit&&r.shift(),this.index=r.push(t)-1,this.currentImage=t,!1!==n&&this.refreshState(),!0},restoreImage:function(e){var t,n=this.editor;e.bookmarks&&(n.focus(),t=n.getSelection()),this.locked={level:999},this.editor.loadSnapshot(e.contents),e.bookmarks?t.selectBookmarks(e.bookmarks):CKEDITOR.env.ie&&((t=this.editor.document.getBody().$.createTextRange()).collapse(!0),t.select()),this.locked=null,this.index=e.index,this.currentImage=this.snapshots[this.index],this.update(),this.refreshState(),n.fire("change")},getNextImage:function(e){var t,n=this.snapshots,o=this.currentImage;if(o)if(e){for(t=this.index-1;0<=t;t--)if(!o.equalsContent(e=n[t]))return e.index=t,e}else for(t=this.index+1;t<n.length;t++)if(!o.equalsContent(e=n[t]))return e.index=t,e;return null},redoable:function(){return this.enabled&&this.hasRedo},undoable:function(){return this.enabled&&this.hasUndo},undo:function(){if(this.undoable()){this.save(!0);var e=this.getNextImage(!0);if(e)return this.restoreImage(e),!0}return!1},redo:function(){if(this.redoable()&&(this.save(!0),this.redoable())){var e=this.getNextImage(!1);if(e)return this.restoreImage(e),!0}return!1},update:function(e){if(!this.locked){e||(e=new o(this.editor));for(var t=this.index,n=this.snapshots;0<t&&this.currentImage.equalsContent(n[t-1]);)--t;n.splice(t,this.index-t+1,e),this.index=t,this.currentImage=e}},updateSelection:function(e){if(!this.snapshots.length)return!1;var t=this.snapshots,n=t[t.length-1];return!(!n.equalsContent(e)||n.equalsSelection(e)||(this.currentImage=t[t.length-1]=e,0))},lock:function(e,t){if(this.locked)this.locked.level++;else if(e)this.locked={level:1};else{var n=null;if(t)n=!0;else{var i=new o(this.editor,!0);this.currentImage&&this.currentImage.equalsContent(i)&&(n=i)}this.locked={update:n,level:1}}},unlock:function(){if(this.locked&&!--this.locked.level){var e=this.locked.update;if(this.locked=null,!0===e)this.update();else if(e){var t=new o(this.editor,!0);e.equalsContent(t)||this.update()}}},addFilterRule:function(e){this._filterRules.push(e)}},n.navigationKeyCodes={37:1,38:1,39:1,40:1,36:1,35:1,33:1,34:1},n.keyGroups={PRINTABLE:0,FUNCTIONAL:1},n.isNavigationKey=function(e){return!!n.navigationKeyCodes[e]},n.getKeyGroup=function(e){var o=n.keyGroups;return t[e]?o.FUNCTIONAL:o.PRINTABLE},n.getOppositeKeyGroup=function(e){var t=n.keyGroups;return e==t.FUNCTIONAL?t.PRINTABLE:t.FUNCTIONAL},n.ieFunctionalKeysBug=function(e){return CKEDITOR.env.ie&&n.getKeyGroup(e)==n.keyGroups.FUNCTIONAL};var o=CKEDITOR.plugins.undo.Image=function(e,t){this.editor=e,e.fire("beforeUndoImage");var n=e.getSnapshot();n&&(this.contents=function(e,t){return CKEDITOR.tools.array.reduce(t,(function(e,t){return t(e)}),e)}(n,e.undoManager._filterRules)),t||(this.bookmarks=(n=n&&e.getSelection())&&n.createBookmarks2(!0)),e.fire("afterUndoImage")},i=/\b(?:href|src|name)="[^"]*?"/gi;o.prototype={equalsContent:function(e){var t=this.contents;return e=e.contents,CKEDITOR.env.ie&&(CKEDITOR.env.ie7Compat||CKEDITOR.env.quirks)&&(t=t.replace(i,""),e=e.replace(i,"")),t==e},equalsSelection:function(e){var t=this.bookmarks;if(e=e.bookmarks,t||e){if(!t||!e||t.length!=e.length)return!1;for(var n=0;n<t.length;n++){var o=t[n],i=e[n];if(o.startOffset!=i.startOffset||o.endOffset!=i.endOffset||!CKEDITOR.tools.arrayCompare(o.start,i.start)||!CKEDITOR.tools.arrayCompare(o.end,i.end))return!1}}return!0}};var r=CKEDITOR.plugins.undo.NativeEditingHandler=function(e){this.undoManager=e,this.ignoreInputEvent=!1,this.keyEventsStack=new a,this.lastKeydownImage=null};r.prototype={onKeydown:function(t){var i=t.data.getKey();229!==i&&(-1<CKEDITOR.tools.indexOf(e,t.data.getKeystroke())?t.data.preventDefault():(this.keyEventsStack.cleanUp(t),t=this.undoManager,this.keyEventsStack.getLast(i)||this.keyEventsStack.push(i),this.lastKeydownImage=new o(t.editor),(n.isNavigationKey(i)||this.undoManager.keyGroupChanged(i))&&(t.strokesRecorded[0]||t.strokesRecorded[1])&&(t.save(!1,this.lastKeydownImage,!1),t.resetType())))},onInput:function(){if(this.ignoreInputEvent)this.ignoreInputEvent=!1;else{var e=this.keyEventsStack.getLast();e||(e=this.keyEventsStack.push(0)),this.keyEventsStack.increment(e.keyCode),this.keyEventsStack.getTotalInputs()>=this.undoManager.strokesLimit&&(this.undoManager.type(e.keyCode,!0),this.keyEventsStack.resetInputs())}},onKeyup:function(e){var t=this.undoManager;e=e.data.getKey();var i=this.keyEventsStack.getTotalInputs();this.keyEventsStack.remove(e),n.ieFunctionalKeysBug(e)&&this.lastKeydownImage&&this.lastKeydownImage.equalsContent(new o(t.editor,!0))||(0<i?t.type(e):n.isNavigationKey(e)&&this.onNavigationKey(!0))},onNavigationKey:function(e){var t=this.undoManager;!e&&t.save(!0,null,!1)||t.updateSelection(new o(t.editor)),t.resetType()},ignoreInputEventListener:function(){this.ignoreInputEvent=!0},activateInputEventListener:function(){this.ignoreInputEvent=!1},attachListeners:function(){var e=this.undoManager.editor,t=e.editable(),o=this;t.attachListener(t,"keydown",(function(e){o.onKeydown(e),n.ieFunctionalKeysBug(e.data.getKey())&&o.onInput()}),null,null,999),t.attachListener(t,CKEDITOR.env.ie?"keypress":"input",o.onInput,o,null,999),t.attachListener(t,"keyup",o.onKeyup,o,null,999),t.attachListener(t,"paste",o.ignoreInputEventListener,o,null,999),t.attachListener(t,"drop",o.ignoreInputEventListener,o,null,999),e.on("afterPaste",o.activateInputEventListener,o,null,999),t.attachListener(t.isInline()?t:e.document.getDocumentElement(),"click",(function(){o.onNavigationKey()}),null,null,999),t.attachListener(this.undoManager.editor,"blur",(function(){o.keyEventsStack.remove(9)}),null,null,999)}};var a=CKEDITOR.plugins.undo.KeyEventsStack=function(){this.stack=[]};a.prototype={push:function(e){return e=this.stack.push({keyCode:e,inputs:0}),this.stack[e-1]},getLastIndex:function(e){if("number"!=typeof e)return this.stack.length-1;for(var t=this.stack.length;t--;)if(this.stack[t].keyCode==e)return t;return-1},getLast:function(e){return-1!=(e=this.getLastIndex(e))?this.stack[e]:null},increment:function(e){this.getLast(e).inputs++},remove:function(e){-1!=(e=this.getLastIndex(e))&&this.stack.splice(e,1)},resetInputs:function(e){if("number"==typeof e)this.getLast(e).inputs=0;else for(e=this.stack.length;e--;)this.stack[e].inputs=0},getTotalInputs:function(){for(var e=this.stack.length,t=0;e--;)t+=this.stack[e].inputs;return t},cleanUp:function(e){(e=e.data.$).ctrlKey||e.metaKey||this.remove(17),e.shiftKey||this.remove(16),e.altKey||this.remove(18)}}}(),function(){function e(e,t){CKEDITOR.tools.extend(this,{editor:e,editable:e.editable(),doc:e.document,win:e.window},t,!0),this.inline=this.editable.isInline(),this.inline||(this.frame=this.win.getFrame()),this.target=this[this.inline?"editable":"doc"]}function t(e,t){CKEDITOR.tools.extend(this,t,{editor:e},!0)}function n(e,t){var n=e.editable();CKEDITOR.tools.extend(this,{editor:e,editable:n,inline:n.isInline(),doc:e.document,win:e.window,container:CKEDITOR.document.getBody(),winTop:CKEDITOR.document.getWindow()},t,!0),this.hidden={},this.visible={},this.inline||(this.frame=this.win.getFrame()),this.queryViewport();var o=CKEDITOR.tools.bind(this.queryViewport,this),a=CKEDITOR.tools.bind(this.hideVisible,this),s=CKEDITOR.tools.bind(this.removeAll,this);n.attachListener(this.winTop,"resize",o),n.attachListener(this.winTop,"scroll",o),n.attachListener(this.winTop,"resize",a),n.attachListener(this.win,"scroll",a),n.attachListener(this.inline?n:this.frame,"mouseout",(function(e){var t=e.data.$.clientX;e=e.data.$.clientY,this.queryViewport(),(t<=this.rect.left||t>=this.rect.right||e<=this.rect.top||e>=this.rect.bottom)&&this.hideVisible(),(0>=t||t>=this.winTopPane.width||0>=e||e>=this.winTopPane.height)&&this.hideVisible()}),this),n.attachListener(e,"resize",o),n.attachListener(e,"mode",s),e.on("destroy",s),this.lineTpl=new CKEDITOR.template('<div data-cke-lineutils-line="1" class="cke_reset_all" style="{lineStyle}"><span style="{tipLeftStyle}">&nbsp;</span><span style="{tipRightStyle}">&nbsp;</span></div>').output({lineStyle:CKEDITOR.tools.writeCssText(CKEDITOR.tools.extend({},r,this.lineStyle,!0)),tipLeftStyle:CKEDITOR.tools.writeCssText(CKEDITOR.tools.extend({},i,{left:"0px","border-left-color":"red","border-width":"6px 0 6px 6px"},this.tipCss,this.tipLeftStyle,!0)),tipRightStyle:CKEDITOR.tools.writeCssText(CKEDITOR.tools.extend({},i,{right:"0px","border-right-color":"red","border-width":"6px 6px 6px 0"},this.tipCss,this.tipRightStyle,!0))})}function o(e){var t;return(t=e&&e.type==CKEDITOR.NODE_ELEMENT)&&(t=!(a[e.getComputedStyle("float")]||a[e.getAttribute("align")])),t&&!s[e.getComputedStyle("position")]}CKEDITOR.plugins.add("lineutils"),CKEDITOR.LINEUTILS_BEFORE=1,CKEDITOR.LINEUTILS_AFTER=2,CKEDITOR.LINEUTILS_INSIDE=4,e.prototype={start:function(e){var t,n,o,i,r=this,a=this.editor,s=this.doc,l=CKEDITOR.tools.eventsBuffer(50,(function(){a.readOnly||"wysiwyg"!=a.mode||(r.relations={},(n=s.$.elementFromPoint(o,i))&&n.nodeType&&(t=new CKEDITOR.dom.element(n),r.traverseSearch(t),isNaN(o+i)||r.pixelSearch(t,o,i),e&&e(r.relations,o,i)))}));this.listener=this.editable.attachListener(this.target,"mousemove",(function(e){o=e.data.$.clientX,i=e.data.$.clientY,l.input()})),this.editable.attachListener(this.inline?this.editable:this.frame,"mouseout",(function(){l.reset()}))},stop:function(){this.listener&&this.listener.removeListener()},getRange:function(){var e={};return e[CKEDITOR.LINEUTILS_BEFORE]=CKEDITOR.POSITION_BEFORE_START,e[CKEDITOR.LINEUTILS_AFTER]=CKEDITOR.POSITION_AFTER_END,e[CKEDITOR.LINEUTILS_INSIDE]=CKEDITOR.POSITION_AFTER_START,function(t){var n=this.editor.createRange();return n.moveToPosition(this.relations[t.uid].element,e[t.type]),n}}(),store:function(){function e(e,t,n){var o=e.getUniqueId();o in n?n[o].type|=t:n[o]={element:e,type:t}}return function(t,n){var i;n&CKEDITOR.LINEUTILS_AFTER&&o(i=t.getNext())&&i.isVisible()&&(e(i,CKEDITOR.LINEUTILS_BEFORE,this.relations),n^=CKEDITOR.LINEUTILS_AFTER),n&CKEDITOR.LINEUTILS_INSIDE&&o(i=t.getFirst())&&i.isVisible()&&(e(i,CKEDITOR.LINEUTILS_BEFORE,this.relations),n^=CKEDITOR.LINEUTILS_INSIDE),e(t,n,this.relations)}}(),traverseSearch:function(e){var t,n,i;do{if(!(i=e.$["data-cke-expando"])||!(i in this.relations)){if(e.equals(this.editable))break;if(o(e))for(t in this.lookups)(n=this.lookups[t](e))&&this.store(e,n)}}while((!e||e.type!=CKEDITOR.NODE_ELEMENT||"true"!=e.getAttribute("contenteditable"))&&(e=e.getParent()))},pixelSearch:function(){function e(e,n,i,r,a){for(var s,l=0;a(i)&&(i+=r,25!=++l);)if(s=this.doc.$.elementFromPoint(n,i))if(s==e)l=0;else if(t(e,s)&&(l=0,o(s=new CKEDITOR.dom.element(s))))return s}var t=CKEDITOR.env.ie||CKEDITOR.env.webkit?function(e,t){return e.contains(t)}:function(e,t){return!!(16&e.compareDocumentPosition(t))};return function(t,n,i){var r=this.win.getViewPaneSize().height,a=e.call(this,t.$,n,i,-1,(function(e){return 0<e}));if(n=e.call(this,t.$,n,i,1,(function(e){return e<r})),a)for(this.traverseSearch(a);!a.getParent().equals(t);)a=a.getParent();if(n)for(this.traverseSearch(n);!n.getParent().equals(t);)n=n.getParent();for(;(a||n)&&(a&&(a=a.getNext(o)),a&&!a.equals(n))&&(this.traverseSearch(a),n&&(n=n.getPrevious(o)),n&&!n.equals(a));)this.traverseSearch(n)}}(),greedySearch:function(){this.relations={};for(var e,t,n,i=this.editable.getElementsByTag("*"),r=0;e=i.getItem(r++);)if(!e.equals(this.editable)&&e.type==CKEDITOR.NODE_ELEMENT&&(e.hasAttribute("contenteditable")||!e.isReadOnly())&&o(e)&&e.isVisible())for(n in this.lookups)(t=this.lookups[n](e))&&this.store(e,t);return this.relations}},t.prototype={locate:function(){function e(e,t){var n=e.element[t===CKEDITOR.LINEUTILS_BEFORE?"getPrevious":"getNext"]();return n&&o(n)?(e.siblingRect=n.getClientRect(),t==CKEDITOR.LINEUTILS_BEFORE?(e.siblingRect.bottom+e.elementRect.top)/2:(e.elementRect.bottom+e.siblingRect.top)/2):t==CKEDITOR.LINEUTILS_BEFORE?e.elementRect.top:e.elementRect.bottom}return function(t){var n;for(var o in this.locations={},t)(n=t[o]).elementRect=n.element.getClientRect(),n.type&CKEDITOR.LINEUTILS_BEFORE&&this.store(o,CKEDITOR.LINEUTILS_BEFORE,e(n,CKEDITOR.LINEUTILS_BEFORE)),n.type&CKEDITOR.LINEUTILS_AFTER&&this.store(o,CKEDITOR.LINEUTILS_AFTER,e(n,CKEDITOR.LINEUTILS_AFTER)),n.type&CKEDITOR.LINEUTILS_INSIDE&&this.store(o,CKEDITOR.LINEUTILS_INSIDE,(n.elementRect.top+n.elementRect.bottom)/2);return this.locations}}(),sort:function(){var e,t,n,o;return function(i,r){for(var a in t=[],e=this.locations)for(var s in e[a])if(n=Math.abs(i-e[a][s]),t.length){for(o=0;o<t.length;o++)if(n<t[o].dist){t.splice(o,0,{uid:+a,type:s,dist:n});break}o==t.length&&t.push({uid:+a,type:s,dist:n})}else t.push({uid:+a,type:s,dist:n});return void 0!==r?t.slice(0,r):t}}(),store:function(e,t,n){this.locations[e]||(this.locations[e]={}),this.locations[e][t]=n}};var i={display:"block",width:"0px",height:"0px","border-color":"transparent","border-style":"solid",position:"absolute",top:"-6px"},r={height:"0px","border-top":"1px dashed red",position:"absolute","z-index":9999};n.prototype={removeAll:function(){for(var e in this.hidden)this.hidden[e].remove(),delete this.hidden[e];for(e in this.visible)this.visible[e].remove(),delete this.visible[e]},hideLine:function(e){var t=e.getUniqueId();e.hide(),this.hidden[t]=e,delete this.visible[t]},showLine:function(e){var t=e.getUniqueId();e.show(),this.visible[t]=e,delete this.hidden[t]},hideVisible:function(){for(var e in this.visible)this.hideLine(this.visible[e])},placeLine:function(e,t){var n,o,i;if(n=this.getStyle(e.uid,e.type)){for(i in this.visible)if(this.visible[i].getCustomData("hash")!==this.hash){o=this.visible[i];break}if(!o)for(i in this.hidden)if(this.hidden[i].getCustomData("hash")!==this.hash){this.showLine(o=this.hidden[i]);break}o||this.showLine(o=this.addLine()),o.setCustomData("hash",this.hash),this.visible[o.getUniqueId()]=o,o.setStyles(n),t&&t(o)}},getStyle:function(e,t){var n=this.relations[e],o=this.locations[e][t],i={};if(i.width=n.siblingRect?Math.max(n.siblingRect.width,n.elementRect.width):n.elementRect.width,i.top=this.inline?o+this.winTopScroll.y-this.rect.relativeY:this.rect.top+this.winTopScroll.y+o,i.top-this.winTopScroll.y<this.rect.top||i.top-this.winTopScroll.y>this.rect.bottom)return!1;for(var r in this.inline?i.left=n.elementRect.left-this.rect.relativeX:(0<n.elementRect.left?i.left=this.rect.left+n.elementRect.left:(i.width+=n.elementRect.left,i.left=this.rect.left),0<(n=i.left+i.width-(this.rect.left+this.winPane.width))&&(i.width-=n)),i.left+=this.winTopScroll.x,i)i[r]=CKEDITOR.tools.cssLength(i[r]);return i},addLine:function(){var e=CKEDITOR.dom.element.createFromHtml(this.lineTpl);return e.appendTo(this.container),e},prepare:function(e,t){this.relations=e,this.locations=t,this.hash=Math.random()},cleanup:function(){var e,t;for(t in this.visible)(e=this.visible[t]).getCustomData("hash")!==this.hash&&this.hideLine(e)},queryViewport:function(){this.winPane=this.win.getViewPaneSize(),this.winTopScroll=this.winTop.getScrollPosition(),this.winTopPane=this.winTop.getViewPaneSize(),this.rect=this.getClientRect(this.inline?this.editable:this.frame)},getClientRect:function(e){e=e.getClientRect();var t=this.container.getDocumentPosition(),n=this.container.getComputedStyle("position");return e.relativeX=e.relativeY=0,"static"!=n&&(e.relativeY=t.y,e.relativeX=t.x,e.top-=e.relativeY,e.bottom-=e.relativeY,e.left-=e.relativeX,e.right-=e.relativeX),e}};var a={left:1,right:1,center:1},s={absolute:1,fixed:1};CKEDITOR.plugins.lineutils={finder:e,locator:t,liner:n}}(),function(){function e(e){return e.getName&&!e.hasAttribute("data-cke-temp")}CKEDITOR.plugins.add("widgetselection",{init:function(e){if(CKEDITOR.env.webkit){var t=CKEDITOR.plugins.widgetselection;e.on("contentDom",(function(e){var n=(e=e.editor).editable();n.attachListener(n,"keydown",(function(e){e.data.getKeystroke()==CKEDITOR.CTRL+65&&CKEDITOR.tools.setTimeout((function(){t.addFillers(n)||t.removeFillers(n)}),0)}),null,null,-1),e.on("selectionCheck",(function(e){t.removeFillers(e.editor.editable())})),e.on("paste",(function(e){e.data.dataValue=t.cleanPasteData(e.data.dataValue)})),"selectall"in e.plugins&&t.addSelectAllIntegration(e)}))}}}),CKEDITOR.plugins.widgetselection={startFiller:null,endFiller:null,fillerAttribute:"data-cke-filler-webkit",fillerContent:"&nbsp;",fillerTagName:"div",addFillers:function(t){var n=t.editor;if(!this.isWholeContentSelected(t)&&0<t.getChildCount()){var o=t.getFirst(e),i=t.getLast(e);if(o&&o.type==CKEDITOR.NODE_ELEMENT&&!o.isEditable()&&(this.startFiller=this.createFiller(),t.append(this.startFiller,1)),i&&i.type==CKEDITOR.NODE_ELEMENT&&!i.isEditable()&&(this.endFiller=this.createFiller(!0),t.append(this.endFiller,0)),this.hasFiller(t))return(n=n.createRange()).selectNodeContents(t),n.select(),!0}return!1},removeFillers:function(e){if(this.hasFiller(e)&&!this.isWholeContentSelected(e)){var t=e.findOne(this.fillerTagName+"["+this.fillerAttribute+"=start]"),n=e.findOne(this.fillerTagName+"["+this.fillerAttribute+"=end]");this.startFiller&&t&&this.startFiller.equals(t)?this.removeFiller(this.startFiller,e):this.startFiller=t,this.endFiller&&n&&this.endFiller.equals(n)?this.removeFiller(this.endFiller,e):this.endFiller=n}},cleanPasteData:function(e){return e&&e.length&&(e=e.replace(this.createFillerRegex(),"").replace(this.createFillerRegex(!0),"")),e},isWholeContentSelected:function(e){var t=e.editor.getSelection().getRanges()[0];return!(!t||t&&t.collapsed||((t=t.clone()).enlarge(CKEDITOR.ENLARGE_ELEMENT),!(t&&e&&t.startContainer&&t.endContainer&&0===t.startOffset&&t.endOffset===e.getChildCount()&&t.startContainer.equals(e)&&t.endContainer.equals(e))))},hasFiller:function(e){return 0<e.find(this.fillerTagName+"["+this.fillerAttribute+"]").count()},createFiller:function(e){var t=new CKEDITOR.dom.element(this.fillerTagName);return t.setHtml(this.fillerContent),t.setAttribute(this.fillerAttribute,e?"end":"start"),t.setAttribute("data-cke-temp",1),t.setStyles({display:"block",width:0,height:0,padding:0,border:0,margin:0,position:"absolute",top:0,left:"-9999px",opacity:0,overflow:"hidden"}),t},removeFiller:function(e,t){if(e){var n,o,i=t.editor,r=t.editor.getSelection().getRanges()[0].startPath(),a=i.createRange();r.contains(e)&&(n=e.getHtml(),o=!0),r="start"==e.getAttribute(this.fillerAttribute),e.remove(),n&&0<n.length&&n!=this.fillerContent?(t.insertHtmlIntoRange(n,i.getSelection().getRanges()[0]),a.setStartAt(t.getChild(t.getChildCount()-1),CKEDITOR.POSITION_BEFORE_END),i.getSelection().selectRanges([a])):o&&(r?a.setStartAt(t.getFirst().getNext(),CKEDITOR.POSITION_AFTER_START):a.setEndAt(t.getLast().getPrevious(),CKEDITOR.POSITION_BEFORE_END),t.editor.getSelection().selectRanges([a]))}},createFillerRegex:function(e){var t=this.createFiller(e).getOuterHtml().replace(/style="[^"]*"/gi,'style="[^"]*"').replace(/>[^<]*</gi,">[^<]*<");return new RegExp((e?"":"^")+t+(e?"$":""))},addSelectAllIntegration:function(e){var t=this;e.editable().attachListener(e,"beforeCommandExec",(function(n){var o=e.editable();"selectAll"==n.data.name&&o&&t.addFillers(o)}),null,null,9999)}}}(),function(){function e(e){this.editor=e,this.registered={},this.instances={},this.selected=[],this.widgetHoldingFocusedEditable=this.focused=null,this._={nextId:0,upcasts:[],upcastCallbacks:[],filters:{}},function(e){var n,o,i=e.editor;i.on("toHtml",(function(o){var i,r=function(e){var n=[],o=e._.upcasts,i=e._.upcastCallbacks;return{toBeWrapped:n,iterator:function(e){var r,a,s,l,u;if("data-cke-widget-wrapper"in e.attributes)return(e=e.getFirst(t.isParserWidgetElement))&&n.push([e]),!1;if("data-widget"in e.attributes)return n.push([e]),!1;if(u=o.length){if(e.attributes["data-cke-widget-upcasted"])return!1;for(l=0,r=i.length;l<r;++l)if(!1===i[l](e))return;for(l=0;l<u;++l)if(a=(r=o[l])[0](e,s={}))return a instanceof CKEDITOR.htmlParser.element&&(e=a),e.attributes["data-cke-widget-data"]=encodeURIComponent(JSON.stringify(s)),e.attributes["data-cke-widget-upcasted"]=1,n.push([e,r[1]]),!1}}}}(e);for(o.data.dataValue.forEach(r.iterator,CKEDITOR.NODE_ELEMENT,!0);i=r.toBeWrapped.pop();){var a=i[0],s=a.parent;s.type==CKEDITOR.NODE_ELEMENT&&s.attributes["data-cke-widget-wrapper"]&&s.replaceWith(a),e.wrapElement(i[0],i[1])}n=o.data.protectedWhitespaces?3==o.data.dataValue.children.length&&t.isParserWidgetWrapper(o.data.dataValue.children[1]):1==o.data.dataValue.children.length&&t.isParserWidgetWrapper(o.data.dataValue.children[0])}),null,null,8),i.on("dataReady",(function(){if(o)for(var n,r,a=i.editable().find(".cke_widget_wrapper"),s=0,l=a.count();s<l;++s)(r=(n=a.getItem(s)).getFirst(t.isDomWidgetElement)).type==CKEDITOR.NODE_ELEMENT&&r.data("widget")?(r.replace(n),e.wrapElement(r)):n.remove();o=0,e.destroyAll(!0),e.initOnAll()})),i.on("loadSnapshot",(function(t){/data-cke-widget/.test(t.data)&&(o=1),e.destroyAll(!0)}),null,null,9),i.on("paste",(function(e){(e=e.data).dataValue=e.dataValue.replace(_,h),e.range&&(e=t.getNestedEditable(i.editable(),e.range.startContainer))&&(e=CKEDITOR.filter.instances[e.data("cke-filter")])&&i.setActiveFilter(e)})),i.on("afterInsertHtml",(function(t){t.data.intoRange?e.checkWidgets({initOnlyNew:!0}):(i.fire("lockSnapshot"),e.checkWidgets({initOnlyNew:!0,focusInited:n}),i.fire("unlockSnapshot"))}))}(this),function(e){var n=e.editor,o={};n.on("toDataFormat",(function(n){var i=CKEDITOR.tools.getNextNumber(),r=[];n.data.downcastingSessionId=i,o[i]=r,n.data.dataValue.forEach((function(n){var o,i=n.attributes;if("data-cke-widget-white-space"in i){o=a(n);var l=s(n);o.parent.attributes["data-cke-white-space-first"]&&(o.value=o.value.replace(/^&nbsp;/g," ")),l.parent.attributes["data-cke-white-space-last"]&&(l.value=l.value.replace(/&nbsp;$/g," "))}if("data-cke-widget-id"in i)(i=e.instances[i["data-cke-widget-id"]])&&(o=n.getFirst(t.isParserWidgetElement),r.push({wrapper:n,element:o,widget:i,editables:{}}),"1"!=o.attributes["data-cke-widget-keep-attr"]&&delete o.attributes["data-widget"]);else if("data-cke-widget-editable"in i)return 0<r.length&&(r[r.length-1].editables[i["data-cke-widget-editable"]]=n),!1}),CKEDITOR.NODE_ELEMENT,!0)}),null,null,8),n.on("toDataFormat",(function(e){if(e.data.downcastingSessionId)for(var t,n,i,r,a,s,l=o[e.data.downcastingSessionId];t=l.shift();){for(s in i=t.element,r=(n=t.widget)._.downcastFn&&n._.downcastFn.call(n,i),e.data.widgetsCopy&&n.getClipboardHtml&&(r=(r=CKEDITOR.htmlParser.fragment.fromHtml(n.getClipboardHtml())).children[0]),t.editables)delete(a=t.editables[s]).attributes.contenteditable,a.setHtml(n.editables[s].getData());r||(r=i),t.wrapper.replaceWith(r)}}),null,null,13),n.on("contentDomUnload",(function(){e.destroyAll(!0)}))}(this),this.on("checkWidgets",i),this.editor.on("contentDomInvalidated",this.checkWidgets,this),function(e){var n=e.editor;n.on("selectionCheck",(function(){e.fire("checkSelection")})),e.on("checkSelection",e.checkSelection,e),n.on("selectionChange",(function(o){var i=(o=t.getNestedEditable(n.editable(),o.data.selection.getStartElement()))&&e.getByElement(o),r=e.widgetHoldingFocusedEditable;r?r===i&&r.focusedEditable.equals(o)||(f(e,r,null),i&&o&&f(e,i,o)):i&&o&&f(e,i,o)})),n.on("dataReady",(function(){g(e).commit()})),n.on("blur",(function(){var t;(t=e.focused)&&o(e,t),(t=e.widgetHoldingFocusedEditable)&&f(e,t,null)}))}(this),function(e){var n=e.editor;n.on("contentDom",(function(){var o,i,r=n.editable(),a=r.isInline()?r:n.document;r.attachListener(a,"mousedown",(function(r){var a=r.data.getTarget();o=a instanceof CKEDITOR.dom.element?e.getByElement(a):null,i=0,o&&(o.inline&&a.type==CKEDITOR.NODE_ELEMENT&&a.hasAttribute("data-cke-widget-drag-handler")?(i=1,e.focused!=o&&n.getSelection().removeAllRanges()):t.getNestedEditable(o.wrapper,a)?o=null:(r.data.preventDefault(),CKEDITOR.env.ie||o.focus()))})),r.attachListener(a,"mouseup",(function(){i&&o&&o.wrapper&&(i=0,o.focus())})),CKEDITOR.env.ie&&r.attachListener(a,"mouseup",(function(){setTimeout((function(){o&&o.wrapper&&r.contains(o.wrapper)&&(o.focus(),o=null)}))}))})),n.on("doubleclick",(function(n){var o=e.getByElement(n.data.element);if(o&&!t.getNestedEditable(o.wrapper,n.data.element))return o.fire("doubleclick",{element:n.data.element})}),null,null,1)}(this),function(e){e.editor.on("key",(function(t){var n,o=e.focused,i=e.widgetHoldingFocusedEditable;return o?n=o.fire("key",{keyCode:t.data.keyCode}):i&&(o=t.data.keyCode,t=i.focusedEditable,o==CKEDITOR.CTRL+65?(o=t.getBogus(),(i=i.editor.createRange()).selectNodeContents(t),o&&i.setEndAt(o,CKEDITOR.POSITION_BEFORE_START),i.select(),n=!1):8==o||46==o?(n=i.editor.getSelection().getRanges(),i=n[0],n=!(1==n.length&&i.collapsed&&i.checkBoundaryOfElement(t,CKEDITOR[8==o?"START":"END"]))):n=void 0),n}),null,null,1)}(this),function(e){var n=e.editor,o=CKEDITOR.plugins.lineutils;n.on("dragstart",(function(o){var i=o.data.target;t.isDomDragHandler(i)&&(i=e.getByElement(i),o.data.dataTransfer.setData("cke/widget-id",i.id),n.focus(),i.focus())})),n.on("drop",(function(t){var o=(r=t.data.dataTransfer).getData("cke/widget-id"),i=r.getTransferType(n),r=n.createRange();""!==o&&i===CKEDITOR.DATA_TRANSFER_CROSS_EDITORS?t.cancel():""!==o&&i==CKEDITOR.DATA_TRANSFER_INTERNAL&&(o=e.instances[o])&&(r.setStartBefore(o.wrapper),r.setEndAfter(o.wrapper),t.data.dragRange=r,delete CKEDITOR.plugins.clipboard.dragStartContainerChildCount,delete CKEDITOR.plugins.clipboard.dragEndContainerChildCount,t.data.dataTransfer.setData("text/html",o.getClipboardHtml()),n.widgets.destroy(o,!0))})),n.on("contentDom",(function(){var i=n.editable();CKEDITOR.tools.extend(e,{finder:new o.finder(n,{lookups:{default:function(n){if(!n.is(CKEDITOR.dtd.$listItem)&&n.is(CKEDITOR.dtd.$block)&&!t.isDomNestedEditable(n)&&!e._.draggedWidget.wrapper.contains(n)){var o=t.getNestedEditable(i,n);if(o){if(n=e._.draggedWidget,e.getByElement(o)==n)return;if(o=CKEDITOR.filter.instances[o.data("cke-filter")],n=n.requiredContent,o&&n&&!o.check(n))return}return CKEDITOR.LINEUTILS_BEFORE|CKEDITOR.LINEUTILS_AFTER}}}}),locator:new o.locator(n),liner:new o.liner(n,{lineStyle:{cursor:"move !important","border-top-color":"#666"},tipLeftStyle:{"border-left-color":"#666"},tipRightStyle:{"border-right-color":"#666"}})},!0)}))}(this),function(e){function t(t){1>e.selected.length||v(n,"cut"===t.name)}var n=e.editor;n.on("contentDom",(function(){var e=n.editable();e.attachListener(e,"copy",t),e.attachListener(e,"cut",t)}))}(this)}function t(e,n,o,i,r){var a=e.editor;CKEDITOR.tools.extend(this,i,{editor:a,id:n,inline:"span"==o.getParent().getName(),element:o,data:CKEDITOR.tools.extend({},"function"==typeof i.defaults?i.defaults():i.defaults),dataReady:!1,inited:!1,ready:!1,edit:t.prototype.edit,focusedEditable:null,definition:i,repository:e,draggable:!1!==i.draggable,_:{downcastFn:i.downcast&&"string"==typeof i.downcast?i.downcasts[i.downcast]:i.downcast}},!0),e.fire("instanceCreated",this),function(e,n){(function(e){(e.wrapper=e.element.getParent()).setAttribute("data-cke-widget-id",e.id)})(e),function(e){if(e.parts){var t,n,o={};for(n in e.parts)t=e.wrapper.findOne(e.parts[n]),o[n]=t;e.parts=o}}(e),function(e){var t,n,o=e.editables;if(e.editables={},e.editables)for(t in o)e.initEditable(t,"string"==typeof(n=o[t])?{selector:n}:n)}(e),function(e){if(!0===e.mask)!function(e){var t=e.wrapper.findOne(".cke_widget_mask");t||((t=new CKEDITOR.dom.element("img",e.editor.document)).setAttributes({src:CKEDITOR.tools.transparentImageData,class:"cke_reset cke_widget_mask"}),e.wrapper.append(t)),e.mask=t}(e);else if(e.mask){var t,n,o=new CKEDITOR.tools.buffers.throttle(250,T,e),i=CKEDITOR.env.gecko?300:0;if(e.on("focus",(function(){o.input(),t=e.editor.on("change",o.input),n=e.on("blur",(function(){t.removeListener(),n.removeListener()}))})),e.editor.on("instanceReady",(function(){setTimeout((function(){o.input()}),i)})),e.editor.on("mode",(function(){setTimeout((function(){o.input()}),i)})),CKEDITOR.env.gecko){var r=e.element.find("img");CKEDITOR.tools.array.forEach(r.toArray(),(function(e){e.on("load",(function(){o.input()}))}))}for(var a in e.editables)e.editables[a].on("focus",(function(){e.editor.on("change",o.input),n&&n.removeListener()})),e.editables[a].on("blur",(function(){e.editor.removeListener("change",o.input)}));o.input()}}(e),function(e){if(e.draggable){var n,o=e.editor,i=e.wrapper.getLast(t.isDomDragHandlerContainer);i?n=i.findOne("img"):((i=new CKEDITOR.dom.element("span",o.document)).setAttributes({class:"cke_reset cke_widget_drag_handler_container",style:"background:rgba(220,220,220,0.5);background-image:url("+o.plugins.widget.path+"images/handle.png);display:none;"}),(n=new CKEDITOR.dom.element("img",o.document)).setAttributes({class:"cke_reset cke_widget_drag_handler","data-cke-widget-drag-handler":"1",src:CKEDITOR.tools.transparentImageData,width:15,title:o.lang.widget.move,height:15,role:"presentation"}),e.inline&&n.setAttribute("draggable","true"),i.append(n),e.wrapper.append(i)),e.wrapper.on("dragover",(function(e){e.data.preventDefault()})),e.wrapper.on("mouseenter",e.updateDragHandlerPosition,e),setTimeout((function(){e.on("data",e.updateDragHandlerPosition,e)}),50),!e.inline&&(n.on("mousedown",x,e),CKEDITOR.env.ie&&9>CKEDITOR.env.version)&&n.on("dragstart",(function(e){e.data.preventDefault(!0)})),e.dragHandlerContainer=i}}(e),function(e){var t=null;e.on("data",(function(){var e,n=this.data.classes;if(t!=n){for(e in t)n&&n[e]||this.removeClass(e);for(e in n)this.addClass(e);t=n}}))}(e),function(e){e.on("data",(function(){if(e.wrapper){var t=this.getLabel?this.getLabel():this.editor.lang.widget.label.replace(/%1/,this.pathName||this.element.getName());e.wrapper.setAttribute("role","region"),e.wrapper.setAttribute("aria-label",t)}}),null,null,9999)}(e),CKEDITOR.env.ie&&9>CKEDITOR.env.version&&e.wrapper.on("dragstart",(function(n){var o=n.data.getTarget();t.getNestedEditable(e,o)||e.inline&&t.isDomDragHandler(o)||n.data.preventDefault()})),e.wrapper.removeClass("cke_widget_new"),e.element.addClass("cke_widget_element"),e.on("key",(function(t){if(13==(t=t.data.keyCode))e.edit();else{if(t==CKEDITOR.CTRL+67||t==CKEDITOR.CTRL+88)return void v(e.editor,t==CKEDITOR.CTRL+88);if(t in I||CKEDITOR.CTRL&t||CKEDITOR.ALT&t)return}return!1}),null,null,999),e.on("doubleclick",(function(t){e.edit()&&t.cancel()})),n.data&&e.on("data",n.data),n.edit&&e.on("edit",n.edit)}(this,i),this.init&&this.init(),this.inited=!0,(e=this.element.data("cke-widget-data"))&&this.setData(JSON.parse(decodeURIComponent(e))),r&&this.setData(r),this.data.classes||this.setData("classes",this.getClasses()),this.dataReady=!0,E(this),this.fire("data",this.data),this.isInited()&&a.editable().contains(this.wrapper)&&(this.ready=!0,this.fire("ready"))}function n(e,t,n){CKEDITOR.dom.element.call(this,t.$),this.editor=e,this._={},t=this.filter=n.filter,CKEDITOR.dtd[this.getName()].p?(this.enterMode=t?t.getAllowedEnterMode(e.enterMode):e.enterMode,this.shiftEnterMode=t?t.getAllowedEnterMode(e.shiftEnterMode,!0):e.shiftEnterMode):this.enterMode=this.shiftEnterMode=CKEDITOR.ENTER_BR}function o(e,t){if(e.focused=null,t.isInited()){var n=t.editor.checkDirty();e.fire("widgetBlurred",{widget:t}),t.setFocused(!1),!n&&t.editor.resetDirty()}}function i(e){if(e=e.data,"wysiwyg"==this.editor.mode){var n,o,i,r,a=this.editor.editable(),s=this.instances;if(a){for(n in s)s[n].isReady()&&!a.contains(s[n].wrapper)&&this.destroy(s[n],!0);if(e&&e.initOnlyNew)s=this.initOnAll();else{var l=a.find(".cke_widget_wrapper");for(s=[],n=0,o=l.count();n<o;n++){if(i=l.getItem(n),r=!this.getByElement(i,!0)){e:{r=d;for(var u=i;u=u.getParent();)if(r(u)){r=!0;break e}r=!1}r=!r}r&&a.contains(i)&&(i.addClass("cke_widget_new"),s.push(this.initOn(i.getFirst(t.isDomWidgetElement))))}}e&&e.focusInited&&1==s.length&&s[0].focus()}}}function r(e){if(void 0!==e.attributes&&e.attributes["data-widget"]){var t=a(e),n=s(e),o=!1;t&&t.value&&t.value.match(/^\s/g)&&(t.parent.attributes["data-cke-white-space-first"]=1,t.value=t.value.replace(/^\s/g,"&nbsp;"),o=!0),n&&n.value&&n.value.match(/\s$/g)&&(n.parent.attributes["data-cke-white-space-last"]=1,n.value=n.value.replace(/\s$/g,"&nbsp;"),o=!0),o&&(e.attributes["data-cke-widget-white-space"]=1)}}function a(e){return e.find((function(e){return 3===e.type}),!0).shift()}function s(e){return e.find((function(e){return 3===e.type}),!0).pop()}function l(e,t,n){if(!n.allowedContent&&!n.disallowedContent)return null;var o=this._.filters[e];return o||(this._.filters[e]=o={}),(e=o[t])||(e=n.allowedContent?new CKEDITOR.filter(n.allowedContent):this.editor.filter.clone(),o[t]=e,n.disallowedContent&&e.disallow(n.disallowedContent)),e}function u(e,t){return{tabindex:-1,contenteditable:"false","data-cke-widget-wrapper":1,"data-cke-filter":"off",class:"cke_widget_wrapper cke_widget_new cke_widget_"+(e?"inline":"block")+(t?" cke_widget_"+t:"")}}function c(e,t){return"boolean"==typeof e.inline?e.inline:!!CKEDITOR.dtd.$inline[t]}function d(e){return e.hasAttribute("data-cke-temp")}function f(e,t,n,o){var i=e.editor;i.fire("lockSnapshot"),n?(o=n.data("cke-widget-editable"),o=t.editables[o],e.widgetHoldingFocusedEditable=t,t.focusedEditable=o,n.addClass("cke_widget_editable_focused"),o.filter&&i.setActiveFilter(o.filter),i.setActiveEnterMode(o.enterMode,o.shiftEnterMode)):(o||t.focusedEditable.removeClass("cke_widget_editable_focused"),t.focusedEditable=null,e.widgetHoldingFocusedEditable=null,i.setActiveFilter(null),i.setActiveEnterMode(null,null)),i.fire("unlockSnapshot")}function h(e,t){return CKEDITOR.tools.trim(t)}function g(e){var t=e.selected,n=[],i=t.slice(0),r=null;return{select:function(e){return 0>CKEDITOR.tools.indexOf(t,e)&&n.push(e),0<=(e=CKEDITOR.tools.indexOf(i,e))&&i.splice(e,1),this},focus:function(e){return r=e,this},commit:function(){var a,s,l=e.focused!==r;for(e.editor.fire("lockSnapshot"),l&&(a=e.focused)&&o(e,a);a=i.pop();)t.splice(CKEDITOR.tools.indexOf(t,a),1),a.isInited()&&(s=a.editor.checkDirty(),a.setSelected(!1),!s&&a.editor.resetDirty());for(l&&r&&(s=e.editor.checkDirty(),e.focused=r,e.fire("widgetFocused",{widget:r}),r.setFocused(!0),!s&&e.editor.resetDirty());a=n.pop();)t.push(a),a.setSelected(!0);e.editor.fire("unlockSnapshot")}}}function m(e,t,n){var o=0;t=y(t);var i,r=e.data.classes||{};if(t){for(r=CKEDITOR.tools.clone(r);i=t.pop();)n?r[i]||(o=r[i]=1):r[i]&&(delete r[i],o=1);o&&e.setData("classes",r)}}function p(e){e.cancel()}function v(e,t){var n,o,i,r=e.widgets.focused;D.hasCopyBin(e)||(o=new D(e,{beforeDestroy:function(){!t&&r&&r.focus(),i&&e.getSelection().selectBookmarks(i),n&&CKEDITOR.plugins.widgetselection.addFillers(e.editable())},afterDestroy:function(){t&&!e.readOnly&&(r?e.widgets.del(r):e.extractSelectedHtml(),e.fire("saveSnapshot"))}}),r||(n=CKEDITOR.env.webkit&&CKEDITOR.plugins.widgetselection.isWholeContentSelected(e.editable()),i=e.getSelection().createBookmarks(!0)),o.handle(function(){var t=e.getSelectedHtml(!0);return e.widgets.focused?e.widgets.focused.getClipboardHtml():(e.once("toDataFormat",(function(e){e.data.widgetsCopy=!0}),null,null,-1),e.dataProcessor.toDataFormat(t))}()))}function y(e){return(e=(e=e.getDefinition().attributes)&&e.class)?e.split(/\s+/):null}function b(){var e=CKEDITOR.document.getActive(),t=this.editor,n=t.editable();(n.isInline()?n:t.document.getWindow().getFrame()).equals(e)&&t.focusManager.focus(n)}function C(){CKEDITOR.env.gecko&&this.editor.unlockSelection(),CKEDITOR.env.webkit||(this.editor.forceNextSelectionCheck(),this.editor.selectionChange(1))}function T(){if(this.wrapper){this.maskPart=this.maskPart||this.mask;var e,t=this.parts[this.maskPart];if(t){(e=this.wrapper.findOne(".cke_widget_partial_mask"))||((e=new CKEDITOR.dom.element("img",this.editor.document)).setAttributes({src:CKEDITOR.tools.transparentImageData,class:"cke_reset cke_widget_partial_mask"}),this.wrapper.append(e)),this.mask=e;var n=e.$,o=t.$;(n.offsetWidth!=o.offsetWidth||n.offsetHeight!=o.offsetHeight||n.offsetTop!=o.offsetTop||n.offsetLeft!=o.offsetLeft)&&(n=t.getParent(),o=CKEDITOR.plugins.widget.isDomWidget(n),e.setStyles({top:t.$.offsetTop+(o?0:n.$.offsetTop)+"px",left:t.$.offsetLeft+(o?0:n.$.offsetLeft)+"px",width:t.$.offsetWidth+"px",height:t.$.offsetHeight+"px"}))}}}function x(e){function t(){var t;for(f.reset();t=u.pop();)t.removeListener();var n=c;t=e.sender;var o=this.repository.finder,i=this.repository.liner,r=this.editor,a=this.editor.editable();CKEDITOR.tools.isEmpty(i.visible)||(n=o.getRange(n[0]),this.focus(),r.fire("drop",{dropRange:n,target:n.startContainer})),a.removeClass("cke_widget_dragging"),i.hideVisible(),r.fire("dragend",{target:t})}if(CKEDITOR.tools.getMouseButton(e)===CKEDITOR.MOUSE_BUTTON_LEFT){var n,o,i=this.repository.finder,r=this.repository.locator,a=this.repository.liner,s=this.editor,l=s.editable(),u=[],c=[];this.repository._.draggedWidget=this;var d=i.greedySearch(),f=CKEDITOR.tools.eventsBuffer(50,(function(){n=r.locate(d),(c=r.sort(o,1)).length&&(a.prepare(d,n),a.placeLine(c[0]),a.cleanup())}));l.addClass("cke_widget_dragging"),u.push(l.on("mousemove",(function(e){o=e.data.$.clientY,f.input()}))),s.fire("dragstart",{target:e.sender}),u.push(s.document.once("mouseup",t,this)),l.isInline()||u.push(CKEDITOR.document.once("mouseup",t,this))}}function E(e){e.element.data("cke-widget-data",encodeURIComponent(JSON.stringify(e.data)))}CKEDITOR.plugins.add("widget",{requires:"lineutils,clipboard,widgetselection",onLoad:function(){void 0!==CKEDITOR.document.$.querySelectorAll&&(CKEDITOR.addCss('.cke_widget_wrapper{position:relative;outline:none}.cke_widget_inline{display:inline-block}.cke_widget_wrapper:hover>.cke_widget_element{outline:2px solid #ffd25c;cursor:default}.cke_widget_wrapper:hover .cke_widget_editable{outline:2px solid #ffd25c}.cke_widget_wrapper.cke_widget_focused>.cke_widget_element,.cke_widget_wrapper .cke_widget_editable.cke_widget_editable_focused{outline:2px solid #47a4f5}.cke_widget_editable{cursor:text}.cke_widget_drag_handler_container{position:absolute;width:15px;height:0;display:block;opacity:0.75;transition:height 0s 0.2s;line-height:0}.cke_widget_wrapper:hover>.cke_widget_drag_handler_container{height:15px;transition:none}.cke_widget_drag_handler_container:hover{opacity:1}.cke_editable[contenteditable="false"] .cke_widget_drag_handler_container{display:none;}img.cke_widget_drag_handler{cursor:move;width:15px;height:15px;display:inline-block}.cke_widget_mask{position:absolute;top:0;left:0;width:100%;height:100%;display:block}.cke_widget_partial_mask{position:absolute;display:block}.cke_editable.cke_widget_dragging, .cke_editable.cke_widget_dragging *{cursor:move !important}'),function(){function e(){}function n(e,t,n){return!(!n||!this.checkElement(e))&&(e=n.widgets.getByElement(e,!0))&&e.checkStyleActive(this)}var o={};CKEDITOR.style.addCustomHandler({type:"widget",setup:function(e){this.widget=e.widget,(this.group="string"==typeof e.group?[e.group]:e.group)&&function(e){function t(e,t,n){for(var o=e.length,i=0;i<o;){if(t.call(n,e[i],i,e))return e[i];i++}}function n(e){return function(t){return function e(t,n){var o=CKEDITOR.tools.object.keys(t),i=CKEDITOR.tools.object.keys(n);if(o.length!==i.length)return!1;for(var r in t)if(("object"!=typeof t[r]||"object"!=typeof n[r]||!e(t[r],n[r]))&&t[r]!==n[r])return!1;return!0}(e.getDefinition(),t.getDefinition())}}var i,r=e.widget;o[r]||(o[r]={});for(var a=0,s=e.group.length;a<s;a++)o[r][i=e.group[a]]||(o[r][i]=[]),t(i=o[r][i],n(e))||i.push(e)}(this)},apply:function(e){var t;e instanceof CKEDITOR.editor&&this.checkApplicable(e.elementPath(),e)&&(t=e.widgets.focused,this.group&&this.removeStylesFromSameGroup(e),t.applyStyle(this))},remove:function(e){e instanceof CKEDITOR.editor&&this.checkApplicable(e.elementPath(),e)&&e.widgets.focused.removeStyle(this)},removeStylesFromSameGroup:function(e){var t,n,i=!1;if(!(e instanceof CKEDITOR.editor))return!1;if(n=e.elementPath(),this.checkApplicable(n,e))for(var r=0,a=this.group.length;r<a;r++){t=o[this.widget][this.group[r]];for(var s=0;s<t.length;s++)t[s]!==this&&t[s].checkActive(n,e)&&(e.widgets.focused.removeStyle(t[s]),i=!0)}return i},checkActive:function(e,t){return this.checkElementMatch(e.lastElement,0,t)},checkApplicable:function(e,t){return t instanceof CKEDITOR.editor&&this.checkElement(e.lastElement)},checkElementMatch:n,checkElementRemovable:n,checkElement:function(e){return!!t.isDomWidgetWrapper(e)&&(e=e.getFirst(t.isDomWidgetElement))&&e.data("widget")==this.widget},buildPreview:function(e){return e||this._.definition.name},toAllowedContentRules:function(e){if(!e)return null;var t,n={};return(e=e.widgets.registered[this.widget])?e.styleableElements?(t=this.getClassesArray())?(n[e.styleableElements]={classes:t,propertiesOnly:!0},n):null:e.styleToAllowedContentRules?e.styleToAllowedContentRules(this):null:null},getClassesArray:function(){var e=this._.definition.attributes&&this._.definition.attributes.class;return e?CKEDITOR.tools.trim(e).split(/\s+/):null},applyToRange:e,removeFromRange:e,applyToObject:e})}())},beforeInit:function(t){void 0!==CKEDITOR.document.$.querySelectorAll&&(t.widgets=new e(t))},afterInit:function(e){if(void 0!==CKEDITOR.document.$.querySelectorAll){var t,n,o,i=e.widgets.registered;for(n in i)(o=(t=i[n]).button)&&e.ui.addButton&&e.ui.addButton(CKEDITOR.tools.capitalize(t.name,!0),{label:o,command:t.name,toolbar:"insert,10"});!function(e){e.contextMenu&&e.contextMenu.addListener((function(t){if(t=e.widgets.getByElement(t,!0))return t.fire("contextMenu",{})}))}(e),function(e){e&&e.addFilterRule((function(e){return e.replace(/\s*cke_widget_selected/g,"").replace(/\s*cke_widget_focused/g,"").replace(/<span[^>]*cke_widget_drag_handler_container[^>]*.*?<\/span>/gim,"")}))}(e.undoManager)}}}),e.prototype={MIN_SELECTION_CHECK_INTERVAL:500,add:function(e,t){var n=this.editor;if((t=CKEDITOR.tools.prototypedCopy(t)).name=e,t._=t._||{},n.fire("widgetDefinition",t),t.template&&(t.template=new CKEDITOR.template(t.template)),function(e,t){e.addCommand(t.name,{exec:function(e,n){function o(){e.widgets.finalizeCreation(s)}if((r=e.widgets.focused)&&r.name==t.name)r.edit();else if(t.insert)t.insert({editor:e,commandData:n});else if(t.template){var i,r="function"==typeof t.defaults?t.defaults():t.defaults,a=(r=CKEDITOR.dom.element.createFromHtml(t.template.output(r),e.document),e.widgets.wrapElement(r,t.name)),s=new CKEDITOR.dom.documentFragment(a.getDocument());s.append(a),(i=e.widgets.initOn(r,t,n&&n.startupData))?(r=i.once("edit",(function(t){t.data.dialog?i.once("dialog",(function(t){var n,r;n=(t=t.data).once("ok",o,null,null,20),r=t.once("cancel",(function(t){t.data&&!1===t.data.hide||e.widgets.destroy(i,!0)})),t.once("hide",(function(){n.removeListener(),r.removeListener()}))})):o()}),null,null,999),i.edit(),r.removeListener()):o()}},allowedContent:t.allowedContent,requiredContent:t.requiredContent,contentForms:t.contentForms,contentTransformations:t.contentTransformations})}(n,t),function(e,t){var n=t.upcast;n&&function(t,n,o){var i=CKEDITOR.tools.getIndex(e._.upcasts,(function(e){return e[2]>o}));0>i&&(i=e._.upcasts.length),e._.upcasts.splice(i,0,[CKEDITOR.tools.bind(t,n),n.name,o])}("string"==typeof n?function(e,n){var o,i,r=t.upcast.split(",");for(i=0;i<r.length;i++)if((o=r[i])===e.name)return t.upcasts[o].call(this,e,n);return!1}:n,t,t.upcastPriority||10)}(this,t),this.registered[e]=t,t.dialog&&n.plugins.dialog)var o=CKEDITOR.on("dialogDefinition",(function(e){var i=(e=e.data.definition).dialog;e.getMode||i.getName()!==t.dialog||(e.getMode=function(){var e=i.getModel(n);return e&&e instanceof CKEDITOR.plugins.widget&&e.ready?CKEDITOR.dialog.EDITING_MODE:CKEDITOR.dialog.CREATION_MODE}),o.removeListener()}));return t},addUpcastCallback:function(e){this._.upcastCallbacks.push(e)},checkSelection:function(){var e,n=this.editor.getSelection(),o=n.getSelectedElement(),i=g(this);if(o&&(e=this.getByElement(o,!0)))return i.focus(e).select(e).commit();if(!(n=n.getRanges()[0])||n.collapsed)return i.commit();for((n=new CKEDITOR.dom.walker(n)).evaluator=t.isDomWidgetWrapper;o=n.next();)i.select(this.getByElement(o));i.commit()},checkWidgets:function(e){this.fire("checkWidgets",CKEDITOR.tools.copy(e||{}))},del:function(e){if(this.focused===e){var t,n=e.editor,o=n.createRange();(t=o.moveToClosestEditablePosition(e.wrapper,!0))||(t=o.moveToClosestEditablePosition(e.wrapper,!1)),t&&n.getSelection().selectRanges([o])}e.wrapper.remove(),this.destroy(e,!0)},destroy:function(e,t){this.widgetHoldingFocusedEditable===e&&f(this,e,null,t),e.destroy(t),delete this.instances[e.id],this.fire("instanceDestroyed",e)},destroyAll:function(e,t){var n,o,i=this.instances;if(t&&!e){i=(o=t.find(".cke_widget_wrapper")).count();for(var r=0;r<i;++r)(n=this.getByElement(o.getItem(r),!0))&&this.destroy(n)}else for(o in i)this.destroy(n=i[o],e)},finalizeCreation:function(e){(e=e.getFirst())&&t.isDomWidgetWrapper(e)&&(this.editor.insertElement(e),(e=this.getByElement(e)).ready=!0,e.fire("ready"),e.focus())},getByElement:function(){function e(e){return e.is(t)&&e.data("cke-widget-id")}var t={div:1,span:1};return function(t,n){if(!t)return null;var o=e(t);if(!n&&!o){var i=this.editor.editable();do{t=t.getParent()}while(t&&!t.equals(i)&&!(o=e(t)))}return this.instances[o]||null}}(),initOn:function(e,n,o){if(n?"string"==typeof n&&(n=this.registered[n]):n=this.registered[e.data("widget")],!n)return null;var i=this.wrapElement(e,n.name);return i?i.hasClass("cke_widget_new")?(e=new t(this,this._.nextId++,e,n,o)).isInited()?this.instances[e.id]=e:null:this.getByElement(e):null},initOnAll:function(e){for(var n,o=[],i=(e=(e||this.editor.editable()).find(".cke_widget_new")).count();i--;)(n=this.initOn(e.getItem(i).getFirst(t.isDomWidgetElement)))&&o.push(n);return o},onWidget:function(e){var t=Array.prototype.slice.call(arguments);for(var n in t.shift(),this.instances){var o=this.instances[n];o.name==e&&o.on.apply(o,t)}this.on("instanceCreated",(function(n){(n=n.data).name==e&&n.on.apply(n,t)}))},parseElementClasses:function(e){if(!e)return null;e=CKEDITOR.tools.trim(e).split(/\s+/);for(var t,n={},o=0;t=e.pop();)-1==t.indexOf("cke_")&&(n[t]=o=1);return o?n:null},wrapElement:function(e,t){var n,o,i=null;if(e instanceof CKEDITOR.dom.element){if(t=t||e.data("widget"),!(n=this.registered[t]))return null;if((i=e.getParent())&&i.type==CKEDITOR.NODE_ELEMENT&&i.data("cke-widget-wrapper"))return i;e.hasAttribute("data-cke-widget-keep-attr")||e.data("cke-widget-keep-attr",e.data("widget")?1:0),e.data("widget",t),(o=c(n,e.getName()))&&r(e),(i=new CKEDITOR.dom.element(o?"span":"div",e.getDocument())).setAttributes(u(o,t)),i.data("cke-display-name",n.pathName?n.pathName:e.getName()),e.getParent(!0)&&i.replace(e),e.appendTo(i)}else if(e instanceof CKEDITOR.htmlParser.element){if(!(n=this.registered[t=t||e.attributes["data-widget"]]))return null;if((i=e.parent)&&i.type==CKEDITOR.NODE_ELEMENT&&i.attributes["data-cke-widget-wrapper"])return i;var a;"data-cke-widget-keep-attr"in e.attributes||(e.attributes["data-cke-widget-keep-attr"]=e.attributes["data-widget"]?1:0),t&&(e.attributes["data-widget"]=t),(o=c(n,e.name))&&r(e),(i=new CKEDITOR.htmlParser.element(o?"span":"div",u(o,t))).attributes["data-cke-display-name"]=n.pathName?n.pathName:e.name,(n=e.parent)&&(a=e.getIndex(),e.remove()),i.add(e),n&&function e(t,n,o){if(t.type==CKEDITOR.NODE_ELEMENT&&(i=CKEDITOR.dtd[t.name])&&!i[o.name]){var i=t.split(n),r=t.parent;return n=i.getIndex(),t.children.length||(--n,t.remove()),i.children.length||i.remove(),e(r,n,o)}t.add(o,n)}(n,a,i)}return i},_tests_createEditableFilter:l},CKEDITOR.event.implementOn(e.prototype),t.prototype={addClass:function(e){this.element.addClass(e),this.wrapper.addClass(t.WRAPPER_CLASS_PREFIX+e)},applyStyle:function(e){m(this,e,1)},checkStyleActive:function(e){var t;if(!(e=y(e)))return!1;for(;t=e.pop();)if(!this.hasClass(t))return!1;return!0},destroy:function(e){if(this.fire("destroy"),this.editables)for(var t in this.editables)this.destroyEditable(t,e);e||("0"==this.element.data("cke-widget-keep-attr")&&this.element.removeAttribute("data-widget"),this.element.removeAttributes(["data-cke-widget-data","data-cke-widget-keep-attr"]),this.element.removeClass("cke_widget_element"),this.element.replace(this.wrapper)),this.wrapper=null},destroyEditable:function(e,t){var n=this.editables[e],o=!0;if(n.removeListener("focus",C),n.removeListener("blur",b),this.editor.focusManager.remove(n),n.filter){for(var i in this.repository.instances){var r=this.repository.instances[i];r.editables&&(r=r.editables[e])&&r!==n&&n.filter===r.filter&&(o=!1)}o&&(n.filter.destroy(),(o=this.repository._.filters[this.name])&&delete o[e])}t||(this.repository.destroyAll(!1,n),n.removeClass("cke_widget_editable"),n.removeClass("cke_widget_editable_focused"),n.removeAttributes(["contenteditable","data-cke-widget-editable","data-cke-enter-mode"])),delete this.editables[e]},edit:function(){var e={dialog:this.dialog},t=this;return!(!1===this.fire("edit",e)||!e.dialog||(this.editor.openDialog(e.dialog,(function(e){var n,o;!1!==t.fire("dialog",e)&&(n=e.on("show",(function(){e.setupContent(t)})),o=e.on("ok",(function(){var n,o=t.on("data",(function(e){n=1,e.cancel()}),null,null,0);t.editor.fire("saveSnapshot"),e.commitContent(t),o.removeListener(),n&&(t.fire("data",t.data),t.editor.fire("saveSnapshot"))})),e.once("hide",(function(){n.removeListener(),o.removeListener()})))}),t),0))},getClasses:function(){return this.repository.parseElementClasses(this.element.getAttribute("class"))},getClipboardHtml:function(){var e=this.editor.createRange();return e.setStartBefore(this.wrapper),e.setEndAfter(this.wrapper),this.editor.editable().getHtmlFromRange(e).getHtml()},hasClass:function(e){return this.element.hasClass(e)},initEditable:function(e,t){var o=this._findOneNotNested(t.selector);return!(!o||!o.is(CKEDITOR.dtd.$editable)||(o=new n(this.editor,o,{filter:l.call(this.repository,this.name,e,t)}),this.editables[e]=o,o.setAttributes({contenteditable:"true","data-cke-widget-editable":e,"data-cke-enter-mode":o.enterMode}),o.filter&&o.data("cke-filter",o.filter.id),o.addClass("cke_widget_editable"),o.removeClass("cke_widget_editable_focused"),t.pathName&&o.data("cke-display-name",t.pathName),this.editor.focusManager.add(o),o.on("focus",C,this),CKEDITOR.env.ie&&o.on("blur",b,this),o._.initialSetData=!0,o.setData(o.getHtml()),0))},_findOneNotNested:function(e){e=this.wrapper.find(e);for(var n,o,i=0;i<e.count();i++)if(o=(n=e.getItem(i)).getAscendant(t.isDomWidgetWrapper),this.wrapper.equals(o))return n;return null},isInited:function(){return!(!this.wrapper||!this.inited)},isReady:function(){return this.isInited()&&this.ready},focus:function(){var e=this.editor.getSelection();if(e){var t=this.editor.checkDirty();e.fake(this.wrapper),!t&&this.editor.resetDirty()}this.editor.focus()},removeClass:function(e){this.element.removeClass(e),this.wrapper.removeClass(t.WRAPPER_CLASS_PREFIX+e)},removeStyle:function(e){m(this,e,0)},setData:function(e,t){var n=this.data,o=0;if("string"==typeof e)n[e]!==t&&(n[e]=t,o=1);else{var i=e;for(e in i)n[e]!==i[e]&&(o=1,n[e]=i[e])}return o&&this.dataReady&&(E(this),this.fire("data",n)),this},setFocused:function(e){return this.wrapper[e?"addClass":"removeClass"]("cke_widget_focused"),this.fire(e?"focus":"blur"),this},setSelected:function(e){return this.wrapper[e?"addClass":"removeClass"]("cke_widget_selected"),this.fire(e?"select":"deselect"),this},updateDragHandlerPosition:function(){var e=this.editor,t=this._.dragHandlerOffset,n={x:(n=this.element.$).offsetLeft,y:n.offsetTop-15};t&&n.x==t.x&&n.y==t.y||(t=e.checkDirty(),e.fire("lockSnapshot"),this.dragHandlerContainer.setStyles({top:n.y+"px",left:n.x+"px"}),this.dragHandlerContainer.removeStyle("display"),e.fire("unlockSnapshot"),!t&&e.resetDirty(),this._.dragHandlerOffset=n)}},CKEDITOR.event.implementOn(t.prototype),t.getNestedEditable=function(e,n){return!n||n.equals(e)?null:t.isDomNestedEditable(n)?n:t.getNestedEditable(e,n.getParent())},t.isDomDragHandler=function(e){return e.type==CKEDITOR.NODE_ELEMENT&&e.hasAttribute("data-cke-widget-drag-handler")},t.isDomDragHandlerContainer=function(e){return e.type==CKEDITOR.NODE_ELEMENT&&e.hasClass("cke_widget_drag_handler_container")},t.isDomNestedEditable=function(e){return e.type==CKEDITOR.NODE_ELEMENT&&e.hasAttribute("data-cke-widget-editable")},t.isDomWidgetElement=function(e){return e.type==CKEDITOR.NODE_ELEMENT&&e.hasAttribute("data-widget")},t.isDomWidgetWrapper=function(e){return e.type==CKEDITOR.NODE_ELEMENT&&e.hasAttribute("data-cke-widget-wrapper")},t.isDomWidget=function(e){return!!e&&(this.isDomWidgetWrapper(e)||this.isDomWidgetElement(e))},t.isParserWidgetElement=function(e){return e.type==CKEDITOR.NODE_ELEMENT&&!!e.attributes["data-widget"]},t.isParserWidgetWrapper=function(e){return e.type==CKEDITOR.NODE_ELEMENT&&!!e.attributes["data-cke-widget-wrapper"]},t.WRAPPER_CLASS_PREFIX="cke_widget_wrapper_",n.prototype=CKEDITOR.tools.extend(CKEDITOR.tools.prototypedCopy(CKEDITOR.dom.element.prototype),{setData:function(e){this._.initialSetData||this.editor.widgets.destroyAll(!1,this),this._.initialSetData=!1,e=this.editor.dataProcessor.toHtml(e,{context:this.getName(),filter:this.filter,enterMode:this.enterMode}),this.setHtml(e),this.editor.widgets.initOnAll(this)},getData:function(){return this.editor.dataProcessor.toDataFormat(this.getHtml(),{context:this.getName(),filter:this.filter,enterMode:this.enterMode})}});var _=/^(?:<(?:div|span)(?: data-cke-temp="1")?(?: id="cke_copybin")?(?: data-cke-temp="1")?>)?(?:<(?:div|span)(?: style="[^"]+")?>)?<span [^>]*data-cke-copybin-start="1"[^>]*>.?<\/span>([\s\S]+)<span [^>]*data-cke-copybin-end="1"[^>]*>.?<\/span>(?:<\/(?:div|span)>)?(?:<\/(?:div|span)>)?$/i,I={37:1,38:1,39:1,40:1,8:1,46:1};I[CKEDITOR.SHIFT+121]=1;var D=CKEDITOR.tools.createClass({$:function(e,t){this._.createCopyBin(e,t),this._.createListeners(t)},_:{createCopyBin:function(e){var t=e.document,n=CKEDITOR.env.edge&&16<=CKEDITOR.env.version,o=!e.blockless&&!CKEDITOR.env.ie||n?"div":"span";n=t.createElement(o),(t=t.createElement(o)).setAttributes({id:"cke_copybin","data-cke-temp":"1"}),n.setStyles({position:"absolute",width:"1px",height:"1px",overflow:"hidden"}),n.setStyle("ltr"==e.config.contentsLangDirection?"left":"right","-5000px"),this.editor=e,this.copyBin=n,this.container=t},createListeners:function(e){e&&(e.beforeDestroy&&(this.beforeDestroy=e.beforeDestroy),e.afterDestroy&&(this.afterDestroy=e.afterDestroy))}},proto:{handle:function(e){var t,n,o,i=this.copyBin,r=this.editor,a=this.container,s=CKEDITOR.env.ie&&9>CKEDITOR.env.version,l=r.document.getDocumentElement().$,u=r.createRange(),c=this,d=CKEDITOR.env.mac&&CKEDITOR.env.webkit,f=d?100:0,h=window.requestAnimationFrame&&!d?requestAnimationFrame:setTimeout;return i.setHtml('<span data-cke-copybin-start="1">​</span>'+e+'<span data-cke-copybin-end="1">​</span>'),r.fire("lockSnapshot"),a.append(i),r.editable().append(a),t=r.on("selectionChange",p,null,null,0),n=r.widgets.on("checkSelection",p,null,null,0),s&&(o=l.scrollTop),u.selectNodeContents(i),u.select(),s&&(l.scrollTop=o),new CKEDITOR.tools.promise((function(e){h((function(){c.beforeDestroy&&c.beforeDestroy(),a.remove(),t.removeListener(),n.removeListener(),r.fire("unlockSnapshot"),c.afterDestroy&&c.afterDestroy(),e()}),f)}))}},statics:{hasCopyBin:function(e){return!!D.getCopyBin(e)},getCopyBin:function(e){return e.document.getById("cke_copybin")}}});CKEDITOR.plugins.widget=t,t.repository=e,t.nestedEditable=n}(),function(){function e(e,t,n){this.editor=e,this.notification=null,this._message=new CKEDITOR.template(t),this._singularMessage=n?new CKEDITOR.template(n):null,this._tasks=[],this._doneTasks=this._doneWeights=this._totalWeights=0}function t(e){this._weight=e||1,this._doneWeight=0,this._isCanceled=!1}CKEDITOR.plugins.add("notificationaggregator",{requires:"notification"}),e.prototype={createTask:function(e){e=e||{};var t,n=!this.notification;return n&&(this.notification=this._createNotification()),(t=this._addTask(e)).on("updated",this._onTaskUpdate,this),t.on("done",this._onTaskDone,this),t.on("canceled",(function(){this._removeTask(t)}),this),this.update(),n&&this.notification.show(),t},update:function(){this._updateNotification(),this.isFinished()&&this.fire("finished")},getPercentage:function(){return 0===this.getTaskCount()?1:this._doneWeights/this._totalWeights},isFinished:function(){return this.getDoneTaskCount()===this.getTaskCount()},getTaskCount:function(){return this._tasks.length},getDoneTaskCount:function(){return this._doneTasks},_updateNotification:function(){this.notification.update({message:this._getNotificationMessage(),progress:this.getPercentage()})},_getNotificationMessage:function(){var e=this.getTaskCount(),t={current:this.getDoneTaskCount(),max:e,percentage:Math.round(100*this.getPercentage())};return(1==e&&this._singularMessage?this._singularMessage:this._message).output(t)},_createNotification:function(){return new CKEDITOR.plugins.notification(this.editor,{type:"progress"})},_addTask:function(e){return e=new t(e.weight),this._tasks.push(e),this._totalWeights+=e._weight,e},_removeTask:function(e){var t=CKEDITOR.tools.indexOf(this._tasks,e);-1!==t&&(e._doneWeight&&(this._doneWeights-=e._doneWeight),this._totalWeights-=e._weight,this._tasks.splice(t,1),this.update())},_onTaskUpdate:function(e){this._doneWeights+=e.data,this.update()},_onTaskDone:function(){this._doneTasks+=1,this.update()}},CKEDITOR.event.implementOn(e.prototype),t.prototype={done:function(){this.update(this._weight)},update:function(e){if(!this.isDone()&&!this.isCanceled()){var t=(e=Math.min(this._weight,e))-this._doneWeight;this._doneWeight=e,this.fire("updated",t),this.isDone()&&this.fire("done")}},cancel:function(){this.isDone()||this.isCanceled()||(this._isCanceled=!0,this.fire("canceled"))},isDone:function(){return this._weight===this._doneWeight},isCanceled:function(){return this._isCanceled}},CKEDITOR.event.implementOn(t.prototype),CKEDITOR.plugins.notificationAggregator=e,CKEDITOR.plugins.notificationAggregator.task=t}(),CKEDITOR.plugins.add("uploadwidget",{requires:"widget,clipboard,filetools,notificationaggregator",init:function(e){e.filter.allow("*[!data-widget,!data-cke-upload-id]")},isSupportedEnvironment:function(){return CKEDITOR.plugins.clipboard.isFileApiSupported}}),CKEDITOR.fileTools||(CKEDITOR.fileTools={}),CKEDITOR.tools.extend(CKEDITOR.fileTools,{addUploadWidget:function(e,t,n){var o=CKEDITOR.fileTools,i=e.uploadRepository;n.fileToElement&&e.on("paste",(function(n){var r,a,s=e.widgets.registered[t],l=(n=n.data).dataTransfer,u=l.getFilesCount(),c=s.loadMethod||"loadAndUpload";if(!n.dataValue&&u)for(a=0;a<u;a++)if(r=l.getFile(a),!s.supportedTypes||o.isTypeSupported(r,s.supportedTypes)){var d=s.fileToElement(r);r=i.create(r,void 0,s.loaderType),d&&(r[c](s.uploadUrl,s.additionalRequestParameters),CKEDITOR.fileTools.markElement(d,t,r.id),"loadAndUpload"!=c&&"upload"!=c||s.skipNotifications||CKEDITOR.fileTools.bindNotifications(e,r),n.dataValue+=d.getOuterHtml())}}),null,null,n.supportedTypes?10:20),CKEDITOR.tools.extend(n,{downcast:function(){return new CKEDITOR.htmlParser.text("")},init:function(){var t,n,o=this,r=this.wrapper.findOne("[data-cke-upload-id]").data("cke-upload-id"),a=i.loaders[r],s=CKEDITOR.tools.capitalize;a.on("update",(function(i){"abort"===a.status&&"function"==typeof o.onAbort&&o.onAbort(a),o.wrapper&&o.wrapper.getParent()?(e.fire("lockSnapshot"),i="on"+s(a.status),"abort"!==a.status&&"function"==typeof o[i]&&!1===o[i](a)||(n="cke_upload_"+a.status,o.wrapper&&n!=t&&(t&&o.wrapper.removeClass(t),o.wrapper.addClass(n),t=n),"error"!=a.status&&"abort"!=a.status||e.widgets.del(o)),e.fire("unlockSnapshot")):(CKEDITOR.instances[e.name]&&e.editable().find('[data-cke-upload-id="'+r+'"]').count()||a.abort(),i.removeListener())})),a.update()},replaceWith:function(t,n){if(""===t.trim())e.widgets.del(this);else{var o,i,r=this==e.widgets.focused,a=e.editable(),s=e.createRange();r||(i=e.getSelection().createBookmarks()),s.setStartBefore(this.wrapper),s.setEndAfter(this.wrapper),r&&(o=s.createBookmark()),a.insertHtmlIntoRange(t,s,n),e.widgets.checkWidgets({initOnlyNew:!0}),e.widgets.destroy(this,!0),r?(s.moveToBookmark(o),s.select()):e.getSelection().selectBookmarks(i)}},_getLoader:function(){var e=this.wrapper.findOne("[data-cke-upload-id]");return e?this.editor.uploadRepository.loaders[e.data("cke-upload-id")]:null}}),e.widgets.add(t,n)},markElement:function(e,t,n){e.setAttributes({"data-cke-upload-id":n,"data-widget":t})},bindNotifications:function(e,t){var n,o=null;t.on("update",(function(){!o&&t.uploadTotal&&((n=e._.uploadWidgetNotificaionAggregator)&&!n.isFinished()||(n=e._.uploadWidgetNotificaionAggregator=new CKEDITOR.plugins.notificationAggregator(e,e.lang.uploadwidget.uploadMany,e.lang.uploadwidget.uploadOne)).once("finished",(function(){var t=n.getTaskCount();0===t?n.notification.hide():n.notification.update({message:1==t?e.lang.uploadwidget.doneOne:e.lang.uploadwidget.doneMany.replace("%1",t),type:"success",important:1})})),o=n.createTask({weight:t.uploadTotal})),o&&"uploading"==t.status&&o.update(t.uploaded)})),t.on("uploaded",(function(){o&&o.done()})),t.on("error",(function(){o&&o.cancel(),e.showNotification(t.message,"warning")})),t.on("abort",(function(){o&&o.cancel(),CKEDITOR.instances[e.name]&&e.showNotification(e.lang.uploadwidget.abort,"info")}))}}),function(){function e(e){return 9>=e&&(e="0"+e),String(e)}function t(t){var o=[(o=new Date).getFullYear(),o.getMonth()+1,o.getDate(),o.getHours(),o.getMinutes(),o.getSeconds()];return n+=1,"image-"+CKEDITOR.tools.array.map(o,e).join("")+"-"+n+"."+t}var n=0;CKEDITOR.plugins.add("uploadimage",{requires:"uploadwidget",onLoad:function(){CKEDITOR.addCss(".cke_upload_uploading img{opacity: 0.3}")},isSupportedEnvironment:function(){return CKEDITOR.plugins.clipboard.isFileApiSupported},init:function(e){if(this.isSupportedEnvironment()){var n=CKEDITOR.fileTools,o=n.getUploadUrl(e.config,"image");o&&(n.addUploadWidget(e,"uploadimage",{supportedTypes:/image\/(jpeg|png|gif|bmp)/,uploadUrl:o,fileToElement:function(){var e=new CKEDITOR.dom.element("img");return e.setAttribute("src","data:image/gif;base64,R0lGODlhDgAOAIAAAAAAAP///yH5BAAAAAAALAAAAAAOAA4AAAIMhI+py+0Po5y02qsKADs="),e},parts:{img:"img"},onUploading:function(e){this.parts.img.setAttribute("src",e.data)},onUploaded:function(e){var t=this.parts.img.$;this.replaceWith('<img src="'+e.url+'" width="'+(e.responseData.width||t.naturalWidth)+'" height="'+(e.responseData.height||t.naturalHeight)+'">')}}),e.on("paste",(function(i){if(i.data.dataValue.match(/<img[\s\S]+data:/i)){i=i.data;var r,a,s,l=document.implementation.createHTMLDocument("");for((l=new CKEDITOR.dom.element(l.body)).data("cke-editable",1),l.appendHtml(i.dataValue),r=l.find("img"),s=0;s<r.count();s++){var u=(a=r.getItem(s)).getAttribute("src"),c=u&&"data:"==u.substring(0,5),d=null===a.data("cke-realelement");c&&d&&!a.data("cke-upload-id")&&!a.isReadOnly(1)&&(c=(c=u.match(/image\/([a-z]+?);/i))&&c[1]||"jpg",(u=e.uploadRepository.create(u,t(c))).upload(o),n.markElement(a,"uploadimage",u.id),n.bindNotifications(e,u))}i.dataValue=l.getHtml()}})))}}})}(),CKEDITOR.plugins.add("wsc",{requires:"dialog",parseApi:function(e){e.config.wsc_onFinish="function"==typeof e.config.wsc_onFinish?e.config.wsc_onFinish:function(){},e.config.wsc_onClose="function"==typeof e.config.wsc_onClose?e.config.wsc_onClose:function(){}},parseConfig:function(e){e.config.wsc_customerId=e.config.wsc_customerId||CKEDITOR.config.wsc_customerId||"1:ua3xw1-2XyGJ3-GWruD3-6OFNT1-oXcuB1-nR6Bp4-hgQHc-EcYng3-sdRXG3-NOfFk",e.config.wsc_customDictionaryIds=e.config.wsc_customDictionaryIds||CKEDITOR.config.wsc_customDictionaryIds||"",e.config.wsc_userDictionaryName=e.config.wsc_userDictionaryName||CKEDITOR.config.wsc_userDictionaryName||"",e.config.wsc_customLoaderScript=e.config.wsc_customLoaderScript||CKEDITOR.config.wsc_customLoaderScript,e.config.wsc_interfaceLang=e.config.wsc_interfaceLang,CKEDITOR.config.wsc_cmd=e.config.wsc_cmd||CKEDITOR.config.wsc_cmd||"spell",CKEDITOR.config.wsc_version="v4.3.0-master-d769233",CKEDITOR.config.wsc_removeGlobalVariable=!0},onLoad:function(e){"moono-lisa"==(CKEDITOR.skinName||e.config.skin)&&CKEDITOR.document.appendStyleSheet(CKEDITOR.getUrl(this.path+"skins/"+CKEDITOR.skin.name+"/wsc.css"))},init:function(e){var t=CKEDITOR.env;this.parseConfig(e),this.parseApi(e),e.addCommand("checkspell",new CKEDITOR.dialogCommand("checkspell")).modes={wysiwyg:!(CKEDITOR.env.opera||CKEDITOR.env.air||document.domain!=window.location.hostname||t.ie&&(8>t.version||t.quirks))},void 0===e.plugins.scayt&&e.ui.addButton&&e.ui.addButton("SpellChecker",{label:e.lang.wsc.toolbar,click:function(e){var t=e.elementMode==CKEDITOR.ELEMENT_MODE_INLINE?e.container.getText():e.document.getBody().getText();(t=t.replace(/\s/g,""))?e.execCommand("checkspell"):alert("Nothing to check!")},toolbar:"spellchecker,10"}),CKEDITOR.dialog.add("checkspell",this.path+(CKEDITOR.env.ie&&7>=CKEDITOR.env.version?"dialogs/wsc_ie.js":window.postMessage?"dialogs/wsc.js":"dialogs/wsc_ie.js"))}}),CKEDITOR.plugins.add("divarea",{afterInit:function(e){e.addMode("wysiwyg",(function(t){var n=CKEDITOR.dom.element.createFromHtml('<div class="cke_wysiwyg_div cke_reset cke_enable_context_menu" hidefocus="true"></div>');e.ui.space("contents").append(n),(n=e.editable(n)).detach=CKEDITOR.tools.override(n.detach,(function(e){return function(){e.apply(this,arguments),this.remove()}})),e.setData(e.getData(1),t),e.fire("contentDom")}))}}),CKEDITOR.config.plugins="dialogui,dialog,about,a11yhelp,dialogadvtab,basicstyles,bidi,blockquote,notification,button,toolbar,clipboard,panelbutton,panel,floatpanel,colorbutton,colordialog,templates,menu,contextmenu,copyformatting,div,resize,elementspath,enterkey,entities,popup,filetools,filebrowser,find,fakeobjects,flash,floatingspace,listblock,richcombo,font,forms,format,horizontalrule,htmlwriter,iframe,wysiwygarea,image,indent,indentblock,indentlist,smiley,justify,menubutton,language,link,list,liststyle,magicline,maximize,newpage,pagebreak,pastetext,pastetools,pastefromgdocs,pastefromword,preview,print,removeformat,save,selectall,showblocks,showborders,sourcearea,specialchar,scayt,stylescombo,tab,table,tabletools,tableselection,undo,lineutils,widgetselection,widget,notificationaggregator,uploadwidget,uploadimage,wsc,divarea",CKEDITOR.config.skin="bootstrapck",a=function(e,t){var n=CKEDITOR.getUrl("plugins/"+t);e=e.split(",");for(var o=0;o<e.length;o++)CKEDITOR.skin.icons[e[o]]={path:n,offset:-e[++o],bgsize:e[++o]}},CKEDITOR.env.hidpi?a("about,0,,bold,24,,italic,48,,strike,72,,subscript,96,,superscript,120,,underline,144,,bidiltr,168,,bidirtl,192,,blockquote,216,,copy-rtl,240,,copy,264,,cut-rtl,288,,cut,312,,paste-rtl,336,,paste,360,,bgcolor,384,,textcolor,408,,templates-rtl,432,,templates,456,,copyformatting,480,,creatediv,504,,find-rtl,528,,find,552,,replace,576,,flash,600,,button,624,,checkbox,648,,form,672,,hiddenfield,696,,imagebutton,720,,radio,744,,select-rtl,768,,select,792,,textarea-rtl,816,,textarea,840,,textfield-rtl,864,,textfield,888,,horizontalrule,912,,iframe,936,,image,960,,indent-rtl,984,,indent,1008,,outdent-rtl,1032,,outdent,1056,,smiley,1080,,justifyblock,1104,,justifycenter,1128,,justifyleft,1152,,justifyright,1176,,language,1200,,anchor-rtl,1224,,anchor,1248,,link,1272,,unlink,1296,,bulletedlist-rtl,1320,,bulletedlist,1344,,numberedlist-rtl,1368,,numberedlist,1392,,maximize,1416,,newpage-rtl,1440,,newpage,1464,,pagebreak-rtl,1488,,pagebreak,1512,,pastetext-rtl,1536,,pastetext,1560,,pastefromword-rtl,1584,,pastefromword,1608,,preview-rtl,1632,,preview,1656,,print,1680,,removeformat,1704,,save,1728,,selectall,1752,,showblocks-rtl,1776,,showblocks,1800,,source-rtl,1824,,source,1848,,specialchar,1872,,scayt,1896,,table,1920,,redo-rtl,1944,,redo,1968,,undo-rtl,1992,,undo,2016,,spellchecker,2040,","icons_hidpi.png"):a("about,0,auto,bold,24,auto,italic,48,auto,strike,72,auto,subscript,96,auto,superscript,120,auto,underline,144,auto,bidiltr,168,auto,bidirtl,192,auto,blockquote,216,auto,copy-rtl,240,auto,copy,264,auto,cut-rtl,288,auto,cut,312,auto,paste-rtl,336,auto,paste,360,auto,bgcolor,384,auto,textcolor,408,auto,templates-rtl,432,auto,templates,456,auto,copyformatting,480,auto,creatediv,504,auto,find-rtl,528,auto,find,552,auto,replace,576,auto,flash,600,auto,button,624,auto,checkbox,648,auto,form,672,auto,hiddenfield,696,auto,imagebutton,720,auto,radio,744,auto,select-rtl,768,auto,select,792,auto,textarea-rtl,816,auto,textarea,840,auto,textfield-rtl,864,auto,textfield,888,auto,horizontalrule,912,auto,iframe,936,auto,image,960,auto,indent-rtl,984,auto,indent,1008,auto,outdent-rtl,1032,auto,outdent,1056,auto,smiley,1080,auto,justifyblock,1104,auto,justifycenter,1128,auto,justifyleft,1152,auto,justifyright,1176,auto,language,1200,auto,anchor-rtl,1224,auto,anchor,1248,auto,link,1272,auto,unlink,1296,auto,bulletedlist-rtl,1320,auto,bulletedlist,1344,auto,numberedlist-rtl,1368,auto,numberedlist,1392,auto,maximize,1416,auto,newpage-rtl,1440,auto,newpage,1464,auto,pagebreak-rtl,1488,auto,pagebreak,1512,auto,pastetext-rtl,1536,auto,pastetext,1560,auto,pastefromword-rtl,1584,auto,pastefromword,1608,auto,preview-rtl,1632,auto,preview,1656,auto,print,1680,auto,removeformat,1704,auto,save,1728,auto,selectall,1752,auto,showblocks-rtl,1776,auto,showblocks,1800,auto,source-rtl,1824,auto,source,1848,auto,specialchar,1872,auto,scayt,1896,auto,table,1920,auto,redo-rtl,1944,auto,redo,1968,auto,undo-rtl,1992,auto,undo,2016,auto,spellchecker,2040,auto","icons.png"),CKEDITOR.lang.languages={en:1,id:1}}}();